{"fetchDate": "2019-12-19", "content": [{"sha": "1772910a5223071bcf96709220ccef610f142c81", "node_id": "MDY6Q29tbWl0NDUwODIwMjM6MTc3MjkxMGE1MjIzMDcxYmNmOTY3MDkyMjBjY2VmNjEwZjE0MmM4MQ==", "commit": {"author": {"name": "Jerry Wang", "email": "jerryw4113@gmail.com", "date": "2019-02-23T13:17:11Z"}, "committer": {"name": "Ronan Lana", "email": "rcpl2010@gmail.com", "date": "2019-02-23T13:17:11Z"}, "message": "Added votepoints into db_database.sql (#411)\n\n* Added GM lv0 command to read votepoints and rewardpoints\r\n\r\n* Added missing votepoints in sql and tweaked MapleClient\r\n\r\n* Fix read from votes\r\n\r\n* Fix votepoints sql", "tree": {"sha": "3b942eb753d1a5072bcdfb8f5f96cfe72840fd36", "url": "https://api.github.com/repos/ronancpl/HeavenMS/git/trees/3b942eb753d1a5072bcdfb8f5f96cfe72840fd36"}, "url": "https://api.github.com/repos/ronancpl/HeavenMS/git/commits/1772910a5223071bcf96709220ccef610f142c81", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/1772910a5223071bcf96709220ccef610f142c81", "html_url": "https://github.com/ronancpl/HeavenMS/commit/1772910a5223071bcf96709220ccef610f142c81", "comments_url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/1772910a5223071bcf96709220ccef610f142c81/comments", "author": {"login": "pandabyte", "id": 14182886, "node_id": "MDQ6VXNlcjE0MTgyODg2", "avatar_url": "https://avatars0.githubusercontent.com/u/14182886?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pandabyte", "html_url": "https://github.com/pandabyte", "followers_url": "https://api.github.com/users/pandabyte/followers", "following_url": "https://api.github.com/users/pandabyte/following{/other_user}", "gists_url": "https://api.github.com/users/pandabyte/gists{/gist_id}", "starred_url": "https://api.github.com/users/pandabyte/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pandabyte/subscriptions", "organizations_url": "https://api.github.com/users/pandabyte/orgs", "repos_url": "https://api.github.com/users/pandabyte/repos", "events_url": "https://api.github.com/users/pandabyte/events{/privacy}", "received_events_url": "https://api.github.com/users/pandabyte/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ronancpl", "id": 9257761, "node_id": "MDQ6VXNlcjkyNTc3NjE=", "avatar_url": "https://avatars2.githubusercontent.com/u/9257761?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ronancpl", "html_url": "https://github.com/ronancpl", "followers_url": "https://api.github.com/users/ronancpl/followers", "following_url": "https://api.github.com/users/ronancpl/following{/other_user}", "gists_url": "https://api.github.com/users/ronancpl/gists{/gist_id}", "starred_url": "https://api.github.com/users/ronancpl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ronancpl/subscriptions", "organizations_url": "https://api.github.com/users/ronancpl/orgs", "repos_url": "https://api.github.com/users/ronancpl/repos", "events_url": "https://api.github.com/users/ronancpl/events{/privacy}", "received_events_url": "https://api.github.com/users/ronancpl/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "895326e819428d9010f157eeb96c10c1b2b48a2b", "url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/895326e819428d9010f157eeb96c10c1b2b48a2b", "html_url": "https://github.com/ronancpl/HeavenMS/commit/895326e819428d9010f157eeb96c10c1b2b48a2b"}], "stats": {"total": 47, "additions": 43, "deletions": 4}, "files": [{"sha": "645d8bada3aa3ca5bb882c658b1c30a513b7f544", "filename": "sql/db_database.sql", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/1772910a5223071bcf96709220ccef610f142c81/sql/db_database.sql", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/1772910a5223071bcf96709220ccef610f142c81/sql/db_database.sql", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/sql/db_database.sql?ref=1772910a5223071bcf96709220ccef610f142c81", "patch": "@@ -40,6 +40,7 @@ CREATE TABLE IF NOT EXISTS `accounts` (\n   `email` varchar(45) DEFAULT NULL,\n   `ip` text,\n   `rewardpoints` int(11) NOT NULL DEFAULT '0',\n+  `votepoints` int(11) NOT NULL DEFAULT '0',\n   `hwid` varchar(12) NOT NULL DEFAULT '',\n   PRIMARY KEY (`id`),\n   UNIQUE KEY `name` (`name`),"}, {"sha": "55089dd751d4b96d9ca7a878738415dd9c35b228", "filename": "src/client/MapleClient.java", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/1772910a5223071bcf96709220ccef610f142c81/src/client/MapleClient.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/1772910a5223071bcf96709220ccef610f142c81/src/client/MapleClient.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/MapleClient.java?ref=1772910a5223071bcf96709220ccef610f142c81", "patch": "@@ -1160,12 +1160,12 @@ public int getVotePoints(){\n \t\tint points = 0;\n \t\ttry {\n                         Connection con = DatabaseConnection.getConnection();\n-\t\t\tPreparedStatement ps = con.prepareStatement(\"SELECT `votes` FROM accounts WHERE id = ?\");\n+\t\t\tPreparedStatement ps = con.prepareStatement(\"SELECT `votepoints` FROM accounts WHERE id = ?\");\n \t\t\tps.setInt(1, accId);\n \t\t\tResultSet rs = ps.executeQuery();\n \n \t\t\tif (rs.next()) {\n-\t\t\t\tpoints = rs.getInt(\"votes\");\n+\t\t\t\tpoints = rs.getInt(\"votepoints\");\n \t\t\t}\n \t\t\tps.close();\n \t\t\trs.close();\n@@ -1196,7 +1196,7 @@ public void useVotePoints(int points){\n \tprivate void saveVotePoints() {\n \t\ttry {\n \t\t\tConnection con = DatabaseConnection.getConnection();\n-\t\t\ttry (PreparedStatement ps = con.prepareStatement(\"UPDATE accounts SET votes = ? WHERE id = ?\")) {\n+\t\t\ttry (PreparedStatement ps = con.prepareStatement(\"UPDATE accounts SET votepoints = ? WHERE id = ?\")) {\n \t\t\t\tps.setInt(1, votePoints);\n \t\t\t\tps.setInt(2, accId);\n \t\t\t\tps.executeUpdate();"}, {"sha": "012a784ef07cf4cde1c1561a836c9fa365601e2c", "filename": "src/client/command/CommandsExecutor.java", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/1772910a5223071bcf96709220ccef610f142c81/src/client/command/CommandsExecutor.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/1772910a5223071bcf96709220ccef610f142c81/src/client/command/CommandsExecutor.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/CommandsExecutor.java?ref=1772910a5223071bcf96709220ccef610f142c81", "patch": "@@ -184,7 +184,7 @@ private void registerLv0Commands(){\n         addCommand(\"online\", OnlineCommand.class);\n         addCommand(\"gm\", GmCommand.class);\n         addCommand(\"reportbug\", ReportBugCommand.class);\n-        //addCommand(\"points\", \"\");\n+        addCommand(\"points\", ReadPointsCommand.class);\n         addCommand(\"joinevent\", JoinEventCommand.class);\n         addCommand(\"leaveevent\", LeaveEventCommand.class);\n         addCommand(\"ranks\", RanksCommand.class);"}, {"sha": "31945197863f541a7abd269b6f8719a034a8ae76", "filename": "src/client/command/commands/gm0/ReadPointsCommand.java", "status": "added", "additions": 38, "deletions": 0, "changes": 38, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/1772910a5223071bcf96709220ccef610f142c81/src/client/command/commands/gm0/ReadPointsCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/1772910a5223071bcf96709220ccef610f142c81/src/client/command/commands/gm0/ReadPointsCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/gm0/ReadPointsCommand.java?ref=1772910a5223071bcf96709220ccef610f142c81", "patch": "@@ -0,0 +1,38 @@\n+package client.command.commands.gm0;\n+\n+import client.MapleCharacter;\n+import client.MapleClient;\n+import client.command.Command;\n+\n+public class ReadPointsCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient client, String[] params) {\n+\n+        MapleCharacter player = client.getPlayer();\n+        if (params.length > 2) {\n+            player.yellowMessage(\"Syntax: @points (rp|vp|all)\");\n+            return;\n+        } else if (params.length == 0) {\n+            player.yellowMessage(\"RewardPoints: \" + player.getRewardPoints() + \" | \"\n+                    + \"VotePoints: \" + player.getClient().getVotePoints());\n+            return;\n+        }\n+\n+        switch (params[0]) {\n+            case \"rp\":\n+                player.yellowMessage(\"RewardPoints: \" + player.getRewardPoints());\n+                break;\n+            case \"vp\":\n+                player.yellowMessage(\"VotePoints: \" + player.getClient().getVotePoints());\n+                break;\n+            default:\n+                player.yellowMessage(\"RewardPoints: \" + player.getRewardPoints() + \" | \"\n+                        + \"VotePoints: \" + player.getClient().getVotePoints());\n+                break;\n+        }\n+    }\n+}\n\\ No newline at end of file"}]}]},
