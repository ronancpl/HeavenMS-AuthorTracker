{"fetchDate": "2019-12-19", "content": [{"sha": "36db21bf80ee1f7e80e36ff04b4d8785c28fb984", "node_id": "MDY6Q29tbWl0NDUwODIwMjM6MzZkYjIxYmY4MGVlMWY3ZTgwZTM2ZmYwNGI0ZDg3ODVjMjhmYjk4NA==", "commit": {"author": {"name": "ExtremeDevilz", "email": "c2509463@drdrb.com", "date": "2017-08-20T04:24:35Z"}, "committer": {"name": "ronancpl", "email": "rcpl2010@gmail.com", "date": "2017-08-20T04:24:35Z"}, "message": "Clarify On Login Packets (#63)\n\n* Clarify On Login Packets\r\n\r\nClarify On Login Packets\r\n\r\n* Rebase Code On PIN/PIC For Login Packet\r\n\r\nRebase Code On PIN/PIC For Login Packet\r\n\r\n* Whoops Sorry !\r\n\r\nWhoops Sorry !\r\n\r\n* Fixes DB Scheme\r\n\r\nFixes DB Scheme\r\n\r\n* Fixed LoginPacket Information\r\n\r\nFixed LoginPacket Information", "tree": {"sha": "da6760c46c1489833d98d3e4856a355fc3fe213d", "url": "https://api.github.com/repos/ronancpl/HeavenMS/git/trees/da6760c46c1489833d98d3e4856a355fc3fe213d"}, "url": "https://api.github.com/repos/ronancpl/HeavenMS/git/commits/36db21bf80ee1f7e80e36ff04b4d8785c28fb984", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/36db21bf80ee1f7e80e36ff04b4d8785c28fb984", "html_url": "https://github.com/ronancpl/HeavenMS/commit/36db21bf80ee1f7e80e36ff04b4d8785c28fb984", "comments_url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/36db21bf80ee1f7e80e36ff04b4d8785c28fb984/comments", "author": {"login": "ExtremeDevilz", "id": 6152152, "node_id": "MDQ6VXNlcjYxNTIxNTI=", "avatar_url": "https://avatars3.githubusercontent.com/u/6152152?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ExtremeDevilz", "html_url": "https://github.com/ExtremeDevilz", "followers_url": "https://api.github.com/users/ExtremeDevilz/followers", "following_url": "https://api.github.com/users/ExtremeDevilz/following{/other_user}", "gists_url": "https://api.github.com/users/ExtremeDevilz/gists{/gist_id}", "starred_url": "https://api.github.com/users/ExtremeDevilz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ExtremeDevilz/subscriptions", "organizations_url": "https://api.github.com/users/ExtremeDevilz/orgs", "repos_url": "https://api.github.com/users/ExtremeDevilz/repos", "events_url": "https://api.github.com/users/ExtremeDevilz/events{/privacy}", "received_events_url": "https://api.github.com/users/ExtremeDevilz/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ronancpl", "id": 9257761, "node_id": "MDQ6VXNlcjkyNTc3NjE=", "avatar_url": "https://avatars2.githubusercontent.com/u/9257761?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ronancpl", "html_url": "https://github.com/ronancpl", "followers_url": "https://api.github.com/users/ronancpl/followers", "following_url": "https://api.github.com/users/ronancpl/following{/other_user}", "gists_url": "https://api.github.com/users/ronancpl/gists{/gist_id}", "starred_url": "https://api.github.com/users/ronancpl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ronancpl/subscriptions", "organizations_url": "https://api.github.com/users/ronancpl/orgs", "repos_url": "https://api.github.com/users/ronancpl/repos", "events_url": "https://api.github.com/users/ronancpl/events{/privacy}", "received_events_url": "https://api.github.com/users/ronancpl/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ba6b5bc191486803bc42be284c99fed42619e6d5", "url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/ba6b5bc191486803bc42be284c99fed42619e6d5", "html_url": "https://github.com/ronancpl/HeavenMS/commit/ba6b5bc191486803bc42be284c99fed42619e6d5"}], "stats": {"total": 47, "additions": 23, "deletions": 24}, "files": [{"sha": "3d50d91379c8bd79431df17880085655f17352cc", "filename": ".gitignore", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/36db21bf80ee1f7e80e36ff04b4d8785c28fb984/.gitignore", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/36db21bf80ee1f7e80e36ff04b4d8785c28fb984/.gitignore", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/.gitignore?ref=36db21bf80ee1f7e80e36ff04b4d8785c28fb984", "patch": "@@ -1 +1,2 @@\n /logs/\n+.idea/\n\\ No newline at end of file"}, {"sha": "736d9fbc3b077c8862b41b8a6837c777b20d40b9", "filename": "sql/db_database.sql", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/36db21bf80ee1f7e80e36ff04b4d8785c28fb984/sql/db_database.sql", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/36db21bf80ee1f7e80e36ff04b4d8785c28fb984/sql/db_database.sql", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/sql/db_database.sql?ref=36db21bf80ee1f7e80e36ff04b4d8785c28fb984", "patch": "@@ -8,9 +8,9 @@ SET time_zone = \"+00:00\";\n /*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;\n /*!40101 SET NAMES utf8 */;\n \n-DROP DATABASE IF EXISTS `maplesolaxia2`;\n-CREATE DATABASE `maplesolaxia2` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;\n-USE `maplesolaxia2`;\n+DROP DATABASE IF EXISTS `maplesolaxia`;\n+CREATE DATABASE `maplesolaxia` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;\n+USE `maplesolaxia`;\n \n CREATE TABLE IF NOT EXISTS `accounts` (\n   `id` int(11) NOT NULL AUTO_INCREMENT,"}, {"sha": "c4217d47a0a54413f59007dc946ac29db17afa3c", "filename": "sql/db_drops.sql", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/36db21bf80ee1f7e80e36ff04b4d8785c28fb984/sql/db_drops.sql", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/36db21bf80ee1f7e80e36ff04b4d8785c28fb984/sql/db_drops.sql", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/sql/db_drops.sql?ref=36db21bf80ee1f7e80e36ff04b4d8785c28fb984", "patch": "@@ -1,7 +1,7 @@\n \ufeff#THIS SQL MUST BE USED AFTER 'db_database.sql'\n #NEXT SQL 'db_shopupdate.sql' IS OPTIONAL\n \n-USE `maplesolaxia2`;\n+USE `maplesolaxia`;\n \n   INSERT IGNORE INTO temp_data (`dropperid`, `itemid`, `minimum_quantity`, `maximum_quantity`, `questid`, `chance`) VALUES\n   #-- copy+paste inside here as many drop data as possible from the spider (drop generator) files --"}, {"sha": "4ec4b74f93dfc0c0314bf8274c32eb8acd6ddd5d", "filename": "sql/db_shopupdate.sql", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/36db21bf80ee1f7e80e36ff04b4d8785c28fb984/sql/db_shopupdate.sql", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/36db21bf80ee1f7e80e36ff04b4d8785c28fb984/sql/db_shopupdate.sql", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/sql/db_shopupdate.sql?ref=36db21bf80ee1f7e80e36ff04b4d8785c28fb984", "patch": "@@ -1,7 +1,7 @@\n \ufeff#THIS SQL IS OPTIONAL, TO BE USED AFTER 'db_drops.sql'\n #THIS REQUIRES PROVIDED WZ FILES\n \n-USE `maplesolaxia2`;\n+USE `maplesolaxia`;\n \n UPDATE shopitems SET itemid=1812005, price=1000 WHERE shopitemid=18;\n UPDATE shopitems SET itemid=1812004, price=1000 WHERE shopitemid=19;"}, {"sha": "9df6a26f1cf8e7c0e4961ea3bb4d4d3458363e64", "filename": "src/tools/MaplePacketCreator.java", "status": "modified", "additions": 17, "deletions": 19, "changes": 36, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/36db21bf80ee1f7e80e36ff04b4d8785c28fb984/src/tools/MaplePacketCreator.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/36db21bf80ee1f7e80e36ff04b4d8785c28fb984/src/tools/MaplePacketCreator.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/tools/MaplePacketCreator.java?ref=36db21bf80ee1f7e80e36ff04b4d8785c28fb984", "patch": "@@ -670,34 +670,36 @@ private static void addMonsterBookInfo(final MaplePacketLittleEndianWriter mplew\n         }\n \n         /**\n-         * Gets a successful authentication and PIN Request packet.\n+         * Gets a successful authentication packet.\n          *\n          * @param c\n          * @param account The account name.\n-         * @return The PIN request packet.\n+         * @return the successful authentication packet\n          */\n         public static byte[] getAuthSuccess(MapleClient c) {\n                 final MaplePacketLittleEndianWriter mplew = new MaplePacketLittleEndianWriter();\n                 mplew.writeShort(SendOpcode.LOGIN_STATUS.getValue());\n                 mplew.writeInt(0);\n                 mplew.writeShort(0);\n-                mplew.writeInt(c.getAccID()); //user id\n+                mplew.writeInt(c.getAccID());\n                 mplew.write(c.getGender());\n-                mplew.writeBool(c.getGMLevel() > 0); //admin byte\n-                short toWrite = (short) (c.getGMLevel() * 64);\n-                //toWrite = toWrite |= 0x100; only in higher versions\n-                mplew.write(toWrite >= 0x80 ? 0x80 : 0);//0x80 is admin, 0x20 and 0x40 = subgm\n+                \n                 mplew.writeBool(c.getGMLevel() > 0);\n-                //mplew.writeShort(toWrite > 0x80 ? 0x80 : toWrite); only in higher versions...\n+                \n+                mplew.write(0); // Admin Byte. 0x80,0x40,0x20.. Rubbish.\n+                mplew.write(0); // Country Code.\n+                \n                 mplew.writeMapleAsciiString(c.getAccountName());\n                 mplew.write(0);\n-                mplew.write(0); //isquietbanned\n-                mplew.writeLong(0);//isquietban time\n-                mplew.writeLong(c.getSessionId()); //creation time\n-                mplew.writeInt(0);\n                 \n-                if (ServerConstants.ENABLE_PIN) mplew.writeShort(0);\n-                else mplew.writeShort(2);\n+                mplew.write(0); // IsQuietBan\n+        \t\tmplew.writeLong(0);//IsQuietBanTimeStamp\n+        \t\tmplew.writeLong(0); //CreationTimeStamp\n+\n+                mplew.writeInt(1); // 1: Remove the \"Select the world you want to play in\"\n+\n+                mplew.write(ServerConstants.ENABLE_PIN ? 0 : 1); // 0 = Pin-System Enabled, 1 = Disabled\n+                mplew.write(ServerConstants.ENABLE_PIC ? (c.getPic() == null ? 0 : 1) : 2); // 0 = Register PIC, 1 = Ask for PIC, 2 = Disabled\n                 \n                 return mplew.getPacket();\n         }\n@@ -861,12 +863,8 @@ private static void addMonsterBookInfo(final MaplePacketLittleEndianWriter mplew\n                 for (MapleCharacter chr : chars) {\n                         addCharEntry(mplew, chr, false);      \n                 }\n-                if (ServerConstants.ENABLE_PIC) {\n-                        mplew.write(c.getPic() == null || c.getPic().length() == 0 ? 0 : 1);\n-                } else {\n-                        mplew.write(2);\n-                }\n \n+                mplew.write(ServerConstants.ENABLE_PIC ? (c.getPic() == null ? 0 : 1) : 2);\n                 mplew.writeInt(c.getCharacterSlots());\n                 return mplew.getPacket();\n         }"}]}]},
