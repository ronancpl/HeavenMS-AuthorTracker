{"fetchDate": "2019-12-19", "content": [{"sha": "090aea9891e0bc60922e84c403a9814c24352433", "node_id": "MDY6Q29tbWl0NDUwODIwMjM6MDkwYWVhOTg5MWUwYmM2MDkyMmU4NGM0MDNhOTgxNGMyNDM1MjQzMw==", "commit": {"author": {"name": "ronancpl", "email": "rcpl2010@gmail.com", "date": "2015-11-06T15:22:14Z"}, "committer": {"name": "ronancpl", "email": "rcpl2010@gmail.com", "date": "2015-11-06T15:22:14Z"}, "message": "MapleSolaxiaV2 Revision 1\n\nEdited Ranking system.", "tree": {"sha": "5a9e140371fc9b63f4ea91b6d79439fc1a06c57a", "url": "https://api.github.com/repos/ronancpl/HeavenMS/git/trees/5a9e140371fc9b63f4ea91b6d79439fc1a06c57a"}, "url": "https://api.github.com/repos/ronancpl/HeavenMS/git/commits/090aea9891e0bc60922e84c403a9814c24352433", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/090aea9891e0bc60922e84c403a9814c24352433", "html_url": "https://github.com/ronancpl/HeavenMS/commit/090aea9891e0bc60922e84c403a9814c24352433", "comments_url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/090aea9891e0bc60922e84c403a9814c24352433/comments", "author": {"login": "ronancpl", "id": 9257761, "node_id": "MDQ6VXNlcjkyNTc3NjE=", "avatar_url": "https://avatars2.githubusercontent.com/u/9257761?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ronancpl", "html_url": "https://github.com/ronancpl", "followers_url": "https://api.github.com/users/ronancpl/followers", "following_url": "https://api.github.com/users/ronancpl/following{/other_user}", "gists_url": "https://api.github.com/users/ronancpl/gists{/gist_id}", "starred_url": "https://api.github.com/users/ronancpl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ronancpl/subscriptions", "organizations_url": "https://api.github.com/users/ronancpl/orgs", "repos_url": "https://api.github.com/users/ronancpl/repos", "events_url": "https://api.github.com/users/ronancpl/events{/privacy}", "received_events_url": "https://api.github.com/users/ronancpl/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ronancpl", "id": 9257761, "node_id": "MDQ6VXNlcjkyNTc3NjE=", "avatar_url": "https://avatars2.githubusercontent.com/u/9257761?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ronancpl", "html_url": "https://github.com/ronancpl", "followers_url": "https://api.github.com/users/ronancpl/followers", "following_url": "https://api.github.com/users/ronancpl/following{/other_user}", "gists_url": "https://api.github.com/users/ronancpl/gists{/gist_id}", "starred_url": "https://api.github.com/users/ronancpl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ronancpl/subscriptions", "organizations_url": "https://api.github.com/users/ronancpl/orgs", "repos_url": "https://api.github.com/users/ronancpl/repos", "events_url": "https://api.github.com/users/ronancpl/events{/privacy}", "received_events_url": "https://api.github.com/users/ronancpl/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "26c3caf63f36b13436592c6c357edb8ade843cf3", "url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/26c3caf63f36b13436592c6c357edb8ade843cf3", "html_url": "https://github.com/ronancpl/HeavenMS/commit/26c3caf63f36b13436592c6c357edb8ade843cf3"}], "stats": {"total": 30, "additions": 24, "deletions": 6}, "files": [{"sha": "9325b077398bf8cad23fa8a549d159a6eb1969ec", "filename": "src/constants/ServerConstants.java", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/090aea9891e0bc60922e84c403a9814c24352433/src/constants/ServerConstants.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/090aea9891e0bc60922e84c403a9814c24352433/src/constants/ServerConstants.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/constants/ServerConstants.java?ref=090aea9891e0bc60922e84c403a9814c24352433", "patch": "@@ -32,10 +32,12 @@\n     public static final boolean USE_PARTY_SEARCH = false;\n     public static final boolean USE_AUTOBAN = false;            //commands the server to detect infractors automatically.\n     public static final boolean USE_ANOTHER_AUTOASSIGN = true;  //based on distributing AP accordingly with higher secondary stat on equipments.\n+    public static final boolean USE_REFRESH_RANK_MOVE = true;\n     \n     public static final int MAX_AP = 999;\n     public static final long BLOCK_DUEY_RACE_COND = (long)(0.5 * 1000);\n-    public static final long PET_LOOT_UPON_ATTACK = (long)(0.8 * 1000);    //time the pet must wait before trying to pick items up.\n+    public static final long PET_LOOT_UPON_ATTACK = (long)(0.7 * 1000);            //time the pet must wait before trying to pick items up.\n+    \n     //Some Gameplay Enhancing Configurations\n     public static final boolean USE_PERFECT_SCROLLING = true;   //scrolls doesn't use slots upon failure.\n     public static final boolean USE_ENHANCED_CHSCROLL = true;   //equips even more powerful with chaos upgrade"}, {"sha": "ee9a00b550569322a0b6b913e09e65e9bcae6ab4", "filename": "src/net/server/RankingWorker.java", "status": "modified", "additions": 17, "deletions": 1, "changes": 18, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/090aea9891e0bc60922e84c403a9814c24352433/src/net/server/RankingWorker.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/090aea9891e0bc60922e84c403a9814c24352433/src/net/server/RankingWorker.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/RankingWorker.java?ref=090aea9891e0bc60922e84c403a9814c24352433", "patch": "@@ -27,6 +27,7 @@\n import java.sql.SQLException;\n import client.MapleJob;\n import tools.DatabaseConnection;\n+import constants.ServerConstants;\n \n /**\n  * @author Matze\n@@ -35,11 +36,17 @@\n public class RankingWorker implements Runnable {\n     private Connection con;\n     private long lastUpdate = System.currentTimeMillis();\n-\n+    \n     public void run() {\n         try {\n             con = DatabaseConnection.getConnection();\n             con.setAutoCommit(false);\n+            \n+            if(ServerConstants.USE_REFRESH_RANK_MOVE == true) {\n+                resetMoveRank(true);\n+                resetMoveRank(false);\n+            }\n+            \n             updateRanking(null);\n             for (int i = 0; i < 3; i += 2) {\n                 for (int j = 1; j < 6; j++) {\n@@ -50,13 +57,22 @@ public void run() {\n             con.setAutoCommit(true);\n             lastUpdate = System.currentTimeMillis();\n         } catch (SQLException ex) {\n+            ex.printStackTrace();\n+            \n             try {\n                 con.rollback();\n                 con.setAutoCommit(true);\n             } catch (SQLException ex2) {\n+                ex2.printStackTrace();\n             }\n         }\n     }\n+    \n+    private void resetMoveRank(boolean job) throws SQLException {\n+        String query = \"UPDATE characters SET \" + (job == true ? \"jobRankMove = 0\" : \"rankMove = 0\");\n+        PreparedStatement reset = con.prepareStatement(query);\n+        ResultSet rs = reset.executeQuery();\n+    }\n \n     private void updateRanking(MapleJob job) throws SQLException {\n         String sqlCharSelect = \"SELECT c.id, \" + (job != null ? \"c.jobRank, c.jobRankMove\" : \"c.rank, c.rankMove\") + \", a.lastlogin AS lastlogin, a.loggedin FROM characters AS c LEFT JOIN accounts AS a ON c.accountid = a.id WHERE c.gm = 0 \";"}, {"sha": "6a2ab57eb0731064a26d394c0e1b8a98f853bc48", "filename": "src/net/server/Server.java", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/090aea9891e0bc60922e84c403a9814c24352433/src/net/server/Server.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/090aea9891e0bc60922e84c403a9814c24352433/src/net/server/Server.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/Server.java?ref=090aea9891e0bc60922e84c403a9814c24352433", "patch": "@@ -168,11 +168,11 @@ public void run() {\n         MapleItemInformationProvider.getInstance().getAllItems();\n \n         CashItemFactory.getSpecialCashItems();\n-        System.out.println(\"Items loaded in \" + ((System.currentTimeMillis() - timeToTake) / 1000.0) + \" seconds\\r\\n\");\n+        System.out.println(\"Items loaded in \" + ((System.currentTimeMillis() - timeToTake) / 1000.0) + \" seconds\");\n         \n-\t\ttimeToTake = System.currentTimeMillis();\n-\t\tMapleQuest.loadAllQuest();\n-\t\tSystem.out.println(\"Quest loaded in \" + ((System.currentTimeMillis() - timeToTake) / 1000.0) + \" seconds\\r\\n\");\n+\ttimeToTake = System.currentTimeMillis();\n+\tMapleQuest.loadAllQuest();\n+\tSystem.out.println(\"Quest loaded in \" + ((System.currentTimeMillis() - timeToTake) / 1000.0) + \" seconds\\r\\n\");\n \t\t\n \t\t\n         try {"}]}]},
