{"fetchDate": "2019-12-19", "content": [{"sha": "939b214fb5d7108a3ddcb54a673d81dea842b844", "node_id": "MDY6Q29tbWl0NDUwODIwMjM6OTM5YjIxNGZiNWQ3MTA4YTNkZGNiNTRhNjczZDgxZGVhODQyYjg0NA==", "commit": {"author": {"name": "ronancpl", "email": "rcpl2010@gmail.com", "date": "2017-04-25T14:55:44Z"}, "committer": {"name": "ronancpl", "email": "rcpl2010@gmail.com", "date": "2017-04-25T14:55:44Z"}, "message": "New PQ: Boss Rush PQ + Ellin/PiratePQ bug fixes\n\nIntroducing Boss Rush PQ. Corrected a few issues regarding rewardings in\nPiratePQ and EllinPQ and implemented a standardized way to script PQs.", "tree": {"sha": "cc6042d759b44f8f2521a5cd397d25360d7c9cbc", "url": "https://api.github.com/repos/ronancpl/HeavenMS/git/trees/cc6042d759b44f8f2521a5cd397d25360d7c9cbc"}, "url": "https://api.github.com/repos/ronancpl/HeavenMS/git/commits/939b214fb5d7108a3ddcb54a673d81dea842b844", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/939b214fb5d7108a3ddcb54a673d81dea842b844", "html_url": "https://github.com/ronancpl/HeavenMS/commit/939b214fb5d7108a3ddcb54a673d81dea842b844", "comments_url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/939b214fb5d7108a3ddcb54a673d81dea842b844/comments", "author": {"login": "ronancpl", "id": 9257761, "node_id": "MDQ6VXNlcjkyNTc3NjE=", "avatar_url": "https://avatars2.githubusercontent.com/u/9257761?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ronancpl", "html_url": "https://github.com/ronancpl", "followers_url": "https://api.github.com/users/ronancpl/followers", "following_url": "https://api.github.com/users/ronancpl/following{/other_user}", "gists_url": "https://api.github.com/users/ronancpl/gists{/gist_id}", "starred_url": "https://api.github.com/users/ronancpl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ronancpl/subscriptions", "organizations_url": "https://api.github.com/users/ronancpl/orgs", "repos_url": "https://api.github.com/users/ronancpl/repos", "events_url": "https://api.github.com/users/ronancpl/events{/privacy}", "received_events_url": "https://api.github.com/users/ronancpl/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ronancpl", "id": 9257761, "node_id": "MDQ6VXNlcjkyNTc3NjE=", "avatar_url": "https://avatars2.githubusercontent.com/u/9257761?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ronancpl", "html_url": "https://github.com/ronancpl", "followers_url": "https://api.github.com/users/ronancpl/followers", "following_url": "https://api.github.com/users/ronancpl/following{/other_user}", "gists_url": "https://api.github.com/users/ronancpl/gists{/gist_id}", "starred_url": "https://api.github.com/users/ronancpl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ronancpl/subscriptions", "organizations_url": "https://api.github.com/users/ronancpl/orgs", "repos_url": "https://api.github.com/users/ronancpl/repos", "events_url": "https://api.github.com/users/ronancpl/events{/privacy}", "received_events_url": "https://api.github.com/users/ronancpl/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "828a8a02a2d1496722ac85c529028a33bfa134fb", "url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/828a8a02a2d1496722ac85c529028a33bfa134fb", "html_url": "https://github.com/ronancpl/HeavenMS/commit/828a8a02a2d1496722ac85c529028a33bfa134fb"}], "stats": {"total": 60726, "additions": 16104, "deletions": 44622}, "files": [{"sha": "48ad28f150a838e293103be5969bdf90761fb068", "filename": "MobBookUpdate/dist/MonsterBook.img.xml", "status": "added", "additions": 14844, "deletions": 0, "changes": 14844, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/MobBookUpdate/dist/MonsterBook.img.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/MobBookUpdate/dist/MonsterBook.img.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/MobBookUpdate/dist/MonsterBook.img.xml?ref=939b214fb5d7108a3ddcb54a673d81dea842b844"}, {"sha": "29d02c30e6cf02818421c07167c5d15940141d67", "filename": "mychanges_ptbr.txt", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/mychanges_ptbr.txt", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/mychanges_ptbr.txt", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/mychanges_ptbr.txt?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -169,4 +169,10 @@ Atualiza\n 22 Abril 2017,\n V\ufffdrias corre\ufffd\ufffdes envolvendo concorr\ufffdncias em propriedades do MapleCharacter.\n Adi\ufffd\ufffdo de constante USE_EQUIPMNT_LVLUP: d\ufffd pra nivelar qualquer equip at\ufffd o n\ufffdvel desejado.\n-Algumas corre\ufffd\ufffdes em quests no cliente e no servidor.\n\\ No newline at end of file\n+Algumas corre\ufffd\ufffdes em quests no cliente e no servidor.\n+Corre\ufffd\ufffdo de bug que gerava client stuck para Outlaw, quando chamava 2 summons e mudava de mapa.\n+\n+23 - 25 Abril 2017,\n+Introdu\ufffd\ufffdo de m\ufffdtodos que auxiliam na normaliza\ufffd\ufffdo dos scripts para PQs.\n+Nova PQ: Boss Rush PQ.\n+Corre\ufffd\ufffdo de situa\ufffd\ufffdes nas PQs Ellin e Pirate.\n\\ No newline at end of file"}, {"sha": "0e6571b23780a6bb4585858e1427dc40012df296", "filename": "nbproject/private/private.xml", "status": "modified", "additions": 17, "deletions": 6, "changes": 23, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/nbproject/private/private.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/nbproject/private/private.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/nbproject/private/private.xml?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -3,13 +3,24 @@\n     <editor-bookmarks xmlns=\"http://www.netbeans.org/ns/editor-bookmarks/2\" lastBookmarkId=\"0\"/>\n     <open-files xmlns=\"http://www.netbeans.org/ns/projectui-open-files/2\">\n         <group>\n-            <file>file:/C:/Nexon/MapleSolaxia/src/net/server/channel/handlers/BeholderHandler.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/src/client/inventory/Equip.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/src/net/server/world/MapleParty.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/src/net/server/channel/handlers/PlayerLoggedinHandler.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/src/scripting/event/EventManager.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/scripts/portal/davy_next4.js</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/src/server/maps/MapleMapObjectType.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/scripts/portal/party6_out.js</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/scripts/event/Ellin.js</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/scripts/event/PiratePQ.js</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/src/client/command/Commands.java</file>\n             <file>file:/C:/Nexon/MapleSolaxia/src/client/MapleCharacter.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/src/tools/MaplePacketCreator.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/src/constants/ServerConstants.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/scripts/portal/party6_stage.js</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/src/scripting/event/EventInstanceManager.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/src/net/server/world/MaplePartyCharacter.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/scripts/reactor/3008000.js</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/src/client/MapleJob.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/src/scripting/AbstractPlayerInteraction.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/scripts/npc/world0/9000037.js</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/scripts/npc/world0/2094002.js</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/scripts/event/BossRushPQ.js</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/scripts/npc/world0/2060009.js</file>\n             <file>file:/C:/Nexon/MapleSolaxia/src/server/maps/MapleMap.java</file>\n         </group>\n     </open-files>"}, {"sha": "55e4212563b89f4455fa7771b640ef3dc393b1e7", "filename": "scripts/event/BossRushPQ.js", "status": "added", "additions": 153, "deletions": 0, "changes": 153, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/event/BossRushPQ.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/event/BossRushPQ.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/event/BossRushPQ.js?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -0,0 +1,153 @@\n+var isPq = true;\n+var minPlayers = 1, maxPlayers = 6;\n+var minLevel = 1, maxLevel = 200;\n+var entryMap = 970030100;\n+var exitMap = 970030000;\n+var recruitMap = 970030000;\n+var clearMap = 970030000;\n+\n+function init() {\n+        em.setProperty(\"state\", \"0\");\n+\tem.setProperty(\"leader\", \"true\");\n+}\n+\n+function getEligibleParty(party) {      //selects, from the given party, the team that is allowed to attempt this event\n+        var eligible = [];\n+        var hasLeader = false;\n+        \n+        if(party.size() > 0) {\n+            var partyList = party.toArray();\n+            \n+            for(var i = 0; i < party.size(); i++) {\n+                var ch = partyList[i];\n+            \n+                if(ch.getMapId() == recruitMap && ch.getLevel() >= minLevel && ch.getLevel() <= maxLevel) {\n+                        if(ch.isLeader()) hasLeader = true;\n+                        eligible.push(ch);\n+                }\n+            }\n+        }\n+        \n+        if(!(hasLeader && eligible.length >= minPlayers && eligible.length <= maxPlayers)) eligible = [];\n+        return eligible;\n+}\n+\n+function setup(level, leaderid) {\n+        em.setProperty(\"state\", \"1\");\n+\tem.setProperty(\"leader\", \"true\");\n+        var eim = em.newInstance(\"BossRush\" + leaderid);\n+\t\n+        em.setProperty(\"level\", level);\n+        eim.startEventTimer(45 * 60000); //45 mins\n+        return eim;\n+}\n+\n+function playerEntry(eim, player) {\n+        var map = eim.getMapInstance(entryMap);\n+        player.changeMap(map, map.getPortal(0));\n+}\n+\n+function scheduledTimeout(eim) {\n+        end(eim);\n+}\n+\n+function removePlayer(eim, player) {\n+        eim.unregisterPlayer(player);\n+        player.changeMap(exitMap, 0);\n+}\n+\n+function playerExit(eim, player) {\n+        eim.unregisterPlayer(player);\n+        player.changeMap(exitMap, 0);\n+}\n+\n+function changedMap(eim, player, mapid) {\n+    if (mapid < 970030001 || mapid > 970042711) {\n+            var party = eim.getPlayers();\n+            if (eim.isLeader(player) || party.size() <= minPlayers) {\n+                    eim.unregisterPlayer(player);\n+                    end(eim);\n+            }\n+            else\n+                    eim.unregisterPlayer(player);\n+    }\n+}\n+\n+function playerDead(eim, player) {}\n+\n+function playerRevive(eim, player) { // player presses ok on the death pop up.\n+        var party = eim.getPlayers();\n+        if (eim.isLeader(player) || party.size() <= minPlayers) {\n+                eim.unregisterPlayer(player);\n+                end(eim);\n+        }\n+        else\n+                eim.unregisterPlayer(player);\n+}\n+\n+\n+function playerDisconnected(eim, player) {\n+        var party = eim.getPlayers();\n+        if (eim.isLeader(player) || party.size() <= minPlayers) {\n+                eim.unregisterPlayer(player);\n+                end(eim);\n+        }\n+        else\n+                removePlayer(eim, player);\n+}\n+\n+function leftParty(eim, player) {\n+        var party = eim.getPlayers();\n+        if (party.size() <= minPlayers)\n+                end(eim);\n+        else\n+                playerExit(eim, player);\n+}\n+\n+function disbandParty(eim) {\n+        end(eim);\n+}\n+\n+function monsterValue(eim, mobId) {\n+    return 1;\n+}\n+\n+function end(eim) {\n+    var party = eim.getPlayers();\n+    for (var i = 0; i < party.size(); i++) {\n+        playerExit(eim, party.get(i));\n+    }\n+    eim.dispose();\n+}\n+\n+function playerClear(eim, player, toMap) {\n+    eim.unregisterPlayer(player);\n+    \n+    if(toMap != null) player.changeMap(toMap);\n+    else player.changeMap(clearMap, 0);\n+}\n+\n+function complete(eim, toMap) {\n+    var party = eim.getPlayers();\n+    for (var i = 0; i < party.size(); i++) {\n+        playerClear(eim, party.get(i), toMap);\n+    }\n+    eim.dispose();\n+}\n+\n+function clearPQ(eim, toMap) {\n+    complete(eim, toMap);\n+}\n+\n+function monsterKilled(mob, eim) {}\n+\n+function allMonstersDead(eim) {}\n+\n+function cancelSchedule() {}\n+\n+function dispose(eim) {\n+    em.cancelSchedule();\n+    \n+    em.setProperty(\"state\", \"0\");\n+    em.setProperty(\"leader\", \"true\");\n+}"}, {"sha": "2dff2741b13792f43197b747586f2c9c8953d91c", "filename": "scripts/event/CWKPQ.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/event/CWKPQ.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/event/CWKPQ.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/event/CWKPQ.js?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -164,7 +164,7 @@ function playerExit(eim, player) {\n     eim.broadcastPlayerMsg(5, \"[Expedition] \" + player.getName() + \" has left the map.\");\n     eim.unregisterPlayer(player);\n \n-    if (eim.disposeIfPlayerBelow(0, 0)) {\n+    if (eim.disposeIfPlayerBelow(minPlayers, 610030010)) {\n \tem.setProperty(\"state\", \"0\");\n \t\tem.setProperty(\"leader\", \"true\");\n \t}"}, {"sha": "8da6fbe6b660a669badc5ea645aed115e6058624", "filename": "scripts/event/Ellin.js", "status": "modified", "additions": 43, "deletions": 6, "changes": 49, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/event/Ellin.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/event/Ellin.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/event/Ellin.js?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -1,15 +1,37 @@\n-importPackage(Packages.client.inventory);\n-importPackage(Packages.tools);\n-\n-var minPlayers = 2;\n+var isPq = true;\n+var minPlayers = 4, maxPlayers = 6;\n+var minLevel = 44, maxLevel = 55;\n var entryMap = 930000000;\n var exitMap = 930000800;\n+var recruitMap = 300030100;\n+var clearMap = 930000800;\n \n function init() {\n         em.setProperty(\"state\", \"0\");\n \tem.setProperty(\"leader\", \"true\");\n }\n \n+function getEligibleParty(party) {      //selects, from the given party, the team that is allowed to attempt this event\n+        var eligible = [];\n+        var hasLeader = false;\n+        \n+        if(party.size() > 0) {\n+            var partyList = party.toArray();\n+            \n+            for(var i = 0; i < party.size(); i++) {\n+                var ch = partyList[i];\n+            \n+                if(ch.getMapId() == recruitMap && ch.getLevel() >= minLevel && ch.getLevel() <= maxLevel && ch.getJob().getId() / 1000 == 0) {  //only adventurers\n+                        if(ch.isLeader()) hasLeader = true;\n+                        eligible.push(ch);\n+                }\n+            }\n+        }\n+        \n+        if(!(hasLeader && eligible.length >= minPlayers && eligible.length <= maxPlayers)) eligible = [];\n+        return eligible;\n+}\n+\n function setup(level, leaderid) {\n         em.setProperty(\"state\", \"1\");\n \tem.setProperty(\"leader\", \"true\");\n@@ -119,8 +141,23 @@ function end(eim) {\n     eim.dispose();\n }\n \n-function clearPQ(eim) {\n-    end(eim);\n+function playerClear(eim, player, toMap) {\n+    eim.unregisterPlayer(player);\n+    \n+    if(toMap != null) player.changeMap(toMap);\n+    else player.changeMap(clearMap, 0);\n+}\n+\n+function complete(eim, toMap) {\n+    var party = eim.getPlayers();\n+    for (var i = 0; i < party.size(); i++) {\n+        playerClear(eim, party.get(i), toMap);\n+    }\n+    eim.dispose();\n+}\n+\n+function clearPQ(eim, toMap) {\n+    complete(eim, toMap);\n }\n \n function monsterKilled(mob, eim) {}"}, {"sha": "2f8c31abf6a7a4d6e94c7eee05cf0887560d5306", "filename": "scripts/event/PiratePQ.js", "status": "modified", "additions": 44, "deletions": 4, "changes": 48, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/event/PiratePQ.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/event/PiratePQ.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/event/PiratePQ.js?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -1,13 +1,37 @@\n var isPq = true;\n-var minPlayers = 1;\n+var minPlayers = 3, maxPlayers = 6;\n+var minLevel = 55, maxLevel = 100;\n var entryMap = 925100000;\n var exitMap = 925100700;\n+var recruitMap = 251010404;\n+var clearMap = 925100600;\n \n function init() {\n         em.setProperty(\"state\", \"0\");\n \tem.setProperty(\"leader\", \"true\");\n }\n \n+function getEligibleParty(party) {      //selects, from the given party, the team that is allowed to attempt this event\n+        var eligible = [];\n+        var hasLeader = false;\n+        \n+        if(party.size() > 0) {\n+            var partyList = party.toArray();\n+            \n+            for(var i = 0; i < party.size(); i++) {\n+                var ch = partyList[i];\n+            \n+                if(ch.getMapId() == recruitMap && ch.getLevel() >= minLevel && ch.getLevel() <= maxLevel) {\n+                        if(ch.isLeader()) hasLeader = true;\n+                        eligible.push(ch);\n+                }\n+            }\n+        }\n+        \n+        if(!(hasLeader && eligible.length >= minPlayers && eligible.length <= maxPlayers)) eligible = [];\n+        return eligible;\n+}\n+\n function setup(level, leaderid) {\n         em.setProperty(\"state\", \"1\");\n \tem.setProperty(\"leader\", \"true\");\n@@ -119,7 +143,7 @@ function changedMap(eim, player, mapid) {\n     if (mapid < 925100000 || mapid > 925100500) {\n \teim.unregisterPlayer(player);\n \n-\tif (eim.disposeIfPlayerBelow(0, 0)) {\n+\tif (eim.disposeIfPlayerBelow(minPlayers, exitMap)) {\n \t\tem.setProperty(\"state\", \"0\");\n \t\tem.setProperty(\"leader\", \"true\");\n \t}\n@@ -129,6 +153,7 @@ function changedMap(eim, player, mapid) {\n function playerDead(eim, player) {}\n \n function playerRevive(eim, player) { // player presses ok on the death pop up.\n+    var party = eim.getPlayers();\n     if (eim.isLeader(player) || party.size() <= minPlayers) { // Check for party leader\n         var party = eim.getPlayers();\n         for (var i = 0; i < party.size(); i++)\n@@ -188,8 +213,23 @@ function end(eim) {\n     eim.dispose();\n }\n \n-function clearPQ(eim) {\n-    end(eim);\n+function playerClear(eim, player, toMap) {\n+    eim.unregisterPlayer(player);\n+    \n+    if(toMap != null) player.changeMap(toMap);\n+    else player.changeMap(clearMap, 0);\n+}\n+\n+function complete(eim, toMap) {\n+    var party = eim.getPlayers();\n+    for (var i = 0; i < party.size(); i++) {\n+        playerClear(eim, party.get(i), toMap);\n+    }\n+    eim.dispose();\n+}\n+\n+function clearPQ(eim, toMap) {\n+    complete(eim, toMap);\n }\n \n function monsterKilled(mob, eim) {}"}, {"sha": "c02ce36be4fe73f68faf3b15d3730ec8236c7e42", "filename": "scripts/event/s4aWorld.js", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/event/s4aWorld.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/event/s4aWorld.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/event/s4aWorld.js?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -2,6 +2,8 @@\n  * 4th Job Snipe / Concentration\n  */\n \n+var minPlayers = 1;\n+\n function init() {\n     em.setProperty(\"started\", \"false\");\n }\n@@ -42,7 +44,7 @@ function changedMap(eim, player, mapid) {\n     if (mapid != 910500000) {\n \teim.unregisterPlayer(player);\n \n-\tif (eim.disposeIfPlayerBelow(0, 0)) {\n+\tif (eim.disposeIfPlayerBelow(minPlayers, 105090200)) {\n \t    em.setProperty(\"started\", \"false\");\n \t}\n     }"}, {"sha": "b6192327ac74e582a4c06d10ad12512ab804f137", "filename": "scripts/map/onUserEnter/108010101.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/map/onUserEnter/108010101.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/map/onUserEnter/108010101.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/map/onUserEnter/108010101.js?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -19,5 +19,5 @@ function spawnMob(x, y, id, map) {\n \t\treturn;\n \t\t\n \tvar mob = MapleLifeFactory.getMonster(id);\n-\tmap.spawnMonsterOnGroudBelow(mob, new java.awt.Point(x, y));\n+\tmap.spawnMonsterOnGroundBelow(mob, new java.awt.Point(x, y));\n }\n\\ No newline at end of file"}, {"sha": "b6192327ac74e582a4c06d10ad12512ab804f137", "filename": "scripts/map/onUserEnter/108010201.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/map/onUserEnter/108010201.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/map/onUserEnter/108010201.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/map/onUserEnter/108010201.js?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -19,5 +19,5 @@ function spawnMob(x, y, id, map) {\n \t\treturn;\n \t\t\n \tvar mob = MapleLifeFactory.getMonster(id);\n-\tmap.spawnMonsterOnGroudBelow(mob, new java.awt.Point(x, y));\n+\tmap.spawnMonsterOnGroundBelow(mob, new java.awt.Point(x, y));\n }\n\\ No newline at end of file"}, {"sha": "b6192327ac74e582a4c06d10ad12512ab804f137", "filename": "scripts/map/onUserEnter/108010301.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/map/onUserEnter/108010301.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/map/onUserEnter/108010301.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/map/onUserEnter/108010301.js?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -19,5 +19,5 @@ function spawnMob(x, y, id, map) {\n \t\treturn;\n \t\t\n \tvar mob = MapleLifeFactory.getMonster(id);\n-\tmap.spawnMonsterOnGroudBelow(mob, new java.awt.Point(x, y));\n+\tmap.spawnMonsterOnGroundBelow(mob, new java.awt.Point(x, y));\n }\n\\ No newline at end of file"}, {"sha": "b6192327ac74e582a4c06d10ad12512ab804f137", "filename": "scripts/map/onUserEnter/108010401.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/map/onUserEnter/108010401.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/map/onUserEnter/108010401.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/map/onUserEnter/108010401.js?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -19,5 +19,5 @@ function spawnMob(x, y, id, map) {\n \t\treturn;\n \t\t\n \tvar mob = MapleLifeFactory.getMonster(id);\n-\tmap.spawnMonsterOnGroudBelow(mob, new java.awt.Point(x, y));\n+\tmap.spawnMonsterOnGroundBelow(mob, new java.awt.Point(x, y));\n }\n\\ No newline at end of file"}, {"sha": "b6192327ac74e582a4c06d10ad12512ab804f137", "filename": "scripts/map/onUserEnter/108010501.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/map/onUserEnter/108010501.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/map/onUserEnter/108010501.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/map/onUserEnter/108010501.js?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -19,5 +19,5 @@ function spawnMob(x, y, id, map) {\n \t\treturn;\n \t\t\n \tvar mob = MapleLifeFactory.getMonster(id);\n-\tmap.spawnMonsterOnGroudBelow(mob, new java.awt.Point(x, y));\n+\tmap.spawnMonsterOnGroundBelow(mob, new java.awt.Point(x, y));\n }\n\\ No newline at end of file"}, {"sha": "e0a1df5874e98c7bafa8eb1b4ad27a4909deaaf6", "filename": "scripts/map/onUserEnter/677000009.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/map/onUserEnter/677000009.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/map/onUserEnter/677000009.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/map/onUserEnter/677000009.js?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -9,5 +9,5 @@ function spawnMob(x, y, id, map) {\n \t\treturn;\n \t\t\n \tvar mob = MapleLifeFactory.getMonster(id);\n-\tmap.spawnMonsterOnGroudBelow(mob, new java.awt.Point(x, y));\n+\tmap.spawnMonsterOnGroundBelow(mob, new java.awt.Point(x, y));\n }\n\\ No newline at end of file"}, {"sha": "52aca938513bc966919b5165120fcfc96c0dae27", "filename": "scripts/npc/world0/2094000.js", "status": "modified", "additions": 61, "deletions": 86, "changes": 147, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/npc/world0/2094000.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/npc/world0/2094000.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/world0/2094000.js?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -1,99 +1,74 @@\n-/*\n-\tThis file is part of the OdinMS Maple Story Server\n-    Copyright (C) 2008 Patrick Huy <patrick.huy@frz.cc> \n-                       Matthias Butz <matze@odinms.de>\n-                       Jan Christian Meyer <vimes@odinms.de>\n-\n-    This program is free software: you can redistribute it and/or modify\n-    it under the terms of the GNU Affero General Public License version 3\n-    as published by the Free Software Foundation. You may not use, modify\n-    or distribute this program under any other version of the\n-    GNU Affero General Public License.\n-\n-    This program is distributed in the hope that it will be useful,\n-    but WITHOUT ANY WARRANTY; without even the implied warranty of\n-    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n-    GNU Affero General Public License for more details.\n-\n-    You should have received a copy of the GNU Affero General Public License\n-    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+/**\n+ * @author: Ronan\n+ * @npc: Guon\n+ * @map: 251010404 - Over the Pirate Ship\n+ * @func: Pirate PQ\n */\n \n var status = 0;\n-var minLevel = 55;\n-var maxLevel = 100;\n-var minPlayers = 2;\n-var maxPlayers = 6;\n+var minLevel = 1;\n+var maxLevel = 200;\n+var minPartySize = 1;\n+var maxPartySize = 6;\n \n function start() {\n-    status = -1;\n-    action(1, 0, 0);\n+\tstatus = -1;\n+\taction(1, 0, 0);\n }\n \n function action(mode, type, selection) {\n-    if (mode == -1) {\n-        cm.dispose();\n-    } else {\n-        if (mode == 0 && status == 0) {\n-            cm.dispose();\n-            return;\n-        }\n-        if (mode == 1)\n-            status++;\n-        else\n-            status--;\n-        if (status == 0) {\n-            if (cm.getParty() == null) {\n-                cm.sendOk(\"Please come back to me after you've formed a party.\");\n-                cm.dispose();\n-                return;\n-            }\n-            if (!cm.isLeader()) {\n-                cm.sendSimple(\"You are not the party leader.\");\n+        if (mode == -1) {\n                 cm.dispose();\n-            } else {\n-                var party = cm.getParty().getMembers();\n-                var mapId = cm.getPlayer().getMapId();\n-                var next = true;\n-                var levelValid = 0;\n-                var inMap = 0;\n-                if (party.size() < minPlayers || party.size() > maxPlayers)\n-                    next = false;\n-                else {\n-                    for (var i = 0; i < party.size() && next; i++) {\n-                        if ((party.get(i).getLevel() >= minLevel) && (party.get(i).getLevel() <= maxLevel)) {\n-                            levelValid += 1;\n-\n-                            if (party.get(i).getMapId() == mapId)\n-                                inMap += 1;\n-\t\t\t}\n-                    }\n-                    if (levelValid < minPlayers || inMap < minPlayers)\n-                        next = false;\n-                }\n-                if (next) {\n-                    var em = cm.getEventManager(\"PiratePQ\");\n-                    if (em == null) {\n-                        cm.sendOk(\"PiratePQ does not work.\");\n+        } else {\n+                if (mode == 0 && status == 0) {\n                         cm.dispose();\n-                    }\n-                    else {\n-                        em.startInstance(cm.getParty(),cm.getPlayer().getMap(), 1);\n-                        party = cm.getParty().getMembers();\n-                    }\n-                    cm.dispose();\n+                        return;\n                 }\n-                else {\n-                    cm.sendOk(\"Your party is not a party of 2 to 6 members between level \" + minLevel + \" and \" + maxLevel + \". Make sure all your members are present and qualified to participate in this quest.\");\n-                    cm.dispose();\n+                if (mode == 1)\n+                        status++;\n+                else\n+                        status--;\n+\n+                if (status == 0) {\n+                        cm.sendSimple(\"#b<Party Quest: Pirate PQ>#k\\r\\n\\r\\nHelp! My son has been kidnapped and is bound on the hands of the fearful #rLord Pirate#k. I need your help... Would you please assemble or join a team to save him? Have your #bparty leader#k talk to me or make yourself a party.#b\\r\\n#L0#I want to participate in the party quest.\\r\\n#L1#I want to find party members.\\r\\n#L2#I would like to hear more details.\");\n+                } else if (status == 1) {\n+                        if (selection == 0) {\n+                                if (cm.getParty() == null) {\n+                                        cm.sendOk(\"You can participate in the party quest only if you are in a party.\");\n+                                        cm.dispose();\n+                                } else if(!cm.isLeader()) {\n+                                        cm.sendOk(\"Your party leader must talk to me to start this party quest.\");\n+                                        cm.dispose();\n+                                } else {\n+                                        var em = cm.getEventManager(\"PiratePQ\");\n+                                        if(em == null) {\n+                                                cm.sendOk(\"The Pirate PQ has encountered an error.\");\n+                                                cm.dispose();\n+                                        }\n+\n+                                        var eli = em.getEligibleParty(cm.getParty());\n+                                        if(eli.size() > 0) {\n+                                                var prop = em.getProperty(\"state\");\n+                                                if (prop != null && prop.equals(\"0\")) { \n+                                                        em.startInstance(cm.getParty(), cm.getPlayer().getMap(), 1);\n+                                                        cm.dispose();\n+                                                } else {\n+                                                        cm.sendOk(\"Another party has already entered the #rParty Quest#k in this channel. Please try another channel, or wait for the current party to finish.\");\n+                                                        cm.dispose();\n+                                                }\n+                                        }\n+                                        else {\n+                                                cm.sendOk(\"You cannot start this party quest yet, because either your party is not in the range size, some of your party members are not eligible to attempt it or they are not in this map. If you're having trouble finding party members, try Party Search.\");\n+                                                cm.dispose();\n+                                        }\n+                                }\n+                        } else if (selection == 1) {\n+                                cm.sendOk(\"Try using a Super Megaphone or asking your buddies or guild to join!\");\n+                                cm.dispose();\n+                        } else {\n+                                cm.sendOk(\"#b<Party Quest: Pirate PQ>#k\\r\\nIn this PQ, your mission is to progressively make your way through the ship, taking on all pirates and baddies in your path. Reaching the #rLord Pirate#k, depending on how many great chests you opened on the stages before, the boss will reveal himself even more powerful, so stay alert. Said chests, if opened, gives many extra rewards to your crew, it's worth a shot! Good luck.\");\n+                                cm.dispose();\n+                        }\n                 }\n-            }\n         }\n-        else {\n-            cm.sendOk(\"PiratePQ does not exist.\");\n-            cm.dispose();\n-        }\n-    }\n-}\n-\t\t\t\t\t\n-\t\t\t\t\t\n+}\n\\ No newline at end of file"}, {"sha": "7451e7c764d8d5708597d2faf4e3249387a6b009", "filename": "scripts/npc/world0/2094001.js", "status": "modified", "additions": 73, "deletions": 63, "changes": 136, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/npc/world0/2094001.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/npc/world0/2094001.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/world0/2094001.js?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -28,68 +28,78 @@ function start() {\n }\n \n function action(mode, type, selection) {\n-    if (mode == 1)\n-\tstatus++;\n-    else\n-\tstatus--;\n-    if (status == 0) {\n-\tcm.removeAll(4001117);\n-\tcm.removeAll(4001120);\n-\tcm.removeAll(4001121);\n-\tcm.removeAll(4001122);\n-\tcm.sendSimple(\"#b#L0#Get me out of here.#l\\r\\n#L1#Give me Pirate Hat.#l#k\");\n-    } else if (status == 1) {\n-\tif (selection == 0) {\n-\t\tif (!cm.canHold(4001129, 1)) {\n-\t\t\tcm.sendOk(\"Please make room in ETC.\");\n-\t\t\tcm.dispose();\n-\t\t\treturn;\n-\t\t}\n-\t\tcm.gainItem(4001129, 1);\n-                cm.warp(251010404,0);\n-\t} else { //TODO JUMP\n-\t\tif (cm.haveItem(1003267, 1)) {\n-\t\t\tcm.sendOk(\"You have the best hat.\");\n-\t\t} else if (cm.haveItem(1002573, 1)) {\n-\t\t    if (cm.haveItem(4001129, 20)) {\t\n-\t\t\t\tif (cm.canHold(1003267,1)) {\n-\t\t\t\t\tcm.gainItem(1002573, -1);\n-\t\t\t\t\tcm.gainItem(4001129, -20);\n-                                        cm.gainItem(1003267,1);\n-\t\t\t\t\tcm.sendOk(\"I have given you the hat.\");\n+        if (mode == -1) {\n+                cm.dispose();\n+        } else {\n+                if (mode == 0 && status == 0) {\n+                        cm.dispose();\n+                        return;\n+                }\n+\n+                if (mode == 1)\n+                        status++;\n+                else\n+                        status--;\n+                if (status == 0) {\n+                        cm.removeAll(4001117);\n+                        cm.removeAll(4001120);\n+                        cm.removeAll(4001121);\n+                        cm.removeAll(4001122);\n+                        cm.sendSimple(\"Thank you for saving me! How can I help you?\\r\\n#b#L0#Get me out of here.\\r\\n#L1#Give me Pirate Hat.\");\n+                } else if (status == 1) {\n+                        if (selection == 0) {\n+                                if (!cm.canHold(4001129, 1)) {\n+                                        cm.sendOk(\"Please make room in ETC.\");\n+                                        cm.dispose();\n+                                        return;\n+                                }\n+                                cm.gainItem(4001129, 1);\n+                                cm.warp(251010404,0);\n+                        } else {\n+                                if (cm.haveItem(1003267, 1)) {\n+                                        cm.sendOk(\"You have the best hat.\");\n+                                } else if (cm.haveItem(1002573, 1)) {\n+                                        if (cm.haveItem(4001129, 20)) {\t\n+                                                if (cm.canHold(1003267,1)) {\n+                                                        cm.gainItem(1002573, -1);\n+                                                        cm.gainItem(4001129, -20);\n+                                                        cm.gainItem(1003267,1);\n+                                                        cm.sendOk(\"I have given you the hat.\");\n+                                                } else {\n+                                                        cm.sendOk(\"Please make room in your EQUIP inventory before receiving the hat.\");\n+                                                }\n+                                        } else {\n+                                                cm.sendOk(\"You need 20 #t4001129# to get the next hat.\");\n+                                        }\n+                                } else if (cm.haveItem(1002572, 1)) {\n+                                        if (cm.haveItem(4001129, 20)) {\n+                                                if (cm.canHold(1002573,1)) {\n+                                                        cm.gainItem(1002572, -1);\n+                                                        cm.gainItem(4001129, -20);\n+                                                        cm.gainItem(1002573,1);\n+                                                        cm.sendOk(\"I have given you the hat.\");\n+                                                } else {\n+                                                        cm.sendOk(\"Please make room in your EQUIP inventory before receiving the hat.\");\n+                                                }\n+                                        } else {\n+                                                cm.sendOk(\"You need 20 #t4001129# to get the next hat.\");\n+                                        }\n                                 } else {\n-\t\t\t\t\tcm.sendOk(\"Please make room.\");\n-                                } \n-\t\t    } else {\n-\t\t\t\tcm.sendOk(\"You need 20 #t4001129# to get the next hat.\");\n-\t\t    }\n-\t\t} else if (cm.haveItem(1002572, 1)) {\n-\t\t    if (cm.haveItem(4001129, 20)) {\t\n-\t\t\t\tif (cm.canHold(1002573,1)) {\n-\t\t\t\t\tcm.gainItem(1002572, -1);\n-\t\t\t\t\tcm.gainItem(4001129, -20);\n-\t\t    \t    cm.gainItem(1002573,1);\n-\t\t\t\t\tcm.sendOk(\"I have given you the hat.\");\n-\t\t    \t} else {\n-\t\t\t\t\tcm.sendOk(\"Please make room.\");\n-\t\t        } \n-\t\t    } else {\n-\t\t\t\tcm.sendOk(\"You need 20 #t4001129# to get the next hat.\");\n-\t\t    }\n-\t\t} else {\n-\t\t    if (cm.haveItem(4001129, 20)) {\t\n-\t\t\t\tif (cm.canHold(1002572,1)) {\n-\t\t\t\t\tcm.gainItem(4001129, -20);\n-\t\t    \t    cm.gainItem(1002572,1);\n-\t\t\t\t\tcm.sendOk(\"I have given you the hat.\");\n-\t\t    \t} else {\n-\t\t\t\t\tcm.sendOk(\"Please make room.\");\n-\t\t        } \n-\t\t    } else {\n-\t\t\t\tcm.sendOk(\"You need 20 #t4001129# to get the next hat.\");\n-\t\t    }\n-\t\t}\n-\t}\n-\tcm.dispose();\n-    }\n+                                        if (cm.haveItem(4001129, 20)) {\t\n+                                                if (cm.canHold(1002572,1)) {\n+                                                        cm.gainItem(4001129, -20);\n+                                                        cm.gainItem(1002572,1);\n+                                                        cm.sendOk(\"I have given you the hat.\");\n+                                                } else {\n+                                                        cm.sendOk(\"Please make room in your EQUIP inventory before receiving the hat.\");\n+                                                }\n+                                        } else {\n+                                                cm.sendOk(\"You need 20 #t4001129# to get the next hat.\");\n+                                        }\n+                                }\n+                        }\n+\n+                        cm.dispose();\n+                }\n+        }\n }"}, {"sha": "20e86f82ae3a2567b358837b1de98beab81e9585", "filename": "scripts/npc/world0/2094002.js", "status": "modified", "additions": 38, "deletions": 38, "changes": 76, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/npc/world0/2094002.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/npc/world0/2094002.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/world0/2094002.js?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -35,16 +35,16 @@ function action(mode, type, selection) {\n     }\n     switch(cm.getPlayer().getMapId()) {\n \tcase 925100000:\n-\t   cm.sendNext(\"We are heading into the Pirate Ship now! To get in, we must destroy all the monsters guarding it.\");\n-\t   cm.dispose();\n-\t   break;\n+\t    cm.sendNext(\"We are heading into the Pirate Ship now! To get in, we must destroy all the monsters guarding it.\");\n+\t    cm.dispose();\n+\t    break;\n \tcase 925100100:\n-\t   var emp = em.getProperty(\"stage2\");\n-\t   if (emp == null) {\n+\t    var emp = em.getProperty(\"stage2\");\n+\t    if (emp == null) {\n \t\tem.setProperty(\"stage2\", \"0\");\n \t\temp = \"0\";\n-\t   }\n-\t   if (emp.equals(\"0\")) {\n+\t    }\n+\t    if (emp.equals(\"0\")) {\n \t\tif (cm.haveItem(4001120,20)) {\n \t\t    cm.sendNext(\"Excellent! Now hunt me 20 Rising Medals.\");\n \t\t    cm.gainItem(4001120,-20);\n@@ -54,7 +54,7 @@ function action(mode, type, selection) {\n \t   \t    cm.sendNext(\"We are heading into the Pirate Ship now! To get in, we must qualify ourselves as noble pirates. Hunt me 20 Rookie Medals.\");\n                     if(cm.countMonster() < 1) cm.getPlayer().getMap().spawnAllMonsterIdFromMapSpawnList(9300114, level, true);\n \t\t}\n-\t   } else if (emp.equals(\"1\")) {\n+\t    } else if (emp.equals(\"1\")) {\n \t\tif (cm.haveItem(4001121,20)) {\n \t\t    cm.sendNext(\"Excellent! Now hunt me 20 Veteran Medals.\");\n \t\t    cm.gainItem(4001121,-20);\n@@ -64,7 +64,7 @@ function action(mode, type, selection) {\n \t   \t    cm.sendNext(\"We are heading into the Pirate Ship now! To get in, we must qualify ourselves as noble pirates. Hunt me 20 Rising Medals.\");\n                     if(cm.countMonster() < 1) cm.getPlayer().getMap().spawnAllMonsterIdFromMapSpawnList(9300115, level, true);\n \t\t}\n-\t   } else if (emp.equals(\"2\")) {\n+\t    } else if (emp.equals(\"2\")) {\n \t\tif (cm.haveItem(4001122,20)) {\n \t\t    cm.sendNext(\"Excellent! Now let us go.\");\n \t\t    cm.gainItem(4001122,-20);\n@@ -74,56 +74,56 @@ function action(mode, type, selection) {\n \t   \t    cm.sendNext(\"We are heading into the Pirate Ship now! To get in, we must qualify ourselves as noble pirates. Hunt me 20 Veteran Medals.\");\n                     if(cm.countMonster() < 1) cm.getPlayer().getMap().spawnAllMonsterIdFromMapSpawnList(9300116, level, true);\n \t\t}\n-\t   } else {\n+\t    } else {\n \t\tcm.sendNext(\"The next stage has opened. GO!\");\n-\t   }\n-\t   cm.dispose();\n-\t   break;\n+\t    }\n+\t    cm.dispose();\n+\t    break;\n \tcase 925100200:\n         case 925100300:\n-\t   cm.sendNext(\"To assault the pirate ship, we must destroy the guards first.\");\n-\t   cm.dispose();\n-\t   break;\n+\t    cm.sendNext(\"To assault the pirate ship, we must destroy the guards first.\");\n+\t    cm.dispose();\n+\t    break;\n \tcase 925100201:\n-\t   if (cm.getMap().getMonsters().size() == 0) {\n+\t    if (cm.getMap().getMonsters().size() == 0) {\n \t\tcm.sendNext(\"Excellent.\");\n \t\tif (em.getProperty(\"stage2a\") == \"0\") {\n \t\t    cm.getMap().setReactorState();\n \t\t    em.setProperty(\"stage2a\", \"1\");\n \t\t}\n-\t   } else {\n+\t    } else {\n \t   \tcm.sendNext(\"These bellflowers are in hiding. We must liberate them.\");\n-\t   }\n-\t   cm.dispose();\n-\t   break;\n+\t    }\n+\t    cm.dispose();\n+\t    break;\n \tcase 925100301:\n-\t   if (cm.getMap().getMonsters().size() == 0) {\n+\t    if (cm.getMap().getMonsters().size() == 0) {\n \t\tcm.sendNext(\"Excellent.\");\n \t\tif (em.getProperty(\"stage3a\").equals(\"0\")) {\n \t\t    cm.getMap().setReactorState();\n \t\t    em.setProperty(\"stage3a\", \"1\");\n \t\t}\n-\t   } else {\n+\t    } else {\n \t   \tcm.sendNext(\"These bellflowers are in hiding. We must liberate them.\");\n-\t   }\n-\t   cm.dispose();\n-\t   break;\n+\t    }\n+\t    cm.dispose();\n+\t    break;\n \tcase 925100202:\n \tcase 925100302:\n-\t   cm.sendNext(\"These are the Captains and Krus which devote their whole life to Lord Pirate. Kill them as you see fit.\");\n-\t   cm.dispose();\n-\t   break;\n+\t    cm.sendNext(\"These are the Captains and Krus which devote their whole life to Lord Pirate. Kill them as you see fit.\");\n+\t    cm.dispose();\n+\t    break;\n \tcase 925100400:\n-\t   cm.sendNext(\"These are the sources of the ship's power. We must seal it by using the Old Metal Keys on the doors!\");\n-\t   cm.dispose();\n-\t   break;\n+\t    cm.sendNext(\"These are the sources of the ship's power. We must seal it by using the Old Metal Keys on the doors!\");\n+\t    cm.dispose();\n+\t    break;\n \tcase 925100500:\n-\t   if (cm.getMap().getMonsters().size() == 0) {\n-\t\tcm.warpParty(925100600);\n-\t   } else {\n+\t    if (cm.getMap().getMonsters().size() == 0) {\n+\t\tcm.clearPQ(925100600);\n+\t    } else {\n \t   \tcm.sendNext(\"Defeat all monsters! Even Lord Pirate's minions!\");\n-\t   }\n-\t   cm.dispose();\n-\t   break;\n+\t    }\n+\t    cm.dispose();\n+\t    break;\n     }\n }\n\\ No newline at end of file"}, {"sha": "6741f6bb3fd68c3d9d15840961b4b78aec36b9e6", "filename": "scripts/npc/world0/2133000.js", "status": "modified", "additions": 101, "deletions": 70, "changes": 171, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/npc/world0/2133000.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/npc/world0/2133000.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/world0/2133000.js?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -1,77 +1,108 @@\n-var status = -1;\n-var minPlayers = 0;\n+/**\n+ * @author: Ronan\n+ * @npc: Ellin\n+ * @map: 300030100 - Deep Fairy Forest\n+ * @func: Ellin PQ\n+*/\n \n-var minLevel = 44, maxLevel = 170;\n+var status = 0;\n+var minLevel = 1;\n+var maxLevel = 200;\n+var minPartySize = 1;\n+var maxPartySize = 6;\n \n function start() {\n-    action(1,0,0);\n+\tstatus = -1;\n+\taction(1, 0, 0);\n }\n \n function action(mode, type, selection) {\n-    if (mode == 1) {\n-\tstatus++;\n-    } else {\n-\tif (status == 0) {\n-\t    cm.dispose();\n-\t}\n-\tstatus--;\n-    }\n-    if (status == 0) {\n-\tcm.sendSimple(\"#b#L0#Give me Altaire Earrings.#l\\r\\n#L1#Give me Glittering Altaire Earrings.#l\\r\\n#L3#Give me Brilliant Altaire Earrings.#l\\r\\n#L2#Attempt Forest of Poison Haze.#l#k\");\n-    } else if (status == 1) {\n-\tif (selection == 0) {\n-\t    if (!cm.haveItem(1032060) && cm.haveItem(4001198, 10)) {\n-\t\tcm.gainItem(1032060,1);\n-\t\tcm.gainItem(4001198, -10);\n-\t    } else {\n-\t\tcm.sendOk(\"You either have Altair Earrings already or you do not have 10 Altair Fragments\");\n-\t    }\n-\t} else if (selection == 1){\n-\t    if (cm.haveItem(1032060) && !cm.haveItem(1032061) && cm.haveItem(4001198, 10)) {\n-\t\tcm.gainItem(1032060,-1);\n-\t\tcm.gainItem(1032061, 1);\n-\t\tcm.gainItem(4001198, -10);\n-\t    } else {\n-\t\tcm.sendOk(\"You either don't have Altair Earrings already or you do not have 10 Altair Fragments\");\n-\t    }\n-\t} else if (selection == 1){\n-\t    if (cm.haveItem(1032061) && !cm.haveItem(1032101) && cm.haveItem(4001198, 10)) {\n-\t\tcm.gainItem(1032061,-1);\n-\t\tcm.gainItem(1032101, 1);\n-\t\tcm.gainItem(4001198, -10);\n-\t    } else {\n-\t\tcm.sendOk(\"You either don't have Glittering Altair Earrings already or you do not have 10 Altair Fragments\");\n-\t    }\n-\t} else if (selection == 2) {\n-\t    if (cm.getPlayer().getParty() == null || !cm.isLeader()) {\n-\t\tcm.sendOk(\"The leader of the party must be here.\");\n-\t    } else {\n-\t\tvar party = cm.getPlayer().getParty().getMembers();\n-\t\tvar mapId = cm.getPlayer().getMapId();\n-\t\tvar next = true;\n-\t\tvar size = 0;\n-\t\tvar it = party.iterator();\n-\t\twhile (it.hasNext()) {\n-\t\t\tvar cPlayer = it.next();\n-\t\t\tvar ccPlayer = cm.getPlayer().getMap().getCharacterById(cPlayer.getId());\n-\t\t\tif (ccPlayer == null || ccPlayer.getLevel() < minLevel || ccPlayer.getLevel() > maxLevel) {\n-\t\t\t\tnext = false;\n-\t\t\t\tbreak;\n-\t\t\t}\n-\t\t\tsize += (ccPlayer.isGM() ? 4 : 1);\n-\t\t}\t\n-\t\tif (next && size >= minPlayers) {\n-\t\t\tvar em = cm.getEventManager(\"Ellin\");\n-\t\t\tif (em == null) {\n-\t\t\t\tcm.sendOk(\"Please try again later.\");\n-\t\t\t} else {\n-\t\t\t\tem.startInstance(cm.getPlayer().getParty(), cm.getPlayer().getMap(), 1);    //common level only\n-\t\t\t}\n-\t\t} else {\n-\t\t\tcm.sendOk(\"All 2+ members of your party must be here and between level \" + minLevel + \" and \" + maxLevel + \".\");\n-\t\t}\n-\t    }\n-\t}\n-\tcm.dispose();\n-    }\n+        if (mode == -1) {\n+                cm.dispose();\n+        } else {\n+                if (mode == 0 && status == 0) {\n+                        cm.dispose();\n+                        return;\n+                }\n+                if (mode == 1)\n+                        status++;\n+                else\n+                        status--;\n+\n+                if (status == 0) {\n+                        cm.sendSimple(\"#b<Party Quest: Ellin PQ>#k\\r\\n\\r\\nWould you like to assemble or join a team to solve the puzzles of the #bForest of Poison Haze#k? Have your #bparty leader#k talk to me or make yourself a party.#b\\r\\n#L0#I want to participate in the party quest.\\r\\n#L1#I want to find party members.\\r\\n#L2#I would like to hear more details.\\r\\n#L3#I would like to reclaim a prize.\");\n+                } else if (status == 1) {\n+                        if (selection == 0) {\n+                                if (cm.getParty() == null) {\n+                                        cm.sendOk(\"You can participate in the party quest only if you are in a party.\");\n+                                        cm.dispose();\n+                                } else if(!cm.isLeader()) {\n+                                        cm.sendOk(\"Your party leader must talk to me to start this party quest.\");\n+                                        cm.dispose();\n+                                } else {\n+                                        var em = cm.getEventManager(\"Ellin\");\n+                                        if(em == null) {\n+                                                cm.sendOk(\"The Ellin PQ has encountered an error.\");\n+                                                cm.dispose();\n+                                        }\n+\n+                                        var eli = em.getEligibleParty(cm.getParty());\n+                                        if(eli.size() > 0) {\n+                                                var prop = em.getProperty(\"state\");\n+                                                if (prop != null && prop.equals(\"0\")) { \n+                                                        em.startInstance(cm.getParty(), cm.getPlayer().getMap(), 1);\n+                                                        cm.dispose();\n+                                                } else {\n+                                                        cm.sendOk(\"Another party has already entered the #rParty Quest#k in this channel. Please try another channel, or wait for the current party to finish.\");\n+                                                        cm.dispose();\n+                                                }\n+                                        }\n+                                        else {\n+                                                cm.sendOk(\"You cannot start this party quest yet, because either your party is not in the range size, some of your party members are not eligible to attempt it or they are not in this map. If you're having trouble finding party members, try Party Search.\");\n+                                                cm.dispose();\n+                                        }\n+                                }\n+                        } else if (selection == 1) {\n+                                cm.sendOk(\"Try using a Super Megaphone or asking your buddies or guild to join!\");\n+                                cm.dispose();\n+                        } else if (selection == 2) {\n+                                cm.sendOk(\"#b<Party Quest: Ellin PQ>#k\\r\\nIn this PQ, your mission is to progressively make your way through the woods, taking on all baddies in your path, solving many puzzles you encounter and rallying yourselves to take the best of teamwork to overcome time limits and powerful creatures. Clearing the final boss, your team have a chance to obtain a marble that, #bwhen dropped by the fountain at the exit map#k, will guarantee the team extra prizes. Good luck.\");\n+                                cm.dispose();\n+                        }\n+                        else {\n+                                cm.sendSimple(\"So, what prize do you want to obtain?\\r\\n#b#L0#Give me Altaire Earrings.\\r\\n#L1#Give me Glittering Altaire Earrings.\\r\\n#L2#Give me Brilliant Altaire Earrings\");\n+                        }\n+                } else if (status == 2) {\n+                        if (selection == 0) {\n+                                if (!cm.haveItem(1032060) && cm.haveItem(4001198, 10)) {\n+                                        cm.gainItem(1032060,1);\n+                                        cm.gainItem(4001198, -10);\n+                                        cm.dispose();\n+                                } else {\n+                                        cm.sendOk(\"You either have Altair Earrings already or you do not have 10 Altair Fragments.\");\n+                                        cm.dispose();\n+                                }\n+                        } else if (selection == 1){\n+                                if (cm.haveItem(1032060) && !cm.haveItem(1032061) && cm.haveItem(4001198, 10)) {\n+                                        cm.gainItem(1032060,-1);\n+                                        cm.gainItem(1032061, 1);\n+                                        cm.gainItem(4001198, -10);\n+                                        cm.dispose();\n+                                } else {\n+                                       cm.sendOk(\"You either don't have Altair Earrings already or you do not have 10 Altair Fragments.\");\n+                                       cm.dispose();\n+                                }\n+                        } else if (selection == 2){\n+                                if (cm.haveItem(1032061) && !cm.haveItem(1032101) && cm.haveItem(4001198, 10)) {\n+                                        cm.gainItem(1032061,-1);\n+                                        cm.gainItem(1032101, 1);\n+                                        cm.gainItem(4001198, -10);\n+                                        cm.dispose();\n+                                } else {\n+                                        cm.sendOk(\"You either don't have Glittering Altair Earrings already or you do not have 10 Altair Fragments.\");\n+                                        cm.dispose();\n+                                }\n+                        }\n+                }\n+        }\n }\n\\ No newline at end of file"}, {"sha": "f5f99acd1c5450a7e032d2b566641075a39957be", "filename": "scripts/npc/world0/9000037.js", "status": "added", "additions": 87, "deletions": 0, "changes": 87, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/npc/world0/9000037.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/npc/world0/9000037.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/world0/9000037.js?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -0,0 +1,87 @@\n+/**\n+ * @author: Ronan\n+ * @npc: Agent Meow\n+ * @map: 970030000 - Hidden Street - Exclusive Training Center\n+ * @func: Boss Rush PQ\n+*/\n+\n+var status = 0;\n+var minLevel = 1;\n+var maxLevel = 200;\n+var minPartySize = 1;\n+var maxPartySize = 6;\n+var state;\n+\n+function start() {\n+\tstatus = -1;\n+        state = (cm.getMapId() >= 970030001 && cm.getMapId() <= 970042711) ? 1 : 0;\n+\taction(1, 0, 0);\n+}\n+\n+function action(mode, type, selection) {\n+        if (mode == -1) {\n+                cm.dispose();\n+        } else {\n+                if (mode == 0 && status == 0) {\n+                        cm.dispose();\n+                        return;\n+                }\n+                if (mode == 1)\n+                        status++;\n+                else\n+                        status--;\n+\n+                if (status == 0) {\n+                        if(state) {\n+                                cm.sendYesNo(\"Do you wish to abandon this event?\");\n+                        }\n+                        else {\n+                                cm.sendSimple(\"#b<Party Quest: Boss Rush>#k\\r\\n\\r\\nWould you like to collaborate with party members to complete the expedition, or are you brave enough to take it on all by yourself? Have your #bparty leader#k talk to me or make yourself a party.#b\\r\\n#L0#I want to participate in the party quest.\\r\\n#L1#I want to find party members.\\r\\n#L2#I would like to hear more details.\");\n+                        }\n+                } else if (status == 1) {\n+                        if(state) {\n+                                cm.warp(970030000);\n+                                cm.dispose();\n+                        }\n+                        else {\n+                                if (selection == 0) {\n+                                        if (cm.getParty() == null) {\n+                                                cm.sendOk(\"You can participate in the party quest only if you are in a party.\");\n+                                                cm.dispose();\n+                                        } else if(!cm.isLeader()) {\n+                                                cm.sendOk(\"Your party leader must talk to me to start this party quest.\");\n+                                                cm.dispose();\n+                                        } else {\n+                                                var em = cm.getEventManager(\"BossRushPQ\");\n+                                                if(em == null) {\n+                                                        cm.sendOk(\"The Boss Rush PQ has encountered an error.\");\n+                                                        cm.dispose();\n+                                                }\n+\n+                                                var eli = em.getEligibleParty(cm.getParty());\n+                                                if(eli.size() > 0) {\n+                                                        var prop = em.getProperty(\"state\");\n+                                                        if (prop != null && prop.equals(\"0\")) { \n+                                                                em.startInstance(cm.getParty(), cm.getPlayer().getMap(), 1);\n+                                                                cm.dispose();\n+                                                        } else {\n+                                                                cm.sendOk(\"Another party has already entered the #rParty Quest#k in this channel. Please try another channel, or wait for the current party to finish.\");\n+                                                                cm.dispose();\n+                                                        }\n+                                                }\n+                                                else {\n+                                                        cm.sendOk(\"You cannot start this party quest yet, because either your party is not in the range size, some of your party members are not eligible to attempt it or they are not in this map. If you're having trouble finding party members, try Party Search.\");\n+                                                        cm.dispose();\n+                                                }\n+                                        }\n+                                } else if (selection == 1) {\n+                                        cm.sendOk(\"Try using a Super Megaphone or asking your buddies or guild to join!\");\n+                                        cm.dispose();\n+                                } else {\n+                                        cm.sendOk(\"#b<Party Quest: Boss Rush PQ>#k\\r\\nBrave adventurers from all over the places travels here to test their skills and abilities in combat, as they face even more powerful bosses from MapleStory. Join forces with fellow adventurers or face all the burden by yourself and receive all the glory, it is up to you. REWARDS are given accordingly to how far the adventurers reach and extra prizes may are given to a random member of the party, all attributed at the end of an expedition.\");\n+                                        cm.dispose();\n+                                }\n+                        }\n+                }\n+        }\n+}\n\\ No newline at end of file"}, {"sha": "5d65b4e81af1cf3665a35ca658804b6d4b77c0f7", "filename": "scripts/npc/world0/9010021.js", "status": "added", "additions": 58, "deletions": 0, "changes": 58, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/npc/world0/9010021.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/npc/world0/9010021.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/world0/9010021.js?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -0,0 +1,58 @@\n+/*\n+\tThis file is part of the OdinMS Maple Story Server\n+    Copyright (C) 2008 Patrick Huy <patrick.huy@frz.cc>\n+\t\t       Matthias Butz <matze@odinms.de>\n+\t\t       Jan Christian Meyer <vimes@odinms.de>\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+/* 9010021 - Wolf Spirit Ryko \n+    BossRushPQ recruiter\n+    @author Ronan\n+ */\n+\n+var status;\n+ \n+function start() {\n+    status = -1;\n+    action(1, 0, 0);\n+}\n+\n+function action(mode, type, selection) {\n+    if (mode < 0)\n+        cm.dispose();\n+    else {\n+        if (mode == 1)\n+            status++;\n+        else\n+            status--;\n+        \n+        if (status == 0) {\n+            cm.sendNext(\"Heed me, human. I hail from a distant plane and came to this world to take a glimpse on the power level of the best of the dwellers of this world.\");\n+\t} else if(status == 1) {\n+            cm.sendNext(\"Oh, don't get me wrong, our civilization are of the type that makes researches for the sake of science, we have no regards for domination or disturbances whatsoever.\");\n+        } else if(status == 2) {\n+            cm.sendNext(\"These contests involve #bsequential boss fights#k, with some resting spots between some sections. This will require some strategy time and enough supplies at hand, as these are not common fights.\");\n+        } else if(status == 3) {\n+            cm.sendAcceptDecline(\"If you feel you are powerful enough, you can join others like you at where we are hosting the contests of power. ... So, what is your decision? Will you come to where the contests are being held right now?\");\n+        } else if(status == 4) {\n+            cm.sendOk(\"Very well. Remember, there you can assemble a team or take on the fightings on your own, it's up to you. Good luck!\");\n+        } else if(status == 5) {\n+            cm.warp(970030000);\n+            cm.dispose();\n+        }\n+    }\n+}\n\\ No newline at end of file"}, {"sha": "d213414d2444ca05f04561c15bc824eab930ae9a", "filename": "scripts/npc/world0/9040006.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/npc/world0/9040006.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/npc/world0/9040006.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/world0/9040006.js?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -258,5 +258,5 @@ function randX() {\n \n function spawnMob(id, x, y, map) {\n \tvar mob = Packages.server.life.MapleLifeFactory.getMonster(id);\n-\tmap.spawnMonsterOnGroudBelow(mob, new Packages.java.awt.Point(x, y));\n+\tmap.spawnMonsterOnGroundBelow(mob, new Packages.java.awt.Point(x, y));\n }\n\\ No newline at end of file"}, {"sha": "1330fcd72b138f6a0c20c1652cb9e2ecad62750c", "filename": "scripts/portal/davy_next4.js", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/portal/davy_next4.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/portal/davy_next4.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/davy_next4.js?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -15,11 +15,11 @@ function enter(pi) {\n             \n             boss.changeDifficulty(level, true);\n             \n-            pi.getMap(925100500).spawnMonster(boss);\n+            pi.getMap(925100500).spawnMonsterOnGroundBelow(boss, new java.awt.Point(777, 140));\n \t    pi.warpParty(925100500); //next\n             return(true);\n \t} else {\n-\t    pi.playerMessage(5, \"The leader must be here\");\n+\t    pi.playerMessage(5, \"The leader must be here.\");\n             return(false);\n \t}\n     } else {"}, {"sha": "f4dfd64975a875bc5dc9eb70f6fcf5261ea9c2af", "filename": "scripts/portal/enterDisguise2.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/portal/enterDisguise2.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/portal/enterDisguise2.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/enterDisguise2.js?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -42,5 +42,5 @@ function spawnMob(x, y, id, map) {\n \t\treturn;\n \t\t\n \tvar mob = MapleLifeFactory.getMonster(id);\n-\tmap.spawnMonsterOnGroudBelow(mob, new java.awt.Point(x, y));\n+\tmap.spawnMonsterOnGroundBelow(mob, new java.awt.Point(x, y));\n }\n\\ No newline at end of file"}, {"sha": "4f433d2f2808a91aa9003fa69921f79877891644", "filename": "scripts/portal/enterMCave.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/portal/enterMCave.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/portal/enterMCave.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/enterMCave.js?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -38,5 +38,5 @@ function spawnMob(x, y, id, map) {\n \t\treturn;\n \t\t\n \tvar mob = MapleLifeFactory.getMonster(id);\n-\tmap.spawnMonsterOnGroudBelow(mob, new java.awt.Point(x, y));\n+\tmap.spawnMonsterOnGroundBelow(mob, new java.awt.Point(x, y));\n }\n\\ No newline at end of file"}, {"sha": "3017233aa57661cf7bc905bb3cf12be76d754342", "filename": "scripts/portal/enterPort.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/portal/enterPort.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/portal/enterPort.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/enterPort.js?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -44,5 +44,5 @@ function spawnMob(x, y, id, map) {\n \t\treturn;\n \t\t\n \tvar mob = MapleLifeFactory.getMonster(id);\n-\tmap.spawnMonsterOnGroudBelow(mob, new java.awt.Point(x, y));\n+\tmap.spawnMonsterOnGroundBelow(mob, new java.awt.Point(x, y));\n }\n\\ No newline at end of file"}, {"sha": "d5f7228a5bbcedf7bc38a994a518cec6cfd84c8c", "filename": "scripts/portal/party6_out.js", "status": "modified", "additions": 14, "deletions": 6, "changes": 20, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/portal/party6_out.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/portal/party6_out.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/party6_out.js?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -1,9 +1,17 @@\n function enter(pi) {\n-\tif ((pi.getMap().getMonsters().size() == 0 || pi.getMap().getMonsterById(9300183) != null) && (pi.getMap().getReactorByName(\"\") == null || pi.getMap().getReactorByName(\"\").getState() == 1)) {\n-\t\tpi.warp(930000800,0);\n-                return true;\n-\t} else {\n-\t\tpi.playerMessage(5, \"Please eliminate the Poison Golem.\");\n+        if ((pi.getMap().getMonsters().size() == 0 || pi.getMap().getMonsterById(9300183) != null) && (pi.getMap().getReactorByName(\"\") == null || pi.getMap().getReactorByName(\"\").getState() == 1)) {\n+                if(pi.isLeader()) {\n+                        pi.clearPQ(930000800);\n+                        return true;\n+                }\n+                else {\n+                        pi.playerMessage(5, \"Wait for the leader to pass through the portal.\");\n+                        return false;\n+                }\n+\n+\n+        } else {\n+                pi.playerMessage(5, \"Please eliminate the Poison Golem.\");\n                 return false;\n-\t}\n+        }\n }\n\\ No newline at end of file"}, {"sha": "21226306b9e897972f1eacee6bacb1d70ff2e9fe", "filename": "scripts/portal/raid_stage.js", "status": "added", "additions": 41, "deletions": 0, "changes": 41, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/portal/raid_stage.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/portal/raid_stage.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/raid_stage.js?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -0,0 +1,41 @@\n+/*\n+\tThis file is part of the OdinMS Maple Story Server\n+    Copyright (C) 2008 Patrick Huy <patrick.huy@frz.cc> \n+                       Matthias Butz <matze@odinms.de>\n+                       Jan Christian Meyer <vimes@odinms.de>\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License version 3\n+    as published by the Free Software Foundation. You may not use, modify\n+    or distribute this program under any other version of the\n+    GNU Affero General Public License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+BossRushPQ - Next Stage\n+@author Ronan\n+*/\n+\n+function enter(pi) {\n+    if(pi.getMap().getMonsters().size() == 0) {\n+        var nextStage;\n+        \n+        if(pi.getMapId() % 5 == 0) nextStage = pi.getMapId() + 100;\n+        else nextStage = 970030001 + (pi.getMapId() - 970030100 / 500);\n+        \n+        pi.warp(nextStage);\n+        return true;\n+    }\n+    else {\n+        pi.getPlayer().dropMessage(6, \"Defeat all monsters before proceeding to the next stage.\");\n+        return false;\n+    }\n+}\n\\ No newline at end of file"}, {"sha": "8d6e82ff8e0bdb52aa9dbab2a718daf01ceeab65", "filename": "scripts/portal/raidout.js", "status": "added", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/portal/raidout.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/portal/raidout.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/raidout.js?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -0,0 +1,4 @@\n+function enter(pi) {\n+\tpi.warp(100000000,0);\n+        return true;\n+}\n\\ No newline at end of file"}, {"sha": "dcf2faf6733f450ec26ef8d18f808f8fc566ae3f", "filename": "scripts/quest/21401.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/quest/21401.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/quest/21401.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/quest/21401.js?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -74,5 +74,5 @@ function spawnMob(x, y, id, map) {\n \t\treturn;\n \t\t\n \tvar mob = MapleLifeFactory.getMonster(id);\n-\tmap.spawnMonsterOnGroudBelow(mob, new java.awt.Point(x, y));\n+\tmap.spawnMonsterOnGroundBelow(mob, new java.awt.Point(x, y));\n }\n\\ No newline at end of file"}, {"sha": "1f782bdd8e3a82f16c7834bb7815a28c5097ab19", "filename": "scripts/reactor/2512001.js", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/reactor/2512001.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/reactor/2512001.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/reactor/2512001.js?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -25,9 +25,9 @@\n  */\n  \n function act() {\n-\tvar eim = rm.getPlayer().getEventInstance();\n-\tvar now = parseInt(eim.getProperty(\"openedChests\"));\n+\tvar em = rm.getPlayer().getEventInstance().getEm();\n+\tvar now = parseInt(em.getProperty(\"openedChests\"));\n \tvar nextNum = now + 1;\n-\teim.setProperty(\"openedChests\", nextNum);\n+\tem.setProperty(\"openedChests\", nextNum.toString());\n \trm.dropItems(true, 1, 50, 100, 15);\n }\n\\ No newline at end of file"}, {"sha": "568c28a8cb64617979d0eb5ea23b77dfd3d4e6a8", "filename": "scripts/reactor/3008000.js", "status": "modified", "additions": 16, "deletions": 3, "changes": 19, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/reactor/3008000.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/reactor/3008000.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/reactor/3008000.js?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -1,3 +1,16 @@\n-function act() {\n-\trm.givePartyExp(52000, rm.getPlayer().getPartyMembers());\n-}\n\\ No newline at end of file\n+/**\n+ * @author: Ronan\n+ * @reactor: Water Fountain\n+ * @map: 930000800 - Forest of Poison Haze - Outer Forest Exit\n+ * @func: Water Fountain\n+*/\n+\n+function hit() {\n+\tvar players = rm.getMap().getAllPlayers().toArray();\n+        \n+        for(var i = 0; i < players.length; i++) {\n+                rm.giveCharacterExp(52000, players[i]);\n+        }\n+}\n+\n+function act() {} //do nothing\n\\ No newline at end of file"}, {"sha": "dba034dce147ac9c15ff2fe52f6c456cef05146d", "filename": "scripts/reactor/9108000.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/reactor/9108000.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/reactor/9108000.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/reactor/9108000.js?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -11,7 +11,7 @@ function act() {\n \t\t\trm.mapMessage(6, \"Protect the Moon Bunny!!!\");\n \t\t\tvar map = em.getMapInstance(rm.getReactor().getMap().getId());\n \t\t\tmap.allowSummonState(true);\n-\t\t\tmap.spawnMonsterOnGroudBelow(9300061, -183, -433);\n+\t\t\tmap.spawnMonsterOnGroundBelow(9300061, -183, -433);\n \t\t}\n \t}\n }\n\\ No newline at end of file"}, {"sha": "dba034dce147ac9c15ff2fe52f6c456cef05146d", "filename": "scripts/reactor/9108001.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/reactor/9108001.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/reactor/9108001.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/reactor/9108001.js?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -11,7 +11,7 @@ function act() {\n \t\t\trm.mapMessage(6, \"Protect the Moon Bunny!!!\");\n \t\t\tvar map = em.getMapInstance(rm.getReactor().getMap().getId());\n \t\t\tmap.allowSummonState(true);\n-\t\t\tmap.spawnMonsterOnGroudBelow(9300061, -183, -433);\n+\t\t\tmap.spawnMonsterOnGroundBelow(9300061, -183, -433);\n \t\t}\n \t}\n }\n\\ No newline at end of file"}, {"sha": "dba034dce147ac9c15ff2fe52f6c456cef05146d", "filename": "scripts/reactor/9108002.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/reactor/9108002.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/reactor/9108002.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/reactor/9108002.js?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -11,7 +11,7 @@ function act() {\n \t\t\trm.mapMessage(6, \"Protect the Moon Bunny!!!\");\n \t\t\tvar map = em.getMapInstance(rm.getReactor().getMap().getId());\n \t\t\tmap.allowSummonState(true);\n-\t\t\tmap.spawnMonsterOnGroudBelow(9300061, -183, -433);\n+\t\t\tmap.spawnMonsterOnGroundBelow(9300061, -183, -433);\n \t\t}\n \t}\n }\n\\ No newline at end of file"}, {"sha": "dba034dce147ac9c15ff2fe52f6c456cef05146d", "filename": "scripts/reactor/9108003.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/reactor/9108003.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/reactor/9108003.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/reactor/9108003.js?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -11,7 +11,7 @@ function act() {\n \t\t\trm.mapMessage(6, \"Protect the Moon Bunny!!!\");\n \t\t\tvar map = em.getMapInstance(rm.getReactor().getMap().getId());\n \t\t\tmap.allowSummonState(true);\n-\t\t\tmap.spawnMonsterOnGroudBelow(9300061, -183, -433);\n+\t\t\tmap.spawnMonsterOnGroundBelow(9300061, -183, -433);\n \t\t}\n \t}\n }\n\\ No newline at end of file"}, {"sha": "dba034dce147ac9c15ff2fe52f6c456cef05146d", "filename": "scripts/reactor/9108004.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/reactor/9108004.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/reactor/9108004.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/reactor/9108004.js?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -11,7 +11,7 @@ function act() {\n \t\t\trm.mapMessage(6, \"Protect the Moon Bunny!!!\");\n \t\t\tvar map = em.getMapInstance(rm.getReactor().getMap().getId());\n \t\t\tmap.allowSummonState(true);\n-\t\t\tmap.spawnMonsterOnGroudBelow(9300061, -183, -433);\n+\t\t\tmap.spawnMonsterOnGroundBelow(9300061, -183, -433);\n \t\t}\n \t}\n }\n\\ No newline at end of file"}, {"sha": "dba034dce147ac9c15ff2fe52f6c456cef05146d", "filename": "scripts/reactor/9108005.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/reactor/9108005.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/scripts/reactor/9108005.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/reactor/9108005.js?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -11,7 +11,7 @@ function act() {\n \t\t\trm.mapMessage(6, \"Protect the Moon Bunny!!!\");\n \t\t\tvar map = em.getMapInstance(rm.getReactor().getMap().getId());\n \t\t\tmap.allowSummonState(true);\n-\t\t\tmap.spawnMonsterOnGroudBelow(9300061, -183, -433);\n+\t\t\tmap.spawnMonsterOnGroundBelow(9300061, -183, -433);\n \t\t}\n \t}\n }\n\\ No newline at end of file"}, {"sha": "c17c69180defe75a7f11c73a777ef1f6b9ec6cec", "filename": "sql/db_database.sql", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/sql/db_database.sql", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/sql/db_database.sql", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/sql/db_database.sql?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -8543,7 +8543,6 @@ INSERT IGNORE INTO `temp_data` (`id`, `dropperid`, `itemid`, `minimum_quantity`,\n (8331, 8220001, 4000048, 1, 1, 0, 600000),\n (8332, 8220001, 4000049, 1, 1, 0, 600000),\n (8333, 8220001, 4000051, 1, 1, 0, 600000),\n-(8334, 8220001, 4000257, 1, 1, 0, 600000),\n (8335, 8220001, 4000021, 1, 1, 0, 500000),\n (8336, 8220001, 4004002, 1, 1, 0, 100000),\n (8337, 8220001, 4010004, 1, 1, 0, 90000),"}, {"sha": "3e68b645f16543e9a57888ec7bbfc52108c14f7c", "filename": "sql/db_drops.sql", "status": "modified", "additions": 30, "deletions": 6, "changes": 36, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/sql/db_drops.sql", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/sql/db_drops.sql", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/sql/db_drops.sql?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -6682,9 +6682,9 @@\n (4220000, 4000166, 1, 1, 0, 200000), \n (4220001, 4000166, 1, 1, 0, 200000), \n (9303014, 4000166, 1, 1, 0, 200000), \n-(4220000, 4032474, 1, 1, 0, 10000), \n-(4220001, 4032474, 1, 1, 0, 10000), \n-(9303014, 4032474, 1, 1, 0, 10000), \n+(4220000, 4032474, 1, 1, 0, 200000), \n+(4220001, 4032474, 1, 1, 0, 200000), \n+(9303014, 4032474, 1, 1, 0, 200000), \n (4220000, 2000002, 1, 4, 0, 40000), \n (4220001, 2000002, 1, 4, 0, 40000), \n (9303014, 2000002, 1, 1, 0, 40000),\n@@ -18794,11 +18794,14 @@\n (9300107, 4031551, 1, 1, 3829, 40000),\n (9300119, 4031551, 1, 1, 3829, 40000),\n (9300119, 0, 801, 1199, 0, 400000),\n-(9300173, 4001161, 1, 1, 0, 200000);\n+(9300173, 4001161, 1, 1, 0, 200000),\n+(9500355, 2388015, 1, 1, 0, 24000),\n+(9500356, 2388032, 1, 1, 0, 24000),\n+(9500357, 2388016, 1, 1, 0, 24000);\n \n # (dropperid, itemid, minqty, maxqty, questid, chance)\n \n-  # delete item drops from Seruf shell\n+  # delete item drops from Seruf in inactive form\n   DELETE FROM temp_data WHERE dropperid=4220001;\n \n   UPDATE IGNORE temp_data SET chance=700 WHERE itemid=1302056;\n@@ -18868,7 +18871,6 @@\n   UPDATE drop_data SET questid=7777 WHERE itemid=4001359;\n   UPDATE drop_data SET questid=7777 WHERE itemid=4001342;\n   UPDATE drop_data SET questid=7777 WHERE itemid=4031906;\n-  UPDATE drop_data SET questid=7777 WHERE itemid=4032474;\n   UPDATE drop_data SET chance=0 WHERE itemid=2050099;\n   UPDATE drop_data SET chance=40000 WHERE itemid=4031991;\n   UPDATE drop_data SET questid=6191 WHERE itemid=4031477;\n@@ -18879,6 +18881,16 @@\n   UPDATE IGNORE drop_data SET itemid=1402011 WHERE itemid=1302056 AND dropperid < 8000000;\n   DELETE FROM drop_data WHERE itemid=1302056 AND dropperid < 8000000;\n \n+  # remove belts dropping from mobs\n+  DELETE FROM drop_data where itemid>=1132000 and itemid<=1132004;\n+\n+  # remove key of dimension dropping outside PQ\n+  DELETE FROM drop_data where itemid=4001023 and dropperid!=9300012;\n+\n+  # remove every not-card drop from bosses out of their natural habitat\n+  DELETE FROM drop_data WHERE dropperid >= 9300184 AND dropperid < 9300215 AND (itemid < 2380000 OR itemid >= 2390000);\n+  DELETE FROM drop_data WHERE dropperid >= 9500337 AND dropperid < 9500364 AND (itemid < 2380000 OR itemid >= 2390000);\n+\n   # update quest reactor items\n   UPDATE reactordrops SET questid=2086 WHERE itemid=4031165;\n   UPDATE reactordrops SET questid=3407 WHERE itemid=4031141;\n@@ -18910,6 +18922,18 @@\n     (2512001, 4010007, 1, -1),\n     (2512001, 4020007, 1, -1),\n     (2512001, 4020008, 1, -1),\n+    (2512001, 4010004, 1, -1),\n+    (2512001, 4010005, 1, -1),\n+    (2512001, 4010006, 1, -1),\n+    (2512001, 4010007, 1, -1),\n+    (2512001, 4020007, 1, -1),\n+    (2512001, 4020008, 1, -1),\n+    (2512001, 4010004, 1, -1),\n+    (2512001, 4010005, 1, -1),\n+    (2512001, 4010006, 1, -1),\n+    (2512001, 4010007, 1, -1),\n+    (2512001, 4020007, 1, -1),\n+    (2512001, 4020008, 1, -1),\n     (2512001, 2020000, 3, -1),\n     (2512001, 2020001, 3, -1),\n     (2512001, 2020003, 3, -1),"}, {"sha": "6dfe1a01d803a708aaa85d7dc3afa6f57f4c3e36", "filename": "sql/db_originaldrops.sql", "status": "removed", "additions": 0, "deletions": 12582, "changes": 12582, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/828a8a02a2d1496722ac85c529028a33bfa134fb/sql/db_originaldrops.sql", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/828a8a02a2d1496722ac85c529028a33bfa134fb/sql/db_originaldrops.sql", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/sql/db_originaldrops.sql?ref=828a8a02a2d1496722ac85c529028a33bfa134fb"}, {"sha": "510f959eb9ac1c92befcbbd3e5a3971908506779", "filename": "sql/original/DEPRECATED-dropupdate.sql", "status": "removed", "additions": 0, "deletions": 15, "changes": 15, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/828a8a02a2d1496722ac85c529028a33bfa134fb/sql/original/DEPRECATED-dropupdate.sql", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/828a8a02a2d1496722ac85c529028a33bfa134fb/sql/original/DEPRECATED-dropupdate.sql", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/sql/original/DEPRECATED-dropupdate.sql?ref=828a8a02a2d1496722ac85c529028a33bfa134fb", "patch": "@@ -1,15 +0,0 @@\n-\ufeff#OBS.: este sql s\u00f3 dever\u00e1 ser utilizado se for descoberto falhas de listagem de dados em\n-#AMBOS O SPIDER E OS DROPS ORIGINAIS!!!\n-\n-UPDATE drop_data SET chance=10000 WHERE (itemid >= 2380000 AND itemid < 2390000) AND (chance= 1000);\n-\n-INSERT INTO `drop_data` (`dropperid`, `itemid`, `minimum_quantity`, `maximum_quantity`, `questid`, `chance`) VALUES\n-(120100, 2380002, 1, 1, 0, 10000),\n-(4230116, 2382042, 1, 1, 0, 10000),\n-(4230117, 2382055, 1, 1, 0, 10000),\n-(2230101, 4032399, 1, 1, 2251, 10000),\n-(100100, 4001352, 1, 1, 28205, 7000),\n-(100101, 4001352, 1, 1, 28205, 7000),\n-(120100, 4001352, 1, 1, 28205, 7000),\n-(130101, 4001352, 1, 1, 28205, 7000),\n-(1210100, 4001352, 1, 1, 28205, 7000);\n\\ No newline at end of file"}, {"sha": "48aed3981520e3e4eaa97f5a2051b0e05f70c1d4", "filename": "sql/original/db_drops - Copy.sql", "status": "removed", "additions": 0, "deletions": 18764, "changes": 18764, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/828a8a02a2d1496722ac85c529028a33bfa134fb/sql/original/db_drops%20-%20Copy.sql", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/828a8a02a2d1496722ac85c529028a33bfa134fb/sql/original/db_drops%20-%20Copy.sql", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/sql/original/db_drops%20-%20Copy.sql?ref=828a8a02a2d1496722ac85c529028a33bfa134fb"}, {"sha": "53889aae458d90642cc1bb49d5f07db196622dc9", "filename": "sql/original/db_originaldrops - Copy.sql", "status": "removed", "additions": 0, "deletions": 12581, "changes": 12581, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/828a8a02a2d1496722ac85c529028a33bfa134fb/sql/original/db_originaldrops%20-%20Copy.sql", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/828a8a02a2d1496722ac85c529028a33bfa134fb/sql/original/db_originaldrops%20-%20Copy.sql", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/sql/original/db_originaldrops%20-%20Copy.sql?ref=828a8a02a2d1496722ac85c529028a33bfa134fb"}, {"sha": "4296c9324b9b73e3a7787e44064d82698e8fe5cd", "filename": "sql/readme.txt", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/sql/readme.txt", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/sql/readme.txt", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/sql/readme.txt?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -1,4 +1,6 @@\n-These SQL files must be executed IN ORDER to set up:\n+---- MapleSolaxiaV2 MySQL Database ----\n+\n+These SQL files must be executed IN ORDER to set up the database:\n \t- db_database.sql\n \t- db_drops.sql\n \t- db_shopupdate.sql (optional)\n\\ No newline at end of file"}, {"sha": "9415fc4cb544d722e301c70a87e134d48b6382ac", "filename": "sql/tools/test_duplicates.sql", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/sql/tools/test_duplicates.sql", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/sql/tools/test_duplicates.sql", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/sql/tools/test_duplicates.sql?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "previous_filename": "sql/testeduplicatas.sql"}, {"sha": "00aed8651a977b071012250be8df8b30d12acec4", "filename": "sql/tools/test_mobcarddrop.sql", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/sql/tools/test_mobcarddrop.sql", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/sql/tools/test_mobcarddrop.sql", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/sql/tools/test_mobcarddrop.sql?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "previous_filename": "sql/testemobcarddrop.sql"}, {"sha": "314a09233ec98bf4cb5eb5ae8f3f32056c222c41", "filename": "src/client/MapleCharacter.java", "status": "modified", "additions": 35, "deletions": 61, "changes": 96, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/src/client/MapleCharacter.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/src/client/MapleCharacter.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/MapleCharacter.java?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -48,8 +48,6 @@\n //import java.util.TimeZone;\n import java.util.concurrent.ScheduledFuture;\n import java.util.concurrent.atomic.AtomicInteger;\n-import java.util.concurrent.locks.ReentrantLock;\n-import java.util.concurrent.locks.Lock;\n import java.util.regex.Pattern;\n \n import net.server.PlayerBuffValueHolder;\n@@ -272,13 +270,14 @@\n     private PartyQuest partyQuest = null;\n     private boolean loggedIn = false;\n     private MapleDragon dragon = null;\n-    private boolean useCS = false;  //chaos scroll upon crafting item.\n+    private boolean useCS;  //chaos scroll upon crafting item.\n     private long useDuey;\n     private long petLootCd;\n     private int newWarpMap = -1;\n-    private Lock sLock = new ReentrantLock(true);\n \n     private MapleCharacter() {\n+        useCS = false;\n+        \n         setStance(0);\n         inventory = new MapleInventory[MapleInventoryType.values().length];\n         savedLocations = new SavedLocation[SavedLocationType.values().length];\n@@ -553,14 +552,9 @@ public int addMP(MapleClient c) {\n \n         return MaxMP;\n     }\n-\n+    \n     public void addSummon(int id, MapleSummon summon) {\n-        sLock.lock();\n-        try {\n-            summons.put(id, summon);\n-        } finally {\n-            sLock.unlock();\n-        }\n+        summons.put(id, summon);\n     }\n \n     public void addVisibleMapObject(MapleMapObject mo) {\n@@ -1091,16 +1085,22 @@ protected MapleMap getWarpMap(int map) {\n \treturn target;\n     }\n     \n-    // for use ONLY inside OnUserEnter map scripts that requires players changing map even before entering it.\n+    // for use ONLY inside OnUserEnter map scripts that requires a player to change map while still moving between maps.\n     public void warpAhead(int map) {\n         newWarpMap = map;\n     }\n+    \n+    private void eventChangedMap(int map) {\n+        if (getEventInstance() != null) getEventInstance().changedMap(MapleCharacter.this, map);\n+    }\n \n     public void changeMap(int map) {\n         changeMap(map, 0);\n     }\n \n     public void changeMap(int map, int portal) {\n+        eventChangedMap(map);\n+        \n         MapleMap warpMap;\n         if (getEventInstance() != null) {\n             warpMap = getEventInstance().getMapInstance(map);\n@@ -1112,6 +1112,8 @@ public void changeMap(int map, int portal) {\n     }\n \n     public void changeMap(int map, String portal) {\n+        eventChangedMap(map);\n+        \n         MapleMap warpMap;\n         if (getEventInstance() != null) {\n             warpMap = getEventInstance().getMapInstance(map);\n@@ -1123,6 +1125,8 @@ public void changeMap(int map, String portal) {\n     }\n \n     public void changeMap(int map, MaplePortal portal) {\n+        eventChangedMap(map);\n+        \n         MapleMap warpMap;\n         if (getEventInstance() != null) {\n             warpMap = getEventInstance().getMapInstance(map);\n@@ -1369,27 +1373,22 @@ private void deregisterBuffStats(List<MapleBuffStat> stats) {\n                     } else if (stat == MapleBuffStat.SUMMON || stat == MapleBuffStat.PUPPET) {\n                         int summonId = mbsvh.effect.getSourceId();\n                         \n-                        sLock.lock();\n-                        try {\n-                            MapleSummon summon = summons.get(summonId);\n-                            if (summon != null) {\n-                                getMap().broadcastMessage(MaplePacketCreator.removeSummon(summon, true), summon.getPosition());\n-                                getMap().removeMapObject(summon);\n-                                removeVisibleMapObject(summon);\n-                                summons.remove(summonId);\n+                        MapleSummon summon = summons.get(summonId);\n+                        if (summon != null) {\n+                            getMap().broadcastMessage(MaplePacketCreator.removeSummon(summon, true), summon.getPosition());\n+                            getMap().removeMapObject(summon);\n+                            removeVisibleMapObject(summon);\n+                            summons.remove(summonId);\n+                        }\n+                        if (summon.getSkill() == DarkKnight.BEHOLDER) {\n+                            if (beholderHealingSchedule != null) {\n+                                beholderHealingSchedule.cancel(false);\n+                                beholderHealingSchedule = null;\n                             }\n-                            if (summon.getSkill() == DarkKnight.BEHOLDER) {\n-                                if (beholderHealingSchedule != null) {\n-                                    beholderHealingSchedule.cancel(false);\n-                                    beholderHealingSchedule = null;\n-                                }\n-                                if (beholderBuffSchedule != null) {\n-                                    beholderBuffSchedule.cancel(false);\n-                                    beholderBuffSchedule = null;\n-                                }\n+                            if (beholderBuffSchedule != null) {\n+                                beholderBuffSchedule.cancel(false);\n+                                beholderBuffSchedule = null;\n                             }\n-                        } finally {\n-                            sLock.unlock();\n                         }\n                     } else if (stat == MapleBuffStat.DRAGONBLOOD) {\n                         dragonBloodSchedule.cancel(false);\n@@ -2530,48 +2529,23 @@ public int getStr() {\n     }\n     \n     public Collection<MapleSummon> getSummonsValues() {\n-        sLock.lock();\n-        try {\n-            return summons.values();\n-        } finally {\n-            sLock.unlock();\n-        }\n+        return summons.values();\n     }\n     \n     public void clearSummons() {\n-        sLock.lock();\n-        try {\n-            summons.clear();\n-        } finally {\n-            sLock.unlock();\n-        }\n+        summons.clear();\n     }\n     \n     public MapleSummon getSummonByKey(int id) {\n-        sLock.lock();\n-        try {\n-            return summons.get(id);\n-        } finally {\n-            sLock.unlock();\n-        }\n+        return summons.get(id);\n     }\n     \n     public boolean isSummonsEmpty() {\n-        sLock.lock();\n-        try {\n-            return summons.isEmpty();\n-        } finally {\n-            sLock.unlock();\n-        }\n+        return summons.isEmpty();\n     }\n     \n     public boolean containsSummon(MapleSummon summon) {\n-        sLock.lock();\n-        try {\n-            return summons.containsValue(summon);\n-        } finally {\n-            sLock.unlock();\n-        }\n+        return summons.containsValue(summon);\n     }\n \n     public int getTotalStr() {"}, {"sha": "4ea8a5e8df692d704ba89da99391c752bd9a149c", "filename": "src/client/command/Commands.java", "status": "modified", "additions": 15, "deletions": 9, "changes": 24, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/src/client/command/Commands.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/src/client/command/Commands.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/Commands.java?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -333,6 +333,12 @@ public static boolean executePlayerCommand(MapleClient c, String[] sub, char hea\n \t\t\tplayer.message(\"@whodrops <item name>: Displays monsters that drop an item given an item name.\");\n \t\t\tplayer.message(\"@uptime: Shows how long Solaxia has been online.\");\n \t\t\tplayer.message(\"@bosshp: Displays the remaining HP of the bosses on your map.\");\n+                        if(ServerConstants.USE_DEBUG) {\n+                            player.message(\"@debugpos: Displays the coordinates on the map the player is currently located.\");\n+                            player.message(\"@debugmapcount: Displays the current number of registered players in the map the player is located.\");\n+                            player.message(\"@debugevent: Displays the name of the event in which the player is currently registered.\");\n+                            player.message(\"@debugreactors: Displays current info for all reactors on the map the the player is currently located.\");\n+                        }\n \t\t\tbreak;\n \t\tcase \"time\":\n \t\t\tDateFormat dateFormat = new SimpleDateFormat(\"HH:mm:ss\");\n@@ -652,7 +658,7 @@ public static boolean executePlayerCommand(MapleClient c, String[] sub, char hea\n                 \n                 case \"debugevent\":\n                         if(ServerConstants.USE_DEBUG) {\n-                            if(player.getEventInstance() == null) player.dropMessage(\"Player currently not in a event.\");\n+                            if(player.getEventInstance() == null) player.dropMessage(\"Player currently not in an event.\");\n                             else player.dropMessage(\"Current event name: \" + player.getEventInstance().getName() + \".\");\n                         }\n                         break;\n@@ -700,18 +706,18 @@ public static boolean executeGMCommand(MapleClient c, String[] sub, char heading\n \t\t\t}\n \t\t\tif (sub.length > 2) {\n \t\t\t\tfor (int i = 0; i < Integer.parseInt(sub[2]); i++) {\n-\t\t\t\t\tplayer.getMap().spawnMonsterOnGroudBelow(MapleLifeFactory.getMonster(Integer.parseInt(sub[1])), player.getPosition());\n+\t\t\t\t\tplayer.getMap().spawnMonsterOnGroundBelow(MapleLifeFactory.getMonster(Integer.parseInt(sub[1])), player.getPosition());\n \t\t\t\t}\n \t\t\t} else {\n-\t\t\t\tplayer.getMap().spawnMonsterOnGroudBelow(MapleLifeFactory.getMonster(Integer.parseInt(sub[1])), player.getPosition());\n+\t\t\t\tplayer.getMap().spawnMonsterOnGroundBelow(MapleLifeFactory.getMonster(Integer.parseInt(sub[1])), player.getPosition());\n \t\t\t}\n \t\t} else if (sub[0].equals(\"bomb\")) {\n \t\t\tif (sub.length > 1){\n \t\t\t\tMapleCharacter victim = c.getWorldServer().getPlayerStorage().getCharacterByName(sub[1]);\n-\t\t\t\tvictim.getMap().spawnMonsterOnGroudBelow(MapleLifeFactory.getMonster(9300166), victim.getPosition());\n+\t\t\t\tvictim.getMap().spawnMonsterOnGroundBelow(MapleLifeFactory.getMonster(9300166), victim.getPosition());\n \t\t\t\tServer.getInstance().broadcastGMMessage(MaplePacketCreator.serverNotice(5, player.getName() + \" used !bomb on \" + victim.getName()));\n \t\t\t} else {\n-\t\t\t\tplayer.getMap().spawnMonsterOnGroudBelow(MapleLifeFactory.getMonster(9300166), player.getPosition());\n+\t\t\t\tplayer.getMap().spawnMonsterOnGroundBelow(MapleLifeFactory.getMonster(9300166), player.getPosition());\n \t\t\t}\n \t\t} else if (sub[0].equals(\"mutemap\")) {\n \t\t\tif(player.getMap().isMuted()) {\n@@ -1189,9 +1195,9 @@ public static boolean executeGMCommand(MapleClient c, String[] sub, char heading\n \t\t\t}\n \t\t\tplayer.dropMessage(\"There are a total of \" + total + \" players online.\");\n \t\t} else if (sub[0].equals(\"pap\")) {\n-\t\t\tplayer.getMap().spawnMonsterOnGroudBelow(MapleLifeFactory.getMonster(8500001), player.getPosition());\n+\t\t\tplayer.getMap().spawnMonsterOnGroundBelow(MapleLifeFactory.getMonster(8500001), player.getPosition());\n \t\t} else if (sub[0].equals(\"pianus\")) {\n-\t\t\tplayer.getMap().spawnMonsterOnGroudBelow(MapleLifeFactory.getMonster(8510000), player.getPosition());\n+\t\t\tplayer.getMap().spawnMonsterOnGroundBelow(MapleLifeFactory.getMonster(8510000), player.getPosition());\n \t\t} else if (sub[0].equalsIgnoreCase(\"search\")) {\n \t\t\tStringBuilder sb = new StringBuilder();\n \t\t\tif (sub.length > 2) {\n@@ -1338,7 +1344,7 @@ public static void executeAdminCommand(MapleClient c, String[] sub, char heading\n \t\t\t}\n \t\t\tbreak;\n \t\tcase \"horntail\":\n-\t\t\tplayer.getMap().spawnMonsterOnGroudBelow(MapleLifeFactory.getMonster(8810026), player.getPosition());\n+\t\t\tplayer.getMap().spawnMonsterOnGroundBelow(MapleLifeFactory.getMonster(8810026), player.getPosition());\n \t\t\tbreak;\n \t\tcase \"packet\":\n \t\t\tplayer.getMap().broadcastMessage(MaplePacketCreator.customPacket(joinStringFrom(sub, 1)));\n@@ -1490,7 +1496,7 @@ public static void executeAdminCommand(MapleClient c, String[] sub, char heading\n \t\tcase \"zakum\":\n \t\t\tplayer.getMap().spawnFakeMonsterOnGroundBelow(MapleLifeFactory.getMonster(8800000), player.getPosition());\n \t\t\tfor (int x = 8800003; x < 8800011; x++) {\n-\t\t\t\tplayer.getMap().spawnMonsterOnGroudBelow(MapleLifeFactory.getMonster(x), player.getPosition());\n+\t\t\t\tplayer.getMap().spawnMonsterOnGroundBelow(MapleLifeFactory.getMonster(x), player.getPosition());\n \t\t\t}\n \t\t\tbreak;\n \t\tcase \"clearquestcache\":"}, {"sha": "66c22d74d1e3e6128909f6b61137d956796c5b73", "filename": "src/constants/ServerConstants.java", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/src/constants/ServerConstants.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/src/constants/ServerConstants.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/constants/ServerConstants.java?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -9,11 +9,11 @@\n     public static String[] WORLD_NAMES = {\"Scania\", \"Bera\", \"Broa\", \"Windia\", \"Khaini\", \"Bellocan\", \"Mardia\", \"Kradia\", \"Yellonde\", \"Demethos\", \"Galicia\", \"El Nido\", \"Zenith\", \"Arcenia\", \"Kastia\", \"Judis\", \"Plana\", \"Kalluna\", \"Stius\", \"Croa\", \"Medere\"};\n \n     // Login Configuration\n-    public static final int CHANNEL_LOAD = 100;//Players per channel\n-    public static final long RANKING_INTERVAL = 60 * 60 * 1000;//60 minutes, 3600000\n+    public static final int CHANNEL_LOAD = 100;                     //Players per channel\n+    public static final long RANKING_INTERVAL = 60 * 60 * 1000;     //60 minutes, 3600000\n     public static final boolean ENABLE_PIC = false;\n     //Event Configuration\n-    public static final boolean PERFECT_PITCH = true;  //for lvl 30 or above, each lvlup player gains 1 perfect pitch.\n+    public static final boolean PERFECT_PITCH = true;               //for lvl 30 or above, each lvlup player gains 1 perfect pitch.\n     // IP Configuration\n     public static String HOST;\n     //Database Configuration\n@@ -25,7 +25,7 @@\n     public static boolean SHUTDOWNHOOK;\n     //Gameplay Configurations\n     public static final boolean USE_MAXRANGE = true;        //will send and receive packets from all events of a map, rather than those of only view range.\n-    public static final boolean USE_DEBUG = true;\n+    public static final boolean USE_DEBUG = true;           //will enable some text prints and new commands in the client oriented for debugging.\n     public static final boolean USE_MTS = false;\n     public static final boolean USE_FAMILY_SYSTEM = false;\n     public static final boolean USE_DUEY = true;\n@@ -57,7 +57,7 @@\n     public static final double PET_AUTOHP_RATIO = 0.99;         //will automatically consume potions until given ratio of the MaxHP/MaxMP is reached.\n     public static final double PET_AUTOMP_RATIO = 0.99;\n     \n-    //Should bosses use 1HP,1MP attacks in dojo?\n+    //Should bosses really use 1HP,1MP attacks in dojo?\n     public static final boolean USE_DEADLY_DOJO = false;\n     \n     //Rates"}, {"sha": "9ee38ab1e55a2bc83a6e19ac873cb333133653b1", "filename": "src/net/server/channel/handlers/AdminCommandHandler.java", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/src/net/server/channel/handlers/AdminCommandHandler.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/src/net/server/channel/handlers/AdminCommandHandler.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/channel/handlers/AdminCommandHandler.java?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -56,7 +56,7 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n                 for (int z = 0; z < toSpawn.length; z++) {\n                     int[] toSpawnChild = toSpawn[z];\n                     if (Randomizer.nextInt(101) <= toSpawnChild[1]) {\n-                        c.getPlayer().getMap().spawnMonsterOnGroudBelow(MapleLifeFactory.getMonster(toSpawnChild[0]), c.getPlayer().getPosition());\n+                        c.getPlayer().getMap().spawnMonsterOnGroundBelow(MapleLifeFactory.getMonster(toSpawnChild[0]), c.getPlayer().getPosition());\n                     }\n                 }\n                 c.announce(MaplePacketCreator.enableActions());\n@@ -143,7 +143,7 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n                 int mobId = slea.readInt();\n                 int quantity = slea.readInt();\n                 for (int i = 0; i < quantity; i++) {\n-                    c.getPlayer().getMap().spawnMonsterOnGroudBelow(MapleLifeFactory.getMonster(mobId), c.getPlayer().getPosition());\n+                    c.getPlayer().getMap().spawnMonsterOnGroundBelow(MapleLifeFactory.getMonster(mobId), c.getPlayer().getPosition());\n                 }\n                 break;\n             case 0x18: // Maple & Mobhp"}, {"sha": "de9d5ec737a2ff732828b81b33895495bd4648ab", "filename": "src/net/server/channel/handlers/UseSummonBag.java", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/src/net/server/channel/handlers/UseSummonBag.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/src/net/server/channel/handlers/UseSummonBag.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/channel/handlers/UseSummonBag.java?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -55,7 +55,7 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n             for (int z = 0; z < toSpawn.length; z++) {\n                 int[] toSpawnChild = toSpawn[z];\n                 if (Randomizer.nextInt(101) <= toSpawnChild[1]) {\n-                    c.getPlayer().getMap().spawnMonsterOnGroudBelow(MapleLifeFactory.getMonster(toSpawnChild[0]), c.getPlayer().getPosition());\n+                    c.getPlayer().getMap().spawnMonsterOnGroundBelow(MapleLifeFactory.getMonster(toSpawnChild[0]), c.getPlayer().getPosition());\n                 }\n             }\n         }"}, {"sha": "4892007e02b62a2990f22a895c4ad6fb616d2b04", "filename": "src/net/server/world/MapleParty.java", "status": "modified", "additions": 15, "deletions": 1, "changes": 16, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/src/net/server/world/MapleParty.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/src/net/server/world/MapleParty.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/world/MapleParty.java?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -29,6 +29,7 @@\n public class MapleParty {\n     private MaplePartyCharacter leader;\n     private List<MaplePartyCharacter> members = new LinkedList<MaplePartyCharacter>();\n+    private List<MaplePartyCharacter> pqMembers = null;\n     private int id;\n \n     public MapleParty(int id, MaplePartyCharacter chrfor) {\n@@ -74,6 +75,19 @@ public MaplePartyCharacter getMemberById(int id) {\n         return Collections.unmodifiableList(members);\n     }\n     \n+    public List<MaplePartyCharacter> getPartyMembers() {\n+        return members;\n+    }\n+    \n+    // used whenever entering PQs: will draw every party member that can attempt a target PQ while ingnoring those unfit.\n+    public Collection<MaplePartyCharacter> getEligibleMembers() {\n+        return Collections.unmodifiableList(pqMembers);\n+    }\n+    \n+    public void setEligibleMembers(List<MaplePartyCharacter> eliParty) {\n+        pqMembers = eliParty;\n+    }\n+    \n     public int getId() {\n         return id;\n     }\n@@ -85,7 +99,7 @@ public void setId(int id) {\n     public MaplePartyCharacter getLeader() {\n         return leader;\n     }\n-\n+    \n     @Override\n     public int hashCode() {\n         final int prime = 31;"}, {"sha": "88e9425945d7d0caca45cc8ca47156b8bd669964", "filename": "src/net/server/world/MaplePartyCharacter.java", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/src/net/server/world/MaplePartyCharacter.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/src/net/server/world/MaplePartyCharacter.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/world/MaplePartyCharacter.java?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -79,6 +79,10 @@ public int getChannel() {\n     public void setChannel(int channel) {\n         this.channel = channel;\n     }\n+    \n+    public boolean isLeader() {\n+        return getPlayer().isPartyLeader();\n+    }\n \n     public boolean isOnline() {\n         return online;"}, {"sha": "2dc6fe332462f1895f4a005753105667e15df28c", "filename": "src/scripting/AbstractPlayerInteraction.java", "status": "modified", "additions": 18, "deletions": 6, "changes": 24, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/src/scripting/AbstractPlayerInteraction.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/src/scripting/AbstractPlayerInteraction.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/scripting/AbstractPlayerInteraction.java?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -93,15 +93,15 @@ public MapleMap getMap() {\n         }\n \n \tpublic void warp(int map) {\n-\t\tgetPlayer().changeMap(getWarpMap(map), getWarpMap(map).getPortal(0));\n+\t\tgetPlayer().changeMap(map, 0);\n \t}\n \n \tpublic void warp(int map, int portal) {\n-\t\tgetPlayer().changeMap(getWarpMap(map), getWarpMap(map).getPortal(portal));\n+\t\tgetPlayer().changeMap(map, portal);\n \t}\n \n \tpublic void warp(int map, String portal) {\n-\t\tgetPlayer().changeMap(getWarpMap(map), getWarpMap(map).getPortal(portal));\n+\t\tgetPlayer().changeMap(map, portal);\n \t}\n \n \tpublic void warpMap(int map) {\n@@ -161,6 +161,15 @@ public void resetMapObjects(int mapid) {\n \tpublic EventManager getEventManager(String event) {\n \t\treturn getClient().getEventManager(event);\n \t}\n+        \n+        public void clearPQ(int toMap) {\n+                clearPQ(getWarpMap(toMap));\n+        }\n+        \n+        public void clearPQ(MapleMap toMap) {\n+                if(getPlayer().getEventInstance() != null)\n+                        getPlayer().getEventInstance().getEm().clearPQ(getPlayer().getEventInstance(), toMap);\n+        }\n \n         public MapleInventory getInventory(MapleInventoryType type) {\n                 return getPlayer().getInventory(type);\n@@ -556,14 +565,17 @@ public void removePartyItems(int id) {\n \t\t\t}\n \t\t}\n \t}\n+        \n+        public void giveCharacterExp(int amount, MapleCharacter chr) {\n+                chr.gainExp((amount * chr.getExpRate()), true, true);\n+        }\n \n \tpublic void givePartyExp(int amount, List<MapleCharacter> party) {\n \t\tfor (MapleCharacter chr : party) {\n-\t\t\tchr.gainExp((amount * chr.getExpRate()), true, true);\n+\t\t\tgiveCharacterExp(amount, chr);\n \t\t}\n \t}\n-\n-\n+        \n \tpublic void givePartyExp(String PQ) {\n \t\tgivePartyExp(PQ, true);\n \t}"}, {"sha": "7ff020a5ea58424d16b4b136feee6a8044ca29a7", "filename": "src/scripting/event/EventInstanceManager.java", "status": "modified", "additions": 32, "deletions": 2, "changes": 34, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/src/scripting/event/EventInstanceManager.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/src/scripting/event/EventInstanceManager.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/scripting/event/EventInstanceManager.java?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -83,6 +83,28 @@ public EventInstanceManager(EventManager em, String name) {\n \tpublic EventManager getEm() {\n \t\treturn em;\n \t}\n+        \n+        public void giveEventPlayersExp(int gain) {\n+                giveEventPlayersExp(gain, -1);\n+        }\n+        \n+        public void giveEventPlayersExp(int gain, int mapId) {\n+                rL.lock();\n+                try {\n+                        if(mapId == -1) {\n+                                for(MapleCharacter mc: chars) {\n+                                        mc.gainExp(gain * mc.getExpRate(), true, true);\n+                                }\n+                        }\n+                        else {\n+                                for(MapleCharacter mc: chars) {\n+                                        if(mc.getMapId() == mapId) mc.gainExp(gain * mc.getExpRate(), true, true);\n+                                }\n+                        }\n+                } finally {\n+                        rL.unlock();\n+                }\n+\t}\n \n \tpublic void registerPlayer(MapleCharacter chr) {\n \t\tif (chr == null || !chr.isLoggedin()){\n@@ -141,7 +163,7 @@ public long getTimeLeft() {\n \t}\n \n \tpublic void registerParty(MapleParty party, MapleMap map) {\n-\t\tfor (MaplePartyCharacter pc : party.getMembers()) {\n+\t\tfor (MaplePartyCharacter pc : party.getEligibleMembers()) {\n \t\t\tMapleCharacter c = map.getCharacterById(pc.getId());\n \t\t\tregisterPlayer(c);\n \t\t}\n@@ -197,6 +219,14 @@ public void movePlayer(MapleCharacter chr) {\n \t\t\tex.printStackTrace();\n \t\t}\n \t}\n+        \n+        public void changedMap(MapleCharacter chr, int mapId) {\n+\t\ttry {\n+\t\t\tem.getIv().invokeFunction(\"changedMap\", this, chr, mapId);\n+\t\t} catch (ScriptException | NoSuchMethodException ex) {\n+\t\t\tex.printStackTrace();\n+\t\t}\n+\t}\n \t\n \tpublic void monsterKilled(MapleMonster mob) {\n \t\tmobs.remove(mob);\n@@ -418,7 +448,7 @@ public final boolean disposeIfPlayerBelow(final byte size, final int towarp) {\n \n             rL.lock();\n             try {\n-                if (chars != null && chars.size() <= size) {\n+                if (chars != null && chars.size() < size) {\n                     for (MapleCharacter chr : chars) {\n                         if (chr == null) {\n                             continue;"}, {"sha": "9e625b7c406f8bc23ea8b8f373de7df3a3f82e01", "filename": "src/scripting/event/EventManager.java", "status": "modified", "additions": 36, "deletions": 1, "changes": 37, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/src/scripting/event/EventManager.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/src/scripting/event/EventManager.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/scripting/event/EventManager.java?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -35,13 +35,18 @@\n \n import net.server.channel.Channel;\n import net.server.world.MapleParty;\n+import net.server.world.MaplePartyCharacter;\n import server.TimerManager;\n import server.expeditions.MapleExpedition;\n import server.maps.MapleMap;\n import server.life.MapleMonster;\n import server.life.MapleLifeFactory;\n \n import client.MapleCharacter;\n+import java.util.LinkedList;\n+import java.util.List;\n+import java.util.ArrayList;\n+import java.lang.reflect.Array;\n \n /**\n  *\n@@ -86,7 +91,8 @@ public void run() {\n     }\n \n     public void cancelSchedule() {\n-        schedule.cancel(true);\n+        if(schedule != null)\n+            schedule.cancel(true);\n     }\n \n     public ScheduledFuture<?> scheduleAtTimestamp(final String methodName, long timestamp) {\n@@ -173,6 +179,7 @@ public void startInstance(MapleParty party, MapleMap map) {\n         try {\n             EventInstanceManager eim = (EventInstanceManager) (iv.invokeFunction(\"setup\", (Object) null));\n             eim.registerParty(party, map);\n+            party.setEligibleMembers(null);\n         } catch (ScriptException | NoSuchMethodException ex) {\n             Logger.getLogger(EventManager.class.getName()).log(Level.SEVERE, null, ex);\n         }\n@@ -183,6 +190,7 @@ public void startInstance(MapleParty party, MapleMap map, int difficulty) {\n         try {\n             EventInstanceManager eim = (EventInstanceManager) (iv.invokeFunction(\"setup\", difficulty, party.getLeader().getId()));\n             eim.registerParty(party, map);\n+            party.setEligibleMembers(null);\n         } catch (ScriptException | NoSuchMethodException ex) {\n             Logger.getLogger(EventManager.class.getName()).log(Level.SEVERE, null, ex);\n         }\n@@ -198,6 +206,33 @@ public void startInstance(EventInstanceManager eim, String leader) {\n         }\n     }\n     \n+    public List<MaplePartyCharacter> getEligibleParty(MapleParty party) {\n+        if (party == null) {\n+            return(new ArrayList<>());\n+        }\n+        try {\n+            Object p = iv.invokeFunction(\"getEligibleParty\", party.getPartyMembers());\n+            \n+            if(p != null) {\n+                List<MaplePartyCharacter> lmpc = new ArrayList<>((List<MaplePartyCharacter>) p);\n+                party.setEligibleMembers(lmpc);\n+                return lmpc;\n+            }\n+        } catch (ScriptException | NoSuchMethodException ex) {\n+            ex.printStackTrace();\n+        }\n+\n+        return(new ArrayList<>());\n+    }\n+    \n+    public void clearPQ(EventInstanceManager eim, MapleMap toMap) {\n+        try {\n+            iv.invokeFunction(\"clearPQ\", eim, toMap);\n+        } catch (ScriptException | NoSuchMethodException ex) {\n+            Logger.getLogger(EventManager.class.getName()).log(Level.SEVERE, null, ex);\n+        }\n+    }\n+    \n     public MapleMonster getMonster(int mid) {\n         return(MapleLifeFactory.getMonster(mid));\n     }"}, {"sha": "168ee0945b668381dd083317d5555263d604dd7a", "filename": "src/scripting/npc/NPCConversationManager.java", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/src/scripting/npc/NPCConversationManager.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/src/scripting/npc/NPCConversationManager.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/scripting/npc/NPCConversationManager.java?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -218,7 +218,7 @@ public void completeQuest(int id) {\n                         ex.printStackTrace();\n \t\t}\n \t}\n-\n+        \n \tpublic int getMeso() {\n \t\treturn getPlayer().getMeso();\n \t}"}, {"sha": "99ec22725f86a0c198fae9018ec8e4500d13716d", "filename": "src/scripting/reactor/ReactorActionManager.java", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/src/scripting/reactor/ReactorActionManager.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/src/scripting/reactor/ReactorActionManager.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/scripting/reactor/ReactorActionManager.java?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -92,7 +92,7 @@ public void dropItems(int posX, int posY, boolean meso, int mesoChance, int minM\n                 int range = maxMeso - minMeso;\n                 int displayDrop = (int) (Math.random() * range) + minMeso;\n                 int mesoDrop = (displayDrop * client.getWorldServer().getMesoRate());\n-                reactor.getMap().spawnMesoDrop(mesoDrop, dropPos, reactor, client.getPlayer(), false, (byte) 0);\n+                reactor.getMap().spawnMesoDrop(mesoDrop, dropPos, reactor, client.getPlayer(), false, (byte) 2);\n             } else {\n                 Item drop;\n                 MapleItemInformationProvider ii = MapleItemInformationProvider.getInstance();\n@@ -129,7 +129,7 @@ public void spawnMonster(int id, int qty, int x, int y) {\n \n     private void spawnMonster(int id, int qty, Point pos) {\n         for (int i = 0; i < qty; i++) {\n-            reactor.getMap().spawnMonsterOnGroudBelow(MapleLifeFactory.getMonster(id), pos);\n+            reactor.getMap().spawnMonsterOnGroundBelow(MapleLifeFactory.getMonster(id), pos);\n         }\n     }\n "}, {"sha": "5878ea0553a372735929dcfb286f595a08c224f0", "filename": "src/scripting/reactor/ReactorScriptManager.java", "status": "modified", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/src/scripting/reactor/ReactorScriptManager.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/src/scripting/reactor/ReactorScriptManager.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/scripting/reactor/ReactorScriptManager.java?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -47,6 +47,23 @@\n     public synchronized static ReactorScriptManager getInstance() {\n         return instance;\n     }\n+    \n+    public void onHit(MapleClient c, MapleReactor reactor) {\n+        try {\n+            ReactorActionManager rm = new ReactorActionManager(c, reactor);\n+            Invocable iv = getInvocable(\"reactor/\" + reactor.getId() + \".js\", c);\n+            if (iv == null) {\n+            \treturn;\n+            }\n+            engine.put(\"rm\", rm);\n+            iv.invokeFunction(\"hit\");\n+        } catch(final NoSuchMethodException e) {\n+            //do nothing, hit is OPTIONAL\n+        }\n+        catch (final ScriptException | NullPointerException e) {\n+            FilePrinter.printError(FilePrinter.REACTOR + reactor.getId() + \".txt\", e);\n+        }\n+    }\n \n     public void act(MapleClient c, MapleReactor reactor) {\n         try {"}, {"sha": "850a12a110257fc89d13b058f9523fb66790e149", "filename": "src/server/maps/MapleMap.java", "status": "modified", "additions": 4, "deletions": 6, "changes": 10, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/src/server/maps/MapleMap.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/src/server/maps/MapleMap.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/maps/MapleMap.java?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -1001,15 +1001,11 @@ public MapleReactor getReactorByName(String name) {\n         return null;\n     }\n \n-    public void spawnMonsterOnGroudBelow(int id, int x, int y) {\n+    public void spawnMonsterOnGroundBelow(int id, int x, int y) {\n         MapleMonster mob = MapleLifeFactory.getMonster(id);\n         spawnMonsterOnGroundBelow(mob, new Point(x, y));\n     }\n \n-    public void spawnMonsterOnGroudBelow(MapleMonster mob, Point pos) {\n-        spawnMonsterOnGroundBelow(mob, pos);\n-    }\n-\n     public void spawnMonsterOnGroundBelow(MapleMonster mob, Point pos) {\n         Point spos = new Point(pos.x, pos.y - 1);\n         spos = calcPointBelow(spos);\n@@ -1642,13 +1638,15 @@ public void removePlayer(MapleCharacter chr) {\n         }\n         chr.leaveMap();\n         chr.cancelMapTimeLimitTask();\n-        for (MapleSummon summon : chr.getSummonsValues()) {\n+        \n+        for (MapleSummon summon : new ArrayList<>(chr.getSummonsValues())) {\n             if (summon.isStationary()) {\n                 chr.cancelBuffStats(MapleBuffStat.PUPPET);\n             } else {\n                 removeMapObject(summon);\n             }\n         }\n+\n         if (chr.getDragon() != null) {\n             removeMapObject(chr.getDragon());\n             if (chr.isHidden()) {"}, {"sha": "72cf9e8fd9aa2a5750fb4310150dd2e28d9f0132", "filename": "src/server/maps/MapleReactor.java", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/src/server/maps/MapleReactor.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/src/server/maps/MapleReactor.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/maps/MapleReactor.java?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -174,8 +174,9 @@ public synchronized void hitReactor(int charPos, short stance, int skillid, Mapl\n                 return;\n             }\n             if(ServerConstants.USE_DEBUG == true) c.getPlayer().dropMessage(5, \"Hitted REACTOR \" + this.getId() + \" with POS \" + charPos + \" , STANCE \" + stance + \" , SkillID \" + skillid + \" , STATE \" + stats.getType(state) + \" STATESIZE \" + stats.getStateSize(state));\n-            int reactorType = stats.getType(state);\n+            ReactorScriptManager.getInstance().onHit(c, this);\n             \n+            int reactorType = stats.getType(state);\n             if (reactorType < 999 && reactorType != -1) {//type 2 = only hit from right (kerning swamp plants), 00 is air left 02 is ground left\n                 if (!(reactorType == 2 && (stance == 0 || stance == 2))) { //get next state\n                     for (byte b = 0; b < stats.getStateSize(state); b++) {//YAY?\n@@ -212,7 +213,6 @@ public synchronized void hitReactor(int charPos, short stance, int skillid, Mapl\n                 map.broadcastMessage(MaplePacketCreator.triggerReactor(this, stance));\n                 ReactorScriptManager.getInstance().act(c, this);\n                 setShouldCollect(true);\n-                System.out.println(\"ehh\");\n             }\n         } catch(Exception e) {\n             e.printStackTrace();"}, {"sha": "74cee66874d76991a76621609fb26d43ce55ccd5", "filename": "src/server/quest/actions/ExpAction.java", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/src/server/quest/actions/ExpAction.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/src/server/quest/actions/ExpAction.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/quest/actions/ExpAction.java?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -47,7 +47,7 @@ public void processData(MapleData data) {\n \t\n \t@Override\n \tpublic void run(MapleCharacter chr, Integer extSelection) {\n-\t\tif (chr.isBeginnerJob()) {\n+\t\tif (chr.isBeginnerJob() && chr.getLevel() < 10) {\n \t\t\tchr.gainExp(exp, true, true);\n \t\t} else {\n \t\t\tchr.gainExp(exp * chr.getExpRate(), true, true);"}, {"sha": "b5a91f9e86abfc26c38540033a0f03d92a12069c", "filename": "wz/Item.wz/Etc/0403.img.xml", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/wz/Item.wz/Etc/0403.img.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/wz/Item.wz/Etc/0403.img.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/wz/Item.wz/Etc/0403.img.xml?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -14516,8 +14516,7 @@\n       <canvas name=\"iconRaw\" width=\"31\" height=\"28\">\n         <vector name=\"origin\" x=\"-1\" y=\"30\"/>\n       </canvas>\n-      <int name=\"price\" value=\"1\"/>\n-      <int name=\"quest\" value=\"1\"/>\n+      <int name=\"price\" value=\"1500\"/>\n     </imgdir>\n   </imgdir>\n   <imgdir name=\"04032475\">"}, {"sha": "5d8e5301981a6837ef45e10b777a8c986dcd188c", "filename": "wz/Quest.wz/Act.img.xml", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/wz/Quest.wz/Act.img.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/wz/Quest.wz/Act.img.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/wz/Quest.wz/Act.img.xml?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -39069,8 +39069,8 @@\n     <imgdir name=\"1\">\n       <imgdir name=\"item\">\n         <imgdir name=\"0\">\n-          <int name=\"id\" value=\"4000257\"/>\n-          <int name=\"count\" value=\"-50\"/>\n+          <int name=\"id\" value=\"4032474\"/>\n+          <int name=\"count\" value=\"-5\"/>\n         </imgdir>\n         <imgdir name=\"1\">\n           <int name=\"id\" value=\"4000046\"/>"}, {"sha": "62c50beea77fd7034e1b2f9ecf0fa5abf5097a5e", "filename": "wz/Quest.wz/Check.img.xml", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/wz/Quest.wz/Check.img.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/wz/Quest.wz/Check.img.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/wz/Quest.wz/Check.img.xml?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -62702,8 +62702,8 @@\n       <int name=\"npc\" value=\"2041017\"/>\n       <imgdir name=\"item\">\n         <imgdir name=\"0\">\n-          <int name=\"id\" value=\"4000257\"/>\n-          <int name=\"count\" value=\"50\"/>\n+          <int name=\"id\" value=\"4032474\"/>\n+          <int name=\"count\" value=\"5\"/>\n         </imgdir>\n         <imgdir name=\"1\">\n           <int name=\"id\" value=\"4000046\"/>"}, {"sha": "c746c4f1f2b1e6adebafc719970bc631caf6aba9", "filename": "wz/String.wz/MonsterBook.img.xml", "status": "modified", "additions": 249, "deletions": 259, "changes": 508, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/939b214fb5d7108a3ddcb54a673d81dea842b844/wz/String.wz/MonsterBook.img.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/939b214fb5d7108a3ddcb54a673d81dea842b844/wz/String.wz/MonsterBook.img.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/wz/String.wz/MonsterBook.img.xml?ref=939b214fb5d7108a3ddcb54a673d81dea842b844", "patch": "@@ -5946,26 +5946,25 @@\n       <int name=\"13\" value=\"2000002\" />\n       <int name=\"14\" value=\"2000003\" />\n       <int name=\"15\" value=\"2000004\" />\n-      <int name=\"16\" value=\"2022066\" />\n-      <int name=\"17\" value=\"2040321\" />\n-      <int name=\"18\" value=\"2040804\" />\n-      <int name=\"19\" value=\"2040925\" />\n-      <int name=\"20\" value=\"2040933\" />\n-      <int name=\"21\" value=\"2043019\" />\n-      <int name=\"22\" value=\"2043110\" />\n-      <int name=\"23\" value=\"2044602\" />\n-      <int name=\"24\" value=\"2383013\" />\n-      <int name=\"25\" value=\"4000021\" />\n-      <int name=\"26\" value=\"4000048\" />\n-      <int name=\"27\" value=\"4003005\" />\n-      <int name=\"28\" value=\"4004002\" />\n-      <int name=\"29\" value=\"4007000\" />\n-      <int name=\"30\" value=\"4007001\" />\n-      <int name=\"31\" value=\"4007002\" />\n-      <int name=\"32\" value=\"4010002\" />\n-      <int name=\"33\" value=\"4020001\" />\n-      <int name=\"34\" value=\"4130010\" />\n-      <int name=\"35\" value=\"4130011\" />\n+      <int name=\"16\" value=\"2040321\" />\n+      <int name=\"17\" value=\"2040804\" />\n+      <int name=\"18\" value=\"2040925\" />\n+      <int name=\"19\" value=\"2040933\" />\n+      <int name=\"20\" value=\"2043019\" />\n+      <int name=\"21\" value=\"2043110\" />\n+      <int name=\"22\" value=\"2044602\" />\n+      <int name=\"23\" value=\"2383013\" />\n+      <int name=\"24\" value=\"4000021\" />\n+      <int name=\"25\" value=\"4000048\" />\n+      <int name=\"26\" value=\"4003005\" />\n+      <int name=\"27\" value=\"4004002\" />\n+      <int name=\"28\" value=\"4007000\" />\n+      <int name=\"29\" value=\"4007001\" />\n+      <int name=\"30\" value=\"4007002\" />\n+      <int name=\"31\" value=\"4010002\" />\n+      <int name=\"32\" value=\"4020001\" />\n+      <int name=\"33\" value=\"4130010\" />\n+      <int name=\"34\" value=\"4130011\" />\n     </imgdir>\n     <string name=\"episode\" value=\"Lv. :  50\\nForm : Mammal\\n\\nA small yeti often spotted in the snowfield of Ossyria near El Nath. Is made to live in cold climates and can therefore withstand strong Ice Attribute Attacks while being vulnerable to Fire Attribute Attacks. Its small frame and slow movement makes it an easy target, but beware, as many a travellers have been badly injured by this cute little creature. The Jr. Yeti is capable of transforming into a giant yeti as well so watch out!  \" />\n   </imgdir>\n@@ -6445,26 +6444,25 @@\n       <int name=\"9\" value=\"1082010\" />\n       <int name=\"10\" value=\"1082067\" />\n       <int name=\"11\" value=\"1092010\" />\n-      <int name=\"12\" value=\"1302056\" />\n-      <int name=\"13\" value=\"1402011\" />\n-      <int name=\"14\" value=\"1412007\" />\n-      <int name=\"15\" value=\"1432040\" />\n-      <int name=\"16\" value=\"2000002\" />\n-      <int name=\"17\" value=\"2000004\" />\n-      <int name=\"18\" value=\"2002010\" />\n-      <int name=\"19\" value=\"2043017\" />\n-      <int name=\"20\" value=\"2044602\" />\n-      <int name=\"21\" value=\"2060000\" />\n-      <int name=\"22\" value=\"2061000\" />\n-      <int name=\"23\" value=\"2383026\" />\n-      <int name=\"24\" value=\"4000126\" />\n-      <int name=\"25\" value=\"4004000\" />\n-      <int name=\"26\" value=\"4010006\" />\n-      <int name=\"27\" value=\"4011007\" />\n-      <int name=\"28\" value=\"4020001\" />\n-      <int name=\"29\" value=\"4020007\" />\n-      <int name=\"30\" value=\"4130004\" />\n-      <int name=\"31\" value=\"4130013\" />\n+      <int name=\"12\" value=\"1402011\" />\n+      <int name=\"13\" value=\"1412007\" />\n+      <int name=\"14\" value=\"1432040\" />\n+      <int name=\"15\" value=\"2000002\" />\n+      <int name=\"16\" value=\"2000004\" />\n+      <int name=\"17\" value=\"2002010\" />\n+      <int name=\"18\" value=\"2043017\" />\n+      <int name=\"19\" value=\"2044602\" />\n+      <int name=\"20\" value=\"2060000\" />\n+      <int name=\"21\" value=\"2061000\" />\n+      <int name=\"22\" value=\"2383026\" />\n+      <int name=\"23\" value=\"4000126\" />\n+      <int name=\"24\" value=\"4004000\" />\n+      <int name=\"25\" value=\"4010006\" />\n+      <int name=\"26\" value=\"4011007\" />\n+      <int name=\"27\" value=\"4020001\" />\n+      <int name=\"28\" value=\"4020007\" />\n+      <int name=\"29\" value=\"4130004\" />\n+      <int name=\"30\" value=\"4130013\" />\n     </imgdir>\n     <string name=\"episode\" value=\" Lv. :  54\\nForm : Enchanted\\nSpecial Trait : -50% Fire Attribute Damage. Sanctity Attribute Attacks Repellent.\\n\\nA powerful weapon secretly built by the Mateon aliens to attack the earth. It has been built to support the small and weak Mateons, and it is equipped with multiple explosive missiles. The Omega Sector has sent over a special troop to battle against MT-09.\" />\n   </imgdir>\n@@ -6484,32 +6482,31 @@\n       <int name=\"6\" value=\"1082081\" />\n       <int name=\"7\" value=\"1082201\" />\n       <int name=\"8\" value=\"1092045\" />\n-      <int name=\"9\" value=\"1132001\" />\n-      <int name=\"10\" value=\"1432006\" />\n-      <int name=\"11\" value=\"1472055\" />\n-      <int name=\"12\" value=\"2000002\" />\n-      <int name=\"13\" value=\"2000003\" />\n-      <int name=\"14\" value=\"2040031\" />\n-      <int name=\"15\" value=\"2040033\" />\n-      <int name=\"16\" value=\"2040515\" />\n-      <int name=\"17\" value=\"2043701\" />\n-      <int name=\"18\" value=\"2043801\" />\n-      <int name=\"19\" value=\"2049100\" />\n-      <int name=\"20\" value=\"2049101\" />\n-      <int name=\"21\" value=\"2330002\" />\n-      <int name=\"22\" value=\"2383035\" />\n-      <int name=\"23\" value=\"4000021\" />\n-      <int name=\"24\" value=\"4000283\" />\n-      <int name=\"25\" value=\"4000284\" />\n-      <int name=\"26\" value=\"4003005\" />\n-      <int name=\"27\" value=\"4004002\" />\n-      <int name=\"28\" value=\"4004004\" />\n-      <int name=\"29\" value=\"4010005\" />\n-      <int name=\"30\" value=\"4020004\" />\n-      <int name=\"31\" value=\"4020007\" />\n-      <int name=\"32\" value=\"4130000\" />\n-      <int name=\"33\" value=\"4130009\" />\n-      <int name=\"34\" value=\"4130021\" />\n+      <int name=\"9\" value=\"1432006\" />\n+      <int name=\"10\" value=\"1472055\" />\n+      <int name=\"11\" value=\"2000002\" />\n+      <int name=\"12\" value=\"2000003\" />\n+      <int name=\"13\" value=\"2040031\" />\n+      <int name=\"14\" value=\"2040033\" />\n+      <int name=\"15\" value=\"2040515\" />\n+      <int name=\"16\" value=\"2043701\" />\n+      <int name=\"17\" value=\"2043801\" />\n+      <int name=\"18\" value=\"2049100\" />\n+      <int name=\"19\" value=\"2049101\" />\n+      <int name=\"20\" value=\"2330002\" />\n+      <int name=\"21\" value=\"2383035\" />\n+      <int name=\"22\" value=\"4000021\" />\n+      <int name=\"23\" value=\"4000283\" />\n+      <int name=\"24\" value=\"4000284\" />\n+      <int name=\"25\" value=\"4003005\" />\n+      <int name=\"26\" value=\"4004002\" />\n+      <int name=\"27\" value=\"4004004\" />\n+      <int name=\"28\" value=\"4010005\" />\n+      <int name=\"29\" value=\"4020004\" />\n+      <int name=\"30\" value=\"4020007\" />\n+      <int name=\"31\" value=\"4130000\" />\n+      <int name=\"32\" value=\"4130009\" />\n+      <int name=\"33\" value=\"4130021\" />\n     </imgdir>\n     <string name=\"episode\" value=\" Lv. :  56\\nForm : Mammal\\n\\nA type of bear that lives near Mu Lung. Although it's only a bear, it has a heartfelt desire to become a virtuous master, hence devoting much of its energy in training. While it diligently trains in its practice uniform, it sometimes fails to suppress its animalistic instinct and attacks the passersby.\" />\n   </imgdir>\n@@ -7517,68 +7514,67 @@\n     </imgdir>\n     <imgdir name=\"reward\">\n       <int name=\"0\" value=\"1302011\" />\n-      <int name=\"1\" value=\"1302056\" />\n-      <int name=\"2\" value=\"1312009\" />\n-      <int name=\"3\" value=\"1322018\" />\n-      <int name=\"4\" value=\"1332015\" />\n-      <int name=\"5\" value=\"1332017\" />\n-      <int name=\"6\" value=\"1372014\" />\n-      <int name=\"7\" value=\"1372033\" />\n-      <int name=\"8\" value=\"1382007\" />\n-      <int name=\"9\" value=\"1402011\" />\n-      <int name=\"10\" value=\"1412007\" />\n-      <int name=\"11\" value=\"1422009\" />\n-      <int name=\"12\" value=\"1432006\" />\n-      <int name=\"13\" value=\"1442010\" />\n-      <int name=\"14\" value=\"1452004\" />\n-      <int name=\"15\" value=\"1462008\" />\n-      <int name=\"16\" value=\"1472025\" />\n-      <int name=\"17\" value=\"1482008\" />\n-      <int name=\"18\" value=\"1492008\" />\n-      <int name=\"19\" value=\"1492022\" />\n-      <int name=\"20\" value=\"2000002\" />\n-      <int name=\"21\" value=\"2000003\" />\n-      <int name=\"22\" value=\"2002002\" />\n-      <int name=\"23\" value=\"2002003\" />\n-      <int name=\"24\" value=\"2040302\" />\n-      <int name=\"25\" value=\"2040401\" />\n-      <int name=\"26\" value=\"2040502\" />\n-      <int name=\"27\" value=\"2040516\" />\n-      <int name=\"28\" value=\"2040614\" />\n-      <int name=\"29\" value=\"2040627\" />\n-      <int name=\"30\" value=\"2040704\" />\n-      <int name=\"31\" value=\"2040804\" />\n-      <int name=\"32\" value=\"2040825\" />\n-      <int name=\"33\" value=\"2040827\" />\n-      <int name=\"34\" value=\"2040933\" />\n-      <int name=\"35\" value=\"2040935\" />\n-      <int name=\"36\" value=\"2041002\" />\n-      <int name=\"37\" value=\"2041013\" />\n-      <int name=\"38\" value=\"2041016\" />\n-      <int name=\"39\" value=\"2041046\" />\n-      <int name=\"40\" value=\"2043201\" />\n-      <int name=\"41\" value=\"2043701\" />\n-      <int name=\"42\" value=\"2043802\" />\n-      <int name=\"43\" value=\"2044114\" />\n-      <int name=\"44\" value=\"2044116\" />\n-      <int name=\"45\" value=\"2044201\" />\n-      <int name=\"46\" value=\"2044301\" />\n-      <int name=\"47\" value=\"2044502\" />\n-      <int name=\"48\" value=\"2044801\" />\n-      <int name=\"49\" value=\"2044803\" />\n-      <int name=\"50\" value=\"2044807\" />\n-      <int name=\"51\" value=\"2044902\" />\n-      <int name=\"52\" value=\"2044904\" />\n-      <int name=\"53\" value=\"2060000\" />\n-      <int name=\"54\" value=\"2061000\" />\n-      <int name=\"55\" value=\"2388005\" />\n-      <int name=\"56\" value=\"4000113\" />\n-      <int name=\"57\" value=\"4000114\" />\n-      <int name=\"58\" value=\"4000115\" />\n-      <int name=\"59\" value=\"4004001\" />\n-      <int name=\"60\" value=\"4010003\" />\n-      <int name=\"61\" value=\"4020006\" />\n-      <int name=\"62\" value=\"4031991\" />\n+      <int name=\"1\" value=\"1312009\" />\n+      <int name=\"2\" value=\"1322018\" />\n+      <int name=\"3\" value=\"1332015\" />\n+      <int name=\"4\" value=\"1332017\" />\n+      <int name=\"5\" value=\"1372014\" />\n+      <int name=\"6\" value=\"1372033\" />\n+      <int name=\"7\" value=\"1382007\" />\n+      <int name=\"8\" value=\"1402011\" />\n+      <int name=\"9\" value=\"1412007\" />\n+      <int name=\"10\" value=\"1422009\" />\n+      <int name=\"11\" value=\"1432006\" />\n+      <int name=\"12\" value=\"1442010\" />\n+      <int name=\"13\" value=\"1452004\" />\n+      <int name=\"14\" value=\"1462008\" />\n+      <int name=\"15\" value=\"1472025\" />\n+      <int name=\"16\" value=\"1482008\" />\n+      <int name=\"17\" value=\"1492008\" />\n+      <int name=\"18\" value=\"1492022\" />\n+      <int name=\"19\" value=\"2000002\" />\n+      <int name=\"20\" value=\"2000003\" />\n+      <int name=\"21\" value=\"2002002\" />\n+      <int name=\"22\" value=\"2002003\" />\n+      <int name=\"23\" value=\"2040302\" />\n+      <int name=\"24\" value=\"2040401\" />\n+      <int name=\"25\" value=\"2040502\" />\n+      <int name=\"26\" value=\"2040516\" />\n+      <int name=\"27\" value=\"2040614\" />\n+      <int name=\"28\" value=\"2040627\" />\n+      <int name=\"29\" value=\"2040704\" />\n+      <int name=\"30\" value=\"2040804\" />\n+      <int name=\"31\" value=\"2040825\" />\n+      <int name=\"32\" value=\"2040827\" />\n+      <int name=\"33\" value=\"2040933\" />\n+      <int name=\"34\" value=\"2040935\" />\n+      <int name=\"35\" value=\"2041002\" />\n+      <int name=\"36\" value=\"2041013\" />\n+      <int name=\"37\" value=\"2041016\" />\n+      <int name=\"38\" value=\"2041046\" />\n+      <int name=\"39\" value=\"2043201\" />\n+      <int name=\"40\" value=\"2043701\" />\n+      <int name=\"41\" value=\"2043802\" />\n+      <int name=\"42\" value=\"2044114\" />\n+      <int name=\"43\" value=\"2044116\" />\n+      <int name=\"44\" value=\"2044201\" />\n+      <int name=\"45\" value=\"2044301\" />\n+      <int name=\"46\" value=\"2044502\" />\n+      <int name=\"47\" value=\"2044801\" />\n+      <int name=\"48\" value=\"2044803\" />\n+      <int name=\"49\" value=\"2044807\" />\n+      <int name=\"50\" value=\"2044902\" />\n+      <int name=\"51\" value=\"2044904\" />\n+      <int name=\"52\" value=\"2060000\" />\n+      <int name=\"53\" value=\"2061000\" />\n+      <int name=\"54\" value=\"2388005\" />\n+      <int name=\"55\" value=\"4000113\" />\n+      <int name=\"56\" value=\"4000114\" />\n+      <int name=\"57\" value=\"4000115\" />\n+      <int name=\"58\" value=\"4004001\" />\n+      <int name=\"59\" value=\"4010003\" />\n+      <int name=\"60\" value=\"4020006\" />\n+      <int name=\"61\" value=\"4031991\" />\n     </imgdir>\n     <string name=\"episode\" value=\" Lv. :  59\\nForm : Enchanted\\n\\nThe ghost of the past that originated from the deserted land in Ludibrium. It was brought back to life due to the Dimensional Schism, and has been a follower of Papulatus ever since, pestering anyone that attempts to go near the lowest level of the Clocktower. It appears in the form of an owl clock, and it tries to cling onto the past by turning back the time. \" />\n   </imgdir>\n@@ -8276,25 +8272,24 @@\n       <int name=\"7\" value=\"1072090\" />\n       <int name=\"8\" value=\"1082066\" />\n       <int name=\"9\" value=\"1102015\" />\n-      <int name=\"10\" value=\"1132003\" />\n-      <int name=\"11\" value=\"1322054\" />\n-      <int name=\"12\" value=\"1472032\" />\n-      <int name=\"13\" value=\"2000004\" />\n-      <int name=\"14\" value=\"2000006\" />\n-      <int name=\"15\" value=\"2040622\" />\n-      <int name=\"16\" value=\"2043112\" />\n-      <int name=\"17\" value=\"2044014\" />\n-      <int name=\"18\" value=\"2070005\" />\n-      <int name=\"19\" value=\"2383047\" />\n-      <int name=\"20\" value=\"4000021\" />\n-      <int name=\"21\" value=\"4000283\" />\n-      <int name=\"22\" value=\"4000285\" />\n-      <int name=\"23\" value=\"4003005\" />\n-      <int name=\"24\" value=\"4010005\" />\n-      <int name=\"25\" value=\"4020007\" />\n-      <int name=\"26\" value=\"4130002\" />\n-      <int name=\"27\" value=\"4130005\" />\n-      <int name=\"28\" value=\"4130013\" />\n+      <int name=\"10\" value=\"1322054\" />\n+      <int name=\"11\" value=\"1472032\" />\n+      <int name=\"12\" value=\"2000004\" />\n+      <int name=\"13\" value=\"2000006\" />\n+      <int name=\"14\" value=\"2040622\" />\n+      <int name=\"15\" value=\"2043112\" />\n+      <int name=\"16\" value=\"2044014\" />\n+      <int name=\"17\" value=\"2070005\" />\n+      <int name=\"18\" value=\"2383047\" />\n+      <int name=\"19\" value=\"4000021\" />\n+      <int name=\"20\" value=\"4000283\" />\n+      <int name=\"21\" value=\"4000285\" />\n+      <int name=\"22\" value=\"4003005\" />\n+      <int name=\"23\" value=\"4010005\" />\n+      <int name=\"24\" value=\"4020007\" />\n+      <int name=\"25\" value=\"4130002\" />\n+      <int name=\"26\" value=\"4130005\" />\n+      <int name=\"27\" value=\"4130013\" />\n     </imgdir>\n     <string name=\"episode\" value=\" Lv. :  60\\nForm : Mammal\\nSpecial Trait : -50% Fire Attribute Damage. -50% Ice Attribute Damage. Vulnerable to Sanctity Attribute Attacks.\\n\\nA type of bear that lives near Mu Lung. Although it is just a bear, it sincerely desires to become a virtuous master; hence, it is always wearing its training uniform, completely immersed in training. It has features similar to those of humans, but no one knows whether that is because it is close to becoming a virtuous master or because that's just one of this monster's special traits.\" />\n   </imgdir>\n@@ -8315,31 +8310,30 @@\n       <int name=\"7\" value=\"1060092\" />\n       <int name=\"8\" value=\"1060095\" />\n       <int name=\"9\" value=\"1082062\" />\n-      <int name=\"10\" value=\"1302056\" />\n-      <int name=\"11\" value=\"1332055\" />\n-      <int name=\"12\" value=\"1382039\" />\n-      <int name=\"13\" value=\"1402003\" />\n-      <int name=\"14\" value=\"1402011\" />\n-      <int name=\"15\" value=\"1452022\" />\n-      <int name=\"16\" value=\"2000002\" />\n-      <int name=\"17\" value=\"2000004\" />\n-      <int name=\"18\" value=\"2000006\" />\n-      <int name=\"19\" value=\"2040301\" />\n-      <int name=\"20\" value=\"2040421\" />\n-      <int name=\"21\" value=\"2043001\" />\n-      <int name=\"22\" value=\"2044802\" />\n-      <int name=\"23\" value=\"2049000\" />\n-      <int name=\"24\" value=\"2330003\" />\n-      <int name=\"25\" value=\"2384008\" />\n-      <int name=\"26\" value=\"4000021\" />\n-      <int name=\"27\" value=\"4000295\" />\n-      <int name=\"28\" value=\"4003005\" />\n-      <int name=\"29\" value=\"4004000\" />\n-      <int name=\"30\" value=\"4007007\" />\n-      <int name=\"31\" value=\"4010006\" />\n-      <int name=\"32\" value=\"4020004\" />\n-      <int name=\"33\" value=\"4130000\" />\n-      <int name=\"34\" value=\"4130012\" />\n+      <int name=\"10\" value=\"1332055\" />\n+      <int name=\"11\" value=\"1382039\" />\n+      <int name=\"12\" value=\"1402003\" />\n+      <int name=\"13\" value=\"1402011\" />\n+      <int name=\"14\" value=\"1452022\" />\n+      <int name=\"15\" value=\"2000002\" />\n+      <int name=\"16\" value=\"2000004\" />\n+      <int name=\"17\" value=\"2000006\" />\n+      <int name=\"18\" value=\"2040301\" />\n+      <int name=\"19\" value=\"2040421\" />\n+      <int name=\"20\" value=\"2043001\" />\n+      <int name=\"21\" value=\"2044802\" />\n+      <int name=\"22\" value=\"2049000\" />\n+      <int name=\"23\" value=\"2330003\" />\n+      <int name=\"24\" value=\"2384008\" />\n+      <int name=\"25\" value=\"4000021\" />\n+      <int name=\"26\" value=\"4000295\" />\n+      <int name=\"27\" value=\"4003005\" />\n+      <int name=\"28\" value=\"4004000\" />\n+      <int name=\"29\" value=\"4007007\" />\n+      <int name=\"30\" value=\"4010006\" />\n+      <int name=\"31\" value=\"4020004\" />\n+      <int name=\"32\" value=\"4130000\" />\n+      <int name=\"33\" value=\"4130012\" />\n     </imgdir>\n     <string name=\"episode\" value=\" Lv. :  64\\nForm : Reptile\\n\\nA monster alligator that lives in the swampy regions near the Herb Town. It enjoys the company of small animals, so it is often seen carrying a little bird on its head and a baby Bellflower Root on its back. It does not attack unless provoked, but it turns into a ferocious monster when attacked.\" />\n   </imgdir>\n@@ -9423,27 +9417,26 @@\n       <int name=\"12\" value=\"1072165\" />\n       <int name=\"13\" value=\"1082105\" />\n       <int name=\"14\" value=\"1082108\" />\n-      <int name=\"15\" value=\"1302056\" />\n-      <int name=\"16\" value=\"1312009\" />\n-      <int name=\"17\" value=\"1332015\" />\n-      <int name=\"18\" value=\"1372015\" />\n-      <int name=\"19\" value=\"1372016\" />\n-      <int name=\"20\" value=\"1402011\" />\n-      <int name=\"21\" value=\"1412011\" />\n-      <int name=\"22\" value=\"1422014\" />\n-      <int name=\"23\" value=\"1492009\" />\n-      <int name=\"24\" value=\"2000004\" />\n-      <int name=\"25\" value=\"2000006\" />\n-      <int name=\"26\" value=\"2040618\" />\n-      <int name=\"27\" value=\"2041021\" />\n-      <int name=\"28\" value=\"2044301\" />\n-      <int name=\"29\" value=\"2050000\" />\n-      <int name=\"30\" value=\"2384026\" />\n-      <int name=\"31\" value=\"4000079\" />\n-      <int name=\"32\" value=\"4010004\" />\n-      <int name=\"33\" value=\"4020007\" />\n-      <int name=\"34\" value=\"4130002\" />\n-      <int name=\"35\" value=\"4130003\" />\n+      <int name=\"15\" value=\"1312009\" />\n+      <int name=\"16\" value=\"1332015\" />\n+      <int name=\"17\" value=\"1372015\" />\n+      <int name=\"18\" value=\"1372016\" />\n+      <int name=\"19\" value=\"1402011\" />\n+      <int name=\"20\" value=\"1412011\" />\n+      <int name=\"21\" value=\"1422014\" />\n+      <int name=\"22\" value=\"1492009\" />\n+      <int name=\"23\" value=\"2000004\" />\n+      <int name=\"24\" value=\"2000006\" />\n+      <int name=\"25\" value=\"2040618\" />\n+      <int name=\"26\" value=\"2041021\" />\n+      <int name=\"27\" value=\"2044301\" />\n+      <int name=\"28\" value=\"2050000\" />\n+      <int name=\"29\" value=\"2384026\" />\n+      <int name=\"30\" value=\"4000079\" />\n+      <int name=\"31\" value=\"4010004\" />\n+      <int name=\"32\" value=\"4020007\" />\n+      <int name=\"33\" value=\"4130002\" />\n+      <int name=\"34\" value=\"4130003\" />\n     </imgdir>\n     <string name=\"episode\" value=\" Lv. :  72\\nForm : Mammal\\n\\nA monster born in an ocean of lava in a cave. With its reddish eyes, monstrous teeth, and spiky collar, Cerebes threatens its enemies although it only  uses melee attacks. When Cerebes evolves into Bain, however, it will use powerful attacks of fire attribute, so beware. \" />\n   </imgdir>\n@@ -10381,68 +10374,66 @@\n     </imgdir>\n     <imgdir name=\"reward\">\n       <int name=\"0\" value=\"1032021\" />\n-      <int name=\"1\" value=\"1132001\" />\n-      <int name=\"2\" value=\"1132003\" />\n-      <int name=\"3\" value=\"1302012\" />\n-      <int name=\"4\" value=\"1312010\" />\n-      <int name=\"5\" value=\"1322019\" />\n-      <int name=\"6\" value=\"1332018\" />\n-      <int name=\"7\" value=\"1372015\" />\n-      <int name=\"8\" value=\"1382010\" />\n-      <int name=\"9\" value=\"1402012\" />\n-      <int name=\"10\" value=\"1412008\" />\n-      <int name=\"11\" value=\"1422010\" />\n-      <int name=\"12\" value=\"1432007\" />\n-      <int name=\"13\" value=\"1442008\" />\n-      <int name=\"14\" value=\"1452011\" />\n-      <int name=\"15\" value=\"1462009\" />\n-      <int name=\"16\" value=\"1472029\" />\n-      <int name=\"17\" value=\"1482009\" />\n-      <int name=\"18\" value=\"1492009\" />\n-      <int name=\"19\" value=\"2000002\" />\n-      <int name=\"20\" value=\"2000003\" />\n-      <int name=\"21\" value=\"2002004\" />\n-      <int name=\"22\" value=\"2002011\" />\n-      <int name=\"23\" value=\"2022142\" />\n-      <int name=\"24\" value=\"2040004\" />\n-      <int name=\"25\" value=\"2040005\" />\n-      <int name=\"26\" value=\"2040025\" />\n-      <int name=\"27\" value=\"2040514\" />\n-      <int name=\"28\" value=\"2040705\" />\n-      <int name=\"29\" value=\"2040805\" />\n-      <int name=\"30\" value=\"2040825\" />\n-      <int name=\"31\" value=\"2040901\" />\n-      <int name=\"32\" value=\"2041001\" />\n-      <int name=\"33\" value=\"2041010\" />\n-      <int name=\"34\" value=\"2041022\" />\n-      <int name=\"35\" value=\"2041043\" />\n-      <int name=\"36\" value=\"2043019\" />\n-      <int name=\"37\" value=\"2043101\" />\n-      <int name=\"38\" value=\"2043301\" />\n-      <int name=\"39\" value=\"2043801\" />\n-      <int name=\"40\" value=\"2044014\" />\n-      <int name=\"41\" value=\"2044101\" />\n-      <int name=\"42\" value=\"2044312\" />\n-      <int name=\"43\" value=\"2044412\" />\n-      <int name=\"44\" value=\"2044501\" />\n-      <int name=\"45\" value=\"2044601\" />\n-      <int name=\"46\" value=\"2044801\" />\n-      <int name=\"47\" value=\"2044803\" />\n-      <int name=\"48\" value=\"2048005\" />\n-      <int name=\"49\" value=\"2049100\" />\n-      <int name=\"50\" value=\"2049101\" />\n-      <int name=\"51\" value=\"2060001\" />\n-      <int name=\"52\" value=\"2061001\" />\n-      <int name=\"53\" value=\"2070004\" />\n-      <int name=\"54\" value=\"2388010\" />\n-      <int name=\"55\" value=\"4000021\" />\n-      <int name=\"56\" value=\"4000283\" />\n-      <int name=\"57\" value=\"4000284\" />\n-      <int name=\"58\" value=\"4000285\" />\n-      <int name=\"59\" value=\"4004000\" />\n-      <int name=\"60\" value=\"4010001\" />\n-      <int name=\"61\" value=\"4010004\" />\n-      <int name=\"62\" value=\"4020006\" />\n+      <int name=\"1\" value=\"1302012\" />\n+      <int name=\"2\" value=\"1312010\" />\n+      <int name=\"3\" value=\"1322019\" />\n+      <int name=\"4\" value=\"1332018\" />\n+      <int name=\"5\" value=\"1372015\" />\n+      <int name=\"6\" value=\"1382010\" />\n+      <int name=\"7\" value=\"1402012\" />\n+      <int name=\"8\" value=\"1412008\" />\n+      <int name=\"9\" value=\"1422010\" />\n+      <int name=\"10\" value=\"1432007\" />\n+      <int name=\"11\" value=\"1442008\" />\n+      <int name=\"12\" value=\"1452011\" />\n+      <int name=\"13\" value=\"1462009\" />\n+      <int name=\"14\" value=\"1472029\" />\n+      <int name=\"15\" value=\"1482009\" />\n+      <int name=\"16\" value=\"1492009\" />\n+      <int name=\"17\" value=\"2000002\" />\n+      <int name=\"18\" value=\"2000003\" />\n+      <int name=\"19\" value=\"2002004\" />\n+      <int name=\"20\" value=\"2002011\" />\n+      <int name=\"21\" value=\"2022142\" />\n+      <int name=\"22\" value=\"2040004\" />\n+      <int name=\"23\" value=\"2040005\" />\n+      <int name=\"24\" value=\"2040025\" />\n+      <int name=\"25\" value=\"2040514\" />\n+      <int name=\"26\" value=\"2040705\" />\n+      <int name=\"27\" value=\"2040805\" />\n+      <int name=\"28\" value=\"2040825\" />\n+      <int name=\"29\" value=\"2040901\" />\n+      <int name=\"30\" value=\"2041001\" />\n+      <int name=\"31\" value=\"2041010\" />\n+      <int name=\"32\" value=\"2041022\" />\n+      <int name=\"33\" value=\"2041043\" />\n+      <int name=\"34\" value=\"2043019\" />\n+      <int name=\"35\" value=\"2043101\" />\n+      <int name=\"36\" value=\"2043301\" />\n+      <int name=\"37\" value=\"2043801\" />\n+      <int name=\"38\" value=\"2044014\" />\n+      <int name=\"39\" value=\"2044101\" />\n+      <int name=\"40\" value=\"2044312\" />\n+      <int name=\"41\" value=\"2044412\" />\n+      <int name=\"42\" value=\"2044501\" />\n+      <int name=\"43\" value=\"2044601\" />\n+      <int name=\"44\" value=\"2044801\" />\n+      <int name=\"45\" value=\"2044803\" />\n+      <int name=\"46\" value=\"2048005\" />\n+      <int name=\"47\" value=\"2049100\" />\n+      <int name=\"48\" value=\"2049101\" />\n+      <int name=\"49\" value=\"2060001\" />\n+      <int name=\"50\" value=\"2061001\" />\n+      <int name=\"51\" value=\"2070004\" />\n+      <int name=\"52\" value=\"2388010\" />\n+      <int name=\"53\" value=\"4000021\" />\n+      <int name=\"54\" value=\"4000283\" />\n+      <int name=\"55\" value=\"4000284\" />\n+      <int name=\"56\" value=\"4000285\" />\n+      <int name=\"57\" value=\"4004000\" />\n+      <int name=\"58\" value=\"4010001\" />\n+      <int name=\"59\" value=\"4010004\" />\n+      <int name=\"60\" value=\"4020006\" />\n     </imgdir>\n     <string name=\"episode\" value=\" Lv. :  71\\nForm : Mammal\\n\\nAn apprentice of Mu Lung who had once trained to become a virtuous master, until it harmed a lot of people under the magic spell of the Priest Cat. It has, since then, chosen the path of penance, although it still occasionally harms people due to the lingering spell. Its physique of a trainee and its magic render this monster a difficult enemy to defeat.\" />\n   </imgdir>\n@@ -13241,10 +13232,9 @@\n       <int name=\"49\" value=\"4000048\" />\n       <int name=\"50\" value=\"4000049\" />\n       <int name=\"51\" value=\"4000051\" />\n-      <int name=\"52\" value=\"4000257\" />\n-      <int name=\"53\" value=\"4004002\" />\n-      <int name=\"54\" value=\"4010004\" />\n-      <int name=\"55\" value=\"4020004\" />\n+      <int name=\"52\" value=\"4004002\" />\n+      <int name=\"53\" value=\"4010004\" />\n+      <int name=\"54\" value=\"4020004\" />\n     </imgdir>\n     <string name=\"episode\" value=\" Lv. :  90\\nForm : Mammal\\n\\nAccording to legend, this Snowman was born between a human and a Snow Spirit. It has the soul of a human but was born with the appearance of a monster which caused him much grief growing up as he was constantly taunted by other humans. The Snow Spirit, who watched Snowman's sad situation, froze up an entire mountain range for Snowman and called it El Nath. Snowman doesn't like humans and hence stays away from them as much as possible, but he'd never attack a human first on his own. However, it will mercilessly attack anyone who breaks the Fragment of the Snow Spirit.\" />\n   </imgdir>"}]}]},
