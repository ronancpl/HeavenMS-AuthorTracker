{"fetchDate": "2019-12-19", "content": [{"sha": "fa376739134d0bbf108c7cca70762c486d55328a", "node_id": "MDY6Q29tbWl0NDUwODIwMjM6ZmEzNzY3MzkxMzRkMGJiZjEwOGM3Y2NhNzA3NjJjNDg2ZDU1MzI4YQ==", "commit": {"author": {"name": "ronancpl", "email": "rcpl2010@gmail.com", "date": "2017-04-27T11:42:06Z"}, "committer": {"name": "ronancpl", "email": "rcpl2010@gmail.com", "date": "2017-04-27T11:42:06Z"}, "message": "Ban/Unban command fix\n\nBug detected by vcoc. Solution requires update at SQL tables \"macbans\"\nand \"ipbans\".", "tree": {"sha": "c89080afddb2505d5b8866b63549e929a1d0e0c0", "url": "https://api.github.com/repos/ronancpl/HeavenMS/git/trees/c89080afddb2505d5b8866b63549e929a1d0e0c0"}, "url": "https://api.github.com/repos/ronancpl/HeavenMS/git/commits/fa376739134d0bbf108c7cca70762c486d55328a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/fa376739134d0bbf108c7cca70762c486d55328a", "html_url": "https://github.com/ronancpl/HeavenMS/commit/fa376739134d0bbf108c7cca70762c486d55328a", "comments_url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/fa376739134d0bbf108c7cca70762c486d55328a/comments", "author": {"login": "ronancpl", "id": 9257761, "node_id": "MDQ6VXNlcjkyNTc3NjE=", "avatar_url": "https://avatars2.githubusercontent.com/u/9257761?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ronancpl", "html_url": "https://github.com/ronancpl", "followers_url": "https://api.github.com/users/ronancpl/followers", "following_url": "https://api.github.com/users/ronancpl/following{/other_user}", "gists_url": "https://api.github.com/users/ronancpl/gists{/gist_id}", "starred_url": "https://api.github.com/users/ronancpl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ronancpl/subscriptions", "organizations_url": "https://api.github.com/users/ronancpl/orgs", "repos_url": "https://api.github.com/users/ronancpl/repos", "events_url": "https://api.github.com/users/ronancpl/events{/privacy}", "received_events_url": "https://api.github.com/users/ronancpl/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ronancpl", "id": 9257761, "node_id": "MDQ6VXNlcjkyNTc3NjE=", "avatar_url": "https://avatars2.githubusercontent.com/u/9257761?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ronancpl", "html_url": "https://github.com/ronancpl", "followers_url": "https://api.github.com/users/ronancpl/followers", "following_url": "https://api.github.com/users/ronancpl/following{/other_user}", "gists_url": "https://api.github.com/users/ronancpl/gists{/gist_id}", "starred_url": "https://api.github.com/users/ronancpl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ronancpl/subscriptions", "organizations_url": "https://api.github.com/users/ronancpl/orgs", "repos_url": "https://api.github.com/users/ronancpl/repos", "events_url": "https://api.github.com/users/ronancpl/events{/privacy}", "received_events_url": "https://api.github.com/users/ronancpl/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f5fbb038e9fb2de20a4607a1524bda3f863bfd72", "url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/f5fbb038e9fb2de20a4607a1524bda3f863bfd72", "html_url": "https://github.com/ronancpl/HeavenMS/commit/f5fbb038e9fb2de20a4607a1524bda3f863bfd72"}], "stats": {"total": 239, "additions": 99, "deletions": 140}, "files": [{"sha": "0e7af8572f271fab80353ac2742720bacbdb563a", "filename": "README.txt", "status": "modified", "additions": 8, "deletions": 5, "changes": 13, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fa376739134d0bbf108c7cca70762c486d55328a/README.txt", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fa376739134d0bbf108c7cca70762c486d55328a/README.txt", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/README.txt?ref=fa376739134d0bbf108c7cca70762c486d55328a", "patch": "@@ -2,12 +2,16 @@ MapleSolaxiaV2\n \n Freelance developer: Ronan C. P. Lana\n \n-Credits are to be given to the original MapleSolaxia staff and other colaborators, as just some minor changes/patches on the game were applied by myself, in which some of them diverged from the original v83 patch contents.\n+Credits are to be given too to Nexon(Duh!), the original MapleSolaxia staff, and other colaborators, as just some changes/patches on the game were applied by myself, in which some of them diverged from the original v83 patch contents.\n+\n+Regarding distributability and usage of the code presented here: like it was before, this MapleStory server is open-source. By that, it is meant that anyone is free to install, use, modify and redistribute the contents, as long as there is no kind of commercial trading involved and the credits to the original creators are maintained within the codes.\n \n This is a NetBeans 8.0.2 Project. This means that it's easier to install the project via opening the server project folder inside NetBeans' IDE. Once installed, build this project on your machine and run the server using the \"launch.bat\" application.\n \n In this project, many gameplay-wise issues generated from either the original WZ files and the server sources have been partially or completely solved. From now on, considering the use of some of this system's edited WZ and server-side files should be a great asset for new private server instances. My opinion, though! Refer to \"README_wzchanges.txt\" for more information on what have been changed from Nexon's v83 WZ files.\n \n+The main objective of this project is to try as best as possible to recreate what once was the original MapleStory v83, while adding up some flavors that spices up the gameplay. In other words, to aim to get the best of the MapleStory of that era.\n+\n ---- Download items ----\n \n Server files: https://github.com/ronancpl/MapleSolaxiaV2\n@@ -17,7 +21,7 @@ Client files & general tools: https://drive.google.com/drive/folders/0BzDsHSr-0V\n \n The following link teaches on how to install a MapleStory v83 private server, however IT DIFFERS on what is used here: http://forum.ragezone.com/f428/maplestory-private-server-v83-741739/\n \n-Use that link ONLY AS AN ORIENTATION on where here things become ambiguous.\n+Use that link ONLY AS AN ORIENTATION on where here things start to become ambiguous.\n \n Firstly, install all the general tools required to run the server:\n \t- WampServer2.0i.exe -> recipient of the server.\n@@ -61,8 +65,7 @@ Now it must be done CAREFULLY:\n \t- File -> Open Script... -> Browse for \"C:\\MapleSolaxia\\sql\" -> db_database.sql, and execute it.\n \t- File -> Open Script... -> Browse for \"C:\\MapleSolaxia\\sql\" -> db_drops.sql, and execute it.\n \n-Now it is OPTIONAL, you don't need to run it if you don't want, as it will simply change some NPC shops to set\n-some new goods, not present in the original MapleStory, to sell:\n+Now it is OPTIONAL, you don't need to run it if you don't want, as it will simply change some NPC shops to set some new goods, not present in the original MapleStory, to sell:\n \t- File -> Open Script... -> Browse for \"C:\\MapleSolaxia\\sql\" -> db_shopupdate.sql, and execute it.\n \n At the end of the execution of these SQLs, you should have installed a database schema named \"maplesolaxia\". REGISTER YOUR FIRST ACCOUNT to be used in-game by creating manually a entry on the table \"accounts\" at that database with a login and a password.\n@@ -120,7 +123,7 @@ As an example of client WZ editing, consider the MobBookUpdate project I develop\n \n At this point, the server-side Monster Book has been updated with the current state of the database's drop data. Then, open HaRepacker 4.2.2 and load \"String.wz\" from \"C:\\Nexon\\MapleStory\". Drop the \"MonsterBook.img\" node by removing it from the hierarchy tree, then (CONTRARY TO WHAT SHOULD BE DONE NORMALLY!) import the server's \"MonsterBook.img.xml\".\n \n-Take note that this is absolutely dangerous if done unwary. Once the MonsterBook does not hold client specific data in it's node contents, importing the XML causes no harm at all. However, try not to remove/reimport nodes from WZ files, as it may cause data losses. Use the HaRepacker's UI instead to make the changes.\n+Take note that this is absolutely dangerous if done unwary. Once the MonsterBook.img does not hold client specific data in it's node contents, importing the XML causes no harm at all. However, try not to remove/reimport nodes from WZ files, as it may cause data losses. Use the HaRepacker's UI instead to make the changes.\n \n Save the changes and overwrite the older WZ on the MapleStory client folder.\n "}, {"sha": "9fc8206cdac73d1fe1432270724d38bc9785ef5e", "filename": "mychanges_ptbr.txt", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fa376739134d0bbf108c7cca70762c486d55328a/mychanges_ptbr.txt", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fa376739134d0bbf108c7cca70762c486d55328a/mychanges_ptbr.txt", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/mychanges_ptbr.txt?ref=fa376739134d0bbf108c7cca70762c486d55328a", "patch": "@@ -178,4 +178,7 @@ Nova PQ: Boss Rush PQ.\n Corre\ufffd\ufffdo de situa\ufffd\ufffdes nas PQs Ellin e Pirate.\n \n 26 Abril 2017,\n-Adi\ufffd\ufffdo de Happyville, via Rooney.\n\\ No newline at end of file\n+Adi\ufffd\ufffdo de Happyville, via Rooney.\n+Corre\ufffd\ufffdo: mapas com \"everlast\" fazendo os itens dropados sumirem.\n+Corre\ufffd\ufffdo: itens dropados na \ufffdrea dos NPCs Snowman n\ufffdo podem ser pegos por outros jogadores.\n+Corre\ufffd\ufffdo: bug no par de comandos unban/ban n\ufffdo permitindo IP de cliente voltar a reconectar ao jogo.\n\\ No newline at end of file"}, {"sha": "e4eefaaf959232edeaf0db3469aa10d7e8bd474d", "filename": "nbproject/private/private.xml", "status": "modified", "additions": 4, "deletions": 9, "changes": 13, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fa376739134d0bbf108c7cca70762c486d55328a/nbproject/private/private.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fa376739134d0bbf108c7cca70762c486d55328a/nbproject/private/private.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/nbproject/private/private.xml?ref=fa376739134d0bbf108c7cca70762c486d55328a", "patch": "@@ -3,16 +3,11 @@\n     <editor-bookmarks xmlns=\"http://www.netbeans.org/ns/editor-bookmarks/2\" lastBookmarkId=\"0\"/>\n     <open-files xmlns=\"http://www.netbeans.org/ns/projectui-open-files/2\">\n         <group>\n-            <file>file:/C:/Nexon/MapleSolaxia/scripts/npc/world0/2002000.js</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/scripts/npc/world0/1022101.js</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/src/server/maps/MapleMapItem.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/scripts/npc/world0/9000020.js</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/src/server/maps/SavedLocationType.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/sql/db_database.sql</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/scripts/npc/world0/2133000.js</file>\n             <file>file:/C:/Nexon/MapleSolaxia/src/client/MapleCharacter.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/src/net/server/channel/handlers/ItemPickupHandler.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/src/server/maps/MapleMap.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/src/server/MapleInventoryManipulator.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/scripts/npc/world0/9020000.js</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/src/constants/ServerConstants.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/src/server/maps/MapleReactor.java</file>\n         </group>\n     </open-files>\n </project-private>"}, {"sha": "5b2fb313066768f7c04132936bf89fce8ea63b81", "filename": "scripts/npc/world0/9000036.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fa376739134d0bbf108c7cca70762c486d55328a/scripts/npc/world0/9000036.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fa376739134d0bbf108c7cca70762c486d55328a/scripts/npc/world0/9000036.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/world0/9000036.js?ref=fa376739134d0bbf108c7cca70762c486d55328a", "patch": "@@ -42,7 +42,7 @@ var maxEqp = 0;\n \n function start() {\n     cm.getPlayer().setCS(true);\n-    var selStr = \"Hello, I am the #bAccessory NPC Crafter#k! My works are widely recognized to be too fine, to the point which all my items mimic not only the appearance but too the attributes of them! Everything I charge is some 'ingredients' to make them and, of course, a fee for my services. On what kind of equipment will you take a look?#b\";\n+    var selStr = \"Hello, I am the #bAccessory NPC Crafter#k! My works are widely recognized to be too fine, up to the point at which all my items mimic not only the appearance but too the attributes of them! Everything I charge is some 'ingredients' to make them and, of course, a fee for my services. On what kind of equipment are you interessed?#b\";\n     var options = [\"Pendants\",\"Face accessories\",\"Eye accessories\",\"Belts & medals\",\"Rings\",\"#t4032496#\"];\n     for (var i = 0; i < options.length; i++)\n         selStr += \"\\r\\n#L\" + i + \"# \" + options[i] + \"#l\";"}, {"sha": "dc2044a2cd4ab58a72d3691a96e767924718bd01", "filename": "scripts/npc/world0/9020000.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fa376739134d0bbf108c7cca70762c486d55328a/scripts/npc/world0/9020000.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fa376739134d0bbf108c7cca70762c486d55328a/scripts/npc/world0/9020000.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/world0/9020000.js?ref=fa376739134d0bbf108c7cca70762c486d55328a", "patch": "@@ -32,7 +32,7 @@\n var status;\n var minLevel = 21;\n var maxLevel = 255;\n-var minPlayers = 3;\n+var minPlayers = 1;\n var maxPlayers = 6;\n \n function start() {"}, {"sha": "640434c8ac5c481f33fb7074f8cc4091b4834696", "filename": "scripts/npc/world0/9201023.js", "status": "modified", "additions": 38, "deletions": 115, "changes": 153, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fa376739134d0bbf108c7cca70762c486d55328a/scripts/npc/world0/9201023.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fa376739134d0bbf108c7cca70762c486d55328a/scripts/npc/world0/9201023.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/world0/9201023.js?ref=fa376739134d0bbf108c7cca70762c486d55328a", "patch": "@@ -23,120 +23,43 @@\n  *9201023 - Nana(K)\n  *@author Jvlaple\n  */\n-var status = -1; \n-\n-\n+ \n function start() {\n-\tcm.sendOk(\"Your skills have been added!\");\n-    action(1, 0, 0);\n+    cm.sendOk(\"Hi, I'm Nana the love fairy... Hows it going?\");\n+    cm.dispose();\n }\n-\n-function action(mode, type, selection) {\n-    if (mode == -1) {\n-        cm.dispose();\n-    } else {\n-        if (mode == 0 && status == 0) {\n-            cm.dispose();\n-            return;\n-        }\n-        if (mode == 1)\n-            status++;\n-        else\n-            status--;\n-\t      if (cm.getPlayer().getJob().getId() > 2000) {\n-\t    \t  if (cm.getPlayer().getSkillLevel(21001003) < 1)\n-\t    \t  \tcm.teachSkill(21001003, 0, 20,-1); // Pole Arm Booster\n-\t    \t  if (cm.getPlayer().getSkillLevel(21100004) < 1)  \n-\t    \t\t  cm.teachSkill(21100004,0, 20,-1); // Combo Smash\n-\t    \t  if (cm.getPlayer().getSkillLevel(21100005) < 1)\n-\t\t        cm.teachSkill(21100005,0, 20,-1); // Combo Drain\n-\t    \t  if (cm.getPlayer().getSkillLevel(21100000) < 1)\n-\t\t        cm.teachSkill(21100000,0, 20,-1); // Pole Arm Mastery\n-\t    \t  if (cm.getPlayer().getSkillLevel(21100002) < 1)\n-\t\t        cm.teachSkill(21100002,0, 30,-1); // Final Charge\n-\t    \t  if (cm.getPlayer().getSkillLevel(21110002) < 1)\n-\t\t        cm.teachSkill(21110002,0, 20,-1); // Full Swing\n-\t    \t  if (cm.getPlayer().getSkillLevel(21110002) > 1)\n-\t\t\t        cm.teachSkill(21110007, cm.getPlayer().getSkillLevel(21110002), 20,-1); // Full Swing\n-\t    \t  if (cm.getPlayer().getSkillLevel(21110002) > 1)\n-\t\t\t        cm.teachSkill(21110008, cm.getPlayer().getSkillLevel(21110002), 20,-1); // Full Swing\n-\t      } else if (cm.getPlayer().getJob().getId() == 232) {\n-\t    \t  if (cm.getPlayer().getSkillLevel(2321008) < 1)\n-\t    \t\t  cm.teachSkill(2321008, 0, 10,-1); // Genesis \n-\t    \t  if (cm.getPlayer().getSkillLevel(2321006) < 1)\n-\t\t    \t  cm.teachSkill(2321006, 0, 10,-1); // res \t    \t  \n-\t      } else if (cm.getPlayer().getJob().getId() == 112) { \n-\t    \t  if (cm.getPlayer().getSkillLevel(1121006) < 1)\n-\t    \t\t  cm.teachSkill(1121006, 0, 10,-1); // pali rush\n-\t    \t  if (cm.getPlayer().getSkillLevel(1121002) < 1)\n-\t\t    \t  cm.teachSkill(1121002, 0, 10,-1); // power stance\t \t    \t  \n-\t      } else if (cm.getPlayer().getJob().getId() == 122) { \n-\t    \t  if (cm.getPlayer().getSkillLevel(1221007) < 1)\n-\t    \t\t  cm.teachSkill(1221007, 0, 10,-1); // hero rush\t  \n-\t    \t  if (cm.getPlayer().getSkillLevel(1221002) < 1)\n-\t\t    \t  cm.teachSkill(1221002, 0, 10,-1); // power stance\t  \t    \t  \n-\t      } else if (cm.getPlayer().getJob().getId() == 132) { \n-\t    \t  if (cm.getPlayer().getSkillLevel(1320006) < 1)\n-\t    \t  cm.teachSkill(1320006, 0, 10,-1); // Berzerk\n-\t    \t  if (cm.getPlayer().getSkillLevel(1321003) < 1)\n-\t    \t  cm.teachSkill(1321003, 0, 10,-1); // DrK Rush\n-\t    \t  if (cm.getPlayer().getSkillLevel(1321002) < 1)\n-\t\t    \t  cm.teachSkill(1321002, 0, 10,-1); // power stance\t \t    \t  \n-\t      } else if (cm.getPlayer().getJob().getId() == 312) { \n-\t    \t  if (cm.getPlayer().getSkillLevel(3121008) < 1)\n-\t    \t  cm.teachSkill(3121008, 0, 10,-1); // Concentrate\t    \t  \n-\t      } else if (cm.getPlayer().getJob().getId() == 512) { \n-\t    \t  if (cm.getPlayer().getSkillLevel(5121003) < 1)\n-\t\t    \t  cm.teachSkill(5121003, 0, 10,-1); // super transformation\n-\t    \t  if (cm.getPlayer().getSkillLevel(5121004) < 1)\n-\t\t    \t  cm.teachSkill(5121004, 0, 10,-1); // demo\n-\t    \t  if (cm.getPlayer().getSkillLevel(5121005) < 1)\n-\t\t    \t  cm.teachSkill(5121005, 0, 10,-1); // snatch\n-\t      } else if (cm.getPlayer().getJob().getId() == 522) { \n-\t    \t  if (cm.getPlayer().getSkillLevel(5221006) < 1)\n-\t\t    \t  cm.teachSkill(5221006, 0, 10,-1); // ship\n-\t    \t  if (cm.getPlayer().getSkillLevel(5221007) < 1)\n-\t\t    \t  cm.teachSkill(5221007, 0, 10,-1); // cannon\n-\t    \t  if (cm.getPlayer().getSkillLevel(5221008) < 1)\n-\t\t    \t  cm.teachSkill(5221008, 0, 10,-1); // torpedo\n-\t    \t  if (cm.getPlayer().getSkillLevel(5221009) < 1)\n-\t\t    \t  cm.teachSkill(5221009, 0, 10,-1); // hypno \n-\t    \t  if (cm.getPlayer().getSkillLevel(5221003) < 1)\n-\t\t    \t  cm.teachSkill(5221003, 0, 10,-1); // air strike\t    \t  \n-\t      } else if (cm.getPlayer().getJob().getId() == 422) { \n-\t    \t  if (cm.getPlayer().getSkillLevel(4221001) < 1)\n-\t\t    \t  cm.teachSkill(4221001, 0, 10,-1); // assassinate\n-\t    \t  if (cm.getPlayer().getSkillLevel(4221006) < 1)\n-\t\t    \t  cm.teachSkill(4221006, 0, 10,-1); // smoke screen  \n-\t      } else if (cm.getPlayer().getJob().getId() == 222) { \n-\t    \t  if (cm.getPlayer().getSkillLevel(2221007) < 1)\n-\t\t    \t  cm.teachSkill(2221007, 0, 10,-1); // blizzard\n-\t      } else if (cm.getPlayer().getJob().getId() == 212) { \n-\t    \t  if (cm.getPlayer().getSkillLevel(2121007) < 1)\n-\t\t    \t  cm.teachSkill(2121007, 0, 10,-1); // meteor\t    \t  \n-\t    \t  \n-\t      }\n-\t    \t  cm.dispose();\n-        /*\n-        if (cm.getPlayer().getMarriageQuestLevel() == 1 || cm.getPlayer().getMarriageQuestLevel() == 52) {\n-            if (!cm.haveItem(4000015, 40)) {\n-                if (status == 0) {\n-                    cm.sendNext(\"Hey, you look like you need proofs of love? I can get them for you.\");\n-                } else if (status == 1) {\n-                    cm.sendNext(\"All you have to do is bring me 40 #bHorned Mushroom Caps#k.\");\n-                    cm.dispose();\n-                }\n-            } else {\n-                if (status == 0) {\n-                    cm.sendNext(\"Wow, you were quick! Heres the proof of love...\");\n-                    cm.gainItem(4000015, -40)\n-                    cm.gainItem(4031367, 1);\n-                    cm.dispose();\n-                }\n-            }\n-        } else {\n-            cm.sendOk(\"Hi, I'm Nana the love fairy... Hows it going?\");\n-            cm.dispose();\n-        }*/\n-    }\n-}\n\\ No newline at end of file\n+//\n+//function action(mode, type, selection) {\n+//    if (mode == -1) {\n+//        cm.dispose();\n+//    } else {\n+//        if (mode == 0 && status == 0) {\n+//            cm.dispose();\n+//            return;\n+//        }\n+//        if (mode == 1)\n+//            status++;\n+//        else\n+//            status--;\n+//        if (cm.getPlayer().getMarriageQuestLevel() == 1 || cm.getPlayer().getMarriageQuestLevel() == 52) {\n+//            if (!cm.haveItem(4000083, 20)) {\n+//                if (status == 0) {\n+//                    cm.sendNext(\"Hey, you look like you need proofs of love? I can get them for you.\");\n+//                } else if (status == 1) {\n+//                    cm.sendNext(\"All you have to do is bring me 20 #bJr. Sentinel Pieces.#k.\");\n+//                    cm.dispose();\n+//                }\n+//            } else {\n+//                if (status == 0) {\n+//                    cm.sendNext(\"Wow, you were quick! Heres the proof of love...\");\n+//                    cm.gainItem(4000083, -20)\n+//                    cm.gainItem(4031369, 1);\n+//                    cm.dispose();\n+//                }\n+//            }\n+//        } else {\n+//            cm.sendOk(\"Hi, I'm Nana the love fairy... Hows it going?\");\n+//            cm.dispose();\n+//        }\n+//    }\n+//}\n\\ No newline at end of file"}, {"sha": "754ed2c808034dec663c8928098cd0aec3636253", "filename": "sql/db_database.sql", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fa376739134d0bbf108c7cca70762c486d55328a/sql/db_database.sql", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fa376739134d0bbf108c7cca70762c486d55328a/sql/db_database.sql", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/sql/db_database.sql?ref=fa376739134d0bbf108c7cca70762c486d55328a", "patch": "@@ -12990,6 +12990,7 @@ CREATE TABLE IF NOT EXISTS `inventoryitems` (\n CREATE TABLE IF NOT EXISTS `ipbans` (\n   `ipbanid` int(10) unsigned NOT NULL AUTO_INCREMENT,\n   `ip` varchar(40) NOT NULL DEFAULT '',\n+  `aid` varchar(40) DEFAULT NULL,\n   PRIMARY KEY (`ipbanid`)\n ) ENGINE=InnoDB DEFAULT CHARSET=latin1 AUTO_INCREMENT=1 ;\n \n@@ -13015,6 +13016,7 @@ CREATE TABLE IF NOT EXISTS `keymap` (\n CREATE TABLE IF NOT EXISTS `macbans` (\n   `macbanid` int(10) unsigned NOT NULL AUTO_INCREMENT,\n   `mac` varchar(30) NOT NULL,\n+  `aid` varchar(40) DEFAULT NULL,\n   PRIMARY KEY (`macbanid`),\n   UNIQUE KEY `mac_2` (`mac`)\n ) ENGINE=InnoDB DEFAULT CHARSET=latin1 AUTO_INCREMENT=1 ;"}, {"sha": "8457f2bf609542bff3d9074daaac24245b6ae819", "filename": "src/client/MapleCharacter.java", "status": "modified", "additions": 22, "deletions": 1, "changes": 23, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fa376739134d0bbf108c7cca70762c486d55328a/src/client/MapleCharacter.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fa376739134d0bbf108c7cca70762c486d55328a/src/client/MapleCharacter.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/MapleCharacter.java?ref=fa376739134d0bbf108c7cca70762c486d55328a", "patch": "@@ -615,7 +615,7 @@ public static boolean ban(String id, String reason, boolean accountId) {\n                 if (ps != null && !ps.isClosed()) {\n                     ps.close();\n                 }\n-\t\t\t\tif (rs != null && !rs.isClosed()) {\n+\t\tif (rs != null && !rs.isClosed()) {\n                     rs.close();\n                 }\n             } catch (SQLException e) {\n@@ -2030,6 +2030,27 @@ public int getId() {\n         return id;\n     }\n \n+    public static int getAccountIdByName(String name) {\n+        try {\n+            int id;\n+            try (PreparedStatement ps = DatabaseConnection.getConnection().prepareStatement(\"SELECT accountid FROM characters WHERE name = ?\")) {\n+                ps.setString(1, name);\n+                try (ResultSet rs = ps.executeQuery()) {\n+                    if (!rs.next()) {\n+                        rs.close();\n+                        ps.close();\n+                        return -1;\n+                    }\n+                    id = rs.getInt(\"accountid\");\n+                }\n+            }\n+            return id;\n+        } catch (Exception e) {\n+            e.printStackTrace();\n+        }\n+        return -1;\n+    }\n+    \n     public static int getIdByName(String name) {\n         try {\n             int id;"}, {"sha": "5f7da286881e73a943aeb70ef283fe8cd12fbacd", "filename": "src/client/MapleClient.java", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fa376739134d0bbf108c7cca70762c486d55328a/src/client/MapleClient.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fa376739134d0bbf108c7cca70762c486d55328a/src/client/MapleClient.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/MapleClient.java?ref=fa376739134d0bbf108c7cca70762c486d55328a", "patch": "@@ -366,7 +366,7 @@ public void banMacs() {\n \t\t\t\t\tfiltered.add(rs.getString(\"filter\"));\n \t\t\t\t}\n \t\t\t}\n-\t\t\ttry (PreparedStatement ps = con.prepareStatement(\"INSERT INTO macbans (mac) VALUES (?)\")) {\n+\t\t\ttry (PreparedStatement ps = con.prepareStatement(\"INSERT INTO macbans (mac, aid) VALUES (?, ?)\")) {\n \t\t\t\tfor (String mac : macs) {\n \t\t\t\t\tboolean matched = false;\n \t\t\t\t\tfor (String filter : filtered) {\n@@ -377,6 +377,7 @@ public void banMacs() {\n \t\t\t\t\t}\n \t\t\t\t\tif (!matched) {\n \t\t\t\t\t\tps.setString(1, mac);\n+                                                ps.setString(2, String.valueOf(getAccID()));\n \t\t\t\t\t\tps.executeUpdate();\n \t\t\t\t\t}\n \t\t\t\t}"}, {"sha": "10d1261b65663be4373aca9cb6172ebe1998a332", "filename": "src/client/command/Commands.java", "status": "modified", "additions": 14, "deletions": 4, "changes": 18, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fa376739134d0bbf108c7cca70762c486d55328a/src/client/command/Commands.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fa376739134d0bbf108c7cca70762c486d55328a/src/client/command/Commands.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/Commands.java?ref=fa376739134d0bbf108c7cca70762c486d55328a", "patch": "@@ -1266,9 +1266,17 @@ public static boolean executeGMCommand(MapleClient c, String[] sub, char heading\n \t\t\tplayer.updateSingleStat(MapleStat.LUK, x);\n \t\t} else if (sub[0].equals(\"unban\")) {\n \t\t\ttry {\n-\t\t\t\ttry (PreparedStatement p = DatabaseConnection.getConnection().prepareStatement(\"UPDATE accounts SET banned = -1 WHERE id = \" + MapleCharacter.getIdByName(sub[1]))) {\n-\t\t\t\t\tp.executeUpdate();\n-\t\t\t\t}\n+                                Connection con = DatabaseConnection.getConnection();\n+                                int aid = MapleCharacter.getAccountIdByName(sub[1]);\n+                                \n+                                PreparedStatement p = con.prepareStatement(\"UPDATE accounts SET banned = -1 WHERE id = \" + aid);\n+                                p.executeUpdate();\n+                            \n+\t\t\t\tp = con.prepareStatement(\"DELETE FROM ipbans WHERE aid = \" + aid);\n+\t\t\t\tp.executeUpdate();\n+                                        \n+                                p = con.prepareStatement(\"DELETE FROM macbans WHERE aid = \" + aid);\n+\t\t\t\tp.executeUpdate();\n \t\t\t} catch (Exception e) {\n                                 e.printStackTrace();\n \t\t\t\tplayer.message(\"Failed to unban \" + sub[1]);\n@@ -1291,8 +1299,10 @@ public static boolean executeGMCommand(MapleClient c, String[] sub, char heading\n \t\t\t\ttry {\n \t\t\t\t\tConnection con = DatabaseConnection.getConnection();\n \t\t\t\t\tif (ip.matches(\"/[0-9]{1,3}\\\\..*\")) {\n-\t\t\t\t\t\tps = con.prepareStatement(\"INSERT INTO ipbans VALUES (DEFAULT, ?)\");\n+\t\t\t\t\t\tps = con.prepareStatement(\"INSERT INTO ipbans VALUES (DEFAULT, ?, ?)\");\n \t\t\t\t\t\tps.setString(1, ip);\n+                                                ps.setString(2, String.valueOf(target.getClient().getAccID()));\n+                                                \n \t\t\t\t\t\tps.executeUpdate();\n \t\t\t\t\t\tps.close();\n \t\t\t\t\t}"}, {"sha": "c268cee21fab6cb2b6e0ab43175f89d5c94b0d08", "filename": "src/constants/ServerConstants.java", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fa376739134d0bbf108c7cca70762c486d55328a/src/constants/ServerConstants.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fa376739134d0bbf108c7cca70762c486d55328a/src/constants/ServerConstants.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/constants/ServerConstants.java?ref=fa376739134d0bbf108c7cca70762c486d55328a", "patch": "@@ -49,7 +49,7 @@\n     //public static final boolean USE_ULTRA_THREE_SNAILS = true;\n     public static final boolean USE_ADD_SLOTS_BY_LEVEL = true;  //slots are added each 20 levels.\n     public static final boolean USE_ADD_RATES_BY_LEVEL = true;  //rates are added each 20 levels.\n-    public static final int USE_EQUIPMNT_LVLUP = 7;             //all equips lvlup at max level as N, set 0 to disable.\n+    public static final int USE_EQUIPMNT_LVLUP = 7;             //Nope, not working yet. //all equips lvlup at max level as N, set 0 to disable.\n     public static final int FAME_GAIN_BY_QUEST = 4;             //fame gain each N quest completes, set 0 to disable.\n     public static final int SCROLL_CHANCE_RATE = 10;            //number of tries for success on a scroll, set 0 for default.\n     "}, {"sha": "889da416d0850a0b55424f7684d60b05d68b8c89", "filename": "src/net/server/channel/handlers/NPCTalkHandler.java", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fa376739134d0bbf108c7cca70762c486d55328a/src/net/server/channel/handlers/NPCTalkHandler.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fa376739134d0bbf108c7cca70762c486d55328a/src/net/server/channel/handlers/NPCTalkHandler.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/channel/handlers/NPCTalkHandler.java?ref=fa376739134d0bbf108c7cca70762c486d55328a", "patch": "@@ -21,7 +21,6 @@\n */\n package net.server.channel.handlers;\n \n-import net.server.channel.handlers.DueyHandler;\n import client.MapleClient;\n import constants.ServerConstants;\n import net.AbstractMaplePacketHandler;\n@@ -43,6 +42,8 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n         MapleMapObject obj = c.getPlayer().getMap().getMapObject(oid);\n         if (obj instanceof MapleNPC) {\n             MapleNPC npc = (MapleNPC) obj;\n+            if(ServerConstants.USE_DEBUG == true) c.getPlayer().dropMessage(5, \"Talking to NPC \" + npc.getId());\n+            \n             if (npc.getId() == 9010009) {   //is duey\n                 if(System.currentTimeMillis() - c.getPlayer().getDuey() < ServerConstants.BLOCK_DUEY_RACE_COND)\n                     return;"}]}]},
