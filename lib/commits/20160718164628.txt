{"fetchDate": "2019-12-19", "content": [{"sha": "d7a2243319b8b730baf514d94735f17488497899", "node_id": "MDY6Q29tbWl0NDUwODIwMjM6ZDdhMjI0MzMxOWI4YjczMGJhZjUxNGQ5NDczNWYxNzQ4ODQ5Nzg5OQ==", "commit": {"author": {"name": "ronancpl", "email": "rcpl2010@gmail.com", "date": "2016-07-18T16:46:28Z"}, "committer": {"name": "ronancpl", "email": "rcpl2010@gmail.com", "date": "2016-07-18T16:46:28Z"}, "message": "Instant sell NPC + new features\n\nDonation Box NPC sells instantly items from inventory. Minor patches.", "tree": {"sha": "70c6a4c9c922561e3ad6f96357c24422e4fe3e37", "url": "https://api.github.com/repos/ronancpl/HeavenMS/git/trees/70c6a4c9c922561e3ad6f96357c24422e4fe3e37"}, "url": "https://api.github.com/repos/ronancpl/HeavenMS/git/commits/d7a2243319b8b730baf514d94735f17488497899", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/d7a2243319b8b730baf514d94735f17488497899", "html_url": "https://github.com/ronancpl/HeavenMS/commit/d7a2243319b8b730baf514d94735f17488497899", "comments_url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/d7a2243319b8b730baf514d94735f17488497899/comments", "author": {"login": "ronancpl", "id": 9257761, "node_id": "MDQ6VXNlcjkyNTc3NjE=", "avatar_url": "https://avatars2.githubusercontent.com/u/9257761?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ronancpl", "html_url": "https://github.com/ronancpl", "followers_url": "https://api.github.com/users/ronancpl/followers", "following_url": "https://api.github.com/users/ronancpl/following{/other_user}", "gists_url": "https://api.github.com/users/ronancpl/gists{/gist_id}", "starred_url": "https://api.github.com/users/ronancpl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ronancpl/subscriptions", "organizations_url": "https://api.github.com/users/ronancpl/orgs", "repos_url": "https://api.github.com/users/ronancpl/repos", "events_url": "https://api.github.com/users/ronancpl/events{/privacy}", "received_events_url": "https://api.github.com/users/ronancpl/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ronancpl", "id": 9257761, "node_id": "MDQ6VXNlcjkyNTc3NjE=", "avatar_url": "https://avatars2.githubusercontent.com/u/9257761?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ronancpl", "html_url": "https://github.com/ronancpl", "followers_url": "https://api.github.com/users/ronancpl/followers", "following_url": "https://api.github.com/users/ronancpl/following{/other_user}", "gists_url": "https://api.github.com/users/ronancpl/gists{/gist_id}", "starred_url": "https://api.github.com/users/ronancpl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ronancpl/subscriptions", "organizations_url": "https://api.github.com/users/ronancpl/orgs", "repos_url": "https://api.github.com/users/ronancpl/repos", "events_url": "https://api.github.com/users/ronancpl/events{/privacy}", "received_events_url": "https://api.github.com/users/ronancpl/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7e32e5a7624aa95bd538fe65db73f4281b3b5218", "url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/7e32e5a7624aa95bd538fe65db73f4281b3b5218", "html_url": "https://github.com/ronancpl/HeavenMS/commit/7e32e5a7624aa95bd538fe65db73f4281b3b5218"}], "stats": {"total": 357, "additions": 290, "deletions": 67}, "files": [{"sha": "e02fe38f2cc4e663ddffc9543437ef0f6848fc7e", "filename": "README.txt", "status": "modified", "additions": 5, "deletions": 4, "changes": 9, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d7a2243319b8b730baf514d94735f17488497899/README.txt", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d7a2243319b8b730baf514d94735f17488497899/README.txt", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/README.txt?ref=d7a2243319b8b730baf514d94735f17488497899", "patch": "@@ -2,16 +2,17 @@ MapleSolaxiaV2\n \n Freelance developer: Ronan C. P. Lana\n \n-Credits about are to be given to the original MapleSolaxia staff and other colaborators, as some minor\n-changes/patches on the game were applied by me.\n+Credits about are to be given to the original MapleSolaxia staff and other colaborators, as just some minor\n+changes/patches on the game were applied by myself.\n \n This is a NetBeans 8.0.2 Project. This means that it's easier to install the project via \"NetBeans' import\n new project using existing code\". Once installed, build this project on your machine and run the server using\n the \"launch.bat\" application.\n \n \n-Note that the project uses the IP 25.15.163.31. Therefore, change the IP wherever it applies to run properly\n-the program. Eventually, I will change the settings on this repository to run at localhost (127.0.0.1).\n+Note that the project uses the IP 25.75.212.150. Therefore, change the IP wherever it applies (Ctrl+f the\n+entire project) to run properly the program. Eventually, I will change the settings on this repository to run\n+at localhost (127.0.0.1).\n ------------------------------------------------\n \n "}, {"sha": "2e8bd4adae148e361eab4487c4ce2452c36a6469", "filename": "configuration.ini", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d7a2243319b8b730baf514d94735f17488497899/configuration.ini", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d7a2243319b8b730baf514d94735f17488497899/configuration.ini", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/configuration.ini?ref=d7a2243319b8b730baf514d94735f17488497899", "patch": "@@ -1,4 +1,4 @@\n-HOST=25.15.163.31\n+HOST=25.75.212.150\n URL=jdbc:mysql://localhost:3306/maplesolaxia\n DB_USER=root\n DB_PASS="}, {"sha": "5f72daaabcbf67145e588e108c753e92e6897801", "filename": "mychanges_ptbr.txt", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d7a2243319b8b730baf514d94735f17488497899/mychanges_ptbr.txt", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d7a2243319b8b730baf514d94735f17488497899/mychanges_ptbr.txt", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/mychanges_ptbr.txt?ref=d7a2243319b8b730baf514d94735f17488497899", "patch": "@@ -87,4 +87,10 @@ Correcao de bug em scripts que fazia o jogador ficar preso num mapa de transicao\n Correcao de bug, onde o sistema nao contabilizava corretamente queda de HP em determinados mapas.\n \n 03 Janeiro 2016,\n-Correcao de bug, onde clientes podiam congelar apos acessar o Cash Shop.\n\\ No newline at end of file\n+Correcao de bug, onde clientes podiam congelar apos acessar o Cash Shop.\n+\n+16 Julho 2016,\n+Correcao de bug.\n+\n+18 Julho 2016,\n+Bazaar NPC (Donation Box): venda automatica de um item designado e todos os itens que estiverem imediatamente ap\ufffds.\n\\ No newline at end of file"}, {"sha": "078212c0eefe61aa995ef47725f889f9d6652f88", "filename": "nbproject/private/private.xml", "status": "modified", "additions": 23, "deletions": 15, "changes": 38, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d7a2243319b8b730baf514d94735f17488497899/nbproject/private/private.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d7a2243319b8b730baf514d94735f17488497899/nbproject/private/private.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/nbproject/private/private.xml?ref=d7a2243319b8b730baf514d94735f17488497899", "patch": "@@ -3,25 +3,33 @@\n     <editor-bookmarks xmlns=\"http://www.netbeans.org/ns/editor-bookmarks/2\" lastBookmarkId=\"0\"/>\n     <open-files xmlns=\"http://www.netbeans.org/ns/projectui-open-files/2\">\n         <group>\n-            <file>file:/C:/Nexon/MapleSolaxia/src/net/server/world/World.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/src/server/MapleStatEffect.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/src/net/MapleServerHandler.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/scripts/npc/world0/9000036.js</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/src/scripting/reactor/ReactorActionManager.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/src/scripting/npc/NPCConversationManager.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/src/client/inventory/MapleInventory.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/src/scripting/npc/NPCScriptManager.java</file>\n             <file>file:/C:/Nexon/MapleSolaxia/src/client/MapleClient.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/src/net/server/PlayerStorage.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/src/client/command/Commands.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/src/server/MapleItemInformationProvider.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/wz/Quest.wz/QuestInfo.img.xml</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/src/client/MonsterBook.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/src/scripting/event/EventInstanceManager.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/src/server/MapleStorage.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/src/server/MapleShop.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/src/client/inventory/MapleInventoryType.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/src/client/inventory/Item.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/src/server/maps/MapleReactorStats.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/src/scripting/AbstractScriptManager.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/src/provider/MapleData.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/src/provider/MapleDataProvider.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/src/net/MapleServerHandler.java</file>\n             <file>file:/C:/Nexon/MapleSolaxia/src/client/MapleCharacter.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/src/net/server/channel/handlers/ChangeMapSpecialHandler.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/src/client/command/Commands.java</file>\n             <file>file:/C:/Nexon/MapleSolaxia/src/tools/MaplePacketCreator.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/src/net/server/channel/handlers/EnterMTSHandler.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/src/net/server/channel/Channel.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/src/net/server/channel/handlers/EnterCashShopHandler.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/src/net/server/channel/handlers/ChangeMapHandler.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/src/net/server/channel/handlers/StorageHandler.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/src/net/server/channel/handlers/PlayerLoggedinHandler.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/src/net/PacketProcessor.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/src/net/server/channel/handlers/ChangeChannelHandler.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/logs/29-07-2015/error/saveToDB.txt</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/src/scripting/AbstractPlayerInteraction.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/src/net/server/RankingWorker.java</file>\n             <file>file:/C:/Nexon/MapleSolaxia/src/constants/ServerConstants.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/src/server/maps/MapleMap.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/src/server/maps/MapleReactor.java</file>\n         </group>\n     </open-files>\n </project-private>"}, {"sha": "17b0c0afe505b541fd0de3750ab19209ebf7b7f6", "filename": "scripts/npc/world0/1022003.js", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d7a2243319b8b730baf514d94735f17488497899/scripts/npc/world0/1022003.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d7a2243319b8b730baf514d94735f17488497899/scripts/npc/world0/1022003.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/world0/1022003.js?ref=d7a2243319b8b730baf514d94735f17488497899", "patch": "@@ -139,9 +139,9 @@ function action(mode, type, selection) {\n             qty = selection;\n \n         if (selectedType == 2){ //helmet refine\n-            var itemSet = new Array(1002042,1002041,1002002,1002044,1002003,1002040,1002007,1002052,1002011,1002058,1002009,1002056,1002087,1002088,1002049,1002050,1002047,1002048,1002099,1002098,1002085,1002028,1002022,1002101);\n+            var itemSet = new Array(1002042,1002041,1002002,1002044,1002003,1002040,1002007,1002052,1002011,1002058,1002009,1002056,1002087,1002088,1002050,1002049,1002047,1002048,1002099,1002098,1002085,1002028,1002022,1002101);\n             var matSet = new Array(new Array(1002001,4011002),new Array(1002001,4021006),new Array(1002043,4011001),new Array(1002043,4011002),new Array(1002039,4011001),new Array(1002039,4011002),new Array(1002051,4011001),new Array(1002051,4011002),new Array(1002059,4011001),new Array(1002059,4011002),\n-                new Array(1002055,4011001),new Array(1002055,4011002),new Array(1002027,4011002),new Array(1002027,4011006),new Array(1002005,4011006),new Array(1002005,4011005),new Array(1002004,4021000),new Array(1002004,4021005),new Array(1002021,4011002),new Array(1002021,4011006),new Array(1002086,4011002),\n+                new Array(1002055,4011001),new Array(1002055,4011002),new Array(1002027,4011002),new Array(1002027,4011006),new Array(1002005,4011005),new Array(1002005,4011006),new Array(1002004,4021000),new Array(1002004,4021005),new Array(1002021,4011002),new Array(1002021,4011006),new Array(1002086,4011002),\n                 new Array(1002086,4011004),new Array(1002100,4011007,4011001),new Array(1002100,4011007,4011002));\n             var matQtySet = new Array(new Array(1,1),new Array(1,1),new Array(1,1),new Array(1,1),new Array(1,1),new Array(1,1),new Array(1,2),new Array(1,2),new Array(1,3),new Array(1,3),new Array(1,3),new Array(1,3),new Array(1,4),new Array(1,4),new Array(1,5),new Array(1,5),new Array(1,3),new Array(1,3),\n                 new Array(1,5),new Array(1,6),new Array(1,5),new Array(1,4),new Array(1,1,7),new Array(1,1,7));"}, {"sha": "4c1e8749adccc6c9d0508ccbfee8accf39fc78e4", "filename": "scripts/npc/world0/1072000.js", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d7a2243319b8b730baf514d94735f17488497899/scripts/npc/world0/1072000.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d7a2243319b8b730baf514d94735f17488497899/scripts/npc/world0/1072000.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/world0/1072000.js?ref=d7a2243319b8b730baf514d94735f17488497899", "patch": "@@ -55,10 +55,11 @@ function action(mode, type, selection) {\n \t\tcm.sendNextPrev(\"You'll be able to acquire a marble called #b#t4031013##k while knocking down those monsters. It is a special marble made out of their sinister, evil minds. Collect 30 of those, and then go talk to a colleague of mine in there. That's how you pass the test.\");\n \telse if (status == 3)\n \t\tcm.sendYesNo(\"Once you go inside, you can't leave until you take care of your mission. If you die, your experience level will decrease..so you better really buckle up and get ready...well, do you want to go for it now?\");\n-\telse if (status == 4)\n+\telse if (status == 4) {\n \t\tcm.sendNext(\"Alright I'll let you in! Defeat the monsters inside, collect 30 Dark Marbles, then strike up a conversation with a colleague of mine inside. He'll give you #bThe Proof of a Hero#k, the proof that you've passed the test. Best of luck to you.\");\n         \tcm.startQuest(100004);\n \t\tcm.gainItem(4031008, -1);\n+\t}\n \telse if (status == 5) {\n \t\tcm.warp(108000300, 0);\n \t\tcm.dispose();"}, {"sha": "61091fcbf653a7e8d2b2674bd57f79291deec0b0", "filename": "scripts/npc/world0/2040016.js", "status": "modified", "additions": 2, "deletions": 4, "changes": 6, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d7a2243319b8b730baf514d94735f17488497899/scripts/npc/world0/2040016.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d7a2243319b8b730baf514d94735f17488497899/scripts/npc/world0/2040016.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/world0/2040016.js?ref=d7a2243319b8b730baf514d94735f17488497899", "patch": "@@ -239,14 +239,12 @@ function action(mode, type, selection) {\n                         }\n                     }\n                     else {\n-\n-                        if (cm.haveItem(mats[i],matQty[i]*qty))complete=false;\n+                        if (!cm.haveItem(mats[i],matQty[i]*qty)) complete=false;\n                     }\n                 }\n             }\n             else {\n-                if (!cm.haveItem(mats, matQty * qty))complete=false;\n-\n+                if (!cm.haveItem(mats, matQty * qty)) complete=false;\n             }\n         }\n \t\t\t"}, {"sha": "326ab962ad69ca1c2e5d5ec95bff98e2a8382fff", "filename": "scripts/npc/world0/2091005.js", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d7a2243319b8b730baf514d94735f17488497899/scripts/npc/world0/2091005.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d7a2243319b8b730baf514d94735f17488497899/scripts/npc/world0/2091005.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/world0/2091005.js?ref=d7a2243319b8b730baf514d94735f17488497899", "patch": "@@ -30,7 +30,9 @@ importPackage(Packages.server.maps);\n var disabled = false;\n var belts = Array(1132000, 1132001, 1132002, 1132003, 1132004);\n var belt_level = Array(25, 35, 45, 60, 75);\n-var belt_points = Array(200, 1800, 4000, 9200, 17000);\n+\n+/* var belt_points = Array(200, 1800, 4000, 9200, 17000); */\n+var belt_points = Array(5, 45, 100, 230, 425); /* Watered down version */\n \n var status = -1;\n var selectedMenu = -1;"}, {"sha": "7bd2d16fa5890c35afef773d656d88a7d41976b5", "filename": "scripts/npc/world0/9000036.js", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d7a2243319b8b730baf514d94735f17488497899/scripts/npc/world0/9000036.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d7a2243319b8b730baf514d94735f17488497899/scripts/npc/world0/9000036.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/world0/9000036.js?ref=d7a2243319b8b730baf514d94735f17488497899", "patch": "@@ -42,7 +42,7 @@ var maxEqp = 0;\n \n function start() {\n     cm.getPlayer().setCS(true);\n-    var selStr = \"Hello, I am the #bAccessory NPC Crafter#k! My works are widely recognized to be too fine, to the point which all my items mimic not only the appearance but too the attributes of them! Everything I charge is some 'ingredients' to make them and, of course, a fee for my services. On what kind of equipment will you take a look?#b\"\n+    var selStr = \"Hello, I am the #bAccessory NPC Crafter#k! My works are widely recognized to be too fine, to the point which all my items mimic not only the appearance but too the attributes of them! Everything I charge is some 'ingredients' to make them and, of course, a fee for my services. On what kind of equipment will you take a look?#b\";\n     var options = [\"Pendants\",\"Face accessories\",\"Eye accessories\",\"Belts & medals\",\"Rings\",\"#t4032496#\"];\n     for (var i = 0; i < options.length; i++)\n         selStr += \"\\r\\n#L\" + i + \"# \" + options[i] + \"#l\";\n@@ -51,7 +51,7 @@ function start() {\n \n function action(mode, type, selection) {\n     status++;\n-    if (mode != 1){\n+    if (mode != 1) {\n         cm.dispose();\n         return;\n     }\n@@ -109,7 +109,7 @@ function action(mode, type, selection) {\n             var matQtySet = [[20, 20, 5, 1], [5, 5, 10, 1], [10, 4, 20, 4], [20, 8, 20, 8], [10, 4, 20, 4], [15, 6, 30, 6], [20, 8, 40, 8], [15, 6, 30, 6], [1, 1, 1]];\n             var costSet = [150000, 500000, 200000, 400000, 200000, 300000, 400000, 300000, 2500000];\n         }else if (selectedType == 1) { //face accessory refine\n-            var matSet = [[4001343, 4003004],[4001343, 4003004,4000026],[4001343, 4003004,4000026,4000082,4003002],[4001343, 4003005],[4001343, 4003005,4000026],[4001343, 4003005,4000026,4000082,4003002],[4001006, 4011008],[4001006, 4011008],[4001006, 4011008],[4001006, 4011008]];\n+            var matSet = [[4006000, 4003004],[4006000, 4003004,4000026],[4006000, 4003004,4000026,4000082,4003002],[4006000, 4003005],[4006000, 4003005,4000026],[4006000, 4003005,4000026,4000082,4003002],[4001006, 4011008],[4001006, 4011008],[4001006, 4011008],[4001006, 4011008]];\n             var matQtySet = [[5,5],[5,5,5],[5,5,5,5,1],[5,5],[5,5,5],[5,5,5,5,1],[1,1],[1,1],[1,1],[1,1]];\n             var costSet = [100000,200000,300000,125000,250000,375000,500000,500000,500000,500000, 25000, 25000, 25000, 25000];\n         }else if (selectedType == 2) { //eye accessory refine\n@@ -121,7 +121,7 @@ function action(mode, type, selection) {\n             var matQtySet = [[2, 5, 10], [7777, 7777]];\n             var costSet = [15000, 7777];\n         }else if (selectedType == 4) { //ring refine\n-            var matSet = [[4003001, 4001344, 4001343], [4003001, 4001344, 4001343], [4021004, 4011008], [4011008, 4001006], [1112405, 2022039], [1112413, 4000176], [4011007, 4021009]];\n+            var matSet = [[4003001, 4001344, 4006000], [4003001, 4001344, 4006000], [4021004, 4011008], [4011008, 4001006], [1112405, 2022039], [1112413, 4000176], [4011007, 4021009]];\n             var matQtySet = [[2, 2, 2], [2, 2, 2], [1, 1], [1, 1], [1, 1], [1, 1], [1, 1]];\n             var costSet = [10000, 10000, 10000, 20000, 15000, 15000, 10000];\n         }else if (selectedType == 5) { //necklace refine"}, {"sha": "dbb5da98dafe0388150d11898f581e6c217b7e77", "filename": "scripts/npc/world0/9000041.js", "status": "added", "additions": 79, "deletions": 0, "changes": 79, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d7a2243319b8b730baf514d94735f17488497899/scripts/npc/world0/9000041.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d7a2243319b8b730baf514d94735f17488497899/scripts/npc/world0/9000041.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/world0/9000041.js?ref=d7a2243319b8b730baf514d94735f17488497899", "patch": "@@ -0,0 +1,79 @@\n+/*\n+\tThis file is part of the OdinMS Maple Story Server\n+    Copyright (C) 2008 Patrick Huy <patrick.huy@frz.cc>\n+\t\t       Matthias Butz <matze@odinms.de>\n+\t\t       Jan Christian Meyer <vimes@odinms.de>\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+/* NPC: Donation Box (9000041)\n+\tVictoria Road : Henesys\n+\t\n+\tNPC Bazaar:\n+        * By Ronan Lana\n+*/\n+\n+var options = [\"EQUIP\",\"USE\",\"SET-UP\",\"ETC\"];\n+var name;\n+var status;\n+var selectedType = 0;\n+\n+function start() {\n+    status = -1;\n+    action(1, 0, 0); \n+}\n+\n+function action(mode, type, selection) {\n+    status++;\n+    if (mode != 1) {\n+        cm.dispose();\n+        return;\n+    }\n+\n+    if (status == 0) {\n+        var selStr = \"Hello, I am the #bBazaar NPC#k! Sell to me any item on your inventory you don't need. #rWARNING#b: Make sure you have your items ready to sell at the slots #rAFTER#b the item you have selected to sell.#k Any items #bunder#k the item selected will be sold thoroughly.\";\n+        for (var i = 0; i < options.length; i++)\n+            selStr += \"\\r\\n#L\" + i + \"# \" + options[i] + \"#l\";\n+        cm.sendSimple(selStr);\n+    }\n+\n+    else if (status == 1) {\n+\tselectedType = selection;\n+        cm.sendGetText(\"From what item on your #r\" + options[selectedType] + \"#k inventory do you want to start the transaction?\");\n+    }\n+\n+    else if (status == 2) {\n+        name = cm.getText();\n+\tvar res = false;\n+\n+        if (selectedType == 0) {\n+\t\tres = cm.getPlayer().sellAllItemsFromName(Packages.client.inventory.MapleInventoryType.EQUIP, name);\n+        }else if (selectedType == 1) {\n+\t\tres = cm.getPlayer().sellAllItemsFromName(Packages.client.inventory.MapleInventoryType.USE, name);\n+        }else if (selectedType == 2) {\n+\t\tres = cm.getPlayer().sellAllItemsFromName(Packages.client.inventory.MapleInventoryType.SETUP, name);\n+        }else if (selectedType == 3) {\n+\t\tres = cm.getPlayer().sellAllItemsFromName(Packages.client.inventory.MapleInventoryType.ETC, name);\n+        }else if (selectedType == 4) {\n+\t\tres = cm.getPlayer().sellAllItemsFromName(Packages.client.inventory.MapleInventoryType.CASH, name);\n+        }\n+\n+        if(res) cm.sendOk(\"Transaction complete!\");\n+\telse cm.sendOk(\"#b'\" + name + \"'#k is not a #b\" + options[selectedType] + \"#k item!\");\n+\n+        cm.dispose();\n+    }\n+}\n\\ No newline at end of file"}, {"sha": "71f718c056a26e712a035380824f0d793e9a482c", "filename": "scripts/npc/world0/9201057.js", "status": "modified", "additions": 7, "deletions": 2, "changes": 9, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d7a2243319b8b730baf514d94735f17488497899/scripts/npc/world0/9201057.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d7a2243319b8b730baf514d94735f17488497899/scripts/npc/world0/9201057.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/world0/9201057.js?ref=d7a2243319b8b730baf514d94735f17488497899", "patch": "@@ -11,9 +11,14 @@ function action(mode, type, selection) {\n         return;\n     }\n     if (cm.c.getPlayer().getMapId() == 103000100 || cm.c.getPlayer().getMapId() == 600010001){\n-        if(cm.getMeso() >= 5000){\n+\tvar item = 4031711 + parseInt(cm.c.getPlayer().getMapId() / 300000000);\n+\n+        if(!cm.canHold(item)) {\n+            cm.sendNext(\"You don't have a etc. slot available.\");\n+\t}\n+\telse if(cm.getMeso() >= 5000){\n             cm.gainMeso(-5000);\n-            cm.gainItem(4031711 + parseInt(cm.c.getPlayer().getMapId() / 300000000), 1);\n+            cm.gainItem(item, 1);\n             cm.sendNext(\"There you go.\");\n         }else\n             cm.sendNext(\"You don't have enough mesos.\");"}, {"sha": "99d42f4750e8deee8a5117f4a72727529e1eb7ae", "filename": "scripts/npc/world0/9201097.js", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d7a2243319b8b730baf514d94735f17488497899/scripts/npc/world0/9201097.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d7a2243319b8b730baf514d94735f17488497899/scripts/npc/world0/9201097.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/world0/9201097.js?ref=d7a2243319b8b730baf514d94735f17488497899", "patch": "@@ -72,14 +72,14 @@ function start() {\n \n function action(mode, type, selection) {\n     if (mode == 0) {\n-\tcm.sendOk(\"Hmmm...it shouldn't be a bad deal for you. Come see me at the right time and you may get a much better item to be offered. Anyway, let me know when you have a change of heart.\");\n+\tcm.sendOk(\"Hmmm...it shouldn't be a bad deal for you. Come see me at the right time and you may get a much better item to be offered. Anyway, let me know when you have a change of mind.\");\n \tcm.dispose();\n \treturn;\n     }\n     \n     status++;\n     if (status == 0) { // first interaction with NPC\n-\tcm.sendNext(\"Hey, got a little bit of time? Well, my job is to collect items here and sell them elsewhere, but these days the monsters have become much more hostile so it's been difficult to getting good items ... What do you think? Do you want to do some business with me?\");\n+\tcm.sendNext(\"Hey, got a little bit of time? Well, my job is to collect items here and sell them elsewhere, but these days the monsters have become much more hostile so it have been difficult to get good items... What do you think? Do you want to do some business with me?\");\n     } else if (status == 1) {\n \tcm.sendYesNo(\"The deal is simple. You get me something I need, I get you something you need. The problem is, I deal with a whole bunch of people, so the items I have to offer may change every time you see me. What do you think? Still want to do it?\");\n     } else if (status == 2) {\n@@ -89,10 +89,10 @@ function action(mode, type, selection) {\n \tlastSelection = selection;\n \trequiredItem = eQuestChoices[selection];\n         \n-        if(selection / 4 == 0) qnt = 50;\n+        if(selection < 4) qnt = 50;\n         else qnt=25;\n         \n-\tcm.sendYesNo(\"Let's see, you want to trade your #b\" + qnt +  \" #t\" + requiredItem + \"##k with my stuff right? Before trading make sure you have an empty slot available on your use or etc. inventory. Now, do you want to trade with me?\");\n+\tcm.sendYesNo(\"Let's see, you want to trade your #b\" + qnt +  \" #t\" + requiredItem + \"##k with my stuff, right? Before trading make sure you have an empty slot available on your use or etc. inventory. Now, do you want to trade with me?\");\n     }else if (status == 4){\n \titemSet = (Math.floor(Math.random() * eQuestPrizes[lastSelection].length));\n \treward = eQuestPrizes[lastSelection];\n@@ -103,13 +103,13 @@ function action(mode, type, selection) {\n \t} else if(prizeItem == 0) {\n             cm.gainItem(requiredItem,-qnt);\n             cm.gainMeso(prizeQuantity);\n-            cm.sendOk(\"For your #b\" + qnt + \" #t\"+requiredItem+\"##k, here's #b\" + prizeQuantity + \" mesos#k. What do you think? Do you like the items I gave you in return? I plan on being here for a while, so if you gather up more items, I'm always open for a trade ...\");\n+            cm.sendOk(\"For your #b\" + qnt + \" #t\"+requiredItem+\"##k, here's #b\" + prizeQuantity + \" mesos#k. What do you think? Did you like the items I gave you in return? I plan on being here for awhile, so if you gather up more items, I'm always open for a trade...\");\n         } else if(!cm.canHold(prizeItem)){\n \t    cm.sendOk(\"Your use and etc. inventory seems to be full. You need the free spaces to trade with me! Make room, and then find me.\");\n \t} else {\n \t    cm.gainItem(requiredItem,-qnt);\n \t    cm.gainItem(prizeItem, prizeQuantity);\n-\t    cm.sendOk(\"For your #b\" + qnt + \" #t\"+requiredItem+\"##k, here's my #b\"+prizeQuantity+\" #t\"+prizeItem+\"##k. What do you think? Do you like the items I gave you in return? I plan on being here for a while, so if you gather up more items, I'm always open for a trade ...\");\n+\t    cm.sendOk(\"For your #b\" + qnt + \" #t\"+requiredItem+\"##k, here's my #b\"+prizeQuantity+\" #t\"+prizeItem+\"##k. What do you think? Did you like the items I gave you in return? I plan on being here for awhile, so if you gather up more items, I'm always open for a trade...\");\n \t}\n \tcm.dispose();\n     }"}, {"sha": "f37a76db3caae3cb526fc283dee56a9cce50844e", "filename": "scripts/quest/3454.js", "status": "added", "additions": 53, "deletions": 0, "changes": 53, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d7a2243319b8b730baf514d94735f17488497899/scripts/quest/3454.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d7a2243319b8b730baf514d94735f17488497899/scripts/quest/3454.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/quest/3454.js?ref=d7a2243319b8b730baf514d94735f17488497899", "patch": "@@ -0,0 +1,53 @@\n+/*\n+\tThis file is part of the OdinMS Maple Story Server\n+    Copyright (C) 2008 Patrick Huy <patrick.huy@frz.cc>\n+\t\t       Matthias Butz <matze@odinms.de>\n+\t\t       Jan Christian Meyer <vimes@odinms.de>\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+/*\t\n+\tAuthor : \t\tRonan\n+\tNPC Name: \t        Dr. Kim\n+\tMap(s): \t\tOmega Sector\n+\tDescription: \t\tQuest - Wave Translator\n+\tQuest ID: \t\t3454\n+*/\n+\n+function end(mode, type, selection) {\n+\tif(qm.getPlayer().getInventory(Packages.client.inventory.MapleInventoryType.ETC).getNumFreeSlot() < 1) {\n+\t\tqm.sendOk(\"Make room on your ETC inventory first.\");\n+\t\tqm.dispose();\t\t\n+\t\treturn;\n+\t}\n+\n+\tqm.gainItem(4000125, -1);\n+\tqm.gainItem(4031926, -10);\n+\tqm.gainItem(4000119, -30);\n+\tqm.gainItem(4000118, -30);\n+\n+\trnd = Math.random();\n+\tif(rnd < 1.0) {\n+\t\tqm.gainItem(4031928, 1);\n+\t}\n+\telse {\n+\t\tqm.gainItem(4031927, 1);\n+\t}\n+\n+\tqm.sendOk(\"Now, go meet Alien Gray and use this undercover to read through their plans. If this fails, we will need to gather some materials once again.\");\n+\tqm.forceCompleteQuest();\n+\tqm.dispose();\n+}"}, {"sha": "cacd609183453aa83eb832e8ef2539e738ea1888", "filename": "scripts/reactor/2202002.js", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d7a2243319b8b730baf514d94735f17488497899/scripts/reactor/2202002.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d7a2243319b8b730baf514d94735f17488497899/scripts/reactor/2202002.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/reactor/2202002.js?ref=d7a2243319b8b730baf514d94735f17488497899", "patch": "@@ -27,5 +27,8 @@\n */\n \n function act(){\n-\trm.warp(922000009);\n+\tif(rm.isQuestActive(3238)) {\n+\t\trm.warp(922000020);\n+\t}\n+\telse rm.warp(922000009);\n }\n\\ No newline at end of file"}, {"sha": "9955f9b0d22509c0baead5f0ca88382ecea00fa1", "filename": "scripts/reactor/2302001.js", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d7a2243319b8b730baf514d94735f17488497899/scripts/reactor/2302001.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d7a2243319b8b730baf514d94735f17488497899/scripts/reactor/2302001.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/reactor/2302001.js?ref=d7a2243319b8b730baf514d94735f17488497899", "patch": "@@ -26,6 +26,11 @@\n  * \n */\n \n+\n function act(){\n+\n \t//rm.dropItems(true, 2, 105, 140);\n+\n+\trm.dropItems();\n+\n }\n\\ No newline at end of file"}, {"sha": "9a767925a9604a8d35477e5eaa1649a45ba2abcc", "filename": "sql/db_drops.sql", "status": "modified", "additions": 7, "deletions": 8, "changes": 15, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d7a2243319b8b730baf514d94735f17488497899/sql/db_drops.sql", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d7a2243319b8b730baf514d94735f17488497899/sql/db_drops.sql", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/sql/db_drops.sql?ref=d7a2243319b8b730baf514d94735f17488497899", "patch": "@@ -559,7 +559,6 @@\n (1210101, 1072285, 1, 1, 0, 700), \n (9300059, 1072285, 1, 1, 0, 700), \n (9400242, 1072285, 1, 1, 0, 700), \n-(1110101, 1012031, 1, 1, 0, 700), \n (1110101, 4030009, 1, 1, 0, 10000), \n (1110101, 4001344, 1, 1, 0, 7000), \n (1110101, 4001356, 1, 1, 0, 7000), \n@@ -3718,11 +3717,6 @@\n (9500307, 4000018, 1, 1, 0, 200000), \n (9500338, 4000018, 1, 1, 0, 200000), \n (9303001, 4000018, 1, 1, 0, 200000), \n-(3220000, 1012031, 1, 1, 0, 40000), \n-(9300185, 1012031, 1, 1, 0, 40000), \n-(9500307, 1012031, 1, 1, 0, 40000), \n-(9500338, 1012031, 1, 1, 0, 40000), \n-(9303001, 1012031, 1, 1, 0, 700), \n (3220000, 4003001, 1, 1, 0, 7000), \n (9300185, 4003001, 1, 1, 0, 7000), \n (9500307, 4003001, 1, 1, 0, 7000), \n@@ -18746,7 +18740,9 @@\n (9400578, 2001000, 1, 1, 0, 800),\n (9400578, 1032032, 1, 1, 0, 1200),\n (9400578, 1032013, 1, 1, 0, 1200),\n-(9400578, 1372009, 1, 1, 0, 1200);\n+(9400578, 1372009, 1, 1, 0, 1200),\n+(9400578, 1372009, 1, 1, 0, 1200),\n+(9300011, 4031130, 1, 1, 0, 10000);\n \n   UPDATE IGNORE temp_data SET dropperid=9000002 WHERE dropperid=9000000;\n \n@@ -18769,7 +18765,8 @@\n     `maximum_quantity` int(11) NOT NULL DEFAULT '1',\n     `questid` int(11) NOT NULL DEFAULT '0',\n     `chance` int(11) NOT NULL DEFAULT '0',\n-    PRIMARY KEY (`dropperid`, `itemid`),\n+    PRIMARY KEY (`id`),\n+    UNIQUE KEY (`dropperid`, `itemid`),\n     KEY `mobid` (`dropperid`)\n   ) ENGINE=MyISAM  DEFAULT CHARSET=latin1 AUTO_INCREMENT=1 ;\n \n@@ -18803,8 +18800,10 @@\n   UPDATE drop_data SET questid=77777 WHERE itemid=4001358;\t#id 77777 for ALL quest items with no v83 quest.\n   UPDATE drop_data SET questid=77777 WHERE itemid=4001359;\n   UPDATE drop_data SET questid=77777 WHERE itemid=4001342;\n+  UPDATE drop_data SET chance=0 WHERE itemid=2050099;\n \n   #update quest reactor items\n+  UPDATE reactordrops SET questid=2086 WHERE itemid=4031165;\n   UPDATE reactordrops SET questid=3407 WHERE itemid=4031141;\n   UPDATE reactordrops SET questid=3407 WHERE itemid=4031142;\n   UPDATE reactordrops SET questid=3407 WHERE itemid=4031143;"}, {"sha": "f269de58a92b3654fd4b1cd9455c1d816c875bf6", "filename": "sql/db_shopupdate.sql", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d7a2243319b8b730baf514d94735f17488497899/sql/db_shopupdate.sql", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d7a2243319b8b730baf514d94735f17488497899/sql/db_shopupdate.sql", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/sql/db_shopupdate.sql?ref=d7a2243319b8b730baf514d94735f17488497899", "patch": "@@ -3,6 +3,9 @@ UPDATE shopitems SET itemid=1812004, price=1000 WHERE shopitemid=19;\n UPDATE shopitems SET itemid=2120000, price=100 WHERE shopitemid=20;\n UPDATE shopitems SET itemid=1812000, price=1000 WHERE shopitemid=21;\n UPDATE shopitems SET itemid=1812001, price=1000 WHERE shopitemid=22;\n+\n+INSERT IGNORE INTO `shopitems` (`shopitemid`, `shopid`, `itemid`, `price`, `pitch`, `position`, `chance`) VALUES\n+(995032, SHOPID, 2040025, 500000, 0, 0),\n UPDATE shopitems SET itemid=2040025, price=500000 WHERE shopitemid=995032;\n UPDATE shopitems SET itemid=2040029, price=500000 WHERE shopitemid=995033;\n UPDATE shopitems SET itemid=2040301, price=400000 WHERE shopitemid=995034;"}, {"sha": "6978170b5b6f63a392f871975ec1fbc0a0bbedc6", "filename": "sql/readme.txt", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d7a2243319b8b730baf514d94735f17488497899/sql/readme.txt", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d7a2243319b8b730baf514d94735f17488497899/sql/readme.txt", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/sql/readme.txt?ref=d7a2243319b8b730baf514d94735f17488497899", "patch": "@@ -1,3 +1,4 @@\n-These 2 SQL files must be executed IN ORDER to set up:\n+These SQL files must be executed IN ORDER to set up:\n \t- db_database.sql\n-\t- db_drops.sql\n\\ No newline at end of file\n+\t- db_drops.sql\n+\t- db_shopupdate.sql (optional)\n\\ No newline at end of file"}, {"sha": "61fdc8e365065100def19ebc6123292f1f4fe7b5", "filename": "src/client/MapleCharacter.java", "status": "modified", "additions": 52, "deletions": 1, "changes": 53, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d7a2243319b8b730baf514d94735f17488497899/src/client/MapleCharacter.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d7a2243319b8b730baf514d94735f17488497899/src/client/MapleCharacter.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/MapleCharacter.java?ref=d7a2243319b8b730baf514d94735f17488497899", "patch": "@@ -2971,7 +2971,7 @@ public void setRates() {\n \n     public static MapleCharacter loadCharFromDB(int charid, MapleClient client, boolean channelserver) throws SQLException {\n         try {\n-            MapleCharacter ret = new MapleCharacter();            \n+            MapleCharacter ret = new MapleCharacter();\n             ret.client = client;\n             ret.id = charid;\n             Connection con = DatabaseConnection.getConnection();\n@@ -4701,7 +4701,58 @@ public boolean gainSlots(int type, int slots, boolean update) {\n \n         return false;\n     }\n+    \n+    public boolean sellAllItemsFromName(MapleInventoryType type, String name) {\n+        //player decides from which inventory items should be sold.\n+        \n+        Item it = getInventory(type).findByName(name);\n+        if(it == null) return(false);\n+        \n+        sellAllItemsFromPosition(type, it.getPosition());\n+        return(true);\n+    }\n+    \n+    public void sellAllItemsFromPosition(MapleInventoryType type, short pos) {\n+        for(short i = pos; i <= getInventory(type).getSlotLimit(); i++) {\n+            if(getInventory(type).getItem(i) == null) continue;\n+            standaloneSell(getClient(), type, i, getInventory(type).getItem(i).getQuantity());\n+        }\n+    }\n \n+    private void standaloneSell(MapleClient c, MapleInventoryType type, short slot, short quantity) {\n+        if (quantity == 0xFFFF || quantity == 0) {\n+            quantity = 1;\n+        }\n+        MapleItemInformationProvider ii = MapleItemInformationProvider.getInstance();\n+        Item item = getInventory(type).getItem((short) slot);\n+        if (item == null){ //Basic check\n+        \treturn;\n+        }\n+        if (ItemConstants.isRechargable(item.getItemId())) {\n+            quantity = item.getQuantity();\n+        }\n+        if (quantity < 0) {\n+            return;\n+        }\n+        short iQuant = item.getQuantity();\n+        if (iQuant == 0xFFFF) {\n+            iQuant = 1;\n+        }\n+        if (quantity <= iQuant && iQuant > 0) {\n+            MapleInventoryManipulator.removeFromSlot(c, type, (byte) slot, quantity, false);\n+            double price;\n+            if (ItemConstants.isRechargable(item.getItemId())) {\n+            \tprice = ii.getWholePrice(item.getItemId()) / (double) ii.getSlotMax(c, item.getItemId());\n+            } else {\n+                price = ii.getPrice(item.getItemId());\n+            }\n+            int recvMesos = (int) Math.max(Math.ceil(price * quantity), 0);\n+            if (price != -1 && recvMesos > 0) {\n+                gainMeso(recvMesos, false);\n+            }\n+        }\n+    }\n+    \n     public void setShop(MapleShop shop) {\n         this.shop = shop;\n     }"}, {"sha": "a80fb0a380f10a34880260ea1de4fff7cbe93e0d", "filename": "src/client/inventory/MapleInventory.java", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d7a2243319b8b730baf514d94735f17488497899/src/client/inventory/MapleInventory.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d7a2243319b8b730baf514d94735f17488497899/src/client/inventory/MapleInventory.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/inventory/MapleInventory.java?ref=d7a2243319b8b730baf514d94735f17488497899", "patch": "@@ -32,6 +32,7 @@\n import tools.Pair;\n import client.MapleCharacter;\n import constants.ItemConstants;\n+import server.MapleItemInformationProvider;\n \n /**\n  *\n@@ -73,6 +74,15 @@ public Item findById(int itemId) {\n         }\n         return null;\n     }\n+    \n+    public Item findByName(String name) {\n+        for (Item item : inventory.values()) {\n+            if (name.compareToIgnoreCase(MapleItemInformationProvider.getInstance().getName(item.getItemId())) == 0) {\n+                return item;\n+            }\n+        }\n+        return null;\n+    }\n \n     public int countById(int itemId) {\n         int possesed = 0;"}, {"sha": "f9e95883f122d17839c197ab1201d14d4d5fdb60", "filename": "src/constants/ExpTable.java", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d7a2243319b8b730baf514d94735f17488497899/src/constants/ExpTable.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d7a2243319b8b730baf514d94735f17488497899/src/constants/ExpTable.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/constants/ExpTable.java?ref=d7a2243319b8b730baf514d94735f17488497899", "patch": "@@ -22,7 +22,7 @@\n package constants;\n \n public final class ExpTable {\n-    private static final int[] exp = {1, 15, 34, 57, 92, 135, 372, 560, 840, 1242, 1144, 1573, 2144, 2800, 3640, 4700, 5893, 7360, 9144, 11120, 13477, 16268, 19320, 22880, 27008, 31477, 36600, 42444, 48720, 55813, 63800, 86784, 98208, 110932, 124432, 139372, 155865, 173280, 192400, 213345, 235372, 259392, 285532, 312928, 342624, 374760, 408336, 445544, 483532, 524160, 567772, 598886, 631704, 666321, 702836, 741351, 781976, 824828, 870028, 917625, 967995, 1021041, 1076994, 1136013, 1198266, 1263930, 1333194, 1406252, 1483314, 1564600, 1650340, 1740778, 1836173, 1936794, 2042930, 2154882, 2272970, 2397528, 2528912, 2667496, 2813674, 2967863, 3130502, 3302053, 3483005, 3673873, 3875201, 4087562, 4311559, 4547832, 4797053, 5059931, 5337215, 5629694, 5938202, 6263614, 6606860, 6968915, 7350811, 7753635, 8178534, 8626718, 9099462, 9598112, 10124088, 10678888, 11264090, 11881362, 12532461, 13219239, 13943653, 14707765, 15513750, 16363902, 17260644, 18206527, 19204245, 20256637, 21366700, 22537594, 23772654, 25075395, 26449526, 27898960, 29427822, 31040466, 32741483, 34535716, 36428273, 38424542, 40530206, 42751262, 45094030, 47565183, 50171755, 52921167, 55821246, 58880250, 62106888, 65510344, 69100311, 72887008, 76881216, 81094306, 85594273, 90225770, 95170142, 100385466, 105886589, 111689174, 117809740, 124265714, 131075474, 138258410, 145834970, 153826726, 162256430, 171148082, 180526997, 190419876, 200854885, 211861732, 223471711, 223471711, 248635353, 262260570, 276632449, 291791906, 307782102, 324648562, 342439302, 361204976, 380999008, 401877754, 423900654, 447130410, 471633156, 497478653, 524740482, 553496261, 583827855, 615821622, 649568646, 685165008, 722712050, 762316670, 804091623, 848155844, 894634784, 943660770, 995373379, 1049919840, 1107455447, 1168144006, 1232158297, 1299680571, 1370903066, 1446028554, 1525246918, 1608855764, 1697021059};\n+    private static final int[] exp = {1, 15, 34, 57, 92, 135, 372, 560, 840, 1144, 1242, 1573, 2144, 2800, 3640, 4700, 5893, 7360, 9144, 11120, 13477, 16268, 19320, 22880, 27008, 31477, 36600, 42444, 48720, 55813, 63800, 86784, 98208, 110932, 124432, 139372, 155865, 173280, 192400, 213345, 235372, 259392, 285532, 312928, 342624, 374760, 408336, 445544, 483532, 524160, 567772, 598886, 631704, 666321, 702836, 741351, 781976, 824828, 870028, 917625, 967995, 1021041, 1076994, 1136013, 1198266, 1263930, 1333194, 1406252, 1483314, 1564600, 1650340, 1740778, 1836173, 1936794, 2042930, 2154882, 2272970, 2397528, 2528912, 2667496, 2813674, 2967863, 3130502, 3302053, 3483005, 3673873, 3875201, 4087562, 4311559, 4547832, 4797053, 5059931, 5337215, 5629694, 5938202, 6263614, 6606860, 6968915, 7350811, 7753635, 8178534, 8626718, 9099462, 9598112, 10124088, 10678888, 11264090, 11881362, 12532461, 13219239, 13943653, 14707765, 15513750, 16363902, 17260644, 18206527, 19204245, 20256637, 21366700, 22537594, 23772654, 25075395, 26449526, 27898960, 29427822, 31040466, 32741483, 34535716, 36428273, 38424542, 40530206, 42751262, 45094030, 47565183, 50171755, 52921167, 55821246, 58880250, 62106888, 65510344, 69100311, 72887008, 76881216, 81094306, 85594273, 90225770, 95170142, 100385466, 105886589, 111689174, 117809740, 124265714, 131075474, 138258410, 145834970, 153826726, 162256430, 171148082, 180526997, 190419876, 200854885, 211861732, 223471711, 223471711, 248635353, 262260570, 276632449, 291791906, 307782102, 324648562, 342439302, 361204976, 380999008, 401877754, 423900654, 447130410, 471633156, 497478653, 524740482, 553496261, 583827855, 615821622, 649568646, 685165008, 722712050, 762316670, 804091623, 848155844, 894634784, 943660770, 995373379, 1049919840, 1107455447, 1168144006, 1232158297, 1299680571, 1370903066, 1446028554, 1525246918, 1608855764, 1697021059};\n     private static final int[] pet = {1, 1, 3, 6, 14, 31, 60, 108, 181, 287, 434, 632, 891, 1224, 1642, 2161, 2793, 3557, 4467, 5542, 6801, 8263, 9950, 11882, 14084, 16578, 19391, 22547, 26074, 30000, 2147483647};\n     private static final int[] mount = {1, 24, 50, 105, 134, 196, 254, 263, 315, 367, 430, 543, 587, 679, 725, 897, 1146, 1394, 1701, 2247, 2543, 2898, 3156, 3313, 3584, 3923, 4150, 4305, 4550};\n "}, {"sha": "8e38c9337b057d243f388cc033961e25c49ea973", "filename": "src/constants/ServerConstants.java", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d7a2243319b8b730baf514d94735f17488497899/src/constants/ServerConstants.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d7a2243319b8b730baf514d94735f17488497899/src/constants/ServerConstants.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/constants/ServerConstants.java?ref=d7a2243319b8b730baf514d94735f17488497899", "patch": "@@ -13,7 +13,7 @@\n     public static final long RANKING_INTERVAL = 60 * 60 * 1000;//60 minutes, 3600000\n     public static final boolean ENABLE_PIC = false;\n     //Event Configuration\n-    public static final boolean PERFECT_PITCH = false;  //for lvl 30 or above, each lvlup player gains 1 perfect pitch.\n+    public static final boolean PERFECT_PITCH = true;  //for lvl 30 or above, each lvlup player gains 1 perfect pitch.\n     // IP Configuration\n     public static String HOST;\n     //Database Configuration\n@@ -24,7 +24,7 @@\n     public static boolean JAVA_8;\n     public static boolean SHUTDOWNHOOK;\n     //Gameplay Configurations\n-    public static final boolean USE_DEBUG = false;\n+    public static final boolean USE_DEBUG = true;\n     public static final boolean USE_MTS = false;\n     public static final boolean USE_FAMILY_SYSTEM = false;\n     public static final boolean USE_DUEY = true;"}, {"sha": "d1d8227d54126b9e4900bf58806278cca5abd72d", "filename": "src/scripting/npc/NPCConversationManager.java", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d7a2243319b8b730baf514d94735f17488497899/src/scripting/npc/NPCConversationManager.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d7a2243319b8b730baf514d94735f17488497899/src/scripting/npc/NPCConversationManager.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/scripting/npc/NPCConversationManager.java?ref=d7a2243319b8b730baf514d94735f17488497899", "patch": "@@ -440,6 +440,7 @@ public boolean hasMerchantItems() {\n \t\t\t\treturn true;\n \t\t\t}\n \t\t} catch (SQLException e) {\n+                    e.printStackTrace();\n \t\t\treturn false;\n \t\t}\n \t\tif (getPlayer().getMerchantMeso() == 0) {"}, {"sha": "dce4f943a40ddd923c11d9309aa95517176a77c1", "filename": "src/scripting/reactor/ReactorActionManager.java", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d7a2243319b8b730baf514d94735f17488497899/src/scripting/reactor/ReactorActionManager.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d7a2243319b8b730baf514d94735f17488497899/src/scripting/reactor/ReactorActionManager.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/scripting/reactor/ReactorActionManager.java?ref=d7a2243319b8b730baf514d94735f17488497899", "patch": "@@ -69,7 +69,7 @@ public void dropItems(boolean meso, int mesoChance, int minMeso, int maxMeso, in\n         Iterator<ReactorDropEntry> iter = chances.iterator();\n         while (iter.hasNext()) {\n             ReactorDropEntry d = iter.next();\n-            if (Math.random() < (1 / (double) d.chance)) {\n+            if (Math.random() < (c.getPlayer().getDropRate() / (double) d.chance)) {\n                 numItems++;\n                 items.add(d);\n             }"}, {"sha": "1b2bffcfbc1a5606d5389574b5d4be68516f6d72", "filename": "src/server/maps/MapleReactor.java", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d7a2243319b8b730baf514d94735f17488497899/src/server/maps/MapleReactor.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d7a2243319b8b730baf514d94735f17488497899/src/server/maps/MapleReactor.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/maps/MapleReactor.java?ref=d7a2243319b8b730baf514d94735f17488497899", "patch": "@@ -151,9 +151,9 @@ public synchronized void hitReactor(int charPos, short stance, int skillid, Mapl\n \t\t\tif(!this.isAlive()) {\n \t\t\t\treturn;\n \t\t\t}\n-                        if(ServerConstants.USE_DEBUG == true) c.getPlayer().dropMessage(5, \"Hitted REACTOR \" + this.getId());\n+                        if(ServerConstants.USE_DEBUG == true) c.getPlayer().dropMessage(5, \"Hitted REACTOR \" + this.getId() + \" with POS \" + charPos + \" , STANCE \" + stance + \" , SkillID \" + skillid);\n \t\t\tif (stats.getType(state) < 999 && stats.getType(state) != -1) {//type 2 = only hit from right (kerning swamp plants), 00 is air left 02 is ground left\n-\t\t\t\tif (!(stats.getType(state) == 2 && (charPos == 0 || charPos == 2))) { //get next state\n+                            if (!(stats.getType(state) == 2 && (stance == 0 || stance == 2))) { //get next state\t\n \t\t\t\t\tfor (byte b = 0; b < stats.getStateSize(state); b++) {//YAY?\n \t\t\t\t\t\tList<Integer> activeSkills = stats.getActiveSkills(state, b);\n \t\t\t\t\t\tif (activeSkills != null) {\n@@ -170,6 +170,8 @@ public synchronized void hitReactor(int charPos, short stance, int skillid, Mapl\n \t\t\t\t\t\t\t} else {//item-triggered on final step\n \t\t\t\t\t\t\t\tmap.broadcastMessage(MaplePacketCreator.triggerReactor(this, stance));\n \t\t\t\t\t\t\t}\n+                                                        \n+                                                        if(ServerConstants.USE_DEBUG == true) c.getPlayer().dropMessage(5, \"REACTOR \" + this.getId() + \" activated\");\n \t\t\t\t\t\t\tReactorScriptManager.getInstance().act(c, this);\n \t\t\t\t\t\t} else { //reactor not broken yet\n \t\t\t\t\t\t\tmap.broadcastMessage(MaplePacketCreator.triggerReactor(this, stance));"}, {"sha": "b822e20c6b0464d11cbb549f348786b9e63c1483", "filename": "src/server/quest/requirements/NpcRequirement.java", "status": "modified", "additions": 1, "deletions": 4, "changes": 5, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d7a2243319b8b730baf514d94735f17488497899/src/server/quest/requirements/NpcRequirement.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d7a2243319b8b730baf514d94735f17488497899/src/server/quest/requirements/NpcRequirement.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/quest/requirements/NpcRequirement.java?ref=d7a2243319b8b730baf514d94735f17488497899", "patch": "@@ -33,13 +33,10 @@\n  */\n public class NpcRequirement extends MapleQuestRequirement {\n \tprivate int reqNPC;\n-\tprivate final boolean autoComplete, autoStart;\n \t\n \tpublic NpcRequirement(MapleQuest quest, MapleData data) {\n \t\tsuper(MapleQuestRequirementType.NPC);\n \t\tprocessData(data);\n-\t\tthis.autoComplete = quest.isAutoComplete();\n-\t\tthis.autoStart = quest.isAutoStart();\n \t}\n \t\n \t@Override\n@@ -50,6 +47,6 @@ public void processData(MapleData data) {\n \t\n \t@Override\n \tpublic boolean check(MapleCharacter chr, Integer npcid) {\n-\t\treturn npcid != null && npcid == reqNPC && (autoComplete || autoStart || chr.getMap().containsNPC(npcid));\n+\t\treturn npcid != null && npcid == reqNPC;\n \t}\n }"}, {"sha": "bf1e96b445e4f833ab4b041547c52f676f83b778", "filename": "wz/Quest.wz/Act.img.xml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d7a2243319b8b730baf514d94735f17488497899/wz/Quest.wz/Act.img.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d7a2243319b8b730baf514d94735f17488497899/wz/Quest.wz/Act.img.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/wz/Quest.wz/Act.img.xml?ref=d7a2243319b8b730baf514d94735f17488497899", "patch": "@@ -21699,7 +21699,7 @@\n       <imgdir name=\"item\">\n         <imgdir name=\"0\">\n           <int name=\"id\" value=\"4031118\" />\n-          <int name=\"count\" value=\"3\" />\n+          <int name=\"count\" value=\"1\" />\n         </imgdir>\n       </imgdir>\n     </imgdir>"}, {"sha": "d373b1cad44c3cb0881a6abb89d81ccc9fa45b13", "filename": "wz/Quest.wz/Check.img.xml", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d7a2243319b8b730baf514d94735f17488497899/wz/Quest.wz/Check.img.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d7a2243319b8b730baf514d94735f17488497899/wz/Quest.wz/Check.img.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/wz/Quest.wz/Check.img.xml?ref=d7a2243319b8b730baf514d94735f17488497899", "patch": "@@ -43616,6 +43616,7 @@\n           <int name=\"count\" value=\"10\" />\n         </imgdir>\n       </imgdir>\n+      <string name=\"endscript\" value=\"q3454e\" />\n     </imgdir>\n     <imgdir name=\"0\">\n       <int name=\"npc\" value=\"2050001\" />\n@@ -43649,7 +43650,6 @@\n     <imgdir name=\"0\">\n       <int name=\"npc\" value=\"2050002\" />\n       <int name=\"interval\" value=\"0\" />\n-      <string name=\"startscript\" value=\"q3455s\" />\n       <imgdir name=\"quest\">\n         <imgdir name=\"0\">\n           <int name=\"id\" value=\"3457\" />\n@@ -49954,8 +49954,6 @@\n   <imgdir name=\"4306\">\n     <imgdir name=\"1\">\n       <int name=\"npc\" value=\"9120003\" />\n-      <string name=\"start\" value=\"2000010100\" />\n-      <string name=\"end\" value=\"2000010200\" />\n       <imgdir name=\"item\">\n         <imgdir name=\"0\">\n           <int name=\"id\" value=\"4000222\" />"}]}]},
