{"fetchDate": "2019-12-19", "content": [{"sha": "768d9d02646b6b7ac12940524aedcd59257d192f", "node_id": "MDY6Q29tbWl0NDUwODIwMjM6NzY4ZDlkMDI2NDZiNmI3YWMxMjk0MDUyNGFlZGNkNTkyNTdkMTkyZg==", "commit": {"author": {"name": "ronancpl", "email": "rcpl2010@gmail.com", "date": "2017-04-10T22:50:17Z"}, "committer": {"name": "ronancpl", "email": "rcpl2010@gmail.com", "date": "2017-04-10T22:50:17Z"}, "message": "Crog boat + Pirate&EllinPQ + No dmg cap client\n\nNow assaulter boat appears to client, added support for PiratePQ and\nEllinPQ and added a no dmg cap version localhost.", "tree": {"sha": "794c738a352907cb20f8c97744b198ddec65e74a", "url": "https://api.github.com/repos/ronancpl/HeavenMS/git/trees/794c738a352907cb20f8c97744b198ddec65e74a"}, "url": "https://api.github.com/repos/ronancpl/HeavenMS/git/commits/768d9d02646b6b7ac12940524aedcd59257d192f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/768d9d02646b6b7ac12940524aedcd59257d192f", "html_url": "https://github.com/ronancpl/HeavenMS/commit/768d9d02646b6b7ac12940524aedcd59257d192f", "comments_url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/768d9d02646b6b7ac12940524aedcd59257d192f/comments", "author": {"login": "ronancpl", "id": 9257761, "node_id": "MDQ6VXNlcjkyNTc3NjE=", "avatar_url": "https://avatars2.githubusercontent.com/u/9257761?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ronancpl", "html_url": "https://github.com/ronancpl", "followers_url": "https://api.github.com/users/ronancpl/followers", "following_url": "https://api.github.com/users/ronancpl/following{/other_user}", "gists_url": "https://api.github.com/users/ronancpl/gists{/gist_id}", "starred_url": "https://api.github.com/users/ronancpl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ronancpl/subscriptions", "organizations_url": "https://api.github.com/users/ronancpl/orgs", "repos_url": "https://api.github.com/users/ronancpl/repos", "events_url": "https://api.github.com/users/ronancpl/events{/privacy}", "received_events_url": "https://api.github.com/users/ronancpl/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ronancpl", "id": 9257761, "node_id": "MDQ6VXNlcjkyNTc3NjE=", "avatar_url": "https://avatars2.githubusercontent.com/u/9257761?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ronancpl", "html_url": "https://github.com/ronancpl", "followers_url": "https://api.github.com/users/ronancpl/followers", "following_url": "https://api.github.com/users/ronancpl/following{/other_user}", "gists_url": "https://api.github.com/users/ronancpl/gists{/gist_id}", "starred_url": "https://api.github.com/users/ronancpl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ronancpl/subscriptions", "organizations_url": "https://api.github.com/users/ronancpl/orgs", "repos_url": "https://api.github.com/users/ronancpl/repos", "events_url": "https://api.github.com/users/ronancpl/events{/privacy}", "received_events_url": "https://api.github.com/users/ronancpl/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8c61c616f984ada8471174600253552140a4aba4", "url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/8c61c616f984ada8471174600253552140a4aba4", "html_url": "https://github.com/ronancpl/HeavenMS/commit/8c61c616f984ada8471174600253552140a4aba4"}], "stats": {"total": 647, "additions": 309, "deletions": 338}, "files": [{"sha": "9ae27a48deac6895df0516e0d4683788fa622550", "filename": "README.txt", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/768d9d02646b6b7ac12940524aedcd59257d192f/README.txt", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/768d9d02646b6b7ac12940524aedcd59257d192f/README.txt", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/README.txt?ref=768d9d02646b6b7ac12940524aedcd59257d192f", "patch": "@@ -119,6 +119,9 @@ property settings must follow these:\n \t- Run as an administrator;\n \t- Opening \"lolwut.exe\", use Fraysa's method.\n \n+Alternatively, there is available the No-Damage Cap version of the MapleStory client. Just extract and use the\n+\"localhost.exe\" from the one package with the given name.\n+\n ---- Important note about CLIENT EDITING ----\n \n DO NOT USE the server's XMLs for reimporting into the client's WZ, it WILL generate some kind of bugs afterwards."}, {"sha": "26c6b902870f00849b495c00ab38bf05f3db1a12", "filename": "mychanges_ptbr.txt", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/768d9d02646b6b7ac12940524aedcd59257d192f/mychanges_ptbr.txt", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/768d9d02646b6b7ac12940524aedcd59257d192f/mychanges_ptbr.txt", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/mychanges_ptbr.txt?ref=768d9d02646b6b7ac12940524aedcd59257d192f", "patch": "@@ -143,4 +143,9 @@ Adi\n Adi\ufffd\ufffdo de efeito: Zombify.\n Adi\ufffd\ufffdo da expedi\ufffd\ufffdo BPQ.\n Aprimoramento de m\ufffdtodos que usam acesso concorrente no projeto.\n-Diversas pequenas altera\ufffd\ufffdes nos WZs do cliente/servidor.\n\\ No newline at end of file\n+Diversas pequenas altera\ufffd\ufffdes nos WZs do cliente/servidor.\n+\n+10 Abril 2017,\n+Navio de Crimson Balrogs agora s\ufffdo renderizados na tela, mesmo depois de mudar de mapas.\n+Adi\ufffd\ufffdo de client alternativo: MapleStory sem Damage Cap.\n+Adi\ufffd\ufffdo de expedi\ufffd\ufffdes PiratePQ e EllinPQ.\n\\ No newline at end of file"}, {"sha": "4ce607c8ff1aee27455576d2fe0583e08f915690", "filename": "nbproject/private/private.xml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/768d9d02646b6b7ac12940524aedcd59257d192f/nbproject/private/private.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/768d9d02646b6b7ac12940524aedcd59257d192f/nbproject/private/private.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/nbproject/private/private.xml?ref=768d9d02646b6b7ac12940524aedcd59257d192f", "patch": "@@ -3,7 +3,7 @@\n     <editor-bookmarks xmlns=\"http://www.netbeans.org/ns/editor-bookmarks/2\" lastBookmarkId=\"0\"/>\n     <open-files xmlns=\"http://www.netbeans.org/ns/projectui-open-files/2\">\n         <group>\n-            <file>file:/C:/Nexon/MapleSolaxia/src/server/maps/MapleMap.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/src/server/life/MobSkill.java</file>\n         </group>\n     </open-files>\n </project-private>"}, {"sha": "583cd2b47154d336dc78f20d0d3f5db9e5c05d0e", "filename": "scripts/event/Boats.js", "status": "modified", "additions": 28, "deletions": 23, "changes": 51, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/768d9d02646b6b7ac12940524aedcd59257d192f/scripts/event/Boats.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/768d9d02646b6b7ac12940524aedcd59257d192f/scripts/event/Boats.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/event/Boats.js?ref=768d9d02646b6b7ac12940524aedcd59257d192f", "patch": "@@ -6,7 +6,8 @@ importPackage(Packages.server.life);\n var closeTime = 50 * 1000; //The time to close the gate\n var beginTime = 60 * 1000; //The time to begin the ride\n var rideTime = 120 * 1000; //The time that require move to destination\n-var invasionTime = 30 * 1000; //The time that spawn balrog\n+var invasionTime = 30 * 1000; //The time to balrog ship approach\n+var invasionDelay = 5 * 1000; //The time that spawn balrog\n var Orbis_btf;\n var Boat_to_Orbis;\n var Orbis_Boat_Cabin;\n@@ -26,26 +27,24 @@ function init() {\n     Orbis_Station = em.getChannelServer().getMapFactory().getMap(200000100);\n     Orbis_docked = em.getChannelServer().getMapFactory().getMap(200000111);\n     \n+    Ellinia_docked.setDocked(true);\n+    Orbis_docked.setDocked(true);\n+    \n     scheduleNew();\n }\n \n function scheduleNew() {\n     em.setProperty(\"docked\", \"true\");\n-    Ellinia_docked.setDocked(true);\n-    Orbis_docked.setDocked(true);\n     \n     em.setProperty(\"entry\", \"true\");\n     em.setProperty(\"haveBalrog\", \"false\");\n     em.schedule(\"stopentry\", closeTime);\n     em.schedule(\"takeoff\", beginTime);\n-\n-    Boat_to_Orbis.killAllMonsters();\n-    Boat_to_Ellinia.killAllMonsters();\n }\n \n function stopentry() {\n     em.setProperty(\"entry\",\"false\");\n-    Orbis_Boat_Cabin.resetReactors();\n+    Orbis_Boat_Cabin.resetReactors();   //boxes\n     Ellinia_Boat_Cabin.resetReactors();\n }\n \n@@ -56,10 +55,8 @@ function takeoff() {\n     Orbis_docked.broadcastShip(false);\n     \n     em.setProperty(\"docked\",\"false\");\n-    Ellinia_docked.setDocked(false);\n-    Orbis_docked.setDocked(false);\n     \n-    em.schedule(\"invasion\", invasionTime);\n+    em.schedule(\"approach\", invasionTime);\n     em.schedule(\"arrived\", rideTime);\n }\n \n@@ -70,29 +67,37 @@ function arrived() {\n     Ellinia_Boat_Cabin.warpEveryone(Ellinia_docked.getId());\n     Orbis_docked.broadcastShip(true);\n     Ellinia_docked.broadcastShip(true);\n+    Boat_to_Orbis.broadcastEnemyShip(false);\n+    Boat_to_Ellinia.broadcastEnemyShip(false);\n     Boat_to_Orbis.killAllMonsters();\n     Boat_to_Ellinia.killAllMonsters();\n     em.setProperty(\"haveBalrog\", \"false\");\n     scheduleNew();\n }\n \n-function invasion() {\n+function approach() {\n     if (Math.floor(Math.random() * 10) < 10) {\n-\tvar map1 = Boat_to_Ellinia;\n-\tvar pos1 = new java.awt.Point(-538, 143);\n-\tmap1.spawnMonsterOnGroundBelow(MapleLifeFactory.getMonster(8150000), pos1);\n-\tmap1.spawnMonsterOnGroundBelow(MapleLifeFactory.getMonster(8150000), pos1);\n-\n-\tvar map2 = Boat_to_Orbis;\n-\tvar pos2 = new java.awt.Point(339, 148);\n-\tmap2.spawnMonsterOnGroundBelow(MapleLifeFactory.getMonster(8150000), pos2);\n-\tmap2.spawnMonsterOnGroundBelow(MapleLifeFactory.getMonster(8150000), pos2);\n-\n         em.setProperty(\"haveBalrog\",\"true\");\n-        Boat_to_Ellinia.broadcastShip(true);\n-        Boat_to_Orbis.broadcastShip(true);\n+        Boat_to_Orbis.broadcastEnemyShip(true);\n+        Boat_to_Ellinia.broadcastEnemyShip(true);\n+        Boat_to_Orbis.broadcastMessage(MaplePacketCreator.musicChange(\"Bgm04/ArabPirate\"));\n+        Boat_to_Ellinia.broadcastMessage(MaplePacketCreator.musicChange(\"Bgm04/ArabPirate\"));\n+        \n+        em.schedule(\"invasion\", invasionDelay);\n     }\n }\n \n+function invasion() {\n+    var map1 = Boat_to_Ellinia;\n+    var pos1 = new java.awt.Point(-538, 143);\n+    map1.spawnMonsterOnGroundBelow(MapleLifeFactory.getMonster(8150000), pos1);\n+    map1.spawnMonsterOnGroundBelow(MapleLifeFactory.getMonster(8150000), pos1);\n+\n+    var map2 = Boat_to_Orbis;\n+    var pos2 = new java.awt.Point(339, 148);\n+    map2.spawnMonsterOnGroundBelow(MapleLifeFactory.getMonster(8150000), pos2);\n+    map2.spawnMonsterOnGroundBelow(MapleLifeFactory.getMonster(8150000), pos2);\n+}\n+\n function cancelSchedule() {\n }\n\\ No newline at end of file"}, {"sha": "882d42771e931bc0f4b32346b2c7870ae46f27f3", "filename": "scripts/event/Ellin.js", "status": "modified", "additions": 10, "deletions": 11, "changes": 21, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/768d9d02646b6b7ac12940524aedcd59257d192f/scripts/event/Ellin.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/768d9d02646b6b7ac12940524aedcd59257d192f/scripts/event/Ellin.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/event/Ellin.js?ref=768d9d02646b6b7ac12940524aedcd59257d192f", "patch": "@@ -1,14 +1,14 @@\n var minPlayers = 2;\n \n function init() {\n-em.setProperty(\"state\", \"0\");\n+        em.setProperty(\"state\", \"0\");\n \tem.setProperty(\"leader\", \"true\");\n }\n \n function setup(level, leaderid) {\n-em.setProperty(\"state\", \"1\");\n+        em.setProperty(\"state\", \"1\");\n \tem.setProperty(\"leader\", \"true\");\n-    var eim = em.newInstance(\"Ellin\" + leaderid);\n+        var eim = em.newInstance(\"Ellin\" + leaderid);\n \n         eim.setInstanceMap(930000000).resetPQ(level);\n \teim.setInstanceMap(930000100).resetPQ(level);\n@@ -21,21 +21,20 @@ em.setProperty(\"state\", \"1\");\n \teim.setInstanceMap(930000600).resetPQ(level);\n \teim.setInstanceMap(930000700).resetPQ(level);\n \n-    eim.startEventTimer(1200000); //20 mins\n-    return eim;\n+        eim.startEventTimer(20 * 60000); //20 mins\n+        return eim;\n }\n \n function playerEntry(eim, player) {\n-    var map = eim.getMapInstance(0);\n-    player.changeMap(map, map.getPortal(0));\n-    player.tryPartyQuest(1206);\n+        var map = eim.getMapInstance(0);\n+        player.changeMap(map, map.getPortal(0));\n }\n \n function playerRevive(eim, player) {\n }\n \n function scheduledTimeout(eim) {\n-    end(eim);\n+        end(eim);\n }\n \n function changedMap(eim, player, mapid) {\n@@ -68,8 +67,8 @@ function playerExit(eim, player) {\n \n function end(eim) {\n     eim.disposeIfPlayerBelow(100, 930000800);\n-\tem.setProperty(\"state\", \"0\");\n-\t\tem.setProperty(\"leader\", \"true\");\n+    em.setProperty(\"state\", \"0\");\n+    em.setProperty(\"leader\", \"true\");\n }\n \n function clearPQ(eim) {"}, {"sha": "a8228dc96b5196c11ec8eb89f5ecda5ab66fab86", "filename": "scripts/event/PiratePQ.js", "status": "modified", "additions": 13, "deletions": 12, "changes": 25, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/768d9d02646b6b7ac12940524aedcd59257d192f/scripts/event/PiratePQ.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/768d9d02646b6b7ac12940524aedcd59257d192f/scripts/event/PiratePQ.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/event/PiratePQ.js?ref=768d9d02646b6b7ac12940524aedcd59257d192f", "patch": "@@ -1,3 +1,4 @@\n+var isPq = true;\n var minPlayers = 1;\n \n function init() {\n@@ -27,10 +28,10 @@ em.setProperty(\"state\", \"1\");\n \t\teim.registerMonster(mob2);\n \t\teim.registerMonster(mob3);\n \t\teim.registerMonster(mob4);\n-\t\tmob.changeLevel(level);\n-\t\tmob2.changeLevel(level);\n-\t\tmob3.changeLevel(level);\n-\t\tmob4.changeLevel(level);\n+\t\tmob.changeDifficulty(level,isPq);\n+\t\tmob2.changeDifficulty(level,isPq);\n+\t\tmob3.changeDifficulty(level,isPq);\n+\t\tmob4.changeDifficulty(level,isPq);\n \t\tmap.spawnMonsterOnGroundBelow(mob, new java.awt.Point(430, 75));\n \t\tmap.spawnMonsterOnGroundBelow(mob2, new java.awt.Point(1600, 75));\n \t\tmap.spawnMonsterOnGroundBelow(mob3, new java.awt.Point(430, 238));\n@@ -43,8 +44,8 @@ em.setProperty(\"state\", \"1\");\n \t\tvar mob2 = em.getMonster(9300113);\n \t\teim.registerMonster(mob);\n \t\teim.registerMonster(mob2);\n-\t\tmob.changeLevel(level);\n-\t\tmob2.changeLevel(level);\n+\t\tmob.changeDifficulty(level,isPq);\n+\t\tmob2.changeDifficulty(level,isPq);\n \t\tmap.spawnMonsterOnGroundBelow(mob, new java.awt.Point(0, 238));\n \t\tmap.spawnMonsterOnGroundBelow(mob2, new java.awt.Point(1700, 238));\n \t}\n@@ -60,10 +61,10 @@ em.setProperty(\"state\", \"1\");\n \t\teim.registerMonster(mob2);\n \t\teim.registerMonster(mob3);\n \t\teim.registerMonster(mob4);\n-\t\tmob.changeLevel(level);\n-\t\tmob2.changeLevel(level);\n-\t\tmob3.changeLevel(level);\n-\t\tmob4.changeLevel(level);\n+\t\tmob.changeDifficulty(level,isPq);\n+\t\tmob2.changeDifficulty(level,isPq);\n+\t\tmob3.changeDifficulty(level,isPq);\n+\t\tmob4.changeDifficulty(level,isPq);\n \t\tmap.spawnMonsterOnGroundBelow(mob, new java.awt.Point(430, 75));\n \t\tmap.spawnMonsterOnGroundBelow(mob2, new java.awt.Point(1600, 75));\n \t\tmap.spawnMonsterOnGroundBelow(mob3, new java.awt.Point(430, 238));\n@@ -76,8 +77,8 @@ em.setProperty(\"state\", \"1\");\n \t\tvar mob2 = em.getMonster(9300113);\n \t\teim.registerMonster(mob);\n \t\teim.registerMonster(mob2);\n-\t\tmob.changeLevel(level);\n-\t\tmob2.changeLevel(level);\n+\t\tmob.changeDifficulty(level,isPq);\n+\t\tmob2.changeDifficulty(level,isPq);\n \t\tmap.spawnMonsterOnGroundBelow(mob, new java.awt.Point(0, 238));\n \t\tmap.spawnMonsterOnGroundBelow(mob2, new java.awt.Point(1700, 238));\n \t}"}, {"sha": "5965acd17a2e9a233f0116647813c17b666c0a6b", "filename": "scripts/map/onUserEnter/101000300.js", "status": "removed", "additions": 0, "deletions": 13, "changes": 13, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/8c61c616f984ada8471174600253552140a4aba4/scripts/map/onUserEnter/101000300.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/8c61c616f984ada8471174600253552140a4aba4/scripts/map/onUserEnter/101000300.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/map/onUserEnter/101000300.js?ref=8c61c616f984ada8471174600253552140a4aba4", "patch": "@@ -1,13 +0,0 @@\n-importPackage(Packages.tools);\n-\n-var eventName = \"Boats\";\n-var toMap = 200090010;\n-\n-function start(ms) {   \t       \n-\tvar em = ms.getClient().getEventManager(eventName);\n-\t\n-\t//is the player late to start the travel?\n-\tif(em.getProperty(\"docked\") == \"false\") {\n-\t\tms.getClient().getPlayer().warp(toMap);\n-        }\n-}"}, {"sha": "04bc08a5ca6a31ac33ff0631dfd2b1cd1cf490bb", "filename": "scripts/map/onUserEnter/103000000.js", "status": "removed", "additions": 0, "deletions": 13, "changes": 13, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/8c61c616f984ada8471174600253552140a4aba4/scripts/map/onUserEnter/103000000.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/8c61c616f984ada8471174600253552140a4aba4/scripts/map/onUserEnter/103000000.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/map/onUserEnter/103000000.js?ref=8c61c616f984ada8471174600253552140a4aba4", "patch": "@@ -1,13 +0,0 @@\n-importPackage(Packages.tools);\n-\n-var eventName = \"AirPlane\";\n-var toMap = 540010101;\n-\n-function start(ms) {   \t       \n-\tvar em = ms.getClient().getEventManager(eventName);\n-\t\n-\t//is the player late to start the travel?\n-\tif(em.getProperty(\"docked\") == \"false\") {\n-\t\tms.getClient().getPlayer().warp(toMap);\n-        }\n-}"}, {"sha": "450d1c041789dd213d6680db2a559e41a60cf9b0", "filename": "scripts/map/onUserEnter/103000100.js", "status": "removed", "additions": 0, "deletions": 13, "changes": 13, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/8c61c616f984ada8471174600253552140a4aba4/scripts/map/onUserEnter/103000100.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/8c61c616f984ada8471174600253552140a4aba4/scripts/map/onUserEnter/103000100.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/map/onUserEnter/103000100.js?ref=8c61c616f984ada8471174600253552140a4aba4", "patch": "@@ -1,13 +0,0 @@\n-importPackage(Packages.tools);\n-\n-var eventName = \"Subway\";\n-var toMap = 600010005;\n-\n-function start(ms) {   \t       \n-\tvar em = ms.getClient().getEventManager(eventName);\n-\t\n-\t//is the player late to start the travel?\n-\tif(em.getProperty(\"docked\") == \"false\") {\n-\t\tms.getClient().getPlayer().warp(toMap);\n-        }\n-}"}, {"sha": "b9a0586ebb2c01a3b4e34c2eda7fe3140d58b9f1", "filename": "scripts/map/onUserEnter/200000111.js", "status": "removed", "additions": 0, "deletions": 13, "changes": 13, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/8c61c616f984ada8471174600253552140a4aba4/scripts/map/onUserEnter/200000111.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/8c61c616f984ada8471174600253552140a4aba4/scripts/map/onUserEnter/200000111.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/map/onUserEnter/200000111.js?ref=8c61c616f984ada8471174600253552140a4aba4", "patch": "@@ -1,13 +0,0 @@\n-importPackage(Packages.tools);\n-\n-var eventName = \"Boats\";\n-var toMap = 200090000;\n-\n-function start(ms) {   \t       \n-\tvar em = ms.getClient().getEventManager(eventName);\n-\t\n-\t//is the player late to start the travel?\n-\tif(em.getProperty(\"docked\") == \"false\") {\n-\t\tms.getClient().getPlayer().warp(toMap);\n-        }\n-}"}, {"sha": "575bc2399bed8273f7045fdc53609ecd22d29b0a", "filename": "scripts/map/onUserEnter/200000121.js", "status": "removed", "additions": 0, "deletions": 13, "changes": 13, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/8c61c616f984ada8471174600253552140a4aba4/scripts/map/onUserEnter/200000121.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/8c61c616f984ada8471174600253552140a4aba4/scripts/map/onUserEnter/200000121.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/map/onUserEnter/200000121.js?ref=8c61c616f984ada8471174600253552140a4aba4", "patch": "@@ -1,13 +0,0 @@\n-importPackage(Packages.tools);\n-\n-var eventName = \"Trains\";\n-var toMap = 200090100;\n-\n-function start(ms) {   \t       \n-\tvar em = ms.getClient().getEventManager(eventName);\n-\t\n-\t//is the player late to start the travel?\n-\tif(em.getProperty(\"docked\") == \"false\") {\n-\t\tms.getClient().getPlayer().warp(toMap);\n-        }\n-}\n\\ No newline at end of file"}, {"sha": "90fa941bbadb97cc9cf0fa7c189392d76a9b6633", "filename": "scripts/map/onUserEnter/200000131.js", "status": "removed", "additions": 0, "deletions": 13, "changes": 13, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/8c61c616f984ada8471174600253552140a4aba4/scripts/map/onUserEnter/200000131.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/8c61c616f984ada8471174600253552140a4aba4/scripts/map/onUserEnter/200000131.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/map/onUserEnter/200000131.js?ref=8c61c616f984ada8471174600253552140a4aba4", "patch": "@@ -1,13 +0,0 @@\n-importPackage(Packages.tools);\n-\n-var eventName = \"Cabin\";\n-var toMap = 200090200;\n-\n-function start(ms) {   \t       \n-\tvar em = ms.getClient().getEventManager(eventName);\n-\t\n-\t//is the player late to start the travel?\n-\tif(em.getProperty(\"docked\") == \"false\") {\n-\t\tms.getClient().getPlayer().warp(toMap);\n-        }\n-}"}, {"sha": "7c015fc928d63e4e1617c88f62d41832584d3ced", "filename": "scripts/map/onUserEnter/200000151.js", "status": "removed", "additions": 0, "deletions": 13, "changes": 13, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/8c61c616f984ada8471174600253552140a4aba4/scripts/map/onUserEnter/200000151.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/8c61c616f984ada8471174600253552140a4aba4/scripts/map/onUserEnter/200000151.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/map/onUserEnter/200000151.js?ref=8c61c616f984ada8471174600253552140a4aba4", "patch": "@@ -1,13 +0,0 @@\n-importPackage(Packages.tools);\n-\n-var eventName = \"Genie\";\n-var toMap = 200090400;\n-\n-function start(ms) {   \t       \n-\tvar em = ms.getClient().getEventManager(eventName);\n-\t\n-\t//is the player late to start the travel?\n-\tif(em.getProperty(\"docked\") == \"false\") {\n-\t\tms.getClient().getPlayer().warp(toMap);\n-        }\n-}"}, {"sha": "4d6b0e02b4217b50aef84a71b90cb004f272e780", "filename": "scripts/map/onUserEnter/200090000.js", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/768d9d02646b6b7ac12940524aedcd59257d192f/scripts/map/onUserEnter/200090000.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/768d9d02646b6b7ac12940524aedcd59257d192f/scripts/map/onUserEnter/200090000.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/map/onUserEnter/200090000.js?ref=768d9d02646b6b7ac12940524aedcd59257d192f", "patch": "@@ -0,0 +1,15 @@\n+// Author: Ronan\n+importPackage(Packages.tools);\n+\n+var mapId = 200090000;\n+\n+function start(pi) {\n+\tvar map = pi.getClient().getChannelServer().getMapFactory().getMap(mapId);\n+\n+\tif(map.getDocked()) {\n+\t\tpi.getClient().announce(MaplePacketCreator.musicChange(\"Bgm04/ArabPirate\"));\n+\t\tpi.getClient().announce(MaplePacketCreator.crogBoatPacket(true));\n+\t}\n+\n+\treturn(true);\n+}\n\\ No newline at end of file"}, {"sha": "49ebeffc7215b31dac8a254a6a50a5e6ff9a77bb", "filename": "scripts/map/onUserEnter/200090010.js", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/768d9d02646b6b7ac12940524aedcd59257d192f/scripts/map/onUserEnter/200090010.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/768d9d02646b6b7ac12940524aedcd59257d192f/scripts/map/onUserEnter/200090010.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/map/onUserEnter/200090010.js?ref=768d9d02646b6b7ac12940524aedcd59257d192f", "patch": "@@ -0,0 +1,15 @@\n+// Author: Ronan\n+importPackage(Packages.tools);\n+\n+var mapId = 200090010;\n+\n+function start(pi) {\n+\tvar map = pi.getClient().getChannelServer().getMapFactory().getMap(mapId);\n+\n+\tif(map.getDocked()) {\n+\t\tpi.getClient().announce(MaplePacketCreator.musicChange(\"Bgm04/ArabPirate\"));\n+\t\tpi.getClient().announce(MaplePacketCreator.crogBoatPacket(true));\n+\t}\n+\n+\treturn(true);\n+}\n\\ No newline at end of file"}, {"sha": "7cda564f10c853aff16a9ea871dce3dcf63eedc3", "filename": "scripts/map/onUserEnter/220000110.js", "status": "removed", "additions": 0, "deletions": 13, "changes": 13, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/8c61c616f984ada8471174600253552140a4aba4/scripts/map/onUserEnter/220000110.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/8c61c616f984ada8471174600253552140a4aba4/scripts/map/onUserEnter/220000110.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/map/onUserEnter/220000110.js?ref=8c61c616f984ada8471174600253552140a4aba4", "patch": "@@ -1,13 +0,0 @@\n-importPackage(Packages.tools);\n-\n-var eventName = \"Trains\";\n-var toMap = 200090110;\n-\n-function start(ms) {   \t       \n-\tvar em = ms.getClient().getEventManager(eventName);\n-\t\n-\t//is the player late to start the travel?\n-\tif(em.getProperty(\"docked\") == \"false\") {\n-\t\tms.getClient().getPlayer().warp(toMap);\n-        }\n-}\n\\ No newline at end of file"}, {"sha": "42f4da5c8a84dc40f962de85cc53c071d6a94492", "filename": "scripts/map/onUserEnter/240000110.js", "status": "removed", "additions": 0, "deletions": 13, "changes": 13, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/8c61c616f984ada8471174600253552140a4aba4/scripts/map/onUserEnter/240000110.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/8c61c616f984ada8471174600253552140a4aba4/scripts/map/onUserEnter/240000110.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/map/onUserEnter/240000110.js?ref=8c61c616f984ada8471174600253552140a4aba4", "patch": "@@ -1,13 +0,0 @@\n-importPackage(Packages.tools);\n-\n-var eventName = \"Cabin\";\n-var toMap = 200090210;\n-\n-function start(ms) {   \t       \n-\tvar em = ms.getClient().getEventManager(eventName);\n-\t\n-\t//is the player late to start the travel?\n-\tif(em.getProperty(\"docked\") == \"false\") {\n-\t\tms.getClient().getPlayer().warp(toMap);\n-        }\n-}"}, {"sha": "07d208a0bd6f78519ca571d56a3b3b4789b88807", "filename": "scripts/map/onUserEnter/260000100.js", "status": "removed", "additions": 0, "deletions": 13, "changes": 13, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/8c61c616f984ada8471174600253552140a4aba4/scripts/map/onUserEnter/260000100.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/8c61c616f984ada8471174600253552140a4aba4/scripts/map/onUserEnter/260000100.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/map/onUserEnter/260000100.js?ref=8c61c616f984ada8471174600253552140a4aba4", "patch": "@@ -1,13 +0,0 @@\n-importPackage(Packages.tools);\n-\n-var eventName = \"Genie\";\n-var toMap = 200090410;\n-\n-function start(ms) {   \t       \n-\tvar em = ms.getClient().getEventManager(eventName);\n-\t\n-\t//is the player late to start the travel?\n-\tif(em.getProperty(\"docked\") == \"false\") {\n-\t\tms.getClient().getPlayer().warp(toMap);\n-        }\n-}"}, {"sha": "7e6ab137b6ceb4984f3e948744a4d3ce6ee428b2", "filename": "scripts/map/onUserEnter/540010000.js", "status": "removed", "additions": 0, "deletions": 13, "changes": 13, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/8c61c616f984ada8471174600253552140a4aba4/scripts/map/onUserEnter/540010000.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/8c61c616f984ada8471174600253552140a4aba4/scripts/map/onUserEnter/540010000.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/map/onUserEnter/540010000.js?ref=8c61c616f984ada8471174600253552140a4aba4", "patch": "@@ -1,13 +0,0 @@\n-importPackage(Packages.tools);\n-\n-var eventName = \"AirPlane\";\n-var toMap = 540010002;\n-\n-function start(ms) {   \t       \n-\tvar em = ms.getClient().getEventManager(eventName);\n-\t\n-\t//is the player late to start the travel?\n-\tif(em.getProperty(\"docked\") == \"false\") {\n-\t\tms.getClient().getPlayer().warp(toMap);\n-        }\n-}"}, {"sha": "f8d4979686a201488ae97180d4c3314e51f64e4c", "filename": "scripts/map/onUserEnter/600010001.js", "status": "removed", "additions": 0, "deletions": 13, "changes": 13, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/8c61c616f984ada8471174600253552140a4aba4/scripts/map/onUserEnter/600010001.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/8c61c616f984ada8471174600253552140a4aba4/scripts/map/onUserEnter/600010001.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/map/onUserEnter/600010001.js?ref=8c61c616f984ada8471174600253552140a4aba4", "patch": "@@ -1,13 +0,0 @@\n-importPackage(Packages.tools);\n-\n-var eventName = \"Subway\";\n-var toMap = 600010003;\n-\n-function start(ms) {   \t       \n-\tvar em = ms.getClient().getEventManager(eventName);\n-\t\n-\t//is the player late to start the travel?\n-\tif(em.getProperty(\"docked\") == \"false\") {\n-\t\tms.getClient().getPlayer().warp(toMap);\n-        }\n-}"}, {"sha": "e69de29bb2d1d6434b8b29ae775ad8c2e48c5391", "filename": "scripts/map/onUserEnter/921100300.txt", "status": "removed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/8c61c616f984ada8471174600253552140a4aba4/scripts/map/onUserEnter/921100300.txt", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/8c61c616f984ada8471174600253552140a4aba4/scripts/map/onUserEnter/921100300.txt", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/map/onUserEnter/921100300.txt?ref=8c61c616f984ada8471174600253552140a4aba4"}, {"sha": "e69de29bb2d1d6434b8b29ae775ad8c2e48c5391", "filename": "scripts/map/onUserEnter/923010000.txt", "status": "removed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/8c61c616f984ada8471174600253552140a4aba4/scripts/map/onUserEnter/923010000.txt", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/8c61c616f984ada8471174600253552140a4aba4/scripts/map/onUserEnter/923010000.txt", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/map/onUserEnter/923010000.txt?ref=8c61c616f984ada8471174600253552140a4aba4"}, {"sha": "7efc7a0d9ac070100532c59513284846f4a792b0", "filename": "scripts/npc/world0/1012008.js", "status": "modified", "additions": 106, "deletions": 105, "changes": 211, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/768d9d02646b6b7ac12940524aedcd59257d192f/scripts/npc/world0/1012008.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/768d9d02646b6b7ac12940524aedcd59257d192f/scripts/npc/world0/1012008.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/world0/1012008.js?ref=768d9d02646b6b7ac12940524aedcd59257d192f", "patch": "@@ -1,120 +1,121 @@\n /*\n-\tThis file is part of the OdinMS Maple Story Server\n-    Copyright (C) 2008 Patrick Huy <patrick.huy@frz.cc>\n-\t\t       Matthias Butz <matze@odinms.de>\n-\t\t       Jan Christian Meyer <vimes@odinms.de>\n+ * @Author - Sparrow\n+ * @NPC - 1012008 - Casey the Game Master\n+ * @Map - 100000203 - Henesys Game Park\n+ */\n \n-    This program is free software: you can redistribute it and/or modify\n-    it under the terms of the GNU Affero General Public License as\n-    published by the Free Software Foundation version 3 as published by\n-    the Free Software Foundation. You may not use, modify or distribute\n-    this program under any other version of the GNU Affero General Public\n-    License.\n-\n-    This program is distributed in the hope that it will be useful,\n-    but WITHOUT ANY WARRANTY; without even the implied warranty of\n-    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n-    GNU Affero General Public License for more details.\n-\n-    You should have received a copy of the GNU Affero General Public License\n-    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n-\n-    Author: Ronan Lana\n-*/\n-/* Casey\n-\tHenesys Game Park (1012008)\n-\t\n-\tRefining NPC: \n-\t* Omok sets - Set 1\n-\t* Match of cards\n-*/\n-\n-var status = -1;\n-var selectedType = -1;\n-var selectedItem = -1;\n-var item;\n-var mats;\n-var matQty;\n-var cost;\n-var qty;\n-\n-var items = [4080100,4080000,4080001,4080002,4080003,4080004,4080005];\n-var matSet = [[4030012],[4030009,4030000,4030001],[4030009,4030000,4030010],[4030009,4030000,4030011],[4030009,4030010,4030001],[4030009,4030011,4030010],[4030009,4030011,4030001]];\n-var matQtySet = [[99],[1,99,99],[1,99,99],[1,99,99],[1,99,99],[1,99,99],[1,99,99]];\n-var costSet = [10000,25000,25000,25000,25000,25000,25000];\n+var status;\n+var current;\n+var omok =       [4080000, 4080001, 4080002, 4080003, 4080004, 4080005];\n+var omok1piece = [4030000, 4030000, 4030000, 4030010, 4030011, 4030011];\n+var omok2piece = [4030001, 4030010, 4030011, 4030001, 4030010, 4030001];\n+var omokamount = 99;\n+var text = \"The set also differs based on what kind of pieces you want to use for the game. Which set would you like to make?\"\n \n function start() {\n-    cm.getPlayer().setCS(true);\n-    var selStr = \"Hey there! My name is #p1012008#, and I am a specialist in mini-games. What kind of mini-game you want me to make? #b\"\n-    var options = [\"#i4080100# #t4080100#\",\"#i4080006# #t4080006#\",\"#i4080007# #t4080007#\",\"#i4080008# #t4080008#\",\"#i4080009# #t4080009#\",\"#i4080010# #t4080010#\",\"#i4080011# #t4080011#\"];\n-    for (var i = 0; i < options.length; i++)\n-        selStr += \"\\r\\n#L\" + i + \"# \" + options[i] + \"#l\";\n-    cm.sendSimple(selStr);\n+    current = 0;\n+    status = -1;\n+    action(1,0,0);\n }\n \n function action(mode, type, selection) {\n-    status++;\n-    if (mode != 1){\n+    if(mode == -1 && current > 0) {\n         cm.dispose();\n         return;\n+    } else {\n+        if(mode == 1) { \n+            status++;\n+        } else {\n+            status--;\n+        }\n     }\n-    if (status == 0) {        \n-        selectedItem = selection;\n-        \n-        item = items[selectedItem];\n-        mats = matSet[selectedItem];\n-        matQty = matQtySet[selectedItem];\n-        cost = costSet[selectedItem];\n-        qty = 1;\n-        \n-        var prompt = \"So we are going for \";\n-        if (qty == 1)\n-            prompt += \"a #t\" + item + \"#\";\n-        else\n-            prompt += qty + \" #t\" + item + \"#\";\n-        prompt += \", right? In that case, I'm going to need specific items from you in order to make it. Make sure you have room in your inventory, though!#b\";\n-        if (mats instanceof Array)\n-            for(var i = 0; i < mats.length; i++)\n-                prompt += \"\\r\\n#i\" + mats[i] + \"# \" + (matQty[i] * qty) + \" #t\" + mats[i] + \"#\";\n-        else\n-            prompt += \"\\r\\n#i\" + mats + \"# \" + (matQty * qty) + \" #t\" + mats + \"#\";\n-        if (cost > 0)\n-            prompt += \"\\r\\n#i4031138# \" + (cost * qty) + \" meso\";\n-        cm.sendYesNo(prompt);\n-    }else if (status == 1) {\n-        var complete = true;\n-        \n-        if (cm.getMeso() < (cost * qty)) {\n-            cm.sendOk(\"See, I need to specify my wages to support my career, that cannot be bypassed. I will gladly help you once you've got the money.\");\n-            cm.dispose();\n-            return;\n+\n+    if (status == 0) {\n+        cm.sendSimple(\"Hey, you look like you need a breather. You should be enjoying the life, just like I am. Well, if you have a couple of items, I can trade you for an item you can play minigames with. Now... what can I do for you?#b\\r\\n#L0#Create a minigame item#l\\r\\n#L1#Explain to me what the minigames are about#l#k\");\n+      \n+    } else if (status == 1) {\n+        if (selection == 0) {\n+            cm.sendSimple(\"You want to make the minigame item? Minigames aren't something you can just go ahead and play right off the bat. For each minigame, you'll need a specific set of items. Which minigame it em do you want to make?#b\\r\\n#L4#Omok Set#l\\r\\n#L5#A Set of Match Cards#l#k\");\n+        } else if (selection == 1) {\n+            cm.sendSimple(\"You want to learn more about the minigames? Awesome! Ask me anything. Which minigame do you want to know more about?#b\\r\\n#L2#Omok#l\\r\\n#L3#Match Cards#l#k\");\n         }\n-        else {\n-            if (mats instanceof Array) {\n-                for(var i = 0; complete && i < mats.length; i++)\n-                    if (!cm.haveItem(mats[i], matQty[i]))\n-                        complete = false;\n-            }else if (!cm.haveItem(mats, matQty))\n-                complete = false;\n-        }\t\n-        if (!complete)\n-            cm.sendOk(\"You are lacking some items for the set you want to make. Please provide them so that we can assemble the game set.\");\n-        else {\n-            if (cm.canHold(item,qty)) {\n-                if (mats instanceof Array) {\n-                    for (var i = 0; i < mats.length; i++)\n-                        cm.gainItem(mats[i], -(matQty[i] * qty));\n-                }else\n-                    cm.gainItem(mats, -(matQty * qty));\n-                cm.gainMeso(-(cost * qty));\n-                \n-                cm.gainItem(item, qty);\n-                cm.sendOk(\"There is your game set. Have fun!\");\n-            }else {\n-                cm.sendOk(\"I can't make a set for you if there's no room in your ETC inventory for it. Please free a space first and then talk to me.\");\n+\n+    } else if (status == 2) {\n+        if (selection == 2) {\n+            current = 1;\n+            cm.sendNext(\"Here are the rules for Omok, so listen carefully. Omok is a game in which you and your opponent take turns laying a piece on the table until someone finds a way to lay 5 consecutive pieces in a line, be it horizontal, diagonal, or vertical. For starters, only the ones with an #bOmok Set#k can open a game room.\");\n+        } else if (selection == 3) {\n+            current = 2;\n+            cm.sendNext(\"Here are the rules for Match Cards, so listen carefully. As the name suggests, Match Cards is simply finding a matching pair among the number of cards laid on the table. When all the matching pairs are found, then the person with more matching pairs will win the game. Just like Omok, you'll need #bA set of Match Cards#k to open the game room.\");\n+\n+        } else if (selection == 4) {\n+            current = 3;\n+            cm.sendNext(\"You want to play #bOmok#k, huh? To play it, you'll need the Omok Set. Only the ones with that item can open the room for a game of Omok, and you can play this game almost anywhere except for a few places at the market place.\");\n+\n+        } else if (selection == 5) {\n+            current = 4;\n+            if (cm.haveItem(4030012, 15)) {\n+                cm.gainItem(4030012, -15);\n+                cm.gainItem(4080100, 1);\n+            } else {\n+                cm.sendNext(\"You want #bA set of Match Cards#k? Hmm...to make A set of Match Cards, you'll need some #bMonster Cards#k. Monster Card can be obtained by taking out the monsters all around the island. Collect 15 Monster Cards and you can make a set of A set of Match Cards.\"); //Lmfao a set of A set xD\n+                cm.dispose();\n             }\n         }\n+\n+         \n+    } else if (status == 3) {\n+        if (current == 1) {\n+            cm.sendNextPrev(\"Every game of Omok will cost you #r100 mesos#k. Even if you don't have an #bOmok Set#k, you can enter the room and play. However, if you don't possess 100 mesos, then you won't be allowed to enter in the room at all. The person opening the game room also needs 100 mesos to open the room (or else there's no game). If you run out of mesos during the game, then you're automatically kicked out of the room!\");\n+        } else if (current == 2) {\n+            cm.sendNextPrev(\"Every game of Match Cards will cost you #r100 mesos#k. Even if you don't have #bA set of Match Cards#k, you can enter the room and play. However, if you don't possess 100 mesos, then you won't be allowed to enter in the room at all. The person opening the game room also needs 100 mesos to open the room (or else there's no game). If you run out of mesos during the game, then you're automatically kicked out of the room!\");\n+\n+        } else if (current == 3) {\n+            for (var i = 0; i < omok.length; i++)\n+                text += \"\\r\\n#L\"+i+\"##b#t\"+omok[i]+\"##k#l\";\n+            cm.sendSimple(text);\n+        }\n+\n+    } else if (status == 4) {\n+        if (current == 1 || current == 2) {\n+            cm.sendNextPrev(\"Enter the room, and when you're ready to play, click on #bReady#k.\\r\\nOnce the visitor clicks on #bReady#k, the room owner can press #bStart#k to begin the game. If an unwanted visitor walks in, and you don't want to play with that person, the room owner has the right to kick the visitor out of the room. There will be a square box with x written on the right of that person. Click on that for a cold goodbye, okay?\"); //Oh yeah, because people WALK in Omok Rooms.\n+        }\n+        else if (current == 3) {\n+            if (cm.haveItem(omok1piece[selection], 99) && cm.haveItem(omok2piece[selection], 99) && cm.haveItem(4030009, 1)) {\n+                cm.gainItem(omok1piece[selection], -omokamount);\n+                cm.gainItem(omok2piece[selection], -omokamount);\n+                cm.gainItem(4030009, -1);\n+                cm.gainItem(omok[selection], 1);\n+                cm.dispose();\n+            } else {\n+                cm.sendNext(\"#bYou want to make #t\" + omok[selection] + \"##k? Hmm...get me the materials, and I can do just that. Listen carefully, the materials you need will be: #r\" + omokamount + \" #t\" + omok1piece[selection] + \"#, \" + omokamount + \" #t\" + omok2piece[selection] + \"#, 1 #t\" + 4030009 + \"##k. The monsters will probrably drop those every once in a while...\");\n+                cm.dispose();\n+            }\n+        }\n+\n+    } else if (status == 5) {\n+        if (current == 1) {\n+            cm.sendNextPrev(\"When the first fame starts, #bthe room owner goes first#k. Beward that you'll be given a time limit, and you may lose your turn if you don't make your move on time. Normally, 3 x 3 is not allowed, but if there comes a point that it's absolutely necessary to put your piece there or face ending the game, then you can put it there. 3 x 3 is allowed as the last line of defense! Oh, and it won't count if it's #r6 or 7 straight#k. Only 5!\");\n+        } else if (current == 2)  {\n+            cm.sendNextPrev(\"Oh, and unlike Omok, when you create the game room for Match Cards, you'll need to set your game on the number of cards you'll use for the game. There are 3 modes avaliable, 3x4, 4x5, and 5x6, which will require 12, 20, and 30 cards respectively. Remember that you won't beable to change it up once the room is open, so if you really wish to change it up, you may have to close the room and open another one.\");\n+        }\n+\n+    } else if (status == 6) {\n+        if (current == 1) {\n+            cm.sendNextPrev(\"If you know your back is against the wall, you can request a #bRedo#k. If the opponent accepts your request, then you and your opponent's last moves will cancel out. If you ever feel the need to go to the bathroom, or take an extended break, you can request a #btie#k. The game will end in a tie if the opponent accepts the request. Tip: this may be a good way to keep your friendships in tact.\");\n+        } else if (current == 2) {\n+            cm.sendNextPrev(\"When the first game starts, #bthe room owner goes first.#k Beware that you'll be given a time limit, and you may lose your turn if you don't make your move on time. When you find a matching pair on your turn, you'll get to keep your turn, as long as you keep finding a pair of matching cards. Use your memorizing skills to make a streak.\");\n+        }\n         \n-        cm.dispose();\n+    } else if (status == 7) {\n+        if (current == 1) {\n+            cm.sendPrev(\"When the next game starts, the loser will go first. Also, no one is allowed to leave in the middle of a game. If you do, you may need to request either a #bforfeit or tie#k. (Of course, if you request a forfeit, you'll lose the game.) And if you click on 'Leave' in the middle of the game and call to leave after the game, you'll leave the room right after the game is over. This will be a much more useful way to leave.\");\n+        } else if (current == 2) {\n+            cm.sendNextPrev(\"If you and your opponent have the same number of matched pairs, then whoever had a longer streak of matched pairs will win. If you ever feel the need to go to the bathroom, or take an extended break, you can request a #btie#k. The game will end in a tie if the opponent accepts the request. Tip: this may be a good way to keep your friendships in tact.\");\n+        }\n+    } else if (status == 8) {\n+        if (current == 2) {\n+            cm.sendPrev(\"When the next game starts, the loser will go first. Also, no one is allowed to leave in the middle of a game. If you do, you may need to request either a #bforfeit or tie#k. (Of course, if you request a forfeit, you'll lose the game.) And if you click on 'Leave' in the middle of the game and call to leave after the game, you'll leave the room right after the game is over. This will be a much more useful way to leave.\");\n+        }\n     }\n-}\n\\ No newline at end of file\n+}  \n\\ No newline at end of file"}, {"sha": "0835260695988037159ac2f83ee5d38795b4dc64", "filename": "scripts/npc/world0/1032009.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/768d9d02646b6b7ac12940524aedcd59257d192f/scripts/npc/world0/1032009.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/768d9d02646b6b7ac12940524aedcd59257d192f/scripts/npc/world0/1032009.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/world0/1032009.js?ref=768d9d02646b6b7ac12940524aedcd59257d192f", "patch": "@@ -31,7 +31,7 @@ function start() {\n \n function action(mode, type, selection) {\n     if (status == 0) {\n-        cm.sendYesNo(\"Do you wish to go to leave the boat?\");\n+        cm.sendYesNo(\"Do you wish to leave the boat?\");\n         status++;\n     } else {\n         if (mode < 1) {"}, {"sha": "3d21152254bbb99e3e2ffdc71749f6dac7605e56", "filename": "scripts/npc/world0/2012002.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/768d9d02646b6b7ac12940524aedcd59257d192f/scripts/npc/world0/2012002.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/768d9d02646b6b7ac12940524aedcd59257d192f/scripts/npc/world0/2012002.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/world0/2012002.js?ref=768d9d02646b6b7ac12940524aedcd59257d192f", "patch": "@@ -29,7 +29,7 @@\n var status = 0;\n \n function start() {\n-    cm.sendYesNo(\"Do you wish to go to leave the boat?\");\n+    cm.sendYesNo(\"Do you wish to leave the boat?\");\n }\n \n function action(mode, type, selection) {"}, {"sha": "d7436a9988d7220827316f68e5d9838121b01bd6", "filename": "scripts/npc/world0/2012024.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/768d9d02646b6b7ac12940524aedcd59257d192f/scripts/npc/world0/2012024.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/768d9d02646b6b7ac12940524aedcd59257d192f/scripts/npc/world0/2012024.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/world0/2012024.js?ref=768d9d02646b6b7ac12940524aedcd59257d192f", "patch": "@@ -28,7 +28,7 @@ function start() {\n \n function action(mode, type, selection) {\n     if (status == 0) {\n-        cm.sendYesNo(\"Do you wish to go to leave the genie?\");\n+        cm.sendYesNo(\"Do you wish to leave the genie?\");\n         status++;\n     } else {\n         if (mode < 1) {"}, {"sha": "6bda2ff57e58fef4d2b757c9b5658d3058450fc8", "filename": "scripts/npc/world0/2023000.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/768d9d02646b6b7ac12940524aedcd59257d192f/scripts/npc/world0/2023000.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/768d9d02646b6b7ac12940524aedcd59257d192f/scripts/npc/world0/2023000.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/world0/2023000.js?ref=768d9d02646b6b7ac12940524aedcd59257d192f", "patch": "@@ -21,7 +21,7 @@\n \n var toMap = new Array(211040200, 220050300, 220000000,240030000);\n var inMap = new Array(211000000, 220000000, 221000000, 240000000);\n-var cost = new Array(10000, 25000, 25000,55000);\n+var cost = new Array(10000, 25000, 25000, 65000);\n var location;\n var status = 0;\n "}, {"sha": "4f2ef64c7e8281877ed4fdbac49632d05b78c482", "filename": "scripts/npc/world0/2102001.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/768d9d02646b6b7ac12940524aedcd59257d192f/scripts/npc/world0/2102001.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/768d9d02646b6b7ac12940524aedcd59257d192f/scripts/npc/world0/2102001.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/world0/2102001.js?ref=768d9d02646b6b7ac12940524aedcd59257d192f", "patch": "@@ -28,7 +28,7 @@ function start() {\n \n function action(mode, type, selection) {\n     if (status == 0) {\n-        cm.sendYesNo(\"Do you wish to go to leave the genie?\");\n+        cm.sendYesNo(\"Do you wish to leave the genie?\");\n         status++;\n     } else {\n         if (mode < 1) {"}, {"sha": "b1623bf2fa7bcdfada85617b08e1976a8798ba7b", "filename": "scripts/npc/world0/2120003.js", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/768d9d02646b6b7ac12940524aedcd59257d192f/scripts/npc/world0/2120003.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/768d9d02646b6b7ac12940524aedcd59257d192f/scripts/npc/world0/2120003.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/world0/2120003.js?ref=768d9d02646b6b7ac12940524aedcd59257d192f", "patch": "@@ -0,0 +1,10 @@\n+/* @Author SharpAceX\n+        Name: Maid\n+        Map(s): Foyer.\n+        Info: Maid\n+*/\n+\n+function start() {\n+\tcm.sendOk(\"Hello and welcome, dear guest. The Master has prepared some wonderful games for you to enjoy tonight.\");\n+\tcm.dispose();\n+}\n\\ No newline at end of file"}, {"sha": "6c105bc472d8040a0f3259a96a0a6b6b348ed392", "filename": "scripts/npc/world0/2133000.js", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/768d9d02646b6b7ac12940524aedcd59257d192f/scripts/npc/world0/2133000.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/768d9d02646b6b7ac12940524aedcd59257d192f/scripts/npc/world0/2133000.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/world0/2133000.js?ref=768d9d02646b6b7ac12940524aedcd59257d192f", "patch": "@@ -50,7 +50,7 @@ function action(mode, type, selection) {\n \t\twhile (it.hasNext()) {\n \t\t\tvar cPlayer = it.next();\n \t\t\tvar ccPlayer = cm.getPlayer().getMap().getCharacterById(cPlayer.getId());\n-\t\t\tif (ccPlayer == null || ccPlayer.getLevel() < 70 || ccPlayer.getLevel() > 255) {\n+\t\t\tif (ccPlayer == null || ccPlayer.getLevel() < 44 || ccPlayer.getLevel() > 55) {\n \t\t\t\tnext = false;\n \t\t\t\tbreak;\n \t\t\t}\n@@ -61,10 +61,10 @@ function action(mode, type, selection) {\n \t\t\tif (em == null) {\n \t\t\t\tcm.sendOk(\"Please try again later.\");\n \t\t\t} else {\n-\t\t\t\tem.startInstance(cm.getPlayer().getParty(), cm.getPlayer().getMap(), 120);\n+\t\t\t\tem.startInstance(cm.getPlayer().getParty(), cm.getPlayer().getMap(), 1);    //common level only\n \t\t\t}\n \t\t} else {\n-\t\t\tcm.sendOk(\"All 2+ members of your party must be here and above level 70.\");\n+\t\t\tcm.sendOk(\"All 2+ members of your party must be here and between level 44 and 55.\");\n \t\t}\n \t    }\n \t}"}, {"sha": "e0944456e07f2169ca6502b2c8a89279dd2361e4", "filename": "scripts/npc/world0/9201143.js", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/768d9d02646b6b7ac12940524aedcd59257d192f/scripts/npc/world0/9201143.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/768d9d02646b6b7ac12940524aedcd59257d192f/scripts/npc/world0/9201143.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/world0/9201143.js?ref=768d9d02646b6b7ac12940524aedcd59257d192f", "patch": "@@ -0,0 +1,11 @@\n+/* @Author SharpAceX \n+        Name: Steward \n+        Map(s): Foyer \n+        Info: Steward \n+        NPC ID: 9201143.js \n+*/ \n+\n+function start() { \n+\tcm.sendNext(\"At your service, my friend.\"); \n+\tcm.dispose(); \n+}\n\\ No newline at end of file"}, {"sha": "c315f6292ff0fbf7554a5df7f389ae698989d1d1", "filename": "sql/db_drops.sql", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/768d9d02646b6b7ac12940524aedcd59257d192f/sql/db_drops.sql", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/768d9d02646b6b7ac12940524aedcd59257d192f/sql/db_drops.sql", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/sql/db_drops.sql?ref=768d9d02646b6b7ac12940524aedcd59257d192f", "patch": "@@ -18842,6 +18842,7 @@\n   UPDATE drop_data SET questid=7777 WHERE itemid=4001358;\t#id 7777 for ALL \"quest items\" with no v83 quest.\n   UPDATE drop_data SET questid=7777 WHERE itemid=4001359;\n   UPDATE drop_data SET questid=7777 WHERE itemid=4001342;\n+  UPDATE drop_data SET questid=7777 WHERE itemid=4031906;\n   UPDATE drop_data SET chance=0 WHERE itemid=2050099;\n   UPDATE drop_data SET chance=40000 WHERE itemid=4031991;\n   UPDATE drop_data SET questid=6191 WHERE itemid=4031477;"}, {"sha": "26fbcdf826adbac214bd5eeeefc7c400b1cdbc38", "filename": "src/scripting/event/EventManager.java", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/768d9d02646b6b7ac12940524aedcd59257d192f/src/scripting/event/EventManager.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/768d9d02646b6b7ac12940524aedcd59257d192f/src/scripting/event/EventManager.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/scripting/event/EventManager.java?ref=768d9d02646b6b7ac12940524aedcd59257d192f", "patch": "@@ -174,6 +174,16 @@ public void startInstance(MapleParty party, MapleMap map) {\n             Logger.getLogger(EventManager.class.getName()).log(Level.SEVERE, null, ex);\n         }\n     }\n+    \n+    //PQ method: starts a PQ with a difficulty level, requires function setup(difficulty, leaderid) instead of setup()\n+    public void startInstance(MapleParty party, MapleMap map, int difficulty) {\n+        try {\n+            EventInstanceManager eim = (EventInstanceManager) (iv.invokeFunction(\"setup\", difficulty, party.getLeader().getId()));\n+            eim.registerParty(party, map);\n+        } catch (ScriptException | NoSuchMethodException ex) {\n+            Logger.getLogger(EventManager.class.getName()).log(Level.SEVERE, null, ex);\n+        }\n+    }\n \n     //non-PQ method for starting instance\n     public void startInstance(EventInstanceManager eim, String leader) {"}, {"sha": "210a65ea5f9d3deb64ca7eec118dea443646e32b", "filename": "src/server/life/ChangeableStats.java", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/768d9d02646b6b7ac12940524aedcd59257d192f/src/server/life/ChangeableStats.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/768d9d02646b6b7ac12940524aedcd59257d192f/src/server/life/ChangeableStats.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/life/ChangeableStats.java?ref=768d9d02646b6b7ac12940524aedcd59257d192f", "patch": "@@ -1,6 +1,6 @@\n /*\n This file is part of the OdinMS Maple Story Server\n-Copyright (C) 2008 ~ 2010 Patrick Huy <patrick.huy@frz.cc> \n+Copyright (C) 2008 ~ 2010 Patrick Huy <patrick.huy@frz.cc>\n Matthias Butz <matze@odinms.de>\n Jan Christian Meyer <vimes@odinms.de>\n This program is free software: you can redistribute it and/or modify\n@@ -47,4 +47,8 @@ public ChangeableStats(MapleMonsterStats stats, int newLevel, boolean pqMob) { /\n         mdef = Math.min(stats.isBoss() ? 30 : 20, (int) Math.round(stats.getMDDamage() * mod));\n         level = newLevel;\n     }\n-}\n\\ No newline at end of file\n+\n+    public ChangeableStats(MapleMonsterStats stats, float statModifier, boolean pqMob) {\n+        this(stats, (int)(statModifier * stats.getLevel()), pqMob);\n+    }\n+}"}, {"sha": "fe8611d8c606973ffa3f1a2ad54205c80bd4e58c", "filename": "src/server/life/MapleMonster.java", "status": "modified", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/768d9d02646b6b7ac12940524aedcd59257d192f/src/server/life/MapleMonster.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/768d9d02646b6b7ac12940524aedcd59257d192f/src/server/life/MapleMonster.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/life/MapleMonster.java?ref=768d9d02646b6b7ac12940524aedcd59257d192f", "patch": "@@ -981,4 +981,24 @@ public final void changeLevel(final int newLevel, boolean pqMob) {\n         this.hp = ostats.getHp();\n         this.mp = ostats.getMp();\n     }\n+    \n+    private float getDifficultyRate(final int difficulty) {\n+        switch(difficulty) {\n+            case 6: return(7.7f);\n+            case 5: return(5.6f);\n+            case 4: return(3.2f);\n+            case 3: return(2.1f);\n+            case 2: return(1.4f);\n+        }\n+        \n+        return(1.0f);\n+    }\n+    \n+    public final void changeLevelByDifficulty(final int difficulty, boolean pqMob) {\n+        changeLevel((int)(this.getLevel() * getDifficultyRate(difficulty)), pqMob);\n+    }\n+    \n+    public final void changeDifficulty(final int difficulty, boolean pqMob) {\n+        changeLevelByDifficulty(difficulty, pqMob);\n+    }\n }"}, {"sha": "71872c0704c81c1f38f50e768eb901ff65fbe436", "filename": "src/server/life/SpawnPoint.java", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/768d9d02646b6b7ac12940524aedcd59257d192f/src/server/life/SpawnPoint.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/768d9d02646b6b7ac12940524aedcd59257d192f/src/server/life/SpawnPoint.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/life/SpawnPoint.java?ref=768d9d02646b6b7ac12940524aedcd59257d192f", "patch": "@@ -49,7 +49,7 @@ public int getSpawned() {\n         return spawnedMonsters.intValue();\n     }\n     \n-    public void denySpawn(boolean val) {\n+    public void setDenySpawn(boolean val) {\n         spawnedMonsters.set((val == false) ? 0 : 1);\n     }\n "}, {"sha": "16f7420a0274808b5ae30414c835d24d0ee0941c", "filename": "src/server/maps/MapleMap.java", "status": "modified", "additions": 36, "deletions": 14, "changes": 50, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/768d9d02646b6b7ac12940524aedcd59257d192f/src/server/maps/MapleMap.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/768d9d02646b6b7ac12940524aedcd59257d192f/src/server/maps/MapleMap.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/maps/MapleMap.java?ref=768d9d02646b6b7ac12940524aedcd59257d192f", "patch": "@@ -711,7 +711,7 @@ public void killAllMonstersNotFriendly() {\n \n     public void killAllMonsters() {\n         for (SpawnPoint spawnPoint : monsterSpawn) {\n-            spawnPoint.denySpawn(true);\n+            spawnPoint.setDenySpawn(true);\n         }\n         \n         for (MapleMapObject monstermo : getMapObjectsInRange(new Point(0, 0), Double.POSITIVE_INFINITY, Arrays.asList(MapleMapObjectType.MONSTER))) {\n@@ -2051,10 +2051,14 @@ public void run() {\n         }\n     }\n     \n-    public void instanceMapFirstSpawn() {\n+    public void instanceMapFirstSpawn(int difficulty, boolean isPq) {\n         for(SpawnPoint spawnPoint: allMonsterSpawn) {\n-            if(spawnPoint.getMobTime() == -1)   //just those allowed to be spawned only once\n-                spawnMonster(spawnPoint.getMonster());\n+            if(spawnPoint.getMobTime() == -1) {   //just those allowed to be spawned only once\n+                MapleMonster monst = spawnPoint.getMonster();\n+                monst.changeLevelByDifficulty(difficulty, isPq);\n+                \n+                spawnMonster(monst);\n+            }\n         }\n     }\n \n@@ -2076,7 +2080,7 @@ public void instanceMapRespawn() {\n     \n     public void restoreMapSpawnPoints() {\n         for (SpawnPoint spawnPoint : monsterSpawn) {\n-            spawnPoint.denySpawn(false);\n+            spawnPoint.setDenySpawn(false);\n         }\n     }\n \n@@ -2146,6 +2150,10 @@ public void setBoat(boolean hasBoat) {\n     public void setDocked(boolean isDocked) {\n         this.docked = isDocked;\n     }\n+    \n+    public boolean getDocked() {\n+        return this.docked;\n+    }\n \n     public void broadcastGMMessage(MapleCharacter source, final byte[] packet, boolean repeatToSource) {\n         broadcastGMMessage(repeatToSource ? null : source, packet, Double.POSITIVE_INFINITY, source.getPosition());\n@@ -2444,25 +2452,39 @@ public void clearMapObjects() {\n     }\n     \n     public void resetMapObjects() {\n+        resetMapObjects(1, false);\n+    }\n+    \n+    public final void resetFully() {\n+        resetMapObjects();\n+    }\n+    \n+    public void resetPQ(int difficulty) {\n+        resetMapObjects(difficulty, true);\n+    }\n+    \n+    public void resetPQ() {\n+        resetMapObjects(1, true);\n+    }\n+    \n+    public void resetMapObjects(int difficulty, boolean isPq) {\n         clearMapObjects();\n         \n         restoreMapSpawnPoints();\n-        instanceMapFirstSpawn();\n+        instanceMapFirstSpawn(difficulty, isPq);\n     }\n     \n     public void broadcastShip(final boolean state) {\n         broadcastMessage(MaplePacketCreator.boatPacket(state));\n+        this.setDocked(state);\n     }\n     \n-    public boolean isDojoMap() {\n-        return mapid >= 925020000 && mapid < 925040000;\n+    public void broadcastEnemyShip(final boolean state) {\n+        broadcastMessage(MaplePacketCreator.crogBoatPacket(state));\n+        this.setDocked(state);\n     }\n     \n-    public final void resetFully() {\n-        resetFully(true);\n-    }\n-\n-    public final void resetFully(final boolean respawn) {\n-        resetMapObjects();\n+    public boolean isDojoMap() {\n+        return mapid >= 925020000 && mapid < 925040000;\n     }\n }"}, {"sha": "53f12a7d9d849b017245ed1445393b22ac3b7048", "filename": "src/tools/MaplePacketCreator.java", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/768d9d02646b6b7ac12940524aedcd59257d192f/src/tools/MaplePacketCreator.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/768d9d02646b6b7ac12940524aedcd59257d192f/src/tools/MaplePacketCreator.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/tools/MaplePacketCreator.java?ref=768d9d02646b6b7ac12940524aedcd59257d192f", "patch": "@@ -4440,8 +4440,15 @@ public static void addPetInfo(final MaplePacketLittleEndianWriter mplew, MaplePe\n                 return mplew.getPacket();\n         }\n \n+        public static byte[] crogBoatPacket(boolean type) {\n+                final MaplePacketLittleEndianWriter mplew = new MaplePacketLittleEndianWriter();\n+                mplew.writeShort(SendOpcode.CONTI_MOVE.getValue());\n+                mplew.write(10);\n+                mplew.write(type ? 4 : 5);\n+                return mplew.getPacket();\n+        }\n \n-        public static byte[] boatPacket(boolean type) {//don't think this is correct..\n+        public static byte[] boatPacket(boolean type) {\n                 final MaplePacketLittleEndianWriter mplew = new MaplePacketLittleEndianWriter();\n                 mplew.writeShort(SendOpcode.CONTI_STATE.getValue());\n                 mplew.write(type ? 1 : 2);"}, {"sha": "3ce6f76dfa1ebb3be51c19f42eb1013fba66aaa8", "filename": "wz/Item.wz/Etc/0403.img.xml", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/768d9d02646b6b7ac12940524aedcd59257d192f/wz/Item.wz/Etc/0403.img.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/768d9d02646b6b7ac12940524aedcd59257d192f/wz/Item.wz/Etc/0403.img.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/wz/Item.wz/Etc/0403.img.xml?ref=768d9d02646b6b7ac12940524aedcd59257d192f", "patch": "@@ -1,4 +1,4 @@\n-\ufeff<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n+<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n <imgdir name=\"0403.img\">\n   <imgdir name=\"04030000\">\n     <imgdir name=\"info\">\n@@ -9798,9 +9798,7 @@\n         <int name=\"z\" value=\"0\"/>\n       </canvas>\n       <int name=\"price\" value=\"1\"/>\n-      <int name=\"tradeBlock\" value=\"1\"/>\n       <int name=\"slotMax\" value=\"1\"/>\n-      <int name=\"notSale\" value=\"1\"/>\n     </imgdir>\n   </imgdir>\n   <imgdir name=\"04031907\">"}]}]},
