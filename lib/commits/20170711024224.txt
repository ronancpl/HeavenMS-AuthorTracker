{"fetchDate": "2019-12-19", "content": [{"sha": "57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59", "node_id": "MDY6Q29tbWl0NDUwODIwMjM6NTcxMjVhNzBjZTQwZWNiZjJmNGM3YzhlYmFmOWEwNmRiZWQwNWQ1OQ==", "commit": {"author": {"name": "ronancpl", "email": "rcpl2010@gmail.com", "date": "2017-07-11T02:42:24Z"}, "committer": {"name": "ronancpl", "email": "rcpl2010@gmail.com", "date": "2017-07-11T02:42:24Z"}, "message": "Masteria NPCs & Quests\n\nAdded more NPCs for the Phantom Woods and Crimsonwood areas. Enabled\nmore quests on that area.", "tree": {"sha": "4a32d8117a2f0c846b9a18d6849fa73681f4321b", "url": "https://api.github.com/repos/ronancpl/HeavenMS/git/trees/4a32d8117a2f0c846b9a18d6849fa73681f4321b"}, "url": "https://api.github.com/repos/ronancpl/HeavenMS/git/commits/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59", "html_url": "https://github.com/ronancpl/HeavenMS/commit/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59", "comments_url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/comments", "author": {"login": "ronancpl", "id": 9257761, "node_id": "MDQ6VXNlcjkyNTc3NjE=", "avatar_url": "https://avatars2.githubusercontent.com/u/9257761?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ronancpl", "html_url": "https://github.com/ronancpl", "followers_url": "https://api.github.com/users/ronancpl/followers", "following_url": "https://api.github.com/users/ronancpl/following{/other_user}", "gists_url": "https://api.github.com/users/ronancpl/gists{/gist_id}", "starred_url": "https://api.github.com/users/ronancpl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ronancpl/subscriptions", "organizations_url": "https://api.github.com/users/ronancpl/orgs", "repos_url": "https://api.github.com/users/ronancpl/repos", "events_url": "https://api.github.com/users/ronancpl/events{/privacy}", "received_events_url": "https://api.github.com/users/ronancpl/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ronancpl", "id": 9257761, "node_id": "MDQ6VXNlcjkyNTc3NjE=", "avatar_url": "https://avatars2.githubusercontent.com/u/9257761?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ronancpl", "html_url": "https://github.com/ronancpl", "followers_url": "https://api.github.com/users/ronancpl/followers", "following_url": "https://api.github.com/users/ronancpl/following{/other_user}", "gists_url": "https://api.github.com/users/ronancpl/gists{/gist_id}", "starred_url": "https://api.github.com/users/ronancpl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ronancpl/subscriptions", "organizations_url": "https://api.github.com/users/ronancpl/orgs", "repos_url": "https://api.github.com/users/ronancpl/repos", "events_url": "https://api.github.com/users/ronancpl/events{/privacy}", "received_events_url": "https://api.github.com/users/ronancpl/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b7c0bb6c07eef1545f2f3d71abd3b83bbcbcc638", "url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/b7c0bb6c07eef1545f2f3d71abd3b83bbcbcc638", "html_url": "https://github.com/ronancpl/HeavenMS/commit/b7c0bb6c07eef1545f2f3d71abd3b83bbcbcc638"}], "stats": {"total": 856, "additions": 776, "deletions": 80}, "files": [{"sha": "47998a9aee070d93ccd3a7c34891a8258982d044", "filename": "build/built-jar.properties", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/build/built-jar.properties", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/build/built-jar.properties", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/built-jar.properties?ref=57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59", "patch": "@@ -1,4 +1,4 @@\n-#Sun, 09 Jul 2017 19:55:31 -0300\n+#Mon, 10 Jul 2017 22:33:23 -0300\n \n \n C\\:\\\\Nexon\\\\MapleSolaxia\\\\MapleSolaxiaV2="}, {"sha": "0971384f3e4d8121d0eb4638e449a4cffb3b9e74", "filename": "build/classes/net/server/channel/handlers/ClickGuideHandler.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/build/classes/net/server/channel/handlers/ClickGuideHandler.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/build/classes/net/server/channel/handlers/ClickGuideHandler.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/net/server/channel/handlers/ClickGuideHandler.class?ref=57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59"}, {"sha": "7bb6f0aecfa1278e3925897b53520fd937ae7c20", "filename": "build/classes/net/server/channel/handlers/NPCTalkHandler.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/build/classes/net/server/channel/handlers/NPCTalkHandler.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/build/classes/net/server/channel/handlers/NPCTalkHandler.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/net/server/channel/handlers/NPCTalkHandler.class?ref=57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59"}, {"sha": "4df8abccd21bb6a4fddd8718e6f712d01e6c1828", "filename": "build/classes/net/server/channel/handlers/RemoteGachaponHandler.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/build/classes/net/server/channel/handlers/RemoteGachaponHandler.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/build/classes/net/server/channel/handlers/RemoteGachaponHandler.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/net/server/channel/handlers/RemoteGachaponHandler.class?ref=57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59"}, {"sha": "71b020eb3b20921bbcc0e067d26d93cfbfbc2b5d", "filename": "build/classes/net/server/channel/handlers/UseCashItemHandler.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/build/classes/net/server/channel/handlers/UseCashItemHandler.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/build/classes/net/server/channel/handlers/UseCashItemHandler.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/net/server/channel/handlers/UseCashItemHandler.class?ref=57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59"}, {"sha": "7e8adfe92773f715a196a11493ba0f96864bd4ef", "filename": "build/classes/scripting/AbstractPlayerInteraction.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/build/classes/scripting/AbstractPlayerInteraction.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/build/classes/scripting/AbstractPlayerInteraction.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/scripting/AbstractPlayerInteraction.class?ref=57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59"}, {"sha": "28ef56950d245b078534ccc0b1dfca1910a9c607", "filename": "build/classes/scripting/npc/NPCConversationManager.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/build/classes/scripting/npc/NPCConversationManager.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/build/classes/scripting/npc/NPCConversationManager.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/scripting/npc/NPCConversationManager.class?ref=57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59"}, {"sha": "4e9ef5d79906b81d9f65fc847293b2d4d116b2c9", "filename": "build/classes/scripting/npc/NPCScriptManager.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/build/classes/scripting/npc/NPCScriptManager.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/build/classes/scripting/npc/NPCScriptManager.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/scripting/npc/NPCScriptManager.class?ref=57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59"}, {"sha": "75767c6b2f0c02a330c6a1bbe36f07ceb17b0936", "filename": "dist/MapleSolaxia.jar", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/dist/MapleSolaxia.jar", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/dist/MapleSolaxia.jar", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/dist/MapleSolaxia.jar?ref=57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59"}, {"sha": "f9ddf5fd2cfaacd3161a07aadcc951ae7f7c1e2a", "filename": "mychanges_ptbr.txt", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/mychanges_ptbr.txt", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/mychanges_ptbr.txt", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/mychanges_ptbr.txt?ref=57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59", "patch": "@@ -355,4 +355,11 @@ Elaborada funcionalidade que permite salvar o \"tempo at\n \n 03 Julho 2017,\n Corrigido cliente n\ufffdo mostrando dano tomado pelo player se ele est\ufffd com GM escondido para os outros GMs.\n-Corrigido cliente n\ufffdo mostrando dano dado pelo summon para outros players.\n\\ No newline at end of file\n+Corrigido cliente n\ufffdo mostrando dano dado pelo summon para outros players.\n+\n+07 - 09 Julho 2017,\n+Corrigido parcialmente Mystic Doors.\n+\n+10 Julho 2017,\n+Abertas novas quests para a regi\ufffdo de Masteria (Phantom Woods / Crimsonwood mountain).\n+Codificados novos NPCs para a regi\ufffdo de Masteria.\n\\ No newline at end of file"}, {"sha": "5af0ed1acce427edd53bc66d6b2b5f2bf3272c28", "filename": "nbproject/private/private.xml", "status": "modified", "additions": 1, "deletions": 13, "changes": 14, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/nbproject/private/private.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/nbproject/private/private.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/nbproject/private/private.xml?ref=57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59", "patch": "@@ -2,18 +2,6 @@\n <project-private xmlns=\"http://www.netbeans.org/ns/project-private/1\">\n     <editor-bookmarks xmlns=\"http://www.netbeans.org/ns/editor-bookmarks/2\" lastBookmarkId=\"1\"/>\n     <open-files xmlns=\"http://www.netbeans.org/ns/projectui-open-files/2\">\n-        <group>\n-            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/net/SendOpcode.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/server/maps/MapleDoor.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/server/MapleStatEffect.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/net/server/world/MaplePartyCharacter.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/net/server/channel/handlers/DoorHandler.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/client/MapleBuffStat.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/server/maps/MapleMap.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/server/maps/MapleDoorObject.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/client/MapleCharacter.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/client/MapleClient.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/tools/MaplePacketCreator.java</file>\n-        </group>\n+        <group/>\n     </open-files>\n </project-private>"}, {"sha": "1b92265645532026cb45444351419c54336ed356", "filename": "scripts/npc/9000017.js", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/scripts/npc/9000017.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/scripts/npc/9000017.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/9000017.js?ref=57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59", "patch": "@@ -32,11 +32,11 @@ function action(mode, type, selection) {\n     }\n \n     if (status == 0) {\n-        var selStr = \"Hey traveler! Come, come closer... We offer a #bhuge opportunity of business#k to you. If you want to know what it is, keep listening...\"\n+        var selStr = \"Hey traveler! Come, come closer... We offer a #bhuge opportunity of business#k to you. If you want to know what it is, keep listening...\";\n         cm.sendNext(selStr);\n     }\n     else if (status == 1) {\n-\tvar selStr = \"We've got here the knowledge to synthetize the mighty #b#t2049100##k! Of course, making one is not an easy task... But worry not! Just gather some material to me and a fee of #b1,200,000 mesos#k for our services to #bobtain it#k. You still want to do it?\"\n+\tvar selStr = \"We've got here the knowledge to synthetize the mighty #b#t2049100##k! Of course, making one is not an easy task... But worry not! Just gather some material to me and a fee of #b1,200,000 mesos#k for our services to #bobtain it#k. You still want to do it?\";\n         cm.sendYesNo(selStr);\n     }\n "}, {"sha": "9e78d57d8d460a2eb5d0296fccafbc48175a4804", "filename": "scripts/npc/9201096.js", "status": "added", "additions": 125, "deletions": 0, "changes": 125, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/scripts/npc/9201096.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/scripts/npc/9201096.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/9201096.js?ref=57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59", "patch": "@@ -0,0 +1,125 @@\n+/* Jack\n+        Refining NPC: \n+\t* ITEMMAKE\n+        * \n+        * By RonanLana\n+*/\n+\n+var status = 0;\n+var selectedType = -1;\n+var selectedItem = -1;\n+var item;\n+var mats;\n+var matQty;\n+var cost;\n+var qty;\n+var equip;\n+var last_use; //last item is a use item\n+\n+function start() {\n+    cm.getPlayer().setCS(true);\n+    status = -1;\n+    action(1, 0, 0);\n+}\n+\n+function action(mode, type, selection) {\n+    if (mode == 1)\n+        status++;\n+    else {\n+        cm.sendOk(\"Very well, see you around.\");\n+        cm.dispose();\n+        return;\n+    }\n+\n+    if (status == 0) {\n+        var selStr = \"Hey, are you aware about the expeditions running right now at the Crimsonwood Keep? So, there is a great opportunity for one to improve themselves, one can rack up experience and loot pretty fast there.\";\n+        cm.sendNext(selStr);\n+    }\n+    else if (status == 1) {\n+\tvar selStr = \"Said so, methinks making use of some strong utility potions can potentially create some differential on the front, and by this I mean to start crafting #b#t2022284##k's to help on the efforts. So, getting right down to business, I'm currently pursuing #rplenty#k of those items: #r#t4032010##k, #r#t4032011##k, #r#t4032012##k, and some funds to support the cause. Would you want to get some of these boosters?\";\n+        cm.sendYesNo(selStr);\n+    }\n+\n+    else if (status == 2) {\n+        //selectedItem = selection;\n+        selectedItem = 0;\n+\n+        var itemSet = new Array(2022284, 7777777);\n+        var matSet = new Array(new Array(4032010, 4032011, 4032012));\n+        var matQtySet = new Array(new Array(60, 60, 45));\n+        var costSet = new Array(75000, 7777777);\n+        item = itemSet[selectedItem];\n+        mats = matSet[selectedItem];\n+        matQty = matQtySet[selectedItem];\n+        cost = costSet[selectedItem];\n+                \n+        var prompt = \"Ok, I'll be crafting some #t\" + item + \"#. In that case, how many of those do you want me to make?\";\n+        cm.sendGetNumber(prompt,1,1,100)\n+    }\n+        \n+    else if (status == 3) {\n+        qty = selection;\n+        last_use = false;\n+                \n+        var prompt = \"So, you want me to make \";\n+        if (qty == 1)\n+            prompt += \"a #t\" + item + \"#?\";\n+        else\n+            prompt += qty + \" #t\" + item + \"#?\";\n+                        \n+        prompt += \" In that case, I'm going to need specific items from you in order to make it. And make sure you have room in your inventory!#b\";\n+                \n+        if (mats instanceof Array){\n+            for (var i = 0; i < mats.length; i++) {\n+                prompt += \"\\r\\n#i\"+mats[i]+\"# \" + matQty[i] * qty + \" #t\" + mats[i] + \"#\";\n+            }\n+        } else {\n+            prompt += \"\\r\\n#i\"+mats+\"# \" + matQty * qty + \" #t\" + mats + \"#\";\n+        }\n+                \n+        if (cost > 0) {\n+            prompt += \"\\r\\n#i4031138# \" + cost * qty + \" meso\";\n+        }\n+        cm.sendYesNo(prompt);\n+    }\n+    \n+    else if (status == 4) {\n+        var complete = true;\n+                \n+        if (cm.getMeso() < cost * qty) {\n+            cm.sendOk(\"Well, I DID say I would be needing some funds to craft it, wasn't it?\");\n+        }\n+        else if(!cm.canHold(item, qty)) {\n+            cm.sendOk(\"You didn't check if you got a slot to spare on your inventory before crafting, right?\");\n+        }\n+        else {\n+            if (mats instanceof Array) {\n+                for (var i = 0; complete && i < mats.length; i++) {\n+                    if (matQty[i] * qty == 1) {\n+                        complete = cm.haveItem(mats[i]);\n+                    } else {\n+                        complete = cm.haveItem(mats[i], matQty[i] * qty);\n+                    }\n+                }\n+            } else {\n+                complete = cm.haveItem(mats, matQty * qty);\n+            }\n+            \n+            if (!complete)\n+                cm.sendOk(\"There are not enough resources on your inventory. Please check it again.\");\n+            else {\n+                if (mats instanceof Array) {\n+                    for (var i = 0; i < mats.length; i++){\n+                        cm.gainItem(mats[i], -matQty[i] * qty);\n+                    }\n+                } else {\n+                    cm.gainItem(mats, -matQty * qty);\n+                }\n+                cm.gainMeso(-cost * qty);\n+                cm.gainItem(item, qty);\n+                cm.sendOk(\"There it is! Thanks for your cooperation.\");\n+            }\n+        }\n+        cm.dispose();\n+    }\n+}\n\\ No newline at end of file"}, {"sha": "40d205aef9ca4a9d0a1c8d5d5ac0c4a0eb9f55e6", "filename": "scripts/npc/9201097.js", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/scripts/npc/9201097.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/scripts/npc/9201097.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/9201097.js?ref=57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59", "patch": "@@ -71,14 +71,20 @@ function start() {\n }\n \n function action(mode, type, selection) {\n-    if (mode == 0) {\n-\tcm.sendOk(\"Hmmm...it shouldn't be a bad deal for you. Come see me at the right time and you may get a much better item to be offered. Anyway, let me know when you have a change of mind.\");\n+    if (mode <= 0) {\n+\tcm.sendOk(\"Hmmm...it shouldn't be a bad deal for you. Come see me at the right time and you may get a much better item to be offered. Anyway, let me know if you have a change of mind.\");\n \tcm.dispose();\n \treturn;\n     }\n     \n     status++;\n     if (status == 0) { // first interaction with NPC\n+        if(cm.getQuestStatus(8225) != 2) {\n+            cm.sendNext(\"Hey, I'm not a bandit, ok?\");\n+            cm.dispose();\n+            return;\n+        }\n+        \n \tcm.sendNext(\"Hey, got a little bit of time? Well, my job is to collect items here and sell them elsewhere, but these days the monsters have become much more hostile so it have been difficult to get good items... What do you think? Do you want to do some business with me?\");\n     } else if (status == 1) {\n \tcm.sendYesNo(\"The deal is simple. You get me something I need, I get you something you need. The problem is, I deal with a whole bunch of people, so the items I have to offer may change every time you see me. What do you think? Still want to do it?\");"}, {"sha": "10dc2caa63e740c2d6ebbc6cacc723a0d379709b", "filename": "scripts/npc/9201098.js", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/scripts/npc/9201098.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/scripts/npc/9201098.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/9201098.js?ref=57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59", "patch": "@@ -0,0 +1,21 @@\n+/**\n+ *9201098 - Lukan\n+ *@author Ronan\n+ */\n+ \n+function start() {\n+    if(cm.getQuestStatus(8223) == 2) {\n+        if(cm.haveItem(3992041)) cm.sendOk(\"We, defenders of Yore, are currenly meeting at the Inner Sactum inside the Keep, about to start an offensive against the Twisted Masters and their army. Join us there anytime.\");\n+        else {\n+            if(!cm.canHold(3992041)) cm.sendOk(\"Please make a slot on your SETUP ready for the key I have to give to you. It is fundamental to enter the Inner Sanctum, inside the Keep.\");\n+            else {\n+                cm.sendOk(\"So you did lost your key, right? Very well, I will craft you another one, but please don't lose it again. It is fundamental to enter the Inner Sanctum, inside the Keep.\");\n+                cm.gainItem(3992041, 1);\n+            }\n+        }\n+    } else {\n+        cm.sendOk(\"O, brave adventurer. The Stormcasters house, from which I belong, guards the surrounding area of Yore, this landscape, from the forces of the Twisted Masters' guard that daily threathens the citizens. Please help us on the defense of Yore.\");\n+    }\n+    \n+    cm.dispose();\n+}"}, {"sha": "fda4cd9f8c66d3b4eb970f7a09933998dcfe22c7", "filename": "scripts/npc/9201099.js", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/scripts/npc/9201099.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/scripts/npc/9201099.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/9201099.js?ref=57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59", "patch": "@@ -0,0 +1,14 @@\n+/**\n+ *9201098 - Mo\n+ *@author Ronan\n+ */\n+ \n+function start() {\n+    if(cm.getQuestStatus(8224) == 2) {\n+        cm.openShopNPC(9201099);\n+    } else {\n+        cm.sendOk(\"Hm, at who do you think you are looking at?\");\n+    }\n+    \n+    cm.dispose();\n+}"}, {"sha": "38356190c82cc016fc959af97e67f77f54c35c0f", "filename": "scripts/npc/9201100.js", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/scripts/npc/9201100.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/scripts/npc/9201100.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/9201100.js?ref=57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59", "patch": "@@ -0,0 +1,14 @@\n+/**\n+ *9201100 - Taggrin\n+ *@author Ronan\n+ */\n+ \n+function start() {\n+    if(cm.getQuestStatus(8224) == 2) {\n+        cm.sendOk(\"Well met, fellow clan member. If you need anything we can be of help, try talking to one of our members.\");\n+    } else {\n+        cm.sendOk(\"Hello there, stranger. We are the renowned Raven Claw clan of mercenaries, and I'm their leader.\");\n+    }\n+    \n+    cm.dispose();\n+}"}, {"sha": "90ef86e3241e751a6c41302a1e661d2793bc646a", "filename": "scripts/npc/9201103.js", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/scripts/npc/9201103.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/scripts/npc/9201103.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/9201103.js?ref=57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59", "patch": "@@ -0,0 +1,10 @@\n+/**\n+ *9201103 - Sage\n+ *@author Ronan\n+ */\n+ \n+function start() {\n+    if(cm.getLevel() >= 100) cm.sendOk(\"Expeditions are frequently being held inside the Crimsonwood Keep by adventurers like you, where many people from many parties cooperate together, solving puzzles therein and taking down strong enemies, being able to get many prizes in the process. To find more info about this, go ahead inside the keep at the top-right room there.\");\n+    else cm.sendOk(\"Inside the Keep, expeditions can be formed to attempt the Crimsonwood Keep PQ, which requires maplers from level 100 or more. It seems you are not suitable for attempting it yet, train some more if you want to attempt it.\");\n+    cm.dispose();\n+}"}, {"sha": "e63d17a6e267ad0ff378dc7b22cabb2256b7cca1", "filename": "scripts/npc/9201104.js", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/scripts/npc/9201104.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/scripts/npc/9201104.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/9201104.js?ref=57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59", "patch": "@@ -0,0 +1,12 @@\n+/**\n+ *9201104 - Sage\n+ *@author Ronan\n+ */\n+ \n+function start() {\n+    if(cm.getMapId() == 610020000) cm.sendOk(\"O, brave adventurer. Just by reaching this spot, you are truly distinct among the masses, congratulations. However, #rpay heed#k: on the path ahead, which leads to the mighty fortress of #bCrimsonwood Keep#k, #rdeadly Menhirs#k are deployed as traps for those unaware of the dangers ahead. #rOne hit from it is enough to take you down#k, so beware. If you aim to reach the Keep, follow the trail ahead carefully.\");\n+    else if(cm.getMapId() == 610020003) cm.sendOk(\"You seem worthy now to receive a hint for what lies ahead. Once inside the main room of the Keep, make sure you remember the layout of the statue you see there. That's it.\");\n+    else if(cm.getMapId() == 610020004) cm.sendOk(\"You seem worthy now to receive a hint for what lies ahead. Devices known as Sigils are activated by detection when some skills of certain jobs are activated nearby, make sure your team is made whole for when the time comes. That's it.\");\n+    else cm.sendOk(\"So far your progress is splendid, good job. However, to make it to the Keep, you must face and accomplish this ordeal, carry on.\");\n+    cm.dispose();\n+}"}, {"sha": "ce9a4172eff1f675931502263342a1fdbd83636e", "filename": "scripts/npc/9201105.js", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/scripts/npc/9201105.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/scripts/npc/9201105.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/9201105.js?ref=57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59", "patch": "@@ -0,0 +1,10 @@\n+/**\n+ *9201105 - Sage\n+ *@author Ronan\n+ */\n+ \n+function start() {\n+    if(cm.getMapId() == 610020005) cm.sendOk(\"The Crimsonwood Keep lies right ahead, a great feat has been made by you this day, salute to thee. Pass through these woods to enter the gates of the Keep.\");\n+    else cm.sendOk(\"So far your progress is splendid, good job. However, to make it to the Keep, you must face and accomplish this ordeal, carry on.\");\n+    cm.dispose();\n+}"}, {"sha": "53ff9734afd3bcfb84576832c4e121d72794a177", "filename": "scripts/npc/9201110.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/scripts/npc/9201110.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/scripts/npc/9201110.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/9201110.js?ref=57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59", "patch": "@@ -7,7 +7,7 @@ function start() {\n         \t\tcm.sendOk(\"As every Thief knows, the best attack is the one you never see coming. So, to best illustrate this, you'll be in a chamber with platforms and ledges that you can only get to with Haste, as well as All-Seeing Eyes that your dagger or claw must close--permanently. After all the All-Seeing Eyes have been eliminated, get ti the Thief Statue and lay claim to the Primal Claw! Good luck!\");\n \t\t\tbreak;\n \t\tcase 610030000:\n-\t\t\tcm.sendOk(\"Once known as the 'Prince of Shadows', Grandmaster Ryo possessed supreme speed and power with short-ranged daggers and longer chain-like Claw. A part-time member of the Bosshunters, he was reowned for unparalleled ability to blend into the very nigth itself. His legend grew during a battle with Crimson Balrog, where he moved so swiftly that Balrog's attacks only caught air. Ryo also performed occasional 'retrievals' for those less fortunate than himself.\");\n+\t\t\tcm.sendOk(\"Once known as the 'Prince of Shadows', Grandmaster Ryo possessed supreme speed and power with short-ranged daggers and longer chain-like Claw. A part-time member of the Bosshunters, he was reowned for unparalleled ability to blend into the very night itself. His legend grew during a battle with Crimson Balrog, where he moved so swiftly that Balrog's attacks only caught air. Ryo also performed occasional 'retrievals' for those less fortunate than himself.\");\n \t\t\tbreak;\n \t\tcase 610030530:\n \t\t\tif (cm.isAllReactorState(6108004, 1)) {"}, {"sha": "33ce5ee0faa08307e388b20f4c40efb5a62ff3f7", "filename": "scripts/npc/9201113.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/scripts/npc/9201113.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/scripts/npc/9201113.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/9201113.js?ref=57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59", "patch": "@@ -56,7 +56,7 @@ function action(mode, type, selection) {\n                 cm.sendOk(\"You do not meet the criteria to take attempt Crimsonwood Keep Party Quest!\");\n                 cm.dispose();\n             } else if (expedition == null) { //Start an expedition\n-                cm.sendSimple(\"#e#b<Party Quest: Crimsonwood Keep>\\r\\n#k#n\" + em.getProperty(\"party\") + \"\\r\\n\\r\\nWould you like to assemble a team to attempt a #rCrimsonwood Keep Party Quest#k?\\r\\n#b#L1#Lets get this going!#l\\r\\n\\#L2#No, I think I'll wait a bit...#l\");\n+                cm.sendSimple(\"#e#b<Party Quest: Crimsonwood Keep>\\r\\n#k#n\" + em.getProperty(\"party\") + \"\\r\\n\\r\\nWould you like to assemble a team to attempt the #rCrimsonwood Keep Party Quest#k?\\r\\n#b#L1#Lets get this going!#l\\r\\n\\#L2#No, I think I'll wait a bit...#l\");\n                 status = 1;\n             } else if (expedition.isLeader(player)) { //If you're the leader, manage the exped\n                 cm.sendSimple(list);"}, {"sha": "c0fa15e75e617befe622bb2de7f7d901e703b6bb", "filename": "scripts/npc/9201114.js", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/scripts/npc/9201114.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/scripts/npc/9201114.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/9201114.js?ref=57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59", "patch": "@@ -19,12 +19,14 @@\n     You should have received a copy of the GNU Affero General Public License\n     along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n-/* Door that warps you inside the CWKPQ start map. Needs GMS-like checks.\n+/* Door that warps you inside the CWKPQ start map.\n  * \n- * @Author Alan (SharpAceX)\n+ * @Author Ronan\n  */\n  \n function start() {\n-    cm.warp(610030020);\n+    if(cm.haveItem(3992041, 1)) cm.warp(610030020);\n+    else cm.getPlayer().dropMessage(5, \"The giant gate of iron will not budge no matter what, however there is a key-shaped socket visible.\");\n+    \n     cm.dispose();\n }\n\\ No newline at end of file"}, {"sha": "33f63377ae22ae700318a181e9508b4324b3e3ad", "filename": "scripts/quest/8219.js", "status": "added", "additions": 61, "deletions": 0, "changes": 61, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/scripts/quest/8219.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/scripts/quest/8219.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/quest/8219.js?ref=57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59", "patch": "@@ -0,0 +1,61 @@\n+/* ===========================================================\n+\t\t\tRonan Lana\n+\tNPC Name: \t\tLukan\n+\tDescription: \tQuest - Storming the Castle\n+=============================================================\n+Version 1.0 - Script Done.(10/7/2017)\n+=============================================================\n+*/\n+\n+var status = -1;\n+\n+function start(mode, type, selection) {\n+    status++;\n+    if (mode != 1) {\n+            if(type == 1 && mode == 0)\n+                    status -= 2;\n+            else{\n+                    qm.sendOk(\"Okay, then. See you around.\");\n+                    qm.dispose();\n+                    return;\n+            }\n+    }\n+    if (status == 0)\n+            qm.sendAcceptDecline(\"The time is now, kid. We have all the preparations complete to further research for why all these oddities have been happening lately. I also must introduce you to my brother, Jack. \");\n+    if (status == 1){\n+            qm.sendOk(\"He is currently wandering around the Crimsonwood Mountain, past the sinister Phantom Forest, in the track to the Crimsonwood Keep. Your next destination is there, may your journey be a safe one.\");\n+            qm.forceStartQuest();\n+            qm.dispose();\n+    }\n+}\n+\n+function end(mode, type, selection) {\n+    status++;\n+\tif (mode != 1) {\n+\t    if(type == 1 && mode == 0)\n+\t\t    status -= 2;\n+\t\telse{\n+\t\t\tqm.sendOk(\"Okay, then. See you around.\");\n+\t\t\tqm.dispose();\n+\t\t\treturn;\n+\t\t}\n+\t}\n+\tif (status == 0)\n+\t\tqm.sendNext(\"Who are you? Oh, you came here by my brother John's stead? Great.\");\n+            \n+        else if (status == 1){\n+\t\tqm.sendOk(\"It seems you helped the folks at the city at some errands, don't you? I shall appraise you nicely. Take a look on this: this is a map of the Phantom Forest, which I made myself after enough exploration. Take possession of that, and you #bwill be granted passage#k by paths other times undiscoverable. Remember well to #rnever lose it#k, you won't be having that again!\\r\\n\\r\\n#fUI/UIWindow.img/QuestIcon/4/0# \\r\\n#i3992040# #t3992040#\\r\\n\\r\\n#fUI/UIWindow.img/QuestIcon/8/0# 175000 EXP\");\n+\t}\n+\telse if (status == 2){\n+\t\tif(qm.canHold(3992040, 1)) {\n+                    qm.gainItem(3992040, 1);\n+                    qm.gainExp(175000 * qm.getPlayer().getExpRate());\n+                    qm.forceCompleteQuest();\n+                }\n+\t\telse {\n+                    qm.sendOk(\"Hey, you don't have a slot in your SETUP inventory for what I have to give to you. Solve that minor issue of yours then talk to me.\");\n+                }\n+                \n+                qm.dispose();\n+\t}\n+}"}, {"sha": "84481e2964c69a7f36860377637e0cc363e3b9af", "filename": "scripts/quest/8223.js", "status": "added", "additions": 30, "deletions": 0, "changes": 30, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/scripts/quest/8223.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/scripts/quest/8223.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/quest/8223.js?ref=57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59", "patch": "@@ -0,0 +1,30 @@\n+/* ===========================================================\n+\t\t\tRonan Lana\n+\tNPC Name: \t\tLukan\n+\tDescription: \tQuest - Storming the Castle\n+=============================================================\n+Version 1.0 - Script Done.(10/7/2017)\n+=============================================================\n+*/\n+\n+var status = -1;\n+\n+function start(mode, type, selection) {\n+    status++;\n+\tif (mode != 1) {\n+\t    if(type == 1 && mode == 0)\n+\t\t    status -= 2;\n+\t\telse{\n+\t\t\tqm.sendOk(\"Okay, then. See you around.\");\n+\t\t\tqm.dispose();\n+\t\t\treturn;\n+\t\t}\n+\t}\n+\tif (status == 0)\n+\t\tqm.sendAcceptDecline(\"Oh, Jack sent you here? Good timing, I'm planning alongside Jack and others to storm the Keep and retake it from the Twisted Masters what is ours by right. You seem ready to fight alongside us, right?\");\n+\tif (status == 1){\n+\t\tqm.sendOk(\"Great! Your mission now is to rack down some numbers of their army and weaken their defenses by all effects. Defeat 75 of each: Windraider, Firebrand and Nightshadow, then return to me to report.\");\n+\t\tqm.forceStartQuest();\n+\t\tqm.dispose();\n+\t}\n+}"}, {"sha": "04a3c52d3935fcb8569f07a14470aa6260a9974f", "filename": "scripts/quest/8224.js", "status": "added", "additions": 30, "deletions": 0, "changes": 30, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/scripts/quest/8224.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/scripts/quest/8224.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/quest/8224.js?ref=57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59", "patch": "@@ -0,0 +1,30 @@\n+/* ===========================================================\n+\t\t\tRonan Lana\n+\tNPC Name: \t\tTaggrin\n+\tDescription: \tQuest - The Fallen Woods\n+=============================================================\n+Version 1.0 - Script Done.(10/7/2017)\n+=============================================================\n+*/\n+\n+var status = -1;\n+\n+function start(mode, type, selection) {\n+    status++;\n+    if (mode != 1) {\n+        if(type == 1 && mode == 0)\n+                status -= 2;\n+            else{\n+                    qm.sendOk(\"Okay, then. See you around.\");\n+                    qm.dispose();\n+                    return;\n+            }\n+    }\n+    if (status == 0)\n+            qm.sendAcceptDecline(\"Hey traveler, come here! I am Taggrin, leader of the Raven Ninja Clan. We are mercenaries currently under the payload of the New Leaf City county. Our job here is to hunt down those creatures that have been lurking around here these days. Are you interested to make a little errand for us? Of course, the pay off will be advantageous for both parties.\");\n+    else if (status == 1){\n+            qm.sendOk(\"Ok. I need you to hunt down #bthose fake trees#k in the forest, and collect 50 of their drops as proof that you made your part on this.\");\n+            qm.forceStartQuest();\n+            qm.dispose();\n+    }\n+}"}, {"sha": "8bb382d08d7f809ed206e652a9b8ca357b6a7d08", "filename": "scripts/quest/8225.js", "status": "added", "additions": 30, "deletions": 0, "changes": 30, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/scripts/quest/8225.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/scripts/quest/8225.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/quest/8225.js?ref=57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59", "patch": "@@ -0,0 +1,30 @@\n+/* ===========================================================\n+\t\t\tRonan Lana\n+\tNPC Name: \t\tTaggrin\n+\tDescription: \tQuest - The Right Path\n+=============================================================\n+Version 1.0 - Script Done.(10/7/2017)\n+=============================================================\n+*/\n+\n+var status = -1;\n+\n+function start(mode, type, selection) {\n+    status++;\n+\tif (mode != 1) {\n+\t    if(type == 1 && mode == 0)\n+\t\t    status -= 2;\n+\t\telse{\n+\t\t\tqm.sendOk(\"Okay, then. See you around.\");\n+\t\t\tqm.dispose();\n+\t\t\treturn;\n+\t\t}\n+\t}\n+\tif (status == 0)\n+\t\tqm.sendAcceptDecline(\"Hey, partner. Now that you make part of the Raven Claws team, I have a task for you. Are you up now?\");\n+\telse if (status == 1){\n+\t\tqm.sendOk(\"Very well. To prove your valor among our ranks, you must first pass on a little challenge: you have to be able to move extraordinaly well around here, known of all secrets these woods holds. Trace a #bmap of the Phantom Forest#k, then come talk to me. I shall then evaluate if you're worth to be with us.\");\n+\t\tqm.forceStartQuest();\n+\t\tqm.dispose();\n+\t}\n+}"}, {"sha": "7f84f351b9ad5838bd4878acd17576f1a32f5389", "filename": "scripts/quest/8226.js", "status": "added", "additions": 30, "deletions": 0, "changes": 30, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/scripts/quest/8226.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/scripts/quest/8226.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/quest/8226.js?ref=57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59", "patch": "@@ -0,0 +1,30 @@\n+/* ===========================================================\n+\t\t\tRonan Lana\n+\tNPC Name: \t\tTaggrin\n+\tDescription: \tQuest - The Right Path\n+=============================================================\n+Version 1.0 - Script Done.(10/7/2017)\n+=============================================================\n+*/\n+\n+var status = -1;\n+\n+function start(mode, type, selection) {\n+    status++;\n+\tif (mode != 1) {\n+\t    if(type == 1 && mode == 0)\n+\t\t    status -= 2;\n+\t\telse{\n+\t\t\tqm.sendOk(\"Okay, then. See you around.\");\n+\t\t\tqm.dispose();\n+\t\t\treturn;\n+\t\t}\n+\t}\n+\tif (status == 0)\n+\t\tqm.sendAcceptDecline(\"Now that you are part of our team, listen to what I have to say. We, Raven Clan of Ninjas, are hired to take care of many issues, and to do so each one works on different sectors of the continent, solving problems for our employers. I'm about to talk about your mission, are you ready?\");\n+\telse if (status == 1){\n+\t\tqm.sendOk(\"Your next mission is: defeat the Elderwraiths that roam this forest. These are a tough bunch though, so stay alert. I need you to bring me 100 #t4032010# as proof of your duty.\");\n+\t\tqm.forceStartQuest();\n+\t\tqm.dispose();\n+\t}\n+}"}, {"sha": "4781e2d1695c927228febaa337c5a0af61ad73a9", "filename": "scripts/quest/8227.js", "status": "added", "additions": 59, "deletions": 0, "changes": 59, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/scripts/quest/8227.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/scripts/quest/8227.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/quest/8227.js?ref=57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59", "patch": "@@ -0,0 +1,59 @@\n+/* ===========================================================\n+\t\t\tRonan Lana\n+\tNPC Name: \t\tJack, John\n+\tDescription: \tQuest - Lost in Translation\n+=============================================================\n+Version 1.0 - Script Done.(10/7/2017)\n+=============================================================\n+*/\n+\n+var status = -1;\n+\n+function start(mode, type, selection) {\n+    status++;\n+    if (mode != 1) {\n+        if(type == 1 && mode == 0)\n+                status -= 2;\n+        else {\n+            qm.sendOk(\"Come on, the city really needs you cooperating on this one!\");\n+            qm.dispose();\n+            return;\n+        }\n+    }\n+    if (status == 0)\n+            qm.sendAcceptDecline(\"Hey buddy! Nice timing. There is this communique I've been able to swipe from the officials at the Keep, however it's information is encrypted. I have no use for this as it is like this. So, will you transport this to John and see if he can decode this?\");\n+    else if (status == 1){\n+        if(qm.canHold(4032032, 1)) {\n+            qm.gainItem(4032032, 1);\n+            qm.sendOk(\"Very well, I'm counting on you on this one.\");\n+            qm.forceStartQuest();\n+        } else {\n+            qm.sendOk(\"Hey. There's no slot on your ETC.\");\n+        }\n+\n+        qm.dispose();\n+    }\n+}\n+\n+function end(mode, type, selection) {\n+    status++;\n+    if (mode != 1) {\n+        if(type == 1 && mode == 0)\n+                status -= 2;\n+        else {\n+            qm.dispose();\n+            return;\n+        }\n+    }\n+    if (status == 0){\n+        if(qm.haveItem(4032032, 1)) {\n+            qm.gainItem(4032032, -1);\n+            qm.sendOk(\"Oh you brought a letter from the Keep?! Neat! Let me check if I can decode that right now.\");\n+            qm.forceCompleteQuest();\n+        } else {\n+            qm.sendOk(\"You don't brought the coded letter Jack said? Come on, kid, we need that to decipher our enemies' next step!\");\n+        }\n+\n+        qm.dispose();\n+    }\n+}"}, {"sha": "b1352e8cd8c5b9fa806f9e156e4865b341e127f3", "filename": "scripts/quest/8228.js", "status": "added", "additions": 64, "deletions": 0, "changes": 64, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/scripts/quest/8228.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/scripts/quest/8228.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/quest/8228.js?ref=57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59", "patch": "@@ -0,0 +1,64 @@\n+/* ===========================================================\n+\t\t\tRonan Lana\n+\tNPC Name: \t\tJohn, Elpam\n+\tDescription: \tQuest - Lost in Translation\n+=============================================================\n+Version 1.0 - Script Done.(10/7/2017)\n+=============================================================\n+*/\n+\n+var status = -1;\n+\n+function start(mode, type, selection) {\n+    status++;\n+\tif (mode != 1) {\n+\t    if(type == 1 && mode == 0)\n+\t\t    status -= 2;\n+            else {\n+                qm.sendOk(\"Come on, the city really needs you cooperating on this one!\");\n+                qm.dispose();\n+                return;\n+            }\n+\t}\n+\tif (status == 0)\n+\t\tqm.sendAcceptDecline(\"Hm, that's no good. I can't seem to make these Hyper Glyphs work, dang it. ... Ah, yea, the outsider! He may know the language this paper is written on. Let Elpam try to read this, maybe he knows something.\");\n+\telse if (status == 1){\n+            if(qm.canHold(4032032, 1)) {\n+                qm.gainItem(4032032, 1);\n+                qm.sendOk(\"Very well, I'm counting on you on this one.\");\n+                qm.forceStartQuest();\n+            } else {\n+                qm.sendOk(\"Hey. There's no slot on your ETC.\");\n+            }\n+\n+            qm.dispose();\n+\t}\n+}\n+\n+function end(mode, type, selection) {\n+    status++;\n+    if (mode != 1) {\n+        if(type == 1 && mode == 0)\n+                status -= 2;\n+        else {\n+            qm.dispose();\n+            return;\n+        }\n+    }\n+    if (status == 0){\n+        if(!qm.canHold(4032018, 1)) {\n+            qm.sendOk(\"I'm afraid you don't have a slot available on your ETC inventory.\");\n+        }\n+        else if(qm.haveItem(4032032, 1)) {\n+            qm.gainItem(4032032, -1);\n+            qm.gainItem(4032018, 1);\n+\n+            qm.sendOk(\"Hello, native of this world. So you have a message that needs translation? My people back in Versal is known for mastering many foreign languages, this one may very well be some we know. Please stand by... Here, the translated transcript.\");\n+            qm.forceCompleteQuest();\n+        } else {\n+            qm.sendOk(\"I'm afraid you don't have the letter you claimed to have with you.\");\n+        }\n+\n+        qm.dispose();\n+    }\n+}"}, {"sha": "3573a7f1366c21da836cf365e8bac273d584dcf7", "filename": "scripts/quest/8229.js", "status": "added", "additions": 63, "deletions": 0, "changes": 63, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/scripts/quest/8229.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/scripts/quest/8229.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/quest/8229.js?ref=57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59", "patch": "@@ -0,0 +1,63 @@\n+/* ===========================================================\n+\t\t\tRonan Lana\n+\tNPC Name: \t\tJohn, Jack\n+\tDescription: \tQuest - Lost in Translation\n+=============================================================\n+Version 1.0 - Script Done.(10/7/2017)\n+=============================================================\n+*/\n+\n+var status = -1;\n+\n+function start(mode, type, selection) {\n+    status++;\n+\tif (mode != 1) {\n+\t    if(type == 1 && mode == 0)\n+\t\t    status -= 2;\n+            else {\n+                qm.sendOk(\"Come on, the city really needs you cooperating on this one!\");\n+                qm.dispose();\n+                return;\n+            }\n+\t}\n+\tif (status == 0)\n+\t\tqm.sendAcceptDecline(\"I knew we could rely on the outsider on this matter! Now that we have the letter translated by him, head it to Jack, he knows what to do.\");\n+\telse if (status == 1){\n+            if(qm.haveItem(4032018, 1)) {\n+                qm.forceStartQuest();\n+            } else if (qm.canHold(4032018, 1)) {\n+                qm.gainItem(4032018, 1);\n+                qm.forceStartQuest();\n+            } else {\n+                qm.sendOk(\"Hey. There's no slot on your ETC.\");\n+            }\n+\n+            qm.dispose();\n+\t}\n+}\n+\n+function end(mode, type, selection) {\n+    status++;\n+    if (mode != 1) {\n+        if(type == 1 && mode == 0)\n+                status -= 2;\n+        else {\n+            qm.dispose();\n+            return;\n+        }\n+    }\n+    if (status == 0){\n+        if(qm.haveItem(4032018, 1)) {\n+            qm.sendOk(\"Oh, you brought it. Nicely done, the countermeasure process will be much easier now.\\r\\n\\r\\n#fUI/UIWindow.img/QuestIcon/4/0# \\r\\n\\r\\n#fUI/UIWindow.img/QuestIcon/8/0# 50000 EXP\");\n+        } else {\n+            qm.sendOk(\"What's wrong? Why you didn't retrieved the translated message yet? Please bring me the letter's content for me to strategize a countermeasure ASAP.\");\n+            qm.dispose();\n+        }\n+    } else if (status == 1){\n+        qm.gainItem(4032018, -1);\n+        qm.gainExp(50000 * qm.getPlayer().getExpRate());\n+        qm.forceCompleteQuest();\n+        \n+        qm.dispose();\n+    }\n+}"}, {"sha": "0f3507e9a24473042987fdfd6f4ff7eb073ae7df", "filename": "scripts/quest/8230.js", "status": "added", "additions": 47, "deletions": 0, "changes": 47, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/scripts/quest/8230.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/scripts/quest/8230.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/quest/8230.js?ref=57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59", "patch": "@@ -0,0 +1,47 @@\n+/* ===========================================================\n+\t\t\tRonan Lana\n+\tNPC Name: \t\tJack\n+\tDescription: \tQuest - Stemming the Tide\n+=============================================================\n+Version 1.0 - Script Done.(10/7/2017)\n+=============================================================\n+*/\n+\n+var status = -1;\n+\n+function start(mode, type, selection) {\n+    status++;\n+    if (mode != 1) {\n+        if(type == 1 && mode == 0)\n+                status -= 2;\n+        else{\n+                qm.sendOk(\"Okay, then. See you around.\");\n+                qm.dispose();\n+                return;\n+        }\n+    }\n+    if (status == 0)\n+            qm.sendAcceptDecline(\"Hey, traveler! I need your help. A great threat is about to endanger the folks down there at the New Leaf City, the way I can see it right now. These creatures roaming around here suddenly... That can be no good. Care if you listen to what I have to say?\");\n+    else if (status == 1) {\n+            qm.sendOk(\"That's the thing: the Twisted Masters, great figures that currently holds seize of the Crimsonwood Keep, have planned a large-scale attack to the New Leaf City, that may be happening on the next few days. I can't just stay here observing while they prepare for this attack. However, I can't just leave this position, I must keep an eye on their moves at all costs. There's where you enter: go find Lukan, knight of the past Crimsonwood Keep, that is currently wandering around the woods, and receive from him further orders, he knows what to do.\");\n+            qm.forceStartQuest();\n+            qm.dispose();\n+    }\n+}\n+\n+function end(mode, type, selection) {\n+\tstatus++;\n+\n+\tif(status == 0) {\n+\t\tif(qm.haveItem(3992041)) {\n+\t\t\tqm.sendOk(\"Ah, you did accomplish the task I handed to you. Nicely done, now those guys are busy recovering from this offensive. Now, remember: #bthat key must be used to access#k the Inner Sanctum inside the Keep. Hold that with you at all times if you ever want to enter there.\");\n+\t\t\tqm.forceCompleteQuest();\n+                } else if(qm.getQuestStatus(8223) == 2) {\n+                        qm.sendOk(\"You completed the mission but lost the key? That's bad, you NEED this key to enter the inner rooms of the Keep. Check out there with Lukan what you should be doing next, we need you inside the Keep.\");\n+\t\t} else {\n+\t\t\tqm.sendOk(\"The folks back there on the city are counting on you on this one. Please hurry up.\");\n+\t\t}\n+\t\n+\t\tqm.dispose();\n+\t}\n+}\n\\ No newline at end of file"}, {"sha": "636c9da263a594d2e7b563c2e1399e3783678be9", "filename": "sql/db_database.sql", "status": "modified", "additions": 20, "deletions": 1, "changes": 21, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/sql/db_database.sql", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/sql/db_database.sql", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/sql/db_database.sql?ref=57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59", "patch": "@@ -20744,7 +20744,25 @@ INSERT INTO `shopitems` (`shopitemid`, `shopid`, `itemid`, `price`, `pitch`, `po\n (20043, 1338, 2002025, 1500, 0, 192),\n (20044, 1338, 2002024, 1500, 0, 196),\n (20045, 1338, 2002023, 3800, 0, 200),\n-(20046, 1338, 5041000, 1500000, 0, 200);\n+(20046, 1338, 5041000, 1500000, 0, 200),\n+(20047, 9201099, 2030020, 400, 0, 1),\n+(20048, 9201099, 2022002, 1000, 0, 2),\n+(20049, 9201099, 2000018, 620, 0, 3),\n+(20050, 9201099, 2022003, 1100, 0, 4),\n+(20051, 9201099, 2070010, 2000, 0, 5),\n+(20052, 9201099, 2061004, 40, 0, 6),\n+(20053, 9201099, 2060004, 40, 0, 7),\n+(20054, 9201099, 2002017, 5000, 0, 8),\n+(20055, 9201099, 2022000, 1650, 0, 9),\n+(20056, 9201099, 2050003, 500, 0, 10),\n+(20057, 9201099, 2050002, 300, 0, 11),\n+(20058, 9201099, 2050001, 200, 0, 12),\n+(20059, 9201099, 2020015, 9690, 0, 13),\n+(20060, 9201099, 2020014, 8100, 0, 14),\n+(20061, 9201099, 2020013, 5000, 0, 15),\n+(20062, 9201099, 2020012, 4500, 0, 16),\n+(20063, 9201099, 2050000, 200, 0, 17),\n+(20064, 9201099, 2050004, 400, 0, 18);\n \n CREATE TABLE IF NOT EXISTS `shops` (\n   `shopid` int(10) unsigned NOT NULL AUTO_INCREMENT,\n@@ -20837,6 +20855,7 @@ INSERT INTO `shops` (`shopid`, `npcid`) VALUES\n (9201058, 9201058),\n (9201059, 9201059),\n (9201060, 9201060),\n+(9201099, 9201099),\n (9270019, 9270019),\n (9270020, 9270020),\n (9270021, 9270021),"}, {"sha": "0825872468562647ce1c37976c0167b82fec5eb0", "filename": "sql/db_drops.sql", "status": "modified", "additions": 15, "deletions": 5, "changes": 20, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/sql/db_drops.sql", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/sql/db_drops.sql", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/sql/db_drops.sql?ref=57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59", "patch": "@@ -11820,7 +11820,7 @@\n (9500334, 2040801, 1, 4, 0, 10000), \n (9500349, 2040801, 1, 4, 0, 10000), \n (9303011, 2040801, 1, 1, 0, 750), \n-(9400576, 4032007, 1, 1, 0, 10000), \n+(9400576, 4032007, 1, 1, 0, 200000), \n (9400576, 2002000, 1, 1, 0, 10000), \n (9400576, 4006000, 1, 1, 0, 7000), \n (9400576, 2043301, 1, 1, 0, 750), \n@@ -13869,7 +13869,7 @@\n (9500162, 1040107, 1, 1, 0, 700), \n (8140001, 1060095, 1, 1, 0, 700), \n (9500162, 1060095, 1, 1, 0, 700), \n-(9400581, 4032006, 1, 1, 0, 10000),\n+(9400581, 4032006, 1, 1, 0, 200000),\n (9400581, 2000006, 1, 1, 0, 40000), \n (9400581, 2000004, 1, 1, 0, 40000), \n (9400581, 2000005, 1, 1, 0, 40000), \n@@ -16168,7 +16168,7 @@\n (9400574, 1082158, 1, 1, 0, 700), \n (9400574, 1332052, 1, 1, 0, 700), \n (9400574, 1332027, 1, 1, 0, 700), \n-(9400579, 4032009, 1, 1, 0, 10000), \n+(9400579, 4032009, 1, 1, 0, 200000), \n (9400579, 4006001, 1, 1, 0, 7000), \n (9400579, 2041013, 1, 1, 0, 750), \n (9400579, 4020008, 1, 1, 0, 7000), \n@@ -18744,7 +18744,7 @@\n (3000004, 2381033, 1, 1, 0, 10000),\n (2230101, 4032399, 1, 1, 2251, 30000),\n (2230131, 4032399, 1, 1, 2251, 30000),\n-(9400578, 4032008, 1, 1, 0, 10000),\n+(9400578, 4032008, 1, 1, 0, 200000),\n (9400578, 2001000, 1, 1, 0, 800),\n (9400578, 1032032, 1, 1, 0, 1200),\n (9400578, 1032013, 1, 1, 0, 1200),\n@@ -19043,7 +19043,17 @@\n (9300024, 4001035, 1, 1, 0, 999999),\n (9300025, 4001036, 1, 1, 0, 999999),\n (9300027, 4001035, 1, 1, 0, 999999),\n-(9300033, 4001035, 1, 1, 0, 999999);\n+(9300033, 4001035, 1, 1, 0, 999999),\n+(9400585, 4032004, 1, 1, 0, 200000),\n+(9400585, 0, 310, 500, 0, 200000),\n+(9400586, 4032004, 1, 1, 0, 200000),\n+(9400586, 0, 310, 500, 0, 200000),\n+(9400587, 4000018, 1, 1, 0, 200000),\n+(9400587, 4032003, 1, 1, 0, 150000),\n+(9400587, 0, 210, 380, 0, 200000),\n+(9400588, 4000018, 1, 1, 0, 200000),\n+(9400588, 4032003, 1, 1, 0, 150000),\n+(9400588, 0, 210, 380, 0, 200000);\n \n # (dropperid, itemid, minqty, maxqty, questid, chance)\n "}, {"sha": "871493454881d3b1a0ce2899a4c51f8327f361f7", "filename": "src/net/server/channel/handlers/NPCTalkHandler.java", "status": "modified", "additions": 16, "deletions": 7, "changes": 23, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/src/net/server/channel/handlers/NPCTalkHandler.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/src/net/server/channel/handlers/NPCTalkHandler.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/channel/handlers/NPCTalkHandler.java?ref=57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59", "patch": "@@ -28,6 +28,7 @@\n import server.life.MapleNPC;\n import server.maps.MapleMapObject;\n import server.maps.PlayerNPCs;\n+import tools.FilePrinter;\n import tools.MaplePacketCreator;\n import tools.data.input.SeekableLittleEndianAccessor;\n \n@@ -38,8 +39,10 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n             return;\n         }\n         \n-        if(System.currentTimeMillis() - c.getPlayer().getNpcCooldown() < ServerConstants.BLOCK_NPC_RACE_CONDT)\n+        if(System.currentTimeMillis() - c.getPlayer().getNpcCooldown() < ServerConstants.BLOCK_NPC_RACE_CONDT) {\n+            c.announce(MaplePacketCreator.enableActions());\n             return;\n+        }\n         \n         int oid = slea.readInt();\n         MapleMapObject obj = c.getPlayer().getMap().getMapObject(oid);\n@@ -50,11 +53,6 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n             if (npc.getId() == 9010009) {   //is duey\n                 c.getPlayer().setNpcCooldown(System.currentTimeMillis());\n                 c.announce(MaplePacketCreator.sendDuey((byte) 8, DueyHandler.loadItems(c.getPlayer())));\n-            } else if (npc.hasShop()) {\n-                if (c.getPlayer().getShop() != null) {\n-                    return;\n-                }\n-                npc.sendShop(c);\n             } else {\n                 if (c.getCM() != null || c.getQM() != null) {\n                     c.announce(MaplePacketCreator.enableActions());\n@@ -64,7 +62,18 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n                     // Custom handling for gachapon scripts to reduce the amount of scripts needed.\n                     NPCScriptManager.getInstance().start(c, npc.getId(), \"gachapon\", null);\n                 } else {\n-                    NPCScriptManager.getInstance().start(c, npc.getId(), null);\n+                    boolean hasNpcScript = NPCScriptManager.getInstance().start(c, npc.getId(), null);\n+                    if (!hasNpcScript) {\n+                        if (!npc.hasShop()) {\n+                            FilePrinter.printError(FilePrinter.NPC_UNCODED, \"NPC \" + npc.getName() + \"(\" + npc.getId() + \") is not coded.\\r\\n\");\n+                            return;\n+                        } else if(c.getPlayer().getShop() != null) {\n+                            c.announce(MaplePacketCreator.enableActions());\n+                            return;\n+                        }\n+                        \n+                        npc.sendShop(c);\n+                    }\n                 }\n             }\n         } else if (obj instanceof PlayerNPCs) {"}, {"sha": "c3ff6a8460193998972c36c4d5b3334809f48bb8", "filename": "src/scripting/AbstractPlayerInteraction.java", "status": "modified", "additions": 9, "deletions": 5, "changes": 14, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/src/scripting/AbstractPlayerInteraction.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/src/scripting/AbstractPlayerInteraction.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/scripting/AbstractPlayerInteraction.java?ref=57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59", "patch": "@@ -233,13 +233,17 @@ public void updateQuest(int questid, int pid, String data) {\n \t\tc.getPlayer().updateQuest(status);\n \t}\n \n-\tpublic MapleQuestStatus.Status getQuestStatus(int id) {\n-\t\treturn c.getPlayer().getQuest(MapleQuest.getInstance(id)).getStatus();\n+\tpublic int getQuestStatus(int id) {\n+\t\treturn c.getPlayer().getQuest(MapleQuest.getInstance(id)).getStatus().getId();\n \t}\n-\n+        \n+        private MapleQuestStatus.Status getQuestStat(int id) {\n+                return c.getPlayer().getQuest(MapleQuest.getInstance(id)).getStatus();\n+        }\n+        \n \tpublic boolean isQuestCompleted(int quest) {\n \t\ttry {\n-\t\t\treturn getQuestStatus(quest) == MapleQuestStatus.Status.COMPLETED;\n+\t\t\treturn getQuestStat(quest) == MapleQuestStatus.Status.COMPLETED;\n \t\t} catch (NullPointerException e) {\n                         e.printStackTrace();\n \t\t\treturn false;\n@@ -252,7 +256,7 @@ public boolean isQuestActive(int quest) {\n         \n \tpublic boolean isQuestStarted(int quest) {\n \t\ttry {\n-\t\t\treturn getQuestStatus(quest) == MapleQuestStatus.Status.STARTED;\n+\t\t\treturn getQuestStat(quest) == MapleQuestStatus.Status.STARTED;\n \t\t} catch (NullPointerException e) {\n                         e.printStackTrace();\n \t\t\treturn false;"}, {"sha": "afdcff4d835e4f85ae3d6f8940b6bcf5fbd97479", "filename": "src/scripting/npc/NPCConversationManager.java", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/src/scripting/npc/NPCConversationManager.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/src/scripting/npc/NPCConversationManager.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/scripting/npc/NPCConversationManager.java?ref=57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59", "patch": "@@ -38,6 +38,7 @@\n import scripting.AbstractPlayerInteraction;\n import server.MapleItemInformationProvider;\n import server.MapleStatEffect;\n+import server.MapleShopFactory;\n import server.events.gm.MapleEvent;\n import server.gachapon.MapleGachapon;\n import server.gachapon.MapleGachapon.MapleGachaponItem;\n@@ -315,6 +316,10 @@ public MapleStatEffect getItemEffect(int itemId) {\n \tpublic void resetStats() {\n \t\tgetPlayer().resetStats();\n \t}\n+        \n+        public void openShopNPC(int id) {\n+            MapleShopFactory.getInstance().getShop(id).sendShop(c);\n+        }\n \n \tpublic void maxMastery() {\n \t\tfor (MapleData skill_ : MapleDataProviderFactory.getDataProvider(new File(System.getProperty(\"wzpath\") + \"/\" + \"String.wz\")).getData(\"Skill.img\").getChildren()) {"}, {"sha": "26476ca3df5b82a0b50969956c875952999a6daf", "filename": "src/scripting/npc/NPCScriptManager.java", "status": "modified", "additions": 10, "deletions": 7, "changes": 17, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/src/scripting/npc/NPCScriptManager.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/src/scripting/npc/NPCScriptManager.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/scripting/npc/NPCScriptManager.java?ref=57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59", "patch": "@@ -50,11 +50,11 @@ public synchronized static NPCScriptManager getInstance() {\n         return instance;\n     }\n \n-    public void start(MapleClient c, int npc, MapleCharacter chr) {\n-        start(c, npc, null, chr);\n+    public boolean start(MapleClient c, int npc, MapleCharacter chr) {\n+        return start(c, npc, null, chr);\n     }\n \n-    public void start(MapleClient c, int npc, String fileName, MapleCharacter chr) {\n+    public boolean start(MapleClient c, int npc, String fileName, MapleCharacter chr) {\n         try {\n             NPCConversationManager cm = new NPCConversationManager(c, npc, fileName);\n             if (cms.containsKey(c)) {\n@@ -69,12 +69,9 @@ public void start(MapleClient c, int npc, String fileName, MapleCharacter chr) {\n                 if (iv == null) {\n                     iv = getInvocable(\"npc/\" + npc + \".js\", c);\n                 }\n-                if (iv == null) {\n-                    FilePrinter.printError(FilePrinter.NPC_UNCODED, \"NPC \" + MapleLifeFactory.getNPC(npc).getName() + \"(\" + npc + \") is not coded.\\r\\n\");\n-                }\n                 if (iv == null || NPCScriptManager.getInstance() == null) {\n                     dispose(c);\n-                    return;\n+                    return false;\n                 }\n                 engine.put(\"cm\", cm);\n                 scripts.put(c, iv);\n@@ -91,12 +88,18 @@ public void start(MapleClient c, int npc, String fileName, MapleCharacter chr) {\n             } else {\n                 c.announce(MaplePacketCreator.enableActions());\n             }\n+            \n+            return true;\n         } catch (final UndeclaredThrowableException | ScriptException ute) {\n             FilePrinter.printError(FilePrinter.NPC + npc + \".txt\", ute);\n             dispose(c);\n+            \n+            return false;\n         } catch (final Exception e) {\n             FilePrinter.printError(FilePrinter.NPC + npc + \".txt\", e);\n             dispose(c);\n+            \n+            return false;\n         }\n     }\n "}, {"sha": "fdb579f3318e71a3e4a10f30fa8fe122f208a65e", "filename": "src/server/quest/MapleQuest.java", "status": "modified", "additions": 10, "deletions": 10, "changes": 20, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/src/server/quest/MapleQuest.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/src/server/quest/MapleQuest.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/quest/MapleQuest.java?ref=57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59", "patch": "@@ -135,34 +135,34 @@ private MapleQuest(int id) {\n         if (startActData != null) {\n             for (MapleData startAct : startActData.getChildren()) {\n                 MapleQuestActionType questActionType = MapleQuestActionType.getByWZName(startAct.getName());\n-\t\t\t\tMapleQuestAction act = this.getAction(questActionType, startAct);\n+                MapleQuestAction act = this.getAction(questActionType, startAct);\n \t\t\t\t\n-\t\t\t\tif(act == null)\n-\t\t\t\t\tcontinue;\n+                if(act == null)\n+                    continue;\n \t\t\t\t\n                 startActs.put(questActionType, act);\n             }\n         }\n         MapleData completeActData = actData.getChildByPath(\"1\");\n         if (completeActData != null) {\n             for (MapleData completeAct : completeActData.getChildren()) {\n-\t\t\t\tMapleQuestActionType questActionType = MapleQuestActionType.getByWZName(completeAct.getName());\n-\t\t\t\tMapleQuestAction act = this.getAction(questActionType, completeAct);\n-\t\t\t\t\n-\t\t\t\tif(act == null)\n-\t\t\t\t\tcontinue;\n+                MapleQuestActionType questActionType = MapleQuestActionType.getByWZName(completeAct.getName());\n+                MapleQuestAction act = this.getAction(questActionType, completeAct);\n+\n+                if(act == null)\n+                    continue;\n \t\t\t\t\n                 completeActs.put(questActionType, act);\n             }\n         }\n     }\n \t\n \tpublic boolean isAutoComplete() {\n-\t\treturn autoPreComplete || autoComplete;\n+            return autoPreComplete || autoComplete;\n \t}\n \t\n \tpublic boolean isAutoStart() {\n-\t\treturn autoStart;\n+            return autoStart;\n \t}\n \n     public static MapleQuest getInstance(int id) {"}, {"sha": "0ad572ee72f5f843f2515911dfc4c00e36175d4d", "filename": "src/server/quest/actions/ItemAction.java", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/src/server/quest/actions/ItemAction.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/src/server/quest/actions/ItemAction.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/quest/actions/ItemAction.java?ref=57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59", "patch": "@@ -80,7 +80,7 @@ public void processData(MapleData data) {\n \t@Override\n \tpublic void run(MapleCharacter chr, Integer extSelection) {\n \t\tMapleItemInformationProvider ii = MapleItemInformationProvider.getInstance();\n-        Map<Integer, Integer> props = new HashMap<>();\n+                Map<Integer, Integer> props = new HashMap<>();\n \t\tfor(ItemData item : items.values()) {\n \t\t\tif(item.getProp() != null && item.getProp() != -1 && canGetItem(item, chr)) {\n \t\t\t\tfor (int i = 0; i < item.getProp(); i++) {\n@@ -133,7 +133,7 @@ public void run(MapleCharacter chr, Integer extSelection) {\n \t@Override\n \tpublic boolean check(MapleCharacter chr, Integer extSelection) {\n \t\tMapleItemInformationProvider ii = MapleItemInformationProvider.getInstance();\n-        EnumMap<MapleInventoryType, Integer> props = new EnumMap<>(MapleInventoryType.class);\n+                EnumMap<MapleInventoryType, Integer> props = new EnumMap<>(MapleInventoryType.class);\n \t\tList<Pair<Item, MapleInventoryType>> itemList = new ArrayList<>();\n \t\tfor(ItemData item : items.values()) {\n \t\t\tif (!canGetItem(item, chr)) {"}, {"sha": "bec6245b2a2a050c8f92fd0ec23bb3002f4881a9", "filename": "wz/Quest.wz/Act.img.xml", "status": "modified", "additions": 7, "deletions": 6, "changes": 13, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/wz/Quest.wz/Act.img.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/wz/Quest.wz/Act.img.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/wz/Quest.wz/Act.img.xml?ref=57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59", "patch": "@@ -39358,6 +39358,13 @@\n     <imgdir name=\"0\">\n     </imgdir>\n     <imgdir name=\"1\">\n+      <int name=\"exp\" value=\"85000\"/>\n+      <imgdir name=\"item\">\n+        <imgdir name=\"0\">\n+          <int name=\"id\" value=\"4032006\"/>\n+          <int name=\"count\" value=\"-10\"/>\n+        </imgdir>\n+      </imgdir>\n     </imgdir>\n   </imgdir>\n   <imgdir name=\"8223\">\n@@ -39391,12 +39398,6 @@\n     </imgdir>\n     <imgdir name=\"1\">\n       <int name=\"exp\" value=\"15000\"/>\n-      <imgdir name=\"item\">\n-        <imgdir name=\"0\">\n-          <int name=\"id\" value=\"3992040\"/>\n-          <int name=\"count\" value=\"1\"/>\n-        </imgdir>\n-      </imgdir>\n     </imgdir>\n   </imgdir>\n   <imgdir name=\"8226\">"}, {"sha": "73aa09d98fcc47d953049970667d78751c8d4b53", "filename": "wz/Quest.wz/Check.img.xml", "status": "modified", "additions": 21, "deletions": 10, "changes": 31, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/wz/Quest.wz/Check.img.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/wz/Quest.wz/Check.img.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/wz/Quest.wz/Check.img.xml?ref=57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59", "patch": "@@ -63032,11 +63032,9 @@\n     <imgdir name=\"0\">\n       <int name=\"npc\" value=\"9201098\"/>\n       <int name=\"lvmin\" value=\"70\"/>\n-      <string name=\"startscript\" value=\"q8222s\"/>\n     </imgdir>\n     <imgdir name=\"1\">\n       <int name=\"npc\" value=\"9201098\"/>\n-      <string name=\"endscript\" value=\"q8222e\"/>\n       <imgdir name=\"item\">\n         <imgdir name=\"0\">\n           <int name=\"id\" value=\"4032006\"/>\n@@ -63098,6 +63096,12 @@\n   <imgdir name=\"8225\">\n     <imgdir name=\"1\">\n       <int name=\"npc\" value=\"9201100\"/>\n+      <imgdir name=\"item\">\n+        <imgdir name=\"0\">\n+          <int name=\"id\" value=\"3992040\"/>\n+          <int name=\"count\" value=\"1\"/>\n+        </imgdir>\n+      </imgdir>\n     </imgdir>\n     <imgdir name=\"0\">\n       <int name=\"npc\" value=\"9201100\"/>\n@@ -63109,12 +63113,6 @@\n           <int name=\"state\" value=\"2\"/>\n         </imgdir>\n       </imgdir>\n-      <imgdir name=\"item\">\n-        <imgdir name=\"0\">\n-          <int name=\"id\" value=\"3992040\"/>\n-          <int name=\"count\" value=\"1\"/>\n-        </imgdir>\n-      </imgdir>\n     </imgdir>\n   </imgdir>\n   <imgdir name=\"8226\">\n@@ -63153,6 +63151,13 @@\n     </imgdir>\n     <imgdir name=\"1\">\n       <int name=\"npc\" value=\"9201051\"/>\n+      <string name=\"endscript\" value=\"q8227e\"/>\n+      <imgdir name=\"item\">\n+        <imgdir name=\"0\">\n+          <int name=\"id\" value=\"4032032\"/>\n+          <int name=\"count\" value=\"1\"/>\n+        </imgdir>\n+      </imgdir>\n     </imgdir>\n   </imgdir>\n   <imgdir name=\"8228\">\n@@ -63171,8 +63176,8 @@\n       <string name=\"endscript\" value=\"q8228e\"/>\n       <imgdir name=\"item\">\n         <imgdir name=\"0\">\n-          <int name=\"id\" value=\"4032018\"/>\n-          <int name=\"count\" value=\"0\"/>\n+          <int name=\"id\" value=\"4032032\"/>\n+          <int name=\"count\" value=\"1\"/>\n         </imgdir>\n       </imgdir>\n     </imgdir>\n@@ -63181,6 +63186,12 @@\n     <imgdir name=\"1\">\n       <int name=\"npc\" value=\"9201096\"/>\n       <string name=\"endscript\" value=\"q8229e\"/>\n+      <imgdir name=\"item\">\n+        <imgdir name=\"0\">\n+          <int name=\"id\" value=\"4032018\"/>\n+          <int name=\"count\" value=\"1\"/>\n+        </imgdir>\n+      </imgdir>\n     </imgdir>\n     <imgdir name=\"0\">\n       <int name=\"npc\" value=\"9201051\"/>"}, {"sha": "e3592323c9276e59b81418e44ff571bbf681c245", "filename": "wz/Quest.wz/Say.img.xml", "status": "modified", "additions": 14, "deletions": 3, "changes": 17, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/wz/Quest.wz/Say.img.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59/wz/Quest.wz/Say.img.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/wz/Quest.wz/Say.img.xml?ref=57125a70ce40ecbf2f4c7c8ebaf9a06dbed05d59", "patch": "@@ -43323,14 +43323,25 @@\n     </imgdir>\n   </imgdir>\n   <imgdir name=\"8222\">\n+    <imgdir name=\"0\">\n+      <string name=\"1\" value=\"Well met, adventurer. I am #bLukan de Vrisien#k, knight of the Crimsonwood Keep. As one would expect from someone that guards their territory, they should know where they are and how well things are faring about what they are guarding. Strangely enough, I can&apos;t recognize these woods recently and, on top of that, many monsters just started wandering around.\"/>\n+      <imgdir name=\"yes\">\n+        <string name=\"0\" value=\"Very well, prove your words by taking down 10 Stormbreakers.\"/>\n+      </imgdir>\n+      <imgdir name=\"no\">\n+        <string name=\"0\" value=\"Well, I guess I can&apos;t count on you right now, as you too seem very busy.\"/>\n+      </imgdir>\n+      <string name=\"0\" value=\"Could you help me collect some #rbadges#k from the Stormbreakers, those #rknight-like#k creatures clad in red armor that are using lightning-type weapons, as means to research the source of the problem?\"/>\n+    </imgdir>\n     <imgdir name=\"1\">\n+      <string name=\"0\" value=\"Oh, great. You have done your job completing this challenge. I now can trust you are not linked to those Stormbreakers. You see, my position is that of a knight in the Stormcaster army, hailing from the Crimsonwood Keep. Right now I am lost on this foggy forest, looking for a way to the Keep.\"/>\n+      <string name=\"1\" value=\"What? Crimsonwood Keep is history? What are you talking about?! ... Well, given the fact that many monsters have simply appeared mysteriously, and I&apos;m in fact disorientated by the forest itself, it seems reasonable to say that I might have come from another time.\"/>\n       <imgdir name=\"stop\">\n         <imgdir name=\"item\">\n-          <string name=\"0\" value=\"#b10 Stormbreaker Badges#k were the terms of the challenge... and you are still shy of that number.  By accepting those terms of my challenge, you are honor-bound to bring me exactly 10, and no fewer.  Return when you have acquired all of them. \"/>\n+          <string name=\"0\" value=\"#b10 Stormbreaker Badges#k were the terms of the task... and you are still shy of that number.  By accepting those terms of my task, you are honor-bound to bring me exactly 10, and no fewer.  Return when you have acquired all of them.\"/>\n         </imgdir>\n       </imgdir>\n-    </imgdir>\n-    <imgdir name=\"0\">\n+      <string name=\"2\" value=\"Yet, there is something very suspicious after all of this. Guess I will set out for investigations now, thank you for your support.\"/>\n     </imgdir>\n   </imgdir>\n   <imgdir name=\"8223\">"}]}]},
