{"fetchDate": "2019-12-19", "content": [{"sha": "132f28639180aea52aba572ce8b528fbd839dec1", "node_id": "MDY6Q29tbWl0NDUwODIwMjM6MTMyZjI4NjM5MTgwYWVhNTJhYmE1NzJjZThiNTI4ZmJkODM5ZGVjMQ==", "commit": {"author": {"name": "ronancpl", "email": "rcpl2010@gmail.com", "date": "2018-08-28T17:12:00Z"}, "committer": {"name": "ronancpl", "email": "rcpl2010@gmail.com", "date": "2018-08-28T17:12:00Z"}, "message": "Commands overhaul + Selective loot + Antimulticlient Coordinator\n\nCompletely overhauled commands layout, each command splitted in Java classes.\nOptimized \"ranks\" command, no more calling the DB to get ranking info.\nImplemented a mechanic where mobs only spawns loots that are visible/collectable by the player's party.\nImplemented a server flag which sets whether explorers, cygnus and legends are allowed to share the cash shop inventory or not.\nImplemented support for dynamic server rates at bootup. Rates can now be assigned at the configuration.ini file.\nDevised the anti-multiclient login coordinator feature. Besides multiclient attempts by the same machine, it also prevents unauthorized login attempts into an account.\nFixed PQ instances being forcefully closed even when party leader reassignment upon logout is available.\nFixed mob statis not concurrently protected.", "tree": {"sha": "7ee49aa040518c16f347e7386e5a1bbe56a78e06", "url": "https://api.github.com/repos/ronancpl/HeavenMS/git/trees/7ee49aa040518c16f347e7386e5a1bbe56a78e06"}, "url": "https://api.github.com/repos/ronancpl/HeavenMS/git/commits/132f28639180aea52aba572ce8b528fbd839dec1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/132f28639180aea52aba572ce8b528fbd839dec1", "html_url": "https://github.com/ronancpl/HeavenMS/commit/132f28639180aea52aba572ce8b528fbd839dec1", "comments_url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/132f28639180aea52aba572ce8b528fbd839dec1/comments", "author": {"login": "ronancpl", "id": 9257761, "node_id": "MDQ6VXNlcjkyNTc3NjE=", "avatar_url": "https://avatars2.githubusercontent.com/u/9257761?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ronancpl", "html_url": "https://github.com/ronancpl", "followers_url": "https://api.github.com/users/ronancpl/followers", "following_url": "https://api.github.com/users/ronancpl/following{/other_user}", "gists_url": "https://api.github.com/users/ronancpl/gists{/gist_id}", "starred_url": "https://api.github.com/users/ronancpl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ronancpl/subscriptions", "organizations_url": "https://api.github.com/users/ronancpl/orgs", "repos_url": "https://api.github.com/users/ronancpl/repos", "events_url": "https://api.github.com/users/ronancpl/events{/privacy}", "received_events_url": "https://api.github.com/users/ronancpl/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ronancpl", "id": 9257761, "node_id": "MDQ6VXNlcjkyNTc3NjE=", "avatar_url": "https://avatars2.githubusercontent.com/u/9257761?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ronancpl", "html_url": "https://github.com/ronancpl", "followers_url": "https://api.github.com/users/ronancpl/followers", "following_url": "https://api.github.com/users/ronancpl/following{/other_user}", "gists_url": "https://api.github.com/users/ronancpl/gists{/gist_id}", "starred_url": "https://api.github.com/users/ronancpl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ronancpl/subscriptions", "organizations_url": "https://api.github.com/users/ronancpl/orgs", "repos_url": "https://api.github.com/users/ronancpl/repos", "events_url": "https://api.github.com/users/ronancpl/events{/privacy}", "received_events_url": "https://api.github.com/users/ronancpl/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b5c68311298f80fcd49440f79a89051a2280ac6c", "url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/b5c68311298f80fcd49440f79a89051a2280ac6c", "html_url": "https://github.com/ronancpl/HeavenMS/commit/b5c68311298f80fcd49440f79a89051a2280ac6c"}], "stats": {"total": 14361, "additions": 10514, "deletions": 3847}, "files": [{"sha": "eede63433b22ea037022eeeb6cd994201f888284", "filename": "docs/feature_list.md", "status": "modified", "additions": 9, "deletions": 3, "changes": 12, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/docs/feature_list.md", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/docs/feature_list.md", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/docs/feature_list.md?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -1,4 +1,4 @@\n-#**HeavenMS**\n+# HeavenMS\n \n Credits:\n \n@@ -96,6 +96,7 @@ Monsters, Maps & Reactors:\n * Monsterbook displays drop data info conformant with the underlying DB (needs custom wz). See more on the MobBookUpdate feature.\n * Every skill/mastery book is now droppable by mobs.\n * Mobs now can drop more than one of the same equipment (number of possible drops defined at droptime, uses the minimum/maximum quantity fields on DB).\n+* Mobs only drops items that are visible/collectable by the player's party.\n * Redesigned HT mechanics for spawn and linked damage to the sponge.\n * Limited item count on maps, smartly expiring oldest registered items, preventing potential item flooding.\n * Implemented Zombify disease status.\n@@ -131,10 +132,12 @@ Player potentials:\n * Pet evolutions functional (not GMS-like).\n * Reviewed keybinding system.\n * Account's Character slots: either each world has it's own count or there's a shared value between all worlds.\n+* Optional cash shop inventory separated by player classes or fully account-ranged.\n \n Server potentials:\n \n * Multi-worlds.\n+* Dynamic world rates, each world can hold it's own rates from server bootup.\n * Dynamic World/Channel deployment. While not implemented here, new channel deployment sensitive to quantity of online players was originally resinate's idea.\n * Inventory auto-gather and auto-sorting feature.\n * Enhanced auto-pot system: pet uses as many potions as necessary to reach the desired threshold.\n@@ -143,7 +146,7 @@ Server potentials:\n * Enhanced inventory check: free slots on inventory smartly fetched on demand.\n * Enhanced auto-loot handler: optimized the brute-force checks for some cash items on the player equipped inventory at every requisition.\n * Tweaked pet/mount hunger: calculations for fullness/tiredness takes active time of the subject into account.\n-* Consistent experience gain system.\n+* Consistent experience and meso gain system.\n * NPC crafters (equips, plates/jewels, etc) now won't take items freely if the requirement conditions are not properly met.\n * Improved Duey mechanics: package received popup and reviewed many delivery mechanics.\n * Pet item pickup now gives preference to player attacks rather than forcing attack disables when automatically picking up.\n@@ -178,7 +181,9 @@ Admin/GM commands:\n \n * Server commands layered by GM levels.\n * Spawn Zakum/Horntail/Pinkbean.\n-* New commands.\n+* Several new commands.\n+* Rank command highlighting users either by world or server-wide.\n+* Revamped command files layout -- thanks Arthur L.\n \n External tools:\n \n@@ -213,6 +218,7 @@ Project:\n * Improved login phase, using cache over DB queries.\n * Usage of HikariCP to improve the DB connection management.\n * Developed many survey tools for content profiling.\n+* Developed a robust anti-exploit login coordinator system.\n * Protected many flaws with login management system.\n * Channel, World and Server-wide timer management.\n * Heavily reviewed future task management inside the project. Way less trivial schedules are spawned now, relieving task overload on the TimerManager."}, {"sha": "f7b4917ab2ffe128e680b083793bc7dcff2bad71", "filename": "docs/issues.txt", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/docs/issues.txt", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/docs/issues.txt", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/docs/issues.txt?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -23,6 +23,7 @@ Missing features list:\n - Some pirate skills doesn't work for 3rd parties.\n - Cache frequently used SQL data.\n - Pet commands are not being propagated to 3rd parties, and the commandResponse packet function seems somewhat wonky.\n+- Pet speed.\n ---------------------------\n \n "}, {"sha": "641813bf12c138eb0c793ea32b9f3eb2515d4ab1", "filename": "docs/mychanges_ptbr.txt", "status": "modified", "additions": 20, "deletions": 1, "changes": 21, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/docs/mychanges_ptbr.txt", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/docs/mychanges_ptbr.txt", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/docs/mychanges_ptbr.txt?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -1246,4 +1246,23 @@ Retirado campo de GM da tabela \"accounts\".\n Corrigido estatuas do stage1 da GuildPQ nao funcionando corretamente.\n Alterado varias strings de NPCs e de mensagens utilizando a palavra \"evento\" querendo dizer instancias (julgamento subjetivo).\n Adicionado comandos para start, complete e reset quests.\n-Adicionado scripts para meteoritos de Omega Sector.\n\\ No newline at end of file\n+Adicionado scripts para meteoritos de Omega Sector.\n+\n+18 - 19 Agosto 2018,\n+Refatorado comandos, desacoplando e distribuindo c\u00f3digo para v\u00e1rias classes separadas por GM ranks.\n+Refatorado comando \"ranks\", n\u00e3o mais requisitando acesso \u00e0 DB para recuperar informa\u00e7\u00f5es de ranking.\n+Corrigido comando \"ranks\" n\u00e3o avaliando donators corretamente.\n+\n+20 - 23 Agosto 2018,\n+Implementado mec\u00e2nica com loot de mobs onde somente itens colet\u00e1veis pelo jogador/party podem aparecer.\n+Implementado server flag que permite explorers, cygnus e legends compartilharem mesmo invent\u00e1rio de cash shop.\n+Corrigido m\u00e9todo de ganho de mesos ignorando atualiza\u00e7\u00e3o de meso quando h\u00e1 overflow.\n+Implementado suporte para rates espec\u00edficos pra cada world (exp, meso, drop, quest e travel rates).\n+Adicionado listagem de tipos para o comando de debug.\n+Implementado sistema anti-multicliente e detector de tentativas inautorizadas de acesso a contas durante a fase de login.\n+Corrigido setGender n\u00e3o modificando estado do cliente para n\u00e3o-logado ao cancelar a a\u00e7\u00e3o.\n+\n+24 Agosto 2018,\n+Melhorado mec\u00e2nica de logout de l\u00edder de party, passando a lideran\u00e7a adiante antes de efetivamente deslogar, permitindo assim inst\u00e2ncias a continuarem ap\u00f3s a sa\u00edda do mesmo, dadas circunst\u00e2ncias favor\u00e1veis.\n+Outra corre\u00e7\u00e3o no XMLDomMapleData, que ainda continua dando NullPointerExceptions.\n+Corrigido stati de mobs n\u00e3o protegido concorrentemente em certos casos.\n\\ No newline at end of file"}, {"sha": "9e47f10de7ee346eaffa15611e07614e4d225979", "filename": "scripts/npc/9977777.js", "status": "modified", "additions": 9, "deletions": 3, "changes": 12, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/scripts/npc/9977777.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/scripts/npc/9977777.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/9977777.js?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -111,6 +111,7 @@ function writeFeatureTab_MonstersMapsReactors() {\n         addFeature(\"Monsterbook displays updated drop data info.\");\n         addFeature(\"Every skill/mastery book is now obtainable.\");\n         addFeature(\"Mobs now can drop more than one of the same equip.\");\n+        addFeature(\"Mobs only drop items collectable by the player/party.\");\n         addFeature(\"Redesigned HT mechanics: assemble & dmg taken.\");\n         addFeature(\"Implemented Zombify disease status.\");\n         addFeature(\"Added Boss HP Bar for dozens of bosses.\");\n@@ -146,10 +147,12 @@ function writeFeatureTab_Playerpotentials() {\n         addFeature(\"Pet evolutions functional (not GMS-like).\");\n         addFeature(\"Reviewed keybinding system.\");\n         addFeature(\"Character slots per world/server-wide.\");\n+        addFeature(\"Optional cash shop inventory separated by classes.\");\n }\n \n function writeFeatureTab_Serverpotentials() {\n         addFeature(\"Multi-worlds.\");\n+        addFeature(\"Each world can hold it's own rates from server bootup.\");\n         addFeature(\"Dynamic World/Channel deployment.\");\n         addFeature(\"Inventory auto-gather and auto-sorting feature.\");\n         addFeature(\"Enhanced auto-pot system: smart pet potion handle.\");\n@@ -158,13 +161,13 @@ function writeFeatureTab_Serverpotentials() {\n         addFeature(\"Enhanced inventory check: free slots smartly fetched.\");\n         addFeature(\"Enhanced petloot handler: no brute-force inv. checks.\");\n         addFeature(\"Tweaked pet/mount hunger to a balanced growth rate.\");\n-        addFeature(\"Consistent experience gain system.\");\n+        addFeature(\"Consistent experience and meso gain system.\");\n         addFeature(\"NPC crafters won't take items freely anymore.\");\n         addFeature(\"Duey: pkg rcvd popup and many delivery mechanics.\");\n         addFeature(\"Pet pickup gives preference to player attacks.\");\n         addFeature(\"Channel capacity bar and worlds with capacity check.\");\n         addFeature(\"Diseases visible for others, even after changing maps.\");\n-        addFeature(\"Persistent diseases. Players keep their status on login.\");\n+        addFeature(\"Persistent diseases. Players keeps status on login.\");\n         addFeature(\"Poison damage value visible for other players.\");\n         addFeature(\"M. book announcer displays info based on demand.\");\n         addFeature(\"Custom jail system.\");\n@@ -182,9 +185,11 @@ function writeFeatureTab_Serverpotentials() {\n }\n \n function writeFeatureTab_AdminGMcommands() {\n-        addFeature(\"Server commands layered by GM levels.\");\n         addFeature(\"Spawn Zakum/Horntail/Pinkbean.\");\n         addFeature(\"Several new commands.\");\n+        addFeature(\"Rank command highlighting users by world or overall.\");\n+        addFeature(\"Server commands layered by GM levels.\");\n+        addFeature(\"Revamped command files layout - thanks Arthur L!\");\n }\n \n function writeFeatureTab_CustomNPCs() {\n@@ -219,6 +224,7 @@ function writeFeatureTab_Project() {\n         addFeature(\"Reviewed SQL data, eliminating duplicated entries.\");\n         addFeature(\"Improved login phase, using cache over DB queries.\");\n         addFeature(\"Protected many flaws with login management system.\");\n+        addFeature(\"Developed a robust anti-exploit login coordinator.\");\n         addFeature(\"Usage of HikariCP to improve DB connection calls.\");\n         addFeature(\"Developed many survey tools for content profiling.\");\n         addFeature(\"ThreadTracker: runtime tool for deadlock detection.\");"}, {"sha": "a9c8257359aa314c9b388ab31fc761b07048423f", "filename": "scripts/npc/commands.js", "status": "modified", "additions": 15, "deletions": 263, "changes": 278, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/scripts/npc/commands.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/scripts/npc/commands.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/commands.js?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -6,252 +6,18 @@\n         Script: commands.js\n */\n \n+importPackage(Packages.client.command);\n+\n var status;\n \n var common_heading = \"@\";\n var staff_heading = \"!\";\n \n-var comm_lv6 = [];\n-var desc_lv6 = [];\n-\n-var comm_lv5 = [];\n-var desc_lv5 = [];\n-\n-var comm_lv4 = [];\n-var desc_lv4 = [];\n-\n-var comm_lv3 = [];\n-var desc_lv3 = [];\n-\n-var comm_lv2 = [];\n-var desc_lv2 = [];\n-\n-var comm_lv1 = [];\n-var desc_lv1 = [];\n-\n-var comm_lv0 = [];\n-var desc_lv0 = [];\n-\n var levels = [\"Common\", \"Donator\", \"JrGM\", \"GM\", \"SuperGM\", \"Developer\", \"Admin\"];\n-\n-var comm_cursor, desc_cursor;\n-\n-function addCommand(comm, desc) {\n-        comm_cursor.push(comm);\n-        desc_cursor.push(desc);\n-}\n-\n-function writeHeavenMSCommandsLv6() {    //Admin\n-        comm_cursor = comm_lv6;\n-        desc_cursor = desc_lv6;\n-\n-        addCommand(\"setgmlevel\", \"\");\n-        addCommand(\"warpworld\", \"\");\n-        addCommand(\"saveall\", \"\");\n-        addCommand(\"dcall\", \"\");\n-        addCommand(\"mapplayers\", \"\");\n-        addCommand(\"getacc\", \"\");\n-        addCommand(\"addchannel\", \"\");\n-        addCommand(\"addworld\", \"\");\n-        //addCommand(\"removechannel\", \"\");\n-        //addCommand(\"removeworld\", \"\");\n-        addCommand(\"shutdown\", \"\");\n-        addCommand(\"shutdownnow\", \"\");\n-        addCommand(\"clearquestcache\", \"\");\n-        addCommand(\"clearquest\", \"\");\n-        addCommand(\"spawnallpnpcs\", \"\");\n-        addCommand(\"eraseallpnpcs\", \"\");\n-}\n-\n-function writeHeavenMSCommandsLv5() {    //Developer\n-        comm_cursor = comm_lv5;\n-        desc_cursor = desc_lv5;\n-\n-        addCommand(\"debugmonster\", \"\");\n-        addCommand(\"debugpacket\", \"\");\n-        addCommand(\"debugportal\", \"\");\n-        addCommand(\"debugspawnpoint\", \"\");\n-        addCommand(\"debugpos\", \"\");\n-        addCommand(\"debugmap\", \"\");\n-        addCommand(\"debugmobsp\", \"\");\n-        addCommand(\"debugevent\", \"\");\n-        addCommand(\"debugareas\", \"\");\n-        addCommand(\"debugreactors\", \"\");\n-        addCommand(\"debugcoupons\", \"\");\n-        addCommand(\"debugplayercoupons\", \"\");\n-        addCommand(\"debugtimer\", \"\");\n-        addCommand(\"debugmarriage\", \"\");\n-        addCommand(\"showpackets\", \"\");\n-        addCommand(\"set\", \"\");\n-}\n-\n-function writeHeavenMSCommandsLv4() {    //SuperGM\n-        comm_cursor = comm_lv4;\n-        desc_cursor = desc_lv4;\n-\n-        addCommand(\"servermessage\", \"\");\n-        addCommand(\"proitem\", \"\");\n-        addCommand(\"seteqstat\", \"\");\n-        addCommand(\"exprate\", \"\");\n-        addCommand(\"mesorate\", \"\");\n-        addCommand(\"droprate\", \"\");\n-        addCommand(\"questrate\", \"\");\n-        addCommand(\"itemvac\", \"\");\n-        addCommand(\"forcevac\", \"\");\n-        addCommand(\"zakum\", \"\");\n-        addCommand(\"horntail\", \"\");\n-        addCommand(\"pinkbean\", \"\");\n-        addCommand(\"pap\", \"\");\n-        addCommand(\"pianus\", \"\");\n-        addCommand(\"cake\", \"\");\n-        addCommand(\"playernpcremove\", \"\");\n-        addCommand(\"playernpc\", \"\");\n-}\n-\n-function writeHeavenMSCommandsLv3() {    //GM\n-        comm_cursor = comm_lv3;\n-        desc_cursor = desc_lv3;\n-\n-        addCommand(\"debuff\", \"\");\n-        addCommand(\"fly\", \"\");\n-        addCommand(\"spawn\", \"\");\n-        addCommand(\"mutemap\", \"\");\n-        addCommand(\"checkdmg\", \"\");\n-        addCommand(\"inmap\", \"\");\n-        addCommand(\"reloadevents\", \"\");\n-        addCommand(\"reloaddrops\", \"\");\n-        addCommand(\"reloadportals\", \"\");\n-        addCommand(\"reloadmap\", \"\");\n-        addCommand(\"reloadshops\", \"\");\n-        addCommand(\"hpmp\", \"\");\n-        addCommand(\"maxhpmp\", \"\");\n-        addCommand(\"music\", \"\");\n-        addCommand(\"monitor\", \"\");\n-        addCommand(\"monitors\", \"\");\n-        addCommand(\"ignore\", \"\");\n-        addCommand(\"ignored\", \"\");\n-        addCommand(\"pos\", \"\");\n-        addCommand(\"togglecoupon\", \"\");\n-        addCommand(\"chat\", \"\");\n-        addCommand(\"fame\", \"\");\n-        addCommand(\"givenx\", \"\");\n-        addCommand(\"givevp\", \"\");\n-        addCommand(\"givems\", \"\");\n-        addCommand(\"id\", \"\");\n-        addCommand(\"expeds\", \"\");\n-        addCommand(\"kill\", \"\");\n-        addCommand(\"seed\", \"\");\n-        addCommand(\"maxenergy\", \"\");\n-        addCommand(\"killall\", \"\");\n-        addCommand(\"notice\", \"\");\n-        addCommand(\"rip\", \"\");\n-        addCommand(\"openportal\", \"\");\n-        addCommand(\"closeportal\", \"\");\n-        addCommand(\"pe\", \"\");\n-        addCommand(\"startevent\", \"\");\n-        addCommand(\"endevent\", \"\");\n-        addCommand(\"online2\", \"\");\n-        addCommand(\"warpsnowball\", \"\");\n-        addCommand(\"ban\", \"\");\n-        addCommand(\"unban\", \"\");\n-        addCommand(\"healmap\", \"\");\n-        addCommand(\"healperson\", \"\");\n-        addCommand(\"hurt\", \"\");\n-        addCommand(\"killmap\", \"\");\n-        addCommand(\"night\", \"\");\n-        addCommand(\"npc\", \"\");\n-        addCommand(\"face\", \"\");\n-        addCommand(\"hair\", \"\");\n-        addCommand(\"startquest\", \"\");\n-        addCommand(\"completequest\", \"\");\n-        addCommand(\"resetquest\", \"\");\n-}\n-\n-function writeHeavenMSCommandsLv2() {    //JrGM\n-        comm_cursor = comm_lv2;\n-        desc_cursor = desc_lv2;\n-\n-        addCommand(\"recharge\", \"\");\n-        addCommand(\"whereami\", \"\");\n-        addCommand(\"hide\", \"\");\n-        addCommand(\"unhide\", \"\");\n-        addCommand(\"sp\", \"\");\n-        addCommand(\"ap\", \"\");\n-        addCommand(\"empowerme\", \"\");\n-        addCommand(\"buffmap\", \"\");\n-        addCommand(\"buff\", \"\");\n-        addCommand(\"bomb\", \"\");\n-        addCommand(\"dc\", \"\");\n-        addCommand(\"cleardrops\", \"\");\n-        addCommand(\"clearslot\", \"\");\n-        addCommand(\"warp\", \"\");\n-        addCommand(\"warpto\", \"\");\n-        addCommand(\"warphere\", \"\");\n-        addCommand(\"reach\", \"\");\n-        addCommand(\"gmshop\", \"\");\n-        addCommand(\"heal\", \"\");\n-        addCommand(\"item\", \"\");\n-        addCommand(\"level\", \"\");\n-        addCommand(\"levelpro\", \"\");\n-        addCommand(\"setstat\", \"\");\n-        addCommand(\"maxstat\", \"\");\n-        addCommand(\"maxskill\", \"\");\n-        addCommand(\"resetskill\", \"\");\n-        addCommand(\"mesos\", \"\");\n-        addCommand(\"search\", \"\");\n-        addCommand(\"jail\", \"\");\n-        addCommand(\"unjail\", \"\");\n-        addCommand(\"job\", \"\");\n-        addCommand(\"unbug\", \"\");\n-}\n-\n-function writeHeavenMSCommandsLv1() {    //Donator\n-        comm_cursor = comm_lv1;\n-        desc_cursor = desc_lv1;\n-\n-        addCommand(\"bosshp\", \"\");\n-        addCommand(\"mobhp\", \"\");\n-        addCommand(\"whatdropsfrom\", \"\");\n-        addCommand(\"whodrops\", \"\");\n-        addCommand(\"buffme\", \"\");\n-        addCommand(\"goto\", \"\");\n-}\n-\n-function writeHeavenMSCommandsLv0() {    //Common\n-        comm_cursor = comm_lv0;\n-        desc_cursor = desc_lv0;\n-\n-        addCommand(\"commands\", \"\");\n-        addCommand(\"droplimit\", \"\");\n-        addCommand(\"time\", \"\");\n-        addCommand(\"credits\", \"\");\n-        addCommand(\"uptime\", \"\");\n-        addCommand(\"gacha\", \"\");\n-        addCommand(\"dispose\", \"\");\n-        addCommand(\"equiplv\", \"\");\n-        addCommand(\"showrates\", \"\");\n-        addCommand(\"rates\", \"\");\n-        addCommand(\"online\", \"\");\n-        addCommand(\"gm\", \"\");\n-        addCommand(\"reportbug\", \"\");\n-\t//addCommand(\"points\", \"\");\n-        addCommand(\"joinevent\", \"\");\n-        addCommand(\"leaveevent\", \"\");\n-        addCommand(\"ranks\", \"\");\n-        addCommand(\"str\", \"\");\n-        addCommand(\"dex\", \"\");\n-        addCommand(\"int\", \"\");\n-        addCommand(\"luk\", \"\");\n-}\n+var commands;\n \n function writeHeavenMSCommands() {\n-        writeHeavenMSCommandsLv0();  //Common\n-        writeHeavenMSCommandsLv1();  //Donator\n-        writeHeavenMSCommandsLv2();  //JrGM\n-        writeHeavenMSCommandsLv3();  //GM\n-        writeHeavenMSCommandsLv4();  //Developer\n-        writeHeavenMSCommandsLv5();  //SuperGM\n-        writeHeavenMSCommandsLv6();  //Admin\n+        commands = CommandsExecutor.getInstance().getGmCommands();\n }\n \n function start() {\n@@ -282,33 +48,19 @@ function action(mode, type, selection) {\n                         cm.sendSimple(sendStr);\n                 } else if(status == 1) {\n                         var lvComm, lvDesc, lvHead = (cm.getPlayer().gmLevel() < 2) ? common_heading : staff_heading;\n-\n-                        if(selection == 0) {\n-                                lvComm = comm_lv0;\n-                                lvDesc = desc_lv0;\n-                        } else if(selection == 1) {\n-                                lvComm = comm_lv1;\n-                                lvDesc = desc_lv1;\n-                        } else if(selection == 2) {\n-                                lvComm = comm_lv2;\n-                                lvDesc = desc_lv2;\n-                        } else if(selection == 3) {\n-                                lvComm = comm_lv3;\n-                                lvDesc = desc_lv3;\n-                        } else if(selection == 4) {\n-                                lvComm = comm_lv4;\n-                                lvDesc = desc_lv4;\n-                        } else if(selection == 5) {\n-                                lvComm = comm_lv5;\n-                                lvDesc = desc_lv5;\n-                        } else {\n-                                lvComm = comm_lv6;\n-                                lvDesc = desc_lv6;\n+                        \n+                        if(selection > 6) {\n+                                selection = 6;\n+                        } else if(selection < 0) {\n+                                selection = 0;\n                         }\n-\n+                        \n+                        lvComm = commands.get(selection).getLeft();\n+                        lvDesc = commands.get(selection).getRight();\n+                        \n                         var sendStr = \"The following commands are available for #b\" + levels[selection] + \"#k:\\r\\n\\r\\n\";\n-                        for(var i = 0; i < lvComm.length; i++) {\n-                            sendStr += \"  #L\" + i + \"# \" + lvHead + lvComm[i] + \" - \" + lvDesc[i];\n+                        for(var i = 0; i < lvComm.size(); i++) {\n+                            sendStr += \"  #L\" + i + \"# \" + lvHead + lvComm.get(i) + \" - \" + lvDesc.get(i);\n                             sendStr += \"#l\\r\\n\";\n                         }\n "}, {"sha": "11d59bf77734711026b282419d4ea38f18b28483", "filename": "scripts/npc/credits.js", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/scripts/npc/credits.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/scripts/npc/credits.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/credits.js?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -61,7 +61,7 @@ function writeServerStaff_MoopleDEV() {\n }\n \n function writeServerStaff_MetroMS() {\n-        addPerson(\"Moongra\", \"Developer\");\n+        addPerson(\"Moogra\", \"Developer\");\n         setHistory(2009, 2010);\n }\n \n@@ -73,6 +73,7 @@ function writeServerStaff_BubblesDEV() {\n \n function writeServerStaff_ThePackII() {\n         addPerson(\"Hofer\", \"Developer\");\n+        addPerson(\"Moogra\", \"Developer\");\n         setHistory(2008, 2009);\n }\n "}, {"sha": "a1b780a0c89620f64215c96322bb0801839c2daf", "filename": "sql/db_database.sql", "status": "modified", "additions": 7, "deletions": 9, "changes": 16, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/sql/db_database.sql", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/sql/db_database.sql", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/sql/db_database.sql?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -1,4 +1,4 @@\n-#EXECUTE THIS FIRST, THEN NEXT SQL: 'db_drops.sql'\n+\ufeff#EXECUTE THIS FIRST, THEN NEXT SQL: 'db_drops.sql'\n \n SET SQL_MODE = \"NO_AUTO_VALUE_ON_ZERO\";\n SET time_zone = \"+00:00\";\n@@ -44,7 +44,7 @@ CREATE TABLE IF NOT EXISTS `accounts` (\n   `hwid` varchar(12) NOT NULL DEFAULT '',\n   PRIMARY KEY (`id`),\n   UNIQUE KEY `name` (`name`),\n-  KEY `ranking1` (`id`,`banned`,`gm`),\n+  KEY `ranking1` (`id`,`banned`),\n   INDEX (id, name),\n   INDEX (id, nxCredit, maplePoint, nxPrepaid)\n ) ENGINE=InnoDB DEFAULT CHARSET=latin1 AUTO_INCREMENT=1 ;\n@@ -13005,14 +13005,12 @@ CREATE TABLE IF NOT EXISTS `ipbans` (\n   PRIMARY KEY (`ipbanid`)\n ) ENGINE=InnoDB DEFAULT CHARSET=latin1 AUTO_INCREMENT=1 ;\n \n-CREATE TABLE IF NOT EXISTS `iplog` (\n-  `iplogid` int(10) unsigned NOT NULL AUTO_INCREMENT,\n+CREATE TABLE IF NOT EXISTS `ipaccounts` (\n   `accountid` int(11) NOT NULL DEFAULT '0',\n-  `ip` varchar(30) NOT NULL DEFAULT '',\n-  `login` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,\n-  PRIMARY KEY (`iplogid`),\n-  KEY `accountid` (`accountid`,`ip`),\n-  KEY `ip` (`ip`)\n+  `ip` varchar(40) NOT NULL DEFAULT '',\n+  `relevance` tinyint(2) NOT NULL DEFAULT '0',\n+  `expiresat` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,\n+  PRIMARY KEY (`accountid`,`ip`)\n ) ENGINE=InnoDB DEFAULT CHARSET=latin1 AUTO_INCREMENT=1 ;\n \n CREATE TABLE IF NOT EXISTS `keymap` ("}, {"sha": "e29c3902ca297a6d86eff18e85784a00809eb39d", "filename": "src/client/MapleCharacter.java", "status": "modified", "additions": 45, "deletions": 15, "changes": 60, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/MapleCharacter.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/MapleCharacter.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/MapleCharacter.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -77,6 +77,7 @@\n import server.events.gm.MapleOla;\n import server.life.MapleMonster;\n import server.life.MobSkill;\n+import server.loot.MapleLootManager;\n import server.maps.AbstractAnimatedMapleMapObject;\n import server.maps.MapleHiredMerchant;\n import server.maps.MapleDoor;\n@@ -92,6 +93,7 @@\n import server.maps.MaplePlayerShopItem;\n import server.maps.MapleSummon;\n import server.life.MaplePlayerNPC;\n+import server.life.MonsterDropEntry;\n import server.maps.SavedLocation;\n import server.maps.SavedLocationType;\n import server.partyquest.MonsterCarnival;\n@@ -279,7 +281,7 @@\n     private Lock chrLock = MonitoredReentrantLockFactory.createLock(MonitoredLockType.CHARACTER_CHR, true);\n     private Lock effLock = MonitoredReentrantLockFactory.createLock(MonitoredLockType.CHARACTER_EFF, true);\n     private Lock evtLock = MonitoredReentrantLockFactory.createLock(MonitoredLockType.CHARACTER_EVT, true);\n-    private Lock petLock = MonitoredReentrantLockFactory.createLock(MonitoredLockType.CHARACTER_PET, true); // for quest tasks as well\n+    private Lock petLock = MonitoredReentrantLockFactory.createLock(MonitoredLockType.CHARACTER_PET, true); // for meso & quest tasks as well\n     private Lock prtLock = MonitoredReentrantLockFactory.createLock(MonitoredLockType.CHARACTER_PRT);\n     private Map<Integer, Set<Integer>> excluded = new LinkedHashMap<>();\n     private Set<Integer> excludedItems = new LinkedHashSet<>();\n@@ -1852,7 +1854,7 @@ public final void pickupItem(MapleMapObject ob, int petIndex) {     // yes, one\n                         return;\n                     }\n             \n-                    if (mapitem.getQuest() > 0 && !this.needQuestItem(mapitem.getQuest(), mapitem.getItemId())) {\n+                    if (!this.needQuestItem(mapitem.getQuest(), mapitem.getItemId())) {\n                         client.announce(MaplePacketCreator.showItemUnavailable());\n                         client.announce(MaplePacketCreator.enableActions());\n                         return;\n@@ -1984,13 +1986,15 @@ public void decreaseReports() {\n     public void deleteGuild(int guildId) {\n         try {\n             Connection con = DatabaseConnection.getConnection();\n-            try (PreparedStatement ps = con.prepareStatement(\"UPDATE characters SET guildid = 0, guildrank = 5 WHERE guildid = ?\")) {\n-                ps.setInt(1, guildId);\n-                ps.execute();\n-            }\n-            try (PreparedStatement ps = con.prepareStatement(\"DELETE FROM guilds WHERE guildid = ?\")) {\n-                ps.setInt(1, id);\n-                ps.execute();\n+            try {\n+                try (PreparedStatement ps = con.prepareStatement(\"UPDATE characters SET guildid = 0, guildrank = 5 WHERE guildid = ?\")) {\n+                    ps.setInt(1, guildId);\n+                    ps.execute();\n+                }\n+                try (PreparedStatement ps = con.prepareStatement(\"DELETE FROM guilds WHERE guildid = ?\")) {\n+                    ps.setInt(1, id);\n+                    ps.execute();\n+                }\n             } finally {\n                 con.close();\n             }\n@@ -2897,13 +2901,27 @@ public void gainMeso(int gain, boolean show) {\n     }\n \n     public void gainMeso(int gain, boolean show, boolean enableActions, boolean inChat) {\n-        if (meso.get() + gain < 0) {\n-            client.announce(MaplePacketCreator.enableActions());\n-            return;\n+        long nextMeso;\n+        petLock.lock();\n+        try {\n+            nextMeso = meso.get() + gain;\n+            if (nextMeso > Integer.MAX_VALUE) {\n+                gain -= (nextMeso - Integer.MAX_VALUE);\n+            } else if (nextMeso < 0) {\n+                gain = -meso.get();\n+            }\n+            nextMeso = meso.addAndGet(gain);\n+        } finally {\n+            petLock.unlock();\n         }\n-        updateSingleStat(MapleStat.MESO, meso.addAndGet(gain), enableActions);\n-        if (show) {\n-            client.announce(MaplePacketCreator.getShowMesoGain(gain, inChat));\n+        \n+        if (gain != 0) {\n+            updateSingleStat(MapleStat.MESO, (int) nextMeso, enableActions);\n+            if (show) {\n+                client.announce(MaplePacketCreator.getShowMesoGain(gain, inChat));\n+            }\n+        } else {\n+            client.announce(MaplePacketCreator.enableActions());\n         }\n     }\n \n@@ -4817,6 +4835,18 @@ public boolean isPartyMember(int cid) {\n         \n         return false;\n     }\n+    \n+    public List<MonsterDropEntry> retrieveRelevantDrops(int monsterId) {\n+        List<MapleCharacter> pchars = new LinkedList<>();\n+        for (MapleCharacter chr : getPartyMembers()) {\n+            if (chr.isLoggedinWorld()) {\n+                pchars.add(chr);\n+            }\n+        }\n+        \n+        if(pchars.isEmpty()) pchars.add(this);\n+        return MapleLootManager.retrieveRelevantDrops(monsterId, pchars);\n+    }\n \n     public MaplePlayerShop getPlayerShop() {\n         return playerShop;"}, {"sha": "0de15209734e8216d4a5bef3b642f54dd7f1d90e", "filename": "src/client/MapleClient.java", "status": "modified", "additions": 96, "deletions": 75, "changes": 171, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/MapleClient.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/MapleClient.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/MapleClient.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -48,6 +48,8 @@\n import javax.script.ScriptEngine;\n \n import net.server.Server;\n+import net.server.coordinator.MapleSessionCoordinator;\n+import net.server.coordinator.MapleSessionCoordinator.AntiMulticlientResult;\n import net.server.channel.Channel;\n import net.server.guild.MapleGuild;\n import net.server.guild.MapleGuildCharacter;\n@@ -88,7 +90,7 @@\n \tprivate final IoSession session;\n \tprivate MapleCharacter player;\n \tprivate int channel = 1;\n-\tprivate int accId = 1;\n+\tprivate int accId = 0;\n \tprivate boolean loggedIn = false;\n \tprivate boolean serverTransition = false;\n \tprivate Calendar birthday = null;\n@@ -462,7 +464,7 @@ public String getPin() {\n \tpublic boolean checkPin(String other) {\n \t\tpinattempt++;\n \t\tif (pinattempt > 5) {\n-\t\t\tsession.close(false);\n+                        MapleSessionCoordinator.getInstance().closeSession(session, false);\n \t\t}\n \t\tif (pin.equals(other)) {\n \t\t\tpinattempt = 0;\n@@ -496,7 +498,7 @@ public boolean checkPic(String other) {\n             \n \t\tpicattempt++;\n \t\tif (picattempt > 5) {\n-\t\t\tsession.close(false);\n+\t\t\tMapleSessionCoordinator.getInstance().closeSession(session, false);\n \t\t}\n \t\tif (pic.equals(other)) {\n \t\t\tpicattempt = 0;\n@@ -508,7 +510,7 @@ public boolean checkPic(String other) {\n \tpublic int login(String login, String pwd) {\n \t\tloginattempt++;\n \t\tif (loginattempt > 4) {\n-\t\t\tsession.close(false);\n+\t\t\tMapleSessionCoordinator.getInstance().closeSession(session, false);\n \t\t}\n \t\tint loginok = 5;\n \t\tConnection con = null;\n@@ -549,10 +551,6 @@ public int login(String login, String pwd) {\n \t\t\t\t\tloggedIn = false;\n \t\t\t\t\tloginok = 4;\n \t\t\t\t}\n-\t\t\t\tps = con.prepareStatement(\"INSERT INTO iplog (accountid, ip) VALUES (?, ?)\");\n-\t\t\t\tps.setInt(1, accId);\n-\t\t\t\tps.setString(2, session.getRemoteAddress().toString());\n-\t\t\t\tps.executeUpdate();\n \t\t\t}\n \t\t} catch (SQLException e) {\n \t\t\te.printStackTrace();\n@@ -571,10 +569,36 @@ public int login(String login, String pwd) {\n \t\t\t\te.printStackTrace();\n \t\t\t}\n \t\t}\n-\t\tif (loginok == 0) {\n-\t\t\tloginattempt = 0;\n-\t\t}\n-\t\treturn loginok;\n+                \n+\t\tif (loginok == 0 || loginok == 4) {\n+                        AntiMulticlientResult res = MapleSessionCoordinator.getInstance().attemptSessionLogin(session, accId, loginok == 4);\n+                        \n+                        switch (res) {\n+                                case SUCCESS:\n+                                        if (loginok == 0) {\n+                                                loginattempt = 0;\n+                                        }\n+                                        \n+                                        return loginok;\n+\n+                                case REMOTE_LOGGEDIN:\n+                                        return 17;\n+\n+                                case REMOTE_REACHED_LIMIT:\n+                                        return 13;\n+\n+                                case REMOTE_PROCESSING:\n+                                        return 10;\n+                                    \n+                                case MANY_ACCOUNT_ATTEMPTS:\n+                                        return 16;\n+\n+                                default:\n+                                        return 8;\n+                        }\n+\t\t} else {\n+                        return loginok;\n+                }\n \t}\n \n \tpublic Calendar getTempBanCalendar() {\n@@ -717,20 +741,23 @@ public int getAccID() {\n \n \tpublic void updateLoginState(int newstate) {\n \t\ttry {\n-\t\t\tConnection con = DatabaseConnection.getConnection();\n-\t\t\ttry (PreparedStatement ps = con.prepareStatement(\"UPDATE accounts SET loggedin = ?, lastlogin = CURRENT_TIMESTAMP() WHERE id = ?\")) {\n+                        Connection con = DatabaseConnection.getConnection();\n+\t\t\ttry (PreparedStatement ps = con.prepareStatement(\"UPDATE accounts SET loggedin = ?, lastlogin = ? WHERE id = ?\")) {\n+                                // using sql currenttime here could potentially break the login, thanks Arnah for pointing this out\n+                            \n \t\t\t\tps.setInt(1, newstate);\n-\t\t\t\tps.setInt(2, getAccID());\n+                                ps.setTimestamp(2, new java.sql.Timestamp(Server.getInstance().getCurrentTime()));\n+\t\t\t\tps.setInt(3, getAccID());\n \t\t\t\tps.executeUpdate();\n \t\t\t}\n-                        \n                         con.close();\n \t\t} catch (SQLException e) {\n \t\t\te.printStackTrace();\n \t\t}\n \t\tif (newstate == LOGIN_NOTLOGGEDIN) {\n \t\t\tloggedIn = false;\n \t\t\tserverTransition = false;\n+                        setAccID(0);\n \t\t} else {\n \t\t\tserverTransition = (newstate == LOGIN_SERVER_TRANSITION);\n \t\t\tloggedIn = !serverTransition;\n@@ -756,9 +783,9 @@ public int getLoginState() {  // 0 = LOGIN_NOTLOGGEDIN, 1= LOGIN_SERVER_TRANSITI\n \t\t\t\n \t\t\tint state = rs.getInt(\"loggedin\");\n \t\t\tif (state == LOGIN_SERVER_TRANSITION) {\n-                                // Arnah's note: lastlogin is a date-type, in case of login and game servers being of different timezones this becomes broken\n-\t\t\t\tif (rs.getTimestamp(\"lastlogin\").getTime() + 30000 < System.currentTimeMillis()) {\n+\t\t\t\tif (rs.getTimestamp(\"lastlogin\").getTime() + 30000 < Server.getInstance().getCurrentTime()) {\n \t\t\t\t\tstate = LOGIN_NOTLOGGEDIN;\n+                                        MapleSessionCoordinator.getInstance().closeSession(session, null);\n \t\t\t\t\tupdateLoginState(LOGIN_NOTLOGGEDIN);\n \t\t\t\t}\n \t\t\t} else if (state == LOGIN_LOGGEDIN && player == null) {\n@@ -791,19 +818,45 @@ public boolean checkBirthDate(Calendar date) {\n                 return date.get(Calendar.YEAR) == birthday.get(Calendar.YEAR) && date.get(Calendar.MONTH) == birthday.get(Calendar.MONTH) && date.get(Calendar.DAY_OF_MONTH) == birthday.get(Calendar.DAY_OF_MONTH);\n \t}\n \n-\tprivate void removePlayer() {\n+        private void removePartyPlayer(World wserv) {\n+                MapleMap map = player.getMap();\n+                final MapleParty party = player.getParty();\n+                final int idz = player.getId();\n+                final MaplePartyCharacter chrp = new MaplePartyCharacter(player);\n+                \n+                if (party != null) {\n+                        chrp.setOnline(false);\n+                        wserv.updateParty(party.getId(), PartyOperation.LOG_ONOFF, chrp);\n+                        if (party.getLeader().getId() == idz && map != null) {\n+                                MaplePartyCharacter lchr = null;\n+                                for (MaplePartyCharacter pchr : party.getMembers()) {\n+                                        if (pchr != null && pchr.getId() != idz && (lchr == null || lchr.getLevel() <= pchr.getLevel()) && map.getCharacterById(pchr.getId()) != null) {\n+                                                lchr = pchr;\n+                                        }\n+                                }\n+                                if (lchr != null) {\n+                                        wserv.updateParty(party.getId(), PartyOperation.CHANGE_LEADER, lchr);\n+                                }\n+                        }\n+                }\n+        }\n+        \n+\tprivate void removePlayer(World wserv) {\n \t\ttry {\n                         player.setDisconnectedFromChannelWorld();\n                         player.notifyMapTransferToPartner(-1);\n                         player.cancelAllBuffs(true);\n                         \n                         player.closePlayerInteractions();\n                         QuestScriptManager.getInstance().dispose(this);\n-\t\t\t\n+                        \n+                        removePartyPlayer(wserv);\n+                        \n                         EventInstanceManager eim = player.getEventInstance();\n \t\t\tif (eim != null) {\n \t\t\t\teim.playerDisconnected(player);\n \t\t\t}\n+                        \n                         if (player.getMap() != null) {\n                                 int mapId = player.getMapId();\n                                 player.getMap().removePlayer(player);\n@@ -823,37 +876,33 @@ public final synchronized void disconnect(boolean shutdown, boolean cashshop) {/\n \t\t}\n \t\tdisconnecting = true;\n \t\tif (player != null && player.isLoggedin() && player.getClient() != null) {\n-                        MapleMap map = player.getMap();\n-\t\t\tfinal MapleParty party = player.getParty();\n-\t\t\tfinal int idz = player.getId();\n \t\t\tfinal int messengerid = player.getMessenger() == null ? 0 : player.getMessenger().getId();\n \t\t\t//final int fid = player.getFamilyId();\n \t\t\tfinal BuddyList bl = player.getBuddylist();\n-\t\t\tfinal MaplePartyCharacter chrp = new MaplePartyCharacter(player);\n \t\t\tfinal MapleMessengerCharacter chrm = new MapleMessengerCharacter(player, 0);\n \t\t\tfinal MapleGuildCharacter chrg = player.getMGC();\n \t\t\tfinal MapleGuild guild = player.getGuild();\n                         \n                         player.cancelMagicDoor();\n \n-                        final World wserv = getWorldServer();\n-\t\t\tif (channel == -1 || shutdown) {\n-                                if(chrg != null) chrg.setCharacter(null);\n-                                \n-                                if(wserv != null) wserv.removePlayer(player);\n-                                removePlayer();\n-                                \n-                                player.saveCooldowns();\n-                                player.cancelAllDebuffs();\n-                                player.saveCharToDB(true);\n-                                \n-                                clear();\n-                                return;\n-\t\t\t}\n-                        \n-                        removePlayer();\n-\t\t\t\n+                        final World wserv = getWorldServer();   // obviously wserv is NOT null if this player was online on it\n                         try {\n+                                if (channel == -1 || shutdown) {\n+                                        if(chrg != null) chrg.setCharacter(null);\n+\n+                                        wserv.removePlayer(player);\n+                                        removePlayer(wserv);\n+\n+                                        player.saveCooldowns();\n+                                        player.cancelAllDebuffs();\n+                                        player.saveCharToDB(true);\n+\n+                                        clear();\n+                                        return;\n+                                }\n+\n+                                removePlayer(wserv);\n+\t\t\t\n \t\t\t\tif (!cashshop) {\n \t\t\t\t\tif (!this.serverTransition) { // meaning not changing channels\n \t\t\t\t\t\tif (messengerid > 0) {\n@@ -878,42 +927,12 @@ public final synchronized void disconnect(boolean shutdown, boolean cashshop) {/\n \t\t\t\t\t\t\tserver.setGuildMemberOnline(player, false, player.getClient().getChannel());\n \t\t\t\t\t\t\tplayer.getClient().announce(MaplePacketCreator.showGuildInfo(player));\n \t\t\t\t\t\t}\n-\t\t\t\t\t\tif (party != null) {\n-\t\t\t\t\t\t\tchrp.setOnline(false);\n-\t\t\t\t\t\t\twserv.updateParty(party.getId(), PartyOperation.LOG_ONOFF, chrp);\n-\t\t\t\t\t\t\tif (map != null && party.getLeader().getId() == idz) {\n-\t\t\t\t\t\t\t\tMaplePartyCharacter lchr = null;\n-\t\t\t\t\t\t\t\tfor (MaplePartyCharacter pchr : party.getMembers()) {\n-\t\t\t\t\t\t\t\t\tif (pchr != null && map.getCharacterById(pchr.getId()) != null && (lchr == null || lchr.getLevel() <= pchr.getLevel())) {\n-\t\t\t\t\t\t\t\t\t\tlchr = pchr;\n-\t\t\t\t\t\t\t\t\t}\n-\t\t\t\t\t\t\t\t}\n-\t\t\t\t\t\t\t\tif (lchr != null) {\n-\t\t\t\t\t\t\t\t\twserv.updateParty(party.getId(), PartyOperation.CHANGE_LEADER, lchr);\n-\t\t\t\t\t\t\t\t}\n-\t\t\t\t\t\t\t}\n-\t\t\t\t\t\t}                   \n                                                 if (bl != null) {\n \t\t\t\t\t\t\twserv.loggedOff(player.getName(), player.getId(), channel, player.getBuddylist().getBuddyIds());\n \t\t\t\t\t\t}\n \t\t\t\t\t}\n \t\t\t\t} else {\n-\t\t\t\t\tif (!this.serverTransition) { // if dc inside of cash shop.\n-\t\t\t\t\t\tif (party != null) {\n-\t\t\t\t\t\t\tchrp.setOnline(false);\n-\t\t\t\t\t\t\twserv.updateParty(party.getId(), PartyOperation.LOG_ONOFF, chrp);\n-\t\t\t\t\t\t\tif (map != null && party.getLeader().getId() == idz) {\n-\t\t\t\t\t\t\t\tMaplePartyCharacter lchr = null;\n-\t\t\t\t\t\t\t\tfor (MaplePartyCharacter pchr : party.getMembers()) {\n-\t\t\t\t\t\t\t\t\tif (pchr != null && map.getCharacterById(pchr.getId()) != null && (lchr == null || lchr.getLevel() <= pchr.getLevel())) {\n-\t\t\t\t\t\t\t\t\t\tlchr = pchr;\n-\t\t\t\t\t\t\t\t\t}\n-\t\t\t\t\t\t\t\t}\n-\t\t\t\t\t\t\t\tif (lchr != null) {\n-\t\t\t\t\t\t\t\t\twserv.updateParty(party.getId(), PartyOperation.CHANGE_LEADER, lchr);\n-\t\t\t\t\t\t\t\t}\n-\t\t\t\t\t\t\t}\n-\t\t\t\t\t\t}\t                \n+\t\t\t\t\tif (!this.serverTransition) { // if dc inside of cash shop.\t                \n \t\t\t\t\t\tif (bl != null) {\n \t\t\t\t\t\t\twserv.loggedOff(player.getName(), player.getId(), channel, player.getBuddylist().getBuddyIds());\n \t\t\t\t\t\t}\n@@ -943,10 +962,10 @@ public final synchronized void disconnect(boolean shutdown, boolean cashshop) {/\n \t\t\t}\n \t\t}\n \t\tif (!serverTransition && isLoggedIn()) {\n+                        MapleSessionCoordinator.getInstance().closeSession(session, false);\n \t\t\tupdateLoginState(MapleClient.LOGIN_NOTLOGGEDIN);\n \t\t\tsession.removeAttribute(MapleClient.CLIENT_KEY); // prevents double dcing during login\n-\t\t\tsession.close(false);\n-                        \n+\t\t\t\n                         clear();\n \t\t} else {\n                         engines.clear();\n@@ -1026,7 +1045,9 @@ public void testPing(long timeThen) {\n                 try {\n                         if (lastPong < timeThen) {\n                                 if (session != null && session.isConnected()) {\n-                                        session.close(false);\n+                                        MapleSessionCoordinator.getInstance().closeSession(session, false);\n+                                        updateLoginState(MapleClient.LOGIN_NOTLOGGEDIN);\n+                                        session.removeAttribute(MapleClient.CLIENT_KEY);\n                                 }\n                         }\n                 } catch (NullPointerException e) {"}, {"sha": "874c9a36a62c26b964e2806bbf1b318c813271ac", "filename": "src/client/command/Command.java", "status": "added", "additions": 53, "deletions": 0, "changes": 53, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/Command.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/Command.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/Command.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,53 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command;\n+\n+import client.MapleClient;\n+\n+public abstract class Command {\n+\n+    protected String description;\n+\n+    public abstract void execute(MapleClient client, String[] params);\n+\n+    public String getDescription() {\n+        return description;\n+    }\n+\n+    protected void setDescription(String description) {\n+        this.description = description;\n+    }\n+\n+    protected String joinStringFrom(String arr[], int start) {\n+        StringBuilder builder = new StringBuilder();\n+        for (int i = start; i < arr.length; i++) {\n+            builder.append(arr[i]);\n+            if (i != arr.length - 1) {\n+                builder.append(\" \");\n+            }\n+        }\n+        return builder.toString();\n+    }\n+}\n+"}, {"sha": "566d1ea2d0c5562e2ecaead7638842cf311cfa0f", "filename": "src/client/command/Commands.java", "status": "removed", "additions": 0, "deletions": 3159, "changes": 3159, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/b5c68311298f80fcd49440f79a89051a2280ac6c/src/client/command/Commands.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/b5c68311298f80fcd49440f79a89051a2280ac6c/src/client/command/Commands.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/Commands.java?ref=b5c68311298f80fcd49440f79a89051a2280ac6c"}, {"sha": "438a074aaef1b5ea606be6c358ac7f04789ef480", "filename": "src/client/command/CommandsExecutor.java", "status": "added", "additions": 356, "deletions": 0, "changes": 356, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/CommandsExecutor.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/CommandsExecutor.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/CommandsExecutor.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,356 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command;\n+\n+import client.MapleClient;\n+import client.command.commands.v0.*;\n+import client.command.commands.v1.*;\n+import client.command.commands.v2.*;\n+import client.command.commands.v3.*;\n+import client.command.commands.v4.*;\n+import client.command.commands.v5.*;\n+import client.command.commands.v6.*;\n+import tools.FilePrinter;\n+import tools.Pair;\n+\n+import java.text.SimpleDateFormat;\n+import java.util.ArrayList;\n+import java.util.List;\n+import java.util.Arrays;\n+import java.util.Calendar;\n+import java.util.HashMap;\n+\n+public class CommandsExecutor {\n+    \n+    public static CommandsExecutor instance = new CommandsExecutor();\n+    \n+    public static CommandsExecutor getInstance() {\n+        return instance;\n+    }\n+    \n+    private static final char USER_HEADING = '@';\n+    private static final char GM_HEADING = '!';\n+    \n+    public static boolean isCommand(MapleClient client, String content){\n+        char heading = content.charAt(0);\n+        if (client.getPlayer().isGM()){\n+            return heading == USER_HEADING || heading == GM_HEADING;\n+        }\n+        return heading == USER_HEADING;\n+    }\n+\n+    private HashMap<String, RegisteredCommand> registeredCommands = new HashMap<>();\n+    private Pair<List<String>, List<String>> levelCommandsCursor;\n+    private List<Pair<List<String>, List<String>>> commandsNameDesc = new ArrayList<>();\n+\n+    private CommandsExecutor(){\n+        registerLv0Commands();\n+        registerLv1Commands();\n+        registerLv2Commands();\n+        registerLv3Commands();\n+        registerLv4Commands();\n+        registerLv5Commands();\n+        registerLv6Commands();\n+    }\n+\n+    public List<Pair<List<String>, List<String>>> getGmCommands() {\n+        return commandsNameDesc;\n+    }\n+    \n+    public void handle(MapleClient client, String message){\n+        final String[] spitedMessage = message.toLowerCase().substring(1).split(\"[ ]\");\n+        final String commandName = spitedMessage[0];\n+        final RegisteredCommand command = registeredCommands.get(commandName);\n+        if (command == null){\n+            client.getPlayer().yellowMessage(\"Command '\" + commandName + \"' is not available. See @commands for a list of available commands.\");\n+            return;\n+        }\n+        if (client.getPlayer().gmLevel() < command.getRank()){\n+            client.getPlayer().yellowMessage(\"You not have permission to use this command.\");\n+            return;\n+        }\n+        String[] params;\n+        if (spitedMessage.length > 1) {\n+             params = Arrays.copyOfRange(spitedMessage, 1, spitedMessage.length);\n+        } else {\n+            params = new String[]{};\n+        }\n+        try {\n+            Command commandInstance = command.getCommandClass().newInstance();\n+            commandInstance.execute(client, params);\n+            writeLog(client, message);\n+        } catch (InstantiationException e) {\n+            e.printStackTrace();\n+        } catch (IllegalAccessException e) {\n+            e.printStackTrace();\n+        }\n+\n+    }\n+\n+    private void writeLog(MapleClient client, String command){\n+        SimpleDateFormat sdf = new SimpleDateFormat(\"dd-MM-yyyy HH:mm\");\n+        FilePrinter.print(FilePrinter.USED_COMMANDS, client.getPlayer().getName() + \" used: \" + command + \" on \"\n+                + sdf.format(Calendar.getInstance().getTime()) + \"\\r\\n\");\n+    }\n+\n+    private void addCommandInfo(String name, Class<? extends Command> commandClass) {\n+        try {\n+            levelCommandsCursor.getRight().add(commandClass.newInstance().getDescription());\n+            levelCommandsCursor.getLeft().add(name);\n+        } catch(Exception e) {\n+            e.printStackTrace();\n+        }\n+    }\n+    \n+    private void addCommand(String[] syntaxs, Class<? extends Command> commandClass){\n+        for (String syntax : syntaxs){\n+            addCommand(syntax, 0, commandClass);\n+        }\n+    }\n+    private void addCommand(String syntax, Class<? extends Command> commandClass){\n+        //for (String syntax : syntaxs){\n+            addCommand(syntax, 0, commandClass);\n+        //}\n+    }\n+\n+    private void addCommand(String[] surtaxes, int rank, Class<? extends Command> commandClass){\n+        for (String syntax : surtaxes){\n+            addCommand(syntax, rank, commandClass);\n+        }\n+    }\n+\n+    private void addCommand(String syntax, int rank,  Class<? extends Command> commandClass){\n+        if (registeredCommands.containsKey(syntax.toLowerCase())){\n+            System.out.println(\"Error on register command with name: \" + syntax + \". Already exists.\");\n+            return;\n+        }\n+        \n+        RegisteredCommand registeredCommand = new RegisteredCommand(commandClass, rank);\n+        \n+        String commandName = syntax.toLowerCase();\n+        addCommandInfo(commandName, commandClass);\n+        registeredCommands.put(commandName, registeredCommand);\n+    }\n+\n+    private void registerLv0Commands(){\n+        levelCommandsCursor = new Pair<>((List<String>) new ArrayList<String>(), (List<String>) new ArrayList<String>());\n+        \n+        addCommand(new String[]{\"help\", \"commands\"}, HelpCommand.class);\n+        addCommand(\"droplimit\", DropLimitCommand.class);\n+        addCommand(\"time\", TimeCommand.class);\n+        addCommand(\"credits\", StaffCommand.class);\n+        addCommand(\"uptime\", UptimeCommand.class);\n+        addCommand(\"gacha\", GachaCommand.class);\n+        addCommand(\"dispose\", DisposeCommand.class);\n+        addCommand(\"equiplv\",  EquipLvCommand.class);\n+        addCommand(\"showrates\", ShowRatesCommand.class);\n+        addCommand(\"rates\", RatesCommand.class);\n+        addCommand(\"online\", OnlineCommand.class);\n+        addCommand(\"gm\", GmCommand.class);\n+        addCommand(\"reportbug\", ReportBugCommand.class);\n+        //addCommand(\"points\", \"\");\n+        addCommand(\"joinevent\", JoinEventCommand.class);\n+        addCommand(\"leaveevent\", LeaveEventCommand.class);\n+        addCommand(\"ranks\", RanksCommand.class);\n+        addCommand(\"str\", StatStrCommand.class);\n+        addCommand(\"dex\", StatDexCommand.class);\n+        addCommand(\"int\", StatIntCommand.class);\n+        addCommand(\"luk\", StatLukCommand.class);\n+        \n+        commandsNameDesc.add(levelCommandsCursor);\n+    }\n+\n+\n+    private void registerLv1Commands() {\n+        levelCommandsCursor = new Pair<>((List<String>) new ArrayList<String>(), (List<String>) new ArrayList<String>());\n+        \n+        addCommand(\"bosshp\", 1, BossHpCommand.class);\n+        addCommand(\"mobhp\", 1, MobHpCommand.class);\n+        addCommand(\"whatdropsfrom\", 1, WhatDropsFromCommand.class);\n+        addCommand(\"whodrops\", 1, WhoDropsCommand.class);\n+        addCommand(\"buffme\", 1, BuffMeCommand.class);\n+        addCommand(\"goto\", 1, GotoCommand.class);\n+        \n+        commandsNameDesc.add(levelCommandsCursor);\n+    }\n+\n+\n+    private void registerLv2Commands(){\n+        levelCommandsCursor = new Pair<>((List<String>) new ArrayList<String>(), (List<String>) new ArrayList<String>());\n+        \n+        addCommand(\"recharge\", 2, RechargeCommand.class);\n+        addCommand(\"whereami\", 2, WhereaMiCommand.class);\n+        addCommand(\"hide\", 2, HideCommand.class);\n+        addCommand(\"unhide\", 2, UnHideCommand.class);\n+        addCommand(\"sp\", 2, SpCommand.class);\n+        addCommand(\"ap\", 2, ApCommand.class);\n+        addCommand(\"empowerme\", 2, EmpowerMeCommand.class);\n+        addCommand(\"buffmap\", 2, BuffMapCommand.class);\n+        addCommand(\"buff\", 2, BuffCommand.class);\n+        addCommand(\"bomb\", 2, BombCommand.class);\n+        addCommand(\"dc\", 2, DcCommand.class);\n+        addCommand(\"cleardrops\", 2, ClearDropsCommand.class);\n+        addCommand(\"clearslot\", 2, ClearSlotCommand.class);\n+        addCommand(\"warp\", 2, WarpCommand.class);\n+        addCommand(\"warpto\", 2, WarpToCommand.class);\n+        addCommand(new String[]{\"warphere\", \"summon\"}, 2, SummonCommand.class);\n+        addCommand(new String[]{\"reach\", \"follow\"}, 2, ReachCommand.class);\n+        addCommand(\"gmshop\", 2, GmShopCommand.class);\n+        addCommand(\"heal\", 2, HealCommand.class);\n+        addCommand(\"item\", 2, ItemCommand.class);\n+        addCommand(\"drop\", 2, ItemDropCommand.class);\n+        addCommand(\"level\", 2, LevelCommand.class);\n+        addCommand(\"levelpro\", 2, LevelProCommand.class);\n+        addCommand(\"setstat\", 2, SetStatCommand.class);\n+        addCommand(\"maxstat\", 2, MaxStatCommand.class);\n+        addCommand(\"maxskill\", 2, MaxSkillCommand.class);\n+        addCommand(\"resetskill\", 2, ResetSkillCommand.class);\n+        addCommand(\"mesos\", 2, MesosCommand.class);\n+        addCommand(\"search\", 2, SearchCommand.class);\n+        addCommand(\"jail\", 2, JailCommand.class);\n+        addCommand(\"unjail\", 2, UnJailCommand.class);\n+        addCommand(\"job\", 2, JobCommand.class);\n+        addCommand(\"unbug\", 2, UnBugCommand.class);\n+        \n+        commandsNameDesc.add(levelCommandsCursor);\n+    }\n+\n+    private void registerLv3Commands() {\n+        levelCommandsCursor = new Pair<>((List<String>) new ArrayList<String>(), (List<String>) new ArrayList<String>());\n+        \n+        addCommand(\"debuff\", 3, DebuffCommand.class);\n+        addCommand(\"fly\", 3, FlyCommand.class);\n+        addCommand(\"spawn\", 3, SpawnCommand.class);\n+        addCommand(\"mutemap\", 3, MuteMapCommand.class);\n+        addCommand(\"checkdmg\", 3, CheckDmgCommand.class);\n+        addCommand(\"inmap\", 3, InMapCommand.class);\n+        addCommand(\"reloadevents\", 3, ReloadEventsCommand.class);\n+        addCommand(\"reloaddrops\", 3, ReloadDropsCommand.class);\n+        addCommand(\"reloadportals\", 3, ReloadPortalsCommand.class);\n+        addCommand(\"reloadmap\", 3, ReloadMapCommand.class);\n+        addCommand(\"reloadshops\", 3, ReloadShopsCommand.class);\n+        addCommand(\"hpmp\", 3, HpMpCommand.class);\n+        addCommand(\"maxhpmp\", 3, MaxHpMpCommand.class);\n+        addCommand(\"music\", 3, MusicCommand.class);\n+        addCommand(\"monitor\", 3, MonitorCommand.class);\n+        addCommand(\"monitors\", 3, MonitorsCommand.class);\n+        addCommand(\"ignore\", 3, IgnoreCommand.class);\n+        addCommand(\"ignored\", 3, IgnoredCommand.class);\n+        addCommand(\"pos\", 3, PosCommand.class);\n+        addCommand(\"togglecoupon\", 3, ToggleCouponCommand.class);\n+        addCommand(\"chat\", 3, ChatCommand.class);\n+        addCommand(\"fame\", 3, FameCommand.class);\n+        addCommand(\"givenx\", 3, GiveNxCommand.class);\n+        addCommand(\"givevp\", 3, GiveVpCommand.class);\n+        addCommand(\"givems\", 3, GiveMesosCommand.class);\n+        addCommand(\"id\", 3, IdCommand.class);\n+        addCommand(\"expeds\", 3, ExpedsCommand.class);\n+        addCommand(\"kill\", 3, KillCommand.class);\n+        addCommand(\"seed\", 3, SeedCommand.class);\n+        addCommand(\"maxenergy\", 3, MaxEnergyCommand.class);\n+        addCommand(\"killall\", 3, KillAllCommand.class);\n+        addCommand(\"notice\", 3, NoticeCommand.class);\n+        addCommand(\"rip\", 3, RipCommand.class);\n+        addCommand(\"openportal\", 3, OpenPortalCommand.class);\n+        addCommand(\"closeportal\", 3, ClosePortalCommand.class);\n+        addCommand(\"pe\", 3, PeCommand.class);\n+        addCommand(\"startevent\", 3, StartEventCommand.class);\n+        addCommand(\"endevent\", 3, EndEventCommand.class);\n+        addCommand(\"online2\", 3, OnlineTwoCommand.class);\n+        addCommand(\"warpsnowball\", 3, WarpSnowBallCommand.class);\n+        addCommand(\"ban\", 3, BanCommand.class);\n+        addCommand(\"unban\", 3, UnBanCommand.class);\n+        addCommand(\"healmap\", 3, HealMapCommand.class);\n+        addCommand(\"healperson\", 3, HealPersonCommand.class);\n+        addCommand(\"hurt\", 3, HurtCommand.class);\n+        addCommand(\"killmap\", 3, KillMapCommand.class);\n+        addCommand(\"night\", 3, NightCommand.class);\n+        addCommand(\"npc\", 3, NpcCommand.class);\n+        addCommand(\"face\", 3, FaceCommand.class);\n+        addCommand(\"hair\", 3, HairCommand.class);\n+        addCommand(\"startquest\", 3, QuestStartCommand.class);\n+        addCommand(\"completequest\", 3, QuestCompleteCommand.class);\n+        addCommand(\"resetquest\", 3, QuestResetCommand.class);\n+        \n+        commandsNameDesc.add(levelCommandsCursor);\n+    }\n+\n+    private void registerLv4Commands(){\n+        levelCommandsCursor = new Pair<>((List<String>) new ArrayList<String>(), (List<String>) new ArrayList<String>());\n+        \n+        addCommand(\"servermessage\", 4, ServerMessageCommand.class);\n+        addCommand(\"proitem\", 4, ProItemCommand.class);\n+        addCommand(\"seteqstat\", 4, SetQStatCommand.class);\n+        addCommand(\"exprate\", 4, ExpRateCommand.class);\n+        addCommand(\"mesorate\", 4, MesoRateCommand.class);\n+        addCommand(\"droprate\", 4, DropRateCommand.class);\n+        addCommand(\"questrate\", 4, QuestRateCommand.class);\n+        addCommand(\"travelrate\", 4, TravelRateCommand.class);\n+        addCommand(\"itemvac\", 4, ItemVacCommand.class);\n+        addCommand(\"forcevac\", 4, ForceVacCommand.class);\n+        addCommand(\"zakum\", 4, ZakumCommand.class);\n+        addCommand(\"horntail\", 4, HorntailCommand.class);\n+        addCommand(\"pinkbean\", 4, PinkbeanCommand.class);\n+        addCommand(\"pap\", 4, PapCommand.class);\n+        addCommand(\"pianus\", 4, PianusCommand.class);\n+        addCommand(\"cake\", 4, CakeCommand.class);\n+        addCommand(\"playernpcremove\", 4, PlayerNpcRemoveCommand.class);\n+        addCommand(\"playernpc\", 4, PlayerNpcCommand.class);\n+        \n+        commandsNameDesc.add(levelCommandsCursor);\n+    }\n+\n+    private void registerLv5Commands(){\n+        levelCommandsCursor = new Pair<>((List<String>) new ArrayList<String>(), (List<String>) new ArrayList<String>());\n+        \n+        addCommand(\"debug\", 5, DebugCommand.class);\n+        addCommand(\"set\", 5, SetCommand.class);\n+        addCommand(\"showpackets\", 5, ShowPacketsCommand.class);\n+        \n+        commandsNameDesc.add(levelCommandsCursor);\n+    }\n+\n+    private void registerLv6Commands(){\n+        levelCommandsCursor = new Pair<>((List<String>) new ArrayList<String>(), (List<String>) new ArrayList<String>());\n+        \n+        addCommand(\"setgmlevel\", 6, SetGmLevelCommand.class);\n+        addCommand(\"warpworld\", 6, WarpWorldCommand.class);\n+        addCommand(\"saveall\", 6, SaveAllCommand.class);\n+        addCommand(\"dcall\", 6, DCAllCommand.class);\n+        addCommand(\"mapplayers\", 6, MapPlayersCommand.class);\n+        addCommand(\"getacc\", 6, GetAccCommand.class);\n+        addCommand(\"shutdown\", 6, ShutdownCommand.class);\n+        addCommand(\"clearquestcache\", 6, ClearQuestCacheCommand.class);\n+        addCommand(\"clearquest\", 6, ClearQuestCommand.class);\n+        addCommand(\"spawnallpnpcs\", 6, SpawnAllPNpcsCommand.class);\n+        addCommand(\"eraseallpnpcs\", 6, EraseAllPNpcsCommand.class);\n+        addCommand(\"addchannel\", 6, ServerAddChannelCommand.class);\n+        addCommand(\"addworld\", 6, ServerAddWorldCommand.class);\n+        addCommand(\"removechannel\", 6, ServerRemoveChannelCommand.class);\n+        addCommand(\"removeworld\", 6, ServerRemoveWorldCommand.class);\n+        \n+        commandsNameDesc.add(levelCommandsCursor);\n+    }\n+\n+}"}, {"sha": "6bbe94e184d5705917bda419a1b19bc61971f201", "filename": "src/client/command/RegisteredCommand.java", "status": "added", "additions": 43, "deletions": 0, "changes": 43, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/RegisteredCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/RegisteredCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/RegisteredCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,43 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command;\n+\n+class RegisteredCommand {\n+\n+    private final Class<? extends Command> commandClass;\n+    private final int rank;\n+\n+    RegisteredCommand(Class<? extends Command> commandClass, int rank){\n+        this.commandClass = commandClass;\n+        this.rank = rank;\n+    }\n+\n+    public Class<? extends Command> getCommandClass() {\n+        return commandClass;\n+    }\n+\n+    public int getRank() {\n+        return rank;\n+    }\n+}"}, {"sha": "d895a763d631bfe26342fc1308d2f189ce0fa2f4", "filename": "src/client/command/commands/v0/BuyBackCommand.java", "status": "added", "additions": 35, "deletions": 0, "changes": 35, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v0/BuyBackCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v0/BuyBackCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v0/BuyBackCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,35 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v0;\n+\n+import client.MapleClient;\n+import client.command.Command;\n+import client.processor.BuybackProcessor;\n+\n+public class BuyBackCommand extends Command {\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        BuybackProcessor.processBuyback(c);\n+    }\n+}"}, {"sha": "1500a39cb4a0562cd08e9689de39c1502f2bf3a2", "filename": "src/client/command/commands/v0/DisposeCommand.java", "status": "added", "additions": 43, "deletions": 0, "changes": 43, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v0/DisposeCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v0/DisposeCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v0/DisposeCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,43 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v0;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import scripting.npc.NPCScriptManager;\n+import tools.MaplePacketCreator;\n+\n+public class DisposeCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        NPCScriptManager.getInstance().dispose(c);\n+        c.announce(MaplePacketCreator.enableActions());\n+        c.removeClickedNPC();\n+        c.getPlayer().message(\"You've been disposed.\");\n+    }\n+}"}, {"sha": "17017a1c99a800f3580e064e77914aa9fcb30aed", "filename": "src/client/command/commands/v0/DropLimitCommand.java", "status": "added", "additions": 45, "deletions": 0, "changes": 45, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v0/DropLimitCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v0/DropLimitCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v0/DropLimitCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,45 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v0;\n+\n+import client.MapleClient;\n+import client.command.Command;\n+import constants.ServerConstants;\n+\n+public class DropLimitCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+    \n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        int dropCount = c.getPlayer().getMap().getDroppedItemCount();\n+        if(((float) dropCount) / ServerConstants.ITEM_LIMIT_ON_MAP < 0.75f) {\n+            c.getPlayer().showHint(\"Current drop count: #b\" + dropCount + \"#k / #e\" + ServerConstants.ITEM_LIMIT_ON_MAP + \"#n\", 300);\n+        } else {\n+            c.getPlayer().showHint(\"Current drop count: #r\" + dropCount + \"#k / #e\" + ServerConstants.ITEM_LIMIT_ON_MAP + \"#n\", 300);\n+        }\n+\n+    }\n+}"}, {"sha": "8c87869b4b47d210b0c0139df9ed866c04f78ec4", "filename": "src/client/command/commands/v0/EquipLvCommand.java", "status": "added", "additions": 38, "deletions": 0, "changes": 38, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v0/EquipLvCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v0/EquipLvCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v0/EquipLvCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,38 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v0;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+\n+public class EquipLvCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        c.getPlayer().showAllEquipFeatures();\n+    }\n+}"}, {"sha": "bd24795dfabac609eefacdf5faeb38f8f66045ee", "filename": "src/client/command/commands/v0/GachaCommand.java", "status": "added", "additions": 66, "deletions": 0, "changes": 66, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v0/GachaCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v0/GachaCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v0/GachaCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,66 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v0;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import server.MapleItemInformationProvider;\n+import server.gachapon.MapleGachapon;\n+import tools.MaplePacketCreator;\n+\n+public class GachaCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleGachapon.Gachapon gacha = null;\n+        String search = joinStringFrom(params,0);\n+        String gachaName = \"\";\n+        String [] names = {\"Henesys\", \"Ellinia\", \"Perion\", \"Kerning City\", \"Sleepywood\", \"Mushroom Shrine\", \"Showa Spa Male\", \"Showa Spa Female\", \"New Leaf City\", \"Nautilus Harbor\"};\n+        int [] ids = {9100100, 9100101, 9100102, 9100103, 9100104, 9100105, 9100106, 9100107, 9100109, 9100117};\n+        for (int i = 0; i < names.length; i++){\n+            if (search.equalsIgnoreCase(names[i])){\n+                gachaName = names[i];\n+                gacha = MapleGachapon.Gachapon.getByNpcId(ids[i]);\n+            }\n+        }\n+        if (gacha == null){\n+            c.getPlayer().yellowMessage(\"Please use @gacha <name> where name corresponds to one of the below:\");\n+            for (String name : names){\n+                c.getPlayer().yellowMessage(name);\n+            }\n+            return;\n+        }\n+        String talkStr = \"The #b\" + gachaName + \"#k Gachapon contains the following items.\\r\\n\\r\\n\";\n+        for (int i = 0; i < 2; i++){\n+            for (int id : gacha.getItems(i)){\n+                talkStr += \"-\" + MapleItemInformationProvider.getInstance().getName(id) + \"\\r\\n\";\n+            }\n+        }\n+        talkStr += \"\\r\\nPlease keep in mind that there are items that are in all gachapons and are not listed here.\";\n+        c.announce(MaplePacketCreator.getNPCTalk(9010000, (byte) 0, talkStr, \"00 00\", (byte) 0));\n+    }\n+}"}, {"sha": "4d451cc639b05702565882fa0446255d62666f86", "filename": "src/client/command/commands/v0/GmCommand.java", "status": "added", "additions": 60, "deletions": 0, "changes": 60, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v0/GmCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v0/GmCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v0/GmCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,60 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v0;\n+\n+import client.MapleCharacter;\n+import client.command.Command;\n+import client.MapleClient;\n+import net.server.Server;\n+import tools.FilePrinter;\n+import tools.MaplePacketCreator;\n+import tools.Randomizer;\n+\n+public class GmCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        String[] tips = {\n+                \"Please only use @gm in emergencies or to report somebody.\",\n+                \"To report a bug or make a suggestion, use the forum.\",\n+                \"Please do not use @gm to ask if a GM is online.\",\n+                \"Do not ask if you can receive help, just state your issue.\",\n+                \"Do not say 'I have a bug to report', just state it.\",\n+        };\n+        MapleCharacter player = c.getPlayer();\n+        if (params[0].length() < 3) { // #goodbye 'hi'\n+            player.dropMessage(5, \"Your message was too short. Please provide as much detail as possible.\");\n+            return;\n+        }\n+        String message = joinStringFrom(params, 0);\n+        Server.getInstance().broadcastGMMessage(c.getWorld(), MaplePacketCreator.sendYellowTip(\"[GM MESSAGE]:\" + MapleCharacter.makeMapleReadable(player.getName()) + \": \" + message));\n+        Server.getInstance().broadcastGMMessage(c.getWorld(), MaplePacketCreator.serverNotice(1, message));\n+        FilePrinter.printError(\"gm.txt\", MapleCharacter.makeMapleReadable(player.getName()) + \": \" + message + \"\\r\\n\");\n+        player.dropMessage(5, \"Your message '\" + message + \"' was sent to GMs.\");\n+        player.dropMessage(5, tips[Randomizer.nextInt(tips.length)]);\n+    }\n+}"}, {"sha": "ac409b400e1cc062872a6f51c8d7b330b828ee44", "filename": "src/client/command/commands/v0/HelpCommand.java", "status": "added", "additions": 38, "deletions": 0, "changes": 38, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v0/HelpCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v0/HelpCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v0/HelpCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,38 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v0;\n+\n+import client.MapleClient;\n+import client.command.Command;\n+\n+public class HelpCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient client, String[] params) {\n+        client.getAbstractPlayerInteraction().openNpc(9201143, \"commands\");\n+    }\n+}"}, {"sha": "a652918082e871327d7a12b0fd490224690b0487", "filename": "src/client/command/commands/v0/JoinEventCommand.java", "status": "added", "additions": 66, "deletions": 0, "changes": 66, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v0/JoinEventCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v0/JoinEventCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v0/JoinEventCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,66 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v0;\n+\n+import client.MapleCharacter;\n+import client.command.Command;\n+import client.MapleClient;\n+import server.events.gm.MapleEvent;\n+import server.maps.FieldLimit;\n+\n+public class JoinEventCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if(!FieldLimit.CANNOTMIGRATE.check(player.getMap().getFieldLimit())) {\n+            MapleEvent event = c.getChannelServer().getEvent();\n+            if(event != null) {\n+                if(event.getMapId() != player.getMapId()) {\n+                    if(event.getLimit() > 0) {\n+                        player.saveLocation(\"EVENT\");\n+\n+                        if(event.getMapId() == 109080000 || event.getMapId() == 109060001)\n+                            player.setTeam(event.getLimit() % 2);\n+\n+                        event.minusLimit();\n+\n+                        player.changeMap(event.getMapId());\n+                    } else {\n+                        player.dropMessage(5, \"The limit of players for the event has already been reached.\");\n+                    }\n+                } else {\n+                    player.dropMessage(5, \"You are already in the event.\");\n+                }\n+            } else {\n+                player.dropMessage(5, \"There is currently no event in progress.\");\n+            }\n+        } else {\n+            player.dropMessage(5, \"You are currently in a map where you can't join an event.\");\n+        }\n+    }\n+}"}, {"sha": "b588bc692c51888fc1b4c5b486fb6a2324ba8e9d", "filename": "src/client/command/commands/v0/LeaveEventCommand.java", "status": "added", "additions": 58, "deletions": 0, "changes": 58, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v0/LeaveEventCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v0/LeaveEventCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v0/LeaveEventCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,58 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v0;\n+\n+import client.MapleCharacter;\n+import client.command.Command;\n+import client.MapleClient;\n+\n+public class LeaveEventCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        int returnMap = player.getSavedLocation(\"EVENT\");\n+        if(returnMap != -1) {\n+            if(player.getOla() != null) {\n+                player.getOla().resetTimes();\n+                player.setOla(null);\n+            }\n+            if(player.getFitness() != null) {\n+                player.getFitness().resetTimes();\n+                player.setFitness(null);\n+            }\n+\n+            player.changeMap(returnMap);\n+            if(c.getChannelServer().getEvent() != null) {\n+                c.getChannelServer().getEvent().addLimit();\n+            }\n+        } else {\n+            player.dropMessage(5, \"You are not currently in an event.\");\n+        }\n+\n+    }\n+}"}, {"sha": "847d10ba111c8a496d93164d25d2957a76d59b61", "filename": "src/client/command/commands/v0/OnlineCommand.java", "status": "added", "additions": 49, "deletions": 0, "changes": 49, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v0/OnlineCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v0/OnlineCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v0/OnlineCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,49 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v0;\n+\n+import client.MapleCharacter;\n+import client.command.Command;\n+import client.MapleClient;\n+import net.server.Server;\n+import net.server.channel.Channel;\n+\n+public class OnlineCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        for (Channel ch : Server.getInstance().getChannelsFromWorld(player.getWorld())) {\n+            player.yellowMessage(\"Players in Channel \" + ch.getId() + \":\");\n+            for (MapleCharacter chr : ch.getPlayerStorage().getAllCharacters()) {\n+                if (!chr.isGM()) {\n+                    player.message(\" >> \" + MapleCharacter.makeMapleReadable(chr.getName()) + \" is at \" + chr.getMap().getMapName() + \".\");\n+                }\n+            }\n+        }\n+    }\n+}"}, {"sha": "b2445731af3a478ab825c9b8f2b11be8318b6f14", "filename": "src/client/command/commands/v0/RanksCommand.java", "status": "added", "additions": 47, "deletions": 0, "changes": 47, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v0/RanksCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v0/RanksCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v0/RanksCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,47 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v0;\n+\n+import client.MapleCharacter;\n+import client.command.Command;\n+import client.MapleClient;\n+import net.server.Server;\n+import tools.MaplePacketCreator;\n+\n+import java.util.List;\n+import tools.Pair;\n+\n+public class RanksCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        \n+        List<Pair<String, Integer>> worldRanking = Server.getInstance().getWorldPlayerRanking(player.getWorld());\n+        player.announce(MaplePacketCreator.showPlayerRanks(9010000, worldRanking));\n+    }\n+}"}, {"sha": "4840c3d15c56e7598d6d2c33e2d95a076b0e4e5b", "filename": "src/client/command/commands/v0/RatesCommand.java", "status": "added", "additions": 49, "deletions": 0, "changes": 49, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v0/RatesCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v0/RatesCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v0/RatesCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,49 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v0;\n+\n+import client.MapleCharacter;\n+import client.command.Command;\n+import client.MapleClient;\n+import constants.ServerConstants;\n+\n+public class RatesCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        \n+        // travel rates not applicable since it's intrinsically a server/environment rate rather than a character rate\n+        String showMsg_ = \"#eCHARACTER RATES#n\" + \"\\r\\n\\r\\n\";\n+        showMsg_ += \"EXP Rate: #e#b\" + player.getExpRate() + \"x#k#n\" + \"\\r\\n\";\n+        showMsg_ += \"MESO Rate: #e#b\" + player.getMesoRate() + \"x#k#n\" + \"\\r\\n\";\n+        showMsg_ += \"DROP Rate: #e#b\" + player.getDropRate() + \"x#k#n\" + \"\\r\\n\";\n+        if(ServerConstants.USE_QUEST_RATE) showMsg_ += \"QUEST Rate: #e#b\" + c.getWorldServer().getQuestRate() + \"x#k#n\" + \"\\r\\n\";\n+\n+        player.showHint(showMsg_, 300);\n+    }\n+}"}, {"sha": "1ab77f8653f65e314814048cfdd070e9bca4bef0", "filename": "src/client/command/commands/v0/ReportBugCommand.java", "status": "added", "additions": 53, "deletions": 0, "changes": 53, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v0/ReportBugCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v0/ReportBugCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v0/ReportBugCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,53 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v0;\n+\n+import client.MapleCharacter;\n+import client.command.Command;\n+import client.MapleClient;\n+import net.server.Server;\n+import tools.FilePrinter;\n+import tools.MaplePacketCreator;\n+\n+public class ReportBugCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+\n+        if (params.length < 1) {\n+            player.dropMessage(5, \"Message too short and not sent. Please do @bug <bug>\");\n+            return;\n+        }\n+        String message = joinStringFrom(params, 0);\n+        Server.getInstance().broadcastGMMessage(c.getWorld(), MaplePacketCreator.sendYellowTip(\"[BUG]:\" + MapleCharacter.makeMapleReadable(player.getName()) + \": \" + message));\n+        Server.getInstance().broadcastGMMessage(c.getWorld(), MaplePacketCreator.serverNotice(1, message));\n+        FilePrinter.printError(\"bug.txt\", MapleCharacter.makeMapleReadable(player.getName()) + \": \" + message + \"\\r\\n\");\n+        player.dropMessage(5, \"Your bug '\" + message + \"' was submitted successfully to our developers. Thank you!\");\n+\n+    }\n+}"}, {"sha": "7bddad2b14b865a05619af81b49ebf6407d1b1d7", "filename": "src/client/command/commands/v0/ShowRatesCommand.java", "status": "added", "additions": 67, "deletions": 0, "changes": 67, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v0/ShowRatesCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v0/ShowRatesCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v0/ShowRatesCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,67 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v0;\n+\n+import client.MapleCharacter;\n+import client.command.Command;\n+import client.MapleClient;\n+import constants.ServerConstants;\n+\n+public class ShowRatesCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        String showMsg = \"#eEXP RATE#n\" + \"\\r\\n\";\n+        showMsg += \"Server EXP Rate: #k\" + c.getWorldServer().getExpRate() + \"x#k\" + \"\\r\\n\";\n+        showMsg += \"Player EXP Rate: #k\" + player.getRawExpRate() + \"x#k\" + \"\\r\\n\";\n+        if(player.getCouponExpRate() != 1) showMsg += \"Coupon EXP Rate: #k\" + player.getCouponExpRate() + \"x#k\" + \"\\r\\n\";\n+        showMsg += \"EXP Rate: #e#b\" + player.getExpRate() + \"x#k#n\" + \"\\r\\n\";\n+\n+        showMsg += \"\\r\\n\" + \"#eMESO RATE#n\" + \"\\r\\n\";\n+        showMsg += \"Server MESO Rate: #k\" + c.getWorldServer().getMesoRate() + \"x#k\" + \"\\r\\n\";\n+        showMsg += \"Player MESO Rate: #k\" + player.getRawMesoRate() + \"x#k\" + \"\\r\\n\";\n+        if(player.getCouponMesoRate() != 1) showMsg += \"Coupon MESO Rate: #k\" + player.getCouponMesoRate() + \"x#k\" + \"\\r\\n\";\n+        showMsg += \"MESO Rate: #e#b\" + player.getMesoRate() + \"x#k#n\" + \"\\r\\n\";\n+\n+        showMsg += \"\\r\\n\" + \"#eDROP RATE#n\" + \"\\r\\n\";\n+        showMsg += \"Server DROP Rate: #k\" + c.getWorldServer().getDropRate() + \"x#k\" + \"\\r\\n\";\n+        showMsg += \"Player DROP Rate: #k\" + player.getRawDropRate() + \"x#k\" + \"\\r\\n\";\n+        if(player.getCouponDropRate() != 1) showMsg += \"Coupon DROP Rate: #k\" + player.getCouponDropRate() + \"x#k\" + \"\\r\\n\";\n+        showMsg += \"DROP Rate: #e#b\" + player.getDropRate() + \"x#k#n\" + \"\\r\\n\";\n+\n+        if(ServerConstants.USE_QUEST_RATE) {\n+            showMsg += \"\\r\\n\" + \"#eQUEST RATE#n\" + \"\\r\\n\";\n+            showMsg += \"Server QUEST Rate: #e#b\" + c.getWorldServer().getQuestRate() + \"x#k#n\" + \"\\r\\n\";\n+        }\n+        \n+        showMsg += \"\\r\\n\" + \"#eTRAVEL RATE#n\" + \"\\r\\n\";\n+        showMsg += \"Server TRAVEL Rate: #e#b\" + c.getWorldServer().getTravelRate() + \"x#k#n\" + \"\\r\\n\";\n+\n+        player.showHint(showMsg, 300);\n+    }\n+}"}, {"sha": "1db3a7acf8261c9a224fba6a2549c8d4c89bcd14", "filename": "src/client/command/commands/v0/StaffCommand.java", "status": "added", "additions": 38, "deletions": 0, "changes": 38, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v0/StaffCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v0/StaffCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v0/StaffCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,38 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v0;\n+\n+import client.MapleClient;\n+import client.command.Command;\n+\n+public class StaffCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        c.getAbstractPlayerInteraction().openNpc(2010007, \"credits\");\n+    }\n+}"}, {"sha": "3154f802960c7c69c9ce1be4b13be9aeb4a4e32c", "filename": "src/client/command/commands/v0/StatDexCommand.java", "status": "added", "additions": 57, "deletions": 0, "changes": 57, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v0/StatDexCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v0/StatDexCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v0/StatDexCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,57 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v0;\n+\n+import client.MapleCharacter;\n+import client.MapleClient;\n+import client.MapleStat;\n+import client.command.Command;\n+\n+public class StatDexCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        int remainingAp = player.getRemainingAp();\n+\n+        int amount = (params.length > 0) ? Math.min(Integer.parseInt(params[0]), remainingAp) : remainingAp;\n+        if (amount > 0 && amount <= remainingAp && amount <= 32763) {\n+            int playerStat = player.getDex();\n+            \n+            if (amount + playerStat <= 32767 && amount + playerStat >= 4) {\n+                player.setDex(playerStat + amount);\n+                player.updateSingleStat(MapleStat.DEX, playerStat);\n+                player.setRemainingAp(remainingAp - amount);\n+                player.updateSingleStat(MapleStat.AVAILABLEAP, remainingAp);\n+            } else {\n+                player.dropMessage(\"Please make sure the stat you are trying to raise is not over 32,767 or under 4.\");\n+            }\n+        } else {\n+            player.dropMessage(\"Please make sure your AP is not over 32,767 and you have enough to distribute.\");\n+        }\n+    }\n+}"}, {"sha": "be1d310d7015d4ae88c0549cead2c62e737cf542", "filename": "src/client/command/commands/v0/StatIntCommand.java", "status": "added", "additions": 57, "deletions": 0, "changes": 57, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v0/StatIntCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v0/StatIntCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v0/StatIntCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,57 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v0;\n+\n+import client.MapleStat;\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+\n+public class StatIntCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        int remainingAp = player.getRemainingAp();\n+\n+        int amount = (params.length > 0) ? Math.min(Integer.parseInt(params[0]), remainingAp) : remainingAp;\n+        if (amount > 0 && amount <= remainingAp && amount <= 32763) {\n+            int playerStat = player.getInt();\n+            \n+            if (amount + playerStat <= 32767 && amount + playerStat >= 4) {\n+                player.setInt(playerStat + amount);\n+                player.updateSingleStat(MapleStat.INT, playerStat);\n+                player.setRemainingAp(remainingAp - amount);\n+                player.updateSingleStat(MapleStat.AVAILABLEAP, remainingAp);\n+            } else {\n+                player.dropMessage(\"Please make sure the stat you are trying to raise is not over 32,767 or under 4.\");\n+            }\n+        } else {\n+            player.dropMessage(\"Please make sure your AP is not over 32,767 and you have enough to distribute.\");\n+        }\n+    }\n+}"}, {"sha": "5754fbd78f2c83dd331389fab791db53d8771890", "filename": "src/client/command/commands/v0/StatLukCommand.java", "status": "added", "additions": 57, "deletions": 0, "changes": 57, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v0/StatLukCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v0/StatLukCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v0/StatLukCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,57 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v0;\n+\n+import client.MapleCharacter;\n+import client.MapleClient;\n+import client.MapleStat;\n+import client.command.Command;\n+\n+public class StatLukCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        int remainingAp = player.getRemainingAp();\n+\n+        int amount = (params.length > 0) ? Math.min(Integer.parseInt(params[0]), remainingAp) : remainingAp;\n+        if (amount > 0 && amount <= remainingAp && amount <= 32763) {\n+            int playerStat = player.getLuk();\n+            \n+            if (amount + playerStat <= 32767 && amount + playerStat >= 4) {\n+                player.setLuk(playerStat + amount);\n+                player.updateSingleStat(MapleStat.LUK, playerStat);\n+                player.setRemainingAp(remainingAp - amount);\n+                player.updateSingleStat(MapleStat.AVAILABLEAP, remainingAp);\n+            } else {\n+                player.dropMessage(\"Please make sure the stat you are trying to raise is not over 32,767 or under 4.\");\n+            }\n+        } else {\n+            player.dropMessage(\"Please make sure your AP is not over 32,767 and you have enough to distribute.\");\n+        }\n+    }\n+}"}, {"sha": "da81e7e7b6af6f62ef9a70857b3cb2122af2e80b", "filename": "src/client/command/commands/v0/StatStrCommand.java", "status": "added", "additions": 57, "deletions": 0, "changes": 57, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v0/StatStrCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v0/StatStrCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v0/StatStrCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,57 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v0;\n+\n+import client.MapleStat;\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+\n+public class StatStrCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        int remainingAp = player.getRemainingAp();\n+\n+        int amount = (params.length > 0) ? Math.min(Integer.parseInt(params[0]), remainingAp) : remainingAp;\n+        if (amount > 0 && amount <= remainingAp && amount <= 32763) {\n+            int playerStat = player.getStr();\n+            \n+            if (amount + playerStat <= 32767 && amount + playerStat >= 4) {\n+                player.setStr(playerStat + amount);\n+                player.updateSingleStat(MapleStat.STR, playerStat);\n+                player.setRemainingAp(remainingAp - amount);\n+                player.updateSingleStat(MapleStat.AVAILABLEAP, remainingAp);\n+            } else {\n+                player.dropMessage(\"Please make sure the stat you are trying to raise is not over 32,767 or under 4.\");\n+            }\n+        } else {\n+            player.dropMessage(\"Please make sure your AP is not over 32,767 and you have enough to distribute.\");\n+        }\n+    }\n+}"}, {"sha": "a7e2fd87cb15f369f49331de8f94602c03e0891e", "filename": "src/client/command/commands/v0/TimeCommand.java", "status": "added", "additions": 46, "deletions": 0, "changes": 46, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v0/TimeCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v0/TimeCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v0/TimeCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,46 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v0;\n+\n+import client.MapleClient;\n+import client.command.Command;\n+import constants.ServerConstants;\n+\n+import java.text.DateFormat;\n+import java.text.SimpleDateFormat;\n+import java.util.Date;\n+import java.util.TimeZone;\n+\n+public class TimeCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+    \n+    @Override\n+    public void execute(MapleClient client, String[] params) {\n+        DateFormat dateFormat = new SimpleDateFormat(\"HH:mm:ss\");\n+        dateFormat.setTimeZone(TimeZone.getTimeZone(ServerConstants.TIMEZONE));\n+        client.getPlayer().yellowMessage(\"HeavenMS Server Time: \" + dateFormat.format(new Date()));\n+    }\n+}"}, {"sha": "966135b0bf4135aa3f6989d935eed4777a972039", "filename": "src/client/command/commands/v0/UptimeCommand.java", "status": "added", "additions": 44, "deletions": 0, "changes": 44, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v0/UptimeCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v0/UptimeCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v0/UptimeCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,44 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v0;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import net.server.Server;\n+\n+public class UptimeCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        long milliseconds = System.currentTimeMillis() - Server.uptime;\n+        int seconds = (int) (milliseconds / 1000) % 60 ;\n+        int minutes = (int) ((milliseconds / (1000*60)) % 60);\n+        int hours   = (int) ((milliseconds / (1000*60*60)) % 24);\n+        int days    = (int) ((milliseconds / (1000*60*60*24)));\n+        c.getPlayer().yellowMessage(\"Server has been online for \" + days + \" days \" + hours + \" hours \" + minutes + \" minutes and \" + seconds + \" seconds.\");\n+    }\n+}"}, {"sha": "5bd3ff083bac1bda685fc8cc6f5c789662cd2488", "filename": "src/client/command/commands/v1/BossHpCommand.java", "status": "added", "additions": 52, "deletions": 0, "changes": 52, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v1/BossHpCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v1/BossHpCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v1/BossHpCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,52 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v1;\n+\n+import client.MapleCharacter;\n+import client.command.Command;\n+import client.MapleClient;\n+import server.life.MapleMonster;\n+\n+public class BossHpCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        for(MapleMonster monster : player.getMap().getMonsters()) {\n+            if(monster != null && monster.isBoss() && monster.getHp() > 0) {\n+                long percent = monster.getHp() * 100L / monster.getMaxHp();\n+                String bar = \"[\";\n+                for (int i = 0; i < 100; i++){\n+                    bar += i < percent ? \"|\" : \".\";\n+                }\n+                bar += \"]\";\n+                player.yellowMessage(monster.getName() + \" (\" + monster.getId() + \") has \" + percent + \"% HP left.\");\n+                player.yellowMessage(\"HP: \" + bar);\n+            }\n+        }\n+    }\n+}"}, {"sha": "a1760124b123d1cb8cfe34674cbda837061d89d7", "filename": "src/client/command/commands/v1/BuffMeCommand.java", "status": "added", "additions": 50, "deletions": 0, "changes": 50, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v1/BuffMeCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v1/BuffMeCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v1/BuffMeCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,50 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v1;\n+\n+import client.MapleCharacter;\n+import client.MapleStat;\n+import client.SkillFactory;\n+import client.command.Command;\n+import client.MapleClient;\n+\n+public class BuffMeCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        SkillFactory.getSkill(4101004).getEffect(SkillFactory.getSkill(4101004).getMaxLevel()).applyTo(player);\n+        SkillFactory.getSkill(2311003).getEffect(SkillFactory.getSkill(2311003).getMaxLevel()).applyTo(player);\n+        SkillFactory.getSkill(1301007).getEffect(SkillFactory.getSkill(1301007).getMaxLevel()).applyTo(player);\n+        SkillFactory.getSkill(2301004).getEffect(SkillFactory.getSkill(2301004).getMaxLevel()).applyTo(player);\n+        SkillFactory.getSkill(1005).getEffect(SkillFactory.getSkill(1005).getMaxLevel()).applyTo(player);\n+        player.setHp(player.getMaxHp());\n+        player.updateSingleStat(MapleStat.HP, player.getMaxHp());\n+        player.setMp(player.getMaxMp());\n+        player.updateSingleStat(MapleStat.MP, player.getMaxMp());\n+    }\n+}"}, {"sha": "85c49a5bf0012a2412fde928b509b4954b2c8b92", "filename": "src/client/command/commands/v1/GotoCommand.java", "status": "added", "additions": 108, "deletions": 0, "changes": 108, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v1/GotoCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v1/GotoCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v1/GotoCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,108 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v1;\n+\n+import client.MapleCharacter;\n+import client.command.Command;\n+import client.MapleClient;\n+import server.MaplePortal;\n+import server.maps.MapleMap;\n+\n+import java.util.HashMap;\n+\n+public class GotoCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        final HashMap<String, Integer> gotomaps = new HashMap<String, Integer>();\n+        gotomaps.put(\"gmmap\", 180000000);\n+        gotomaps.put(\"southperry\", 60000);\n+        gotomaps.put(\"amherst\", 1000000);\n+        gotomaps.put(\"henesys\", 100000000);\n+        gotomaps.put(\"ellinia\", 101000000);\n+        gotomaps.put(\"perion\", 102000000);\n+        gotomaps.put(\"kerning\", 103000000);\n+        gotomaps.put(\"lith\", 104000000);\n+        gotomaps.put(\"sleepywood\", 105040300);\n+        gotomaps.put(\"florina\", 110000000);\n+        gotomaps.put(\"nautilus\", 120000000);\n+        gotomaps.put(\"ereve\", 130000000);\n+        gotomaps.put(\"rien\", 140000000);\n+        gotomaps.put(\"orbis\", 200000000);\n+        gotomaps.put(\"happy\", 209000000);\n+        gotomaps.put(\"elnath\", 211000000);\n+        gotomaps.put(\"ludi\", 220000000);\n+        gotomaps.put(\"aqua\", 230000000);\n+        gotomaps.put(\"leafre\", 240000000);\n+        gotomaps.put(\"mulung\", 250000000);\n+        gotomaps.put(\"herb\", 251000000);\n+        gotomaps.put(\"omega\", 221000000);\n+        gotomaps.put(\"korean\", 222000000);\n+        gotomaps.put(\"ellin\", 300000000);\n+        gotomaps.put(\"nlc\", 600000000);\n+        gotomaps.put(\"excavation\", 990000000);\n+        gotomaps.put(\"pianus\", 230040420);\n+        gotomaps.put(\"horntail\", 240060200);\n+        gotomaps.put(\"mushmom\", 100000005);\n+        gotomaps.put(\"griffey\", 240020101);\n+        gotomaps.put(\"manon\", 240020401);\n+        gotomaps.put(\"horseman\", 682000001);\n+        gotomaps.put(\"balrog\", 105090900);\n+        gotomaps.put(\"zakum\", 211042300);\n+        gotomaps.put(\"papu\", 220080001);\n+        gotomaps.put(\"showa\", 801000000);\n+        gotomaps.put(\"guild\", 200000301);\n+        gotomaps.put(\"shrine\", 800000000);\n+        gotomaps.put(\"skelegon\", 240040511);\n+        gotomaps.put(\"hpq\", 100000200);\n+        gotomaps.put(\"ht\", 240050400);\n+        gotomaps.put(\"ariant\", 260000000);\n+        gotomaps.put(\"magatia\", 261000000);\n+        gotomaps.put(\"singapore\", 540000000);\n+        gotomaps.put(\"keep\", 610020006);\n+        gotomaps.put(\"amoria\", 680000000);\n+        gotomaps.put(\"temple\", 270000100);\n+        gotomaps.put(\"neo\", 240070000);\n+        gotomaps.put(\"fm\", 910000000);\n+\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 1){\n+            player.yellowMessage(\"Syntax: @goto <map name>\");\n+            return;\n+        }\n+        if (gotomaps.containsKey(params[0])) {\n+            MapleMap target = c.getChannelServer().getMapFactory().getMap(gotomaps.get(params[0]));\n+            MaplePortal targetPortal = target.getPortal(0);\n+            if (player.getEventInstance() != null) {\n+                player.getEventInstance().removePlayer(player);\n+            }\n+            player.changeMap(target, targetPortal);\n+        } else {\n+            player.dropMessage(5, \"That map does not exist.\");\n+        }\n+    }\n+}"}, {"sha": "64d0a9d29c55ced91084bb17c9948a02cb3a2a31", "filename": "src/client/command/commands/v1/MobHpCommand.java", "status": "added", "additions": 46, "deletions": 0, "changes": 46, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v1/MobHpCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v1/MobHpCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v1/MobHpCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,46 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v1;\n+\n+import client.MapleCharacter;\n+import client.command.Command;\n+import client.MapleClient;\n+import server.life.MapleMonster;\n+\n+public class MobHpCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        for(MapleMonster monster : player.getMap().getMonsters()) {\n+            if (monster != null && monster.getHp() > 0) {\n+                player.yellowMessage(monster.getName() + \" (\" + monster.getId() + \") has \" + monster.getHp() + \" / \" + monster.getMaxHp() + \" HP.\");\n+\n+            }\n+        }\n+    }\n+}"}, {"sha": "662c67ef46604d2932813289c7078b0592e3ce98", "filename": "src/client/command/commands/v1/WhatDropsFromCommand.java", "status": "added", "additions": 77, "deletions": 0, "changes": 77, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v1/WhatDropsFromCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v1/WhatDropsFromCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v1/WhatDropsFromCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,77 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v1;\n+\n+import client.MapleCharacter;\n+import client.command.Command;\n+import client.MapleClient;\n+import server.MapleItemInformationProvider;\n+import server.life.MapleMonsterInformationProvider;\n+import server.life.MonsterDropEntry;\n+import tools.MaplePacketCreator;\n+import tools.Pair;\n+\n+import java.util.Iterator;\n+\n+public class WhatDropsFromCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 1) {\n+            player.dropMessage(5, \"Please do @whatdropsfrom <monster name>\");\n+            return;\n+        }\n+        String monsterName = joinStringFrom(params, 0);\n+        String output = \"\";\n+        int limit = 3;\n+        Iterator<Pair<Integer, String>> listIterator = MapleMonsterInformationProvider.getMobsIDsFromName(monsterName).iterator();\n+        for (int i = 0; i < limit; i++) {\n+            if(listIterator.hasNext()) {\n+                Pair<Integer, String> data = listIterator.next();\n+                int mobId = data.getLeft();\n+                String mobName = data.getRight();\n+                output += mobName + \" drops the following items:\\r\\n\\r\\n\";\n+                for (MonsterDropEntry drop : MapleMonsterInformationProvider.getInstance().retrieveDrop(mobId)){\n+                    try {\n+                        String name = MapleItemInformationProvider.getInstance().getName(drop.itemId);\n+                        if (name.equals(\"null\") || drop.chance == 0){\n+                            continue;\n+                        }\n+                        float chance = 1000000 / drop.chance / player.getDropRate();\n+                        output += \"- \" + name + \" (1/\" + (int) chance + \")\\r\\n\";\n+                    } catch (Exception ex){\n+                        ex.printStackTrace();\n+                        continue;\n+                    }\n+                }\n+                output += \"\\r\\n\";\n+            }\n+        }\n+        c.announce(MaplePacketCreator.getNPCTalk(9010000, (byte) 0, output, \"00 00\", (byte) 0));\n+    }\n+}"}, {"sha": "4022ef98a9ce5bc6b6c1fc8805237b28021ed4f5", "filename": "src/client/command/commands/v1/WhoDropsCommand.java", "status": "added", "additions": 88, "deletions": 0, "changes": 88, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v1/WhoDropsCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v1/WhoDropsCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v1/WhoDropsCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,88 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v1;\n+\n+import client.MapleCharacter;\n+import client.command.Command;\n+import client.MapleClient;\n+import server.MapleItemInformationProvider;\n+import server.life.MapleMonsterInformationProvider;\n+import tools.DatabaseConnection;\n+import tools.MaplePacketCreator;\n+import tools.Pair;\n+\n+import java.sql.Connection;\n+import java.sql.PreparedStatement;\n+import java.sql.ResultSet;\n+import java.util.Iterator;\n+\n+public class WhoDropsCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 1) {\n+            player.dropMessage(5, \"Please do @whodrops <item name>\");\n+            return;\n+        }\n+        String searchString = joinStringFrom(params, 0);\n+        String output = \"\";\n+        Iterator<Pair<Integer, String>> listIterator = MapleItemInformationProvider.getInstance().getItemDataByName(searchString).iterator();\n+        if(listIterator.hasNext()) {\n+            int count = 1;\n+            while(listIterator.hasNext() && count <= 3) {\n+                Pair<Integer, String> data = listIterator.next();\n+                output += \"#b\" + data.getRight() + \"#k is dropped by:\\r\\n\";\n+                try {\n+                    Connection con = DatabaseConnection.getConnection();\n+                    PreparedStatement ps = con.prepareStatement(\"SELECT dropperid FROM drop_data WHERE itemid = ? LIMIT 50\");\n+                    ps.setInt(1, data.getLeft());\n+                    ResultSet rs = ps.executeQuery();\n+                    while(rs.next()) {\n+                        String resultName = MapleMonsterInformationProvider.getMobNameFromID(rs.getInt(\"dropperid\"));\n+                        if (resultName != null) {\n+                            output += resultName + \", \";\n+                        }\n+                    }\n+                    rs.close();\n+                    ps.close();\n+                    con.close();\n+                } catch (Exception e) {\n+                    player.dropMessage(6, \"There was a problem retrieving the required data. Please try again.\");\n+                    e.printStackTrace();\n+                    return;\n+                }\n+                output += \"\\r\\n\\r\\n\";\n+                count++;\n+            }\n+        } else {\n+            player.dropMessage(5, \"The item you searched for doesn't exist.\");\n+            return;\n+        }\n+        c.announce(MaplePacketCreator.getNPCTalk(9010000, (byte) 0, output, \"00 00\", (byte) 0));\n+    }\n+}"}, {"sha": "d305c0dc5a28ba1824767ed33178c48b78dd945a", "filename": "src/client/command/commands/v2/ApCommand.java", "status": "added", "additions": 66, "deletions": 0, "changes": 66, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/ApCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/ApCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v2/ApCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,66 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v2;\n+\n+import client.MapleStat;\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import constants.ServerConstants;\n+\n+public class ApCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 1) {\n+            player.yellowMessage(\"Syntax: !ap [<playername>] <newap>\");\n+            return;\n+        }\n+\n+        if (params.length < 2) {\n+            int newAp = Integer.parseInt(params[0]);\n+            if (newAp < 0) newAp = 0;\n+            else if (newAp > ServerConstants.MAX_AP) newAp = ServerConstants.MAX_AP;\n+\n+            player.setRemainingAp(newAp);\n+            player.updateSingleStat(MapleStat.AVAILABLEAP, player.getRemainingAp());\n+        } else {\n+            MapleCharacter victim = c.getChannelServer().getPlayerStorage().getCharacterByName(params[0]);\n+            if (victim != null) {\n+                int newAp = Integer.parseInt(params[1]);\n+                if (newAp < 0) newAp = 0;\n+                else if (newAp > ServerConstants.MAX_AP) newAp = ServerConstants.MAX_AP;\n+\n+                victim.setRemainingAp(newAp);\n+                victim.updateSingleStat(MapleStat.AVAILABLEAP, victim.getRemainingAp());\n+            } else {\n+                player.message(\"Player '\" + params[0] + \"' could not be found on this channel.\");\n+            }\n+        }\n+    }\n+}"}, {"sha": "d1b1b39ea5c6aac3f8651c08c652a8bb7a577d1a", "filename": "src/client/command/commands/v2/BombCommand.java", "status": "added", "additions": 53, "deletions": 0, "changes": 53, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/BombCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/BombCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v2/BombCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,53 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v2;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import net.server.Server;\n+import server.life.MapleLifeFactory;\n+import tools.MaplePacketCreator;\n+\n+public class BombCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length > 0) {\n+            MapleCharacter victim = c.getWorldServer().getPlayerStorage().getCharacterByName(params[0]);\n+            if (victim != null) {\n+                victim.getMap().spawnMonsterOnGroundBelow(MapleLifeFactory.getMonster(9300166), victim.getPosition());\n+                Server.getInstance().broadcastGMMessage(c.getWorld(), MaplePacketCreator.serverNotice(5, player.getName() + \" used !bomb on \" + victim.getName()));\n+            } else {\n+                player.message(\"Player '\" + params[0] + \"' could not be found on this world.\");\n+            }\n+        } else {\n+            player.getMap().spawnMonsterOnGroundBelow(MapleLifeFactory.getMonster(9300166), player.getPosition());\n+        }\n+    }\n+}"}, {"sha": "0c7278aa99c17715567642a6cca2724161fe011f", "filename": "src/client/command/commands/v2/BuffCommand.java", "status": "added", "additions": 49, "deletions": 0, "changes": 49, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/BuffCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/BuffCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v2/BuffCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,49 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v2;\n+\n+import client.Skill;\n+import client.SkillFactory;\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+\n+public class BuffCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 1) {\n+            player.yellowMessage(\"Syntax: !buff <buffid>\");\n+            return;\n+        }\n+        int skillid = Integer.parseInt(params[0]);\n+\n+        Skill skill = SkillFactory.getSkill(skillid);\n+        if (skill != null) skill.getEffect(skill.getMaxLevel()).applyTo(player);\n+    }\n+}"}, {"sha": "c850ca620738c418759c8bde59321d2ad0e49c88", "filename": "src/client/command/commands/v2/BuffMapCommand.java", "status": "added", "additions": 46, "deletions": 0, "changes": 46, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/BuffMapCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/BuffMapCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v2/BuffMapCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,46 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v2;\n+\n+import client.SkillFactory;\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+\n+public class BuffMapCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        SkillFactory.getSkill(9101001).getEffect(SkillFactory.getSkill(9101001).getMaxLevel()).applyTo(player, true);\n+        SkillFactory.getSkill(9101002).getEffect(SkillFactory.getSkill(9101002).getMaxLevel()).applyTo(player, true);\n+        SkillFactory.getSkill(9101003).getEffect(SkillFactory.getSkill(9101003).getMaxLevel()).applyTo(player, true);\n+        SkillFactory.getSkill(9101008).getEffect(SkillFactory.getSkill(9101008).getMaxLevel()).applyTo(player, true);\n+        SkillFactory.getSkill(1005).getEffect(SkillFactory.getSkill(1005).getMaxLevel()).applyTo(player, true);\n+\n+    }\n+}"}, {"sha": "20111d11731707101ed57a44f3b3332d421cc636", "filename": "src/client/command/commands/v2/ClearDropsCommand.java", "status": "added", "additions": 41, "deletions": 0, "changes": 41, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/ClearDropsCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/ClearDropsCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v2/ClearDropsCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,41 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v2;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+\n+public class ClearDropsCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        player.getMap().clearDrops(player);\n+        player.dropMessage(5, \"Cleared dropped items\");\n+    }\n+}"}, {"sha": "0a35d0aa714eeec1485273c3eeead69214cf9483", "filename": "src/client/command/commands/v2/ClearSlotCommand.java", "status": "added", "additions": 130, "deletions": 0, "changes": 130, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/ClearSlotCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/ClearSlotCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v2/ClearSlotCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,130 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v2;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import client.inventory.Item;\n+import client.inventory.MapleInventoryType;\n+import client.inventory.manipulator.MapleInventoryManipulator;\n+\n+public class ClearSlotCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 1) {\n+            player.yellowMessage(\"Syntax: !clearslot <all, equip, use, setup, etc or cash.>\");\n+            return;\n+        }\n+        String type = params[0];\n+        switch (type) {\n+            case \"all\":\n+                for (int i = 0; i < 101; i++) {\n+                    Item tempItem = c.getPlayer().getInventory(MapleInventoryType.EQUIP).getItem((byte) i);\n+                    if (tempItem == null)\n+                        continue;\n+                    MapleInventoryManipulator.removeFromSlot(c, MapleInventoryType.EQUIP, (byte) i, tempItem.getQuantity(), false, true);\n+                }\n+                for (int i = 0; i < 101; i++) {\n+                    Item tempItem = c.getPlayer().getInventory(MapleInventoryType.USE).getItem((byte) i);\n+                    if (tempItem == null)\n+                        continue;\n+                    MapleInventoryManipulator.removeFromSlot(c, MapleInventoryType.USE, (byte) i, tempItem.getQuantity(), false, true);\n+                }\n+                for (int i = 0; i < 101; i++) {\n+                    Item tempItem = c.getPlayer().getInventory(MapleInventoryType.ETC).getItem((byte) i);\n+                    if (tempItem == null)\n+                        continue;\n+                    MapleInventoryManipulator.removeFromSlot(c, MapleInventoryType.ETC, (byte) i, tempItem.getQuantity(), false, true);\n+                }\n+                for (int i = 0; i < 101; i++) {\n+                    Item tempItem = c.getPlayer().getInventory(MapleInventoryType.SETUP).getItem((byte) i);\n+                    if (tempItem == null)\n+                        continue;\n+                    MapleInventoryManipulator.removeFromSlot(c, MapleInventoryType.SETUP, (byte) i, tempItem.getQuantity(), false, true);\n+                }\n+                for (int i = 0; i < 101; i++) {\n+                    Item tempItem = c.getPlayer().getInventory(MapleInventoryType.CASH).getItem((byte) i);\n+                    if (tempItem == null)\n+                        continue;\n+                    MapleInventoryManipulator.removeFromSlot(c, MapleInventoryType.CASH, (byte) i, tempItem.getQuantity(), false, true);\n+                }\n+                player.yellowMessage(\"All Slots Cleared.\");\n+                break;\n+            case \"equip\":\n+                for (int i = 0; i < 101; i++) {\n+                    Item tempItem = c.getPlayer().getInventory(MapleInventoryType.EQUIP).getItem((byte) i);\n+                    if (tempItem == null)\n+                        continue;\n+                    MapleInventoryManipulator.removeFromSlot(c, MapleInventoryType.EQUIP, (byte) i, tempItem.getQuantity(), false, true);\n+                }\n+                player.yellowMessage(\"Equipment Slot Cleared.\");\n+                break;\n+            case \"use\":\n+                for (int i = 0; i < 101; i++) {\n+                    Item tempItem = c.getPlayer().getInventory(MapleInventoryType.USE).getItem((byte) i);\n+                    if (tempItem == null)\n+                        continue;\n+                    MapleInventoryManipulator.removeFromSlot(c, MapleInventoryType.USE, (byte) i, tempItem.getQuantity(), false, true);\n+                }\n+                player.yellowMessage(\"Use Slot Cleared.\");\n+                break;\n+            case \"setup\":\n+                for (int i = 0; i < 101; i++) {\n+                    Item tempItem = c.getPlayer().getInventory(MapleInventoryType.SETUP).getItem((byte) i);\n+                    if (tempItem == null)\n+                        continue;\n+                    MapleInventoryManipulator.removeFromSlot(c, MapleInventoryType.SETUP, (byte) i, tempItem.getQuantity(), false, true);\n+                }\n+                player.yellowMessage(\"Set-Up Slot Cleared.\");\n+                break;\n+            case \"etc\":\n+                for (int i = 0; i < 101; i++) {\n+                    Item tempItem = c.getPlayer().getInventory(MapleInventoryType.ETC).getItem((byte) i);\n+                    if (tempItem == null)\n+                        continue;\n+                    MapleInventoryManipulator.removeFromSlot(c, MapleInventoryType.ETC, (byte) i, tempItem.getQuantity(), false, true);\n+                }\n+                player.yellowMessage(\"ETC Slot Cleared.\");\n+                break;\n+            case \"cash\":\n+                for (int i = 0; i < 101; i++) {\n+                    Item tempItem = c.getPlayer().getInventory(MapleInventoryType.CASH).getItem((byte) i);\n+                    if (tempItem == null)\n+                        continue;\n+                    MapleInventoryManipulator.removeFromSlot(c, MapleInventoryType.CASH, (byte) i, tempItem.getQuantity(), false, true);\n+                }\n+                player.yellowMessage(\"Cash Slot Cleared.\");\n+                break;\n+            default:\n+                player.yellowMessage(\"Slot\" + type + \" does not exist!\");\n+                break;\n+        }\n+    }\n+}"}, {"sha": "589faa0c3ac2b2abbabfb32df5b68c03d7f3cb8c", "filename": "src/client/command/commands/v2/DcCommand.java", "status": "added", "additions": 65, "deletions": 0, "changes": 65, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/DcCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/DcCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v2/DcCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,65 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v2;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+\n+public class DcCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 1) {\n+            player.yellowMessage(\"Syntax: !dc <playername>\");\n+            return;\n+        }\n+\n+        MapleCharacter victim = c.getWorldServer().getPlayerStorage().getCharacterByName(params[0]);\n+        if (victim == null) {\n+            victim = c.getChannelServer().getPlayerStorage().getCharacterByName(params[0]);\n+            if (victim == null) {\n+                victim = player.getMap().getCharacterByName(params[0]);\n+                if (victim != null) {\n+                    try {//sometimes bugged because the map = null\n+                        victim.getClient().disconnect(true, false);\n+                        player.getMap().removePlayer(victim);\n+                    } catch (Exception e) {\n+                        e.printStackTrace();\n+                    }\n+                } else {\n+                    return;\n+                }\n+            }\n+        }\n+        if (player.gmLevel() < victim.gmLevel()) {\n+            victim = player;\n+        }\n+        victim.getClient().disconnect(false, false);\n+    }\n+}"}, {"sha": "c4fce8bdc199faefd2328bf695f6100714b537c7", "filename": "src/client/command/commands/v2/EmpowerMeCommand.java", "status": "added", "additions": 44, "deletions": 0, "changes": 44, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/EmpowerMeCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/EmpowerMeCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v2/EmpowerMeCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,44 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v2;\n+\n+import client.SkillFactory;\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+\n+public class EmpowerMeCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        final int[] array = {2311003, 2301004, 1301007, 4101004, 2001002, 1101007, 1005, 2301003, 5121009, 1111002, 4111001, 4111002, 4211003, 4211005, 1321000, 2321004, 3121002};\n+        for (int i : array) {\n+            SkillFactory.getSkill(i).getEffect(SkillFactory.getSkill(i).getMaxLevel()).applyTo(player);\n+        }\n+    }\n+}"}, {"sha": "c77454061ef6c626aacd0ffb6921dea2e1f70689", "filename": "src/client/command/commands/v2/GmShopCommand.java", "status": "added", "additions": 40, "deletions": 0, "changes": 40, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/GmShopCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/GmShopCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v2/GmShopCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,40 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v2;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import server.MapleShopFactory;\n+\n+public class GmShopCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleShopFactory.getInstance().getShop(1337).sendShop(c);\n+    }\n+}"}, {"sha": "a1eeba29e688d3e30aa6053eb55199d1894f0d8a", "filename": "src/client/command/commands/v2/HealCommand.java", "status": "added", "additions": 41, "deletions": 0, "changes": 41, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/HealCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/HealCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v2/HealCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,41 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v2;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+\n+public class HealCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        player.setHpMp(30000);\n+    }\n+\n+}"}, {"sha": "38b7c09118bee218caffe3a3a6c222bd1aa37693", "filename": "src/client/command/commands/v2/HideCommand.java", "status": "added", "additions": 42, "deletions": 0, "changes": 42, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/HideCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/HideCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v2/HideCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,42 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v2;\n+\n+import client.SkillFactory;\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+\n+public class HideCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        SkillFactory.getSkill(9101004).getEffect(SkillFactory.getSkill(9101004).getMaxLevel()).applyTo(player);\n+\n+    }\n+}"}, {"sha": "677748974fa6ddb275b447d470c06cb19a68da6e", "filename": "src/client/command/commands/v2/ItemCommand.java", "status": "added", "additions": 88, "deletions": 0, "changes": 88, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/ItemCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/ItemCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v2/ItemCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,88 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v2;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import client.inventory.MaplePet;\n+import client.inventory.manipulator.MapleInventoryManipulator;\n+import constants.ItemConstants;\n+import constants.ServerConstants;\n+import server.MapleItemInformationProvider;\n+\n+public class ItemCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        \n+        if (params.length < 1) {\n+            player.yellowMessage(\"Syntax: !item <itemid> <quantity>\");\n+            return;\n+        }\n+\n+        int itemId = Integer.parseInt(params[0]);\n+        MapleItemInformationProvider ii = MapleItemInformationProvider.getInstance();\n+\n+        if(ii.getName(itemId) == null) {\n+            player.yellowMessage(\"Item id '\" + params[0] + \"' does not exist.\");\n+            return;\n+        }\n+\n+        short quantity = 1;\n+        if(params.length >= 2) quantity = Short.parseShort(params[1]);\n+\n+        if (ServerConstants.BLOCK_GENERATE_CASH_ITEM && ii.isCash(itemId)) {\n+            player.yellowMessage(\"You cannot create a cash item with this command.\");\n+            return;\n+        }\n+\n+        if (ItemConstants.isPet(itemId)) {\n+                if (params.length >= 2){   // thanks to istreety & TacoBell\n+                        quantity = 1;\n+                        long days = Math.max(1, Integer.parseInt(params[1]));\n+                        long expiration = System.currentTimeMillis() + (days * 24 * 60 * 60 * 1000);\n+                        int petid = MaplePet.createPet(itemId);\n+\n+                        MapleInventoryManipulator.addById(c, itemId, quantity, player.getName(), petid, expiration);\n+                        return;\n+                } else {\n+                        player.yellowMessage(\"Pet Syntax: !item <itemid> <expiration>\");\n+                        return;        \n+                }\n+        }\n+        \n+        byte flag = 0;\n+        if(player.gmLevel() < 3) {\n+                flag |= ItemConstants.ACCOUNT_SHARING;\n+                flag |= ItemConstants.UNTRADEABLE;\n+        }\n+\n+        MapleInventoryManipulator.addById(c, itemId, quantity, player.getName(), -1, flag, -1);\n+    }\n+}"}, {"sha": "7edbe3900e0e710fd301c534cf601827a87fcb9b", "filename": "src/client/command/commands/v2/ItemDropCommand.java", "status": "added", "additions": 117, "deletions": 0, "changes": 117, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/ItemDropCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/ItemDropCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v2/ItemDropCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,117 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v2;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import client.inventory.Item;\n+import client.inventory.MapleInventoryType;\n+import client.inventory.MaplePet;\n+import constants.ItemConstants;\n+import constants.ServerConstants;\n+import server.MapleItemInformationProvider;\n+\n+public class ItemDropCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        \n+        if (params.length < 1) {\n+            player.yellowMessage(\"Syntax: !item <itemid> <quantity>\");\n+            return;\n+        }\n+\n+        int itemId = Integer.parseInt(params[0]);\n+        MapleItemInformationProvider ii = MapleItemInformationProvider.getInstance();\n+\n+        if(ii.getName(itemId) == null) {\n+            player.yellowMessage(\"Item id '\" + params[0] + \"' does not exist.\");\n+            return;\n+        }\n+\n+        short quantity = 1;\n+        if(params.length >= 2) quantity = Short.parseShort(params[1]);\n+\n+        if (ServerConstants.BLOCK_GENERATE_CASH_ITEM && ii.isCash(itemId)) {\n+            player.yellowMessage(\"You cannot create a cash item with this command.\");\n+            return;\n+        }\n+\n+        if (ItemConstants.isPet(itemId)) {\n+            if (params.length >= 2){   // thanks to istreety & TacoBell\n+                quantity = 1;\n+                long days = Math.max(1, Integer.parseInt(params[1]));\n+                long expiration = System.currentTimeMillis() + (days * 24 * 60 * 60 * 1000);\n+                int petid = MaplePet.createPet(itemId);\n+\n+                Item toDrop = new Item(itemId, (short) 0, quantity, petid);\n+                toDrop.setExpiration(expiration);\n+\n+                toDrop.setOwner(\"\");\n+                if(player.gmLevel() < 3) {\n+                    byte b = toDrop.getFlag();\n+                    b |= ItemConstants.ACCOUNT_SHARING;\n+                    b |= ItemConstants.UNTRADEABLE;\n+                    b |= ItemConstants.SANDBOX;\n+                    \n+                    toDrop.setFlag(b);\n+                    toDrop.setOwner(\"TRIAL-MODE\");\n+                }\n+\n+                c.getPlayer().getMap().spawnItemDrop(c.getPlayer(), c.getPlayer(), toDrop, c.getPlayer().getPosition(), true, true);\n+\n+                return;\n+            } else {\n+                player.yellowMessage(\"Pet Syntax: !item <itemid> <expiration>\");\n+                return;        \n+            }\n+        }\n+\n+        \n+        Item toDrop;\n+        if (ItemConstants.getInventoryType(itemId) == MapleInventoryType.EQUIP) {\n+            toDrop = ii.getEquipById(itemId);\n+        } else {\n+            toDrop = new Item(itemId, (short) 0, quantity);\n+        }\n+\n+        toDrop.setOwner(player.getName());\n+        if(player.gmLevel() < 3) {\n+            byte b = toDrop.getFlag();\n+            b |= ItemConstants.ACCOUNT_SHARING;\n+            b |= ItemConstants.UNTRADEABLE;\n+            b |= ItemConstants.SANDBOX;\n+\n+            toDrop.setFlag(b);\n+            toDrop.setOwner(\"TRIAL-MODE\");\n+        }\n+\n+        c.getPlayer().getMap().spawnItemDrop(c.getPlayer(), c.getPlayer(), toDrop, c.getPlayer().getPosition(), true, true);\n+    }\n+}"}, {"sha": "97d6ec3944a431a652add2b7681a1d3b2cee6b8f", "filename": "src/client/command/commands/v2/JailCommand.java", "status": "added", "additions": 73, "deletions": 0, "changes": 73, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/JailCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/JailCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v2/JailCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,73 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v2;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import server.MaplePortal;\n+import server.maps.MapleMap;\n+\n+public class JailCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 1) {\n+            player.yellowMessage(\"Syntax: !jail <playername> [<minutes>]\");\n+            return;\n+        }\n+\n+        int minutesJailed = 5;\n+        if (params.length >= 2) {\n+            minutesJailed = Integer.valueOf(params[1]);\n+            if (minutesJailed <= 0) {\n+                player.yellowMessage(\"Syntax: !jail <playername> [<minutes>]\");\n+                return;\n+            }\n+        }\n+\n+        MapleCharacter victim = c.getChannelServer().getPlayerStorage().getCharacterByName(params[0]);\n+        if (victim != null) {\n+            victim.addJailExpirationTime(minutesJailed * 60 * 1000);\n+\n+            int mapid = 300000012;\n+\n+            if (victim.getMapId() != mapid) {    // those gone to jail won't be changing map anyway\n+                MapleMap target = c.getChannelServer().getMapFactory().getMap(mapid);\n+                MaplePortal targetPortal = target.getPortal(0);\n+                victim.changeMap(target, targetPortal);\n+                player.message(victim.getName() + \" was jailed for \" + minutesJailed + \" minutes.\");\n+            } else {\n+                player.message(victim.getName() + \"'s time in jail has been extended for \" + minutesJailed + \" minutes.\");\n+            }\n+\n+        } else {\n+            player.message(\"Player '\" + params[0] + \"' could not be found on this channel.\");\n+        }\n+    }\n+}"}, {"sha": "a40ce8f06d8295afe5115525afdfbf0666705008", "filename": "src/client/command/commands/v2/JobCommand.java", "status": "added", "additions": 67, "deletions": 0, "changes": 67, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/JobCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/JobCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v2/JobCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,67 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v2;\n+\n+import client.MapleJob;\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+\n+public class JobCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length == 1) {\n+            int jobid = Integer.parseInt(params[0]);\n+            if (jobid < 0 || jobid >= 2200) {\n+                player.message(\"Jobid \" + jobid + \" is not available.\");\n+                return;\n+            }\n+\n+            player.changeJob(MapleJob.getById(jobid));\n+            player.equipChanged();\n+        } else if (params.length == 2) {\n+            MapleCharacter victim = c.getChannelServer().getPlayerStorage().getCharacterByName(params[0]);\n+\n+            if (victim != null) {\n+                int jobid = Integer.parseInt(params[1]);\n+                if (jobid < 0 || jobid >= 2200) {\n+                    player.message(\"Jobid \" + jobid + \" is not available.\");\n+                    return;\n+                }\n+\n+                victim.changeJob(MapleJob.getById(jobid));\n+                player.equipChanged();\n+            } else {\n+                player.message(\"Player '\" + params[0] + \"' could not be found on this channel.\");\n+            }\n+        } else {\n+            player.message(\"Syntax: !job <job id> <opt: IGN of another person>\");\n+        }\n+    }\n+}"}, {"sha": "cc03a5b0dbff29109721e5bc723ab7bc37715247", "filename": "src/client/command/commands/v2/LevelCommand.java", "status": "added", "additions": 53, "deletions": 0, "changes": 53, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/LevelCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/LevelCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v2/LevelCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,53 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v2;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import constants.ServerConstants;\n+\n+public class LevelCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 1) {\n+            player.yellowMessage(\"Syntax: !level <newlevel>\");\n+            return;\n+        }\n+\n+        player.loseExp(player.getExp(), false, false);\n+        player.setLevel(Math.min(Integer.parseInt(params[0]), player.getMaxClassLevel()) - 1);\n+\n+        player.resetPlayerRates();\n+        if (ServerConstants.USE_ADD_RATES_BY_LEVEL) player.setPlayerRates();\n+        player.setWorldRates();\n+\n+        player.levelUp(false);\n+    }\n+}"}, {"sha": "4ce2ebf9ca2ae950f36a9682372efeac81992ab4", "filename": "src/client/command/commands/v2/LevelProCommand.java", "status": "added", "additions": 46, "deletions": 0, "changes": 46, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/LevelProCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/LevelProCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v2/LevelProCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,46 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v2;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+\n+public class LevelProCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 1) {\n+            player.yellowMessage(\"Syntax: !levelpro <newlevel>\");\n+            return;\n+        }\n+        while (player.getLevel() < Math.min(player.getMaxClassLevel(), Integer.parseInt(params[0]))) {\n+            player.levelUp(false);\n+        }\n+    }\n+}"}, {"sha": "4fdde06ed833b107cb5df3bcde367e58c7320d5d", "filename": "src/client/command/commands/v2/MaxSkillCommand.java", "status": "added", "additions": 60, "deletions": 0, "changes": 60, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/MaxSkillCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/MaxSkillCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v2/MaxSkillCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,60 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v2;\n+\n+import client.*;\n+import client.command.Command;\n+import provider.MapleData;\n+import provider.MapleDataProviderFactory;\n+\n+import java.io.File;\n+\n+public class MaxSkillCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        for (MapleData skill_ : MapleDataProviderFactory.getDataProvider(new File(System.getProperty(\"wzpath\") + \"/\" + \"String.wz\")).getData(\"Skill.img\").getChildren()) {\n+            try {\n+                Skill skill = SkillFactory.getSkill(Integer.parseInt(skill_.getName()));\n+                player.changeSkillLevel(skill, (byte) skill.getMaxLevel(), skill.getMaxLevel(), -1);\n+            } catch (NumberFormatException nfe) {\n+                nfe.printStackTrace();\n+                break;\n+            } catch (NullPointerException npe) { }\n+        }\n+\n+        if (player.getJob().isA(MapleJob.ARAN1) || player.getJob().isA(MapleJob.LEGEND)) {\n+            Skill skill = SkillFactory.getSkill(5001005);\n+            player.changeSkillLevel(skill, (byte) -1, -1, -1);\n+        } else {\n+            Skill skill = SkillFactory.getSkill(21001001);\n+            player.changeSkillLevel(skill, (byte) -1, -1, -1);\n+        }\n+\n+    }\n+}"}, {"sha": "995764ea25582a04b266061011e822ea5b3eb36c", "filename": "src/client/command/commands/v2/MaxStatCommand.java", "status": "added", "additions": 63, "deletions": 0, "changes": 63, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/MaxStatCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/MaxStatCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v2/MaxStatCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,63 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v2;\n+\n+import client.MapleStat;\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import client.command.CommandsExecutor;\n+import constants.ServerConstants;\n+\n+public class MaxStatCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        player.loseExp(player.getExp(), false, false);\n+        player.setLevel(255);\n+        player.resetPlayerRates();\n+        if (ServerConstants.USE_ADD_RATES_BY_LEVEL) player.setPlayerRates();\n+        player.setWorldRates();\n+        player.setStr(Short.MAX_VALUE);\n+        player.setDex(Short.MAX_VALUE);\n+        player.setInt(Short.MAX_VALUE);\n+        player.setLuk(Short.MAX_VALUE);\n+        player.updateSingleStat(MapleStat.STR, Short.MAX_VALUE);\n+        player.updateSingleStat(MapleStat.DEX, Short.MAX_VALUE);\n+        player.updateSingleStat(MapleStat.INT, Short.MAX_VALUE);\n+        player.updateSingleStat(MapleStat.LUK, Short.MAX_VALUE);\n+        player.setFame(13337);\n+        player.setMaxHp(30000);\n+        player.setMaxMp(30000);\n+        player.updateSingleStat(MapleStat.LEVEL, 255);\n+        player.updateSingleStat(MapleStat.FAME, 13337);\n+        player.updateSingleStat(MapleStat.MAXHP, 30000);\n+        player.updateSingleStat(MapleStat.MAXMP, 30000);\n+        player.yellowMessage(\"Stats maxed out.\");\n+    }\n+}"}, {"sha": "5d1c6de96bb5d0bd9ec8800ef58a6eac500cf854", "filename": "src/client/command/commands/v2/MesosCommand.java", "status": "added", "additions": 42, "deletions": 0, "changes": 42, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/MesosCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/MesosCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v2/MesosCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,42 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v2;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+\n+public class MesosCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length >= 1) {\n+            player.gainMeso(Integer.parseInt(params[0]), true);\n+        }\n+    }\n+}"}, {"sha": "e4e2fa46a6aae2d21146ec722a6fc899a3a27a4d", "filename": "src/client/command/commands/v2/ReachCommand.java", "status": "added", "additions": 56, "deletions": 0, "changes": 56, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/ReachCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/ReachCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v2/ReachCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,56 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v2;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import server.maps.MapleMap;\n+\n+public class ReachCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 1) {\n+            player.yellowMessage(\"Syntax: !reach <playername>\");\n+            return;\n+        }\n+\n+        MapleCharacter victim = c.getWorldServer().getPlayerStorage().getCharacterByName(params[0]);\n+        if (victim != null && victim.isLoggedin()) {\n+            if (player.getClient().getChannel() != victim.getClient().getChannel()) {\n+                player.dropMessage(5, \"Player '\" + victim.getName() + \"' is at channel \" + victim.getClient().getChannel() + \".\");\n+            } else {\n+                MapleMap map = victim.getMap();\n+                player.forceChangeMap(map, map.findClosestPortal(victim.getPosition()));\n+            }\n+        } else {\n+            player.dropMessage(6, \"Unknown player.\");\n+        }\n+    }\n+}"}, {"sha": "631fcae7af22f061984be3c8ed78bf095dd4565e", "filename": "src/client/command/commands/v2/RechargeCommand.java", "status": "added", "additions": 60, "deletions": 0, "changes": 60, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/RechargeCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/RechargeCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v2/RechargeCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,60 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v2;\n+\n+import client.MapleCharacter;\n+import client.command.Command;\n+import client.MapleClient;\n+import client.inventory.Item;\n+import client.inventory.MapleInventoryType;\n+import constants.ItemConstants;\n+import server.MapleItemInformationProvider;\n+\n+public class RechargeCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        MapleItemInformationProvider ii = MapleItemInformationProvider.getInstance();\n+        for (Item torecharge : c.getPlayer().getInventory(MapleInventoryType.USE).list()) {\n+            if (ItemConstants.isThrowingStar(torecharge.getItemId())){\n+                torecharge.setQuantity(ii.getSlotMax(c, torecharge.getItemId()));\n+                c.getPlayer().forceUpdateItem(torecharge);\n+            } else if (ItemConstants.isArrow(torecharge.getItemId())){\n+                torecharge.setQuantity(ii.getSlotMax(c, torecharge.getItemId()));\n+                c.getPlayer().forceUpdateItem(torecharge);\n+            } else if (ItemConstants.isBullet(torecharge.getItemId())){\n+                torecharge.setQuantity(ii.getSlotMax(c, torecharge.getItemId()));\n+                c.getPlayer().forceUpdateItem(torecharge);\n+            } else if (ItemConstants.isConsumable(torecharge.getItemId())){\n+                torecharge.setQuantity(ii.getSlotMax(c, torecharge.getItemId()));\n+                c.getPlayer().forceUpdateItem(torecharge);\n+            }\n+        }\n+        player.dropMessage(5, \"USE Recharged.\");\n+    }\n+}"}, {"sha": "93287e2882746219a744f5d871b843cf55c059bd", "filename": "src/client/command/commands/v2/ResetSkillCommand.java", "status": "added", "additions": 62, "deletions": 0, "changes": 62, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/ResetSkillCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/ResetSkillCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v2/ResetSkillCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,62 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v2;\n+\n+import client.*;\n+import client.command.Command;\n+import provider.MapleData;\n+import provider.MapleDataProviderFactory;\n+\n+import java.io.File;\n+\n+public class ResetSkillCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        for (MapleData skill_ : MapleDataProviderFactory.getDataProvider(new File(System.getProperty(\"wzpath\") + \"/\" + \"String.wz\")).getData(\"Skill.img\").getChildren()) {\n+            try {\n+                Skill skill = SkillFactory.getSkill(Integer.parseInt(skill_.getName()));\n+                player.changeSkillLevel(skill, (byte) 0, skill.getMaxLevel(), -1);\n+            } catch (NumberFormatException nfe) {\n+                nfe.printStackTrace();\n+                break;\n+            } catch (NullPointerException npe) {\n+            }\n+        }\n+\n+        if (player.getJob().isA(MapleJob.ARAN1) || player.getJob().isA(MapleJob.LEGEND)) {\n+            Skill skill = SkillFactory.getSkill(5001005);\n+            player.changeSkillLevel(skill, (byte) -1, -1, -1);\n+        } else {\n+            Skill skill = SkillFactory.getSkill(21001001);\n+            player.changeSkillLevel(skill, (byte) -1, -1, -1);\n+        }\n+\n+        player.yellowMessage(\"Skills reseted.\");\n+    }\n+}"}, {"sha": "2306f23649a606e49eb97551a38581566063b844", "filename": "src/client/command/commands/v2/SearchCommand.java", "status": "added", "additions": 98, "deletions": 0, "changes": 98, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/SearchCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/SearchCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v2/SearchCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,98 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v2;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import provider.MapleData;\n+import provider.MapleDataProvider;\n+import provider.MapleDataProviderFactory;\n+import provider.MapleDataTool;\n+import server.MapleItemInformationProvider;\n+import tools.MaplePacketCreator;\n+import tools.Pair;\n+\n+import java.io.File;\n+\n+public class SearchCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 2) {\n+            player.yellowMessage(\"Syntax: !search <type> <name>\");\n+            return;\n+        }\n+        StringBuilder sb = new StringBuilder();\n+\n+        String search = joinStringFrom(params,1);\n+        long start = System.currentTimeMillis();//for the lulz\n+        MapleData data = null;\n+        MapleDataProvider dataProvider = MapleDataProviderFactory.getDataProvider(new File(\"wz/String.wz\"));\n+        if (!params[0].equalsIgnoreCase(\"ITEM\")) {\n+            if (params[0].equalsIgnoreCase(\"NPC\")) {\n+                data = dataProvider.getData(\"Npc.img\");\n+            } else if (params[0].equalsIgnoreCase(\"MOB\") || params[0].equalsIgnoreCase(\"MONSTER\")) {\n+                data = dataProvider.getData(\"Mob.img\");\n+            } else if (params[0].equalsIgnoreCase(\"SKILL\")) {\n+                data = dataProvider.getData(\"Skill.img\");\n+                                /*} else if (sub[1].equalsIgnoreCase(\"MAP\")) {\n+                                        TODO\n+                                */\n+            } else {\n+                sb.append(\"#bInvalid search.\\r\\nSyntax: '!search [type] [name]', where [type] is NPC, ITEM, MOB, or SKILL.\");\n+            }\n+            if (data != null) {\n+                String name;\n+                for (MapleData searchData : data.getChildren()) {\n+                    name = MapleDataTool.getString(searchData.getChildByPath(\"name\"), \"NO-NAME\");\n+                    if (name.toLowerCase().contains(search.toLowerCase())) {\n+                        sb.append(\"#b\").append(Integer.parseInt(searchData.getName())).append(\"#k - #r\").append(name).append(\"\\r\\n\");\n+                    }\n+                }\n+            }\n+        } else {\n+            for (Pair<Integer, String> itemPair : MapleItemInformationProvider.getInstance().getAllItems()) {\n+                if (sb.length() < 32654) {//ohlol\n+                    if (itemPair.getRight().toLowerCase().contains(search.toLowerCase())) {\n+                        sb.append(\"#b\").append(itemPair.getLeft()).append(\"#k - #r\").append(itemPair.getRight()).append(\"\\r\\n\");\n+                    }\n+                } else {\n+                    sb.append(\"#bCouldn't load all items, there are too many results.\\r\\n\");\n+                    break;\n+                }\n+            }\n+        }\n+        if (sb.length() == 0) {\n+            sb.append(\"#bNo \").append(params[0].toLowerCase()).append(\"s found.\\r\\n\");\n+        }\n+        sb.append(\"\\r\\n#kLoaded within \").append((double) (System.currentTimeMillis() - start) / 1000).append(\" seconds.\");//because I can, and it's free\n+\n+        c.announce(MaplePacketCreator.getNPCTalk(9010000, (byte) 0, sb.toString(), \"00 00\", (byte) 0));\n+    }\n+}"}, {"sha": "b1fabca6b728861de35c10e9918cdb2a4fcfcd20", "filename": "src/client/command/commands/v2/SetStatCommand.java", "status": "added", "additions": 63, "deletions": 0, "changes": 63, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/SetStatCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/SetStatCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v2/SetStatCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,63 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v2;\n+\n+import client.MapleStat;\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+\n+public class SetStatCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 1) {\n+            player.yellowMessage(\"Syntax: !setstat <newstat>\");\n+            return;\n+        }\n+\n+        int x;\n+        try {\n+            x = Integer.parseInt(params[0]);\n+\n+            if (x > Short.MAX_VALUE) x = Short.MAX_VALUE;\n+            else if (x < 0) x = 0;\n+\n+            player.setStr(x);\n+            player.setDex(x);\n+            player.setInt(x);\n+            player.setLuk(x);\n+            player.updateSingleStat(MapleStat.STR, x);\n+            player.updateSingleStat(MapleStat.DEX, x);\n+            player.updateSingleStat(MapleStat.INT, x);\n+            player.updateSingleStat(MapleStat.LUK, x);\n+\n+        } catch (NumberFormatException nfe) {\n+        }\n+    }\n+}"}, {"sha": "5a610a4d141de48cd09d30ee34c0cb7939d0a374", "filename": "src/client/command/commands/v2/SpCommand.java", "status": "added", "additions": 68, "deletions": 0, "changes": 68, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/SpCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/SpCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v2/SpCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,68 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v2;\n+\n+import client.MapleStat;\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import constants.ServerConstants;\n+\n+public class SpCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 1) {\n+            player.yellowMessage(\"Syntax: !sp [<playername>] <newsp>\");\n+            return;\n+        }\n+\n+        if (params.length == 1) {\n+            int newSp = Integer.parseInt(params[0]);\n+            if (newSp < 0) newSp = 0;\n+            else if (newSp > ServerConstants.MAX_AP) newSp = ServerConstants.MAX_AP;\n+\n+            player.setRemainingSp(newSp);\n+            player.updateSingleStat(MapleStat.AVAILABLESP, player.getRemainingSp());\n+        } else {\n+            MapleCharacter victim = c.getChannelServer().getPlayerStorage().getCharacterByName(params[0]);\n+            if (victim != null) {\n+                int newSp = Integer.parseInt(params[1]);\n+                if (newSp < 0) newSp = 0;\n+                else if (newSp > ServerConstants.MAX_AP) newSp = ServerConstants.MAX_AP;\n+\n+                victim.setRemainingSp(newSp);\n+                victim.updateSingleStat(MapleStat.AVAILABLESP, player.getRemainingSp());\n+\n+                player.dropMessage(5, \"SP given.\");\n+            } else {\n+                player.message(\"Player '\" + params[0] + \"' could not be found on this channel.\");\n+            }\n+        }\n+    }\n+}"}, {"sha": "785d5dfa14a6d99759c544e4e6fbb787312eefe9", "filename": "src/client/command/commands/v2/SummonCommand.java", "status": "added", "additions": 83, "deletions": 0, "changes": 83, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/SummonCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/SummonCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v2/SummonCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,83 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v2;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import net.server.Server;\n+import net.server.channel.Channel;\n+\n+public class SummonCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 1) {\n+            player.yellowMessage(\"Syntax: !warphere <playername>\");\n+            return;\n+        }\n+\n+        MapleCharacter victim = c.getChannelServer().getPlayerStorage().getCharacterByName(params[0]);\n+        if (victim == null) {//If victim isn't on current channel, loop all channels on current world.\n+            for (Channel ch : Server.getInstance().getChannelsFromWorld(c.getWorld())) {\n+                victim = ch.getPlayerStorage().getCharacterByName(params[0]);\n+                if (victim != null) {\n+                    break;//We found the person, no need to continue the loop.\n+                }\n+            }\n+        }\n+        if (victim != null) {\n+            boolean changingEvent = true;\n+\n+            if (victim.getEventInstance() != null) {\n+                if (player.getEventInstance() != null && victim.getEventInstance().getLeaderId() == player.getEventInstance().getLeaderId()) {\n+                    changingEvent = false;\n+                } else {\n+                    victim.getEventInstance().unregisterPlayer(victim);\n+                }\n+            }\n+            //Attempt to join the warpers instance.\n+            if (player.getEventInstance() != null && changingEvent) {\n+                if (player.getClient().getChannel() == victim.getClient().getChannel()) {//just in case.. you never know...\n+                    player.getEventInstance().registerPlayer(victim);\n+                    victim.changeMap(player.getEventInstance().getMapInstance(player.getMapId()), player.getMap().findClosestPortal(player.getPosition()));\n+                } else {\n+                    player.dropMessage(\"Target isn't on your channel, not able to warp into event instance.\");\n+                }\n+            } else {//If victim isn't in an event instance or is in the same event instance as the one the caller is, just warp them.\n+                victim.changeMap(player.getMapId(), player.getMap().findClosestPortal(player.getPosition()));\n+            }\n+            if (player.getClient().getChannel() != victim.getClient().getChannel()) {//And then change channel if needed.\n+                victim.dropMessage(\"Changing channel, please wait a moment.\");\n+                victim.getClient().changeChannel(player.getClient().getChannel());\n+            }\n+        } else {\n+            player.dropMessage(6, \"Unknown player.\");\n+        }\n+    }\n+}"}, {"sha": "de7fefd97ea8e8be13198c2fb2a2f1977c5d2e65", "filename": "src/client/command/commands/v2/UnBugCommand.java", "status": "added", "additions": 40, "deletions": 0, "changes": 40, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/UnBugCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/UnBugCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v2/UnBugCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,40 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v2;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import tools.MaplePacketCreator;\n+\n+public class UnBugCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        c.getPlayer().getMap().broadcastMessage(MaplePacketCreator.enableActions());\n+    }\n+}"}, {"sha": "37a8de853927434289927ab92e1f08800b7360c4", "filename": "src/client/command/commands/v2/UnHideCommand.java", "status": "added", "additions": 42, "deletions": 0, "changes": 42, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/UnHideCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/UnHideCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v2/UnHideCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,42 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v2;\n+\n+import client.SkillFactory;\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+\n+public class UnHideCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        SkillFactory.getSkill(9101004).getEffect(SkillFactory.getSkill(9101004).getMaxLevel()).applyTo(player);\n+\n+    }\n+}"}, {"sha": "52b2e86ff7459cd440581a08ec176117dfaa7fff", "filename": "src/client/command/commands/v2/UnJailCommand.java", "status": "added", "additions": 56, "deletions": 0, "changes": 56, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/UnJailCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/UnJailCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v2/UnJailCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,56 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v2;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+\n+public class UnJailCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 1) {\n+            player.yellowMessage(\"Syntax: !unjail <playername>\");\n+            return;\n+        }\n+\n+        MapleCharacter victim = c.getChannelServer().getPlayerStorage().getCharacterByName(params[0]);\n+        if (victim != null) {\n+            if (victim.getJailExpirationTimeLeft() <= 0) {\n+                player.message(\"This player is already free.\");\n+                return;\n+            }\n+            victim.removeJailExpirationTime();\n+            victim.message(\"By lack of concrete proof you are now unjailed. Enjoy freedom!\");\n+            player.message(victim.getName() + \" was unjailed.\");\n+        } else {\n+            player.message(\"Player '\" + params[0] + \"' could not be found on this channel.\");\n+        }\n+    }\n+}"}, {"sha": "95f3af15584021bd88b00fb20171cd72ff5f55e8", "filename": "src/client/command/commands/v2/WarpCommand.java", "status": "added", "additions": 58, "deletions": 0, "changes": 58, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/WarpCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/WarpCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v2/WarpCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,58 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v2;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import server.maps.MapleMap;\n+\n+public class WarpCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 1) {\n+            player.yellowMessage(\"Syntax: !warp <mapid>\");\n+            return;\n+        }\n+\n+        try {\n+            MapleMap target = c.getChannelServer().getMapFactory().getMap(Integer.parseInt(params[0]));\n+            if (target == null) {\n+                player.yellowMessage(\"Map ID \" + params[0] + \" is invalid.\");\n+                return;\n+            }\n+            if (player.getEventInstance() != null) {\n+                player.getEventInstance().leftParty(player);\n+            }\n+            player.changeMap(target, target.getRandomPlayerSpawnpoint());\n+        } catch (Exception ex) {\n+            player.yellowMessage(\"Map ID \" + params[0] + \" is invalid.\");\n+        }\n+    }\n+}"}, {"sha": "67f5207fdf3207f2d2ecf9632b4c014ec2ec4e37", "filename": "src/client/command/commands/v2/WarpToCommand.java", "status": "added", "additions": 78, "deletions": 0, "changes": 78, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/WarpToCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/WarpToCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v2/WarpToCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,78 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v2;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import net.server.Server;\n+import net.server.channel.Channel;\n+\n+public class WarpToCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 2) {\n+            player.yellowMessage(\"Syntax: !warpto <playername> <mapid>\");\n+            return;\n+        }\n+\n+        MapleCharacter victim = c.getChannelServer().getPlayerStorage().getCharacterByName(params[0]);\n+        if (victim == null) {//If victim isn't on current channel or isnt a character try and find him by loop all channels on current world.\n+            for (Channel ch : Server.getInstance().getChannelsFromWorld(c.getWorld())) {\n+                victim = ch.getPlayerStorage().getCharacterByName(params[0]);\n+                if (victim != null) {\n+                    break;//We found the person, no need to continue the loop.\n+                }\n+            }\n+        }\n+        if (victim != null) {//If target isn't null attempt to warp.\n+            //Remove warper from current event instance.\n+            if (player.getEventInstance() != null) {\n+                player.getEventInstance().unregisterPlayer(player);\n+            }\n+            //Attempt to join the victims warp instance.\n+            if (victim.getEventInstance() != null) {\n+                if (victim.getClient().getChannel() == player.getClient().getChannel()) {//just in case.. you never know...\n+                    //victim.getEventInstance().registerPlayer(player);\n+                    player.changeMap(victim.getEventInstance().getMapInstance(victim.getMapId()), victim.getMap().findClosestPortal(victim.getPosition()));\n+                } else {\n+                    player.dropMessage(6, \"Please change to channel \" + victim.getClient().getChannel());\n+                }\n+            } else {//If victim isn't in an event instance, just warp them.\n+                player.changeMap(victim.getMapId(), victim.getMap().findClosestPortal(victim.getPosition()));\n+            }\n+            if (player.getClient().getChannel() != victim.getClient().getChannel()) {//And then change channel if needed.\n+                player.dropMessage(\"Changing channel, please wait a moment.\");\n+                player.getClient().changeChannel(victim.getClient().getChannel());\n+            }\n+        } else {\n+            player.dropMessage(6, \"Unknown player.\");\n+        }\n+    }\n+}"}, {"sha": "54ff6299e6bf99c0a348d6b1a5a877936f66190c", "filename": "src/client/command/commands/v2/WhereaMiCommand.java", "status": "added", "additions": 64, "deletions": 0, "changes": 64, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/WhereaMiCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v2/WhereaMiCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v2/WhereaMiCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,64 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v2;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import server.life.MapleMonster;\n+import server.life.MapleNPC;\n+import server.maps.MapleMapObject;\n+\n+public class WhereaMiCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        player.yellowMessage(\"Map ID: \" + player.getMap().getId());\n+        player.yellowMessage(\"Players on this map:\");\n+        for (MapleMapObject mmo : player.getMap().getPlayers()) {\n+            MapleCharacter chr = (MapleCharacter) mmo;\n+            player.dropMessage(5, \">> \" + chr.getName() + \" - \" + chr.getId() + \" - Oid: \" + chr.getObjectId());\n+        }\n+        player.yellowMessage(\"NPCs on this map:\");\n+        for (MapleMapObject npcs : player.getMap().getMapObjects()) {\n+            if (npcs instanceof MapleNPC) {\n+                MapleNPC npc = (MapleNPC) npcs;\n+                player.dropMessage(5, \">> \" + npc.getName() + \" - \" + npc.getId() + \" - Oid: \" + npc.getObjectId());\n+            }\n+        }\n+        player.yellowMessage(\"Monsters on this map:\");\n+        for (MapleMapObject mobs : player.getMap().getMapObjects()) {\n+            if (mobs instanceof MapleMonster) {\n+                MapleMonster mob = (MapleMonster) mobs;\n+                if (mob.isAlive()) {\n+                    player.dropMessage(5, \">> \" + mob.getName() + \" - \" + mob.getId() + \" - Oid: \" + mob.getObjectId());\n+                }\n+            }\n+        }\n+    }\n+}"}, {"sha": "3d6f6bbdeb112a211740a9627e3f5d88cc66b4d4", "filename": "src/client/command/commands/v3/BanCommand.java", "status": "added", "additions": 96, "deletions": 0, "changes": 96, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/BanCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/BanCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/BanCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,96 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import net.server.Server;\n+import server.TimerManager;\n+import tools.DatabaseConnection;\n+import tools.MaplePacketCreator;\n+\n+import java.sql.Connection;\n+import java.sql.PreparedStatement;\n+import java.sql.SQLException;\n+\n+public class BanCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 2) {\n+            player.yellowMessage(\"Syntax: !ban <IGN> <Reason> (Please be descriptive)\");\n+            return;\n+        }\n+        String ign = params[0];\n+        String reason = joinStringFrom(params, 1);\n+        MapleCharacter target = c.getChannelServer().getPlayerStorage().getCharacterByName(ign);\n+        if (target != null) {\n+            String readableTargetName = MapleCharacter.makeMapleReadable(target.getName());\n+            String ip = target.getClient().getSession().getRemoteAddress().toString().split(\":\")[0];\n+            //Ban ip\n+            PreparedStatement ps = null;\n+            try {\n+                Connection con = DatabaseConnection.getConnection();\n+                if (ip.matches(\"/[0-9]{1,3}\\\\..*\")) {\n+                    ps = con.prepareStatement(\"INSERT INTO ipbans VALUES (DEFAULT, ?, ?)\");\n+                    ps.setString(1, ip);\n+                    ps.setString(2, String.valueOf(target.getClient().getAccID()));\n+\n+                    ps.executeUpdate();\n+                    ps.close();\n+                }\n+\n+                con.close();\n+            } catch (SQLException ex) {\n+                ex.printStackTrace();\n+                c.getPlayer().message(\"Error occured while banning IP address\");\n+                c.getPlayer().message(target.getName() + \"'s IP was not banned: \" + ip);\n+            }\n+            target.getClient().banMacs();\n+            reason = c.getPlayer().getName() + \" banned \" + readableTargetName + \" for \" + reason + \" (IP: \" + ip + \") \" + \"(MAC: \" + c.getMacs() + \")\";\n+            target.ban(reason);\n+            target.yellowMessage(\"You have been banned by #b\" + c.getPlayer().getName() + \" #k.\");\n+            target.yellowMessage(\"Reason: \" + reason);\n+            c.announce(MaplePacketCreator.getGMEffect(4, (byte) 0));\n+            final MapleCharacter rip = target;\n+            TimerManager.getInstance().schedule(new Runnable() {\n+                @Override\n+                public void run() {\n+                    rip.getClient().disconnect(false, false);\n+                }\n+            }, 5000); //5 Seconds\n+            Server.getInstance().broadcastMessage(c.getWorld(), MaplePacketCreator.serverNotice(6, \"[RIP]: \" + ign + \" has been banned.\"));\n+        } else if (MapleCharacter.ban(ign, reason, false)) {\n+            c.announce(MaplePacketCreator.getGMEffect(4, (byte) 0));\n+            Server.getInstance().broadcastMessage(c.getWorld(), MaplePacketCreator.serverNotice(6, \"[RIP]: \" + ign + \" has been banned.\"));\n+        } else {\n+            c.announce(MaplePacketCreator.getGMEffect(6, (byte) 1));\n+        }\n+    }\n+}"}, {"sha": "298b4c9d3294d129a13a20bf3841bb739a48e525", "filename": "src/client/command/commands/v3/ChatCommand.java", "status": "added", "additions": 41, "deletions": 0, "changes": 41, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/ChatCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/ChatCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/ChatCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,41 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+\n+public class ChatCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        player.toggleWhiteChat();\n+        player.message(\"Your chat is now \" + (player.getWhiteChat() ? \" white\" : \"normal\") + \".\");\n+    }\n+}"}, {"sha": "9809288bc819fab3e6a6f766c38a1034ee1b7194", "filename": "src/client/command/commands/v3/CheckDmgCommand.java", "status": "added", "additions": 56, "deletions": 0, "changes": 56, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/CheckDmgCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/CheckDmgCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/CheckDmgCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,56 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.MapleBuffStat;\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+\n+public class CheckDmgCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        MapleCharacter victim = c.getWorldServer().getPlayerStorage().getCharacterByName(params[0]);\n+        if (victim != null) {\n+            int maxBase = victim.calculateMaxBaseDamage(victim.getTotalWatk());\n+            Integer watkBuff = victim.getBuffedValue(MapleBuffStat.WATK);\n+            Integer matkBuff = victim.getBuffedValue(MapleBuffStat.MATK);\n+            Integer blessing = victim.getSkillLevel(10000000 * player.getJobType() + 12);\n+            if (watkBuff == null) watkBuff = 0;\n+            if (matkBuff == null) matkBuff = 0;\n+\n+            player.dropMessage(5, \"Cur Str: \" + victim.getTotalStr() + \" Cur Dex: \" + victim.getTotalDex() + \" Cur Int: \" + victim.getTotalInt() + \" Cur Luk: \" + victim.getTotalLuk());\n+            player.dropMessage(5, \"Cur WATK: \" + victim.getTotalWatk() + \" Cur MATK: \" + victim.getTotalMagic());\n+            player.dropMessage(5, \"Cur WATK Buff: \" + watkBuff + \" Cur MATK Buff: \" + matkBuff + \" Cur Blessing Level: \" + blessing);\n+            player.dropMessage(5, victim.getName() + \"'s maximum base damage (before skills) is \" + maxBase);\n+        } else {\n+            player.message(\"Player '\" + params[0] + \"' could not be found on this world.\");\n+        }\n+    }\n+}"}, {"sha": "893d79073266cf07126dc1ecea81f921cc9d0d1d", "filename": "src/client/command/commands/v3/ClosePortalCommand.java", "status": "added", "additions": 44, "deletions": 0, "changes": 44, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/ClosePortalCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/ClosePortalCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/ClosePortalCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,44 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+\n+public class ClosePortalCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 1) {\n+            player.yellowMessage(\"Syntax: !closeportal <portalid>\");\n+            return;\n+        }\n+        player.getMap().getPortal(params[0]).setPortalState(false);\n+    }\n+}"}, {"sha": "40b6feff6d4d144d72983dc50f25de00ecf85996", "filename": "src/client/command/commands/v3/DebuffCommand.java", "status": "added", "additions": 118, "deletions": 0, "changes": 118, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/DebuffCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/DebuffCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/DebuffCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,118 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.MapleDisease;\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import server.life.MobSkill;\n+import server.life.MobSkillFactory;\n+import server.maps.MapleMapObject;\n+import server.maps.MapleMapObjectType;\n+\n+import java.util.Arrays;\n+\n+public class DebuffCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 1) {\n+            player.yellowMessage(\"Syntax: !debuff SLOW|SEDUCE|ZOMBIFY|CONFUSE|STUN|POISON|SEAL|DARKNESS|WEAKEN|CURSE\");\n+            return;\n+        }\n+\n+        MapleDisease disease = null;\n+        MobSkill skill = null;\n+\n+        switch (params[0].toUpperCase()) {\n+            case \"SLOW\":\n+                disease = MapleDisease.SLOW;\n+                skill = MobSkillFactory.getMobSkill(126, 7);\n+                break;\n+\n+            case \"SEDUCE\":\n+                disease = MapleDisease.SEDUCE;\n+                skill = MobSkillFactory.getMobSkill(128, 7);\n+                break;\n+\n+            case \"ZOMBIFY\":\n+                disease = MapleDisease.ZOMBIFY;\n+                skill = MobSkillFactory.getMobSkill(133, 1);\n+                break;\n+\n+            case \"CONFUSE\":\n+                disease = MapleDisease.CONFUSE;\n+                skill = MobSkillFactory.getMobSkill(132, 2);\n+                break;\n+\n+            case \"STUN\":\n+                disease = MapleDisease.STUN;\n+                skill = MobSkillFactory.getMobSkill(123, 7);\n+                break;\n+\n+            case \"POISON\":\n+                disease = MapleDisease.POISON;\n+                skill = MobSkillFactory.getMobSkill(125, 5);\n+                break;\n+\n+            case \"SEAL\":\n+                disease = MapleDisease.SEAL;\n+                skill = MobSkillFactory.getMobSkill(120, 1);\n+                break;\n+\n+            case \"DARKNESS\":\n+                disease = MapleDisease.DARKNESS;\n+                skill = MobSkillFactory.getMobSkill(121, 1);\n+                break;\n+\n+            case \"WEAKEN\":\n+                disease = MapleDisease.WEAKEN;\n+                skill = MobSkillFactory.getMobSkill(122, 1);\n+                break;\n+\n+            case \"CURSE\":\n+                disease = MapleDisease.CURSE;\n+                skill = MobSkillFactory.getMobSkill(124, 1);\n+                break;\n+        }\n+\n+        if (disease == null) {\n+            player.yellowMessage(\"Syntax: !debuff SLOW|SEDUCE|ZOMBIFY|CONFUSE|STUN|POISON|SEAL|DARKNESS|WEAKEN|CURSE\");\n+            return;\n+        }\n+\n+        for (MapleMapObject mmo : player.getMap().getMapObjectsInRange(player.getPosition(), 777777.7, Arrays.asList(MapleMapObjectType.PLAYER))) {\n+            MapleCharacter chr = (MapleCharacter) mmo;\n+\n+            if (chr.getId() != player.getId()) {\n+                chr.giveDebuff(disease, skill);\n+            }\n+        }\n+    }\n+}"}, {"sha": "1eb60675d3b2dded8122b9c420e1ce39deff0cec", "filename": "src/client/command/commands/v3/EndEventCommand.java", "status": "added", "additions": 41, "deletions": 0, "changes": 41, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/EndEventCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/EndEventCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/EndEventCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,41 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+\n+public class EndEventCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        c.getChannelServer().setEvent(null);\n+        player.dropMessage(5, \"You have ended the event. No more players may join.\");\n+    }\n+}"}, {"sha": "6b90241f5eaf5dd9deb4314cdbc3789d3609d65f", "filename": "src/client/command/commands/v3/ExpedsCommand.java", "status": "added", "additions": 66, "deletions": 0, "changes": 66, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/ExpedsCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/ExpedsCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/ExpedsCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,66 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import net.server.Server;\n+import net.server.channel.Channel;\n+import server.expeditions.MapleExpedition;\n+\n+public class ExpedsCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        for (Channel ch : Server.getInstance().getChannelsFromWorld(c.getWorld())) {\n+            if (ch.getExpeditions().isEmpty()) {\n+                player.yellowMessage(\"No Expeditions in Channel \" + ch.getId());\n+                continue;\n+            }\n+            player.yellowMessage(\"Expeditions in Channel \" + ch.getId());\n+            int id = 0;\n+            for (MapleExpedition exped : ch.getExpeditions()) {\n+                id++;\n+                player.yellowMessage(\"> Expedition \" + id);\n+                player.yellowMessage(\">> Type: \" + exped.getType().toString());\n+                player.yellowMessage(\">> Status: \" + (exped.isRegistering() ? \"REGISTERING\" : \"UNDERWAY\"));\n+                player.yellowMessage(\">> Size: \" + exped.getMembers().size());\n+                player.yellowMessage(\">> Leader: \" + exped.getLeader().getName());\n+                int memId = 2;\n+                for (MapleCharacter member : exped.getMembers()) {\n+                    if (exped.isLeader(member)) {\n+                        continue;\n+                    }\n+                    player.yellowMessage(\">>> Member \" + memId + \": \" + member.getName());\n+                    memId++;\n+                }\n+            }\n+        }\n+    }\n+}"}, {"sha": "0611d7a823afe6f4a4818c0f6321f2f80a770f8c", "filename": "src/client/command/commands/v3/FaceCommand.java", "status": "added", "additions": 75, "deletions": 0, "changes": 75, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/FaceCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/FaceCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/FaceCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,75 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.MapleStat;\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import server.MapleItemInformationProvider;\n+\n+public class FaceCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 1) {\n+            player.yellowMessage(\"Syntax: !face [<playername>] <faceid>\");\n+            return;\n+        }\n+\n+        try {\n+            if (params.length == 1) {\n+                int itemId = Integer.parseInt(params[0]);\n+                if (!(itemId >= 20000 && itemId < 22000) || MapleItemInformationProvider.getInstance().getName(itemId) == null) {\n+                    player.yellowMessage(\"Face id '\" + params[0] + \"' does not exist.\");\n+                    return;\n+                }\n+\n+                player.setFace(itemId);\n+                player.updateSingleStat(MapleStat.FACE, itemId);\n+                player.equipChanged();\n+            } else {\n+                int itemId = Integer.parseInt(params[1]);\n+                if (!(itemId >= 20000 && itemId < 22000) || MapleItemInformationProvider.getInstance().getName(itemId) == null) {\n+                    player.yellowMessage(\"Face id '\" + params[1] + \"' does not exist.\");\n+                }\n+\n+                MapleCharacter victim = c.getChannelServer().getPlayerStorage().getCharacterByName(params[0]);\n+                if (victim == null) {\n+                    victim.setFace(itemId);\n+                    victim.updateSingleStat(MapleStat.FACE, itemId);\n+                    victim.equipChanged();\n+                } else {\n+                    player.yellowMessage(\"Player '\" + params[0] + \"' has not been found on this channel.\");\n+                }\n+            }\n+        } catch (Exception e) {\n+        }\n+\n+    }\n+}"}, {"sha": "b51d70336c6fb40721c928813a4c1c976fbf79af", "filename": "src/client/command/commands/v3/FameCommand.java", "status": "added", "additions": 53, "deletions": 0, "changes": 53, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/FameCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/FameCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/FameCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,53 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.MapleStat;\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+\n+public class FameCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 2) {\n+            player.yellowMessage(\"Syntax: !fame <playername> <gainfame>\");\n+            return;\n+        }\n+\n+        MapleCharacter victim = c.getChannelServer().getPlayerStorage().getCharacterByName(params[0]);\n+        if (victim != null) {\n+            victim.setFame(Integer.parseInt(params[1]));\n+            victim.updateSingleStat(MapleStat.FAME, victim.getFame());\n+            player.message(\"FAME given.\");\n+        } else {\n+            player.message(\"Player '\" + params[0] + \"' could not be found on this channel.\");\n+        }\n+    }\n+}"}, {"sha": "4929dcaa97da6d76e06ca08bc88b302f255dc788", "filename": "src/client/command/commands/v3/FlyCommand.java", "status": "added", "additions": 61, "deletions": 0, "changes": 61, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/FlyCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/FlyCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/FlyCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,61 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import net.server.Server;\n+\n+public class FlyCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) { // fly option will become available for any character of that account\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 1) {\n+            player.yellowMessage(\"Syntax: !fly <on/off>\");\n+            return;\n+        }\n+\n+        Integer accid = c.getAccID();\n+        Server srv = Server.getInstance();\n+        String sendStr = \"\";\n+        if (params[0].equalsIgnoreCase(\"on\")) {\n+            sendStr += \"Enabled Fly feature (F1). With fly active, you cannot attack.\";\n+            if (!srv.canFly(accid)) sendStr += \" Re-login to take effect.\";\n+\n+            srv.changeFly(c.getAccID(), true);\n+        } else {\n+            sendStr += \"Disabled Fly feature. You can now attack.\";\n+            if (srv.canFly(accid)) sendStr += \" Re-login to take effect.\";\n+\n+            srv.changeFly(c.getAccID(), false);\n+        }\n+\n+        player.dropMessage(6, sendStr);\n+    }\n+}"}, {"sha": "946e828da369b9494f9a504555c790fdcf0bb00f", "filename": "src/client/command/commands/v3/GiveMesosCommand.java", "status": "added", "additions": 60, "deletions": 0, "changes": 60, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/GiveMesosCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/GiveMesosCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/GiveMesosCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,60 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+\n+public class GiveMesosCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 1) {\n+            player.yellowMessage(\"Syntax: !givems [<playername>] <gainmeso>\");\n+            return;\n+        }\n+\n+        String recv_;\n+        int value_;\n+        if (params.length == 2) {\n+            recv_ = params[0];\n+            value_ = Integer.parseInt(params[1]);\n+        } else {\n+            recv_ = c.getPlayer().getName();\n+            value_ = Integer.parseInt(params[0]);\n+        }\n+        MapleCharacter victim = c.getChannelServer().getPlayerStorage().getCharacterByName(recv_);\n+        if (victim != null) {\n+            victim.gainMeso(value_, true);\n+            player.message(\"MESO given.\");\n+        } else {\n+            player.message(\"Player '\" + recv_ + \"' could not be found on this channel.\");\n+        }\n+    }\n+}"}, {"sha": "6294b98892da460e9a3832373799e52dfefbb7a1", "filename": "src/client/command/commands/v3/GiveNxCommand.java", "status": "added", "additions": 61, "deletions": 0, "changes": 61, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/GiveNxCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/GiveNxCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/GiveNxCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,61 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+\n+public class GiveNxCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 1) {\n+            player.yellowMessage(\"Syntax: !givenx [<playername>] <gainnx>\");\n+            return;\n+        }\n+\n+        String recv;\n+        int value;\n+        if (params.length > 1) {\n+            recv = params[0];\n+            value = Integer.parseInt(params[1]);\n+        } else {\n+            recv = c.getPlayer().getName();\n+            value = Integer.parseInt(params[0]);\n+        }\n+\n+        MapleCharacter victim = c.getChannelServer().getPlayerStorage().getCharacterByName(recv);\n+        if (victim != null) {\n+            victim.getCashShop().gainCash(1, value);\n+            player.message(\"NX given.\");\n+        } else {\n+            player.message(\"Player '\" + recv + \"' could not be found on this channel.\");\n+        }\n+    }\n+}"}, {"sha": "ce6b642f97bc2bc5ee8a9e5ce684455d1f9c3065", "filename": "src/client/command/commands/v3/GiveVpCommand.java", "status": "added", "additions": 51, "deletions": 0, "changes": 51, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/GiveVpCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/GiveVpCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/GiveVpCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,51 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+\n+public class GiveVpCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 2) {\n+            player.yellowMessage(\"Syntax: !givevp <playername> <gainvotepoint>\");\n+            return;\n+        }\n+\n+        MapleCharacter victim = c.getChannelServer().getPlayerStorage().getCharacterByName(params[0]);\n+        if (victim != null) {\n+            victim.getClient().addVotePoints(Integer.parseInt(params[1]));\n+            player.message(\"VP given.\");\n+        } else {\n+            player.message(\"Player '\" + params[0] + \"' could not be found on this channel.\");\n+        }\n+    }\n+}"}, {"sha": "b9f3a310585bad84e8e234b3d85f5b7c1e1bd96e", "filename": "src/client/command/commands/v3/HairCommand.java", "status": "added", "additions": 75, "deletions": 0, "changes": 75, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/HairCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/HairCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/HairCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,75 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.MapleStat;\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import server.MapleItemInformationProvider;\n+\n+public class HairCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 1) {\n+            player.yellowMessage(\"Syntax: !hair [<playername>] <hairid>\");\n+            return;\n+        }\n+\n+        try {\n+            if (params.length == 1) {\n+                int itemId = Integer.parseInt(params[0]);\n+                if (!(itemId >= 30000 && itemId < 35000) || MapleItemInformationProvider.getInstance().getName(itemId) == null) {\n+                    player.yellowMessage(\"Hair id '\" + params[0] + \"' does not exist.\");\n+                    return;\n+                }\n+\n+                player.setHair(itemId);\n+                player.updateSingleStat(MapleStat.HAIR, itemId);\n+                player.equipChanged();\n+            } else {\n+                int itemId = Integer.parseInt(params[1]);\n+                if (!(itemId >= 30000 && itemId < 35000) || MapleItemInformationProvider.getInstance().getName(itemId) == null) {\n+                    player.yellowMessage(\"Hair id '\" + params[1] + \"' does not exist.\");\n+                    return;\n+                }\n+\n+                MapleCharacter victim = c.getChannelServer().getPlayerStorage().getCharacterByName(params[0]);\n+                if (victim != null) {\n+                    victim.setHair(itemId);\n+                    victim.updateSingleStat(MapleStat.HAIR, itemId);\n+                    victim.equipChanged();\n+                } else {\n+                    player.yellowMessage(\"Player '\" + params[0] + \"' has not been found on this channel.\");\n+                }\n+            }\n+        } catch (Exception e) {\n+        }\n+    }\n+}"}, {"sha": "aedfc4cac869c5fb13fdde1688dacc91b63692e0", "filename": "src/client/command/commands/v3/HealMapCommand.java", "status": "added", "additions": 48, "deletions": 0, "changes": 48, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/HealMapCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/HealMapCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/HealMapCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,48 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.MapleStat;\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+\n+public class HealMapCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        for (MapleCharacter mch : player.getMap().getCharacters()) {\n+            if (mch != null) {\n+                mch.setHp(mch.getMaxHp());\n+                mch.updateSingleStat(MapleStat.HP, mch.getMaxHp());\n+                mch.setMp(mch.getMaxMp());\n+                mch.updateSingleStat(MapleStat.MP, mch.getMaxMp());\n+            }\n+        }\n+    }\n+}"}, {"sha": "6c6c0f9aad94154062107b7de38b40d5921559ec", "filename": "src/client/command/commands/v3/HealPersonCommand.java", "status": "added", "additions": 49, "deletions": 0, "changes": 49, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/HealPersonCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/HealPersonCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/HealPersonCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,49 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.MapleStat;\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+\n+public class HealPersonCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        MapleCharacter victim = c.getChannelServer().getPlayerStorage().getCharacterByName(params[0]);\n+        if (victim != null) {\n+            victim.setHp(victim.getMaxHp());\n+            victim.updateSingleStat(MapleStat.HP, victim.getMaxHp());\n+            victim.setMp(victim.getMaxMp());\n+            victim.updateSingleStat(MapleStat.MP, victim.getMaxMp());\n+        } else {\n+            player.message(\"Player '\" + params[0] + \"' could not be found on this channel.\");\n+        }\n+    }\n+}"}, {"sha": "30b680825d86e1d774b247d1d0fb3b156e4f2b23", "filename": "src/client/command/commands/v3/HpMpCommand.java", "status": "added", "additions": 62, "deletions": 0, "changes": 62, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/HpMpCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/HpMpCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/HpMpCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,62 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.MapleStat;\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+\n+public class HpMpCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        MapleCharacter victim = player;\n+        int statUpdate = 1;\n+\n+        if (params.length == 2) {\n+            victim = c.getWorldServer().getPlayerStorage().getCharacterByName(params[0]);\n+            statUpdate = Integer.valueOf(params[1]);\n+        } else if (params.length == 1) {\n+            statUpdate = Integer.valueOf(params[0]);\n+        } else {\n+            player.yellowMessage(\"Syntax: !hpmp [<playername>] <value>\");\n+        }\n+\n+        if (victim != null) {\n+            victim.setHp(statUpdate);\n+            victim.setMp(statUpdate);\n+            victim.updateSingleStat(MapleStat.HP, statUpdate);\n+            victim.updateSingleStat(MapleStat.MP, statUpdate);\n+\n+            victim.checkBerserk(victim.isHidden());\n+        } else {\n+            player.message(\"Player '\" + params[0] + \"' could not be found on this world.\");\n+        }\n+    }\n+}"}, {"sha": "069454b6f930cd6a77606967ce45bf72c682fbec", "filename": "src/client/command/commands/v3/HurtCommand.java", "status": "added", "additions": 47, "deletions": 0, "changes": 47, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/HurtCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/HurtCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/HurtCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,47 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.MapleStat;\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+\n+public class HurtCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        MapleCharacter victim = c.getChannelServer().getPlayerStorage().getCharacterByName(params[0]);\n+        if (victim != null) {\n+            victim.setHp(1);\n+            victim.updateSingleStat(MapleStat.HP, 1);\n+        } else {\n+            player.message(\"Player '\" + params[0] + \"' could not be found on this channel.\");\n+        }\n+    }\n+}"}, {"sha": "72482685983f7ffae0d8532adf7407c6eee90a00", "filename": "src/client/command/commands/v3/IdCommand.java", "status": "added", "additions": 57, "deletions": 0, "changes": 57, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/IdCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/IdCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/IdCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,57 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+\n+import java.io.BufferedReader;\n+import java.io.InputStreamReader;\n+import java.net.URL;\n+\n+public class IdCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 1) {\n+            player.yellowMessage(\"Syntax: !id <id>\");\n+            return;\n+        }\n+        try {\n+            try (BufferedReader dis = new BufferedReader(new InputStreamReader(new URL(\"http://www.mapletip.com/search_java.php?search_value=\" + params[0] + \"&check=true\").openConnection().getInputStream()))) {\n+                String s;\n+                while ((s = dis.readLine()) != null) {\n+                    player.dropMessage(s);\n+                }\n+            }\n+        } catch (Exception e) {\n+            e.printStackTrace();\n+        }\n+    }\n+}"}, {"sha": "9d58f4e1e376d93ac92eda7757e139555a590860", "filename": "src/client/command/commands/v3/IgnoreCommand.java", "status": "added", "additions": 61, "deletions": 0, "changes": 61, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/IgnoreCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/IgnoreCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/IgnoreCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,61 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import net.server.Server;\n+import tools.MapleLogger;\n+import tools.MaplePacketCreator;\n+\n+public class IgnoreCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 1) {\n+            player.yellowMessage(\"Syntax: !ignore <ign>\");\n+            return;\n+        }\n+        MapleCharacter victim = c.getWorldServer().getPlayerStorage().getCharacterByName(params[0]);\n+        if (victim == null) {\n+            player.message(\"Player '\" + params[0] + \"' could not be found on this world.\");\n+            return;\n+        }\n+        boolean monitored_ = MapleLogger.ignored.contains(victim.getName());\n+        if (monitored_) {\n+            MapleLogger.ignored.remove(victim.getName());\n+        } else {\n+            MapleLogger.ignored.add(victim.getName());\n+        }\n+        player.yellowMessage(victim.getName() + \" is \" + (!monitored_ ? \"now being ignored.\" : \"no longer being ignored.\"));\n+        String message_ = player.getName() + (!monitored_ ? \" has started ignoring \" : \" has stopped ignoring \") + victim.getName() + \".\";\n+        Server.getInstance().broadcastGMMessage(c.getWorld(), MaplePacketCreator.serverNotice(5, message_));\n+\n+    }\n+}"}, {"sha": "c4b287477acec51bb66d68f3e78a777141d02a9e", "filename": "src/client/command/commands/v3/IgnoredCommand.java", "status": "added", "additions": 43, "deletions": 0, "changes": 43, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/IgnoredCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/IgnoredCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/IgnoredCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,43 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import tools.MapleLogger;\n+\n+public class IgnoredCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        for (String ign : MapleLogger.ignored) {\n+            player.yellowMessage(ign + \" is being ignored.\");\n+        }\n+    }\n+}"}, {"sha": "a33d27b7d77b1f537c6aae787c7f1bea39a44ca1", "filename": "src/client/command/commands/v3/InMapCommand.java", "status": "added", "additions": 45, "deletions": 0, "changes": 45, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/InMapCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/InMapCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/InMapCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,45 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+\n+public class InMapCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        String st = \"\";\n+        for (MapleCharacter chr : player.getMap().getCharacters()) {\n+            st += chr.getName() + \" \";\n+        }\n+        player.message(st);\n+\n+    }\n+}"}, {"sha": "c9426414365c69f058cd427ccc781fa8e5c75d7c", "filename": "src/client/command/commands/v3/KillAllCommand.java", "status": "added", "additions": 57, "deletions": 0, "changes": 57, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/KillAllCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/KillAllCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/KillAllCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,57 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import server.life.MapleMonster;\n+import server.maps.MapleMap;\n+import server.maps.MapleMapObject;\n+import server.maps.MapleMapObjectType;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+\n+public class KillAllCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        MapleMap map = player.getMap();\n+        List<MapleMapObject> monsters = map.getMapObjectsInRange(player.getPosition(), Double.POSITIVE_INFINITY, Arrays.asList(MapleMapObjectType.MONSTER));\n+        int count = 0;\n+        for (MapleMapObject monstermo : monsters) {\n+            MapleMonster monster = (MapleMonster) monstermo;\n+            if (!monster.getStats().isFriendly() && !(monster.getId() >= 8810010 && monster.getId() <= 8810018)) {\n+                map.damageMonster(player, monster, Integer.MAX_VALUE);\n+                count++;\n+            }\n+        }\n+        player.dropMessage(5, \"Killed \" + count + \" monsters.\");\n+    }\n+}"}, {"sha": "2801828c2e5f1d1c01153d2895982ebd4e272a59", "filename": "src/client/command/commands/v3/KillCommand.java", "status": "added", "additions": 53, "deletions": 0, "changes": 53, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/KillCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/KillCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/KillCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,53 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import net.server.Server;\n+import tools.MaplePacketCreator;\n+\n+public class KillCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 1) {\n+            player.yellowMessage(\"Syntax: !kill <playername>\");\n+            return;\n+        }\n+\n+        MapleCharacter victim = c.getChannelServer().getPlayerStorage().getCharacterByName(params[0]);\n+        if (victim != null) {\n+            victim.setHpMp(0);\n+            Server.getInstance().broadcastGMMessage(c.getWorld(), MaplePacketCreator.serverNotice(5, player.getName() + \" used !kill on \" + victim.getName()));\n+        } else {\n+            player.message(\"Player '\" + params[0] + \"' could not be found on this channel.\");\n+        }\n+    }\n+}"}, {"sha": "12e8421a97c367de74841ee56f941d432cdf9432", "filename": "src/client/command/commands/v3/KillMapCommand.java", "status": "added", "additions": 44, "deletions": 0, "changes": 44, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/KillMapCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/KillMapCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/KillMapCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,44 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.MapleStat;\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+\n+public class KillMapCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        for (MapleCharacter mch : player.getMap().getCharacters()) {\n+            mch.setHp(0);\n+            mch.updateSingleStat(MapleStat.HP, 0);\n+        }\n+    }\n+}"}, {"sha": "57c8ef545d013fbdf59c3e8ab84604ac4c3a80f8", "filename": "src/client/command/commands/v3/MaxEnergyCommand.java", "status": "added", "additions": 42, "deletions": 0, "changes": 42, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/MaxEnergyCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/MaxEnergyCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/MaxEnergyCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,42 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import tools.MaplePacketCreator;\n+\n+public class MaxEnergyCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        c.getPlayer().setDojoEnergy(10000);\n+        c.announce(MaplePacketCreator.getEnergy(\"energy\", 10000));\n+    }\n+}"}, {"sha": "55de83e58c741c0b757a4868918a23102840aebc", "filename": "src/client/command/commands/v3/MaxHpMpCommand.java", "status": "added", "additions": 79, "deletions": 0, "changes": 79, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/MaxHpMpCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/MaxHpMpCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/MaxHpMpCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,79 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.MapleStat;\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import java.util.ArrayList;\n+import java.util.List;\n+import tools.MaplePacketCreator;\n+import tools.Pair;\n+\n+public class MaxHpMpCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        MapleCharacter victim = player;\n+        int statUpdate = 1;\n+\n+        if (params.length >= 2) {\n+            victim = c.getWorldServer().getPlayerStorage().getCharacterByName(params[0]);\n+            statUpdate = Math.max(1, Integer.valueOf(params[1]));\n+        } else if (params.length == 1) {\n+            statUpdate = Math.max(1, Integer.valueOf(params[0]));\n+        } else {\n+            player.yellowMessage(\"Syntax: !maxhpmp [<playername>] <value>\");\n+        }\n+\n+        if (victim != null) {\n+            List<Pair<MapleStat, Integer>> statup = new ArrayList<>(4);\n+            \n+            if (victim.getHp() > statUpdate) {\n+                victim.setHp(statUpdate);\n+                statup.add(new Pair<>(MapleStat.HP, statUpdate));\n+            }\n+            statup.add(new Pair<>(MapleStat.MAXHP, statUpdate));\n+\n+            if (victim.getMp() > statUpdate) {\n+                victim.setMp(statUpdate);\n+                statup.add(new Pair<>(MapleStat.MP, statUpdate));\n+            }\n+            statup.add(new Pair<>(MapleStat.MAXMP, statUpdate));\n+            c.announce(MaplePacketCreator.updatePlayerStats(statup, victim));\n+\n+            victim.setMaxHp(statUpdate);\n+            victim.setMaxMp(statUpdate);\n+\n+            victim.checkBerserk(victim.isHidden());\n+        } else {\n+            player.message(\"Player '\" + params[0] + \"' could not be found on this world.\");\n+        }\n+    }\n+}"}, {"sha": "ce20568df6752c0ab9c9e5caba94f464bdc4c4cc", "filename": "src/client/command/commands/v3/MonitorCommand.java", "status": "added", "additions": 61, "deletions": 0, "changes": 61, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/MonitorCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/MonitorCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/MonitorCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,61 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import net.server.Server;\n+import tools.MapleLogger;\n+import tools.MaplePacketCreator;\n+\n+public class MonitorCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 1) {\n+            player.yellowMessage(\"Syntax: !monitor <ign>\");\n+            return;\n+        }\n+        MapleCharacter victim = c.getWorldServer().getPlayerStorage().getCharacterByName(params[0]);\n+        if (victim == null) {\n+            player.message(\"Player '\" + params[0] + \"' could not be found on this world.\");\n+            return;\n+        }\n+        boolean monitored = MapleLogger.monitored.contains(victim.getName());\n+        if (monitored) {\n+            MapleLogger.monitored.remove(victim.getName());\n+        } else {\n+            MapleLogger.monitored.add(victim.getName());\n+        }\n+        player.yellowMessage(victim.getName() + \" is \" + (!monitored ? \"now being monitored.\" : \"no longer being monitored.\"));\n+        String message = player.getName() + (!monitored ? \" has started monitoring \" : \" has stopped monitoring \") + victim.getName() + \".\";\n+        Server.getInstance().broadcastGMMessage(c.getWorld(), MaplePacketCreator.serverNotice(5, message));\n+\n+    }\n+}"}, {"sha": "5adbeca2ad9f1f4aeab73f6c312d6798f8dea35f", "filename": "src/client/command/commands/v3/MonitorsCommand.java", "status": "added", "additions": 43, "deletions": 0, "changes": 43, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/MonitorsCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/MonitorsCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/MonitorsCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,43 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import tools.MapleLogger;\n+\n+public class MonitorsCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        for (String ign : MapleLogger.monitored) {\n+            player.yellowMessage(ign + \" is being monitored.\");\n+        }\n+    }\n+}"}, {"sha": "eb664d228e2dde88c51dc87e9c479a088bf50431", "filename": "src/client/command/commands/v3/MusicCommand.java", "status": "added", "additions": 213, "deletions": 0, "changes": 213, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/MusicCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/MusicCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/MusicCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,213 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import tools.MaplePacketCreator;\n+\n+public class MusicCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        final String[] songs = {\n+                \"Jukebox/Congratulation\",\n+                \"Bgm00/SleepyWood\",\n+                \"Bgm00/FloralLife\",\n+                \"Bgm00/GoPicnic\",\n+                \"Bgm00/Nightmare\",\n+                \"Bgm00/RestNPeace\",\n+                \"Bgm01/AncientMove\",\n+                \"Bgm01/MoonlightShadow\",\n+                \"Bgm01/WhereTheBarlogFrom\",\n+                \"Bgm01/CavaBien\",\n+                \"Bgm01/HighlandStar\",\n+                \"Bgm01/BadGuys\",\n+                \"Bgm02/MissingYou\",\n+                \"Bgm02/WhenTheMorningComes\",\n+                \"Bgm02/EvilEyes\",\n+                \"Bgm02/JungleBook\",\n+                \"Bgm02/AboveTheTreetops\",\n+                \"Bgm03/Subway\",\n+                \"Bgm03/Elfwood\",\n+                \"Bgm03/BlueSky\",\n+                \"Bgm03/Beachway\",\n+                \"Bgm03/SnowyVillage\",\n+                \"Bgm04/PlayWithMe\",\n+                \"Bgm04/WhiteChristmas\",\n+                \"Bgm04/UponTheSky\",\n+                \"Bgm04/ArabPirate\",\n+                \"Bgm04/Shinin'Harbor\",\n+                \"Bgm04/WarmRegard\",\n+                \"Bgm05/WolfWood\",\n+                \"Bgm05/DownToTheCave\",\n+                \"Bgm05/AbandonedMine\",\n+                \"Bgm05/MineQuest\",\n+                \"Bgm05/HellGate\",\n+                \"Bgm06/FinalFight\",\n+                \"Bgm06/WelcomeToTheHell\",\n+                \"Bgm06/ComeWithMe\",\n+                \"Bgm06/FlyingInABlueDream\",\n+                \"Bgm06/FantasticThinking\",\n+                \"Bgm07/WaltzForWork\",\n+                \"Bgm07/WhereverYouAre\",\n+                \"Bgm07/FunnyTimeMaker\",\n+                \"Bgm07/HighEnough\",\n+                \"Bgm07/Fantasia\",\n+                \"Bgm08/LetsMarch\",\n+                \"Bgm08/ForTheGlory\",\n+                \"Bgm08/FindingForest\",\n+                \"Bgm08/LetsHuntAliens\",\n+                \"Bgm08/PlotOfPixie\",\n+                \"Bgm09/DarkShadow\",\n+                \"Bgm09/TheyMenacingYou\",\n+                \"Bgm09/FairyTale\",\n+                \"Bgm09/FairyTalediffvers\",\n+                \"Bgm09/TimeAttack\",\n+                \"Bgm10/Timeless\",\n+                \"Bgm10/TimelessB\",\n+                \"Bgm10/BizarreTales\",\n+                \"Bgm10/TheWayGrotesque\",\n+                \"Bgm10/Eregos\",\n+                \"Bgm11/BlueWorld\",\n+                \"Bgm11/Aquarium\",\n+                \"Bgm11/ShiningSea\",\n+                \"Bgm11/DownTown\",\n+                \"Bgm11/DarkMountain\",\n+                \"Bgm12/AquaCave\",\n+                \"Bgm12/DeepSee\",\n+                \"Bgm12/WaterWay\",\n+                \"Bgm12/AcientRemain\",\n+                \"Bgm12/RuinCastle\",\n+                \"Bgm12/Dispute\",\n+                \"Bgm13/CokeTown\",\n+                \"Bgm13/Leafre\",\n+                \"Bgm13/Minar'sDream\",\n+                \"Bgm13/AcientForest\",\n+                \"Bgm13/TowerOfGoddess\",\n+                \"Bgm14/DragonLoad\",\n+                \"Bgm14/HonTale\",\n+                \"Bgm14/CaveOfHontale\",\n+                \"Bgm14/DragonNest\",\n+                \"Bgm14/Ariant\",\n+                \"Bgm14/HotDesert\",\n+                \"Bgm15/MureungHill\",\n+                \"Bgm15/MureungForest\",\n+                \"Bgm15/WhiteHerb\",\n+                \"Bgm15/Pirate\",\n+                \"Bgm15/SunsetDesert\",\n+                \"Bgm16/Duskofgod\",\n+                \"Bgm16/FightingPinkBeen\",\n+                \"Bgm16/Forgetfulness\",\n+                \"Bgm16/Remembrance\",\n+                \"Bgm16/Repentance\",\n+                \"Bgm16/TimeTemple\",\n+                \"Bgm17/MureungSchool1\",\n+                \"Bgm17/MureungSchool2\",\n+                \"Bgm17/MureungSchool3\",\n+                \"Bgm17/MureungSchool4\",\n+                \"Bgm18/BlackWing\",\n+                \"Bgm18/DrillHall\",\n+                \"Bgm18/QueensGarden\",\n+                \"Bgm18/RaindropFlower\",\n+                \"Bgm18/WolfAndSheep\",\n+                \"Bgm19/BambooGym\",\n+                \"Bgm19/CrystalCave\",\n+                \"Bgm19/MushCatle\",\n+                \"Bgm19/RienVillage\",\n+                \"Bgm19/SnowDrop\",\n+                \"Bgm20/GhostShip\",\n+                \"Bgm20/NetsPiramid\",\n+                \"Bgm20/UnderSubway\",\n+                \"Bgm21/2021year\",\n+                \"Bgm21/2099year\",\n+                \"Bgm21/2215year\",\n+                \"Bgm21/2230year\",\n+                \"Bgm21/2503year\",\n+                \"Bgm21/KerningSquare\",\n+                \"Bgm21/KerningSquareField\",\n+                \"Bgm21/KerningSquareSubway\",\n+                \"Bgm21/TeraForest\",\n+                \"BgmEvent/FunnyRabbit\",\n+                \"BgmEvent/FunnyRabbitFaster\",\n+                \"BgmEvent/wedding\",\n+                \"BgmEvent/weddingDance\",\n+                \"BgmEvent/wichTower\",\n+                \"BgmGL/amoria\",\n+                \"BgmGL/Amorianchallenge\",\n+                \"BgmGL/chapel\",\n+                \"BgmGL/cathedral\",\n+                \"BgmGL/Courtyard\",\n+                \"BgmGL/CrimsonwoodKeep\",\n+                \"BgmGL/CrimsonwoodKeepInterior\",\n+                \"BgmGL/GrandmastersGauntlet\",\n+                \"BgmGL/HauntedHouse\",\n+                \"BgmGL/NLChunt\",\n+                \"BgmGL/NLCtown\",\n+                \"BgmGL/NLCupbeat\",\n+                \"BgmGL/PartyQuestGL\",\n+                \"BgmGL/PhantomForest\",\n+                \"BgmJp/Feeling\",\n+                \"BgmJp/BizarreForest\",\n+                \"BgmJp/Hana\",\n+                \"BgmJp/Yume\",\n+                \"BgmJp/Bathroom\",\n+                \"BgmJp/BattleField\",\n+                \"BgmJp/FirstStepMaster\",\n+                \"BgmMY/Highland\",\n+                \"BgmMY/KualaLumpur\",\n+                \"BgmSG/BoatQuay_field\",\n+                \"BgmSG/BoatQuay_town\",\n+                \"BgmSG/CBD_field\",\n+                \"BgmSG/CBD_town\",\n+                \"BgmSG/Ghostship\",\n+                \"BgmUI/ShopBgm\",\n+                \"BgmUI/Title\"\n+        };\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 1) {\n+            player.yellowMessage(\"Syntax: !music <song>\");\n+            for (String s : songs) {\n+                player.yellowMessage(s);\n+            }\n+            return;\n+        }\n+        String song = joinStringFrom(params, 0);\n+        for (String s : songs) {\n+            if (s.equals(song)) {\n+                player.getMap().broadcastMessage(MaplePacketCreator.musicChange(s));\n+                player.yellowMessage(\"Now playing song \" + song + \".\");\n+                break;\n+            }\n+        }\n+        player.yellowMessage(\"Song not found, please enter a song below.\");\n+        for (String s : songs) {\n+            player.yellowMessage(s);\n+        }\n+    }\n+}"}, {"sha": "45bb445ba724312ab5e07fec64a819551b99226a", "filename": "src/client/command/commands/v3/MuteMapCommand.java", "status": "added", "additions": 46, "deletions": 0, "changes": 46, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/MuteMapCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/MuteMapCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/MuteMapCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,46 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+\n+public class MuteMapCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (player.getMap().isMuted()) {\n+            player.getMap().setMuted(false);\n+            player.dropMessage(5, \"The map you are in has been un-muted.\");\n+        } else {\n+            player.getMap().setMuted(true);\n+            player.dropMessage(5, \"The map you are in has been muted.\");\n+        }\n+    }\n+}"}, {"sha": "ec1eb7b9ed50a666e475e2e4bdc9fc6c57b34fe4", "filename": "src/client/command/commands/v3/NightCommand.java", "status": "added", "additions": 41, "deletions": 0, "changes": 41, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/NightCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/NightCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/NightCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,41 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+\n+public class NightCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        player.getMap().broadcastNightEffect();\n+        player.yellowMessage(\"Done.\");\n+    }\n+}"}, {"sha": "8c22496d9f464bf0281352cd802119247db67e4f", "filename": "src/client/command/commands/v3/NoticeCommand.java", "status": "added", "additions": 42, "deletions": 0, "changes": 42, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/NoticeCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/NoticeCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/NoticeCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,42 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import net.server.Server;\n+import tools.MaplePacketCreator;\n+\n+public class NoticeCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        Server.getInstance().broadcastMessage(c.getWorld(), MaplePacketCreator.serverNotice(6, \"[Notice] \" + joinStringFrom(params, 0)));\n+    }\n+}"}, {"sha": "d5d68d0cf90aaad38e91b552cf5d379d12ca5269", "filename": "src/client/command/commands/v3/NpcCommand.java", "status": "added", "additions": 56, "deletions": 0, "changes": 56, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/NpcCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/NpcCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/NpcCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,56 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import server.life.MapleLifeFactory;\n+import server.life.MapleNPC;\n+import tools.MaplePacketCreator;\n+\n+public class NpcCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 1) {\n+            player.yellowMessage(\"Syntax: !npc <npcid>\");\n+            return;\n+        }\n+        MapleNPC npc = MapleLifeFactory.getNPC(Integer.parseInt(params[0]));\n+        if (npc != null) {\n+            npc.setPosition(player.getPosition());\n+            npc.setCy(player.getPosition().y);\n+            npc.setRx0(player.getPosition().x + 50);\n+            npc.setRx1(player.getPosition().x - 50);\n+            npc.setFh(player.getMap().getFootholds().findBelow(c.getPlayer().getPosition()).getId());\n+            player.getMap().addMapObject(npc);\n+            player.getMap().broadcastMessage(MaplePacketCreator.spawnNPC(npc));\n+        }\n+    }\n+}"}, {"sha": "2f160bb73a6b75c6b12983e77dea7111bc35f7a0", "filename": "src/client/command/commands/v3/OnlineTwoCommand.java", "status": "added", "additions": 56, "deletions": 0, "changes": 56, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/OnlineTwoCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/OnlineTwoCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/OnlineTwoCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,56 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import net.server.Server;\n+import net.server.channel.Channel;\n+\n+public class OnlineTwoCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        int total = 0;\n+        for (Channel ch : Server.getInstance().getChannelsFromWorld(player.getWorld())) {\n+            int size = ch.getPlayerStorage().getAllCharacters().size();\n+            total += size;\n+            String s = \"(Channel \" + ch.getId() + \" Online: \" + size + \") : \";\n+            if (ch.getPlayerStorage().getAllCharacters().size() < 50) {\n+                for (MapleCharacter chr : ch.getPlayerStorage().getAllCharacters()) {\n+                    s += MapleCharacter.makeMapleReadable(chr.getName()) + \", \";\n+                }\n+                player.dropMessage(6, s.substring(0, s.length() - 2));\n+            }\n+        }\n+\n+        //player.dropMessage(6, \"There are a total of \" + total + \" players online.\");\n+        player.showHint(\"Players online: #e#r\" + total + \"#k#n.\", 300);\n+    }\n+}"}, {"sha": "14f5ee6598fa9603571ebaa9ad6ec5b755d773ac", "filename": "src/client/command/commands/v3/OpenPortalCommand.java", "status": "added", "additions": 44, "deletions": 0, "changes": 44, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/OpenPortalCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/OpenPortalCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/OpenPortalCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,44 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+\n+public class OpenPortalCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 1) {\n+            player.yellowMessage(\"Syntax: !openportal <portalid>\");\n+            return;\n+        }\n+        player.getMap().getPortal(params[0]).setPortalState(true);\n+    }\n+}"}, {"sha": "1d1353a5058d68e85603731f260c3b85a5892ba9", "filename": "src/client/command/commands/v3/PeCommand.java", "status": "added", "additions": 78, "deletions": 0, "changes": 78, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/PeCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/PeCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/PeCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,78 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import net.MaplePacketHandler;\n+import net.PacketProcessor;\n+import tools.FilePrinter;\n+import tools.HexTool;\n+import tools.data.input.ByteArrayByteStream;\n+import tools.data.input.GenericSeekableLittleEndianAccessor;\n+import tools.data.input.SeekableLittleEndianAccessor;\n+import tools.data.output.MaplePacketLittleEndianWriter;\n+\n+import java.io.FileReader;\n+import java.io.IOException;\n+import java.io.InputStreamReader;\n+import java.util.Properties;\n+\n+public class PeCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        String packet = \"\";\n+        try {\n+            InputStreamReader is = new FileReader(\"pe.txt\");\n+            Properties packetProps = new Properties();\n+            packetProps.load(is);\n+            is.close();\n+            packet = packetProps.getProperty(\"pe\");\n+        } catch (IOException ex) {\n+            ex.printStackTrace();\n+            player.yellowMessage(\"Failed to load pe.txt\");\n+            return;\n+\n+        }\n+        MaplePacketLittleEndianWriter mplew = new MaplePacketLittleEndianWriter();\n+        mplew.write(HexTool.getByteArrayFromHexString(packet));\n+        SeekableLittleEndianAccessor slea = new GenericSeekableLittleEndianAccessor(new ByteArrayByteStream(mplew.getPacket()));\n+        short packetId = slea.readShort();\n+        final MaplePacketHandler packetHandler = PacketProcessor.getProcessor(0, c.getChannel()).getHandler(packetId);\n+        if (packetHandler != null && packetHandler.validateState(c)) {\n+            try {\n+                player.yellowMessage(\"Receiving: \" + packet);\n+                packetHandler.handlePacket(slea, c);\n+            } catch (final Throwable t) {\n+                FilePrinter.printError(FilePrinter.PACKET_HANDLER + packetHandler.getClass().getName() + \".txt\", t, \"Error for \" + (c.getPlayer() == null ? \"\" : \"player ; \" + c.getPlayer() + \" on map ; \" + c.getPlayer().getMapId() + \" - \") + \"account ; \" + c.getAccountName() + \"\\r\\n\" + slea.toString());\n+            }\n+        }\n+    }\n+}"}, {"sha": "8427f65e2f2365f8f107e09ff2523784cb0c434c", "filename": "src/client/command/commands/v3/PosCommand.java", "status": "added", "additions": 44, "deletions": 0, "changes": 44, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/PosCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/PosCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/PosCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,44 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+\n+public class PosCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        float xpos = player.getPosition().x;\n+        float ypos = player.getPosition().y;\n+        float fh = player.getMap().getFootholds().findBelow(player.getPosition()).getId();\n+        player.dropMessage(6, \"Position: (\" + xpos + \", \" + ypos + \")\");\n+        player.dropMessage(6, \"Foothold ID: \" + fh);\n+    }\n+}"}, {"sha": "591d30efa540434cd491ae6b9668f6296b34df8f", "filename": "src/client/command/commands/v3/QuestCompleteCommand.java", "status": "added", "additions": 60, "deletions": 0, "changes": 60, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/QuestCompleteCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/QuestCompleteCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/QuestCompleteCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,60 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import server.quest.MapleQuest;\n+\n+public class QuestCompleteCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        \n+        if (params.length < 1){\n+            player.yellowMessage(\"Syntax: !completequest <questid>\");\n+            return;\n+        }\n+\n+        int questId = Integer.parseInt(params[0]);\n+\n+        if (player.getQuestStatus(questId) == 1) {\n+            MapleQuest quest = MapleQuest.getInstance(questId);\n+            if (quest != null) {\n+                int npcid = quest.getNpcRequirement(true);\n+                quest.forceComplete(player, npcid);\n+                player.dropMessage(5, \"QUEST \" + questId + \" completed.\");\n+            } else {    // should not occur\n+                player.dropMessage(5, \"QUESTID \" + questId + \" is invalid.\");\n+            }\n+        } else {\n+            player.dropMessage(5, \"QUESTID \" + questId + \" not started or already completed.\");\n+        }\n+    }\n+}"}, {"sha": "4f32d2ac4e0c63064892f45c3ca82609cdacceae", "filename": "src/client/command/commands/v3/QuestResetCommand.java", "status": "added", "additions": 57, "deletions": 0, "changes": 57, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/QuestResetCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/QuestResetCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/QuestResetCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,57 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import server.quest.MapleQuest;\n+\n+public class QuestResetCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        \n+        if (params.length < 1){\n+            player.yellowMessage(\"Syntax: !resetquest <questid>\");\n+            return;\n+        }\n+\n+        int questid_ = Integer.parseInt(params[0]);\n+\n+        if (player.getQuestStatus(questid_) != 0) {\n+            MapleQuest quest = MapleQuest.getInstance(questid_);\n+            if (quest != null) {\n+                quest.reset(player);\n+                player.dropMessage(5, \"QUEST \" + questid_ + \" reseted.\");\n+            } else {    // should not occur\n+                player.dropMessage(5, \"QUESTID \" + questid_ + \" is invalid.\");\n+            }\n+        }\n+    }\n+}"}, {"sha": "e25e1733789838bd074caaaf648c138046ca02bb", "filename": "src/client/command/commands/v3/QuestStartCommand.java", "status": "added", "additions": 60, "deletions": 0, "changes": 60, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/QuestStartCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/QuestStartCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/QuestStartCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,60 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import server.quest.MapleQuest;\n+\n+public class QuestStartCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        \n+        if (params.length < 1){\n+            player.yellowMessage(\"Syntax: !startquest <questid>\");\n+            return;\n+        }\n+\n+        int questid = Integer.parseInt(params[0]);\n+\n+        if (player.getQuestStatus(questid) == 0) {\n+            MapleQuest quest = MapleQuest.getInstance(questid);\n+            if (quest != null) {\n+                int npcid = quest.getNpcRequirement(false);\n+                quest.forceStart(player, npcid);\n+                player.dropMessage(5, \"QUEST \" + questid + \" started.\");\n+            } else {\n+                player.dropMessage(5, \"QUESTID \" + questid + \" is invalid.\");\n+            }\n+        } else {\n+            player.dropMessage(5, \"QUESTID \" + questid + \" already started/completed.\");\n+        }\n+    }\n+}"}, {"sha": "330d40a515ff2015c501bc440e72b98908a6521d", "filename": "src/client/command/commands/v3/ReloadDropsCommand.java", "status": "added", "additions": 42, "deletions": 0, "changes": 42, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/ReloadDropsCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/ReloadDropsCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/ReloadDropsCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,42 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import server.life.MapleMonsterInformationProvider;\n+\n+public class ReloadDropsCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        MapleMonsterInformationProvider.getInstance().clearDrops();\n+        player.dropMessage(5, \"Reloaded Drops\");\n+    }\n+}"}, {"sha": "0fec0a7f0210e09cd460b60700182fa4ac4c7208", "filename": "src/client/command/commands/v3/ReloadEventsCommand.java", "status": "added", "additions": 45, "deletions": 0, "changes": 45, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/ReloadEventsCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/ReloadEventsCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/ReloadEventsCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,45 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import net.server.Server;\n+import net.server.channel.Channel;\n+\n+public class ReloadEventsCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        for (Channel ch : Server.getInstance().getAllChannels()) {\n+            ch.reloadEventScriptManager();\n+        }\n+        player.dropMessage(5, \"Reloaded Events\");\n+    }\n+}"}, {"sha": "1e0ea363003ff366484c9f87be96bdf0a6c5a6fc", "filename": "src/client/command/commands/v3/ReloadMapCommand.java", "status": "added", "additions": 50, "deletions": 0, "changes": 50, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/ReloadMapCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/ReloadMapCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/ReloadMapCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,50 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import server.maps.MapleMap;\n+\n+public class ReloadMapCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        MapleMap oldMap = c.getPlayer().getMap();\n+        MapleMap newMap = c.getChannelServer().getMapFactory().resetMap(player.getMapId());\n+        int callerid = c.getPlayer().getId();\n+\n+        for (MapleCharacter chr : oldMap.getCharacters()) {\n+            chr.changeMap(newMap);\n+            if (chr.getId() != callerid)\n+                chr.dropMessage(\"You have been relocated due to map reloading. Sorry for the inconvenience.\");\n+        }\n+        newMap.respawn();\n+    }\n+}"}, {"sha": "9fdd32f8fd8fafc2be8667e78548f7f6d5dc2baf", "filename": "src/client/command/commands/v3/ReloadPortalsCommand.java", "status": "added", "additions": 42, "deletions": 0, "changes": 42, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/ReloadPortalsCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/ReloadPortalsCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/ReloadPortalsCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,42 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import scripting.portal.PortalScriptManager;\n+\n+public class ReloadPortalsCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        PortalScriptManager.getInstance().reloadPortalScripts();\n+        player.dropMessage(5, \"Reloaded Portals\");\n+    }\n+}"}, {"sha": "3b10854c83647a12c49c4a7952861eb45a377172", "filename": "src/client/command/commands/v3/ReloadShopsCommand.java", "status": "added", "additions": 40, "deletions": 0, "changes": 40, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/ReloadShopsCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/ReloadShopsCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/ReloadShopsCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,40 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import server.MapleShopFactory;\n+\n+\n+public class ReloadShopsCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleShopFactory.getInstance().reloadShops();\n+    }\n+}"}, {"sha": "f34bf0ccf817d80331e6e80a67952082014dbd6b", "filename": "src/client/command/commands/v3/RipCommand.java", "status": "added", "additions": 42, "deletions": 0, "changes": 42, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/RipCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/RipCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/RipCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,42 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import net.server.Server;\n+import tools.MaplePacketCreator;\n+\n+public class RipCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        Server.getInstance().broadcastMessage(c.getWorld(), MaplePacketCreator.serverNotice(6, \"[RIP]: \" + joinStringFrom(params, 1)));\n+    }\n+}"}, {"sha": "8f7c93b4da209bd34f0945feb0aaf66af826589b", "filename": "src/client/command/commands/v3/SeedCommand.java", "status": "added", "additions": 57, "deletions": 0, "changes": 57, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/SeedCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/SeedCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/SeedCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,57 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import client.inventory.Item;\n+\n+import java.awt.*;\n+\n+public class SeedCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (player.getMapId() != 910010000) {\n+            player.yellowMessage(\"This command can only be used in HPQ.\");\n+            return;\n+        }\n+        Point pos[] = {new Point(7, -207), new Point(179, -447), new Point(-3, -687), new Point(-357, -687), new Point(-538, -447), new Point(-359, -207)};\n+        int seed[] = {4001097, 4001096, 4001095, 4001100, 4001099, 4001098};\n+        for (int i = 0; i < pos.length; i++) {\n+            Item item = new Item(seed[i], (byte) 0, (short) 1);\n+            player.getMap().spawnItemDrop(player, player, item, pos[i], false, true);\n+            try {\n+                Thread.sleep(100);\n+            } catch (InterruptedException e) {\n+                e.printStackTrace();\n+            }\n+        }\n+    }\n+}"}, {"sha": "144f37207210bebe7c89822006e423e7ab6d792e", "filename": "src/client/command/commands/v3/SpawnCommand.java", "status": "added", "additions": 57, "deletions": 0, "changes": 57, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/SpawnCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/SpawnCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/SpawnCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,57 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import server.life.MapleLifeFactory;\n+import server.life.MapleMonster;\n+\n+public class SpawnCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 1) {\n+            player.yellowMessage(\"Syntax: !spawn <mobid>\");\n+            return;\n+        }\n+\n+        MapleMonster monster = MapleLifeFactory.getMonster(Integer.parseInt(params[0]));\n+        if (monster == null) {\n+            return;\n+        }\n+        if (params.length == 2) {\n+            for (int i = 0; i < Integer.parseInt(params[1]); i++) {\n+                player.getMap().spawnMonsterOnGroundBelow(MapleLifeFactory.getMonster(Integer.parseInt(params[0])), player.getPosition());\n+            }\n+        } else {\n+            player.getMap().spawnMonsterOnGroundBelow(MapleLifeFactory.getMonster(Integer.parseInt(params[0])), player.getPosition());\n+        }\n+    }\n+}"}, {"sha": "f5b406c05de859f567ee8ea4d03d93f677cd68a4", "filename": "src/client/command/commands/v3/StartEventCommand.java", "status": "added", "additions": 45, "deletions": 0, "changes": 45, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/StartEventCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/StartEventCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/StartEventCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,45 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import server.events.gm.MapleEvent;\n+\n+public class StartEventCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        int players = 50;\n+        if (params.length > 1)\n+            players = Integer.parseInt(params[0]);\n+        c.getChannelServer().setEvent(new MapleEvent(player.getMapId(), players));\n+        player.dropMessage(5, \"The event has been set on \" + player.getMap().getMapName() + \" and will allow \" + players + \" players to join.\");\n+    }\n+}"}, {"sha": "87c08c5947590b8e88c828b89ffcab400767a8e8", "filename": "src/client/command/commands/v3/ToggleCouponCommand.java", "status": "added", "additions": 45, "deletions": 0, "changes": 45, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/ToggleCouponCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/ToggleCouponCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/ToggleCouponCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,45 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import net.server.Server;\n+\n+public class ToggleCouponCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 1) {\n+            player.yellowMessage(\"Syntax: !togglecoupon <itemid>\");\n+            return;\n+        }\n+        Server.getInstance().toggleCoupon(Integer.parseInt(params[0]));\n+    }\n+}"}, {"sha": "54f5782a3582edf4904018f2af37ced886c4dc28", "filename": "src/client/command/commands/v3/UnBanCommand.java", "status": "added", "additions": 68, "deletions": 0, "changes": 68, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/UnBanCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/UnBanCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/UnBanCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,68 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import tools.DatabaseConnection;\n+\n+import java.sql.Connection;\n+import java.sql.PreparedStatement;\n+\n+public class UnBanCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 1) {\n+            player.yellowMessage(\"Syntax: !unban <playername>\");\n+            return;\n+        }\n+\n+        try {\n+            Connection con = DatabaseConnection.getConnection();\n+            int aid = MapleCharacter.getAccountIdByName(params[0]);\n+\n+            PreparedStatement p = con.prepareStatement(\"UPDATE accounts SET banned = -1 WHERE id = \" + aid);\n+            p.executeUpdate();\n+\n+            p = con.prepareStatement(\"DELETE FROM ipbans WHERE aid = \" + aid);\n+            p.executeUpdate();\n+\n+            p = con.prepareStatement(\"DELETE FROM macbans WHERE aid = \" + aid);\n+            p.executeUpdate();\n+\n+            con.close();\n+        } catch (Exception e) {\n+            e.printStackTrace();\n+            player.message(\"Failed to unban \" + params[0]);\n+            return;\n+        }\n+        player.message(\"Unbanned \" + params[0]);\n+    }\n+}"}, {"sha": "2d62daf4b62163410ed878e660ecadd3e4d14cbc", "filename": "src/client/command/commands/v3/WarpSnowBallCommand.java", "status": "added", "additions": 46, "deletions": 0, "changes": 46, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/WarpSnowBallCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v3/WarpSnowBallCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v3/WarpSnowBallCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,46 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v3;\n+\n+        import client.command.Command;\n+        import client.MapleClient;\n+        import client.MapleCharacter;\n+\n+        import java.util.ArrayList;\n+        import java.util.List;\n+\n+public class WarpSnowBallCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        List<MapleCharacter> chars = new ArrayList<>(player.getMap().getCharacters());\n+        for (MapleCharacter chr : chars) {\n+            chr.changeMap(109060000, chr.getTeam());\n+        }\n+    }\n+}"}, {"sha": "91e6c86276ecb745e325c33fae569eee2ac5f11a", "filename": "src/client/command/commands/v4/CakeCommand.java", "status": "added", "additions": 51, "deletions": 0, "changes": 51, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v4/CakeCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v4/CakeCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v4/CakeCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,51 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v4;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import server.life.MapleLifeFactory;\n+import server.life.MapleMonster;\n+\n+public class CakeCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        MapleMonster monster = MapleLifeFactory.getMonster(9400606);\n+        if (params.length == 1) {\n+            double mobHp = Double.parseDouble(params[0]);\n+            int newHp = (mobHp <= 0) ? Integer.MAX_VALUE : ((mobHp > Integer.MAX_VALUE) ? Integer.MAX_VALUE : (int) mobHp);\n+\n+            monster.getStats().setHp(newHp);\n+            monster.setStartingHp(newHp);\n+        }\n+\n+        player.getMap().spawnMonsterOnGroundBelow(monster, player.getPosition());\n+    }\n+}"}, {"sha": "783f0d3f220795ef821ec735725a26a74d79f5ee", "filename": "src/client/command/commands/v4/DropRateCommand.java", "status": "added", "additions": 49, "deletions": 0, "changes": 49, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v4/DropRateCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v4/DropRateCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v4/DropRateCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,49 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v4;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import tools.MaplePacketCreator;\n+\n+public class DropRateCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 1) {\n+            player.yellowMessage(\"Syntax: !droprate <newrate>\");\n+            return;\n+        }\n+\n+        int droprate = Math.max(Integer.parseInt(params[0]), 1);\n+        c.getWorldServer().setDropRate(droprate);\n+        c.getWorldServer().broadcastPacket(MaplePacketCreator.serverNotice(6, \"[Rate] Drop Rate has been changed to \" + droprate + \"x.\"));\n+\n+    }\n+}"}, {"sha": "50026dde88c452ac37b393522b8005687e037330", "filename": "src/client/command/commands/v4/ExpRateCommand.java", "status": "added", "additions": 48, "deletions": 0, "changes": 48, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v4/ExpRateCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v4/ExpRateCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v4/ExpRateCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,48 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v4;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import tools.MaplePacketCreator;\n+\n+public class ExpRateCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 1) {\n+            player.yellowMessage(\"Syntax: !exprate <newrate>\");\n+            return;\n+        }\n+\n+        int exprate = Math.max(Integer.parseInt(params[0]), 1);\n+        c.getWorldServer().setExpRate(exprate);\n+        c.getWorldServer().broadcastPacket(MaplePacketCreator.serverNotice(6, \"[Rate] Exp Rate has been changed to \" + exprate + \"x.\"));\n+    }\n+}"}, {"sha": "cdb5fd202b2fb8b0b004f53e5a56fa25da71cc59", "filename": "src/client/command/commands/v4/ForceVacCommand.java", "status": "added", "additions": 76, "deletions": 0, "changes": 76, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v4/ForceVacCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v4/ForceVacCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v4/ForceVacCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,76 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v4;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import client.inventory.MaplePet;\n+import client.inventory.manipulator.MapleInventoryManipulator;\n+import server.maps.MapleMapItem;\n+import server.maps.MapleMapObject;\n+import server.maps.MapleMapObjectType;\n+import tools.MaplePacketCreator;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+\n+public class ForceVacCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        List<MapleMapObject> items = player.getMap().getMapObjectsInRange(player.getPosition(), Double.POSITIVE_INFINITY, Arrays.asList(MapleMapObjectType.ITEM));\n+        for (MapleMapObject item : items) {\n+            MapleMapItem mapItem = (MapleMapItem) item;\n+\n+            mapItem.lockItem();\n+            try {\n+                if (mapItem.isPickedUp()) continue;\n+\n+                if (mapItem.getMeso() > 0) {\n+                    player.gainMeso(mapItem.getMeso(), true);\n+                } else if (mapItem.getItemId() == 4031865 || mapItem.getItemId() == 4031866) {\n+                    // Add NX to account, show effect and make item disappear\n+                    player.getCashShop().gainCash(1, mapItem.getItemId() == 4031865 ? 100 : 250);\n+                } else if (mapItem.getItem().getItemId() >= 5000000 && mapItem.getItem().getItemId() <= 5000100) {\n+                    int petId = MaplePet.createPet(mapItem.getItem().getItemId());\n+                    if (petId == -1) {\n+                        continue;\n+                    }\n+                    MapleInventoryManipulator.addById(c, mapItem.getItem().getItemId(), mapItem.getItem().getQuantity(), null, petId);\n+                } else {\n+                    MapleInventoryManipulator.addFromDrop(c, mapItem.getItem(), true);\n+                }\n+\n+                player.getMap().pickItemDrop(MaplePacketCreator.removeItemFromMap(mapItem.getObjectId(), 2, player.getId()), mapItem);\n+            } finally {\n+                mapItem.unlockItem();\n+            }\n+        }\n+    }\n+}"}, {"sha": "a853f812455018f54d4e25443e012639435c76f3", "filename": "src/client/command/commands/v4/HorntailCommand.java", "status": "added", "additions": 46, "deletions": 0, "changes": 46, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v4/HorntailCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v4/HorntailCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v4/HorntailCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,46 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v4;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import server.maps.MapleMap;\n+\n+import java.awt.*;\n+\n+public class HorntailCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        final Point targetPoint = player.getPosition();\n+        final MapleMap targetMap = player.getMap();\n+\n+        targetMap.spawnHorntailOnGroundBelow(targetPoint);\n+    }\n+}"}, {"sha": "e17861a8245263a90aa90c125f42f2e900528917", "filename": "src/client/command/commands/v4/ItemVacCommand.java", "status": "added", "additions": 48, "deletions": 0, "changes": 48, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v4/ItemVacCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v4/ItemVacCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v4/ItemVacCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,48 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v4;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import server.maps.MapleMapObject;\n+import server.maps.MapleMapObjectType;\n+\n+import java.util.Arrays;\n+import java.util.List;\n+\n+public class ItemVacCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        List<MapleMapObject> list = player.getMap().getMapObjectsInRange(player.getPosition(), Double.POSITIVE_INFINITY, Arrays.asList(MapleMapObjectType.ITEM));\n+        for (MapleMapObject item : list) {\n+            player.pickupItem(item);\n+        }\n+    }\n+}"}, {"sha": "9b2dd45beb6a71443828baa95e01f863f3808f56", "filename": "src/client/command/commands/v4/MesoRateCommand.java", "status": "added", "additions": 49, "deletions": 0, "changes": 49, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v4/MesoRateCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v4/MesoRateCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v4/MesoRateCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,49 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v4;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import tools.MaplePacketCreator;\n+\n+public class MesoRateCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 1) {\n+            player.yellowMessage(\"Syntax: !mesorate <newrate>\");\n+            return;\n+        }\n+\n+        int mesorate = Math.max(Integer.parseInt(params[0]), 1);\n+        c.getWorldServer().setMesoRate(mesorate);\n+        c.getWorldServer().broadcastPacket(MaplePacketCreator.serverNotice(6, \"[Rate] Meso Rate has been changed to \" + mesorate + \"x.\"));\n+\n+    }\n+}"}, {"sha": "1f03cb47e436e3a226a5d05c84eb26c63ff73fde", "filename": "src/client/command/commands/v4/PapCommand.java", "status": "added", "additions": 41, "deletions": 0, "changes": 41, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v4/PapCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v4/PapCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v4/PapCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,41 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v4;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import server.life.MapleLifeFactory;\n+\n+public class PapCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        player.getMap().spawnMonsterOnGroundBelow(MapleLifeFactory.getMonster(8510000), player.getPosition());\n+    }\n+}"}, {"sha": "9681481f4f0ea96d8e19e79a67e10fbb1083225d", "filename": "src/client/command/commands/v4/PianusCommand.java", "status": "added", "additions": 41, "deletions": 0, "changes": 41, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v4/PianusCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v4/PianusCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v4/PianusCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,41 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v4;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import server.life.MapleLifeFactory;\n+\n+public class PianusCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        player.getMap().spawnMonsterOnGroundBelow(MapleLifeFactory.getMonster(8510000), player.getPosition());\n+    }\n+}"}, {"sha": "45db91dd95bc7ee3ba5198409e2db8938dcc5844", "filename": "src/client/command/commands/v4/PinkbeanCommand.java", "status": "added", "additions": 42, "deletions": 0, "changes": 42, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v4/PinkbeanCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v4/PinkbeanCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v4/PinkbeanCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,42 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v4;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import server.life.MapleLifeFactory;\n+\n+public class PinkbeanCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        player.getMap().spawnMonsterOnGroundBelow(MapleLifeFactory.getMonster(8820001), player.getPosition());\n+\n+    }\n+}"}, {"sha": "68aaec60bb7526f107b516abddd89a23df333d28", "filename": "src/client/command/commands/v4/PlayerNpcCommand.java", "status": "added", "additions": 48, "deletions": 0, "changes": 48, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v4/PlayerNpcCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v4/PlayerNpcCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v4/PlayerNpcCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,48 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v4;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import server.life.MaplePlayerNPC;\n+\n+public class PlayerNpcCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 1) {\n+            player.yellowMessage(\"Syntax: !playernpc <playername>\");\n+            return;\n+        }\n+\n+        if (!MaplePlayerNPC.spawnPlayerNPC(player.getMapId(), player.getPosition(), c.getChannelServer().getPlayerStorage().getCharacterByName(params[0]))) {\n+            player.dropMessage(5, \"Could not deploy PlayerNPC. Either there's no room available here or depleted out scriptids to use.\");\n+        }\n+    }\n+}"}, {"sha": "95c6f02c2ffa3d28ad45fbba0fdfc7c139034262", "filename": "src/client/command/commands/v4/PlayerNpcRemoveCommand.java", "status": "added", "additions": 45, "deletions": 0, "changes": 45, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v4/PlayerNpcRemoveCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v4/PlayerNpcRemoveCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v4/PlayerNpcRemoveCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,45 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v4;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import server.life.MaplePlayerNPC;\n+\n+public class PlayerNpcRemoveCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 1) {\n+            player.yellowMessage(\"Syntax: !playernpcremove <playername>\");\n+            return;\n+        }\n+        MaplePlayerNPC.removePlayerNPC(c.getChannelServer().getPlayerStorage().getCharacterByName(params[0]));\n+    }\n+}"}, {"sha": "8fbb431a5101786fe08a5d92f9437e6c8810639e", "filename": "src/client/command/commands/v4/ProItemCommand.java", "status": "added", "additions": 83, "deletions": 0, "changes": 83, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v4/ProItemCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v4/ProItemCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v4/ProItemCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,83 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v4;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import client.inventory.Equip;\n+import client.inventory.Item;\n+import client.inventory.MapleInventoryType;\n+import client.inventory.manipulator.MapleInventoryManipulator;\n+import constants.ItemConstants;\n+import server.MapleItemInformationProvider;\n+\n+public class ProItemCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 2) {\n+            player.yellowMessage(\"Syntax: !proitem <itemid> <statvalue>\");\n+            return;\n+        }\n+        int itemid = Integer.parseInt(params[0]);\n+        short multiply = Short.parseShort(params[1]);\n+\n+        MapleItemInformationProvider ii = MapleItemInformationProvider.getInstance();\n+        MapleInventoryType type = ItemConstants.getInventoryType(itemid);\n+        if (type.equals(MapleInventoryType.EQUIP)) {\n+            Item it = ii.getEquipById(itemid);\n+            it.setOwner(player.getName());\n+\n+            hardsetItemStats((Equip) it, multiply);\n+            MapleInventoryManipulator.addFromDrop(c, it);\n+        } else {\n+            player.dropMessage(6, \"Make sure it's an equippable item.\");\n+        }\n+    }\n+    private static void hardsetItemStats(Equip equip, short stat) {\n+        equip.setStr(stat);\n+        equip.setDex(stat);\n+        equip.setInt(stat);\n+        equip.setLuk(stat);\n+        equip.setMatk(stat);\n+        equip.setWatk(stat);\n+        equip.setAcc(stat);\n+        equip.setAvoid(stat);\n+        equip.setJump(stat);\n+        equip.setSpeed(stat);\n+        equip.setWdef(stat);\n+        equip.setMdef(stat);\n+        equip.setHp(stat);\n+        equip.setMp(stat);\n+\n+        byte flag = equip.getFlag();\n+        flag |= ItemConstants.UNTRADEABLE;\n+        equip.setFlag(flag);\n+    }\n+}"}, {"sha": "43f329e852d8bad5b09ecf81c40e0d2674509aa7", "filename": "src/client/command/commands/v4/QuestRateCommand.java", "status": "added", "additions": 49, "deletions": 0, "changes": 49, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v4/QuestRateCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v4/QuestRateCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v4/QuestRateCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,49 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v4;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import tools.MaplePacketCreator;\n+\n+public class QuestRateCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 1) {\n+            player.yellowMessage(\"Syntax: !questrate <newrate>\");\n+            return;\n+        }\n+\n+        int questrate = Math.max(Integer.parseInt(params[0]), 1);\n+        c.getWorldServer().setQuestRate(questrate);\n+        c.getWorldServer().broadcastPacket(MaplePacketCreator.serverNotice(6, \"[Rate] Quest Rate has been changed to \" + questrate + \"x.\"));\n+\n+    }\n+}"}, {"sha": "00b02992c36b44776389c72e14b533411c367fed", "filename": "src/client/command/commands/v4/ServerMessageCommand.java", "status": "added", "additions": 40, "deletions": 0, "changes": 40, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v4/ServerMessageCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v4/ServerMessageCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v4/ServerMessageCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,40 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v4;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+\n+public class ServerMessageCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        //MapleCharacter player = c.getPlayer();\n+        c.getWorldServer().setServerMessage(joinStringFrom(params, 0));\n+    }\n+}"}, {"sha": "f79abe5143ede5652f90139f850d5a669e421b74", "filename": "src/client/command/commands/v4/SetQStatCommand.java", "status": "added", "additions": 81, "deletions": 0, "changes": 81, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v4/SetQStatCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v4/SetQStatCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v4/SetQStatCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,81 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v4;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import client.inventory.Equip;\n+import client.inventory.MapleInventory;\n+import client.inventory.MapleInventoryType;\n+import constants.ItemConstants;\n+\n+public class SetQStatCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 1) {\n+            player.yellowMessage(\"Syntax: !seteqstat <statvalue>\");\n+            return;\n+        }\n+\n+        int newStat = Integer.parseInt(params[0]);\n+        MapleInventory equip = player.getInventory(MapleInventoryType.EQUIP);\n+\n+        for (byte i = 1; i <= equip.getSlotLimit(); i++) {\n+            try {\n+                Equip eu = (Equip) equip.getItem(i);\n+                if (eu == null) continue;\n+\n+                short incval = (short) newStat;\n+                eu.setWdef(incval);\n+                eu.setAcc(incval);\n+                eu.setAvoid(incval);\n+                eu.setJump(incval);\n+                eu.setMatk(incval);\n+                eu.setMdef(incval);\n+                eu.setHp(incval);\n+                eu.setMp(incval);\n+                eu.setSpeed(incval);\n+                eu.setWatk(incval);\n+                eu.setDex(incval);\n+                eu.setInt(incval);\n+                eu.setStr(incval);\n+                eu.setLuk(incval);\n+\n+                byte flag = eu.getFlag();\n+                flag |= ItemConstants.UNTRADEABLE;\n+                eu.setFlag(flag);\n+\n+                player.forceUpdateItem(eu);\n+            } catch (Exception e) {\n+                e.printStackTrace();\n+            }\n+        }\n+    }\n+}"}, {"sha": "acd2092f9bb372054487fa77ed493df68ee0b9e2", "filename": "src/client/command/commands/v4/TravelRateCommand.java", "status": "added", "additions": 48, "deletions": 0, "changes": 48, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v4/TravelRateCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v4/TravelRateCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v4/TravelRateCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,48 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v4;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import tools.MaplePacketCreator;\n+\n+public class TravelRateCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 1) {\n+            player.yellowMessage(\"Syntax: !travelrate <newrate>\");\n+            return;\n+        }\n+\n+        int travelrate = Math.max(Integer.parseInt(params[0]), 1);\n+        c.getWorldServer().setTravelRate(travelrate);\n+        c.getWorldServer().broadcastPacket(MaplePacketCreator.serverNotice(6, \"[Rate] Travel Rate has been changed to \" + travelrate + \"x.\"));\n+    }\n+}"}, {"sha": "fe2b22aacf5df00af2e1fb5797c2a8d2c89e967a", "filename": "src/client/command/commands/v4/ZakumCommand.java", "status": "added", "additions": 44, "deletions": 0, "changes": 44, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v4/ZakumCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v4/ZakumCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v4/ZakumCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,44 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v4;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import server.life.MapleLifeFactory;\n+\n+public class ZakumCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        player.getMap().spawnFakeMonsterOnGroundBelow(MapleLifeFactory.getMonster(8800000), player.getPosition());\n+        for (int x = 8800003; x < 8800011; x++) {\n+            player.getMap().spawnMonsterOnGroundBelow(MapleLifeFactory.getMonster(x), player.getPosition());\n+        }\n+    }\n+}"}, {"sha": "df8c3a3a347f8bd1c3bcaf91cadb5f4da65a66b6", "filename": "src/client/command/commands/v5/DebugCommand.java", "status": "added", "additions": 162, "deletions": 0, "changes": 162, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v5/DebugCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v5/DebugCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v5/DebugCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,162 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v5;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import net.server.Server;\n+import server.MaplePortal;\n+import server.TimerManager;\n+import server.life.MapleMonster;\n+import server.life.SpawnPoint;\n+import server.maps.MapleMapObject;\n+import server.maps.MapleMapObjectType;\n+import server.maps.MapleReactor;\n+import tools.MaplePacketCreator;\n+\n+import java.awt.*;\n+import java.util.Arrays;\n+import java.util.List;\n+\n+public class DebugCommand extends Command {\n+    private final static String debugTypes[] = {\"monster\", \"packet\", \"portal\", \"spawnpoint\", \"pos\", \"map\", \"mobsp\", \"event\", \"areas\", \"reactors\", \"servercoupons\", \"playercoupons\", \"timer\", \"marriage\", \"\"};\n+    \n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+\n+        if (params.length < 1) {\n+            player.yellowMessage(\"Syntax: !debug <type>\");\n+            return;\n+        }\n+\n+        switch (params[0]) {\n+            case \"type\":\n+            case \"help\":\n+                String msgTypes = \"Available #bdebug types#k:\\r\\n\\r\\n\";\n+                for(int i = 0; i < debugTypes.length; i++) {\n+                    msgTypes += (\"#L\" + i + \"#\" + debugTypes[i] + \"#l\\r\\n\");\n+                }\n+                \n+                player.announce(MaplePacketCreator.getNPCTalk(9201143, (byte) 0, msgTypes, \"00 00\", (byte) 0));\n+                break;\n+            \n+            case \"monster\":\n+                List<MapleMapObject> monsters = player.getMap().getMapObjectsInRange(player.getPosition(), Double.POSITIVE_INFINITY, Arrays.asList(MapleMapObjectType.MONSTER));\n+                for (MapleMapObject monstermo : monsters) {\n+                    MapleMonster monster = (MapleMonster) monstermo;\n+                    player.message(\"Monster ID: \" + monster.getId() + \" Aggro target: \" + ((monster.getController() != null) ? monster.getController().getName() : \"<none>\"));\n+                }\n+                break;\n+\n+            case \"packet\":\n+                player.getMap().broadcastMessage(MaplePacketCreator.customPacket(joinStringFrom(params, 1)));\n+                break;\n+\n+            case \"portal\":\n+                MaplePortal portal = player.getMap().findClosestPortal(player.getPosition());\n+                if (portal != null)\n+                    player.dropMessage(6, \"Closest portal: \" + portal.getId() + \" '\" + portal.getName() + \"' Type: \" + portal.getType() + \" --> toMap: \" + portal.getTargetMapId() + \" scriptname: '\" + portal.getScriptName() + \"' state: \" + portal.getPortalState() + \".\");\n+                else player.dropMessage(6, \"There is no portal on this map.\");\n+                break;\n+\n+            case \"spawnpoint\":\n+                SpawnPoint sp = player.getMap().findClosestSpawnpoint(player.getPosition());\n+                if (sp != null)\n+                    player.dropMessage(6, \"Closest mob spawn point: \" + \" Position: x \" + sp.getPosition().getX() + \" y \" + sp.getPosition().getY() + \" Spawns mobid: '\" + sp.getMonsterId() + \"' --> canSpawn: \" + !sp.getDenySpawn() + \" canSpawnRightNow: \" + sp.shouldSpawn() + \".\");\n+                else player.dropMessage(6, \"There is no mob spawn point on this map.\");\n+                break;\n+\n+            case \"pos\":\n+                player.dropMessage(6, \"Current map position: (\" + player.getPosition().getX() + \", \" + player.getPosition().getY() + \").\");\n+                break;\n+\n+            case \"map\":\n+                player.dropMessage(6, \"Current map id \" + player.getMap().getId() + \", event: '\" + ((player.getMap().getEventInstance() != null) ? player.getMap().getEventInstance().getName() : \"null\") + \"'; Players: \" + player.getMap().getAllPlayers().size() + \", Mobs: \" + player.getMap().countMonsters() + \", Reactors: \" + player.getMap().countReactors() + \", Items: \" + player.getMap().countItems() + \", Objects: \" + player.getMap().getMapObjects().size() + \".\");\n+                break;\n+\n+            case \"mobsp\":\n+                player.getMap().reportMonsterSpawnPoints(player);\n+                break;\n+\n+            case \"event\":\n+                if (player.getEventInstance() == null) player.dropMessage(6, \"Player currently not in an event.\");\n+                else player.dropMessage(6, \"Current event name: \" + player.getEventInstance().getName() + \".\");\n+                break;\n+\n+            case \"areas\":\n+                player.dropMessage(6, \"Configured areas on map \" + player.getMapId() + \":\");\n+\n+                byte index = 0;\n+                for (Rectangle rect : player.getMap().getAreas()) {\n+                    player.dropMessage(6, \"Id: \" + index + \" -> posX: \" + rect.getX() + \" posY: '\" + rect.getY() + \"' dX: \" + rect.getWidth() + \" dY: \" + rect.getHeight() + \".\");\n+                    index++;\n+                }\n+                break;\n+\n+            case \"reactors\":\n+                player.dropMessage(6, \"Current reactor states on map \" + player.getMapId() + \":\");\n+\n+                for (MapleMapObject mmo : player.getMap().getReactors()) {\n+                    MapleReactor mr = (MapleReactor) mmo;\n+                    player.dropMessage(6, \"Id: \" + mr.getId() + \" Oid: \" + mr.getObjectId() + \" name: '\" + mr.getName() + \"' -> Type: \" + mr.getReactorType() + \" State: \" + mr.getState() + \" Event State: \" + mr.getEventState() + \" Position: x \" + mr.getPosition().getX() + \" y \" + mr.getPosition().getY() + \".\");\n+                }\n+                break;\n+\n+            case \"servercoupons\":\n+            case \"coupons\":\n+                String s = \"Currently active SERVER coupons: \";\n+                for (Integer i : Server.getInstance().getActiveCoupons()) {\n+                    s += (i + \" \");\n+                }\n+\n+                player.dropMessage(6, s);\n+                break;\n+\n+            case \"playercoupons\":\n+                String st = \"Currently active PLAYER coupons: \";\n+                for (Integer i : player.getActiveCoupons()) {\n+                    st += (i + \" \");\n+                }\n+\n+                player.dropMessage(6, st);\n+                break;\n+\n+            case \"timer\":\n+                TimerManager tMan = TimerManager.getInstance();\n+                player.dropMessage(6, \"Total Task: \" + tMan.getTaskCount() + \" Current Task: \" + tMan.getQueuedTasks() + \" Active Task: \" + tMan.getActiveCount() + \" Completed Task: \" + tMan.getCompletedTaskCount());\n+                break;\n+\n+            case \"marriage\":\n+                c.getChannelServer().debugMarriageStatus();\n+                break;\n+\n+        }\n+    }\n+}"}, {"sha": "a01613e27f132d2564a6e9156f5a576312f71fb8", "filename": "src/client/command/commands/v5/SetCommand.java", "status": "added", "additions": 41, "deletions": 0, "changes": 41, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v5/SetCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v5/SetCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v5/SetCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,41 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v5;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import constants.ServerConstants;\n+\n+public class SetCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        for (int i = 0; i < params.length; i++) {\n+            ServerConstants.DEBUG_VALUES[i] = Integer.parseInt(params[i]);\n+        }\n+    }\n+}"}, {"sha": "284cab3b5b0eaee749ac471c03555940a983a7e6", "filename": "src/client/command/commands/v5/ShowPacketsCommand.java", "status": "added", "additions": 39, "deletions": 0, "changes": 39, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v5/ShowPacketsCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v5/ShowPacketsCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v5/ShowPacketsCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,39 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v5;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import constants.ServerConstants;\n+\n+public class ShowPacketsCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        ServerConstants.USE_DEBUG_SHOW_RCVD_PACKET = !ServerConstants.USE_DEBUG_SHOW_RCVD_PACKET;\n+    }\n+}"}, {"sha": "bec633bf5f150a9d9d7671de63d8a2b2677c2cea", "filename": "src/client/command/commands/v6/ClearQuestCacheCommand.java", "status": "added", "additions": 42, "deletions": 0, "changes": 42, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v6/ClearQuestCacheCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v6/ClearQuestCacheCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v6/ClearQuestCacheCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,42 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v6;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import server.quest.MapleQuest;\n+\n+public class ClearQuestCacheCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        MapleQuest.clearCache();\n+        player.dropMessage(5, \"Quest Cache Cleared.\");\n+    }\n+}"}, {"sha": "db8b5ebefa8e29f5dd24f938ea64480038555332", "filename": "src/client/command/commands/v6/ClearQuestCommand.java", "status": "added", "additions": 47, "deletions": 0, "changes": 47, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v6/ClearQuestCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v6/ClearQuestCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v6/ClearQuestCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,47 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v6;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import server.quest.MapleQuest;\n+\n+public class ClearQuestCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 1) {\n+            player.dropMessage(5, \"Please include a quest ID.\");\n+            return;\n+        }\n+        MapleQuest.clearCache(Integer.parseInt(params[0]));\n+        player.dropMessage(5, \"Quest Cache for quest \" + params[0] + \" cleared.\");\n+\n+    }\n+}"}, {"sha": "382935ea187e2fdf52dc177ba90e3b6094736eb7", "filename": "src/client/command/commands/v6/DCAllCommand.java", "status": "added", "additions": 49, "deletions": 0, "changes": 49, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v6/DCAllCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v6/DCAllCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v6/DCAllCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,49 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v6;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import net.server.Server;\n+import net.server.world.World;\n+\n+public class DCAllCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        for (World world : Server.getInstance().getWorlds()) {\n+            for (MapleCharacter chr : world.getPlayerStorage().getAllCharacters()) {\n+                if (!chr.isGM()) {\n+                    chr.getClient().disconnect(false, false);\n+                }\n+            }\n+        }\n+        player.message(\"All players successfully disconnected.\");\n+    }\n+}"}, {"sha": "7d32d5f12f059e5c863c9500326c6b3646d4d230", "filename": "src/client/command/commands/v6/EraseAllPNpcsCommand.java", "status": "added", "additions": 41, "deletions": 0, "changes": 41, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v6/EraseAllPNpcsCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v6/EraseAllPNpcsCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v6/EraseAllPNpcsCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,41 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v6;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import server.life.MaplePlayerNPC;\n+\n+public class EraseAllPNpcsCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        //MapleCharacter player = c.getPlayer();\n+        MaplePlayerNPC.removeAllPlayerNPC();\n+    }\n+}"}, {"sha": "85a2424ed3be4743c5b59b9c0e6ee17e7d30c34b", "filename": "src/client/command/commands/v6/FredCommand.java", "status": "added", "additions": 41, "deletions": 0, "changes": 41, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v6/FredCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v6/FredCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v6/FredCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,41 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v6;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import tools.MaplePacketCreator;\n+\n+public class FredCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        c.announce(MaplePacketCreator.fredrickMessage(Byte.valueOf(params[0])));\n+\n+    }\n+}"}, {"sha": "74487fae748e8bb9b578c41c11e253dbc8653a70", "filename": "src/client/command/commands/v6/GetAccCommand.java", "status": "added", "additions": 49, "deletions": 0, "changes": 49, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v6/GetAccCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v6/GetAccCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v6/GetAccCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,49 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v6;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+\n+public class GetAccCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 1) {\n+            player.yellowMessage(\"Syntax: !getacc <playername>\");\n+            return;\n+        }\n+        MapleCharacter victim = c.getWorldServer().getPlayerStorage().getCharacterByName(params[0]);\n+        if (victim != null) {\n+            player.message(victim.getName() + \"'s account name is \" + victim.getClient().getAccountName() + \".\");\n+        } else {\n+            player.message(\"Player '\" + params[0] + \"' could not be found on this world.\");\n+        }\n+    }\n+}"}, {"sha": "93bd128a3330bc0f9b70b993ab8800108cdf1e12", "filename": "src/client/command/commands/v6/MapPlayersCommand.java", "status": "added", "additions": 55, "deletions": 0, "changes": 55, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v6/MapPlayersCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v6/MapPlayersCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v6/MapPlayersCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,55 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v6;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import net.server.Server;\n+import net.server.world.World;\n+\n+public class MapPlayersCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        String names = \"\";\n+        int map = player.getMapId();\n+        for (World world : Server.getInstance().getWorlds()) {\n+            for (MapleCharacter chr : world.getPlayerStorage().getAllCharacters()) {\n+                int curMap = chr.getMapId();\n+                String hp = Integer.toString(chr.getHp());\n+                String maxhp = Integer.toString(chr.getMaxHp());\n+                String name = chr.getName() + \": \" + hp + \"/\" + maxhp;\n+                if (map == curMap) {\n+                    names = names.equals(\"\") ? name : (names + \", \" + name);\n+                }\n+            }\n+        }\n+        player.message(\"These b lurkin: \" + names);\n+    }\n+}"}, {"sha": "dd0d2a87eb72308393ba1e19161d0c6e0973153f", "filename": "src/client/command/commands/v6/SaveAllCommand.java", "status": "added", "additions": 50, "deletions": 0, "changes": 50, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v6/SaveAllCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v6/SaveAllCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v6/SaveAllCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,50 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v6;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import net.server.Server;\n+import net.server.world.World;\n+import tools.MaplePacketCreator;\n+\n+public class SaveAllCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        for (World world : Server.getInstance().getWorlds()) {\n+            for (MapleCharacter chr : world.getPlayerStorage().getAllCharacters()) {\n+                chr.saveCharToDB();\n+            }\n+        }\n+        String message = player.getName() + \" used !saveall.\";\n+        Server.getInstance().broadcastGMMessage(c.getWorld(), MaplePacketCreator.serverNotice(5, message));\n+        player.message(\"All players saved successfully.\");\n+    }\n+}"}, {"sha": "e75e232f77bef19199180c1381c2f11450d59b43", "filename": "src/client/command/commands/v6/ServerAddChannelCommand.java", "status": "added", "additions": 69, "deletions": 0, "changes": 69, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v6/ServerAddChannelCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v6/ServerAddChannelCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v6/ServerAddChannelCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,69 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v6;\n+\n+import client.MapleCharacter;\n+import client.command.Command;\n+import client.MapleClient;\n+import net.server.Server;\n+\n+public class ServerAddChannelCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        final MapleCharacter player = c.getPlayer();\n+        \n+        if (params.length < 1) {\n+            player.dropMessage(5, \"Syntax: @addchannel <worldid>\");\n+            return;\n+        }\n+\n+        final int worldid = Integer.parseInt(params[0]);\n+\n+        new Thread(new Runnable() {\n+            @Override\n+            public void run() {\n+                int chid = Server.getInstance().addChannel(worldid);\n+                if(player.isLoggedinWorld()) {\n+                    if(chid >= 0) {\n+                        player.dropMessage(5, \"NEW Channel \" + chid + \" successfully deployed on world \" + worldid + \".\");\n+                    } else {\n+                        if(chid == -3) {\n+                            player.dropMessage(5, \"Invalid worldid detected. Channel creation aborted.\");\n+                        } else if(chid == -2) {\n+                            player.dropMessage(5, \"Reached channel limit on worldid \" + worldid + \". Channel creation aborted.\");\n+                        } else if(chid == -1) {\n+                            player.dropMessage(5, \"Error detected when loading the 'world.ini' file. Channel creation aborted.\");\n+                        } else {\n+                            player.dropMessage(5, \"NEW Channel failed to be deployed. Check if the needed port is already in use or other limitations are taking place.\");\n+                        }\n+                    }\n+                }\n+            }\n+        }).start();\n+    }\n+}"}, {"sha": "9414a5391c3506c389d4cdf30756e0aa470c7cb0", "filename": "src/client/command/commands/v6/ServerAddWorldCommand.java", "status": "added", "additions": 59, "deletions": 0, "changes": 59, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v6/ServerAddWorldCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v6/ServerAddWorldCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v6/ServerAddWorldCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,59 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v6;\n+\n+import client.MapleCharacter;\n+import client.command.Command;\n+import client.MapleClient;\n+import net.server.Server;\n+\n+public class ServerAddWorldCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        final MapleCharacter player = c.getPlayer();\n+        \n+        new Thread(new Runnable() {\n+            @Override\n+            public void run() {\n+                int wid = Server.getInstance().addWorld();\n+\n+                if(player.isLoggedinWorld()) {\n+                    if(wid >= 0) {\n+                        player.dropMessage(5, \"NEW World \" + wid + \" successfully deployed.\");\n+                    } else {\n+                        if(wid == -2) {\n+                            player.dropMessage(5, \"Error detected when loading the 'world.ini' file. World creation aborted.\");\n+                        } else {\n+                            player.dropMessage(5, \"NEW World failed to be deployed. Check if needed ports are already in use or maximum world count has been reached.\");\n+                        }\n+                    }\n+                }\n+            }\n+        }).start();\n+    }\n+}"}, {"sha": "95f00ae7683cedc497bb809bf5beeb52f9c6705c", "filename": "src/client/command/commands/v6/ServerRemoveChannelCommand.java", "status": "added", "additions": 61, "deletions": 0, "changes": 61, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v6/ServerRemoveChannelCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v6/ServerRemoveChannelCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v6/ServerRemoveChannelCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,61 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v6;\n+\n+import client.MapleCharacter;\n+import client.command.Command;\n+import client.MapleClient;\n+import net.server.Server;\n+\n+public class ServerRemoveChannelCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        final MapleCharacter player = c.getPlayer();\n+        \n+        if (params.length < 1) {\n+            player.dropMessage(5, \"Syntax: @removechannel <worldid>\");\n+            return;\n+        }\n+\n+        final int worldId = Integer.parseInt(params[0]);\n+        new Thread(new Runnable() {\n+            @Override\n+            public void run() {\n+                if(Server.getInstance().removeChannel(worldId)) {\n+                    if(player.isLoggedinWorld()) {\n+                        player.dropMessage(5, \"Successfully removed a channel on World \" + worldId + \". Current channel count: \" + Server.getInstance().getWorld(worldId).getChannelsSize() + \".\");\n+                    }\n+                } else {\n+                    if(player.isLoggedinWorld()) {\n+                        player.dropMessage(5, \"Failed to remove last Channel on world \" + worldId + \". Check if either that world exists or there are people currently playing there.\");\n+                    }\n+                }\n+            }\n+        }).start();\n+    }\n+}"}, {"sha": "217d74d0185635e78521a05cb61ec06e888b65da", "filename": "src/client/command/commands/v6/ServerRemoveWorldCommand.java", "status": "added", "additions": 65, "deletions": 0, "changes": 65, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v6/ServerRemoveWorldCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v6/ServerRemoveWorldCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v6/ServerRemoveWorldCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,65 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v6;\n+\n+import client.MapleCharacter;\n+import client.command.Command;\n+import client.MapleClient;\n+import net.server.Server;\n+\n+public class ServerRemoveWorldCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        final MapleCharacter player = c.getPlayer();\n+        \n+        final int rwid = Server.getInstance().getWorldsSize() - 1;\n+        if(rwid <= 0) {\n+            player.dropMessage(5, \"Unable to remove world 0.\");\n+            return;\n+        }\n+\n+        new Thread(new Runnable() {\n+            @Override\n+            public void run() {\n+                if(Server.getInstance().removeWorld()) {\n+                    if(player.isLoggedinWorld()) {\n+                        player.dropMessage(5, \"Successfully removed a world. Current world count: \" + Server.getInstance().getWorldsSize() + \".\");\n+                    }\n+                } else {\n+                    if(player.isLoggedinWorld()) {\n+                        if(rwid < 0) {\n+                            player.dropMessage(5, \"No registered worlds to remove.\");\n+                        } else {\n+                            player.dropMessage(5, \"Failed to remove world \" + rwid + \". Check if there are people currently playing there.\");\n+                        }\n+                    }\n+                }\n+            }\n+        }).start();\n+    }\n+}"}, {"sha": "f746b86e8b2570acd74aa83cf5e8745e4fe0f752", "filename": "src/client/command/commands/v6/SetGmLevelCommand.java", "status": "added", "additions": 55, "deletions": 0, "changes": 55, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v6/SetGmLevelCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v6/SetGmLevelCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v6/SetGmLevelCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,55 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v6;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+\n+public class SetGmLevelCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 2) {\n+            player.yellowMessage(\"Syntax: !setgmlevel <playername> <newlevel>\");\n+            return;\n+        }\n+\n+        int newLevel = Integer.parseInt(params[1]);\n+        MapleCharacter target = c.getChannelServer().getPlayerStorage().getCharacterByName(params[0]);\n+        if (target != null) {\n+            target.setGMLevel(newLevel);\n+            target.getClient().setGMLevel(newLevel);\n+\n+            target.dropMessage(\"You are now a level \" + newLevel + \" GM. See @commands for a list of available commands.\");\n+            player.dropMessage(target + \" is now a level \" + newLevel + \" GM.\");\n+        } else {\n+            player.dropMessage(\"Player '\" + params[0] + \"' was not found on this channel.\");\n+        }\n+    }\n+}"}, {"sha": "f678d5e6ab60591be179054612aca6f67b1ab025", "filename": "src/client/command/commands/v6/ShutdownCommand.java", "status": "added", "additions": 69, "deletions": 0, "changes": 69, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v6/ShutdownCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v6/ShutdownCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v6/ShutdownCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,69 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v6;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import net.server.Server;\n+import net.server.world.World;\n+\n+public class ShutdownCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 1){\n+            player.yellowMessage(\"Syntax: !shutdown [<time>|NOW]\");\n+        }\n+        int time = 60000;\n+        if (params[0].equalsIgnoreCase(\"now\")){\n+            time = 1;\n+        }else {\n+            time *= Integer.parseInt(params[0]);\n+        }\n+\n+        if (time > 1) {\n+            int seconds = (int) (time / 1000) % 60;\n+            int minutes = (int) ((time / (1000 * 60)) % 60);\n+            int hours = (int) ((time / (1000 * 60 * 60)) % 24);\n+            int days = (int) ((time / (1000 * 60 * 60 * 24)));\n+\n+            String strTime = \"\";\n+            if (days > 0) strTime += days + \" days, \";\n+            if (hours > 0) strTime += hours + \" hours, \";\n+            strTime += minutes + \" minutes, \";\n+            strTime += seconds + \" seconds\";\n+\n+            for (World w : Server.getInstance().getWorlds()) {\n+                for (MapleCharacter chr : w.getPlayerStorage().getAllCharacters()) {\n+                    chr.dropMessage(\"Server is undergoing maintenance process, and will be shutdown in \" + strTime + \". Prepare yourself to quit safely in the mean time.\");\n+                }\n+            }\n+        }\n+    }\n+}"}, {"sha": "2c6e95bfafe2248a8ece9ebb2b95f3cb49a07774", "filename": "src/client/command/commands/v6/SpawnAllPNpcsCommand.java", "status": "added", "additions": 41, "deletions": 0, "changes": 41, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v6/SpawnAllPNpcsCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v6/SpawnAllPNpcsCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v6/SpawnAllPNpcsCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,41 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v6;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import server.life.MaplePlayerNPC;\n+\n+public class SpawnAllPNpcsCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        MaplePlayerNPC.multicastSpawnPlayerNPC(player.getMapId(), player.getWorld());\n+    }\n+}"}, {"sha": "664c4ac739e01409372cb30c0bc9826da1c565f1", "filename": "src/client/command/commands/v6/WarpWorldCommand.java", "status": "added", "additions": 68, "deletions": 0, "changes": 68, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v6/WarpWorldCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/command/commands/v6/WarpWorldCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/v6/WarpWorldCommand.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,68 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.v6;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import client.MapleCharacter;\n+import net.server.Server;\n+import tools.MaplePacketCreator;\n+\n+import java.net.InetAddress;\n+import java.net.UnknownHostException;\n+\n+public class WarpWorldCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        MapleCharacter player = c.getPlayer();\n+        if (params.length < 1) {\n+            player.yellowMessage(\"Syntax: !warpworld <worldid>\");\n+            return;\n+        }\n+\n+        Server server = Server.getInstance();\n+        byte worldb = Byte.parseByte(params[0]);\n+        if (worldb <= (server.getWorldsSize() - 1)) {\n+            try {\n+                String[] socket = server.getInetSocket(worldb, c.getChannel());\n+                c.getWorldServer().removePlayer(player);\n+                player.getMap().removePlayer(player);//LOL FORGOT THIS ><\n+                c.updateLoginState(MapleClient.LOGIN_SERVER_TRANSITION);\n+                player.setWorld(worldb);\n+                player.saveCharToDB();//To set the new world :O (true because else 2 player instances are created, one in both worlds)\n+                c.announce(MaplePacketCreator.getChannelChange(InetAddress.getByName(socket[0]), Integer.parseInt(socket[1])));\n+            } catch (UnknownHostException | NumberFormatException ex) {\n+                ex.printStackTrace();\n+                player.message(\"Unexpected error when changing worlds, are you sure the world you are trying to warp to has the same amount of channels?\");\n+            }\n+\n+        } else {\n+            player.message(\"Invalid world; highest number available: \" + (server.getWorldsSize() - 1));\n+        }\n+    }\n+}"}, {"sha": "db943ba3859a63baeefb9d085c5978cf604149f4", "filename": "src/client/inventory/ItemFactory.java", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/inventory/ItemFactory.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/inventory/ItemFactory.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/inventory/ItemFactory.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -44,7 +44,8 @@\n     CASH_EXPLORER(3, true),\n     CASH_CYGNUS(4, true),\n     CASH_ARAN(5, true),\n-    MERCHANT(6, false);\n+    MERCHANT(6, false),\n+    CASH_OVERALL(7, true);\n     private final int value;\n     private final boolean account;\n     private static final Lock lock = MonitoredReentrantLockFactory.createLock(MonitoredLockType.ITEM, true);"}, {"sha": "c68f558b6f6ff44c1ead9706444e4977358e272a", "filename": "src/client/status/MonsterStatusEffect.java", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/client/status/MonsterStatusEffect.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/client/status/MonsterStatusEffect.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/status/MonsterStatusEffect.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -22,9 +22,10 @@\n package client.status;\n \n import client.Skill;\n-import java.util.Map;\n import server.life.MobSkill;\n-import tools.ArrayMap;\n+\n+import java.util.Map;\n+import java.util.concurrent.ConcurrentHashMap;\n \n public class MonsterStatusEffect {\n \n@@ -34,7 +35,7 @@\n     private boolean monsterSkill;\n     \n     public MonsterStatusEffect(Map<MonsterStatus, Integer> stati, Skill skillId, MobSkill mobskill, boolean monsterSkill) {\n-        this.stati = new ArrayMap<>(stati);\n+        this.stati = new ConcurrentHashMap<>(stati);\n         this.skill = skillId;\n         this.monsterSkill = monsterSkill;\n         this.mobskill = mobskill;"}, {"sha": "7830aadb28e489ad7c6a5c3761805112b50dbbbc", "filename": "src/constants/ServerConstants.java", "status": "modified", "additions": 18, "deletions": 5, "changes": 23, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/constants/ServerConstants.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/constants/ServerConstants.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/constants/ServerConstants.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -32,7 +32,15 @@\n     \n     public static final boolean AUTOMATIC_REGISTER = true;      //Automatically register players when they login with a nonexistent username.\n     public static final boolean BCRYPT_MIGRATION = true;        //Performs a migration from old SHA-1 and SHA-512 password to bcrypt.\n-    public static final boolean COLLECTIVE_CHARSLOT = false;     //Available character slots are contabilized globally rather than per world server.\n+    public static final boolean COLLECTIVE_CHARSLOT = false;    //Available character slots are contabilized globally rather than per world server.\n+    public static final boolean DETERRED_MULTICLIENT = false;    //Enables multi-client and suspicious remote IP detection on the login system.\n+    \n+    //Besides blocking logging in with several client sessions on the same machine, this also blocks suspicious login attempts for players that tries to login on an account using several diferent remote addresses.\n+    \n+    //Multiclient Coordinator Configuration\n+    public static final int MAX_ALLOWED_ACCOUNT_IP = 4;         //Allows up to N concurrent IP's for an account. IP's remains linked to an account longer the more times it's used to login.\n+    public static final int MAX_ACCOUNT_LOGIN_ATTEMPT = 15;     //After N tries on an account, login on that account gets disabled for a short period.\n+    public static final int LOGIN_ATTEMPT_DURATION = 120;       //Period in seconds the login attempt remains registered on the system.\n     \n     //Ip Configuration\n     public static String HOST;\n@@ -74,6 +82,7 @@\n     public static final boolean USE_ENFORCE_UNMERCHABLE_PET = true; //Forces players to not sell pets via merchants. (since non-named pets gets dirty name and other possible DB-related issues)\n     public static final boolean USE_ENFORCE_MDOOR_POSITION = false; //Forces mystic door to be spawned near spawnpoints.\n     public static final boolean USE_SPAWN_LOOT_ON_ANIMATION = false;//Makes loot appear some time after the mob has been killed (following the mob death animation, instead of instantly).\n+    public static final boolean USE_SPAWN_RELEVANT_LOOT = true;     //Forces to only spawn loots that are collectable by the player or any of their party members.\n     public static final boolean USE_ERASE_PERMIT_ON_OPENSHOP = true;//Forces \"shop permit\" item to be consumed when player deploy his/her player shop.\n     public static final boolean USE_ERASE_UNTRADEABLE_DROP = true;  //Forces flagged untradeable items to disappear when dropped.\n     public static final boolean USE_ERASE_PET_ON_EXPIRATION = false;//Forces pets to be removed from inventory when expire time comes, rather than converting it to a doll.\n@@ -82,27 +91,31 @@\n     public static final boolean USE_BANISHABLE_TOWN_SCROLL = true;  //Enables town scrolls to act as if it's a \"player banish\", rendering the antibanish scroll effect available.\n     public static final boolean USE_OLD_GMS_STYLED_PQ_NPCS = true;  //Enables PQ NPCs with similar behaviour to old GMS style, that skips info about the PQs and immediately tries to register the party in.\n     public static final boolean USE_ENABLE_SOLO_EXPEDITIONS = true; //Enables start expeditions with any number of players. This will also bypass all the Zakum prequest.\n-    public static final boolean USE_ENABLE_FULL_RESPAWN = true;    //At respawn task, always respawn missing mobs when they're available. Spawn count doesn't depend on how many players are currently there.\n+    public static final boolean USE_ENABLE_FULL_RESPAWN = true;     //At respawn task, always respawn missing mobs when they're available. Spawn count doesn't depend on how many players are currently there.\n     \n     //Announcement Configuration\n     public static final boolean USE_ANNOUNCE_SHOPITEMSOLD = false;  //Automatic message sent to owner when an item from the Player Shop or Hired Merchant is sold.\n     public static final boolean USE_ANNOUNCE_CHANGEJOB = false;     //Automatic message sent to acquantainces when changing jobs.\n     \n+    //Cash Shop Configuration\n+    public static final boolean USE_JOINT_CASHSHOP_INVENTORY = true;//Enables usage of a same cash shop inventory for explorers, cygnus and legends. Items from exclusive cash shop inventories won't show up on the shared inventory, though.\n+    \n     //Maker Configuration\n     public static final boolean USE_MAKER_PERMISSIVE_ATKUP = true;  //Allows players to use attack-based strengthening gems on non-weapon items.\n     public static final boolean USE_MAKER_FEE_HEURISTICS = true;    //Apply compiled values for stimulants and reagents into the Maker fee calculations (max error revolves around 50k mesos). Set false to use basic constant values instead (results are never higher than requested by the client-side).\n     \n     //Commands Configuration\n     public static final boolean BLOCK_GENERATE_CASH_ITEM = false;   //Prevents creation of cash items with the item/drop command.\n+    public static final boolean USE_WHOLE_SERVER_RANKING = false;   //Enables a ranking pool made from every character registered on the server for the \"ranks\" command, instead of separated by worlds.\n     \n     //Server Rates And Experience\n     public static final int EXP_RATE = 10;\n     public static final int MESO_RATE = 10;\n     public static final int DROP_RATE = 10;\n-    public static final int TRAVEL_RATE = 10;                       //Means of transportation rides/departs using 1/N of the default time.\n     public static final int QUEST_RATE = 5;                         //Multiplier for Exp & Meso gains when completing a quest. Only available when USE_QUEST_RATE is true. Stacks with server Exp & Meso rates.\n-    public static final double EQUIP_EXP_RATE = 1.0;                //Rate for equipment exp gain, grows linearly. Set 1.0 for default (about 100~200 same-level range mobs killed to pass equip from level 1 to 2).\n+    public static final int TRAVEL_RATE = 10;                       //Means of transportation rides/departs using 1/N of the default time.\n     \n+    public static final double EQUIP_EXP_RATE = 1.0;                //Rate for equipment exp gain, grows linearly. Set 1.0 for default (about 100~200 same-level range mobs killed to pass equip from level 1 to 2).\n     public static final double PARTY_BONUS_EXP_RATE = 1.0;          //Rate for the party exp reward.\n     public static final double PQ_BONUS_EXP_RATE = 0.5;             //Rate for the PQ exp reward.\n     \n@@ -118,7 +131,7 @@\n     public static final int MAX_EVENT_LEVELS = 8;                       //Event has different levels of rewarding system.\n     public static final long BLOCK_NPC_RACE_CONDT = (long)(0.5 * 1000); //Time the player client must wait before reopening a conversation with an NPC.\n     public static final long PET_LOOT_UPON_ATTACK = (long)(0.7 * 1000); //Time the pet must wait before trying to pick items up.\n-    public static final int TOT_MOB_QUEST_REQUIREMENT = 77;              //Overwrites old 999-mobs requirement for the ToT questline with new requirement value, set 0 for default.\n+    public static final int TOT_MOB_QUEST_REQUIREMENT = 77;             //Overwrites old 999-mobs requirement for the ToT questline with new requirement value, set 0 for default.\n     public static final int MOB_REACTOR_REFRESH_TIME = 30 * 1000;       //Overwrites refresh time for those reactors oriented to inflict damage to bosses (Ice Queen, Riche), set 0 for default.\n     \n     //Dangling Items/Locks Configuration"}, {"sha": "ee5c237d3df7aba7bae6875d3a741fe85228dde1", "filename": "src/net/MapleServerHandler.java", "status": "modified", "additions": 31, "deletions": 12, "changes": 43, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/net/MapleServerHandler.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/net/MapleServerHandler.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/MapleServerHandler.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -28,23 +28,25 @@\n import java.util.Calendar;\n import java.util.concurrent.atomic.AtomicLong;\n \n-import net.server.audit.locks.MonitoredLockType;\n-import net.server.audit.locks.factory.MonitoredReentrantLockFactory;\n-import net.server.Server;\n-\n import org.apache.mina.core.service.IoHandlerAdapter;\n import org.apache.mina.core.session.IdleStatus;\n import org.apache.mina.core.session.IoSession;\n \n+import client.MapleClient;\n+import constants.ServerConstants;\n+\n+import net.server.Server;\n+import net.server.audit.locks.MonitoredLockType;\n+import net.server.audit.locks.factory.MonitoredReentrantLockFactory;\n+import net.server.coordinator.MapleSessionCoordinator;\n+\n import tools.FilePrinter;\n import tools.MapleAESOFB;\n import tools.MapleLogger;\n import tools.MaplePacketCreator;\n import tools.data.input.ByteArrayByteStream;\n import tools.data.input.GenericSeekableLittleEndianAccessor;\n import tools.data.input.SeekableLittleEndianAccessor;\n-import client.MapleClient;\n-import constants.ServerConstants;\n import java.util.Arrays;\n \n import java.util.concurrent.locks.Lock;\n@@ -89,8 +91,10 @@ public void exceptionCaught(IoSession session, Throwable cause) throws Exception\n             return;\n         }\n         \n+        /*\n     \tSystem.out.println(\"disconnect by exception\");\n         cause.printStackTrace();\n+        */\n         \n         if (cause instanceof IOException || cause instanceof ClassCastException) {\n             return;\n@@ -101,18 +105,27 @@ public void exceptionCaught(IoSession session, Throwable cause) throws Exception\n         }\n     }\n \n+    private boolean isLoginServerHandler() {\n+        return channel == -1 && world == -1;\n+    }\n+    \n     @Override\n     public void sessionOpened(IoSession session) {\n         if (!Server.getInstance().isOnline()) {\n-            session.close(true);\n+            MapleSessionCoordinator.getInstance().closeSession(session, true);\n             return;\n         }\n-        if (channel > -1 && world > -1) {\n+        \n+        if (!isLoginServerHandler()) {\n             if (Server.getInstance().getChannel(world, channel) == null) {\n-                session.close(true);\n+                MapleSessionCoordinator.getInstance().closeSession(session, true);\n                 return;\n             }\n         } else {\n+            if (!MapleSessionCoordinator.getInstance().canStartLoginSession(session)) {\n+                return;\n+            }\n+            \n             FilePrinter.print(FilePrinter.SESSION, \"IoSession with \" + session.getRemoteAddress() + \" opened on \" + sdf.format(Calendar.getInstance().getTime()), false);\n         }\n \n@@ -132,6 +145,12 @@ public void sessionOpened(IoSession session) {\n \n     @Override\n     public void sessionClosed(IoSession session) throws Exception {\n+        if (isLoginServerHandler()) {\n+            MapleSessionCoordinator.getInstance().closeLoginSession(session);\n+        } else {\n+            MapleSessionCoordinator.getInstance().closeSession(session, null);\n+        }\n+        \n         MapleClient client = (MapleClient) session.getAttribute(MapleClient.CLIENT_KEY);\n         if (client != null) {\n             try {\n@@ -190,15 +209,15 @@ public void sessionIdle(final IoSession session, final IdleStatus status) throws\n     private void registerIdleSession(MapleClient c) {\n         if(idleLock.tryLock()) {\n             try {\n-                idleSessions.put(c, System.currentTimeMillis());\n+                idleSessions.put(c, Server.getInstance().getCurrentTime());\n                 c.announce(MaplePacketCreator.getPing());\n             } finally {\n                 idleLock.unlock();\n             }\n         } else {\n             tempLock.lock();\n             try {\n-                tempIdleSessions.put(c, System.currentTimeMillis());\n+                tempIdleSessions.put(c, Server.getInstance().getCurrentTime());\n                 c.announce(MaplePacketCreator.getPing());\n             } finally {\n                 tempLock.unlock();\n@@ -207,7 +226,7 @@ private void registerIdleSession(MapleClient c) {\n     }\n     \n     private void manageIdleSessions() {\n-        long timeNow = System.currentTimeMillis();\n+        long timeNow = Server.getInstance().getCurrentTime();\n         long timeThen = timeNow - 15000;\n         \n         idleLock.lock();"}, {"sha": "720c5589513489d5fd3e723655e478686e2fb401", "filename": "src/net/mina/MaplePacketDecoder.java", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/net/mina/MaplePacketDecoder.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/net/mina/MaplePacketDecoder.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/mina/MaplePacketDecoder.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -22,6 +22,7 @@\n package net.mina;\n \n import client.MapleClient;\n+import net.server.coordinator.MapleSessionCoordinator;\n import org.apache.mina.core.buffer.IoBuffer;\n import org.apache.mina.core.session.IoSession;\n import org.apache.mina.filter.codec.CumulativeProtocolDecoder;\n@@ -39,7 +40,7 @@\n     protected boolean doDecode(IoSession session, IoBuffer in, ProtocolDecoderOutput out) throws Exception {\n         final MapleClient client = (MapleClient) session.getAttribute(MapleClient.CLIENT_KEY);\n         if(client == null) {\n-            session.close(true);\n+            MapleSessionCoordinator.getInstance().closeSession(session, true);\n             return false;\n         }\n         \n@@ -53,7 +54,7 @@ protected boolean doDecode(IoSession session, IoBuffer in, ProtocolDecoderOutput\n         if (in.remaining() >= 4 && decoderState.packetlength == -1) {\n             int packetHeader = in.getInt();\n             if (!rcvdCrypto.checkPacket(packetHeader)) {\n-                session.close(true);\n+                MapleSessionCoordinator.getInstance().closeSession(session, true);\n                 return false;\n             }\n             decoderState.packetlength = MapleAESOFB.getPacketLength(packetHeader);"}, {"sha": "fffd2e0ec2b35baf10568a55e6006ac3914fee75", "filename": "src/net/server/Server.java", "status": "modified", "additions": 188, "deletions": 16, "changes": 204, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/net/server/Server.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/net/server/Server.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/Server.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -59,7 +59,10 @@\n import net.server.guild.MapleGuildCharacter;\n import net.server.worker.CharacterDiseaseWorker;\n import net.server.worker.CouponWorker;\n-import net.server.worker.RankingWorker;\n+import net.server.worker.LoginCoordinatorWorker;\n+import net.server.worker.LoginStorageWorker;\n+import net.server.worker.RankingCommandWorker;\n+import net.server.worker.RankingLoginWorker;\n import net.server.worker.ReleaseLockWorker;\n import net.server.world.World;\n \n@@ -90,6 +93,16 @@\n import tools.Pair;\n \n public class Server {\n+    \n+    private static Server instance = null;\n+    \n+    public static Server getInstance() {\n+        if (instance == null) {\n+            instance = new Server();\n+        }\n+        return instance;\n+    }\n+    \n     private static final Set<Integer> activeFly = new HashSet<>();\n     private static final Map<Integer, Integer> couponRates = new HashMap<>(30);\n     private static final List<Integer> activeCoupons = new LinkedList<>();\n@@ -98,7 +111,6 @@\n     private List<Map<Integer, String>> channels = new LinkedList<>();\n     private List<World> worlds = new ArrayList<>();\n     private final Properties subnetInfo = new Properties();\n-    private static Server instance = null;\n     private final Map<Integer, Set<Integer>> accountChars = new HashMap<>();\n     private final Map<Integer, Short> accountCharacterCount = new HashMap<>();\n     private final Map<Integer, Integer> worldChars = new HashMap<>();\n@@ -113,6 +125,8 @@\n     private final List<MapleClient> processDiseaseAnnouncePlayers = new LinkedList<>();\n     private final List<MapleClient> registeredDiseaseAnnouncePlayers = new LinkedList<>();\n     \n+    private final List<List<Pair<String, Integer>>> playerRanking = new LinkedList<>();\n+    \n     private final Lock srvLock = MonitoredReentrantLockFactory.createLock(MonitoredLockType.SERVER);\n     private final Lock disLock = MonitoredReentrantLockFactory.createLock(MonitoredLockType.SERVER_DISEASES);\n     \n@@ -131,13 +145,6 @@\n     private boolean online = false;\n     public static long uptime = System.currentTimeMillis();\n     \n-    public static Server getInstance() {\n-        if (instance == null) {\n-            instance = new Server();\n-        }\n-        return instance;\n-    }\n-\n     public long getCurrentTime() {  // returns a slightly delayed time value, under frequency of UPDATE_INTERVAL\n         return serverCurrentTime;\n     }\n@@ -343,8 +350,9 @@ public int addWorld() {\n         \n         int newWorld = initWorld(p);\n         if(newWorld > -1) {\n-            Set<Integer> accounts;\n+            installWorldPlayerRanking(newWorld);\n             \n+            Set<Integer> accounts;\n             lgnRLock.lock();\n             try {\n                 accounts = new HashSet<>(accountChars.keySet());\n@@ -360,6 +368,11 @@ public int addWorld() {\n         return newWorld;\n     }\n     \n+    private static int getWorldProperty(Properties p, String property, int wid, int defaultValue) {\n+        String content = p.getProperty(property + wid);\n+        return content != null ? Integer.parseInt(content) : defaultValue;\n+    }\n+    \n     private int initWorld(Properties p) {\n         wldWLock.lock();\n         try {\n@@ -370,13 +383,16 @@ private int initWorld(Properties p) {\n             }\n             \n             System.out.println(\"Starting world \" + i);\n+            int exprate = getWorldProperty(p, \"exprate\", i, ServerConstants.EXP_RATE);\n+            int mesorate = getWorldProperty(p, \"mesorate\", i, ServerConstants.MESO_RATE);\n+            int droprate = getWorldProperty(p, \"droprate\", i, ServerConstants.DROP_RATE);\n+            int questrate = getWorldProperty(p, \"questrate\", i, ServerConstants.QUEST_RATE);\n+            int travelrate = getWorldProperty(p, \"travelrate\", i, ServerConstants.TRAVEL_RATE);\n+            \n             World world = new World(i,\n                     Integer.parseInt(p.getProperty(\"flag\" + i)),\n                     p.getProperty(\"eventmessage\" + i),\n-                    ServerConstants.EXP_RATE,\n-                    ServerConstants.DROP_RATE,\n-                    ServerConstants.MESO_RATE,\n-                    ServerConstants.QUEST_RATE);\n+                    exprate, droprate, mesorate, questrate, travelrate);\n \n             worldRecommendedList.add(new Pair<>(i, p.getProperty(\"whyamirecommended\" + i)));\n             worlds.add(world);\n@@ -446,6 +462,7 @@ public boolean removeWorld() {   //lol don't!\n         wldWLock.lock();\n         try {\n             if(worldid == worlds.size() - 1) {\n+                removeWorldPlayerRanking();\n                 w.shutdown();\n                 \n                 worlds.remove(worldid);\n@@ -627,6 +644,157 @@ public void registerAnnouncePlayerDiseases(MapleClient c) {\n         }\n     }\n     \n+    public List<Pair<String, Integer>> getWorldPlayerRanking(int worldid) {\n+        wldRLock.lock();\n+        try {\n+            return new ArrayList<>(playerRanking.get(!ServerConstants.USE_WHOLE_SERVER_RANKING ? worldid : 0));\n+        } finally {\n+            wldRLock.unlock();\n+        }\n+    }\n+    \n+    private void installWorldPlayerRanking(int worldid) {\n+        List<Pair<Integer, List<Pair<String, Integer>>>> ranking = updatePlayerRankingFromDB(worldid);\n+        if(!ranking.isEmpty()) {\n+            wldWLock.lock();\n+            try {\n+                if (!ServerConstants.USE_WHOLE_SERVER_RANKING) {\n+                    for(int i = playerRanking.size(); i <= worldid; i++) {\n+                        playerRanking.add(new ArrayList<Pair<String, Integer>>(0));\n+                    }\n+                    \n+                    playerRanking.add(worldid, ranking.get(0).getRight());\n+                } else {\n+                    playerRanking.add(0, ranking.get(0).getRight());\n+                }\n+            } finally {\n+                wldWLock.unlock();\n+            }\n+        }\n+    }\n+    \n+    private void removeWorldPlayerRanking() {\n+        if (!ServerConstants.USE_WHOLE_SERVER_RANKING) {\n+            wldWLock.lock();\n+            try {\n+                if(playerRanking.size() < this.getWorldsSize()) {\n+                    return;\n+                }\n+                \n+                playerRanking.remove(playerRanking.size() - 1);\n+            } finally {\n+                wldWLock.unlock();\n+            }\n+        } else {\n+            List<Pair<Integer, List<Pair<String, Integer>>>> ranking = updatePlayerRankingFromDB(-1 * (this.getWorldsSize() - 2));  // update ranking list\n+            \n+            wldWLock.lock();\n+            try {\n+                playerRanking.add(0, ranking.get(0).getRight());\n+            } finally {\n+                wldWLock.unlock();\n+            }\n+        }\n+    }\n+    \n+    public void updateWorldPlayerRanking() {\n+        List<Pair<Integer, List<Pair<String, Integer>>>> rankUpdates = updatePlayerRankingFromDB(-1 * (this.getWorldsSize() - 1));\n+        if(!rankUpdates.isEmpty()) {\n+            wldWLock.lock();\n+            try {\n+                if (!ServerConstants.USE_WHOLE_SERVER_RANKING) {\n+                    for(int i = playerRanking.size(); i <= rankUpdates.get(rankUpdates.size() - 1).getLeft(); i++) {\n+                        playerRanking.add(new ArrayList<Pair<String, Integer>>(0));\n+                    }\n+                    \n+                    for(Pair<Integer, List<Pair<String, Integer>>> wranks : rankUpdates) {\n+                        playerRanking.set(wranks.getLeft(), wranks.getRight());\n+                    }\n+                } else {\n+                    playerRanking.set(0, rankUpdates.get(0).getRight());\n+                }\n+            } finally {\n+                wldWLock.unlock();\n+            }\n+        }\n+    }\n+    \n+    private void initWorldPlayerRanking() {\n+        if (ServerConstants.USE_WHOLE_SERVER_RANKING) {\n+            playerRanking.add(new ArrayList<Pair<String, Integer>>(0));\n+        }        \n+        updateWorldPlayerRanking();\n+    }\n+    \n+    private static List<Pair<Integer, List<Pair<String, Integer>>>> updatePlayerRankingFromDB(int worldid) {\n+        List<Pair<Integer, List<Pair<String, Integer>>>> rankSystem = new ArrayList<>();\n+        List<Pair<String, Integer>> rankUpdate = new ArrayList<>(0);\n+        \n+        PreparedStatement ps = null;\n+        ResultSet rs = null;\n+        Connection con = null;\n+        try {\n+            con = DatabaseConnection.getConnection();\n+            \n+            String worldQuery;\n+            if (!ServerConstants.USE_WHOLE_SERVER_RANKING) {\n+                if(worldid >= 0) {\n+                    worldQuery = (\" AND `characters`.`world` = \" + worldid);\n+                } else {\n+                    worldQuery = (\" AND `characters`.`world` >= 0 AND `characters`.`world` <= \" + -worldid);\n+                }\n+            } else {\n+                worldQuery = (\" AND `characters`.`world` >= 0 AND `characters`.`world` <= \" + Math.abs(worldid));\n+            }\n+            \n+            ps = con.prepareStatement(\"SELECT `characters`.`name`, `characters`.`level`, `characters`.`world` FROM `characters` LEFT JOIN accounts ON accounts.id = characters.accountid WHERE `characters`.`gm` < 2 AND `accounts`.`banned` = '0'\" + worldQuery + \" ORDER BY \" + (!ServerConstants.USE_WHOLE_SERVER_RANKING ? \"world, \" : \"\") + \"level DESC, exp DESC LIMIT 50\");\n+            rs = ps.executeQuery();\n+            \n+            if (!ServerConstants.USE_WHOLE_SERVER_RANKING) {\n+                int currentWorld = -1;\n+                while(rs.next()) {\n+                    int rsWorld = rs.getInt(\"world\");\n+                    if(currentWorld < rsWorld) {\n+                        currentWorld = rsWorld;\n+                        rankUpdate = new ArrayList<>(50);\n+                        rankSystem.add(new Pair<>(rsWorld, rankUpdate));\n+                    }\n+\n+                    rankUpdate.add(new Pair<>(rs.getString(\"name\"), rs.getInt(\"level\")));\n+                }\n+            } else {\n+                rankUpdate = new ArrayList<>(50);\n+                rankSystem.add(new Pair<>(0, rankUpdate));\n+                \n+                while(rs.next()) {\n+                    rankUpdate.add(new Pair<>(rs.getString(\"name\"), rs.getInt(\"level\")));\n+                }\n+            }\n+            \n+            ps.close();\n+            rs.close();\n+            con.close();\n+        } catch(SQLException ex) {\n+            ex.printStackTrace();\n+        } finally {\n+            try {\n+                if(ps != null && !ps.isClosed()) {\n+                    ps.close();\n+                }\n+                if(rs != null && !rs.isClosed()) {\n+                    rs.close();\n+                }\n+                if(con != null && !con.isClosed()) {\n+                    con.close();\n+                }\n+            } catch (SQLException e) {\n+                e.printStackTrace();\n+            }\n+        }\n+        \n+        return rankSystem;\n+    }\n+    \n     public void init() {\n         Properties p = loadWorldINI();\n         if(p == null) {\n@@ -635,7 +803,7 @@ public void init() {\n \n         System.out.println(\"HeavenMS v\" + ServerConstants.VERSION + \" starting up.\\r\\n\");\n \n-\n+        \n         if(ServerConstants.SHUTDOWNHOOK)\n             Runtime.getRuntime().addShutdownHook(new Thread(shutdown(false)));\n         \n@@ -670,7 +838,10 @@ public void init() {\n         tMan.register(new CharacterDiseaseWorker(), ServerConstants.UPDATE_INTERVAL, ServerConstants.UPDATE_INTERVAL);\n         tMan.register(new ReleaseLockWorker(), 2 * 60 * 1000, 2 * 60 * 1000);\n         tMan.register(new CouponWorker(), ServerConstants.COUPON_INTERVAL, timeLeft);\n-        tMan.register(new RankingWorker(), ServerConstants.RANKING_INTERVAL, timeLeft);\n+        tMan.register(new RankingCommandWorker(), 5 * 60 * 1000, 5 * 60 * 1000);\n+        tMan.register(new RankingLoginWorker(), ServerConstants.RANKING_INTERVAL, timeLeft);\n+        tMan.register(new LoginCoordinatorWorker(), 60 * 60 * 1000, timeLeft);\n+        tMan.register(new LoginStorageWorker(), 2 * 60 * 1000, 2 * 60 * 1000);\n         \n         long timeToTake = System.currentTimeMillis();\n         SkillFactory.loadAllSkills();\n@@ -696,6 +867,7 @@ public void init() {\n             for (int i = 0; i < worldCount; i++) {\n                 initWorld(p);\n             }\n+            initWorldPlayerRanking();\n             \n             MaplePlayerNPCFactory.loadFactoryMetadata();\n             loadPlayerNpcMapStepFromDb();"}, {"sha": "3e9705f8783359722babe3dcef0b9714f275068f", "filename": "src/net/server/audit/LockCollector.java", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/net/server/audit/LockCollector.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/net/server/audit/LockCollector.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/audit/LockCollector.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -35,13 +35,13 @@\n     \n     private static final LockCollector instance = new LockCollector();\n     \n-    private Map<Runnable, Integer> disposableLocks = new HashMap<>(200);\n-    private final Lock lock = new ReentrantLock(true);\n-    \n     public static LockCollector getInstance() {\n         return instance;\n     }\n     \n+    private Map<Runnable, Integer> disposableLocks = new HashMap<>(200);\n+    private final Lock lock = new ReentrantLock(true);\n+    \n     public void registerDisposeAction(Runnable r) {\n         lock.lock();\n         try {"}, {"sha": "f70f834de184ba3670e563d13a2182e3dde0b84c", "filename": "src/net/server/audit/ThreadTracker.java", "status": "modified", "additions": 8, "deletions": 7, "changes": 15, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/net/server/audit/ThreadTracker.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/net/server/audit/ThreadTracker.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/audit/ThreadTracker.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -48,6 +48,14 @@\n  */\n public class ThreadTracker {\n     private static ThreadTracker instance = null;\n+    \n+    public static ThreadTracker getInstance() {\n+        if (instance == null) {\n+            instance = new ThreadTracker();\n+        }\n+        return instance;\n+    }\n+    \n     private final Lock ttLock = new ReentrantLock(true);\n     \n     private final Map<Long, List<MonitoredLockType>> threadTracker = new HashMap<>();\n@@ -278,11 +286,4 @@ public void run() {\n     public void cancelThreadTrackerTask() {\n         threadTrackerSchedule.cancel(false);\n     }\n-    \n-    public static ThreadTracker getInstance() {\n-        if (instance == null) {\n-            instance = new ThreadTracker();\n-        }\n-        return instance;\n-    }\n }"}, {"sha": "042d302dd6359cf314188dcaa976967b7fe64b46", "filename": "src/net/server/audit/locks/MonitoredLockType.java", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/net/server/audit/locks/MonitoredLockType.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/net/server/audit/locks/MonitoredLockType.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/audit/locks/MonitoredLockType.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -45,6 +45,7 @@\n     SERVER,\n     SERVER_DISEASES,\n     SERVER_LOGIN,\n+    SERVER_LOGIN_COORD,\n     SERVER_WORLDS,\n     MERCHANT,\n     CHANNEL,"}, {"sha": "8b4fecefa9da4883eed6a3899ff83af9f5109b98", "filename": "src/net/server/channel/Channel.java", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/net/server/channel/Channel.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/net/server/channel/Channel.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/channel/Channel.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -217,7 +217,7 @@ public final void shutdown() {\n             acceptor.unbind();\n             \n             finishedShutdown = true;\n-            System.out.println(\"Successfully shut down Channel \" + channel + \" on World \" + world + \"\\r\\n\");          \n+            System.out.println(\"Successfully shut down Channel \" + channel + \" on World \" + world + \"\\r\\n\");\n         } catch (Exception e) {\n             e.printStackTrace();\n             System.err.println(\"Error while shutting down Channel \" + channel + \" on World \" + world + \"\\r\\n\" + e);"}, {"sha": "97465fc086558a9af8c0f28055900e50e2eaa64a", "filename": "src/net/server/channel/handlers/GeneralChatHandler.java", "status": "modified", "additions": 5, "deletions": 26, "changes": 31, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/net/server/channel/handlers/GeneralChatHandler.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/net/server/channel/handlers/GeneralChatHandler.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/channel/handlers/GeneralChatHandler.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -24,23 +24,13 @@\n import client.MapleCharacter;\n import client.MapleClient;\n import client.autoban.AutobanFactory;\n-import client.command.Commands;\n-import java.text.SimpleDateFormat;\n-import java.util.Calendar;\n+import client.command.CommandsExecutor;\n import net.AbstractMaplePacketHandler;\n import tools.FilePrinter;\n import tools.MaplePacketCreator;\n import tools.data.input.SeekableLittleEndianAccessor;\n \n-public final class GeneralChatHandler extends AbstractMaplePacketHandler {\n-        private static boolean isCommandIssue(char heading, MapleCharacter chr) {\n-                if(chr.gmLevel() > 1 && heading == '!') {\n-                        return true;\n-                } else {\n-                        return heading == '@';\n-                }\n-        }\n-    \n+public final class GeneralChatHandler extends AbstractMaplePacketHandler {    \n \t@Override\n         public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c) {\n                 String s = slea.readMapleAsciiString();\n@@ -56,19 +46,8 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n                         return;\n                 }\n                 char heading = s.charAt(0);\n-                if (isCommandIssue(heading, chr)) {\n-                        String[] sp = s.split(\" \");\n-                        sp[0] = sp[0].toLowerCase().substring(1);\n-\n-                        if(Commands.executeHeavenMsPlayerCommand(c, sp, heading)) {\n-                            String command = \"\";\n-                            for (String used : sp) {\n-                                    command += used + \" \";\n-                            }\n-\n-                            SimpleDateFormat sdf = new SimpleDateFormat(\"dd-MM-yyyy HH:mm\");\n-                            FilePrinter.print(FilePrinter.USED_COMMANDS, c.getPlayer().getName() + \" used: \" + heading + command + \"on \" + sdf.format(Calendar.getInstance().getTime()) + \"\\r\\n\");\n-                        }\n+                if (CommandsExecutor.isCommand(c, s)) {\n+                        CommandsExecutor.getInstance().handle(c, s);\n                 } else if (heading != '/') {\n                         int show = slea.readByte();\n                         if(chr.getMap().isMuted() && !chr.isGM()) {\n@@ -85,4 +64,4 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n                         chr.getAutobanManager().spam(7);\n                 }\n         }\n-}\n+}\n\\ No newline at end of file"}, {"sha": "26e7609ba1ac01c64b054077cc45108aee0f6a1b", "filename": "src/net/server/channel/handlers/PetLootHandler.java", "status": "modified", "additions": 27, "deletions": 28, "changes": 55, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/net/server/channel/handlers/PetLootHandler.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/net/server/channel/handlers/PetLootHandler.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/channel/handlers/PetLootHandler.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -55,41 +55,40 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n         \n         slea.skip(13);\n         int oid = slea.readInt();\n-        MapleMapObject ob = chr.getMap().getMapObject(oid);\n-        if(ob == null) {\n-            c.announce(MaplePacketCreator.enableActions());\n-            return;\n-        }\n-        \n-        MapleMapItem mapitem = (MapleMapItem) ob;\n-        if (mapitem.getMeso() > 0) {\n-            if (!chr.isEquippedMesoMagnet()) {\n-                c.announce(MaplePacketCreator.enableActions());\n-                return;\n-            }\n-            \n-            if (chr.isEquippedPetItemIgnore()) {\n-                final Set<Integer> petIgnore = chr.getExcludedItems();\n-                if(!petIgnore.isEmpty() && petIgnore.contains(Integer.MAX_VALUE)) {\n+        MapleMapObject ob = chr.getMap().getMapObject(oid);        \n+        try {\n+            MapleMapItem mapitem = (MapleMapItem) ob;\n+            if (mapitem.getMeso() > 0) {\n+                if (!chr.isEquippedMesoMagnet()) {\n                     c.announce(MaplePacketCreator.enableActions());\n                     return;\n                 }\n-            }\n-        } else {\n-            if (!chr.isEquippedItemPouch()) {\n-                c.announce(MaplePacketCreator.enableActions());\n-                return;\n-            }\n-            \n-            if (chr.isEquippedPetItemIgnore()) {\n-                final Set<Integer> petIgnore = chr.getExcludedItems();\n-                if(!petIgnore.isEmpty() && petIgnore.contains(mapitem.getItem().getItemId())) {\n+\n+                if (chr.isEquippedPetItemIgnore()) {\n+                    final Set<Integer> petIgnore = chr.getExcludedItems();\n+                    if(!petIgnore.isEmpty() && petIgnore.contains(Integer.MAX_VALUE)) {\n+                        c.announce(MaplePacketCreator.enableActions());\n+                        return;\n+                    }\n+                }\n+            } else {\n+                if (!chr.isEquippedItemPouch()) {\n                     c.announce(MaplePacketCreator.enableActions());\n                     return;\n                 }\n+\n+                if (chr.isEquippedPetItemIgnore()) {\n+                    final Set<Integer> petIgnore = chr.getExcludedItems();\n+                    if(!petIgnore.isEmpty() && petIgnore.contains(mapitem.getItem().getItemId())) {\n+                        c.announce(MaplePacketCreator.enableActions());\n+                        return;\n+                    }\n+                }\n             }\n+\n+            chr.pickupItem(ob, petIndex);\n+        } catch (NullPointerException | ClassCastException e) {\n+            c.announce(MaplePacketCreator.enableActions());\n         }\n-        \n-        chr.pickupItem(ob, petIndex);\n     }\n }"}, {"sha": "314069638b130ca218f054eda75c3233af6fb5a7", "filename": "src/net/server/coordinator/LoginStorage.java", "status": "added", "additions": 92, "deletions": 0, "changes": 92, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/net/server/coordinator/LoginStorage.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/net/server/coordinator/LoginStorage.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/coordinator/LoginStorage.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,92 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+package net.server.coordinator;\n+\n+import constants.ServerConstants;\n+import java.util.Collections;\n+import java.util.LinkedList;\n+import java.util.List;\n+import java.util.Map.Entry;\n+import java.util.concurrent.ConcurrentHashMap;\n+\n+import net.server.Server;\n+\n+/**\n+ *\n+ * @author Ronan\n+ */\n+public class LoginStorage {\n+    \n+    ConcurrentHashMap<Integer, List<Long>> loginHistory = new ConcurrentHashMap<>();\n+    \n+    public boolean registerLogin(int accountId) {\n+        List<Long> accHist = loginHistory.putIfAbsent(accountId, new LinkedList<Long>());\n+        if (accHist != null) {\n+            synchronized (accHist) {\n+                if (accHist.size() > ServerConstants.MAX_ACCOUNT_LOGIN_ATTEMPT) {\n+                    long blockExpiration = Server.getInstance().getCurrentTime() + ServerConstants.LOGIN_ATTEMPT_DURATION;\n+                    Collections.fill(accHist, blockExpiration);\n+                    \n+                    return false;\n+                }\n+            }\n+        } else {\n+            accHist = loginHistory.get(accountId);\n+        }\n+        \n+        synchronized (accHist) {\n+            accHist.add(Server.getInstance().getCurrentTime() + ServerConstants.LOGIN_ATTEMPT_DURATION);\n+            return true;\n+        }\n+    }\n+    \n+    public void updateLoginHistory() {\n+        long timeNow = Server.getInstance().getCurrentTime();\n+        List<Integer> toRemove = new LinkedList<>();\n+        List<Long> toRemoveAttempt = new LinkedList<>();\n+        \n+        for (Entry<Integer, List<Long>> loginEntries : loginHistory.entrySet()) {\n+            toRemoveAttempt.clear();\n+            \n+            List<Long> accAttempts = loginEntries.getValue();\n+            synchronized (accAttempts) {\n+                for (Long loginAttempt : accAttempts) {\n+                    if (loginAttempt < timeNow) {\n+                        toRemoveAttempt.add(loginAttempt);\n+                    }\n+                }\n+\n+                if (!toRemoveAttempt.isEmpty()) {\n+                    for (Long trAttempt : toRemoveAttempt) {\n+                        accAttempts.remove(trAttempt);\n+                    }\n+\n+                    if (accAttempts.isEmpty()) {\n+                        toRemove.add(loginEntries.getKey());\n+                    }\n+                }\n+            }\n+        }\n+        \n+        for (Integer tr : toRemove) {\n+            loginHistory.remove(tr);\n+        }\n+    }\n+}"}, {"sha": "ddf6820b355dd9c0c3b8b694ac042726bf02e1a3", "filename": "src/net/server/coordinator/MapleSessionCoordinator.java", "status": "added", "additions": 339, "deletions": 0, "changes": 339, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/net/server/coordinator/MapleSessionCoordinator.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/net/server/coordinator/MapleSessionCoordinator.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/coordinator/MapleSessionCoordinator.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,339 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+package net.server.coordinator;\n+\n+import constants.ServerConstants;\n+\n+import net.server.Server;\n+import net.server.audit.locks.MonitoredLockType;\n+import net.server.audit.locks.factory.MonitoredReentrantLockFactory;\n+import org.apache.mina.core.session.IoSession;\n+import tools.DatabaseConnection;\n+\n+import java.net.InetSocketAddress;\n+import java.sql.Connection;\n+import java.sql.PreparedStatement;\n+import java.sql.ResultSet;\n+import java.sql.SQLException;\n+import java.util.ArrayList;\n+import java.util.List;\n+import java.util.HashMap;\n+import java.util.HashSet;\n+import java.util.Map;\n+import java.util.Set;\n+import java.util.concurrent.locks.Lock;\n+import java.util.concurrent.locks.ReentrantLock;\n+\n+/**\n+ *\n+ * @author Ronan\n+ */\n+public class MapleSessionCoordinator {\n+    \n+    private final static MapleSessionCoordinator instance = new MapleSessionCoordinator();\n+    \n+    public static MapleSessionCoordinator getInstance() {\n+        return instance;\n+    }\n+    \n+    public enum AntiMulticlientResult {\n+        SUCCESS,\n+        REMOTE_LOGGEDIN,\n+        REMOTE_REACHED_LIMIT,\n+        REMOTE_PROCESSING,\n+        MANY_ACCOUNT_ATTEMPTS,\n+        COORDINATOR_ERROR\n+    }\n+    \n+    private final LoginStorage loginStorage = new LoginStorage();\n+    private final Set<String> onlineRemoteHosts = new HashSet<>();\n+    private final Map<String, Set<IoSession>> loginRemoteHosts = new HashMap<>();\n+    private final Set<String> pooledRemoteHosts = new HashSet<>();\n+    private final List<ReentrantLock> poolLock = new ArrayList<>(100);\n+    \n+    private MapleSessionCoordinator() {\n+        for(int i = 0; i < 100; i++) {\n+            poolLock.add(MonitoredReentrantLockFactory.createLock(MonitoredLockType.SERVER_LOGIN_COORD));\n+        }\n+    }\n+    \n+    private static long ipExpirationUpdate(int relevance) {\n+        int degree = 1, i = relevance, subdegree;\n+        while ((subdegree = 5 * degree) <= i) {\n+            i -= subdegree;\n+            degree++;\n+        }\n+        \n+        degree--;\n+        int baseTime, subdegreeTime;\n+        if (degree > 2) {\n+            subdegreeTime = 10;\n+        } else {\n+            subdegreeTime = 1 + (3 * degree);\n+        }\n+        \n+        switch(degree) {\n+            case 0:\n+                baseTime = 2;       // 2 hours\n+                break;\n+                \n+            case 1:\n+                baseTime = 24;      // 1 day\n+                break;\n+                \n+            case 2:\n+                baseTime = 168;     // 7 days\n+                break;\n+                \n+            default:\n+                baseTime = 1680;    // 70 days\n+        }\n+        \n+        return 3600000 * (baseTime + subdegreeTime);\n+    }\n+    \n+    private static void updateAccessAccount(Connection con, String remoteHost, int accountId, int loginRelevance) throws SQLException {\n+        java.sql.Timestamp nextTimestamp = new java.sql.Timestamp(Server.getInstance().getCurrentTime() + ipExpirationUpdate(loginRelevance));\n+        if(loginRelevance < Byte.MAX_VALUE) {\n+            loginRelevance++;\n+        }\n+        \n+        try (PreparedStatement ps = con.prepareStatement(\"UPDATE ipaccounts SET relevance = ?, expiresat = ? WHERE accountid = ? AND ip LIKE ?\")) {\n+            ps.setInt(1, loginRelevance);\n+            ps.setTimestamp(2, nextTimestamp);\n+            ps.setInt(3, accountId);\n+            ps.setString(4, remoteHost);\n+            \n+            ps.executeUpdate();\n+        }\n+    }\n+    \n+    private static void registerAccessAccount(Connection con, String remoteHost, int accountId) throws SQLException {\n+        try (PreparedStatement ps = con.prepareStatement(\"INSERT INTO ipaccounts (accountid, ip, expiresat) VALUES (?, ?, ?)\")) {\n+            ps.setInt(1, accountId);\n+            ps.setString(2, remoteHost);\n+            ps.setTimestamp(3, new java.sql.Timestamp(Server.getInstance().getCurrentTime() + ipExpirationUpdate(0)));\n+            \n+            ps.executeUpdate();\n+        }\n+    }\n+    \n+    private static boolean attemptAccessAccount(String remoteHost, int accountId, boolean routineCheck) {\n+        try {\n+            Connection con = DatabaseConnection.getConnection();\n+            int ipCount = 0;\n+            \n+            try (PreparedStatement ps = con.prepareStatement(\"SELECT SQL_CACHE * FROM ipaccounts WHERE accountid = ?\")) {\n+                ps.setInt(1, accountId);\n+                try (ResultSet rs = ps.executeQuery()) {\n+                    while (rs.next()) {\n+                        if (remoteHost.contentEquals(rs.getString(\"ip\"))) {\n+                            if (!routineCheck) {\n+                                int loginRelevance = rs.getInt(\"relevance\");\n+                                updateAccessAccount(con, remoteHost, accountId, loginRelevance);\n+                            }\n+                            \n+                            return true;\n+                        }\n+                        \n+                        ipCount++;\n+                    }\n+                }\n+                \n+                if (ipCount < ServerConstants.MAX_ALLOWED_ACCOUNT_IP) {\n+                    if (!routineCheck) {\n+                        registerAccessAccount(con, remoteHost, accountId);\n+                    }\n+                    \n+                    return true;\n+                }\n+            } finally {\n+                con.close();\n+            }\n+        } catch (SQLException ex) {\n+            ex.printStackTrace();\n+        }\n+        \n+        return false;\n+    }\n+    \n+    private Lock getCoodinatorLock(String remoteHost) {\n+        return poolLock.get(remoteHost.hashCode() % 100);\n+    }\n+    \n+    private static String getRemoteIp(IoSession session) {\n+        return ((InetSocketAddress) session.getRemoteAddress()).getAddress().getHostAddress();\n+    }\n+    \n+    public boolean canStartLoginSession(IoSession session) {\n+        if (!ServerConstants.DETERRED_MULTICLIENT) return true;\n+        \n+        String remoteHost = getRemoteIp(session);\n+        Lock lock = getCoodinatorLock(remoteHost);\n+        \n+        try {\n+            int tries = 0;\n+            while (true) {\n+                if (lock.tryLock()) {\n+                    try {\n+                        if (pooledRemoteHosts.contains(remoteHost)) {\n+                            return false;\n+                        }\n+                        \n+                        pooledRemoteHosts.add(remoteHost);\n+                    } finally {\n+                        lock.unlock();\n+                    }\n+                    \n+                    break;\n+                } else {\n+                    if(tries == 2) {\n+                        return true;\n+                    }\n+                    tries++;\n+                    \n+                    Thread.sleep(1777);\n+                }\n+            }\n+        } catch (Exception e) {\n+            e.printStackTrace();\n+            return true;\n+        }\n+        \n+        try {\n+            if (onlineRemoteHosts.contains(remoteHost) || loginRemoteHosts.containsKey(remoteHost)) {\n+                return false;\n+            }\n+            \n+            Set<IoSession> lrh = new HashSet<>(2);\n+            lrh.add(session);\n+            loginRemoteHosts.put(remoteHost, lrh);\n+            \n+            return true;\n+        } finally {\n+            lock.lock();\n+            try {\n+                pooledRemoteHosts.remove(remoteHost);\n+            } finally {\n+                lock.unlock();\n+            }\n+        }\n+    }\n+    \n+    public void closeLoginSession(IoSession session) {\n+        String remoteIp = getRemoteIp(session);\n+        Set<IoSession> lrh = loginRemoteHosts.get(remoteIp);\n+        if (lrh != null) {\n+            lrh.remove(session);\n+            if (lrh.isEmpty()) {\n+                loginRemoteHosts.remove(remoteIp);\n+            }\n+        }\n+    }\n+    \n+    public AntiMulticlientResult attemptSessionLogin(IoSession session, int accountId, boolean routineCheck) {\n+        if (!ServerConstants.DETERRED_MULTICLIENT) return AntiMulticlientResult.SUCCESS;\n+        \n+        String remoteHost = getRemoteIp(session);\n+        Lock lock = getCoodinatorLock(remoteHost);\n+        \n+        try {\n+            int tries = 0;\n+            while (true) {\n+                if (lock.tryLock()) {\n+                    try {\n+                        if (pooledRemoteHosts.contains(remoteHost)) {\n+                            return AntiMulticlientResult.REMOTE_PROCESSING;\n+                        }\n+                        \n+                        pooledRemoteHosts.add(remoteHost);\n+                    } finally {\n+                        lock.unlock();\n+                    }\n+                    \n+                    break;\n+                } else {\n+                    if(tries == 2) {\n+                        return AntiMulticlientResult.COORDINATOR_ERROR;\n+                    }\n+                    tries++;\n+                    \n+                    Thread.sleep(1777);\n+                }\n+            }\n+        } catch (Exception e) {\n+            e.printStackTrace();\n+            return AntiMulticlientResult.COORDINATOR_ERROR;\n+        }\n+        \n+        try {\n+            if (!loginStorage.registerLogin(accountId)) {\n+                return AntiMulticlientResult.MANY_ACCOUNT_ATTEMPTS;\n+            }\n+            \n+            if (!routineCheck) {\n+                if (onlineRemoteHosts.contains(remoteHost)) {\n+                    return AntiMulticlientResult.REMOTE_LOGGEDIN;\n+                }\n+\n+                if (!attemptAccessAccount(remoteHost, accountId, routineCheck)) {\n+                    return AntiMulticlientResult.REMOTE_REACHED_LIMIT;\n+                }\n+                \n+                onlineRemoteHosts.add(remoteHost);\n+            } else {\n+                if (!attemptAccessAccount(remoteHost, accountId, routineCheck)) {\n+                    return AntiMulticlientResult.REMOTE_REACHED_LIMIT;\n+                }\n+            }\n+            \n+            return AntiMulticlientResult.SUCCESS;\n+        } finally {\n+            lock.lock();\n+            try {\n+                pooledRemoteHosts.remove(remoteHost);\n+            } finally {\n+                lock.unlock();\n+            }\n+        }\n+    }\n+    \n+    public void closeSession(IoSession session, Boolean immediately) {\n+        onlineRemoteHosts.remove(getRemoteIp(session));\n+        if (immediately != null) session.close(immediately);\n+    }\n+    \n+    public void runUpdateIpHistory() {\n+        try {\n+            Connection con = DatabaseConnection.getConnection();\n+            try (PreparedStatement ps = con.prepareStatement(\"DELETE FROM ipaccounts WHERE expiresat < CURRENT_TIMESTAMP\")) {\n+                ps.execute();\n+            } finally {\n+                con.close();\n+            }\n+        } catch (SQLException ex) {\n+            ex.printStackTrace();\n+        }\n+    }\n+    \n+    public void runUpdateLoginHistory() {\n+        loginStorage.updateLoginHistory();\n+    }\n+}"}, {"sha": "925d9aeca21916b1b62ebf626b9d3f3b1de05d49", "filename": "src/net/server/handlers/login/AfterLoginHandler.java", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/net/server/handlers/login/AfterLoginHandler.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/net/server/handlers/login/AfterLoginHandler.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/handlers/login/AfterLoginHandler.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -23,6 +23,7 @@\n \n import client.MapleClient;\n import net.AbstractMaplePacketHandler;\n+import net.server.coordinator.MapleSessionCoordinator;\n import tools.MaplePacketCreator;\n import tools.data.input.SeekableLittleEndianAccessor;\n \n@@ -56,6 +57,7 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n                 c.announce(MaplePacketCreator.requestPinAfterFailure());\n             }\n         } else if (c2 == 0 && c3 == 5) {\n+            MapleSessionCoordinator.getInstance().closeSession(c.getSession(), null);\n             c.updateLoginState(MapleClient.LOGIN_NOTLOGGEDIN);\n         }\n     }"}, {"sha": "4d325996bc9e7c943a95dc63248191726a6a3f7f", "filename": "src/net/server/handlers/login/RegisterPinHandler.java", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/net/server/handlers/login/RegisterPinHandler.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/net/server/handlers/login/RegisterPinHandler.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/handlers/login/RegisterPinHandler.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -23,6 +23,7 @@\n \n import client.MapleClient;\n import net.AbstractMaplePacketHandler;\n+import net.server.coordinator.MapleSessionCoordinator;\n import tools.MaplePacketCreator;\n import tools.data.input.SeekableLittleEndianAccessor;\n \n@@ -34,12 +35,15 @@\n     public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c) {\n         byte c2 = slea.readByte();\n         if (c2 == 0) {\n+            MapleSessionCoordinator.getInstance().closeSession(c.getSession(), null);\n             c.updateLoginState(MapleClient.LOGIN_NOTLOGGEDIN);\n         } else {\n             String pin = slea.readMapleAsciiString();\n             if (pin != null) {\n                 c.setPin(pin);\n                 c.announce(MaplePacketCreator.pinRegistered());\n+                \n+                MapleSessionCoordinator.getInstance().closeSession(c.getSession(), null);\n                 c.updateLoginState(MapleClient.LOGIN_NOTLOGGEDIN);\n             }\n         }"}, {"sha": "adaed709ac2952203da2c764e74c4c361827eb53", "filename": "src/net/server/handlers/login/SetGenderHandler.java", "status": "modified", "additions": 12, "deletions": 7, "changes": 19, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/net/server/handlers/login/SetGenderHandler.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/net/server/handlers/login/SetGenderHandler.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/handlers/login/SetGenderHandler.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -25,6 +25,7 @@\n import client.MapleClient;\n import net.AbstractMaplePacketHandler;\n import net.server.Server;\n+import net.server.coordinator.MapleSessionCoordinator;\n import tools.MaplePacketCreator;\n import tools.data.input.SeekableLittleEndianAccessor;\n \n@@ -35,13 +36,17 @@\n public class SetGenderHandler extends AbstractMaplePacketHandler {\n     @Override\n     public void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c) {\n-        byte type = slea.readByte(); //?\n-        if (type == 0x01 && c.getGender() == 10) { //Packet shouldn't come if Gender isn't 10.\n-            c.setGender(slea.readByte());\n-            c.announce(MaplePacketCreator.getAuthSuccess(c));\n-            final MapleClient client = c;\n-            \n-            Server.getInstance().registerLoginState(c);\n+        if (c.getGender() == 10) { //Packet shouldn't come if Gender isn't 10.\n+            byte confirmed = slea.readByte();\n+            if (confirmed == 0x01) {\n+                c.setGender(slea.readByte());\n+                c.announce(MaplePacketCreator.getAuthSuccess(c));\n+\n+                Server.getInstance().registerLoginState(c);\n+            } else {\n+                MapleSessionCoordinator.getInstance().closeSession(c.getSession(), null);\n+                c.updateLoginState(MapleClient.LOGIN_NOTLOGGEDIN);\n+            }\n         }\n     }\n "}, {"sha": "91bc2d9a17da31e3ef79e2ac8817fe1e6611405b", "filename": "src/net/server/worker/LoginCoordinatorWorker.java", "status": "added", "additions": 34, "deletions": 0, "changes": 34, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/net/server/worker/LoginCoordinatorWorker.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/net/server/worker/LoginCoordinatorWorker.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/worker/LoginCoordinatorWorker.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,34 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+package net.server.worker;\n+\n+import net.server.coordinator.MapleSessionCoordinator;\n+\n+/**\n+ *\n+ * @author Ronan\n+ */\n+public class LoginCoordinatorWorker implements Runnable {\n+    \n+    @Override\n+    public void run() {\n+        MapleSessionCoordinator.getInstance().runUpdateIpHistory();\n+    }\n+}"}, {"sha": "2942135aa3f2dd31d97843850aa9a8b435cb6bda", "filename": "src/net/server/worker/LoginStorageWorker.java", "status": "added", "additions": 34, "deletions": 0, "changes": 34, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/net/server/worker/LoginStorageWorker.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/net/server/worker/LoginStorageWorker.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/worker/LoginStorageWorker.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,34 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+package net.server.worker;\n+\n+import net.server.coordinator.MapleSessionCoordinator;\n+\n+/**\n+ *\n+ * @author Ronan\n+ */\n+public class LoginStorageWorker implements Runnable {\n+    \n+    @Override\n+    public void run() {\n+        MapleSessionCoordinator.getInstance().runUpdateLoginHistory();\n+    }\n+}"}, {"sha": "de0077021a79cbaf3705959a003103544785493b", "filename": "src/net/server/worker/RankingCommandWorker.java", "status": "added", "additions": 34, "deletions": 0, "changes": 34, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/net/server/worker/RankingCommandWorker.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/net/server/worker/RankingCommandWorker.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/worker/RankingCommandWorker.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,34 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+package net.server.worker;\n+\n+import net.server.Server;\n+\n+/**\n+ *\n+ * @author Ronan\n+ */\n+public class RankingCommandWorker implements Runnable {\n+    \n+    @Override\n+    public void run() {\n+        Server.getInstance().updateWorldPlayerRanking();\n+    }\n+}"}, {"sha": "4df7d05af2566eb5894c817939c850ca092c9bd3", "filename": "src/net/server/worker/RankingLoginWorker.java", "status": "renamed", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/net/server/worker/RankingLoginWorker.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/net/server/worker/RankingLoginWorker.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/worker/RankingLoginWorker.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -35,7 +35,7 @@\n  * @author Quit\n  * @author Ronan\n  */\n-public class RankingWorker implements Runnable {\n+public class RankingLoginWorker implements Runnable {\n     private Connection con;\n     private long lastUpdate = System.currentTimeMillis();\n     ", "previous_filename": "src/net/server/worker/RankingWorker.java"}, {"sha": "69babeb30e81a153320d96635209930f6e3e0294", "filename": "src/net/server/world/World.java", "status": "modified", "additions": 17, "deletions": 3, "changes": 20, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/net/server/world/World.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/net/server/world/World.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/world/World.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -92,7 +92,7 @@\n  */\n public class World {\n \n-    private int id, flag, exprate, droprate, mesorate, questrate;\n+    private int id, flag, exprate, droprate, mesorate, questrate, travelrate;\n     private String eventmsg;\n     private List<Channel> channels = new ArrayList<>();\n     private Map<Integer, Byte> pnpcStep = new HashMap<>();\n@@ -151,14 +151,15 @@\n     private ScheduledFuture<?> charactersSchedule;\n     private ScheduledFuture<?> marriagesSchedule;\n     \n-    public World(int world, int flag, String eventmsg, int exprate, int droprate, int mesorate, int questrate) {\n+    public World(int world, int flag, String eventmsg, int exprate, int droprate, int mesorate, int questrate, int travelrate) {\n         this.id = world;\n         this.flag = flag;\n         this.eventmsg = eventmsg;\n         this.exprate = exprate;\n         this.droprate = droprate;\n         this.mesorate = mesorate;\n         this.questrate = questrate;\n+        this.travelrate = travelrate;\n         runningPartyId.set(1);\n         runningMessengerId.set(1);\n         \n@@ -336,7 +337,19 @@ public int getQuestRate() {\n     public void setQuestRate(int quest) {\n         this.questrate = quest;\n     }\n-\n+    \n+    public int getTravelRate() {\n+        return travelrate;\n+    }\n+    \n+    public void setTravelRate(int quest) {\n+        this.travelrate = quest;\n+    }\n+    \n+    public int getTransportationTime(int travelTime) {\n+        return (int) Math.ceil(travelTime / travelrate);\n+    }\n+    \n     public void loadAccountCharactersView(Integer accountId, List<MapleCharacter> chars) {\n         SortedMap<Integer, MapleCharacter> charsMap = new TreeMap<>();\n         for(MapleCharacter chr : chars) {\n@@ -1825,5 +1838,6 @@ public final void shutdown() {\n         players = null;\n         \n         clearWorldData();\n+        System.out.println(\"Finished shutting down world \" + id + \"\\r\\n\");\n     }\n }"}, {"sha": "13606f3e07b778f9b62ff513b4e02cf556389909", "filename": "src/provider/wz/XMLDomMapleData.java", "status": "modified", "additions": 74, "deletions": 85, "changes": 159, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/provider/wz/XMLDomMapleData.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/provider/wz/XMLDomMapleData.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/provider/wz/XMLDomMapleData.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -65,30 +65,28 @@ private XMLDomMapleData(Node node) {\n \t}\n \n \t@Override\n-\tpublic MapleData getChildByPath(String path) {\n+\tpublic synchronized MapleData getChildByPath(String path) {  // the whole XML reading system seems susceptible to give nulls on strenuous read scenarios\n \t\tString segments[] = path.split(\"/\");\n \t\tif (segments[0].equals(\"..\")) {\n \t\t\treturn ((MapleData) getParent()).getChildByPath(path.substring(path.indexOf(\"/\") + 1));\n \t\t}\n \n                 Node myNode;\n-                synchronized (this) {   // the whole XML reading system seems susceptible to give nulls on strenuous read scenarios\n-                        myNode = node;\n-                        for (int x = 0; x < segments.length; x++) {\n-                                NodeList childNodes = myNode.getChildNodes();\n-                                boolean foundChild = false;\n-                                for (int i = 0; i < childNodes.getLength(); i++) {\n-                                        Node childNode = childNodes.item(i);\n-                                        if (childNode.getNodeType() == Node.ELEMENT_NODE && childNode.getAttributes().getNamedItem(\"name\").getNodeValue().equals(segments[x])) {\n-                                                myNode = childNode;\n-                                                foundChild = true;\n-                                                break;\n-                                        }\n-                                }\n-                                if (!foundChild) {\n-                                        return null;\n+                myNode = node;\n+                for (String s : segments) {\n+                        NodeList childNodes = myNode.getChildNodes();\n+                        boolean foundChild = false;\n+                        for (int i = 0; i < childNodes.getLength(); i++) {\n+                                Node childNode = childNodes.item(i);\n+                                if (childNode.getNodeType() == Node.ELEMENT_NODE && childNode.getAttributes().getNamedItem(\"name\").getNodeValue().equals(s)) {\n+                                        myNode = childNode;\n+                                        foundChild = true;\n+                                        break;\n                                 }\n                         }\n+                        if (!foundChild) {\n+                                return null;\n+                        }\n                 }\n                 \n \t\tXMLDomMapleData ret = new XMLDomMapleData(myNode);\n@@ -97,77 +95,72 @@ public MapleData getChildByPath(String path) {\n \t}\n \n \t@Override\n-\tpublic List<MapleData> getChildren() {\n+\tpublic synchronized List<MapleData> getChildren() {\n \t\tList<MapleData> ret = new ArrayList<>();\n-                synchronized (this) {\n-                        NodeList childNodes = node.getChildNodes();\n-                        for (int i = 0; i < childNodes.getLength(); i++) {\n-                                Node childNode = childNodes.item(i);\n-                                if (childNode.getNodeType() == Node.ELEMENT_NODE) {\n-                                        XMLDomMapleData child = new XMLDomMapleData(childNode);\n-                                        child.imageDataDir = new File(imageDataDir, getName());\n-                                        ret.add(child);\n-                                }\n+                \n+                NodeList childNodes = node.getChildNodes();\n+                for (int i = 0; i < childNodes.getLength(); i++) {\n+                        Node childNode = childNodes.item(i);\n+                        if (childNode.getNodeType() == Node.ELEMENT_NODE) {\n+                                XMLDomMapleData child = new XMLDomMapleData(childNode);\n+                                child.imageDataDir = new File(imageDataDir, getName());\n+                                ret.add(child);\n                         }\n                 }\n+                \n \t\treturn ret;\n \t}\n \n \t@Override\n-\tpublic Object getData() {\n-                synchronized (this) {\n-                        NamedNodeMap attributes = node.getAttributes();\n-                        MapleDataType type = getType();\n-                        switch (type) {\n-                                case DOUBLE:\n-                                case FLOAT:\n-                                case INT:\n-                                case SHORT: {\n-                                        String value = attributes.getNamedItem(\"value\").getNodeValue();\n-                                        Number nval = GameConstants.parseNumber(value);\n-\n-                                        switch (type) {\n-                                                case DOUBLE:\n-                                                        return nval.doubleValue();\n-                                                case FLOAT:\n-                                                        return nval.floatValue();\n-                                                case INT:\n-                                                        return nval.intValue();\n-                                                case SHORT:\n-                                                        return nval.shortValue();\n-                                                default:\n-                                                        return null;\n-                                        }\n-                                }\n-                                case STRING:\n-                                case UOL: {\n-                                        String value = attributes.getNamedItem(\"value\").getNodeValue();\n-                                        return value;\n+\tpublic synchronized Object getData() {\n+                NamedNodeMap attributes = node.getAttributes();\n+                MapleDataType type = getType();\n+                switch (type) {\n+                        case DOUBLE:\n+                        case FLOAT:\n+                        case INT:\n+                        case SHORT: {\n+                                String value = attributes.getNamedItem(\"value\").getNodeValue();\n+                                Number nval = GameConstants.parseNumber(value);\n+\n+                                switch (type) {\n+                                        case DOUBLE:\n+                                                return nval.doubleValue();\n+                                        case FLOAT:\n+                                                return nval.floatValue();\n+                                        case INT:\n+                                                return nval.intValue();\n+                                        case SHORT:\n+                                                return nval.shortValue();\n+                                        default:\n+                                                return null;\n                                 }\n-                                case VECTOR: {\n-                                        String x = attributes.getNamedItem(\"x\").getNodeValue();\n-                                        String y = attributes.getNamedItem(\"y\").getNodeValue();\n-                                        return new Point(Integer.parseInt(x), Integer.parseInt(y));\n-                                }\n-                                case CANVAS: {\n-                                        String width = attributes.getNamedItem(\"width\").getNodeValue();\n-                                        String height = attributes.getNamedItem(\"height\").getNodeValue();\n-                                        return new FileStoredPngMapleCanvas(Integer.parseInt(width), Integer.parseInt(height), new File(\n-                                                        imageDataDir, getName() + \".png\"));\n-                                }\n-                                default:\n-                                        return null;\n                         }\n+                        case STRING:\n+                        case UOL: {\n+                                String value = attributes.getNamedItem(\"value\").getNodeValue();\n+                                return value;\n+                        }\n+                        case VECTOR: {\n+                                String x = attributes.getNamedItem(\"x\").getNodeValue();\n+                                String y = attributes.getNamedItem(\"y\").getNodeValue();\n+                                return new Point(Integer.parseInt(x), Integer.parseInt(y));\n+                        }\n+                        case CANVAS: {\n+                                String width = attributes.getNamedItem(\"width\").getNodeValue();\n+                                String height = attributes.getNamedItem(\"height\").getNodeValue();\n+                                return new FileStoredPngMapleCanvas(Integer.parseInt(width), Integer.parseInt(height), new File(\n+                                                imageDataDir, getName() + \".png\"));\n+                        }\n+                        default:\n+                                return null;\n                 }\n \t}\n \n \t@Override\n-\tpublic MapleDataType getType() {\n-                String nodeName;\n-                synchronized(this) {\n-                        nodeName = node.getNodeName();\n-                }\n-\t\t\n+\tpublic synchronized MapleDataType getType() {\n+                String nodeName = node.getNodeName();\n+                \n                 switch (nodeName) {\n                     case \"imgdir\":\n                         return MapleDataType.PROPERTY;\n@@ -198,28 +191,24 @@ public MapleDataType getType() {\n \t}\n \n \t@Override\n-\tpublic MapleDataEntity getParent() {\n+\tpublic synchronized MapleDataEntity getParent() {\n                 Node parentNode;\n-                synchronized(this) {\n-                        parentNode = node.getParentNode();\n-                        if (parentNode.getNodeType() == Node.DOCUMENT_NODE) {\n-                                return null;\n-                        }\n+                parentNode = node.getParentNode();\n+                if (parentNode.getNodeType() == Node.DOCUMENT_NODE) {\n+                        return null;\n                 }\n \t\tXMLDomMapleData parentData = new XMLDomMapleData(parentNode);\n \t\tparentData.imageDataDir = imageDataDir.getParentFile();\n \t\treturn parentData;\n \t}\n \n \t@Override\n-\tpublic String getName() {\n-                synchronized (this) {\n-                        return node.getAttributes().getNamedItem(\"name\").getNodeValue();\n-                }\n+\tpublic synchronized String getName() {\n+                return node.getAttributes().getNamedItem(\"name\").getNodeValue();\n \t}\n \n \t@Override\n-\tpublic Iterator<MapleData> iterator() {\n+\tpublic synchronized Iterator<MapleData> iterator() {\n \t\treturn getChildren().iterator();\n \t}\n }"}, {"sha": "60beebe1f3765c0ff74fa5100e7685c3d4311d40", "filename": "src/scripting/event/EventManager.java", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/scripting/event/EventManager.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/scripting/event/EventManager.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/scripting/event/EventManager.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -781,8 +781,8 @@ public void completeQuest(MapleCharacter chr, int id, int npcid) {\n         }\n     }\n     \n-    public static int getTransportationTime(int travelTime) {\n-        return (int) Math.ceil(travelTime / ServerConstants.TRAVEL_RATE);\n+    public int getTransportationTime(int travelTime) {\n+        return this.getWorldServer().getTransportationTime(travelTime);\n     }\n     \n     private void fillEimQueue() {"}, {"sha": "cacf4cafcc66b23be8b19005812d3ade3af8341d", "filename": "src/scripting/item/ItemScriptManager.java", "status": "modified", "additions": 6, "deletions": 5, "changes": 11, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/scripting/item/ItemScriptManager.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/scripting/item/ItemScriptManager.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/scripting/item/ItemScriptManager.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -41,18 +41,19 @@\n public class ItemScriptManager {\n \n     private static ItemScriptManager instance = new ItemScriptManager();\n+    \n+    public static ItemScriptManager getInstance() {\n+        return instance;\n+    }\n+    \n     private Map<String, Invocable> scripts = new HashMap<>();\n     private ScriptEngineFactory sef;\n \n     private ItemScriptManager() {\n         ScriptEngineManager sem = new ScriptEngineManager();\n         sef = sem.getEngineByName(\"javascript\").getFactory();\n     }\n-\n-    public static ItemScriptManager getInstance() {\n-        return instance;\n-    }\n-\n+    \n     public boolean scriptExists(String scriptName) {\n         File scriptFile = new File(\"scripts/item/\" + scriptName + \".js\");\n         return scriptFile.exists();"}, {"sha": "8ffcae777ab7e51b72585598744dffbc835d68b6", "filename": "src/scripting/map/MapScriptManager.java", "status": "modified", "additions": 5, "deletions": 4, "changes": 9, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/scripting/map/MapScriptManager.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/scripting/map/MapScriptManager.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/scripting/map/MapScriptManager.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -40,6 +40,11 @@\n public class MapScriptManager {\n \n     private static MapScriptManager instance = new MapScriptManager();\n+    \n+    public static MapScriptManager getInstance() {\n+        return instance;\n+    }\n+    \n     private Map<String, Invocable> scripts = new HashMap<>();\n     private ScriptEngineFactory sef;\n \n@@ -48,10 +53,6 @@ private MapScriptManager() {\n         sef = sem.getEngineByName(\"javascript\").getFactory();\n     }\n \n-    public static MapScriptManager getInstance() {\n-        return instance;\n-    }\n-\n     public void reloadScripts() {\n         scripts.clear();\n     }"}, {"sha": "2d2b8c22e8fc5acaa9dba837ed6d8a42d225d698", "filename": "src/scripting/npc/NPCScriptManager.java", "status": "modified", "additions": 5, "deletions": 4, "changes": 9, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/scripting/npc/NPCScriptManager.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/scripting/npc/NPCScriptManager.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/scripting/npc/NPCScriptManager.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -41,14 +41,15 @@\n  */\n public class NPCScriptManager extends AbstractScriptManager {\n \n-    private Map<MapleClient, NPCConversationManager> cms = new HashMap<>();\n-    private Map<MapleClient, Invocable> scripts = new HashMap<>();\n     private static NPCScriptManager instance = new NPCScriptManager();\n-\n+    \n     public static NPCScriptManager getInstance() {\n         return instance;\n     }\n-\n+    \n+    private Map<MapleClient, NPCConversationManager> cms = new HashMap<>();\n+    private Map<MapleClient, Invocable> scripts = new HashMap<>();\n+    \n     public boolean start(MapleClient c, int npc, MapleCharacter chr) {\n         return start(c, npc, null, chr);\n     }"}, {"sha": "fb2717034ef9d25b037ca556996cc7568bf99754", "filename": "src/scripting/portal/PortalScriptManager.java", "status": "modified", "additions": 5, "deletions": 4, "changes": 9, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/scripting/portal/PortalScriptManager.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/scripting/portal/PortalScriptManager.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/scripting/portal/PortalScriptManager.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -41,6 +41,11 @@\n public class PortalScriptManager {\n \n     private static PortalScriptManager instance = new PortalScriptManager();\n+    \n+    public static PortalScriptManager getInstance() {\n+        return instance;\n+    }\n+    \n     private Map<String, PortalScript> scripts = new HashMap<>();\n     private ScriptEngineFactory sef;\n \n@@ -49,10 +54,6 @@ private PortalScriptManager() {\n         sef = sem.getEngineByName(\"javascript\").getFactory();\n     }\n \n-    public static PortalScriptManager getInstance() {\n-        return instance;\n-    }\n-\n     private PortalScript getPortalScript(String scriptName) {\n         if (scripts.containsKey(scriptName)) {\n             return scripts.get(scriptName);"}, {"sha": "46450f7ea91a145888942132978b81034a3f3a11", "filename": "src/scripting/quest/QuestScriptManager.java", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/scripting/quest/QuestScriptManager.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/scripting/quest/QuestScriptManager.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/scripting/quest/QuestScriptManager.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -39,13 +39,15 @@\n  * @author RMZero213\n  */\n public class QuestScriptManager extends AbstractScriptManager {\n-\tprivate Map<MapleClient, QuestActionManager> qms = new HashMap<>();\n-\tprivate Map<MapleClient, Invocable> scripts = new HashMap<>();\n-\tprivate static QuestScriptManager instance = new QuestScriptManager();\n+    \n+        private static QuestScriptManager instance = new QuestScriptManager();\n \n \tpublic synchronized static QuestScriptManager getInstance() {\n \t\treturn instance;\n \t}\n+    \n+\tprivate Map<MapleClient, QuestActionManager> qms = new HashMap<>();\n+\tprivate Map<MapleClient, Invocable> scripts = new HashMap<>();\n         \n \tpublic void start(MapleClient c, short questid, int npc) {\n                 MapleQuest quest = MapleQuest.getInstance(questid);"}, {"sha": "d3b7f36cb421aad5beff2b1f642e7dbceb41f232", "filename": "src/scripting/reactor/ReactorScriptManager.java", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/scripting/reactor/ReactorScriptManager.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/scripting/reactor/ReactorScriptManager.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/scripting/reactor/ReactorScriptManager.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -43,12 +43,13 @@\n public class ReactorScriptManager extends AbstractScriptManager {\n \n     private static ReactorScriptManager instance = new ReactorScriptManager();\n-    private Map<Integer, List<ReactorDropEntry>> drops = new HashMap<>();\n-\n+    \n     public synchronized static ReactorScriptManager getInstance() {\n         return instance;\n     }\n     \n+    private Map<Integer, List<ReactorDropEntry>> drops = new HashMap<>();\n+    \n     public void onHit(MapleClient c, MapleReactor reactor) {\n         try {\n             Invocable iv = getInvocable(\"reactor/\" + reactor.getId() + \".js\", c);"}, {"sha": "9ecb721ba639aa712b80d7359860431cc9fe485f", "filename": "src/server/CashShop.java", "status": "modified", "additions": 11, "deletions": 6, "changes": 17, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/server/CashShop.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/server/CashShop.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/CashShop.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -46,6 +46,7 @@\n import client.inventory.MapleInventoryType;\n import client.inventory.MaplePet;\n import constants.ItemConstants;\n+import constants.ServerConstants;\n import java.util.Collections;\n import net.server.audit.locks.MonitoredLockType;\n \n@@ -275,12 +276,16 @@ public CashShop(int accountId, int characterId, int jobType) throws SQLException\n         this.accountId = accountId;\n         this.characterId = characterId;\n \n-        if (jobType == 0) {\n-            factory = ItemFactory.CASH_EXPLORER;\n-        } else if (jobType == 1) {\n-            factory = ItemFactory.CASH_CYGNUS;\n-        } else if (jobType == 2) {\n-            factory = ItemFactory.CASH_ARAN;\n+        if (!ServerConstants.USE_JOINT_CASHSHOP_INVENTORY) {\n+            if (jobType == 0) {\n+                factory = ItemFactory.CASH_EXPLORER;\n+            } else if (jobType == 1) {\n+                factory = ItemFactory.CASH_CYGNUS;\n+            } else if (jobType == 2) {\n+                factory = ItemFactory.CASH_ARAN;\n+            }\n+        } else {\n+            factory = ItemFactory.CASH_OVERALL;\n         }\n \n         Connection con = DatabaseConnection.getConnection();"}, {"sha": "56642c9d8162d306f668d997f94ddc353111c86e", "filename": "src/server/MapleItemInformationProvider.java", "status": "modified", "additions": 18, "deletions": 16, "changes": 34, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/server/MapleItemInformationProvider.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/server/MapleItemInformationProvider.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/MapleItemInformationProvider.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -77,8 +77,12 @@\n  *\n  */\n public class MapleItemInformationProvider {\n-\n-    private static MapleItemInformationProvider instance = null;\n+    private final static MapleItemInformationProvider instance = new MapleItemInformationProvider();\n+    \n+    public static MapleItemInformationProvider getInstance() {\n+        return instance;\n+    }\n+    \n     protected MapleDataProvider itemData;\n     protected MapleDataProvider equipData;\n     protected MapleDataProvider stringData;\n@@ -142,13 +146,6 @@ private MapleItemInformationProvider() {\n         isPartyQuestItemCache.put(0, false);\n     }\n \n-    public static MapleItemInformationProvider getInstance() {\n-        if (instance == null) {\n-            instance = new MapleItemInformationProvider();\n-        }\n-        return instance;\n-    }\n-\n //    public MapleInventoryType getInventoryType(int itemId) {\n //        if (inventoryTypeCache.containsKey(itemId)) {\n //            return inventoryTypeCache.get(itemId);\n@@ -1224,14 +1221,19 @@ public boolean isDropRestricted(int itemId) {\n         if (dropRestrictionCache.containsKey(itemId)) {\n             return dropRestrictionCache.get(itemId);\n         }\n-        MapleData data = getItemData(itemId);\n-        boolean bRestricted = MapleDataTool.getIntConvert(\"info/tradeBlock\", data, 0) == 1;\n-        if (!bRestricted) {\n-        \tbRestricted = MapleDataTool.getIntConvert(\"info/accountSharable\", data, 0) == 1;\n-        }\n-        if (!bRestricted) {\n-            bRestricted = MapleDataTool.getIntConvert(\"info/quest\", data, 0) == 1;\n+        \n+        boolean bRestricted = false;\n+        if(itemId != 0) {\n+            MapleData data = getItemData(itemId);\n+            bRestricted = MapleDataTool.getIntConvert(\"info/tradeBlock\", data, 0) == 1;\n+            if (!bRestricted) {\n+                    bRestricted = MapleDataTool.getIntConvert(\"info/accountSharable\", data, 0) == 1;\n+            }\n+            if (!bRestricted) {\n+                bRestricted = MapleDataTool.getIntConvert(\"info/quest\", data, 0) == 1;\n+            }\n         }\n+        \n         dropRestrictionCache.put(itemId, bRestricted);\n         return bRestricted;\n     }"}, {"sha": "2807e041a26d085c365e800be975ce8aa9d0f5c9", "filename": "src/server/MapleShopFactory.java", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/server/MapleShopFactory.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/server/MapleShopFactory.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/MapleShopFactory.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -29,13 +29,15 @@\n  * @author Matze\n  */\n public class MapleShopFactory {\n-    private Map<Integer, MapleShop> shops = new HashMap<Integer, MapleShop>();\n-    private Map<Integer, MapleShop> npcShops = new HashMap<Integer, MapleShop>();\n+    \n     private static MapleShopFactory instance = new MapleShopFactory();\n-\n+    \n     public static MapleShopFactory getInstance() {\n         return instance;\n     }\n+    \n+    private Map<Integer, MapleShop> shops = new HashMap<Integer, MapleShop>();\n+    private Map<Integer, MapleShop> npcShops = new HashMap<Integer, MapleShop>();\n \n     private MapleShop loadShop(int id, boolean isShopId) {\n         MapleShop ret = MapleShop.createFromDB(id, isShopId);"}, {"sha": "b80aaa388b0301e2531c1aa206d2ecc33d72ac12", "filename": "src/server/TimerManager.java", "status": "modified", "additions": 5, "deletions": 4, "changes": 9, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/server/TimerManager.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/server/TimerManager.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/TimerManager.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -34,6 +34,11 @@\n \n public class TimerManager implements TimerManagerMBean {\n     private static TimerManager instance = new TimerManager();\n+    \n+    public static TimerManager getInstance() {\n+        return instance;\n+    }\n+    \n     private ScheduledThreadPoolExecutor ses;\n \n     private TimerManager() {\n@@ -45,10 +50,6 @@ private TimerManager() {\n         }\n     }\n \n-    public static TimerManager getInstance() {\n-        return instance;\n-    }\n-\n     public void start() {\n         if (ses != null && !ses.isShutdown() && !ses.isTerminated()) {\n             return;"}, {"sha": "3fcdb6c8992cbb036da96c97acc32f0c3b1e2ed8", "filename": "src/server/gachapon/MapleGachapon.java", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/server/gachapon/MapleGachapon.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/server/gachapon/MapleGachapon.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/gachapon/MapleGachapon.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -30,6 +30,10 @@\n public class MapleGachapon {\n \n \tprivate static final MapleGachapon instance = new MapleGachapon();\n+        \n+        public static MapleGachapon getInstance() {\n+\t\treturn instance;\n+\t}\n \t\n \tpublic enum Gachapon {\n \n@@ -89,10 +93,6 @@ public static Gachapon getByNpcId(int npcId) {\n \t\t\treturn null;\n \t\t}\n \t}\n-\n-\tpublic static MapleGachapon getInstance() {\n-\t\treturn instance;\n-\t}\n \t\n \tpublic MapleGachaponItem process(int npcId) {\n \t\tGachapon gacha = Gachapon.getByNpcId(npcId);"}, {"sha": "849c3f6cd5415b140649fdde678ab1394eab7ba5", "filename": "src/server/life/MapleMonster.java", "status": "modified", "additions": 15, "deletions": 10, "changes": 25, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/server/life/MapleMonster.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/server/life/MapleMonster.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/life/MapleMonster.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -505,7 +505,7 @@ private void distributeExperience(int killerId) {\n         }\n         \n         if(!expDist.isEmpty()) {    // locate on world server the partyid of the missing characters\n-            World wserv = Server.getInstance().getWorld(map.getWorld());\n+            World wserv = map.getWorldServer();\n             \n             for (Entry<Integer, Float> ed : expDist.entrySet()) {\n                 boolean isKiller = (ed.getKey() == killerId);\n@@ -1151,16 +1151,21 @@ public void run() {\n     }\n \n     private void debuffMobStat(MonsterStatus stat) {\n-        if (isBuffed(stat)) {\n-            final MonsterStatusEffect oldEffect = stati.get(stat);\n-            byte[] packet = MaplePacketCreator.cancelMonsterStatus(getObjectId(), oldEffect.getStati());\n-            map.broadcastMessage(packet, getPosition());\n-\n-            MapleCharacter chrController = getController();\n-            if (chrController != null && !chrController.isMapObjectVisible(MapleMonster.this)) {\n-                chrController.getClient().announce(packet);\n+        statiLock.lock();\n+        try {\n+            if (isBuffed(stat)) {\n+                final MonsterStatusEffect oldEffect = stati.get(stat);\n+                byte[] packet = MaplePacketCreator.cancelMonsterStatus(getObjectId(), oldEffect.getStati());\n+                map.broadcastMessage(packet, getPosition());\n+\n+                MapleCharacter chrController = getController();\n+                if (chrController != null && !chrController.isMapObjectVisible(MapleMonster.this)) {\n+                    chrController.getClient().announce(packet);\n+                }\n+                stati.remove(stat);\n             }\n-            stati.remove(stat);\n+        } finally {\n+            statiLock.unlock();\n         }\n     }\n     "}, {"sha": "69ae214833284f87a81ae6278b63f9426c5f4d3b", "filename": "src/server/life/MapleMonsterInformationProvider.java", "status": "modified", "additions": 5, "deletions": 4, "changes": 9, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/server/life/MapleMonsterInformationProvider.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/server/life/MapleMonsterInformationProvider.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/life/MapleMonsterInformationProvider.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -47,6 +47,11 @@\n \t// Author : LightPepsi\n \n \tprivate static final MapleMonsterInformationProvider instance = new MapleMonsterInformationProvider();\n+        \n+        public static MapleMonsterInformationProvider getInstance() {\n+\t\treturn instance;\n+\t}\n+        \n         private final Map<Integer, List<MonsterDropEntry>> drops = new HashMap<>();        \n \tprivate final List<MonsterGlobalDropEntry> globaldrops = new ArrayList<>();\n         \n@@ -61,10 +66,6 @@ protected MapleMonsterInformationProvider() {\n \t\tretrieveGlobal();\n \t}\n \n-\tpublic static MapleMonsterInformationProvider getInstance() {\n-\t\treturn instance;\n-\t}\n-\n \tpublic final List<MonsterGlobalDropEntry> getGlobalDrop() {\n \t\treturn globaldrops;\n \t}"}, {"sha": "c97e8f7807abd5b2905a917adc7f90e5ca1822f4", "filename": "src/server/life/positioner/MaplePlayerNPCPodium.java", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/server/life/positioner/MaplePlayerNPCPodium.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/server/life/positioner/MaplePlayerNPCPodium.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/life/positioner/MaplePlayerNPCPodium.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -138,16 +138,16 @@ private static Point getNextPlayerNpcPosition(MapleMap map, int podiumData) {\n             if(podiumStep >= ServerConstants.PLAYERNPC_AREA_STEPS) return null;\n             \n             List<MapleMapObject> mmoList = map.getMapObjectsInRange(new Point(0, 0), Double.POSITIVE_INFINITY, Arrays.asList(MapleMapObjectType.PLAYER_NPC));\n-            Server.getInstance().getWorld(map.getWorld()).setPlayerNpcMapPodiumData(map.getId(), encodePodiumData(podiumStep + 1, podiumCount + 1));\n+            map.getWorldServer().setPlayerNpcMapPodiumData(map.getId(), encodePodiumData(podiumStep + 1, podiumCount + 1));\n             return reorganizePlayerNpcs(map, podiumStep + 1, mmoList);\n         } else {\n-            Server.getInstance().getWorld(map.getWorld()).setPlayerNpcMapPodiumData(map.getId(), encodePodiumData(podiumStep, podiumCount + 1));\n+            map.getWorldServer().setPlayerNpcMapPodiumData(map.getId(), encodePodiumData(podiumStep, podiumCount + 1));\n             return calcNextPos(podiumCount, podiumStep);\n         }\n     }\n     \n     public static Point getNextPlayerNpcPosition(MapleMap map) {\n-        Point pos = getNextPlayerNpcPosition(map, Server.getInstance().getWorld(map.getWorld()).getPlayerNpcMapPodiumData(map.getId()));\n+        Point pos = getNextPlayerNpcPosition(map, map.getWorldServer().getPlayerNpcMapPodiumData(map.getId()));\n         if(pos == null) return null;\n         \n         return map.getGroundBelow(pos);"}, {"sha": "58e6054ab731aba76bbeed01416d6f812e2e0e34", "filename": "src/server/life/positioner/MaplePlayerNPCPositioner.java", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/server/life/positioner/MaplePlayerNPCPositioner.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/server/life/positioner/MaplePlayerNPCPositioner.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/life/positioner/MaplePlayerNPCPositioner.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -204,7 +204,7 @@ private static Point getNextPlayerNpcPosition(MapleMap map, int initStep) {   //\n                     if(searchPos != null) {\n                         if(!isPlayerNpcNearby(otherPlayerNpcs, searchPos, cx, cy)) {\n                             if(i > initStep) {\n-                                Server.getInstance().getWorld(map.getWorld()).setPlayerNpcMapStep(map.getId(), i);\n+                                map.getWorldServer().setPlayerNpcMapStep(map.getId(), i);\n                             }\n \n                             if(reorganize && ServerConstants.PLAYERNPC_ORGANIZE_AREA) {\n@@ -232,12 +232,12 @@ private static Point getNextPlayerNpcPosition(MapleMap map, int initStep) {   //\n         }\n         \n         if(i > initStep) {\n-            Server.getInstance().getWorld(map.getWorld()).setPlayerNpcMapStep(map.getId(), ServerConstants.PLAYERNPC_AREA_STEPS - 1);\n+            map.getWorldServer().setPlayerNpcMapStep(map.getId(), ServerConstants.PLAYERNPC_AREA_STEPS - 1);\n         }\n         return null;\n     }\n     \n     public static Point getNextPlayerNpcPosition(MapleMap map) {\n-        return getNextPlayerNpcPosition(map, Server.getInstance().getWorld(map.getWorld()).getPlayerNpcMapStep(map.getId()));\n+        return getNextPlayerNpcPosition(map, map.getWorldServer().getPlayerNpcMapStep(map.getId()));\n     }\n }"}, {"sha": "857e18ff70be920a10cf0e3f2d2407bc87b2318b", "filename": "src/server/loot/MapleLootInventory.java", "status": "added", "additions": 56, "deletions": 0, "changes": 56, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/server/loot/MapleLootInventory.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/server/loot/MapleLootInventory.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/loot/MapleLootInventory.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,56 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+package server.loot;\n+\n+import client.MapleCharacter;\n+import java.util.HashMap;\n+import java.util.Map;\n+import client.inventory.Item;\n+import client.inventory.MapleInventoryType;\n+\n+\n+/**\n+ *\n+ * @author Ronan\n+ */\n+public class MapleLootInventory {\n+    Map<Integer, Integer> items = new HashMap<>(50);\n+    \n+    public MapleLootInventory(MapleCharacter from) {\n+        for (MapleInventoryType values : MapleInventoryType.values()) {\n+            \n+            for(Item it : from.getInventory(values).list()) {\n+                Integer itemQty = items.get(it.getItemId());\n+                \n+                if(itemQty == null) {\n+                    items.put(it.getItemId(), (int) it.getQuantity());\n+                } else {\n+                    items.put(it.getItemId(), itemQty + it.getQuantity());\n+                }\n+            }\n+        }\n+    }\n+    \n+    public boolean hasItem(int itemid, int quantity) {\n+        Integer itemQty = items.get(itemid);\n+        return itemQty != null && itemQty >= quantity;\n+    }\n+    \n+}"}, {"sha": "0c39bffb5672bb99afc1fb2b74c285229d7530ad", "filename": "src/server/loot/MapleLootManager.java", "status": "added", "additions": 81, "deletions": 0, "changes": 81, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/server/loot/MapleLootManager.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/server/loot/MapleLootManager.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/loot/MapleLootManager.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -0,0 +1,81 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+package server.loot;\n+\n+import client.MapleCharacter;\n+import java.util.LinkedList;\n+import java.util.List;\n+\n+import server.MapleItemInformationProvider;\n+import server.life.MapleMonsterInformationProvider;\n+import server.life.MonsterDropEntry;\n+import server.quest.MapleQuest;\n+\n+/**\n+ *\n+ * @author Ronan\n+ */\n+public class MapleLootManager {\n+    \n+    private static boolean needQuestItem(MonsterDropEntry dropEntry, MapleQuest quest, MapleCharacter chr, MapleLootInventory chrInv) {\n+        if (chr.getQuestStatus(dropEntry.questid) != 1) return false;\n+        return !chrInv.hasItem(dropEntry.itemId, quest.getItemAmountNeeded(dropEntry.itemId));\n+    }\n+    \n+    private static boolean isRelevantDrop(MonsterDropEntry dropEntry, List<MapleCharacter> partyMembers, List<MapleLootInventory> partyInv) {\n+        MapleQuest quest = MapleQuest.getInstance(dropEntry.questid);\n+        boolean restricted = MapleItemInformationProvider.getInstance().isDropRestricted(dropEntry.itemId);\n+        \n+        for (int i = 0; i < partyMembers.size(); i++) {\n+            MapleLootInventory chrInv = partyInv.get(i);\n+            \n+            if(restricted && chrInv.hasItem(dropEntry.itemId, 1)) {\n+                continue;\n+            }\n+            \n+            if(dropEntry.questid <= 0 || needQuestItem(dropEntry, quest, partyMembers.get(i), chrInv)) {\n+                return true;\n+            }\n+        }\n+        \n+        return false;\n+    }\n+    \n+    public static List<MonsterDropEntry> retrieveRelevantDrops(int monsterId, List<MapleCharacter> partyMembers) {\n+        List<MonsterDropEntry> loots = MapleMonsterInformationProvider.getInstance().retrieveEffectiveDrop(monsterId);\n+        if(loots.isEmpty()) return loots;\n+        \n+        List<MapleLootInventory> partyInv = new LinkedList<>();\n+        for(MapleCharacter chr : partyMembers) {\n+            MapleLootInventory lootInv = new MapleLootInventory(chr);\n+            partyInv.add(lootInv);\n+        }\n+        \n+        List<MonsterDropEntry> effectiveLoot = new LinkedList<>();\n+        for(MonsterDropEntry mde : loots) {\n+            if(isRelevantDrop(mde, partyMembers, partyInv)) {\n+                effectiveLoot.add(mde);\n+            }\n+        }\n+        \n+        return effectiveLoot;\n+    }\n+    \n+}"}, {"sha": "14f55e3580c9bdea3f1511a4a4e6f3bae4998a64", "filename": "src/server/maps/MapleMap.java", "status": "modified", "additions": 20, "deletions": 20, "changes": 40, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/server/maps/MapleMap.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/server/maps/MapleMap.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/maps/MapleMap.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -63,6 +63,7 @@\n import java.lang.ref.WeakReference;\n import net.server.Server;\n import net.server.channel.Channel;\n+import net.server.world.World;\n import scripting.map.MapScriptManager;\n import server.MapleItemInformationProvider;\n import server.MaplePortal;\n@@ -84,7 +85,6 @@\n import server.partyquest.MonsterCarnival;\n import server.partyquest.MonsterCarnivalParty;\n //import server.partyquest.Pyramid;\n-import scripting.event.EventManager;\n import scripting.event.EventInstanceManager;\n import server.life.MaplePlayerNPC;\n import server.life.MonsterListener;\n@@ -262,6 +262,10 @@ public int getId() {\n     public Channel getChannelServer() {\n         return Server.getInstance().getWorld(world).getChannel(channel);\n     }\n+    \n+    public World getWorldServer() {\n+        return Server.getInstance().getWorld(world);\n+    }\n \n     public MapleMap getReturnMap() {\n         if(returnMapId == 999999999) return this;\n@@ -697,7 +701,7 @@ private void dropFromMonster(final MapleCharacter chr, final MapleMonster mob, f\n         final List<MonsterDropEntry>  dropEntry = new ArrayList<>();\n         final List<MonsterDropEntry> visibleQuestEntry = new ArrayList<>();\n         final List<MonsterDropEntry> otherQuestEntry = new ArrayList<>();\n-        sortDropEntries(mi.retrieveEffectiveDrop(mob.getId()), dropEntry, visibleQuestEntry, otherQuestEntry, chr);\n+        sortDropEntries(ServerConstants.USE_SPAWN_RELEVANT_LOOT ? chr.retrieveRelevantDrops(mob.getId()) : mi.retrieveEffectiveDrop(mob.getId()), dropEntry, visibleQuestEntry, otherQuestEntry, chr);\n         \n         registerMobItemDrops(droptype, mobpos, chRate, pos, dropEntry, visibleQuestEntry, otherQuestEntry, globalEntry, chr, mob);\n     }\n@@ -974,10 +978,6 @@ public void pickItemDrop(byte[] pickupPacket, MapleMapItem mdrop) { // mdrop mus\n         unregisterItemDrop(mdrop);\n     }\n     \n-    private static boolean shouldShowQuestItem(MapleCharacter chr, int questid, int itemid) {\n-        return questid <= 0 || chr.needQuestItem(questid, itemid);\n-    }\n-    \n     public void updatePlayerItemDrops(int partyid, int charid, List<MapleCharacter> partyMembers, MapleCharacter partyLeaver) {\n         for(MapleMapItem mdrop : getDroppedItems()) {\n             if(mdrop.getOwnerId() == charid) {\n@@ -994,7 +994,7 @@ public void updatePlayerItemDrops(int partyid, int charid, List<MapleCharacter>\n                         if(this.equals(mc.getMap())) {\n                             mc.announce(removePacket);\n                             \n-                            if(shouldShowQuestItem(mc, mdrop.getQuest(), mdrop.getItemId())) {\n+                            if(mc.needQuestItem(mdrop.getQuest(), mdrop.getItemId())) {\n                                 mc.announce(updatePacket);\n                             }\n                         }\n@@ -1004,7 +1004,7 @@ public void updatePlayerItemDrops(int partyid, int charid, List<MapleCharacter>\n                         if(this.equals(partyLeaver.getMap())) {\n                             partyLeaver.announce(removePacket);\n                             \n-                            if(shouldShowQuestItem(partyLeaver, mdrop.getQuest(), mdrop.getItemId())) {\n+                            if(partyLeaver.needQuestItem(mdrop.getQuest(), mdrop.getItemId())) {\n                                 partyLeaver.announce(MaplePacketCreator.updateMapItemObject(mdrop, true));\n                             }\n                         }\n@@ -1024,7 +1024,7 @@ private void spawnDrop(final Item idrop, final Point dropPos, final MapleMapObje\n             public void sendPackets(MapleClient c) {\n                 MapleCharacter chr = c.getPlayer();\n                 \n-                if (shouldShowQuestItem(chr, questid, idrop.getItemId())) {\n+                if (chr.needQuestItem(questid, idrop.getItemId())) {\n                     mdrop.lockItem();\n                     try {\n                         c.announce(MaplePacketCreator.dropItemFromMapObject(chr.getParty() != null, mdrop, dropper.getPosition(), dropPos, (byte) 1));\n@@ -1208,19 +1208,19 @@ public boolean damageMonster(final MapleCharacter chr, final MapleMonster monste\n     }\n     \n     public void broadcastBalrogVictory(String leaderName) {\n-        Server.getInstance().getWorld(world).dropMessage(6, \"[VICTORY] \" + leaderName + \"'s party has successfully defeated the Balrog! Praise to them, they finished with \" + countAlivePlayers() + \" players alive.\");\n+        getWorldServer().dropMessage(6, \"[VICTORY] \" + leaderName + \"'s party has successfully defeated the Balrog! Praise to them, they finished with \" + countAlivePlayers() + \" players alive.\");\n     }\n     \n     public void broadcastHorntailVictory() {\n-        Server.getInstance().getWorld(world).dropMessage(6, \"[VICTORY] To the crew that have finally conquered Horned Tail after numerous attempts, I salute thee! You are the true heroes of Leafre!!\");\n+        getWorldServer().dropMessage(6, \"[VICTORY] To the crew that have finally conquered Horned Tail after numerous attempts, I salute thee! You are the true heroes of Leafre!!\");\n     }\n     \n     public void broadcastZakumVictory() {\n-        Server.getInstance().getWorld(world).dropMessage(6, \"[VICTORY] At last, the tree of evil that for so long overwhelmed Ossyria has fallen. To the crew that managed to finally conquer Zakum, after numerous attempts, victory! You are the true heroes of Ossyria!!\");\n+        getWorldServer().dropMessage(6, \"[VICTORY] At last, the tree of evil that for so long overwhelmed Ossyria has fallen. To the crew that managed to finally conquer Zakum, after numerous attempts, victory! You are the true heroes of Ossyria!!\");\n     }\n     \n     public void broadcastPinkBeanVictory(int channel) {\n-        Server.getInstance().getWorld(world).dropMessage(6, \"[VICTORY] In a swift stroke of sorts, the crew that has attempted Pink Bean at channel \" + channel + \" has ultimately defeated it. The Temple of Time shines radiantly once again, the day finally coming back, as the crew that managed to finally conquer it returns victoriously from the battlefield!!\");\n+        getWorldServer().dropMessage(6, \"[VICTORY] In a swift stroke of sorts, the crew that has attempted Pink Bean at channel \" + channel + \" has ultimately defeated it. The Temple of Time shines radiantly once again, the day finally coming back, as the crew that managed to finally conquer it returns victoriously from the battlefield!!\");\n     }\n     \n     private boolean removeKilledMonsterObject(MapleMonster monster) {\n@@ -2089,7 +2089,7 @@ public void run() {\n             }\n         };\n         \n-        Server.getInstance().getWorld(world).registerTimedMapObject(expireKite, ServerConstants.KITE_EXPIRE_TIME);\n+        getWorldServer().registerTimedMapObject(expireKite, ServerConstants.KITE_EXPIRE_TIME);\n     }\n     \n     public final void spawnItemDrop(final MapleMapObject dropper, final MapleCharacter owner, final Item item, Point pos, final boolean ffaDrop, final boolean playerDrop) {\n@@ -2360,7 +2360,7 @@ public void addPlayer(final MapleCharacter chr) {\n                 spawnMonsterOnGroundBelow(MapleLifeFactory.getMonster(9300102), new Point(77, 426));\n             }\n         } else if (mapid == 200090060) { // To Rien\n-            int travelTime = EventManager.getTransportationTime(1 * 60 * 1000);\n+            int travelTime = getWorldServer().getTransportationTime(1 * 60 * 1000);\n             chr.announce(MaplePacketCreator.getClock(travelTime / 1000));\n             TimerManager.getInstance().schedule(new Runnable() {\n \n@@ -2372,7 +2372,7 @@ public void run() {\n                 }\n             }, travelTime);\n         } else if (mapid == 200090070) { // To Lith Harbor\n-            int travelTime = EventManager.getTransportationTime(1 * 60 * 1000);\n+            int travelTime = getWorldServer().getTransportationTime(1 * 60 * 1000);\n             chr.announce(MaplePacketCreator.getClock(travelTime / 1000));\n             TimerManager.getInstance().schedule(new Runnable() {\n \n@@ -2384,7 +2384,7 @@ public void run() {\n                 }\n             }, travelTime);\n         } else if (mapid == 200090030) { // To Ereve (SkyFerry)\n-            int travelTime = EventManager.getTransportationTime(2 * 60 * 1000);\n+            int travelTime = getWorldServer().getTransportationTime(2 * 60 * 1000);\n             chr.announce(MaplePacketCreator.getClock(travelTime / 1000));\n             TimerManager.getInstance().schedule(new Runnable() {\n \n@@ -2396,7 +2396,7 @@ public void run() {\n                 }\n             }, travelTime);\n         } else if (mapid == 200090031) { // To Victoria Island (SkyFerry)\n-            int travelTime = EventManager.getTransportationTime(2 * 60 * 1000);\n+            int travelTime = getWorldServer().getTransportationTime(2 * 60 * 1000);\n             chr.announce(MaplePacketCreator.getClock(travelTime / 1000));\n             TimerManager.getInstance().schedule(new Runnable() {\n \n@@ -2408,7 +2408,7 @@ public void run() {\n                 }\n             }, travelTime);\n         } else if (mapid == 200090021) { // To Orbis (SkyFerry)\n-            int travelTime = EventManager.getTransportationTime(8 * 60 * 1000);\n+            int travelTime = getWorldServer().getTransportationTime(8 * 60 * 1000);\n             chr.announce(MaplePacketCreator.getClock(travelTime / 1000));\n             TimerManager.getInstance().schedule(new Runnable() {\n \n@@ -2420,7 +2420,7 @@ public void run() {\n                 }\n             }, travelTime);\n         } else if (mapid == 200090020) { // To Ereve From Orbis (SkyFerry)\n-            int travelTime = EventManager.getTransportationTime(8 * 60 * 1000);\n+            int travelTime = getWorldServer().getTransportationTime(8 * 60 * 1000);\n             chr.announce(MaplePacketCreator.getClock(travelTime / 1000));\n             TimerManager.getInstance().schedule(new Runnable() {\n "}, {"sha": "9d0bd4e8a34eb5a75e12ee0b054f522779619996", "filename": "src/server/maps/MapleMapItem.java", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/server/maps/MapleMapItem.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/server/maps/MapleMapItem.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/maps/MapleMapItem.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -184,7 +184,7 @@ public final MapleMapObjectType getType() {\n     public void sendSpawnData(final MapleClient client) {\n         MapleCharacter chr = client.getPlayer();\n         \n-\tif (questid <= 0 || chr.needQuestItem(questid, item.getItemId())) {\n+\tif (chr.needQuestItem(questid, getItemId())) {\n \t    this.lockItem();\n             try {\n                 client.announce(MaplePacketCreator.dropItemFromMapObject(chr.getParty() != null, this, null, getPosition(), (byte) 2));"}, {"sha": "419b6f9919350017f081cf7b105426d04b609e46", "filename": "src/tools/MaplePacketCreator.java", "status": "modified", "additions": 11, "deletions": 12, "changes": 23, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/src/tools/MaplePacketCreator.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/src/tools/MaplePacketCreator.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/tools/MaplePacketCreator.java?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -4541,20 +4541,19 @@ public static void addThread(final MaplePacketLittleEndianWriter mplew, ResultSe\n                 return mplew.getPacket();\n         }\n \n-        public static byte[] showPlayerRanks(int npcid, ResultSet rs) throws SQLException {\n+        public static byte[] showPlayerRanks(int npcid, List<Pair<String, Integer>> worldRanking) {\n                 final MaplePacketLittleEndianWriter mplew = new MaplePacketLittleEndianWriter();\n                 mplew.writeShort(SendOpcode.GUILD_OPERATION.getValue());\n                 mplew.write(0x49);\n                 mplew.writeInt(npcid);\n-                if (!rs.last()) { \n+                if (worldRanking.isEmpty()) { \n                         mplew.writeInt(0);\n                         return mplew.getPacket();\n                 }\n-                mplew.writeInt(rs.getRow());\n-                rs.beforeFirst();\n-                while (rs.next()) {\n-                        mplew.writeMapleAsciiString(rs.getString(\"name\"));\n-                        mplew.writeInt(rs.getInt(\"level\"));\n+                mplew.writeInt(worldRanking.size());\n+                for (Pair<String, Integer> wr : worldRanking) {\n+                        mplew.writeMapleAsciiString(wr.getLeft());\n+                        mplew.writeInt(wr.getRight());\n                         mplew.writeInt(0);\n                         mplew.writeInt(0);\n                         mplew.writeInt(0);\n@@ -4726,8 +4725,7 @@ private static void addPetInfo(final MaplePacketLittleEndianWriter mplew, MapleP\n \n                 mplew.writeInt(pet.getItemId());\n                 mplew.writeMapleAsciiString(pet.getName());\n-                mplew.writeInt(pet.getUniqueId());\n-                mplew.writeInt(0);\n+                mplew.writeLong(pet.getUniqueId());\n                 mplew.writePos(pet.getPos());\n                 mplew.write(pet.getStance());\n                 mplew.writeInt(pet.getFh());\n@@ -4828,6 +4826,8 @@ private static void addPetInfo(final MaplePacketLittleEndianWriter mplew, MapleP\n         }\n \n         public static byte[] petStatUpdate(MapleCharacter chr) {\n+                // this actually does nothing... packet structure and stats needs to be uncovered\n+            \n                 final MaplePacketLittleEndianWriter mplew = new MaplePacketLittleEndianWriter();\n                 mplew.writeShort(SendOpcode.STAT_CHANGED.getValue());\n                 int mask = 0;\n@@ -4837,8 +4837,7 @@ private static void addPetInfo(final MaplePacketLittleEndianWriter mplew, MapleP\n                 MaplePet[] pets = chr.getPets();\n                 for (int i = 0; i < 3; i++) {\n                         if (pets[i] != null) {\n-                                mplew.writeInt(pets[i].getUniqueId());\n-                                mplew.writeInt(0);\n+                                mplew.writeLong(pets[i].getUniqueId());\n                         } else {\n                                 mplew.writeLong(0);\n                         }\n@@ -5477,7 +5476,7 @@ private static void addPetInfo(final MaplePacketLittleEndianWriter mplew, MapleP\n         }\n         /*\n          * Possible things for ENTRUSTED_SHOP_CHECK_RESULT\n-         * 0x0E = 00 = Renaming Failed - Can't find the merchant, 01 = Renaming succesful\n+         * 0x0E = 00 = Renaming Failed - Can't find the merchant, 01 = Renaming successful\n          * 0x10 = Changes channel to the store (Store is open at Channel 1, do you want to change channels?)\n          * 0x11 = You cannot sell any items when managing.. blabla\n          * 0x12 = FKING POPUP LOL"}, {"sha": "9c5c7b5d0b088b9eb6697f658349a2825f432261", "filename": "tools/MapleQuestItemFetcher/nbproject/private/private.xml", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/tools/MapleQuestItemFetcher/nbproject/private/private.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/tools/MapleQuestItemFetcher/nbproject/private/private.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/tools/MapleQuestItemFetcher/nbproject/private/private.xml?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -3,7 +3,8 @@\n     <editor-bookmarks xmlns=\"http://www.netbeans.org/ns/editor-bookmarks/2\" lastBookmarkId=\"0\"/>\n     <open-files xmlns=\"http://www.netbeans.org/ns/projectui-open-files/2\">\n         <group>\n-            <file>file:/C:/Nexon/MapleSolaxia/HeavenMS/tools/MapleQuestItemFetcher/src/maplequestitemfetcher/MapleQuestItemFetcher.java</file>\n+            <file>file:/C:/Nexon/HeavenMS/tools/MapleQuestItemFetcher/src/tools/MapleItemInformationProvider.java</file>\n+            <file>file:/C:/Nexon/HeavenMS/tools/MapleQuestItemFetcher/src/maplequestitemfetcher/MapleQuestItemFetcher.java</file>\n         </group>\n     </open-files>\n </project-private>"}, {"sha": "7bae4fb4ab751344b9167c3f30d2aac1529a5a2f", "filename": "world.ini", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/world.ini", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/world.ini", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/world.ini?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -11,6 +11,10 @@ servermessage0=Welcome to Scania!\n eventmessage0=Scania!\n whyamirecommended0=Welcome to Scania!\n channels0=3\n+exprate0=10\n+mesorate0=10\n+droprate0=10\n+questrate0=5\n \n #Properties for Bera 1\n flag1=0"}, {"sha": "b4615334d818b45f60002c4d0b0e9b1f13203d38", "filename": "wz/String.wz/Consume.img.xml", "status": "modified", "additions": 7, "deletions": 7, "changes": 14, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/132f28639180aea52aba572ce8b528fbd839dec1/wz/String.wz/Consume.img.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/132f28639180aea52aba572ce8b528fbd839dec1/wz/String.wz/Consume.img.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/wz/String.wz/Consume.img.xml?ref=132f28639180aea52aba572ce8b528fbd839dec1", "patch": "@@ -4878,19 +4878,19 @@\n   </imgdir>\n   <imgdir name=\"2380003\">\n     <string name=\"name\" value=\"Stump Card\"/>\n-    <string name=\"desc\" value=\"StumpA card that features\"/>\n+    <string name=\"desc\" value=\"A card that features Stump.\"/>\n   </imgdir>\n   <imgdir name=\"2380004\">\n     <string name=\"name\" value=\"Red Snail Card\"/>\n-    <string name=\"desc\" value=\"Red SnailA card that features\"/>\n+    <string name=\"desc\" value=\"A card that features Red Snail.\"/>\n   </imgdir>\n   <imgdir name=\"2380005\">\n     <string name=\"name\" value=\"Slime Card\"/>\n-    <string name=\"desc\" value=\"A card that features Slime\"/>\n+    <string name=\"desc\" value=\"A card that features Slime.\"/>\n   </imgdir>\n   <imgdir name=\"2380006\">\n     <string name=\"name\" value=\"Pig Card\"/>\n-    <string name=\"desc\" value=\"A card that features Pig\"/>\n+    <string name=\"desc\" value=\"A card that features Pig.\"/>\n   </imgdir>\n   <imgdir name=\"2380007\">\n     <string name=\"name\" value=\"Orange Mushroom Card\"/>\n@@ -4902,7 +4902,7 @@\n   </imgdir>\n   <imgdir name=\"2380009\">\n     <string name=\"name\" value=\"Ribbon Pig Card\"/>\n-    <string name=\"desc\" value=\"A card that features Ribbon Pig\"/>\n+    <string name=\"desc\" value=\"A card that features Ribbon Pig.\"/>\n   </imgdir>\n   <imgdir name=\"2380010\">\n     <string name=\"name\" value=\"Octopus Card\"/>\n@@ -4918,7 +4918,7 @@\n   </imgdir>\n   <imgdir name=\"2381000\">\n     <string name=\"name\" value=\"Axe Stump Card\"/>\n-    <string name=\"desc\" value=\"A card that features Axe Stump\"/>\n+    <string name=\"desc\" value=\"A card that features Axe Stump.\"/>\n   </imgdir>\n   <imgdir name=\"2381001\">\n     <string name=\"name\" value=\"Ghost Stump Card\"/>\n@@ -5002,7 +5002,7 @@\n   </imgdir>\n   <imgdir name=\"2381021\">\n     <string name=\"name\" value=\"Cico Card\"/>\n-    <string name=\"desc\" value=\"A card that features Cico\"/>\n+    <string name=\"desc\" value=\"A card that features Cico.\"/>\n   </imgdir>\n   <imgdir name=\"2381022\">\n     <string name=\"name\" value=\"Wild Boar Card\"/>"}]}]},
