{"fetchDate": "2019-12-19", "content": [{"sha": "0910dc24282732922e045e23dc3179a089d925b8", "node_id": "MDY6Q29tbWl0NDUwODIwMjM6MDkxMGRjMjQyODI3MzI5MjJlMDQ1ZTIzZGMzMTc5YTA4OWQ5MjViOA==", "commit": {"author": {"name": "ronancpl", "email": "rcpl2010@gmail.com", "date": "2018-11-22T18:16:21Z"}, "committer": {"name": "ronancpl", "email": "rcpl2010@gmail.com", "date": "2018-11-22T18:16:21Z"}, "message": "Missing Pirate questlines + Find & MoveLife update + Party-Map patch\n\nImplemented missing scripts for Aerial Strike, Hypnotize and Time Leap skill questlines.\nFixed an deadlock issue within player's inventory and status.\nFixed skill spam detection disconnecting players when legitimatelly spamming Flash Jump or Heal.\nFixed party members map location not being properly updated after changing maps.\nRehauled MoveLife handler. Improved packet read of attack and skill elements, properly reflecting incoming actions to other player on the map.\nReviewed an issue with equipments MaxHP/MaxMP getting unsynced with player's MaxHP/MaxMP, resulting in differences within server-client view of a player's pool.\nFixed mobs not being spawned by dojo bosses after enough spawn actions were instanced.\nImplemented proper Mob.wz linked mob data support.\nFixed /find not identifying a player's channel properly.\nFixed Echo of Hero not affecting other player in the map.\nFixed commands warp and goto not taking player off events/expeditions properly.\nFixed storage expansion not being registered on DB when buying the cash item.\nFixed party leadership being reassigned after changing channels.\nImplemented suggested level range limit between party members on the EXP share system. Players whose level range from the attacker exceeds the estipulated threshold will not receive any EXP from the action.\n\nHappy Thanksgiving Day everyone!!!", "tree": {"sha": "b3cf3e149401ad43108e57b990737724dad614c8", "url": "https://api.github.com/repos/ronancpl/HeavenMS/git/trees/b3cf3e149401ad43108e57b990737724dad614c8"}, "url": "https://api.github.com/repos/ronancpl/HeavenMS/git/commits/0910dc24282732922e045e23dc3179a089d925b8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/0910dc24282732922e045e23dc3179a089d925b8", "html_url": "https://github.com/ronancpl/HeavenMS/commit/0910dc24282732922e045e23dc3179a089d925b8", "comments_url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/0910dc24282732922e045e23dc3179a089d925b8/comments", "author": {"login": "ronancpl", "id": 9257761, "node_id": "MDQ6VXNlcjkyNTc3NjE=", "avatar_url": "https://avatars2.githubusercontent.com/u/9257761?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ronancpl", "html_url": "https://github.com/ronancpl", "followers_url": "https://api.github.com/users/ronancpl/followers", "following_url": "https://api.github.com/users/ronancpl/following{/other_user}", "gists_url": "https://api.github.com/users/ronancpl/gists{/gist_id}", "starred_url": "https://api.github.com/users/ronancpl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ronancpl/subscriptions", "organizations_url": "https://api.github.com/users/ronancpl/orgs", "repos_url": "https://api.github.com/users/ronancpl/repos", "events_url": "https://api.github.com/users/ronancpl/events{/privacy}", "received_events_url": "https://api.github.com/users/ronancpl/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ronancpl", "id": 9257761, "node_id": "MDQ6VXNlcjkyNTc3NjE=", "avatar_url": "https://avatars2.githubusercontent.com/u/9257761?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ronancpl", "html_url": "https://github.com/ronancpl", "followers_url": "https://api.github.com/users/ronancpl/followers", "following_url": "https://api.github.com/users/ronancpl/following{/other_user}", "gists_url": "https://api.github.com/users/ronancpl/gists{/gist_id}", "starred_url": "https://api.github.com/users/ronancpl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ronancpl/subscriptions", "organizations_url": "https://api.github.com/users/ronancpl/orgs", "repos_url": "https://api.github.com/users/ronancpl/repos", "events_url": "https://api.github.com/users/ronancpl/events{/privacy}", "received_events_url": "https://api.github.com/users/ronancpl/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5ee0cd1c98002d81b343212b85ede7b97e8a45ce", "url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/5ee0cd1c98002d81b343212b85ede7b97e8a45ce", "html_url": "https://github.com/ronancpl/HeavenMS/commit/5ee0cd1c98002d81b343212b85ede7b97e8a45ce"}], "stats": {"total": 6154, "additions": 3793, "deletions": 2361}, "files": [{"sha": "7589dbdfe8f899712d1da73b86a4ad2a2db6f8bf", "filename": "docs/mychanges_ptbr.txt", "status": "modified", "additions": 30, "deletions": 1, "changes": 31, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/docs/mychanges_ptbr.txt", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/docs/mychanges_ptbr.txt", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/docs/mychanges_ptbr.txt?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -1453,4 +1453,33 @@ Refatorado packets que lidam com respostas a comandos de pets.\n Corrigido drop data de Ultra Gray com item inexistente.\n Corrigido quest de meteoritos mudando estado da quest mesmo quando jogador n\u00e3o recebe o item devido a invent\u00e1rio cheio.\n Corrigido quest de Maker lv1 retirando mesos al\u00e9m da quantidade esperada, ao realizar a\u00e7\u00f5es da quest.\n-Adicionado server flag que lida com utiliza\u00e7\u00e3o de features NPCs custom.\n\\ No newline at end of file\n+Adicionado server flag que lida com utiliza\u00e7\u00e3o de features NPCs custom.\n+\n+11 Novembro 2018,\n+Implementado questline para as skills Hypnotize e Time Leap.\n+Corrigido um problema de deadlock envolvendo invent\u00e1rios e locks de status de jogadores.\n+Corrigido detec\u00e7\u00e3o de spam de Flash Jump desconectando jogadores que tentam us\u00e1-lo em rampas.\n+Corrigido mapa no 4o est\u00e1gio de Tera Gate com footholds irregulares.\n+\n+12 - 14 Novembro 2018,\n+M\u00e9todo de update de cupons dos jogadores agora atua de forma mais otimizada, evitando execu\u00e7\u00f5es desnecess\u00e1rias.\n+Corrigido update de mapas n\u00e3o atuando corretamente para jogadores de party.\n+Revisado leitura de uso de skills e ataques de mobs, agora aplicando os limites para detec\u00e7\u00e3o de ataque/skill de uma forma mais correta.\n+Corrigido caso onde registros de MaxHP e MaxMP de jogadores se tornariam inconsistentes ap\u00f3s equipamento aumentar de n\u00edvel.\n+Corrigido mobs parando de ser spawnados em mapas de Dojo ap\u00f3s diversos usos de MobSkill.\n+Implementado suporte apropriado para mobs linkados. Registros de mobs base s\u00e3o propagados para seus links, para eventualmente ter informa\u00e7\u00f5es sobrescritas.\n+Corrigido MoveLife n\u00e3o lan\u00e7ando corretamente pacotes para outros jogadores em diversos cen\u00e1rios, diversas vezes tornando a jogabilidade inconstante no multiplayer.\n+\n+15 - 17 Novembro 2018,\n+Corrigido /find n\u00e3o identificando canal do jogador-alvo corretamente.\n+Corrigido lider de party sendo passado para outro membro no mapa ao mudar canais.\n+Corrigido Echo of Hero n\u00e3o atuando em outros jogadores no mapa.\n+Corrigido quest inicial de Mushroom Castle n\u00e3o levando jogadores \u00e0 \u00e1rea diretamente.\n+Corrigido comandos warp e goto n\u00e3o retirando jogadores corretamente de eventos/expedi\u00e7\u00e3o ao mudar de mapas.\n+Implementado script para questline de skill Aerial Strike.\n+\n+20 - 21 Novembro 2018,\n+Corrigido limite do Cash Shop storage n\u00e3o atualizando corretamente quando jogador compra expans\u00e3o de 8.\n+Atualizado guild rank de jogadores ao resetar guildid dos mesmos, agora evitando jogadores com rank acima de 5 mesmo sem guild.\n+Adicionado restri\u00e7\u00e3o no sistema de partilha de EXP. Jogadores que possuem uma diferen\u00e7a de n\u00edvel com o last hitter satisfatoriamente grande n\u00e3o recebe este ganho.\n+Modificado nome de skill Maple Hero destacados em quest e itens para Maple Warrior.\n\\ No newline at end of file"}, {"sha": "4bb475df5251156999aabe7b0d2665d9fc5fc4ae", "filename": "handbook/Use.txt", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/handbook/Use.txt", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/handbook/Use.txt", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/handbook/Use.txt?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -1181,7 +1181,7 @@\n 2280000 - Lava Bottle - A glass bottle that contains an actual lava, which is waiting to be spilled out. Drink this lava, and the lava will consume the body with fire, which will enable the drinker to master Fire Demon.\n 2280001 - Black Cloud Machine - A mechanical device that produces black clouds. Enables the character to acquire the Smokescreen skill using the clouds.\n 2280002 - Firm Hand - A stimulant packaged inside a bottle that resembles a clenched fist. Drinking the stimulant will allow the character to acquire The Will of a Warrior.\n-2280003 - [Skill Book] Maple Hero - You can learn #cMaple Hero# with this book.rnJob : All 4th jobsrnCondition : #cMaple Hero# not acquired.\n+2280003 - [Skill Book] Maple Warrior - You can learn #cMaple Warrior# with this book.rnJob : All 4th jobsrnCondition : #cMaple Warrior# not acquired.\n 2280004 - [Skill Book] Infinity - You can learn #Infinity# with this book.rnJob : 4th Advancement MagicianrnCondition : #cInfinity# not acquired\n 2280005 - [Skill Book] Dragon's Breath - You can learn #cDragon's Breath# with this book.wnJob : 4th Advancement BowmanrnCondition : #cDragon's Breath# not acquired\n 2280006 - [Skill Book] Taunt - You can learn #cTaunt# with this book.rnJob : 4th Advancement ThiefrnCondition : #cTaunt# not acquired\n@@ -1287,7 +1287,7 @@\n 2290093 - [Mastery Book] Assassinate - This increases the master level of #cAssassinate# up to 30 with 50% of chance.rnClass : ShadowerrnCondition : Skill level above 15\n 2290094 - [Mastery Book] Smokescreen - This increases the master level of #cSmokescreen# up to 20 with 70% of chance.rnClass : ShadowerrnCondition : Skill level above 5\n 2290095 - [Mastery Book] Smokescreen - This increases the master level of #cSmokescreen# up to 30 with 50% of chance.rnClass : ShadowerrnCondition : Skill level above 15\n-2290096 - [Mastery Book] Maple Hero 20 - This increases the master level of #cMaple Hero# up to 20 with 70% of chance.rnJob : All 4th Advancement JobsrnCondition : Skill level above 5\n+2290096 - [Mastery Book] Maple Warrior 20 - This increases the master level of #cMaple Warrior# up to 20 with 70% of chance.rnJob : All 4th Advancement JobsrnCondition : Skill level above 5\n 2290097 - [Mastery Book] Dragon Strike - With a 70% success rate, it raises the Master Level of #cDragon Strike# to 20.nJob : BuccaneernRequirement : At least Level 5 in this skill\n 2290098 - [Mastery Book] Dragon Strike - With a 50% success rate, it raises the Master Level of #cDragon Strike# to 30.nJob : BuccaneernRequirement : At least Level 15 in this skill\n 2290099 - [Mastery Book] Energy Orb - With a 70% success rate, it raises the Master Level of #cEnergy Orb# to 20.nJob : BuccaneernRequirement : At least Level 5 in this skill\n@@ -1316,7 +1316,7 @@\n 2290122 - [Mastery Book] Battleship Torpedo - With a 50% success rate, it raises the Master Level of #cBattleship Torpedo# to 30.nJob : CorsairnRequirement : At least Level 15 in this skill\n 2290123 - [Mastery Book] Hypnotize - With a 70% success rate, it raises the Master Level of #cHypnotize# to 20.nJob : CorsairnRequirement : At least Level 5 in this skill\n 2290124 - [Mastery Book] Bullseye - With a 70% success rate, it raises the Master Level of #cBullseye# to 20.nJob : CorsairnRequirement : At least Level 5 in this skill\n-2290125 - [Mastery Book] Maple Hero 30 - This increases the master level of #cMaple Hero# up to 30 with 50% of chance.rnJob : All 4th Advancement JobsrnCondition : Skill level above 15\n+2290125 - [Mastery Book] Maple Warrior 30 - This increases the master level of #cMaple Warrior# up to 30 with 50% of chance.rnJob : All 4th Advancement JobsrnCondition : Skill level above 15\n 2310000 - The Owl of Minerva - #cThe Owl of Minerva#, which represents wisdom, can be used to search for items sold at the Free Market. #cDisappears right after showing the results of the item search#.\n 2320000 - Teleport Rock - Remembers 5 maps of your choice. This rock will enable you to #cteleport to the map you remembered#. It can even allow you to #cmove to the map where a certain character is#, provided that the person is in the same channel at the same world.\n 2330000 - Bullet - A bullet made out of steel. A set contains numerous bullets and once they are used up, they'll need to be recharged.\\nAttack + 10"}, {"sha": "cc86853be9dd7ec5831ca2387e63e79a8893d303", "filename": "scripts/event/4jaerial.js", "status": "added", "additions": 109, "deletions": 0, "changes": 109, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/4jaerial.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/4jaerial.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/event/4jaerial.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -0,0 +1,109 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+/**\n+ * @Author Ronan\n+ * Event - Jonathan's Test Quest\n+**/\n+\n+var entryMap = 912020000;\n+var exitMap = 120000102;\n+\n+var minMapId = 912020000;\n+var maxMapId = 912020000;\n+\n+var eventTime = 2; //2 minutes\n+\n+var lobbyRange = [0, 0];\n+\n+function setLobbyRange() {\n+    return lobbyRange;\n+}\n+\n+function init() {\n+    em.setProperty(\"noEntry\",\"false\");\n+}\n+\n+function setup(level, lobbyid) {\n+    var eim = em.newInstance(\"4jaerial_\" + lobbyid);\n+    eim.setProperty(\"level\", level);\n+    eim.setProperty(\"boss\", \"0\");\n+    eim.setProperty(\"canLeave\", \"0\");\n+\n+    eim.getInstanceMap(entryMap).resetPQ(level);\n+    eim.getInstanceMap(entryMap).shuffleReactors();\n+\n+    respawnStages(eim);\n+    eim.startEventTimer(eventTime * 60000);\n+    return eim;\n+}\n+\n+function afterSetup(eim) {}\n+\n+function respawnStages(eim) {}\n+\n+function playerEntry(eim, player) {\n+    var map = eim.getMapInstance(entryMap);\n+    player.changeMap(map, map.getPortal(0));\n+}\n+\n+function playerUnregistered(eim, player) {}\n+\n+function playerExit(eim, player) {\n+    eim.unregisterPlayer(player);\n+    eim.dispose();\n+    em.setProperty(\"noEntry\",\"false\");\n+}\n+\n+function playerLeft(eim, player) {}\n+\n+function scheduledTimeout(eim) {\n+    var player = eim.getPlayers().get(0);\n+    playerExit(eim, player);\n+    player.changeMap(exitMap);\n+}\n+\n+function playerDisconnected(eim, player) {\n+    playerExit(eim, player);\n+}\n+\n+function changedMap(eim, chr, mapid) {\n+    if(mapid < minMapId || mapid > maxMapId) playerExit(eim, chr);\n+}\n+\n+function clearPQ(eim) {\n+    eim.stopEventTimer();\n+    eim.setEventCleared();\n+}\n+\n+function monsterKilled(mob, eim) {}\n+\n+function leftParty(eim, player) {}\n+\n+function disbandParty(eim) {}\n+\n+function monsterValue(eim, mobId) {\n+    return 1;\n+}\n+\n+function allMonstersDead(eim) {}\n+\n+function cancelSchedule() {}\n+\n+function dispose() {}"}, {"sha": "32ccf85bdb2d35f98fdce558fcd750a9b41ef8af", "filename": "scripts/event/AreaBossBamboo.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/AreaBossBamboo.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/AreaBossBamboo.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/event/AreaBossBamboo.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -23,7 +23,7 @@\n -- Odin JavaScript --------------------------------------------------------------------------------\n \tBamboo Warrior Spawner\n -- Edited by --------------------------------------------------------------------------------------\n-\tRonan (based on xQuasar's King Clang spawner)\n+\tRonan - based on xQuasar's King Clang spawner\n \n **/\n function init() {"}, {"sha": "3a52fd76af0df879121ae3f43d9232411f3508b0", "filename": "scripts/event/AreaBossCentipede.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/AreaBossCentipede.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/AreaBossCentipede.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/event/AreaBossCentipede.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -23,7 +23,7 @@\n -- Odin JavaScript --------------------------------------------------------------------------------\n \tCentipede Spawner\n -- Edited by --------------------------------------------------------------------------------------\n-\tRonan (based on xQuasar's King Clang spawner)\n+\tRonan - based on xQuasar's King Clang spawner\n \n **/\n function init() {"}, {"sha": "da5bed77f516589714a74a9a6879f252ec11261e", "filename": "scripts/event/AreaBossDeo.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/AreaBossDeo.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/AreaBossDeo.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/event/AreaBossDeo.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -23,7 +23,7 @@\n -- Odin JavaScript --------------------------------------------------------------------------------\n \tDeo Spawner\n -- Edited by --------------------------------------------------------------------------------------\n-\tThreeStep (based on xQuasar's King Clang spawner)\n+\tThreeStep - based on xQuasar's King Clang spawner\n \n **/\n function init() {"}, {"sha": "66b20592eedbf05595bd3c5652a5d847c565042b", "filename": "scripts/event/AreaBossDyle.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/AreaBossDyle.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/AreaBossDyle.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/event/AreaBossDyle.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -23,7 +23,7 @@\n -- Odin JavaScript --------------------------------------------------------------------------------\n \tDyle Spawner\n -- Edited by --------------------------------------------------------------------------------------\n-\tThreeStep (based on xQuasar's King Clang spawner)\n+\tThreeStep - based on xQuasar's King Clang spawner\n \n **/\n importPackage(Packages.server.life);"}, {"sha": "f969216612db65471130a3b6fce47a2128c91fcc", "filename": "scripts/event/AreaBossEliza1.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/AreaBossEliza1.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/AreaBossEliza1.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/event/AreaBossEliza1.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -23,7 +23,7 @@\n -- Odin JavaScript --------------------------------------------------------------------------------\n \tEliza1 Spawner\n -- Edited by --------------------------------------------------------------------------------------\n-\tThreeStep (based on xQuasar's King Clang spawner)\n+\tThreeStep - based on xQuasar's King Clang spawner\n \n **/\n "}, {"sha": "a5cd6265b7bf3bb8cd945991a629550f9a6a1401", "filename": "scripts/event/AreaBossFaust1.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/AreaBossFaust1.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/AreaBossFaust1.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/event/AreaBossFaust1.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -23,7 +23,7 @@\n -- Odin JavaScript --------------------------------------------------------------------------------\n \tFaust1 Spawner\n -- Edited by --------------------------------------------------------------------------------------\n-\tThreeStep (based on xQuasar's King Clang spawner)\n+\tThreeStep - based on xQuasar's King Clang spawner\n \n **/\n "}, {"sha": "0c2a24ebbff1e1fdd963091394abffc12459fd14", "filename": "scripts/event/AreaBossFaust2.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/AreaBossFaust2.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/AreaBossFaust2.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/event/AreaBossFaust2.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -23,7 +23,7 @@\n -- Odin JavaScript --------------------------------------------------------------------------------\n \tFaust2 Spawner\n -- Edited by --------------------------------------------------------------------------------------\n-\tThreeStep (based on xQuasar's King Clang spawner)\n+\tThreeStep - based on xQuasar's King Clang spawner\n \n **/\n "}, {"sha": "25b7502deb23fe00754ee030fef9487b790e3817", "filename": "scripts/event/AreaBossKimera.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/AreaBossKimera.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/AreaBossKimera.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/event/AreaBossKimera.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -23,7 +23,7 @@\n -- Odin JavaScript --------------------------------------------------------------------------------\n \tChimera/Kimera Spawner\n -- Edited by --------------------------------------------------------------------------------------\n-\tThreeStep (based on xQuasar's King Clang spawner)\n+\tThreeStep - based on xQuasar's King Clang spawner\n \n **/\n "}, {"sha": "96f3445d2822f1e1593c651b672ed880752bb17a", "filename": "scripts/event/AreaBossKingClang.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/AreaBossKingClang.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/AreaBossKingClang.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/event/AreaBossKingClang.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -23,7 +23,7 @@\n -- Odin JavaScript --------------------------------------------------------------------------------\n \tKing Clang Spawner\n -- Edited by --------------------------------------------------------------------------------------\n-\tThreeStep (based on xQuasar's King Clang spawner)\n+\tThreeStep - based on xQuasar's King Clang spawner\n \n **/\n "}, {"sha": "ec9ebbcde76bf082574f183f8b3aea00591c6d08", "filename": "scripts/event/AreaBossKingSageCat.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/AreaBossKingSageCat.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/AreaBossKingSageCat.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/event/AreaBossKingSageCat.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -23,7 +23,7 @@\n -- Odin JavaScript --------------------------------------------------------------------------------\n \tKing Sage Cat Spawner\n -- Edited by --------------------------------------------------------------------------------------\n-\tThreeStep (based on xQuasar's King Clang spawner)\n+\tThreeStep - based on xQuasar's King Clang spawner\n \n **/\n "}, {"sha": "f229804c2ed411c26fbc1197666d106b165bc991", "filename": "scripts/event/AreaBossLeviathan.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/AreaBossLeviathan.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/AreaBossLeviathan.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/event/AreaBossLeviathan.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -23,7 +23,7 @@\n -- Odin JavaScript --------------------------------------------------------------------------------\n \tLeviathan Spawner\n -- Edited by --------------------------------------------------------------------------------------\n-\tThreeStep (based on xQuasar's King Clang spawner)\n+\tThreeStep - based on xQuasar's King Clang spawner\n \n **/\n "}, {"sha": "39a3a4e23cc6fe736df63a10da815ad402904e08", "filename": "scripts/event/AreaBossMano.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/AreaBossMano.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/AreaBossMano.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/event/AreaBossMano.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -23,7 +23,7 @@\n -- Odin JavaScript --------------------------------------------------------------------------------\n \tMano Spawner\n -- Edited by --------------------------------------------------------------------------------------\n-\tThreeStep (based on xQuasar's King Clang spawner)\n+\tThreeStep - based on xQuasar's King Clang spawner\n **/\n \n importPackage(Packages.client);"}, {"sha": "941a160c4ea35bb21511e6f3f482326005349f4b", "filename": "scripts/event/AreaBossNineTailedFox.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/AreaBossNineTailedFox.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/AreaBossNineTailedFox.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/event/AreaBossNineTailedFox.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -23,7 +23,7 @@\n -- Odin JavaScript --------------------------------------------------------------------------------\n \tNine Tailed Fox (Old Fox) Spawner\n -- Edited by --------------------------------------------------------------------------------------\n-\tThreeStep (based on xQuasar's King Clang spawner)\n+\tThreeStep - based on xQuasar's King Clang spawner\n \n **/\n "}, {"sha": "16a1ad4231c36836c335080ab8d0134ef049599a", "filename": "scripts/event/AreaBossSeruf.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/AreaBossSeruf.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/AreaBossSeruf.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/event/AreaBossSeruf.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -24,7 +24,7 @@\n -- Odin JavaScript --------------------------------------------------------------------------------\n \tSeruf Spawner\n -- Edited by --------------------------------------------------------------------------------------\n-\tThreeStep (based on xQuasar's King Clang spawner)\n+\tThreeStep - based on xQuasar's King Clang spawner\n \n **/\n "}, {"sha": "5c51b4a183f9db0146c7f4cbda93915ccf57c2af", "filename": "scripts/event/AreaBossSnackBar.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/AreaBossSnackBar.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/AreaBossSnackBar.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/event/AreaBossSnackBar.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -23,7 +23,7 @@\n -- Odin JavaScript --------------------------------------------------------------------------------\n \tSnack Bar Spawner\n -- Edited by --------------------------------------------------------------------------------------\n-\tRonan (based on xQuasar's King Clang spawner)\n+\tRonan - based on xQuasar's King Clang spawner\n \n **/\n function init() {"}, {"sha": "f75494e593a382c26371b2baf4214255685a4a8e", "filename": "scripts/event/AreaBossStumpy.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/AreaBossStumpy.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/AreaBossStumpy.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/event/AreaBossStumpy.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -23,7 +23,7 @@\n -- Odin JavaScript --------------------------------------------------------------------------------\n \tStumpy Spawner\n -- Edited by --------------------------------------------------------------------------------------\n-\tThreeStep (based on xQuasar's King Clang spawner)\n+\tThreeStep - based on xQuasar's King Clang spawner\n \n **/\n "}, {"sha": "9840ae117165a86522b3e9feba52319e51d71a62", "filename": "scripts/event/AreaBossTaeRoon.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/AreaBossTaeRoon.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/AreaBossTaeRoon.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/event/AreaBossTaeRoon.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -23,7 +23,7 @@\n -- Odin JavaScript --------------------------------------------------------------------------------\n \tTae Roon Spawner\n -- Edited by --------------------------------------------------------------------------------------\n-\tThreeStep (based on xQuasar's King Clang spawner)\n+\tThreeStep - based on xQuasar's King Clang spawner\n \n **/\n "}, {"sha": "c02e76dcecf81ed9242866a7da3dc56cf0b278eb", "filename": "scripts/event/AreaBossTimer1.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/AreaBossTimer1.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/AreaBossTimer1.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/event/AreaBossTimer1.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -23,7 +23,7 @@\n -- Odin JavaScript --------------------------------------------------------------------------------\n \tTimer1 Spawner\n -- Edited by --------------------------------------------------------------------------------------\n-\tThreeStep (based on xQuasar's King Clang spawner)\n+\tThreeStep - based on xQuasar's King Clang spawner\n **/\n \n importPackage(Packages.client);"}, {"sha": "3e50299e3cd517a5b6b4fdfd006435d6b29102fd", "filename": "scripts/event/AreaBossTimer2.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/AreaBossTimer2.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/AreaBossTimer2.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/event/AreaBossTimer2.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -23,7 +23,7 @@\n -- Odin JavaScript --------------------------------------------------------------------------------\n \tTimer2 Spawner\n -- Edited by --------------------------------------------------------------------------------------\n-\tThreeStep (based on xQuasar's King Clang spawner)\n+\tThreeStep - based on xQuasar's King Clang spawner\n \n **/\n "}, {"sha": "7411e8edf0bdfeb6f09cbbbadb1c9e975d9a4e29", "filename": "scripts/event/AreaBossTimer3.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/AreaBossTimer3.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/AreaBossTimer3.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/event/AreaBossTimer3.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -24,7 +24,7 @@\n -- Odin JavaScript --------------------------------------------------------------------------------\n \tTimer3 Spawner\n -- Edited by --------------------------------------------------------------------------------------\n-\tThreeStep (based on xQuasar's King Clang spawner)\n+\tThreeStep - based on xQuasar's King Clang spawner\n \n **/\n "}, {"sha": "70d475266c4e612a3c6c4ee62d3f39382feefd47", "filename": "scripts/event/AreaBossZeno.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/AreaBossZeno.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/AreaBossZeno.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/event/AreaBossZeno.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -24,7 +24,7 @@\n -- Odin JavaScript --------------------------------------------------------------------------------\n \tZeno Spawner\n -- Edited by --------------------------------------------------------------------------------------\n-\tThreeStep (based on xQuasar's King Clang spawner)\n+\tThreeStep - based on xQuasar's King Clang spawner\n **/\n function init() {\n     scheduleNew();"}, {"sha": "e6f5d8a2a1de4c38cf31258e77ebdae78b924548", "filename": "scripts/event/Cabin.js", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/Cabin.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/Cabin.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/event/Cabin.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -29,8 +29,8 @@\n         1.5 - Fix for infinity looping [Information]\n \t1.4 - Ship/boat is now showed\n \t    - Removed temp message[Information]\n-\t    - Credit to Snow/superraz777 for old source\n-\t    - Credit to Titan/Kool for the ship/boat packet\n+\t    - Credits to Snow, superraz777 for old source\n+\t    - Credits to Titan, Kool for the ship/boat packet\n \t1.3 - Removing some function since is not needed [Information]\n \t    - Remove register player menthod [Information]\n \t1.2 - It should be 2 ships not 1 [Information]"}, {"sha": "ef3869e124cb0cc9034dee600da456165e571362", "filename": "scripts/event/DelliBattle.js", "status": "added", "additions": 209, "deletions": 0, "changes": 209, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/DelliBattle.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/event/DelliBattle.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/event/DelliBattle.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -0,0 +1,209 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/**\n+ * @author: Ronan\n+ * @event: Delli Battle\n+*/\n+\n+var isPq = true;\n+var minPlayers = 1, maxPlayers = 2;\n+var minLevel = 120, maxLevel = 255;\n+var entryMap = 925010300;\n+var exitMap = 925010200;\n+var recruitMap = 925010200;\n+\n+var minMapId = 925010300;\n+var maxMapId = 925010300;\n+\n+var eventTime = 6;     // 6 minutes\n+\n+var lobbyRange = [0, 0];\n+\n+function init() {\n+        setEventRequirements();\n+}\n+\n+function setLobbyRange() {\n+        return lobbyRange;\n+}\n+\n+function setEventRequirements() {\n+        var reqStr = \"\";\n+        \n+        reqStr += \"\\r\\n    Number of players: \";\n+        if(maxPlayers - minPlayers >= 1) reqStr += minPlayers + \" ~ \" + maxPlayers;\n+        else reqStr += minPlayers;\n+        \n+        reqStr += \"\\r\\n    Level range: \";\n+        if(maxLevel - minLevel >= 1) reqStr += minLevel + \" ~ \" + maxLevel;\n+        else reqStr += minLevel;\n+        \n+        reqStr += \"\\r\\n    Time limit: \";\n+        reqStr += eventTime + \" minutes\";\n+        \n+        em.setProperty(\"party\", reqStr);\n+}\n+\n+function getEligibleParty(party) {      //selects, from the given party, the team that is allowed to attempt this event\n+        var eligible = [];\n+        var hasLeader = false;\n+        \n+        if(party.size() > 0) {\n+                var partyList = party.toArray();\n+\n+                for(var i = 0; i < party.size(); i++) {\n+                        var ch = partyList[i];\n+\n+                        if(ch.getMapId() == recruitMap && ch.getLevel() >= minLevel && ch.getLevel() <= maxLevel) {\n+                                if(ch.isLeader()) hasLeader = true;\n+                                eligible.push(ch);\n+                        }\n+                }\n+        }\n+        \n+        if(!(hasLeader && eligible.length >= minPlayers && eligible.length <= maxPlayers)) eligible = [];\n+        return eligible;\n+}\n+\n+function setup(level, lobbyid) {\n+        var eim = em.newInstance(\"Delli\" + lobbyid);\n+        eim.setProperty(\"level\", level);\n+        \n+        respawnStages(eim);\n+        eim.startEventTimer(eventTime * 60000);\n+        \n+        eim.getMapInstance(entryMap).toggleDrops();\n+        return eim;\n+}\n+\n+function afterSetup(eim) {}\n+\n+function respawnStages(eim) {    \n+        eim.getMapInstance(entryMap).instanceMapRespawn();\n+        eim.schedule(\"respawnStages\", 15 * 1000);\n+}\n+\n+function playerEntry(eim, player) {\n+        var map = eim.getMapInstance(entryMap);\n+        player.changeMap(map, map.getPortal(0));\n+}\n+\n+function scheduledTimeout(eim) {\n+        eim.getMapInstance(entryMap).killAllMonstersNotFriendly();\n+        eim.showClearEffect();\n+        clearPQ(eim);\n+}\n+\n+function playerUnregistered(eim, player) {}\n+\n+function playerExit(eim, player) {\n+        eim.unregisterPlayer(player);\n+        player.changeMap(exitMap, 0);\n+}\n+\n+function playerLeft(eim, player) {\n+        if(!eim.isEventCleared()) {\n+                playerExit(eim, player);\n+        }\n+}\n+\n+function changedMap(eim, player, mapid) {\n+        if (mapid < minMapId || mapid > maxMapId) {\n+                if (eim.isEventTeamLackingNow(true, minPlayers, player)) {\n+                        eim.unregisterPlayer(player);\n+                        end(eim);\n+                }\n+                else\n+                        eim.unregisterPlayer(player);\n+        }\n+}\n+\n+function changedLeader(eim, leader) {\n+        var mapid = leader.getMapId();\n+        if (!eim.isEventCleared() && (mapid < minMapId || mapid > maxMapId)) {\n+                end(eim);\n+        }\n+}\n+\n+function playerDead(eim, player) {}\n+\n+function playerRevive(eim, player) { // player presses ok on the death pop up.\n+        if (eim.isEventTeamLackingNow(true, minPlayers, player)) {\n+                eim.unregisterPlayer(player);\n+                end(eim);\n+        }\n+        else\n+                eim.unregisterPlayer(player);\n+}\n+\n+function playerDisconnected(eim, player) {\n+        if (eim.isEventTeamLackingNow(true, minPlayers, player)) {\n+                eim.unregisterPlayer(player);\n+                end(eim);\n+        }\n+        else\n+                eim.unregisterPlayer(player);\n+}\n+\n+function leftParty(eim, player) {\n+        if (eim.isEventTeamLackingNow(false, minPlayers, player)) {\n+                end(eim);\n+        }\n+        else\n+                playerLeft(eim, player);\n+}\n+\n+function disbandParty(eim) {\n+        if (!eim.isEventCleared()) {\n+                end(eim);\n+        }\n+}\n+\n+function monsterValue(eim, mobId) {\n+        return 1;\n+}\n+\n+function friendlyKilled(mob, eim) {\n+        if (mob.getId() == 9300162) {\n+                end(eim);\n+        }\n+}\n+\n+function end(eim) {\n+        var party = eim.getPlayers();\n+        for (var i = 0; i < party.size(); i++) {\n+                playerExit(eim, party.get(i));\n+        }\n+        eim.dispose();\n+}\n+\n+function clearPQ(eim) {\n+        eim.stopEventTimer();\n+        eim.setEventCleared();\n+}\n+\n+function monsterKilled(mob, eim) {}\n+\n+function allMonstersDead(eim) {}\n+\n+function cancelSchedule() {}\n+\n+function dispose(eim) {}"}, {"sha": "74a4c5e5249f96f428f23a28b95be9f4becbe4ac", "filename": "scripts/npc/1072006.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/1072006.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/1072006.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/1072006.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -25,7 +25,7 @@\n -- By ---------------------------------------------------------------------------------------------\n \tUnknown\n -- Version Info -----------------------------------------------------------------------------------\n-        1.2 - Clean up by Moogra\n+        1.2 - Cleanup by Moogra\n \t1.1 - Statement fix [Information]\n \t1.0 - First Version by Unknown\n ---------------------------------------------------------------------------------------------------"}, {"sha": "8595f29c3f21bd2071e9c29187ab3eef8e00ae4e", "filename": "scripts/npc/1090000.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/1090000.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/1090000.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/1090000.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -48,7 +48,7 @@ function start() {\n             cm.teachSkill(5121003, 0, 10, -1);\n             cm.forceCompleteQuest(6330);\n             \n-            cm.sendNext(\"Congratulations. You have managed to pass my test. I'll teach you a new skill called \\\"Super Transformation\\\".\\r\\n\\r\\n  #s5221003#    #b#q5221003##k\");\n+            cm.sendNext(\"Congratulations. You have managed to pass my test. I'll teach you a new skill called \\\"Super Transformation\\\".\\r\\n\\r\\n  #s5121003#    #b#q5121003##k\");\n         }\n     } else if (cm.isQuestStarted(6370)) {\n         if (cm.getEventInstance() != null) {"}, {"sha": "d845f6be0a6fd65864cdf44dd6d30bf9559f202d", "filename": "scripts/npc/1092008.js", "status": "modified", "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/1092008.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/1092008.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/1092008.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -38,8 +38,15 @@ function action(mode, type, selection) {\n                 else\n                         status--;\n     \n-                if(status == 0) {\n-                        cm.sendOk(\"Hey, do you have any business with me?\");\n+                if (status == 0) {\n+                        if (!cm.isQuestStarted(6410)) {\n+                                cm.sendOk(\"Hey, do you have any business with me?\");\n+                                cm.dispose();\n+                        } else {\n+                                cm.sendYesNo(\"Let's go save #r#p2095000##k?\");\n+                        }\n+                } else if (status == 1) {\n+                        cm.warp(925010000, 0);\n                         cm.dispose();\n                 }\n         }"}, {"sha": "9773ef4a134cc2e5cea3c2dfc2490dd6b7af012d", "filename": "scripts/npc/1092010.js", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/1092010.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/1092010.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/1092010.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -23,7 +23,9 @@\n -- JavaScript -----------------\n Jack - Nautilus' Port\n -- Created By --\n-Cody/Cyndicate, totally recoded by Moogra\n+    Cody (Cyndicate)\n+-- totally recoded By --\n+    Moogra\n -- Function --\n No specific function, useless text.\n -- GMS LIKE --"}, {"sha": "f0152d9b94ff9a55ff59e2386e419e7c1ac0147b", "filename": "scripts/npc/1092019.js", "status": "modified", "additions": 85, "deletions": 5, "changes": 90, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/1092019.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/1092019.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/1092019.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -4,6 +4,8 @@\n                        Matthias Butz <matze@odinms.de>\n                        Jan Christian Meyer <vimes@odinms.de>\n \n+    Copyleft (L) 2016 - 2018 RonanLana (HeavenMS)\n+\n     This program is free software: you can redistribute it and/or modify\n     it under the terms of the GNU Affero General Public License version 3\n     as published by the Free Software Foundation. You may not use, modify\n@@ -18,19 +20,97 @@\n     You should have received a copy of the GNU Affero General Public License\n     along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n-\n /*\n -- JavaScript -----------------\n Lord Jonathan - Nautilus' Port\n -- Created By --\n-Cody/Cyndicate\n--- Totally Recreated by Moogra--\n+    Cody (Cyndicate)\n+-- Totally Recreated by --\n+    Moogra\n+-- And Quest Script by --\n+    Ronan\n -- Function --\n No specific function, useless text.\n -- GMS LIKE --\n */\n+\n+var status;\n+\n+var seagullProgress;\n+var seagullIdx = -1;\n+var seagullQuestion = [\"One day, I went to the ocean and caught 62 Octopi for dinner. But then some kid came by and gave me 10 Octopi as a gift! How many Octopi do I have then, in total?\"];\n+var seagullAnswer = [\"72\"];\n+ \n function start() {\n-    cm.sendOk(\"Who are you talking to me? If you're just bored, go bother somebody else.\");\n-    cm.dispose();\n+        status = -1;\n+        action(1, 0, 0);\n }\n \n+function action(mode, type, selection) {\n+        if (mode == -1) {\n+                cm.dispose();\n+        } else {\n+                if (mode == 0 && type > 0) {\n+                        cm.dispose();\n+                        return;\n+                }\n+                if (mode == 1)\n+                        status++;\n+                else\n+                        status--;\n+    \n+                if (status == 0) {    // missing script for skill test found thanks to Lost(tm)\n+                        if (!cm.isQuestStarted(6400)) {\n+                                cm.sendOk(\"Who are you talking to me? If you're just bored, go bother somebody else.\");\n+                                cm.dispose();\n+                        } else {\n+                                seagullProgress = cm.getQuestProgress(6400, 0);\n+                            \n+                                if (seagullProgress == 0) {\n+                                        seagullIdx = Math.floor(Math.random() * seagullQuestion.length);\n+                                        \n+                                        // string visibility thanks to ProXAIMeRx & Glvelturall\n+                                        cm.sendNext(\"Ok then! I'll give you the first question now! You better be ready because this one's a hard one. Even the seagulls here think this one's pretty tough. It's a pretty difficult problem.\");\n+                                } else if (seagullProgress == 1) {\n+                                        cm.sendNext(\"Now~ Let's go onto the next question. This one is really difficult. I am going to have Bart help me on this one. You know Bart, right?\");\n+                                } else {\n+                                        cm.sendNext(\"Ohhhh! Now that was impressive! I considered my test quite difficult, and for you to pass that... you are indeed an integral member of the Pirate family, and a friend of seagulls. We are now bonded by the mutual friendship that will last a lifetime! And, most of all, friends are there to help you out when you are in dire straits. If you are in a state of emergency, call us seagulls.\");\n+                                }\n+                        }\n+                } else if (status == 1) {\n+                        if (seagullProgress == 0) {\n+                                cm.sendGetText(seagullQuestion[seagullIdx]);\n+                        } else if (seagullProgress == 1) {\n+                                cm.sendNextPrev(\"I'm going to send you to an empty room in The Nautilus. You will see 9 Barts there. Hahaha~ Are they twins? No, no, certainly not. I've used a bit of magic for this test of will.\");\n+                        } else {\n+                                cm.sendNextPrev(\"Notify us using the skill Air Strike, and we will be there to help you out, because that's what friends are for.\\r\\n\\r\\n  #s5221003#    #b#q5221003##k\");\n+                        }\n+                } else if (status == 2) {\n+                        if (seagullIdx > -1) {\n+                                var answer = cm.getText();\n+                                if (answer == seagullAnswer[seagullIdx]) {\n+                                        cm.sendNext(\"What! I can't believe how incredibly smart you are! Incredible! In the seagull world, that kind of intellingence would give you a Ph.D. and then some. You're really amazing... I can't believe it... I simply can't believe it!\");\n+                                        cm.setQuestProgress(6400, 0, 1);\n+                                        cm.dispose();\n+                                } else {\n+                                        cm.sendOk(\"Hmm, that's not quite how I recall it. Try again!\");\n+                                        cm.dispose();\n+                                }\n+                        } else if (seagullProgress != 2) {\n+                                cm.sendNextPrev(\"Anyway, only one of 9 Barts is the real Bart. You know that Pirates are known for the strength of their friendships and camaraderie with their fellow pirates. If you're a true pirate, you should be able to find your own mate with ease. Alright then, I'll send you to the room where Bart is.\");\n+                        } else {\n+                                cm.gainExp(1000000);\n+                                cm.teachSkill(5221003, 0, 10, -1);\n+                                cm.forceCompleteQuest(6400);\n+                                cm.dispose();\n+                        }\n+                } else if (status == 3) {\n+                        var em = cm.getEventManager(\"4jaerial\");\n+                        if(!em.startInstance(cm.getPlayer())) {\n+                                cm.sendOk(\"Another player is already challenging the test in this channel. Please try another channel, or wait for the current player to finish.\");\n+                        }\n+                        \n+                        cm.dispose();\n+                }\n+        }\n+}\n\\ No newline at end of file"}, {"sha": "386622528ae1a8e80065632170433ac684a08aa4", "filename": "scripts/npc/1094000.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/1094000.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/1094000.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/1094000.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -23,7 +23,7 @@\n -- JavaScript -----------------\n Bart - Nautilus' Port\n -- Created By --\n-Cody/Cyndicate\n+    Cody (Cyndicate)\n -- Function --\n No specific function, useless text.\n -- GMS LIKE --"}, {"sha": "153219bef8ad83f8c0a15d2dc3f1db2702c4a91b", "filename": "scripts/npc/1095000.js", "status": "added", "additions": 48, "deletions": 0, "changes": 48, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/1095000.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/1095000.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/1095000.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -0,0 +1,48 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+var status;\n+ \n+function start() {\n+        status = -1;\n+        action(1, 0, 0);\n+}\n+\n+function action(mode, type, selection) {\n+        if (mode == -1) {\n+                cm.dispose();\n+        } else {\n+                if (mode == 0 && type > 0) {\n+                        cm.dispose();\n+                        return;\n+                }\n+                if (mode == 1)\n+                        status++;\n+                else\n+                        status--;\n+    \n+                if(status == 0) {\n+                        cm.sendYesNo(\"#b#p2095000##k must be some way up this cliff, according to our latest reports... Or are you saying you want to #rleave here#k?\");\n+                } else if (status == 1) {\n+                        cm.warp(120000104);\n+                        cm.dispose();\n+                }\n+        }\n+}"}, {"sha": "9f829196193597c3dc58582a57dd4c554da53311", "filename": "scripts/npc/1100003.js", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/1100003.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/1100003.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/1100003.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -4,8 +4,7 @@\n \n \t1100003 Kiriru (To Victoria Island From Ereve)\n \n--------Credits:-------------------------------------------------------------------\n-\t*MapleSanta \n+        Credits to: MapleSanta \n ----------------------------------------------------------------------------------\n **/\n "}, {"sha": "7a7ef2c9c061cb8401c6fcbb600b3de7da643d47", "filename": "scripts/npc/1100004.js", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/1100004.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/1100004.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/1100004.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -4,8 +4,7 @@\n \n \t1100004 Kiru (To Orbis)\n \n--------Credits:-------------------------------------------------------------------\n-\t*MapleSanta \n+        Credits to: MapleSanta \n ----------------------------------------------------------------------------------\n **/\n var menu = new Array(\"Orbis\");"}, {"sha": "be67a4de2e7120ef9a2062850c5da40bf1669a6e", "filename": "scripts/npc/1100005.js", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/1100005.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/1100005.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/1100005.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -4,8 +4,7 @@\n \n \t1100005 Kiriru (On boat between Ereve and Victoria Island)\n \n--------Credits:-------------------------------------------------------------------\n-\t*MapleSanta \n+        Credits to: MapleSanta \n ----------------------------------------------------------------------------------\n **/\n "}, {"sha": "83b8483296b0972e482440c29f6e743d5e29e440", "filename": "scripts/npc/1100006.js", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/1100006.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/1100006.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/1100006.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -4,8 +4,7 @@\n \n \t1100006 Kiru (On boat between Ereve and Orbis)\n \n--------Credits:-------------------------------------------------------------------\n-\t*MapleSanta \n+        Credits to: MapleSanta \n ----------------------------------------------------------------------------------\n **/\n "}, {"sha": "b46180efd95247a90bdc939e1e7c143f220f3dd5", "filename": "scripts/npc/1100007.js", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/1100007.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/1100007.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/1100007.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -4,8 +4,7 @@\n \n \t1100007 Kiriru (Victoria Island Station to Ereve)\n \n--------Credits:-------------------------------------------------------------------\n-\t*MapleSanta \n+        Credits to: MapleSanta \n ----------------------------------------------------------------------------------\n **/\n "}, {"sha": "e9aa694db322bf903331c4d4a720182de4549441", "filename": "scripts/npc/1100008.js", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/1100008.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/1100008.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/1100008.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -4,8 +4,7 @@\n \n \t1100008 Kiru (Orbis Station)\n \n--------Credits:-------------------------------------------------------------------\n-\t*MapleSanta \n+        Credits to: MapleSanta \n ----------------------------------------------------------------------------------\n **/\n "}, {"sha": "5c283fbcd609f2a9e750f615049169c1a9281570", "filename": "scripts/npc/1200003.js", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/1200003.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/1200003.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/1200003.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -4,8 +4,7 @@\n \n \t1200003 Puro\n \n--------Credits:-------------------------------------------------------------------\n-\t*MapleSanta \n+        Credits to: MapleSanta \n ----------------------------------------------------------------------------------\n **/\n "}, {"sha": "3a07a5354ffe793ff77845820bd6cfb32ada338b", "filename": "scripts/npc/1200004.js", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/1200004.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/1200004.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/1200004.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -4,8 +4,7 @@\n \n \t1200004 Puro\n \n--------Credits:-------------------------------------------------------------------\n-\t*MapleSanta \n+        Credits to: MapleSanta \n ----------------------------------------------------------------------------------\n **/\n "}, {"sha": "14d96300476bf82c7c4811f9aa96fc135cc80739", "filename": "scripts/npc/1200005.js", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/1200005.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/1200005.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/1200005.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -4,8 +4,7 @@\n \n \t1200005 Puro\n \n--------Credits:-------------------------------------------------------------------\n-\t*MapleSanta \n+        Credits to: MapleSanta \n ----------------------------------------------------------------------------------\n **/\n "}, {"sha": "179d9c7f600ed0c58fea8f2258e8588d33ac38a1", "filename": "scripts/npc/1200006.js", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/1200006.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/1200006.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/1200006.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -4,8 +4,7 @@\n \n \t1200006 Puro\n \n--------Credits:-------------------------------------------------------------------\n-\t*MapleSanta \n+        Credits to: MapleSanta \n ----------------------------------------------------------------------------------\n **/\n "}, {"sha": "24d434b755d67f5e9fd67e26887b4d1aedc93cf5", "filename": "scripts/npc/2012014.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/2012014.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/2012014.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/2012014.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -25,7 +25,7 @@\n -- By ---------------------------------------------------------------------------------------------\n \tUnknown\n -- Version Info -----------------------------------------------------------------------------------\n-    1.2 - Now Official method (action(x,0,0) is weak) by Moogra.\n+        1.2 - Now Official method (action(x,0,0) is weak) by Moogra.\n \t1.1 - Official Text and Method [Information]\n \t1.0 - First Version by Unknown\n ---------------------------------------------------------------------------------------------------"}, {"sha": "7a5ba4440c8f2b634a2933a45c4ddba46172ef64", "filename": "scripts/npc/2020005.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/2020005.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/2020005.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/2020005.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -23,7 +23,7 @@\n -- Odin JavaScript --------------------------------------------------------------------------------\n \tAlcaster - El Nath Market (211000100)\n -- By ---------------------------------------------------------------------------------------------\n-\tUnknown/Information/xQuasar\n+\tUnknown & Information & xQuasar\n -- Version Info -----------------------------------------------------------------------------------\n \t1.3 - Fixed up completely [xQuasar]\n \t1.2 - Add a missing text part [Information]"}, {"sha": "ae98e3e4820ed15dafbcede17f65716c65cff579", "filename": "scripts/npc/2030013_old.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/2030013_old.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/2030013_old.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/2030013_old.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -20,7 +20,7 @@\n  */\n \n /* \n- * @Author Stereo, xQuasar, <<XkelvinchiaX@Kelvin(For make it Fully Working.)>>\n+ * @Author Stereo, xQuasar, XkelvinchiaX (Kelvin) - For make it Fully Working.\n  * \n  * Adobis - El Nath: Entrance to Zakum Altar (211042400)\n  * "}, {"sha": "16724ce25747f7ceb880b35afaa70127ac0f9926", "filename": "scripts/npc/2040030.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/2040030.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/2040030.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/2040030.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -1,4 +1,4 @@\n-/* Author: aaroncsn <(MapleSea Like)(Need to add creation of minigame)>\n+/* Author: aaroncsn - MapleSea Like, Need to add creation of minigame\n \tNPC Name: \t\tWisp\n \tMap(s): \t\tLudibrium: Eos Tower Entrance(220000400)\n \tDescription: \t\tPet Master"}, {"sha": "a57b3528549b66b391244094c113e108de122d76", "filename": "scripts/npc/2043000.js", "status": "added", "additions": 52, "deletions": 0, "changes": 52, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/2043000.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/2043000.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/2043000.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -0,0 +1,52 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+/* Papulatus\n+\tOrigin of Clock Tower (922020300)\n+\tTime Leap quest NPC.\n+ */\n+\n+var status;\n+ \n+function start() {  // thanks iPunchEm for NPC visibility\n+        status = -1;\n+        action(1, 0, 0);\n+}\n+\n+function action(mode, type, selection) {\n+        if (mode == -1) {\n+                cm.dispose();\n+        } else {\n+                if (mode == 0 && type > 0) {\n+                        cm.dispose();\n+                        return;\n+                }\n+                if (mode == 1)\n+                        status++;\n+                else\n+                        status--;\n+    \n+                if(status == 0) {\n+                        cm.sendNext(\"You don't belong to this world... Return now.\");\n+                } else if(status == 1) {\n+                        cm.warp(220080000);\n+                        cm.dispose();\n+                }\n+        }\n+}\n\\ No newline at end of file"}, {"sha": "8d0366bd4b07e8ebd05e9eaa80e67fe455cc03a4", "filename": "scripts/npc/2095000.js", "status": "added", "additions": 96, "deletions": 0, "changes": 96, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/2095000.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/2095000.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/2095000.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -0,0 +1,96 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+/* Delli\n+\tLooking for Delli 3 (925010200)\n+\tHypnotize skill quest NPC.\n+ */\n+\n+var status;\n+ \n+function start() {\n+        status = -1;\n+        action(1, 0, 0);\n+}\n+\n+function action(mode, type, selection) {\n+        if (mode == -1) {\n+                cm.dispose();\n+        } else {\n+                if (mode == 0 && type > 0) {\n+                        cm.dispose();\n+                        return;\n+                }\n+                if (mode == 1)\n+                        status++;\n+                else\n+                        status--;\n+    \n+                if (status == 0) {\n+                        if (cm.getMapId() != 925010400) {\n+                                em = cm.getEventManager(\"DelliBattle\");\n+                                if(em == null) {\n+                                        cm.sendOk(\"The Delli Battle has encountered an error.\");\n+                                        cm.dispose();\n+                                        return;\n+                                } else if(cm.isUsingOldPqNpcStyle()) {\n+                                        action(1, 0, 0);\n+                                        return;\n+                                }\n+\n+                                cm.sendSimple(\"#e#b<Party Quest: Save Delli>\\r\\n#k#n\" + em.getProperty(\"party\") + \"\\r\\n\\r\\nAh, #r#p1095000##k sent you here? Is she worried about me? ... I'm terribly sorry to hear that, but I can't really go back just yet, some monsters are under the Black Mage's influence, and it's up to me to liberate them! ... It seems you're not going to accept that either, huh? Would you like to collaborate with party members to help me? If so, please have your #bparty leader#k talk to me.#b\\r\\n#L0#I want to participate in the party quest.\\r\\n#L1#I want to find party members.\\r\\n#L2#I would like to hear more details.\");\n+                        } else {\n+                                cm.sendYesNo(\"The mission succeeded, thanks for escorting me! I can lead you to #b#m120000104##k, are you ready?\");\n+                        }\n+                } else if (status == 1) {\n+                        if (cm.getMapId() != 925010400) {\n+                                if (selection == 0) {\n+                                        if (cm.getParty() == null) {\n+                                                cm.sendOk(\"You can participate in the party quest only if you are in a party.\");\n+                                                cm.dispose();\n+                                        } else if(!cm.isLeader()) {\n+                                                cm.sendOk(\"Your party leader must talk to me to start this party quest.\");\n+                                                cm.dispose();\n+                                        } else {\n+                                                var eli = em.getEligibleParty(cm.getParty());\n+                                                if(eli.size() > 0) {\n+                                                        if(!em.startInstance(cm.getParty(), cm.getPlayer().getMap(), 1)) {\n+                                                                cm.sendOk(\"Another party has already entered the #rParty Quest#k in this channel. Please try another channel, or wait for the current party to finish.\");\n+                                                        }\n+                                                }\n+                                                else {\n+                                                        cm.sendOk(\"You cannot start this party quest yet, because either your party is not in the range size, some of your party members are not eligible to attempt it or they are not in this map. If you're having trouble finding party members, try Party Search.\");\n+                                                }\n+\n+                                                cm.dispose();\n+                                        }\n+                                } else if (selection == 1) {\n+                                        cm.sendOk(\"Try using a Super Megaphone or asking your buddies or guild to join!\");\n+                                        cm.dispose();\n+                                } else {\n+                                        cm.sendOk(\"#e#b<Party Quest: Save Delli>#k#n\\r\\n A ambush is under way! I must stand on the field for around 6 minutes to complete the liberation, please protect me during that time so that my mission is completed.\");\n+                                        cm.dispose();\n+                                }\n+                        } else {\n+                                cm.warp(120000104);\n+                                cm.dispose();\n+                        }\n+                }\n+        }\n+}\n\\ No newline at end of file"}, {"sha": "3fc087cbfa7f7aaacc78fe280289548ffccc7661", "filename": "scripts/npc/2100007.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/2100007.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/2100007.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/2100007.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -1,4 +1,4 @@\n-/* Author: aaroncsn <(MapleSea Like)(Incomplete- Needs skin id)>\n+/* Author: aaroncsn - MapleSea Like, Incomplete, Needs skin id\n \tNPC Name: \t\tLaila\n \tMap(s): \t\tThe Burning Road: Ariant(2600000000)\n \tDescription: \tSkin Care Specialist"}, {"sha": "09beb06a21bd85965861f69a3f2d8f858a93093d", "filename": "scripts/npc/2131000.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/2131000.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/2131000.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/2131000.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -1,4 +1,4 @@\n-/* Author: aaroncsn <(MapleSea Like)(Incomplete)>\n+/* Author: aaroncsn - MapleSea Like, Incomplete\n \tNPC Name: \t\tAthena Pierce\n \tMap(s): \t\tAltair Camp: Conference Hall(300000010)\n \tDescription: \t\tUnknown"}, {"sha": "9d32980e37d0c00d979832c1a6a432f5f597231d", "filename": "scripts/npc/2131002.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/2131002.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/2131002.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/2131002.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -1,4 +1,4 @@\n-/* Author: aaroncsn <(MapleSea Like)(Incomplete)>\n+/* Author: aaroncsn - MapleSea Like, Incomplete\n \tNPC Name: \t\tEuryth\n \tMap(s): \t\tElin Forest:Altair Camp(300000000)\n \tDescription: \t\tUnknown"}, {"sha": "d6a5376d15db7ec85c368d59d93bc09f718626af", "filename": "scripts/npc/2132000.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/2132000.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/2132000.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/2132000.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -1,4 +1,4 @@\n-/* Author: aaroncsn <(MapleSea Like)(Incomplete)>\n+/* Author: aaroncsn - MapleSea Like, Incomplete\n \tNPC Name: \t\tKanderun\n \tMap(s): \t\tElin Forest:Entrance to Rocky Mountain(300010400)\n \tDescription: \t\tUnknown"}, {"sha": "55eaf9a2788bbbe369b59480679a3db52a85e48d", "filename": "scripts/npc/9000001.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/9000001.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/9000001.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/9000001.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -19,7 +19,7 @@\n     You should have received a copy of the GNU Affero General Public License\n     along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n-/* Edited by: kevintjuh93\n+/* Credits to: kevintjuh93\n     NPC Name:         Jean\n     Map(s):         Victoria Road : Lith Harbour (104000000)\n     Description:         Event Assistant"}, {"sha": "139350063716140a494159bcc848a61e46c32075", "filename": "scripts/npc/9030000.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/9030000.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/9030000.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/9030000.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -20,7 +20,7 @@\n     along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n /* Fredrick NPC (9030000)\n- * By kevintjuh93\n+ * @author kevintjuh93\n  */\n \n var status;"}, {"sha": "2a3725336195014bfcfdff4514af480e138822d8", "filename": "scripts/npc/9201006.js", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/9201006.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/9201006.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/9201006.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -23,8 +23,9 @@\n \tDebbie\n -- By ---------------------------------------------------------------------------------------------\n \tAngel (get31720 ragezone)\n--- Extra Info -------------------------------------------------------------------------------------\n-\tFixed by  [happydud3] & [XotiCraze]\n+-- Version Info -----------------------------------------------------------------------------------\n+\t1.0 - First Version by Angel\n+        2.0 - Second Version by happydud3 & XotiCraze\n ---------------------------------------------------------------------------------------------------\n **/\n "}, {"sha": "0e879780e8e8bff5fa7a11286b122e613435e934", "filename": "scripts/npc/9201007.js", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/9201007.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/9201007.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/9201007.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -23,10 +23,10 @@\n \tAssistant Nancy\n -- By ---------------------------------------------------------------------------------------------\n \tAngel (get31720 ragezone)\n--- Extra Info -------------------------------------------------------------------------------------\n-\tFixed by  [happydud3] & [XotiCraze]\n--- Content Improved by ----------------------------------------------------------------------------\n-        RonanLana (HeavenMS)\n+-- Version Info -----------------------------------------------------------------------------------\n+\t1.0 - First Version by Angel\n+        2.0 - Second Version by happydud3 & XotiCraze\n+        3.0 - Third Version by RonanLana (HeavenMS)\n ---------------------------------------------------------------------------------------------------\n **/\n "}, {"sha": "601d7489be6468c912b9509f68bc31cf7036e113", "filename": "scripts/npc/9201009.js", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/9201009.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/9201009.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/9201009.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -23,10 +23,10 @@\n \tAssistant Nancy\n -- By ---------------------------------------------------------------------------------------------\n \tAngel (get31720 ragezone)\n--- Extra Info -------------------------------------------------------------------------------------\n-\tFixed by  [happydud3] & [XotiCraze]\n--- Content Improved by ----------------------------------------------------------------------------\n-        RonanLana (HeavenMS)\n+-- Version Info -----------------------------------------------------------------------------------\n+\t1.0 - First Version by Angel\n+        2.0 - Second Version by happydud3 & XotiCraze\n+        3.0 - Third Version by RonanLana (HeavenMS)\n ---------------------------------------------------------------------------------------------------\n **/\n "}, {"sha": "b372bccd0c0e560a4a599f0a66890269d9880d24", "filename": "scripts/npc/9201010.js", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/9201010.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/9201010.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/9201010.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -23,8 +23,10 @@\n \tAssistant Travis\n -- By ---------------------------------------------------------------------------------------------\n \tAngel (get31720 ragezone)\n--- Extra Info -------------------------------------------------------------------------------------\n-\tFixed by  [happydud3] & [XotiCraze]\n+-- Version Info -----------------------------------------------------------------------------------\n+\t1.0 - First Version by Angel\n+        2.0 - Second Version by happydud3 & XotiCraze\n+        3.0 - Third Version by RonanLana (HeavenMS)\n ---------------------------------------------------------------------------------------------------\n **/\n "}, {"sha": "6713b15fcfbc7dd5e8ea7ad18fd58e0cd5ca10f7", "filename": "scripts/npc/9201014.js", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/9201014.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/9201014.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/9201014.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -23,9 +23,10 @@\n \tPila Present\n -- By ---------------------------------------------------------------------------------------------\n \tAngel (get31720 ragezone)\n--- Extra Info -------------------------------------------------------------------------------------\n-\tFixed by  [happydud3] & [XotiCraze]\n-        Improved by [RonanLana]\n+-- Version Info -----------------------------------------------------------------------------------\n+\t1.0 - First Version by Angel\n+        2.0 - Second Version by happydud3 & XotiCraze\n+        3.0 - Third Version by RonanLana (HeavenMS)\n ---------------------------------------------------------------------------------------------------\n **/\n "}, {"sha": "3ced465fdb671108e970e4c483296783e7bc5e85", "filename": "scripts/npc/9201096.js", "status": "modified", "additions": 21, "deletions": 5, "changes": 26, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/9201096.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/9201096.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/9201096.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -1,9 +1,25 @@\n-/* Jack\n-        Refining NPC: \n-\t* ITEMMAKE\n-        * \n-        * By RonanLana\n+/*\n+    This file is part of the HeavenMS MapleStory Server\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n+/* Jack - Refining NPC\n+\t@author RonanLana\n+ */\n \n var status = 0;\n var selectedType = -1;"}, {"sha": "60263714daf90ff8e0734df28a5f3be5dbc4a484", "filename": "scripts/npc/9270023.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/9270023.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/9270023.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/9270023.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -21,7 +21,7 @@\n */\n /* \tNoel\n \tSingapore Random Face Changer\n-\tCredits to aaron and cody\n+\t@Author AAron (aaroncsn), Cody\n \tSide note by aaron [If there is something wrong PM me on fMS]\n */\n var status = 0;"}, {"sha": "0ede90abf7d653e4906de0d0cd18a75f6b95e752", "filename": "scripts/npc/9270024.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/9270024.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/9270024.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/9270024.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -21,7 +21,7 @@\n */\n /* \tKelvin\n \tSingaPore VIP Face changer\n-\tMade by aaron and cody \n+\t@Author AAron (aaroncsn), Cody\n */\n var status = 0;\n var beauty = 0;"}, {"sha": "f997c1ea79c510e16de04a5764cf69d2bcb6b51b", "filename": "scripts/npc/9270036.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/9270036.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/9270036.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/9270036.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -21,7 +21,7 @@\n */\n /*     Eric\n     Singapore VIP Hair/Color Changer\n-    MADE BY AAron and Cody from the FlowsionMS Forums\n+    @Author AAron, Cody (FlowsionMS) Forums\n */\n var status = 0;\n var beauty = 0;"}, {"sha": "2c26b2bd5f11d22596395be0a8ec4913a7f9b752", "filename": "scripts/npc/9270037.js", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/9270037.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/9270037.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/9270037.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -21,7 +21,8 @@\n */\n /* \tJimmy\n \tSinga Random Hair/Color Changer\n-\tCredits to Cody and AAron from FlowsionMS\n+\t@Author Cody (FlowsionMS)\n+        @Author AAron (FlowsionMS)\n  */\n var status = 0;\n var beauty = 0;"}, {"sha": "04da15ab8907e8ce33696515efda98e8cc1b807f", "filename": "scripts/npc/credits.js", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/credits.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/npc/credits.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/credits.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -98,6 +98,7 @@ function writeServerStaff_Contributors() {\n         addPerson(\"xQuasar\", \"Contributor\");\n         addPerson(\"Xterminator\", \"Contributor\");\n         addPerson(\"XoticStory\", \"Contributor\");\n+        addPerson(\"Masterrulax\", \"Contributor\");\n }\n \n function writeAllServerStaffs() {"}, {"sha": "20c64ee7bb3601b568253b4fe40968fba93d7887", "filename": "scripts/portal/Populatus00.js", "status": "modified", "additions": 24, "deletions": 18, "changes": 42, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/portal/Populatus00.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/portal/Populatus00.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/Populatus00.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -23,28 +23,34 @@\n /* @author RonanLana */\n \n function enter(pi) {\n-    var em = pi.getEventManager(\"PapulatusBattle\");\n+    if (!((pi.isQuestStarted(6361) && pi.haveItem(4031870, 1)) || (pi.isQuestCompleted(6361) && !pi.isQuestCompleted(6363)))) {\n+        var em = pi.getEventManager(\"PapulatusBattle\");\n \n-    if (pi.getParty() == null) {\n-        pi.playerMessage(5, \"You are currently not in a party, create one to attempt the boss.\");\n-        return false;\n-    } else if(!pi.isLeader()) {\n-        pi.playerMessage(5, \"Your party leader must enter the portal to start the battle.\");\n-        return false;\n-    } else {\n-        var eli = em.getEligibleParty(pi.getParty());\n-        if(eli.size() > 0) {\n-            if(!em.startInstance(pi.getParty(), pi.getPlayer().getMap(), 1)) {\n-                pi.playerMessage(5, \"The battle against the boss has already begun, so you may not enter this place yet.\");\n+        if (pi.getParty() == null) {\n+            pi.playerMessage(5, \"You are currently not in a party, create one to attempt the boss.\");\n+            return false;\n+        } else if(!pi.isLeader()) {\n+            pi.playerMessage(5, \"Your party leader must enter the portal to start the battle.\");\n+            return false;\n+        } else {\n+            var eli = em.getEligibleParty(pi.getParty());\n+            if(eli.size() > 0) {\n+                if(!em.startInstance(pi.getParty(), pi.getPlayer().getMap(), 1)) {\n+                    pi.playerMessage(5, \"The battle against the boss has already begun, so you may not enter this place yet.\");\n+                    return false;\n+                }\n+            }\n+            else {  //this should never appear\n+                pi.playerMessage(5, \"You cannot start this battle yet, because either your party is not in the range size, some of your party members are not eligible to attempt it or they are not in this map. If you're having trouble finding party members, try Party Search.\");\n                 return false;\n             }\n-        }\n-        else {  //this should never appear\n-            pi.playerMessage(5, \"You cannot start this battle yet, because either your party is not in the range size, some of your party members are not eligible to attempt it or they are not in this map. If you're having trouble finding party members, try Party Search.\");\n-            return false;\n-        }\n \n+            pi.playPortalSound();\n+            return true;\n+        }\n+    } else {\n         pi.playPortalSound();\n+        pi.warp(922020300);\n         return true;\n-    }    \n+    }\n }\n\\ No newline at end of file"}, {"sha": "0378679430c741a97508869bb6ef34bdfcc421c5", "filename": "scripts/portal/aranTutorArrow0.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/portal/aranTutorArrow0.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/portal/aranTutorArrow0.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/aranTutorArrow0.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -20,7 +20,7 @@\n     along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n /*\n-By kevintjuh93\n+@author kevintjuh93\n */\n function enter(pi) { \n     pi.blockPortal();\t"}, {"sha": "6385f645d52693d5b30bb2ba46099f5730ffcf40", "filename": "scripts/portal/aranTutorArrow1.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/portal/aranTutorArrow1.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/portal/aranTutorArrow1.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/aranTutorArrow1.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -20,7 +20,7 @@\n     along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n /*\n-By kevintjuh93\n+@author kevintjuh93\n */\n function enter(pi) {\n     pi.blockPortal();\t"}, {"sha": "11dc2e2fa50e93e974617720191aabf112ebfda7", "filename": "scripts/portal/aranTutorArrow2.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/portal/aranTutorArrow2.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/portal/aranTutorArrow2.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/aranTutorArrow2.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -20,7 +20,7 @@\n     along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n /*\n-By kevintjuh93\n+@author kevintjuh93\n */\n function enter(pi) { \n     pi.blockPortal();\t"}, {"sha": "e4e7fdd5ab1a9cd2049b93b95fabf3869f50e25d", "filename": "scripts/portal/aranTutorArrow3.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/portal/aranTutorArrow3.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/portal/aranTutorArrow3.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/aranTutorArrow3.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -20,7 +20,7 @@\n     along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n /*\n-By kevintjuh93\n+@author kevintjuh93\n */\n function enter(pi) { \n     pi.blockPortal();\t"}, {"sha": "021057f72621440e438f92ac806228537850fb7a", "filename": "scripts/portal/aranTutorGuide0.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/portal/aranTutorGuide0.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/portal/aranTutorGuide0.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/aranTutorGuide0.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -20,7 +20,7 @@\n     along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n /*\n-By kevintjuh93\n+@author kevintjuh93\n */\n function enter(pi) { \n \tpi.blockPortal();"}, {"sha": "c674dd9f2b5bff6e5bfb4e8f59fcca8c34b6e0a2", "filename": "scripts/portal/aranTutorGuide1.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/portal/aranTutorGuide1.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/portal/aranTutorGuide1.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/aranTutorGuide1.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -20,7 +20,7 @@\n     along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n /*\n-By kevintjuh93\n+@author kevintjuh93\n */\n function enter(pi) { \n \tpi.blockPortal();  "}, {"sha": "5e8c1578537b6710a05b14b859072f7caaa591b4", "filename": "scripts/portal/aranTutorGuide2.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/portal/aranTutorGuide2.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/portal/aranTutorGuide2.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/aranTutorGuide2.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -20,7 +20,7 @@\n     along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n /*\n-By kevintjuh93\n+@author kevintjuh93\n */\n function enter(pi) { \n     \tpi.blockPortal();"}, {"sha": "a38f0e21918729e7c6be6a2de22573095cfb008b", "filename": "scripts/portal/aranTutorLost.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/portal/aranTutorLost.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/portal/aranTutorLost.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/aranTutorLost.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -20,7 +20,7 @@\n     along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n /*\n-By kevintjuh93\n+@author kevintjuh93\n */\n function enter(pi) {\n \tpi.blockPortal();"}, {"sha": "d214d14d086dc5e5ea0500df0892deb2ae4c3a9e", "filename": "scripts/portal/aranTutorMono0.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/portal/aranTutorMono0.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/portal/aranTutorMono0.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/aranTutorMono0.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -20,7 +20,7 @@\n     along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n /*\n-By kevintjuh93\n+@author kevintjuh93\n */\n function enter(pi) { \n \tpi.blockPortal();"}, {"sha": "a8509e958122f2f1452b2eadabcc7c068b10d260", "filename": "scripts/portal/aranTutorMono1.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/portal/aranTutorMono1.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/portal/aranTutorMono1.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/aranTutorMono1.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -20,7 +20,7 @@\n     along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n /*\n-By kevintjuh93\n+@author kevintjuh93\n */\n function enter(pi) { \n \tpi.blockPortal();"}, {"sha": "2b06feae4b61eefebb27246519ffb9ec4da9fbb3", "filename": "scripts/portal/aranTutorMono2.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/portal/aranTutorMono2.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/portal/aranTutorMono2.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/aranTutorMono2.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -20,7 +20,7 @@\n     along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n /*\n-By kevintjuh93\n+@author kevintjuh93\n */\n function enter(pi) { \n \tpi.blockPortal();"}, {"sha": "cefbdfdd90d3e0dec48128381634fa4cdf31dcae", "filename": "scripts/portal/aranTutorMono3.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/portal/aranTutorMono3.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/portal/aranTutorMono3.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/aranTutorMono3.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -20,7 +20,7 @@\n     along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n /*\n-By kevintjuh93\n+@author kevintjuh93\n */\n function enter(pi) {   \n \tpi.blockPortal();"}, {"sha": "73c5a7dd019f33b2c7b8153c228e1792e1bf893d", "filename": "scripts/portal/enterMagiclibrar.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/portal/enterMagiclibrar.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/portal/enterMagiclibrar.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/enterMagiclibrar.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -16,7 +16,7 @@\n     You should have received a copy of the GNU Affero General Public License\n     along with this program.  If not, see <http://www.gnu.org/licenses/>.\n \n-    Edited by: Kevin\n+    Credits to: Kevin\n */\n function enter(pi) {\n     if(pi.isQuestStarted(20718)){"}, {"sha": "654801f495a6091927a86c271528b0a863cf0256", "filename": "scripts/portal/glTutoMsg0.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/portal/glTutoMsg0.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/portal/glTutoMsg0.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/glTutoMsg0.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -20,7 +20,7 @@\n     along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n /*\n-By kevintjuh93\n+@author kevintjuh93\n */\n function enter(pi) { \n \tpi.showInstruction(\"Once you leave this area you won't be able to return.\", 150, 5);"}, {"sha": "2ebd0275ce9d5297ea32718e7a4e00fd5187468b", "filename": "scripts/portal/infoMinimap.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/portal/infoMinimap.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/portal/infoMinimap.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/infoMinimap.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -20,7 +20,7 @@\n     along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n /*\n-By kevintjuh93\n+@author kevintjuh93\n */\n function enter(pi) { \n \tif (pi.isQuestStarted(1031)) "}, {"sha": "04698dba2008199707c547b06f4db4d5bd118915", "filename": "scripts/portal/infoPickup.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/portal/infoPickup.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/portal/infoPickup.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/infoPickup.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -20,7 +20,7 @@\n     along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n /*\n-By kevintjuh93\n+@author kevintjuh93\n */\n function enter(pi) { \n \tif (pi.isQuestStarted(1035))"}, {"sha": "5796725da249ebe1ac1a1f4c5a91d13a97226a14", "filename": "scripts/portal/infoReactor.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/portal/infoReactor.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/portal/infoReactor.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/infoReactor.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -20,7 +20,7 @@\n     along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n /*\n-By kevintjuh93\n+@author kevintjuh93\n */\n function enter(pi) { \n \tif (pi.isQuestCompleted(1008))"}, {"sha": "c9c09ab07398ca26293edfc98be20c384584bea4", "filename": "scripts/portal/infoSkill.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/portal/infoSkill.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/portal/infoSkill.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/infoSkill.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -20,7 +20,7 @@\n     along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n /*\n-By kevintjuh93\n+@author kevintjuh93\n */\n function enter(pi) { \n \tif (pi.isQuestCompleted(1035))"}, {"sha": "39007482c2524b6ff53c54ab3b265405ce15f0be", "filename": "scripts/portal/s4mind_end.js", "status": "added", "additions": 33, "deletions": 0, "changes": 33, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/portal/s4mind_end.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/portal/s4mind_end.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/s4mind_end.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -0,0 +1,33 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+function enter(pi) {\n+    if (!pi.getEventInstance().isEventCleared()) {\n+        pi.message(\"You have to clear this mission before entering this portal.\");\n+        return false;\n+    } else {\n+        if (pi.isQuestStarted(6410)) {\n+            pi.setQuestProgress(6410, 0, 1);\n+        }\n+        \n+        pi.playPortalSound();\n+        pi.warp(925010400);\n+        return true;\n+    }\n+}\n\\ No newline at end of file"}, {"sha": "0400da3c62e2e8fe7ce0cbf332763722639175be", "filename": "scripts/portal/s4ship_out.js", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/portal/s4ship_out.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/portal/s4ship_out.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/s4ship_out.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -23,9 +23,11 @@ function enter(pi) {\n         pi.message(\"You have to wait one minute before you can leave this place.\");\n         return false;\n     } else if (exit == 2) {\n+        pi.playPortalSound();\n         pi.warp(912010200);\n         return true;\n     } else {\n+        pi.playPortalSound();\n         pi.warp(120000101);\n         return true;\n     }"}, {"sha": "0400da3c62e2e8fe7ce0cbf332763722639175be", "filename": "scripts/portal/s4super_out.js", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/portal/s4super_out.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/portal/s4super_out.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/s4super_out.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -23,9 +23,11 @@ function enter(pi) {\n         pi.message(\"You have to wait one minute before you can leave this place.\");\n         return false;\n     } else if (exit == 2) {\n+        pi.playPortalSound();\n         pi.warp(912010200);\n         return true;\n     } else {\n+        pi.playPortalSound();\n         pi.warp(120000101);\n         return true;\n     }"}, {"sha": "67c8cc0408ef4a63280b761cdc0c0e334aeee7a1", "filename": "scripts/quest/10940.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/quest/10940.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/quest/10940.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/quest/10940.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -1,4 +1,4 @@\n-//credits to kevintjuh93\n+//@author kevintjuh93\n \n var status = -1;\n "}, {"sha": "059c4b8279380a2b0d5f0616c2ec3f8cd60b49d9", "filename": "scripts/quest/20710.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/quest/20710.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/quest/20710.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/quest/20710.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -1,5 +1,5 @@\n /*\n-\tAuthor: DietStory dev team\n+\tAuthor: DietStory v1.02 dev team\n \tNPC: Matthias\n \tQuest: Hidden Inside the Trash Can\n */"}, {"sha": "7aa7e5d5f9c59228b9a29a4d4f11c7a2188596d4", "filename": "scripts/quest/2230.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/quest/2230.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/quest/2230.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/quest/2230.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -76,7 +76,7 @@ function end(mode, type, selection) {\n         } else if (status == 5) {\n             qm.sendYesNo(\"Now do you understand? Every action comes with consequences, and pets are no exception. The egg of the snail shall hatch soon.\");\n         } else if (status == 6) {\n-            qm.gainItem(5000054, 1, false, true, 5 * 60 * 60 * 1000);  // rune snail (5hrs)\n+            qm.gainItem(5000054, 1, false, true, 5 * 60 * 60 * 1000);  // rune snail (5hrs), missing expiration time detected thanks to cljnilsson\n             \n             qm.gainItem(4032086, -1); // Mysterious Egg * -1\n             qm.forceCompleteQuest();"}, {"sha": "9efd61d7f4a8a52c833e5e2d53b0dfcef5105bda", "filename": "scripts/quest/2300.js", "status": "modified", "additions": 88, "deletions": 49, "changes": 137, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/quest/2300.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/quest/2300.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/quest/2300.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -4,62 +4,101 @@\n \tDescription: \tQuest -  Kingdom of Mushroom in Danger\n =============================================================\n Version 1.0 - Script Done.(17/7/2010)\n+Version 2.0 - Script Reworked by Ronan.(16/11/2018)\n =============================================================\n */\n \n var status = -1;\n \n function start(mode, type, selection) {\n-    status++;\n-\tif (mode != 1) {\n-\t    if(type == 1 && mode == 0)\n-\t\t    status -= 2;\n-\t\telse{\n-\t\t\tif(status == 0){\n-\t\t\t\tqm.sendOk(\"Really? It's an urgent matter, so if you have some time, please see me.\");\n-\t\t\t\tqm.dispose();\n-\t\t\t\treturn;\n-\t\t\t} else if(status == 3){\n-\t\t\t\tqm.sendNext(\"Okay. In that case, I'll just give you the routes to the Kingdom of Mushroom. #bNear the west entrance of Henesys,#k you'll find an #bempty house#k. Enter the house, and turn left to enter#b<Themed Dungeon : Mushroom Castle>#k. That's the entrance to the Kingdom of Mushroom. There's not much time!\");\n-\t\t\t\tqm.forceStartQuest();\n-\t\t\t\treturn;\n-\t\t\t}\n-\t\t}\n-\t}\n-\tif(status == 0) \n-\t\tqm.sendAcceptDecline(\"Now that you have made the job advancement, you look like you're ready for this. I have something I'd like to ask you for help. Are you willing to listen?\");\n-\tif(status == 1)\n-\t\tqm.sendNext(\"What happened is that the #bKingdom of Mushroom#k is currently in disarray. Kingdom of Mushroom is located near Henesys, featuring the peace-loving, intelligent King Mush. Recently, he began to feel ill, so he decided to appoint his only daughter #bPrincess Violetta#k. Something must have happened since then for the kingdom to be in its current state.\");\n-\tif(status == 2)\n-\t\tqm.sendNext(\"I am not aware of the exact details, but it's obvious something terrible had taken place, so I think it'll be better if you go there and assess the damage yourself. An explorer like you seem more than capable of saving Kingdom of Mushroom. I have just written you a #brecommendation letter#k, so I suggest you head over to Kingdom of Mushroom immediately and look for the #bHead Patrol Officer#k.\\r\\n\\r\\n#fUI/UIWindow.img/QuestIcon/4/0#\\r\\n#v4032375# #t4032375#\");\n-\tif(status == 3)\n-\t\tqm.sendYesNo(\"By the way, do you know where Kingdom of Mushroom is located? It'll be okay if you can find your way there, but if you don't mind, I can take you straight to the entrance.\");\n-\tif(status == 4){\n-\t\tqm.gainItem(4032375, 1);\n-\t\tqm.forceStartQuest();\n-\t\tqm.dispose();\n-\t}\n+    if (mode == -1) {\n+        qm.dispose();\n+    } else {\n+        if(mode == 0 && type > 0) {\n+            if (status != 3) {\n+                qm.sendOk(\"Really? It's an urgent matter, so if you have some time, please see me.\");\n+                qm.dispose();\n+            } else {\n+                if (qm.canHold(4032375, 1)) {\n+                    qm.sendNext(\"Okay. In that case, I'll just give you the routes to the Kingdom of Mushroom. #bNear the west entrance of Henesys,#k you'll find an #bempty house#k. Enter the house, and turn left to enter#b<Themed Dungeon : Mushroom Castle>#k. That's the entrance to the Kingdom of Mushroom. There's not much time!\");\n+                } else {\n+                    qm.sendOk(\"Please have a slot available in your Etc inventory.\");\n+                    qm.dispose();\n+                }\n+            }\n+            \n+            status++;\n+        } else {\n+            if (mode == 1)\n+                status++;\n+            else\n+                status--;\n+\n+            if (status == 0) {\n+                qm.sendAcceptDecline(\"Now that you have made the job advancement, you look like you're ready for this. I have something I'd like to ask you for help. Are you willing to listen?\");\n+            } else if (status == 1) {\n+                qm.sendNext(\"What happened is that the #bKingdom of Mushroom#k is currently in disarray. Kingdom of Mushroom is located near Henesys, featuring the peace-loving, intelligent King Mush. Recently, he began to feel ill, so he decided to appoint his only daughter #bPrincess Violetta#k. Something must have happened since then for the kingdom to be in its current state.\");\n+            } else if (status == 2) {\n+                qm.sendNext(\"I am not aware of the exact details, but it's obvious something terrible had taken place, so I think it'll be better if you go there and assess the damage yourself. An explorer like you seem more than capable of saving Kingdom of Mushroom. I have just written you a #brecommendation letter#k, so I suggest you head over to Kingdom of Mushroom immediately and look for the #bHead Patrol Officer#k.\\r\\n\\r\\n#fUI/UIWindow.img/QuestIcon/4/0#\\r\\n#v4032375# #t4032375#\");\n+            } else if (status == 3) {\n+                qm.sendYesNo(\"By the way, do you know where Kingdom of Mushroom is located? It'll be okay if you can find your way there, but if you don't mind, I can take you straight to the entrance.\");\n+            } else if (status == 4) {\n+                if (qm.canHold(4032375, 1)) {\n+                    if (!qm.haveItem(4032375, 1)) {\n+                        qm.gainItem(4032375, 1);\n+                    }\n+                    \n+                    qm.warp(106020000, 0);\n+                    qm.forceStartQuest();\n+                } else {\n+                    qm.sendOk(\"Please have a slot available in your Etc inventory.\");\n+                }\n+                \n+                qm.dispose();\n+                return;\n+            } else if (status == 5) {\n+                if (!qm.haveItem(4032375, 1)) {\n+                    qm.gainItem(4032375, 1);\n+                }\n+                \n+                qm.forceStartQuest();\n+                qm.dispose();\n+                return;\n+            }\n+        }\n+    }\n }\n \n function end(mode, type, selection) {\n-    status++;\n-\tif (mode != 1) {\n-\t    if(type == 1 && mode == 0)\n-\t\t    status -= 2;\n-\t\telse{\n-\t\t    qm.dispose();\n-\t\t\treturn;\n-\t\t}\n-\t}\n-\tif(status == 0)\n-\t\tqm.sendNext(\"Hmmm? Is that a #brecommendation letter from the job instructor#k??! What is this, are you the one that came to save us, the Kingdom of Mushroom?\");\n-\tif(status == 1)\n-\t\tqm.sendNextPrev(\"Hmmm... okay. Since the letter is from the job instructor, I suppose you are really the one. I apologize for not introducing myself to you earlier. I'm the #bHead Security Officer#k in charge of protecting King Mush. As you can see, this temporary hideout is protected by the team of security and soldiers. Our situation may be dire, but nevertheless, welcome to Kingdom of Mushroom.\");\n-\tif(status == 2){\n-\t\tqm.gainItem(4032375, -1);\n-                qm.gainExp(6000);\n-\t\tqm.forceCompleteQuest();\n-\t\tqm.forceStartQuest(2312);\n-\t\tqm.dispose();\n-\t}\n+    if (mode == -1) {\n+        qm.dispose();\n+    } else {\n+        if(mode == 0 && type > 0) {\n+            qm.dispose();\n+            return;\n+        }\n+        \n+        if (mode == 1)\n+            status++;\n+        else\n+            status--;\n+        \n+        if (status == 0) {\n+            if (!qm.haveItem(4032375, 1)) {\n+                qm.sendNext(\"What do you want, hmmm?\");\n+                qm.dispose();\n+                return;\n+            }\n+            \n+            qm.sendNext(\"Hmmm? Is that a #brecommendation letter from the job instructor#k??! What is this, are you the one that came to save us, the Kingdom of Mushroom?\");\n+        } else if (status == 1) {\n+            qm.sendNextPrev(\"Hmmm... okay. Since the letter is from the job instructor, I suppose you are really the one. I apologize for not introducing myself to you earlier. I'm the #bHead Security Officer#k in charge of protecting King Mush. As you can see, this temporary hideout is protected by the team of security and soldiers. Our situation may be dire, but nevertheless, welcome to Kingdom of Mushroom.\");\n+        } else if (status == 2) {\n+            qm.gainItem(4032375, -1);\n+            qm.gainExp(6000);\n+            qm.forceCompleteQuest();\n+            qm.forceStartQuest(2312);\n+            qm.dispose();\n+        }\n+    }\n }\n\\ No newline at end of file"}, {"sha": "9efd61d7f4a8a52c833e5e2d53b0dfcef5105bda", "filename": "scripts/quest/2301.js", "status": "modified", "additions": 89, "deletions": 49, "changes": 138, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/quest/2301.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/quest/2301.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/quest/2301.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -4,61 +4,101 @@\n \tDescription: \tQuest -  Kingdom of Mushroom in Danger\n =============================================================\n Version 1.0 - Script Done.(17/7/2010)\n+Version 2.0 - Script Reworked by Ronan.(16/11/2018)\n =============================================================\n */\n \n var status = -1;\n \n function start(mode, type, selection) {\n-    status++;\n-\tif (mode != 1) {\n-\t    if(type == 1 && mode == 0)\n-\t\t    status -= 2;\n-\t\telse{\n-\t\t\t//if(status == 0){\n-\t\t\t\tqm.sendOk(\"Really? It's an urgent matter, so if you have some time, please see me.\");\n-\t\t\t\tqm.dispose();\n-\t\t\t\treturn;\n-\t\t\t//} else if(status == 3){\n-\t\t\t\t//qm.sendNext(\"Okay. In that case, I'll just give you the routes to the Kingdom of Mushroom. #bNear the west entrance of Henesys,#k you'll find an #bempty house#k. Enter the house, and turn left to enter#b<Themed Dungeon : Mushroom Castle>#k. That's the entrance to the Kingdom of Mushroom. There's not much time!\");\n-\t\t\t\t//qm.forceStartQuest();\n-\t\t\t\t//return;\n-\t\t\t}\n-\t\t}\n-\t//}\n-\tif(status == 0) \n-\t\tqm.sendAcceptDecline(\"Now that you have made the job advancement, you look like you're ready for this. I have something I'd like to ask you for help. Are you willing to listen?\");\n-\tif(status == 1)\n-\t\tqm.sendNext(\"What happened is that the #bKingdom of Mushroom#k is currently in disarray. Kingdom of Mushroom is located near Henesys, featuring the peace-loving, intelligent King Mush. Recently, he began to feel ill, so he decided to appoint his only daughter #bPrincess Violetta#k. Something must have happened since then for the kingdom to be in its current state.\");\n-\tif(status == 2)\n-\t\tqm.sendNext(\"I am not aware of the exact details, but it's obvious something terrible had taken place, so I think it'll be better if you go there and assess the damage yourself. An explorer like you seem more than capable of saving Kingdom of Mushroom. I have just written you a #brecommendation letter#k, so I suggest you head over to Kingdom of Mushroom immediately and look for the #bHead Patrol Officer#k.\\r\\n\\r\\n#fUI/UIWindow.img/QuestIcon/4/0#\\r\\n#v4032375# #t4032375#\");\n-\tif(status == 3)\n-\t\tqm.sendYesNo(\"By the way, do you know where Kingdom of Mushroom is located? It'll be okay if you can find your way there, but if you don't mind, I can take you straight to the entrance.\");\n-\tif(status == 4){\n-\t\tqm.gainItem(4032375, 1);\n-\t\tqm.forceStartQuest();\n-\t\tqm.dispose();\n-\t}\n+    if (mode == -1) {\n+        qm.dispose();\n+    } else {\n+        if(mode == 0 && type > 0) {\n+            if (status != 3) {\n+                qm.sendOk(\"Really? It's an urgent matter, so if you have some time, please see me.\");\n+                qm.dispose();\n+            } else {\n+                if (qm.canHold(4032375, 1)) {\n+                    qm.sendNext(\"Okay. In that case, I'll just give you the routes to the Kingdom of Mushroom. #bNear the west entrance of Henesys,#k you'll find an #bempty house#k. Enter the house, and turn left to enter#b<Themed Dungeon : Mushroom Castle>#k. That's the entrance to the Kingdom of Mushroom. There's not much time!\");\n+                } else {\n+                    qm.sendOk(\"Please have a slot available in your Etc inventory.\");\n+                    qm.dispose();\n+                }\n+            }\n+            \n+            status++;\n+        } else {\n+            if (mode == 1)\n+                status++;\n+            else\n+                status--;\n+\n+            if (status == 0) {\n+                qm.sendAcceptDecline(\"Now that you have made the job advancement, you look like you're ready for this. I have something I'd like to ask you for help. Are you willing to listen?\");\n+            } else if (status == 1) {\n+                qm.sendNext(\"What happened is that the #bKingdom of Mushroom#k is currently in disarray. Kingdom of Mushroom is located near Henesys, featuring the peace-loving, intelligent King Mush. Recently, he began to feel ill, so he decided to appoint his only daughter #bPrincess Violetta#k. Something must have happened since then for the kingdom to be in its current state.\");\n+            } else if (status == 2) {\n+                qm.sendNext(\"I am not aware of the exact details, but it's obvious something terrible had taken place, so I think it'll be better if you go there and assess the damage yourself. An explorer like you seem more than capable of saving Kingdom of Mushroom. I have just written you a #brecommendation letter#k, so I suggest you head over to Kingdom of Mushroom immediately and look for the #bHead Patrol Officer#k.\\r\\n\\r\\n#fUI/UIWindow.img/QuestIcon/4/0#\\r\\n#v4032375# #t4032375#\");\n+            } else if (status == 3) {\n+                qm.sendYesNo(\"By the way, do you know where Kingdom of Mushroom is located? It'll be okay if you can find your way there, but if you don't mind, I can take you straight to the entrance.\");\n+            } else if (status == 4) {\n+                if (qm.canHold(4032375, 1)) {\n+                    if (!qm.haveItem(4032375, 1)) {\n+                        qm.gainItem(4032375, 1);\n+                    }\n+                    \n+                    qm.warp(106020000, 0);\n+                    qm.forceStartQuest();\n+                } else {\n+                    qm.sendOk(\"Please have a slot available in your Etc inventory.\");\n+                }\n+                \n+                qm.dispose();\n+                return;\n+            } else if (status == 5) {\n+                if (!qm.haveItem(4032375, 1)) {\n+                    qm.gainItem(4032375, 1);\n+                }\n+                \n+                qm.forceStartQuest();\n+                qm.dispose();\n+                return;\n+            }\n+        }\n+    }\n }\n \n function end(mode, type, selection) {\n-    status++;\n-\tif (mode != 1) {\n-\t    if(type == 1 && mode == 0)\n-\t\t    status -= 2;\n-\t\telse{\n-\t\t    qm.dispose();\n-\t\t\treturn;\n-\t\t}\n-\t}\n-\tif(status == 0)\n-\t\tqm.sendNext(\"Hmmm? Is that a #brecommendation letter from the job instructor#k??! What is this, are you the one that came to save us, the Kingdom of Mushroom?\");\n-\tif(status == 1)\n-\t\tqm.sendNextPrev(\"Hmmm... okay. Since the letter is from the job instructor, I suppose you are really the one. I apologize for not introducing myself to you earlier. I'm the #bHead Security Officer#k in charge of protecting King Mush. As you can see, this temporary hideout is protected by the team of security and soldiers. Our situation may be dire, but nevertheless, welcome to Kingdom of Mushroom.\");\n-\tif(status == 2){\n-\t\tqm.forceCompleteQuest();\n-\t\tqm.gainItem(4032375, -1);\n-\t\tqm.forceStartQuest(2312);\n-\t\tqm.dispose();\n-\t}\n-}\n+    if (mode == -1) {\n+        qm.dispose();\n+    } else {\n+        if(mode == 0 && type > 0) {\n+            qm.dispose();\n+            return;\n+        }\n+        \n+        if (mode == 1)\n+            status++;\n+        else\n+            status--;\n+        \n+        if (status == 0) {\n+            if (!qm.haveItem(4032375, 1)) {\n+                qm.sendNext(\"What do you want, hmmm?\");\n+                qm.dispose();\n+                return;\n+            }\n+            \n+            qm.sendNext(\"Hmmm? Is that a #brecommendation letter from the job instructor#k??! What is this, are you the one that came to save us, the Kingdom of Mushroom?\");\n+        } else if (status == 1) {\n+            qm.sendNextPrev(\"Hmmm... okay. Since the letter is from the job instructor, I suppose you are really the one. I apologize for not introducing myself to you earlier. I'm the #bHead Security Officer#k in charge of protecting King Mush. As you can see, this temporary hideout is protected by the team of security and soldiers. Our situation may be dire, but nevertheless, welcome to Kingdom of Mushroom.\");\n+        } else if (status == 2) {\n+            qm.gainItem(4032375, -1);\n+            qm.gainExp(6000);\n+            qm.forceCompleteQuest();\n+            qm.forceStartQuest(2312);\n+            qm.dispose();\n+        }\n+    }\n+}\n\\ No newline at end of file"}, {"sha": "9efd61d7f4a8a52c833e5e2d53b0dfcef5105bda", "filename": "scripts/quest/2302.js", "status": "modified", "additions": 89, "deletions": 49, "changes": 138, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/quest/2302.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/quest/2302.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/quest/2302.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -4,61 +4,101 @@\n \tDescription: \tQuest -  Kingdom of Mushroom in Danger\n =============================================================\n Version 1.0 - Script Done.(17/7/2010)\n+Version 2.0 - Script Reworked by Ronan.(16/11/2018)\n =============================================================\n */\n \n var status = -1;\n \n function start(mode, type, selection) {\n-    status++;\n-\tif (mode != 1) {\n-\t    if(type == 1 && mode == 0)\n-\t\t    status -= 2;\n-\t\telse{\n-\t\t\t//if(status == 0){\n-\t\t\t\tqm.sendOk(\"Really? It's an urgent matter, so if you have some time, please see me.\");\n-\t\t\t\tqm.dispose();\n-\t\t\t\treturn;\n-\t\t\t//} else if(status == 3){\n-\t\t\t\t//qm.sendNext(\"Okay. In that case, I'll just give you the routes to the Kingdom of Mushroom. #bNear the west entrance of Henesys,#k you'll find an #bempty house#k. Enter the house, and turn left to enter#b<Themed Dungeon : Mushroom Castle>#k. That's the entrance to the Kingdom of Mushroom. There's not much time!\");\n-\t\t\t\t//qm.forceStartQuest();\n-\t\t\t\t//return;\n-\t\t\t}\n-\t\t}\n-\t//}\n-\tif(status == 0) \n-\t\tqm.sendAcceptDecline(\"Now that you have made the job advancement, you look like you're ready for this. I have something I'd like to ask you for help. Are you willing to listen?\");\n-\tif(status == 1)\n-\t\tqm.sendNext(\"What happened is that the #bKingdom of Mushroom#k is currently in disarray. Kingdom of Mushroom is located near Henesys, featuring the peace-loving, intelligent King Mush. Recently, he began to feel ill, so he decided to appoint his only daughter #bPrincess Violetta#k. Something must have happened since then for the kingdom to be in its current state.\");\n-\tif(status == 2)\n-\t\tqm.sendNext(\"I am not aware of the exact details, but it's obvious something terrible had taken place, so I think it'll be better if you go there and assess the damage yourself. An explorer like you seem more than capable of saving Kingdom of Mushroom. I have just written you a #brecommendation letter#k, so I suggest you head over to Kingdom of Mushroom immediately and look for the #bHead Patrol Officer#k.\\r\\n\\r\\n#fUI/UIWindow.img/QuestIcon/4/0#\\r\\n#v4032375# #t4032375#\");\n-\tif(status == 3)\n-\t\tqm.sendYesNo(\"By the way, do you know where Kingdom of Mushroom is located? It'll be okay if you can find your way there, but if you don't mind, I can take you straight to the entrance.\");\n-\tif(status == 4){\n-\t\tqm.gainItem(4032375, 1);\n-\t\tqm.forceStartQuest();\n-\t\tqm.dispose();\n-\t}\n+    if (mode == -1) {\n+        qm.dispose();\n+    } else {\n+        if(mode == 0 && type > 0) {\n+            if (status != 3) {\n+                qm.sendOk(\"Really? It's an urgent matter, so if you have some time, please see me.\");\n+                qm.dispose();\n+            } else {\n+                if (qm.canHold(4032375, 1)) {\n+                    qm.sendNext(\"Okay. In that case, I'll just give you the routes to the Kingdom of Mushroom. #bNear the west entrance of Henesys,#k you'll find an #bempty house#k. Enter the house, and turn left to enter#b<Themed Dungeon : Mushroom Castle>#k. That's the entrance to the Kingdom of Mushroom. There's not much time!\");\n+                } else {\n+                    qm.sendOk(\"Please have a slot available in your Etc inventory.\");\n+                    qm.dispose();\n+                }\n+            }\n+            \n+            status++;\n+        } else {\n+            if (mode == 1)\n+                status++;\n+            else\n+                status--;\n+\n+            if (status == 0) {\n+                qm.sendAcceptDecline(\"Now that you have made the job advancement, you look like you're ready for this. I have something I'd like to ask you for help. Are you willing to listen?\");\n+            } else if (status == 1) {\n+                qm.sendNext(\"What happened is that the #bKingdom of Mushroom#k is currently in disarray. Kingdom of Mushroom is located near Henesys, featuring the peace-loving, intelligent King Mush. Recently, he began to feel ill, so he decided to appoint his only daughter #bPrincess Violetta#k. Something must have happened since then for the kingdom to be in its current state.\");\n+            } else if (status == 2) {\n+                qm.sendNext(\"I am not aware of the exact details, but it's obvious something terrible had taken place, so I think it'll be better if you go there and assess the damage yourself. An explorer like you seem more than capable of saving Kingdom of Mushroom. I have just written you a #brecommendation letter#k, so I suggest you head over to Kingdom of Mushroom immediately and look for the #bHead Patrol Officer#k.\\r\\n\\r\\n#fUI/UIWindow.img/QuestIcon/4/0#\\r\\n#v4032375# #t4032375#\");\n+            } else if (status == 3) {\n+                qm.sendYesNo(\"By the way, do you know where Kingdom of Mushroom is located? It'll be okay if you can find your way there, but if you don't mind, I can take you straight to the entrance.\");\n+            } else if (status == 4) {\n+                if (qm.canHold(4032375, 1)) {\n+                    if (!qm.haveItem(4032375, 1)) {\n+                        qm.gainItem(4032375, 1);\n+                    }\n+                    \n+                    qm.warp(106020000, 0);\n+                    qm.forceStartQuest();\n+                } else {\n+                    qm.sendOk(\"Please have a slot available in your Etc inventory.\");\n+                }\n+                \n+                qm.dispose();\n+                return;\n+            } else if (status == 5) {\n+                if (!qm.haveItem(4032375, 1)) {\n+                    qm.gainItem(4032375, 1);\n+                }\n+                \n+                qm.forceStartQuest();\n+                qm.dispose();\n+                return;\n+            }\n+        }\n+    }\n }\n \n function end(mode, type, selection) {\n-    status++;\n-\tif (mode != 1) {\n-\t    if(type == 1 && mode == 0)\n-\t\t    status -= 2;\n-\t\telse{\n-\t\t    qm.dispose();\n-\t\t\treturn;\n-\t\t}\n-\t}\n-\tif(status == 0)\n-\t\tqm.sendNext(\"Hmmm? Is that a #brecommendation letter from the job instructor#k??! What is this, are you the one that came to save us, the Kingdom of Mushroom?\");\n-\tif(status == 1)\n-\t\tqm.sendNextPrev(\"Hmmm... okay. Since the letter is from the job instructor, I suppose you are really the one. I apologize for not introducing myself to you earlier. I'm the #bHead Security Officer#k in charge of protecting King Mush. As you can see, this temporary hideout is protected by the team of security and soldiers. Our situation may be dire, but nevertheless, welcome to Kingdom of Mushroom.\");\n-\tif(status == 2){\n-\t\tqm.forceCompleteQuest();\n-\t\tqm.gainItem(4032375, -1);\n-\t\tqm.forceStartQuest(2312);\t\t\n-\t\tqm.dispose();\n-\t}\n-}\n+    if (mode == -1) {\n+        qm.dispose();\n+    } else {\n+        if(mode == 0 && type > 0) {\n+            qm.dispose();\n+            return;\n+        }\n+        \n+        if (mode == 1)\n+            status++;\n+        else\n+            status--;\n+        \n+        if (status == 0) {\n+            if (!qm.haveItem(4032375, 1)) {\n+                qm.sendNext(\"What do you want, hmmm?\");\n+                qm.dispose();\n+                return;\n+            }\n+            \n+            qm.sendNext(\"Hmmm? Is that a #brecommendation letter from the job instructor#k??! What is this, are you the one that came to save us, the Kingdom of Mushroom?\");\n+        } else if (status == 1) {\n+            qm.sendNextPrev(\"Hmmm... okay. Since the letter is from the job instructor, I suppose you are really the one. I apologize for not introducing myself to you earlier. I'm the #bHead Security Officer#k in charge of protecting King Mush. As you can see, this temporary hideout is protected by the team of security and soldiers. Our situation may be dire, but nevertheless, welcome to Kingdom of Mushroom.\");\n+        } else if (status == 2) {\n+            qm.gainItem(4032375, -1);\n+            qm.gainExp(6000);\n+            qm.forceCompleteQuest();\n+            qm.forceStartQuest(2312);\n+            qm.dispose();\n+        }\n+    }\n+}\n\\ No newline at end of file"}, {"sha": "9efd61d7f4a8a52c833e5e2d53b0dfcef5105bda", "filename": "scripts/quest/2303.js", "status": "modified", "additions": 89, "deletions": 48, "changes": 137, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/quest/2303.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/quest/2303.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/quest/2303.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -4,60 +4,101 @@\n \tDescription: \tQuest -  Kingdom of Mushroom in Danger\n =============================================================\n Version 1.0 - Script Done.(17/7/2010)\n+Version 2.0 - Script Reworked by Ronan.(16/11/2018)\n =============================================================\n */\n \n var status = -1;\n \n function start(mode, type, selection) {\n-    status++;\n-\tif (mode != 1) {\n-\t    if(type == 1 && mode == 0)\n-\t\t    status -= 2;\n-\t\telse{\n-\t\t\t//if(status == 0){\n-\t\t\t\tqm.sendOk(\"Really? It's an urgent matter, so if you have some time, please see me.\");\n-\t\t\t\tqm.dispose();\n-\t\t\t\treturn;\n-\t\t\t//} else if(status == 3){\n-\t\t\t\t//qm.sendNext(\"Okay. In that case, I'll just give you the routes to the Kingdom of Mushroom. #bNear the west entrance of Henesys,#k you'll find an #bempty house#k. Enter the house, and turn left to enter#b<Themed Dungeon : Mushroom Castle>#k. That's the entrance to the Kingdom of Mushroom. There's not much time!\");\n-\t\t\t\t//qm.forceStartQuest();\n-\t\t\t\t//return;\n-\t\t\t}\n-\t\t}\n-\t//}\n-\tif(status == 0) \n-\t\tqm.sendAcceptDecline(\"Now that you have made the job advancement, you look like you're ready for this. I have something I'd like to ask you for help. Are you willing to listen?\");\n-\tif(status == 1)\n-\t\tqm.sendNext(\"What happened is that the #bKingdom of Mushroom#k is currently in disarray. Kingdom of Mushroom is located near Henesys, featuring the peace-loving, intelligent King Mush. Recently, he began to feel ill, so he decided to appoint his only daughter #bPrincess Violetta#k. Something must have happened since then for the kingdom to be in its current state.\");\n-\tif(status == 2)\n-\t\tqm.sendNext(\"I am not aware of the exact details, but it's obvious something terrible had taken place, so I think it'll be better if you go there and assess the damage yourself. An explorer like you seem more than capable of saving Kingdom of Mushroom. I have just written you a #brecommendation letter#k, so I suggest you head over to Kingdom of Mushroom immediately and look for the #bHead Patrol Officer#k.\\r\\n\\r\\n#fUI/UIWindow.img/QuestIcon/4/0#\\r\\n#v4032375# #t4032375#\");\n-\tif(status == 3)\n-\t\tqm.sendYesNo(\"By the way, do you know where Kingdom of Mushroom is located? It'll be okay if you can find your way there, but if you don't mind, I can take you straight to the entrance.\");\n-\tif(status == 4){\n-\t\tqm.gainItem(4032375, 1);\n-\t\tqm.forceStartQuest();\n-\t\tqm.dispose();\n-\t}\n+    if (mode == -1) {\n+        qm.dispose();\n+    } else {\n+        if(mode == 0 && type > 0) {\n+            if (status != 3) {\n+                qm.sendOk(\"Really? It's an urgent matter, so if you have some time, please see me.\");\n+                qm.dispose();\n+            } else {\n+                if (qm.canHold(4032375, 1)) {\n+                    qm.sendNext(\"Okay. In that case, I'll just give you the routes to the Kingdom of Mushroom. #bNear the west entrance of Henesys,#k you'll find an #bempty house#k. Enter the house, and turn left to enter#b<Themed Dungeon : Mushroom Castle>#k. That's the entrance to the Kingdom of Mushroom. There's not much time!\");\n+                } else {\n+                    qm.sendOk(\"Please have a slot available in your Etc inventory.\");\n+                    qm.dispose();\n+                }\n+            }\n+            \n+            status++;\n+        } else {\n+            if (mode == 1)\n+                status++;\n+            else\n+                status--;\n+\n+            if (status == 0) {\n+                qm.sendAcceptDecline(\"Now that you have made the job advancement, you look like you're ready for this. I have something I'd like to ask you for help. Are you willing to listen?\");\n+            } else if (status == 1) {\n+                qm.sendNext(\"What happened is that the #bKingdom of Mushroom#k is currently in disarray. Kingdom of Mushroom is located near Henesys, featuring the peace-loving, intelligent King Mush. Recently, he began to feel ill, so he decided to appoint his only daughter #bPrincess Violetta#k. Something must have happened since then for the kingdom to be in its current state.\");\n+            } else if (status == 2) {\n+                qm.sendNext(\"I am not aware of the exact details, but it's obvious something terrible had taken place, so I think it'll be better if you go there and assess the damage yourself. An explorer like you seem more than capable of saving Kingdom of Mushroom. I have just written you a #brecommendation letter#k, so I suggest you head over to Kingdom of Mushroom immediately and look for the #bHead Patrol Officer#k.\\r\\n\\r\\n#fUI/UIWindow.img/QuestIcon/4/0#\\r\\n#v4032375# #t4032375#\");\n+            } else if (status == 3) {\n+                qm.sendYesNo(\"By the way, do you know where Kingdom of Mushroom is located? It'll be okay if you can find your way there, but if you don't mind, I can take you straight to the entrance.\");\n+            } else if (status == 4) {\n+                if (qm.canHold(4032375, 1)) {\n+                    if (!qm.haveItem(4032375, 1)) {\n+                        qm.gainItem(4032375, 1);\n+                    }\n+                    \n+                    qm.warp(106020000, 0);\n+                    qm.forceStartQuest();\n+                } else {\n+                    qm.sendOk(\"Please have a slot available in your Etc inventory.\");\n+                }\n+                \n+                qm.dispose();\n+                return;\n+            } else if (status == 5) {\n+                if (!qm.haveItem(4032375, 1)) {\n+                    qm.gainItem(4032375, 1);\n+                }\n+                \n+                qm.forceStartQuest();\n+                qm.dispose();\n+                return;\n+            }\n+        }\n+    }\n }\n+\n function end(mode, type, selection) {\n-    status++;\n-\tif (mode != 1) {\n-\t    if(type == 1 && mode == 0)\n-\t\t    status -= 2;\n-\t\telse{\n-\t\t    qm.dispose();\n-\t\t\treturn;\n-\t\t}\n-\t}\n-\tif(status == 0)\n-\t\tqm.sendNext(\"Hmmm? Is that a #brecommendation letter from the job instructor#k??! What is this, are you the one that came to save us, the Kingdom of Mushroom?\");\n-\tif(status == 1)\n-\t\tqm.sendNextPrev(\"Hmmm... okay. Since the letter is from the job instructor, I suppose you are really the one. I apologize for not introducing myself to you earlier. I'm the #bHead Security Officer#k in charge of protecting King Mush. As you can see, this temporary hideout is protected by the team of security and soldiers. Our situation may be dire, but nevertheless, welcome to Kingdom of Mushroom.\");\n-\tif(status == 2){\n-\t\tqm.forceCompleteQuest();\n-\t\tqm.gainItem(4032375, -1);\n-\t\tqm.forceStartQuest(2312);\t\t\n-\t\tqm.dispose();\n-\t}\n+    if (mode == -1) {\n+        qm.dispose();\n+    } else {\n+        if(mode == 0 && type > 0) {\n+            qm.dispose();\n+            return;\n+        }\n+        \n+        if (mode == 1)\n+            status++;\n+        else\n+            status--;\n+        \n+        if (status == 0) {\n+            if (!qm.haveItem(4032375, 1)) {\n+                qm.sendNext(\"What do you want, hmmm?\");\n+                qm.dispose();\n+                return;\n+            }\n+            \n+            qm.sendNext(\"Hmmm? Is that a #brecommendation letter from the job instructor#k??! What is this, are you the one that came to save us, the Kingdom of Mushroom?\");\n+        } else if (status == 1) {\n+            qm.sendNextPrev(\"Hmmm... okay. Since the letter is from the job instructor, I suppose you are really the one. I apologize for not introducing myself to you earlier. I'm the #bHead Security Officer#k in charge of protecting King Mush. As you can see, this temporary hideout is protected by the team of security and soldiers. Our situation may be dire, but nevertheless, welcome to Kingdom of Mushroom.\");\n+        } else if (status == 2) {\n+            qm.gainItem(4032375, -1);\n+            qm.gainExp(6000);\n+            qm.forceCompleteQuest();\n+            qm.forceStartQuest(2312);\n+            qm.dispose();\n+        }\n+    }\n }\n\\ No newline at end of file"}, {"sha": "9efd61d7f4a8a52c833e5e2d53b0dfcef5105bda", "filename": "scripts/quest/2304.js", "status": "modified", "additions": 89, "deletions": 49, "changes": 138, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/quest/2304.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/quest/2304.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/quest/2304.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -4,61 +4,101 @@\n \tDescription: \tQuest -  Kingdom of Mushroom in Danger\n =============================================================\n Version 1.0 - Script Done.(17/7/2010)\n+Version 2.0 - Script Reworked by Ronan.(16/11/2018)\n =============================================================\n */\n \n var status = -1;\n \n function start(mode, type, selection) {\n-    status++;\n-\tif (mode != 1) {\n-\t    if(type == 1 && mode == 0)\n-\t\t    status -= 2;\n-\t\telse{\n-\t\t\t//if(status == 0){\n-\t\t\t\tqm.sendOk(\"Really? It's an urgent matter, so if you have some time, please see me.\");\n-\t\t\t\tqm.dispose();\n-\t\t\t\treturn;\n-\t\t\t//} else if(status == 3){\n-\t\t\t\t//qm.sendNext(\"Okay. In that case, I'll just give you the routes to the Kingdom of Mushroom. #bNear the west entrance of Henesys,#k you'll find an #bempty house#k. Enter the house, and turn left to enter#b<Themed Dungeon : Mushroom Castle>#k. That's the entrance to the Kingdom of Mushroom. There's not much time!\");\n-\t\t\t\t//qm.forceStartQuest();\n-\t\t\t\t//return;\n-\t\t\t}\n-\t\t}\n-\t//}\n-\tif(status == 0) \n-\t\tqm.sendAcceptDecline(\"Now that you have made the job advancement, you look like you're ready for this. I have something I'd like to ask you for help. Are you willing to listen?\");\n-\tif(status == 1)\n-\t\tqm.sendNext(\"What happened is that the #bKingdom of Mushroom#k is currently in disarray. Kingdom of Mushroom is located near Henesys, featuring the peace-loving, intelligent King Mush. Recently, he began to feel ill, so he decided to appoint his only daughter #bPrincess Violetta#k. Something must have happened since then for the kingdom to be in its current state.\");\n-\tif(status == 2)\n-\t\tqm.sendNext(\"I am not aware of the exact details, but it's obvious something terrible had taken place, so I think it'll be better if you go there and assess the damage yourself. An explorer like you seem more than capable of saving Kingdom of Mushroom. I have just written you a #brecommendation letter#k, so I suggest you head over to Kingdom of Mushroom immediately and look for the #bHead Patrol Officer#k.\\r\\n\\r\\n#fUI/UIWindow.img/QuestIcon/4/0#\\r\\n#v4032375# #t4032375#\");\n-\tif(status == 3)\n-\t\tqm.sendYesNo(\"By the way, do you know where Kingdom of Mushroom is located? It'll be okay if you can find your way there, but if you don't mind, I can take you straight to the entrance.\");\n-\tif(status == 4){\n-\t\tqm.gainItem(4032375, 1);\n-\t\tqm.forceStartQuest();\n-\t\tqm.dispose();\n-\t}\n+    if (mode == -1) {\n+        qm.dispose();\n+    } else {\n+        if(mode == 0 && type > 0) {\n+            if (status != 3) {\n+                qm.sendOk(\"Really? It's an urgent matter, so if you have some time, please see me.\");\n+                qm.dispose();\n+            } else {\n+                if (qm.canHold(4032375, 1)) {\n+                    qm.sendNext(\"Okay. In that case, I'll just give you the routes to the Kingdom of Mushroom. #bNear the west entrance of Henesys,#k you'll find an #bempty house#k. Enter the house, and turn left to enter#b<Themed Dungeon : Mushroom Castle>#k. That's the entrance to the Kingdom of Mushroom. There's not much time!\");\n+                } else {\n+                    qm.sendOk(\"Please have a slot available in your Etc inventory.\");\n+                    qm.dispose();\n+                }\n+            }\n+            \n+            status++;\n+        } else {\n+            if (mode == 1)\n+                status++;\n+            else\n+                status--;\n+\n+            if (status == 0) {\n+                qm.sendAcceptDecline(\"Now that you have made the job advancement, you look like you're ready for this. I have something I'd like to ask you for help. Are you willing to listen?\");\n+            } else if (status == 1) {\n+                qm.sendNext(\"What happened is that the #bKingdom of Mushroom#k is currently in disarray. Kingdom of Mushroom is located near Henesys, featuring the peace-loving, intelligent King Mush. Recently, he began to feel ill, so he decided to appoint his only daughter #bPrincess Violetta#k. Something must have happened since then for the kingdom to be in its current state.\");\n+            } else if (status == 2) {\n+                qm.sendNext(\"I am not aware of the exact details, but it's obvious something terrible had taken place, so I think it'll be better if you go there and assess the damage yourself. An explorer like you seem more than capable of saving Kingdom of Mushroom. I have just written you a #brecommendation letter#k, so I suggest you head over to Kingdom of Mushroom immediately and look for the #bHead Patrol Officer#k.\\r\\n\\r\\n#fUI/UIWindow.img/QuestIcon/4/0#\\r\\n#v4032375# #t4032375#\");\n+            } else if (status == 3) {\n+                qm.sendYesNo(\"By the way, do you know where Kingdom of Mushroom is located? It'll be okay if you can find your way there, but if you don't mind, I can take you straight to the entrance.\");\n+            } else if (status == 4) {\n+                if (qm.canHold(4032375, 1)) {\n+                    if (!qm.haveItem(4032375, 1)) {\n+                        qm.gainItem(4032375, 1);\n+                    }\n+                    \n+                    qm.warp(106020000, 0);\n+                    qm.forceStartQuest();\n+                } else {\n+                    qm.sendOk(\"Please have a slot available in your Etc inventory.\");\n+                }\n+                \n+                qm.dispose();\n+                return;\n+            } else if (status == 5) {\n+                if (!qm.haveItem(4032375, 1)) {\n+                    qm.gainItem(4032375, 1);\n+                }\n+                \n+                qm.forceStartQuest();\n+                qm.dispose();\n+                return;\n+            }\n+        }\n+    }\n }\n \n function end(mode, type, selection) {\n-    status++;\n-\tif (mode != 1) {\n-\t    if(type == 1 && mode == 0)\n-\t\t    status -= 2;\n-\t\telse{\n-\t\t    qm.dispose();\n-\t\t\treturn;\n-\t\t}\n-\t}\n-\tif(status == 0)\n-\t\tqm.sendNext(\"Hmmm? Is that a #brecommendation letter from the job instructor#k??! What is this, are you the one that came to save us, the Kingdom of Mushroom?\");\n-\tif(status == 1)\n-\t\tqm.sendNextPrev(\"Hmmm... okay. Since the letter is from the job instructor, I suppose you are really the one. I apologize for not introducing myself to you earlier. I'm the #bHead Security Officer#k in charge of protecting King Mush. As you can see, this temporary hideout is protected by the team of security and soldiers. Our situation may be dire, but nevertheless, welcome to Kingdom of Mushroom.\");\n-\tif(status == 2){\n-\t\tqm.forceCompleteQuest();\n-\t\tqm.gainItem(4032375, -1);\n-\t\tqm.forceStartQuest(2312);\t\t\n-\t\tqm.dispose();\n-\t}\n-}\n+    if (mode == -1) {\n+        qm.dispose();\n+    } else {\n+        if(mode == 0 && type > 0) {\n+            qm.dispose();\n+            return;\n+        }\n+        \n+        if (mode == 1)\n+            status++;\n+        else\n+            status--;\n+        \n+        if (status == 0) {\n+            if (!qm.haveItem(4032375, 1)) {\n+                qm.sendNext(\"What do you want, hmmm?\");\n+                qm.dispose();\n+                return;\n+            }\n+            \n+            qm.sendNext(\"Hmmm? Is that a #brecommendation letter from the job instructor#k??! What is this, are you the one that came to save us, the Kingdom of Mushroom?\");\n+        } else if (status == 1) {\n+            qm.sendNextPrev(\"Hmmm... okay. Since the letter is from the job instructor, I suppose you are really the one. I apologize for not introducing myself to you earlier. I'm the #bHead Security Officer#k in charge of protecting King Mush. As you can see, this temporary hideout is protected by the team of security and soldiers. Our situation may be dire, but nevertheless, welcome to Kingdom of Mushroom.\");\n+        } else if (status == 2) {\n+            qm.gainItem(4032375, -1);\n+            qm.gainExp(6000);\n+            qm.forceCompleteQuest();\n+            qm.forceStartQuest(2312);\n+            qm.dispose();\n+        }\n+    }\n+}\n\\ No newline at end of file"}, {"sha": "9efd61d7f4a8a52c833e5e2d53b0dfcef5105bda", "filename": "scripts/quest/2305.js", "status": "modified", "additions": 89, "deletions": 49, "changes": 138, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/quest/2305.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/quest/2305.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/quest/2305.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -4,61 +4,101 @@\n \tDescription: \tQuest -  Kingdom of Mushroom in Danger\n =============================================================\n Version 1.0 - Script Done.(17/7/2010)\n+Version 2.0 - Script Reworked by Ronan.(16/11/2018)\n =============================================================\n */\n \n var status = -1;\n \n function start(mode, type, selection) {\n-    status++;\n-\tif (mode != 1) {\n-\t    if(type == 1 && mode == 0)\n-\t\t    status -= 2;\n-\t\telse{\n-\t\t\t//if(status == 0){\n-\t\t\t\tqm.sendOk(\"Really? It's an urgent matter, so if you have some time, please see me.\");\n-\t\t\t\tqm.dispose();\n-\t\t\t\treturn;\n-\t\t\t//} else if(status == 3){\n-\t\t\t\t//qm.sendNext(\"Okay. In that case, I'll just give you the routes to the Kingdom of Mushroom. #bNear the west entrance of Henesys,#k you'll find an #bempty house#k. Enter the house, and turn left to enter#b<Themed Dungeon : Mushroom Castle>#k. That's the entrance to the Kingdom of Mushroom. There's not much time!\");\n-\t\t\t\t//qm.forceStartQuest();\n-\t\t\t\t//return;\n-\t\t\t}\n-\t\t}\n-\t//}\n-\tif(status == 0) \n-\t\tqm.sendAcceptDecline(\"Now that you have made the job advancement, you look like you're ready for this. I have something I'd like to ask you for help. Are you willing to listen?\");\n-\tif(status == 1)\n-\t\tqm.sendNext(\"What happened is that the #bKingdom of Mushroom#k is currently in disarray. Kingdom of Mushroom is located near Henesys, featuring the peace-loving, intelligent King Mush. Recently, he began to feel ill, so he decided to appoint his only daughter #bPrincess Violetta#k. Something must have happened since then for the kingdom to be in its current state.\");\n-\tif(status == 2)\n-\t\tqm.sendNext(\"I am not aware of the exact details, but it's obvious something terrible had taken place, so I think it'll be better if you go there and assess the damage yourself. An explorer like you seem more than capable of saving Kingdom of Mushroom. I have just written you a #brecommendation letter#k, so I suggest you head over to Kingdom of Mushroom immediately and look for the #bHead Patrol Officer#k.\\r\\n\\r\\n#fUI/UIWindow.img/QuestIcon/4/0#\\r\\n#v4032375# #t4032375#\");\n-\tif(status == 3)\n-\t\tqm.sendYesNo(\"By the way, do you know where Kingdom of Mushroom is located? It'll be okay if you can find your way there, but if you don't mind, I can take you straight to the entrance.\");\n-\tif(status == 4){\n-\t\tqm.gainItem(4032375, 1);\n-\t\tqm.forceStartQuest();\n-\t\tqm.dispose();\n-\t}\n+    if (mode == -1) {\n+        qm.dispose();\n+    } else {\n+        if(mode == 0 && type > 0) {\n+            if (status != 3) {\n+                qm.sendOk(\"Really? It's an urgent matter, so if you have some time, please see me.\");\n+                qm.dispose();\n+            } else {\n+                if (qm.canHold(4032375, 1)) {\n+                    qm.sendNext(\"Okay. In that case, I'll just give you the routes to the Kingdom of Mushroom. #bNear the west entrance of Henesys,#k you'll find an #bempty house#k. Enter the house, and turn left to enter#b<Themed Dungeon : Mushroom Castle>#k. That's the entrance to the Kingdom of Mushroom. There's not much time!\");\n+                } else {\n+                    qm.sendOk(\"Please have a slot available in your Etc inventory.\");\n+                    qm.dispose();\n+                }\n+            }\n+            \n+            status++;\n+        } else {\n+            if (mode == 1)\n+                status++;\n+            else\n+                status--;\n+\n+            if (status == 0) {\n+                qm.sendAcceptDecline(\"Now that you have made the job advancement, you look like you're ready for this. I have something I'd like to ask you for help. Are you willing to listen?\");\n+            } else if (status == 1) {\n+                qm.sendNext(\"What happened is that the #bKingdom of Mushroom#k is currently in disarray. Kingdom of Mushroom is located near Henesys, featuring the peace-loving, intelligent King Mush. Recently, he began to feel ill, so he decided to appoint his only daughter #bPrincess Violetta#k. Something must have happened since then for the kingdom to be in its current state.\");\n+            } else if (status == 2) {\n+                qm.sendNext(\"I am not aware of the exact details, but it's obvious something terrible had taken place, so I think it'll be better if you go there and assess the damage yourself. An explorer like you seem more than capable of saving Kingdom of Mushroom. I have just written you a #brecommendation letter#k, so I suggest you head over to Kingdom of Mushroom immediately and look for the #bHead Patrol Officer#k.\\r\\n\\r\\n#fUI/UIWindow.img/QuestIcon/4/0#\\r\\n#v4032375# #t4032375#\");\n+            } else if (status == 3) {\n+                qm.sendYesNo(\"By the way, do you know where Kingdom of Mushroom is located? It'll be okay if you can find your way there, but if you don't mind, I can take you straight to the entrance.\");\n+            } else if (status == 4) {\n+                if (qm.canHold(4032375, 1)) {\n+                    if (!qm.haveItem(4032375, 1)) {\n+                        qm.gainItem(4032375, 1);\n+                    }\n+                    \n+                    qm.warp(106020000, 0);\n+                    qm.forceStartQuest();\n+                } else {\n+                    qm.sendOk(\"Please have a slot available in your Etc inventory.\");\n+                }\n+                \n+                qm.dispose();\n+                return;\n+            } else if (status == 5) {\n+                if (!qm.haveItem(4032375, 1)) {\n+                    qm.gainItem(4032375, 1);\n+                }\n+                \n+                qm.forceStartQuest();\n+                qm.dispose();\n+                return;\n+            }\n+        }\n+    }\n }\n \n function end(mode, type, selection) {\n-    status++;\n-\tif (mode != 1) {\n-\t    if(type == 1 && mode == 0)\n-\t\t    status -= 2;\n-\t\telse{\n-\t\t    qm.dispose();\n-\t\t\treturn;\n-\t\t}\n-\t}\n-\tif(status == 0)\n-\t\tqm.sendNext(\"Hmmm? Is that a #brecommendation letter from the job instructor#k??! What is this, are you the one that came to save us, the Kingdom of Mushroom?\");\n-\tif(status == 1)\n-\t\tqm.sendNextPrev(\"Hmmm... okay. Since the letter is from the job instructor, I suppose you are really the one. I apologize for not introducing myself to you earlier. I'm the #bHead Security Officer#k in charge of protecting King Mush. As you can see, this temporary hideout is protected by the team of security and soldiers. Our situation may be dire, but nevertheless, welcome to Kingdom of Mushroom.\");\n-\tif(status == 2){\n-\t\tqm.forceCompleteQuest();\n-\t\tqm.gainItem(4032375, -1);\n-\t\tqm.forceStartQuest(2312);\t\t\n-\t\tqm.dispose();\n-\t}\n-}\n+    if (mode == -1) {\n+        qm.dispose();\n+    } else {\n+        if(mode == 0 && type > 0) {\n+            qm.dispose();\n+            return;\n+        }\n+        \n+        if (mode == 1)\n+            status++;\n+        else\n+            status--;\n+        \n+        if (status == 0) {\n+            if (!qm.haveItem(4032375, 1)) {\n+                qm.sendNext(\"What do you want, hmmm?\");\n+                qm.dispose();\n+                return;\n+            }\n+            \n+            qm.sendNext(\"Hmmm? Is that a #brecommendation letter from the job instructor#k??! What is this, are you the one that came to save us, the Kingdom of Mushroom?\");\n+        } else if (status == 1) {\n+            qm.sendNextPrev(\"Hmmm... okay. Since the letter is from the job instructor, I suppose you are really the one. I apologize for not introducing myself to you earlier. I'm the #bHead Security Officer#k in charge of protecting King Mush. As you can see, this temporary hideout is protected by the team of security and soldiers. Our situation may be dire, but nevertheless, welcome to Kingdom of Mushroom.\");\n+        } else if (status == 2) {\n+            qm.gainItem(4032375, -1);\n+            qm.gainExp(6000);\n+            qm.forceCompleteQuest();\n+            qm.forceStartQuest(2312);\n+            qm.dispose();\n+        }\n+    }\n+}\n\\ No newline at end of file"}, {"sha": "9efd61d7f4a8a52c833e5e2d53b0dfcef5105bda", "filename": "scripts/quest/2306.js", "status": "modified", "additions": 89, "deletions": 49, "changes": 138, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/quest/2306.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/quest/2306.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/quest/2306.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -4,61 +4,101 @@\n \tDescription: \tQuest -  Kingdom of Mushroom in Danger\n =============================================================\n Version 1.0 - Script Done.(17/7/2010)\n+Version 2.0 - Script Reworked by Ronan.(16/11/2018)\n =============================================================\n */\n \n var status = -1;\n \n function start(mode, type, selection) {\n-    status++;\n-\tif (mode != 1) {\n-\t    if(type == 1 && mode == 0)\n-\t\t    status -= 2;\n-\t\telse{\n-\t\t\t//if(status == 0){\n-\t\t\t\tqm.sendOk(\"Really? It's an urgent matter, so if you have some time, please see me.\");\n-\t\t\t\tqm.dispose();\n-\t\t\t\treturn;\n-\t\t\t//} else if(status == 3){\n-\t\t\t\t//qm.sendNext(\"Okay. In that case, I'll just give you the routes to the Kingdom of Mushroom. #bNear the west entrance of Henesys,#k you'll find an #bempty house#k. Enter the house, and turn left to enter#b<Themed Dungeon : Mushroom Castle>#k. That's the entrance to the Kingdom of Mushroom. There's not much time!\");\n-\t\t\t\t//qm.forceStartQuest();\n-\t\t\t\t//return;\n-\t\t\t}\n-\t\t}\n-\t//}\n-\tif(status == 0) \n-\t\tqm.sendAcceptDecline(\"Now that you have made the job advancement, you look like you're ready for this. I have something I'd like to ask you for help. Are you willing to listen?\");\n-\tif(status == 1)\n-\t\tqm.sendNext(\"What happened is that the #bKingdom of Mushroom#k is currently in disarray. Kingdom of Mushroom is located near Henesys, featuring the peace-loving, intelligent King Mush. Recently, he began to feel ill, so he decided to appoint his only daughter #bPrincess Violetta#k. Something must have happened since then for the kingdom to be in its current state.\");\n-\tif(status == 2)\n-\t\tqm.sendNext(\"I am not aware of the exact details, but it's obvious something terrible had taken place, so I think it'll be better if you go there and assess the damage yourself. An explorer like you seem more than capable of saving Kingdom of Mushroom. I have just written you a #brecommendation letter#k, so I suggest you head over to Kingdom of Mushroom immediately and look for the #bHead Patrol Officer#k.\\r\\n\\r\\n#fUI/UIWindow.img/QuestIcon/4/0#\\r\\n#v4032375# #t4032375#\");\n-\tif(status == 3)\n-\t\tqm.sendYesNo(\"By the way, do you know where Kingdom of Mushroom is located? It'll be okay if you can find your way there, but if you don't mind, I can take you straight to the entrance.\");\n-\tif(status == 4){\n-\t\tqm.gainItem(4032375, 1);\n-\t\tqm.forceStartQuest();\n-\t\tqm.dispose();\n-\t}\n+    if (mode == -1) {\n+        qm.dispose();\n+    } else {\n+        if(mode == 0 && type > 0) {\n+            if (status != 3) {\n+                qm.sendOk(\"Really? It's an urgent matter, so if you have some time, please see me.\");\n+                qm.dispose();\n+            } else {\n+                if (qm.canHold(4032375, 1)) {\n+                    qm.sendNext(\"Okay. In that case, I'll just give you the routes to the Kingdom of Mushroom. #bNear the west entrance of Henesys,#k you'll find an #bempty house#k. Enter the house, and turn left to enter#b<Themed Dungeon : Mushroom Castle>#k. That's the entrance to the Kingdom of Mushroom. There's not much time!\");\n+                } else {\n+                    qm.sendOk(\"Please have a slot available in your Etc inventory.\");\n+                    qm.dispose();\n+                }\n+            }\n+            \n+            status++;\n+        } else {\n+            if (mode == 1)\n+                status++;\n+            else\n+                status--;\n+\n+            if (status == 0) {\n+                qm.sendAcceptDecline(\"Now that you have made the job advancement, you look like you're ready for this. I have something I'd like to ask you for help. Are you willing to listen?\");\n+            } else if (status == 1) {\n+                qm.sendNext(\"What happened is that the #bKingdom of Mushroom#k is currently in disarray. Kingdom of Mushroom is located near Henesys, featuring the peace-loving, intelligent King Mush. Recently, he began to feel ill, so he decided to appoint his only daughter #bPrincess Violetta#k. Something must have happened since then for the kingdom to be in its current state.\");\n+            } else if (status == 2) {\n+                qm.sendNext(\"I am not aware of the exact details, but it's obvious something terrible had taken place, so I think it'll be better if you go there and assess the damage yourself. An explorer like you seem more than capable of saving Kingdom of Mushroom. I have just written you a #brecommendation letter#k, so I suggest you head over to Kingdom of Mushroom immediately and look for the #bHead Patrol Officer#k.\\r\\n\\r\\n#fUI/UIWindow.img/QuestIcon/4/0#\\r\\n#v4032375# #t4032375#\");\n+            } else if (status == 3) {\n+                qm.sendYesNo(\"By the way, do you know where Kingdom of Mushroom is located? It'll be okay if you can find your way there, but if you don't mind, I can take you straight to the entrance.\");\n+            } else if (status == 4) {\n+                if (qm.canHold(4032375, 1)) {\n+                    if (!qm.haveItem(4032375, 1)) {\n+                        qm.gainItem(4032375, 1);\n+                    }\n+                    \n+                    qm.warp(106020000, 0);\n+                    qm.forceStartQuest();\n+                } else {\n+                    qm.sendOk(\"Please have a slot available in your Etc inventory.\");\n+                }\n+                \n+                qm.dispose();\n+                return;\n+            } else if (status == 5) {\n+                if (!qm.haveItem(4032375, 1)) {\n+                    qm.gainItem(4032375, 1);\n+                }\n+                \n+                qm.forceStartQuest();\n+                qm.dispose();\n+                return;\n+            }\n+        }\n+    }\n }\n \n function end(mode, type, selection) {\n-    status++;\n-\tif (mode != 1) {\n-\t    if(type == 1 && mode == 0)\n-\t\t    status -= 2;\n-\t\telse{\n-\t\t    qm.dispose();\n-\t\t\treturn;\n-\t\t}\n-\t}\n-\tif(status == 0)\n-\t\tqm.sendNext(\"Hmmm? Is that a #brecommendation letter from the job instructor#k??! What is this, are you the one that came to save us, the Kingdom of Mushroom?\");\n-\tif(status == 1)\n-\t\tqm.sendNextPrev(\"Hmmm... okay. Since the letter is from the job instructor, I suppose you are really the one. I apologize for not introducing myself to you earlier. I'm the #bHead Security Officer#k in charge of protecting King Mush. As you can see, this temporary hideout is protected by the team of security and soldiers. Our situation may be dire, but nevertheless, welcome to Kingdom of Mushroom.\");\n-\tif(status == 2){\n-\t\tqm.forceCompleteQuest();\n-\t\tqm.gainItem(4032375, -1);\n-\t\tqm.forceStartQuest(2312);\t\t\n-\t\tqm.dispose();\n-\t}\n-}\n+    if (mode == -1) {\n+        qm.dispose();\n+    } else {\n+        if(mode == 0 && type > 0) {\n+            qm.dispose();\n+            return;\n+        }\n+        \n+        if (mode == 1)\n+            status++;\n+        else\n+            status--;\n+        \n+        if (status == 0) {\n+            if (!qm.haveItem(4032375, 1)) {\n+                qm.sendNext(\"What do you want, hmmm?\");\n+                qm.dispose();\n+                return;\n+            }\n+            \n+            qm.sendNext(\"Hmmm? Is that a #brecommendation letter from the job instructor#k??! What is this, are you the one that came to save us, the Kingdom of Mushroom?\");\n+        } else if (status == 1) {\n+            qm.sendNextPrev(\"Hmmm... okay. Since the letter is from the job instructor, I suppose you are really the one. I apologize for not introducing myself to you earlier. I'm the #bHead Security Officer#k in charge of protecting King Mush. As you can see, this temporary hideout is protected by the team of security and soldiers. Our situation may be dire, but nevertheless, welcome to Kingdom of Mushroom.\");\n+        } else if (status == 2) {\n+            qm.gainItem(4032375, -1);\n+            qm.gainExp(6000);\n+            qm.forceCompleteQuest();\n+            qm.forceStartQuest(2312);\n+            qm.dispose();\n+        }\n+    }\n+}\n\\ No newline at end of file"}, {"sha": "9efd61d7f4a8a52c833e5e2d53b0dfcef5105bda", "filename": "scripts/quest/2307.js", "status": "modified", "additions": 89, "deletions": 49, "changes": 138, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/quest/2307.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/quest/2307.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/quest/2307.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -4,61 +4,101 @@\n \tDescription: \tQuest -  Kingdom of Mushroom in Danger\n =============================================================\n Version 1.0 - Script Done.(17/7/2010)\n+Version 2.0 - Script Reworked by Ronan.(16/11/2018)\n =============================================================\n */\n \n var status = -1;\n \n function start(mode, type, selection) {\n-    status++;\n-\tif (mode != 1) {\n-\t    if(type == 1 && mode == 0)\n-\t\t    status -= 2;\n-\t\telse{\n-\t\t\t//if(status == 0){\n-\t\t\t\tqm.sendOk(\"Really? It's an urgent matter, so if you have some time, please see me.\");\n-\t\t\t\tqm.dispose();\n-\t\t\t\treturn;\n-\t\t\t//} else if(status == 3){\n-\t\t\t\t//qm.sendNext(\"Okay. In that case, I'll just give you the routes to the Kingdom of Mushroom. #bNear the west entrance of Henesys,#k you'll find an #bempty house#k. Enter the house, and turn left to enter#b<Themed Dungeon : Mushroom Castle>#k. That's the entrance to the Kingdom of Mushroom. There's not much time!\");\n-\t\t\t\t//qm.forceStartQuest();\n-\t\t\t\t//return;\n-\t\t\t}\n-\t\t}\n-\t//}\n-\tif(status == 0) \n-\t\tqm.sendAcceptDecline(\"Now that you have made the job advancement, you look like you're ready for this. I have something I'd like to ask you for help. Are you willing to listen?\");\n-\tif(status == 1)\n-\t\tqm.sendNext(\"What happened is that the #bKingdom of Mushroom#k is currently in disarray. Kingdom of Mushroom is located near Henesys, featuring the peace-loving, intelligent King Mush. Recently, he began to feel ill, so he decided to appoint his only daughter #bPrincess Violetta#k. Something must have happened since then for the kingdom to be in its current state.\");\n-\tif(status == 2)\n-\t\tqm.sendNext(\"I am not aware of the exact details, but it's obvious something terrible had taken place, so I think it'll be better if you go there and assess the damage yourself. An explorer like you seem more than capable of saving Kingdom of Mushroom. I have just written you a #brecommendation letter#k, so I suggest you head over to Kingdom of Mushroom immediately and look for the #bHead Patrol Officer#k.\\r\\n\\r\\n#fUI/UIWindow.img/QuestIcon/4/0#\\r\\n#v4032375# #t4032375#\");\n-\tif(status == 3)\n-\t\tqm.sendYesNo(\"By the way, do you know where Kingdom of Mushroom is located? It'll be okay if you can find your way there, but if you don't mind, I can take you straight to the entrance.\");\n-\tif(status == 4){\n-\t\tqm.gainItem(4032375, 1);\n-\t\tqm.forceStartQuest();\n-\t\tqm.dispose();\n-\t}\n+    if (mode == -1) {\n+        qm.dispose();\n+    } else {\n+        if(mode == 0 && type > 0) {\n+            if (status != 3) {\n+                qm.sendOk(\"Really? It's an urgent matter, so if you have some time, please see me.\");\n+                qm.dispose();\n+            } else {\n+                if (qm.canHold(4032375, 1)) {\n+                    qm.sendNext(\"Okay. In that case, I'll just give you the routes to the Kingdom of Mushroom. #bNear the west entrance of Henesys,#k you'll find an #bempty house#k. Enter the house, and turn left to enter#b<Themed Dungeon : Mushroom Castle>#k. That's the entrance to the Kingdom of Mushroom. There's not much time!\");\n+                } else {\n+                    qm.sendOk(\"Please have a slot available in your Etc inventory.\");\n+                    qm.dispose();\n+                }\n+            }\n+            \n+            status++;\n+        } else {\n+            if (mode == 1)\n+                status++;\n+            else\n+                status--;\n+\n+            if (status == 0) {\n+                qm.sendAcceptDecline(\"Now that you have made the job advancement, you look like you're ready for this. I have something I'd like to ask you for help. Are you willing to listen?\");\n+            } else if (status == 1) {\n+                qm.sendNext(\"What happened is that the #bKingdom of Mushroom#k is currently in disarray. Kingdom of Mushroom is located near Henesys, featuring the peace-loving, intelligent King Mush. Recently, he began to feel ill, so he decided to appoint his only daughter #bPrincess Violetta#k. Something must have happened since then for the kingdom to be in its current state.\");\n+            } else if (status == 2) {\n+                qm.sendNext(\"I am not aware of the exact details, but it's obvious something terrible had taken place, so I think it'll be better if you go there and assess the damage yourself. An explorer like you seem more than capable of saving Kingdom of Mushroom. I have just written you a #brecommendation letter#k, so I suggest you head over to Kingdom of Mushroom immediately and look for the #bHead Patrol Officer#k.\\r\\n\\r\\n#fUI/UIWindow.img/QuestIcon/4/0#\\r\\n#v4032375# #t4032375#\");\n+            } else if (status == 3) {\n+                qm.sendYesNo(\"By the way, do you know where Kingdom of Mushroom is located? It'll be okay if you can find your way there, but if you don't mind, I can take you straight to the entrance.\");\n+            } else if (status == 4) {\n+                if (qm.canHold(4032375, 1)) {\n+                    if (!qm.haveItem(4032375, 1)) {\n+                        qm.gainItem(4032375, 1);\n+                    }\n+                    \n+                    qm.warp(106020000, 0);\n+                    qm.forceStartQuest();\n+                } else {\n+                    qm.sendOk(\"Please have a slot available in your Etc inventory.\");\n+                }\n+                \n+                qm.dispose();\n+                return;\n+            } else if (status == 5) {\n+                if (!qm.haveItem(4032375, 1)) {\n+                    qm.gainItem(4032375, 1);\n+                }\n+                \n+                qm.forceStartQuest();\n+                qm.dispose();\n+                return;\n+            }\n+        }\n+    }\n }\n \n function end(mode, type, selection) {\n-    status++;\n-\tif (mode != 1) {\n-\t    if(type == 1 && mode == 0)\n-\t\t    status -= 2;\n-\t\telse{\n-\t\t    qm.dispose();\n-\t\t\treturn;\n-\t\t}\n-\t}\n-\tif(status == 0)\n-\t\tqm.sendNext(\"Hmmm? Is that a #brecommendation letter from the job instructor#k??! What is this, are you the one that came to save us, the Kingdom of Mushroom?\");\n-\tif(status == 1)\n-\t\tqm.sendNextPrev(\"Hmmm... okay. Since the letter is from the job instructor, I suppose you are really the one. I apologize for not introducing myself to you earlier. I'm the #bHead Security Officer#k in charge of protecting King Mush. As you can see, this temporary hideout is protected by the team of security and soldiers. Our situation may be dire, but nevertheless, welcome to Kingdom of Mushroom.\");\n-\tif(status == 2){\n-\t\tqm.forceCompleteQuest();\n-\t\tqm.gainItem(4032375, -1);\n-\t\tqm.forceStartQuest(2312);\t\t\n-\t\tqm.dispose();\n-\t}\n-}\n+    if (mode == -1) {\n+        qm.dispose();\n+    } else {\n+        if(mode == 0 && type > 0) {\n+            qm.dispose();\n+            return;\n+        }\n+        \n+        if (mode == 1)\n+            status++;\n+        else\n+            status--;\n+        \n+        if (status == 0) {\n+            if (!qm.haveItem(4032375, 1)) {\n+                qm.sendNext(\"What do you want, hmmm?\");\n+                qm.dispose();\n+                return;\n+            }\n+            \n+            qm.sendNext(\"Hmmm? Is that a #brecommendation letter from the job instructor#k??! What is this, are you the one that came to save us, the Kingdom of Mushroom?\");\n+        } else if (status == 1) {\n+            qm.sendNextPrev(\"Hmmm... okay. Since the letter is from the job instructor, I suppose you are really the one. I apologize for not introducing myself to you earlier. I'm the #bHead Security Officer#k in charge of protecting King Mush. As you can see, this temporary hideout is protected by the team of security and soldiers. Our situation may be dire, but nevertheless, welcome to Kingdom of Mushroom.\");\n+        } else if (status == 2) {\n+            qm.gainItem(4032375, -1);\n+            qm.gainExp(6000);\n+            qm.forceCompleteQuest();\n+            qm.forceStartQuest(2312);\n+            qm.dispose();\n+        }\n+    }\n+}\n\\ No newline at end of file"}, {"sha": "9efd61d7f4a8a52c833e5e2d53b0dfcef5105bda", "filename": "scripts/quest/2308.js", "status": "modified", "additions": 89, "deletions": 49, "changes": 138, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/quest/2308.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/quest/2308.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/quest/2308.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -4,61 +4,101 @@\n \tDescription: \tQuest -  Kingdom of Mushroom in Danger\n =============================================================\n Version 1.0 - Script Done.(17/7/2010)\n+Version 2.0 - Script Reworked by Ronan.(16/11/2018)\n =============================================================\n */\n \n var status = -1;\n \n function start(mode, type, selection) {\n-    status++;\n-\tif (mode != 1) {\n-\t    if(type == 1 && mode == 0)\n-\t\t    status -= 2;\n-\t\telse{\n-\t\t\t//if(status == 0){\n-\t\t\t\tqm.sendOk(\"Really? It's an urgent matter, so if you have some time, please see me.\");\n-\t\t\t\tqm.dispose();\n-\t\t\t\treturn;\n-\t\t\t//} else if(status == 3){\n-\t\t\t\t//qm.sendNext(\"Okay. In that case, I'll just give you the routes to the Kingdom of Mushroom. #bNear the west entrance of Henesys,#k you'll find an #bempty house#k. Enter the house, and turn left to enter#b<Themed Dungeon : Mushroom Castle>#k. That's the entrance to the Kingdom of Mushroom. There's not much time!\");\n-\t\t\t\t//qm.forceStartQuest();\n-\t\t\t\t//return;\n-\t\t\t}\n-\t\t}\n-\t//}\n-\tif(status == 0) \n-\t\tqm.sendAcceptDecline(\"Now that you have made the job advancement, you look like you're ready for this. I have something I'd like to ask you for help. Are you willing to listen?\");\n-\tif(status == 1)\n-\t\tqm.sendNext(\"What happened is that the #bKingdom of Mushroom#k is currently in disarray. Kingdom of Mushroom is located near Henesys, featuring the peace-loving, intelligent King Mush. Recently, he began to feel ill, so he decided to appoint his only daughter #bPrincess Violetta#k. Something must have happened since then for the kingdom to be in its current state.\");\n-\tif(status == 2)\n-\t\tqm.sendNext(\"I am not aware of the exact details, but it's obvious something terrible had taken place, so I think it'll be better if you go there and assess the damage yourself. An explorer like you seem more than capable of saving Kingdom of Mushroom. I have just written you a #brecommendation letter#k, so I suggest you head over to Kingdom of Mushroom immediately and look for the #bHead Patrol Officer#k.\\r\\n\\r\\n#fUI/UIWindow.img/QuestIcon/4/0#\\r\\n#v4032375# #t4032375#\");\n-\tif(status == 3)\n-\t\tqm.sendYesNo(\"By the way, do you know where Kingdom of Mushroom is located? It'll be okay if you can find your way there, but if you don't mind, I can take you straight to the entrance.\");\n-\tif(status == 4){\n-\t\tqm.gainItem(4032375, 1);\n-\t\tqm.forceStartQuest();\n-\t\tqm.dispose();\n-\t}\n+    if (mode == -1) {\n+        qm.dispose();\n+    } else {\n+        if(mode == 0 && type > 0) {\n+            if (status != 3) {\n+                qm.sendOk(\"Really? It's an urgent matter, so if you have some time, please see me.\");\n+                qm.dispose();\n+            } else {\n+                if (qm.canHold(4032375, 1)) {\n+                    qm.sendNext(\"Okay. In that case, I'll just give you the routes to the Kingdom of Mushroom. #bNear the west entrance of Henesys,#k you'll find an #bempty house#k. Enter the house, and turn left to enter#b<Themed Dungeon : Mushroom Castle>#k. That's the entrance to the Kingdom of Mushroom. There's not much time!\");\n+                } else {\n+                    qm.sendOk(\"Please have a slot available in your Etc inventory.\");\n+                    qm.dispose();\n+                }\n+            }\n+            \n+            status++;\n+        } else {\n+            if (mode == 1)\n+                status++;\n+            else\n+                status--;\n+\n+            if (status == 0) {\n+                qm.sendAcceptDecline(\"Now that you have made the job advancement, you look like you're ready for this. I have something I'd like to ask you for help. Are you willing to listen?\");\n+            } else if (status == 1) {\n+                qm.sendNext(\"What happened is that the #bKingdom of Mushroom#k is currently in disarray. Kingdom of Mushroom is located near Henesys, featuring the peace-loving, intelligent King Mush. Recently, he began to feel ill, so he decided to appoint his only daughter #bPrincess Violetta#k. Something must have happened since then for the kingdom to be in its current state.\");\n+            } else if (status == 2) {\n+                qm.sendNext(\"I am not aware of the exact details, but it's obvious something terrible had taken place, so I think it'll be better if you go there and assess the damage yourself. An explorer like you seem more than capable of saving Kingdom of Mushroom. I have just written you a #brecommendation letter#k, so I suggest you head over to Kingdom of Mushroom immediately and look for the #bHead Patrol Officer#k.\\r\\n\\r\\n#fUI/UIWindow.img/QuestIcon/4/0#\\r\\n#v4032375# #t4032375#\");\n+            } else if (status == 3) {\n+                qm.sendYesNo(\"By the way, do you know where Kingdom of Mushroom is located? It'll be okay if you can find your way there, but if you don't mind, I can take you straight to the entrance.\");\n+            } else if (status == 4) {\n+                if (qm.canHold(4032375, 1)) {\n+                    if (!qm.haveItem(4032375, 1)) {\n+                        qm.gainItem(4032375, 1);\n+                    }\n+                    \n+                    qm.warp(106020000, 0);\n+                    qm.forceStartQuest();\n+                } else {\n+                    qm.sendOk(\"Please have a slot available in your Etc inventory.\");\n+                }\n+                \n+                qm.dispose();\n+                return;\n+            } else if (status == 5) {\n+                if (!qm.haveItem(4032375, 1)) {\n+                    qm.gainItem(4032375, 1);\n+                }\n+                \n+                qm.forceStartQuest();\n+                qm.dispose();\n+                return;\n+            }\n+        }\n+    }\n }\n \n function end(mode, type, selection) {\n-    status++;\n-\tif (mode != 1) {\n-\t    if(type == 1 && mode == 0)\n-\t\t    status -= 2;\n-\t\telse{\n-\t\t    qm.dispose();\n-\t\t\treturn;\n-\t\t}\n-\t}\n-\tif(status == 0)\n-\t\tqm.sendNext(\"Hmmm? Is that a #brecommendation letter from the job instructor#k??! What is this, are you the one that came to save us, the Kingdom of Mushroom?\");\n-\tif(status == 1)\n-\t\tqm.sendNextPrev(\"Hmmm... okay. Since the letter is from the job instructor, I suppose you are really the one. I apologize for not introducing myself to you earlier. I'm the #bHead Security Officer#k in charge of protecting King Mush. As you can see, this temporary hideout is protected by the team of security and soldiers. Our situation may be dire, but nevertheless, welcome to Kingdom of Mushroom.\");\n-\tif(status == 2){\n-\t\tqm.forceCompleteQuest();\n-\t\tqm.gainItem(4032375, -1);\n-\t\tqm.forceStartQuest(2312);\t\t\n-\t\tqm.dispose();\n-\t}\n-}\n+    if (mode == -1) {\n+        qm.dispose();\n+    } else {\n+        if(mode == 0 && type > 0) {\n+            qm.dispose();\n+            return;\n+        }\n+        \n+        if (mode == 1)\n+            status++;\n+        else\n+            status--;\n+        \n+        if (status == 0) {\n+            if (!qm.haveItem(4032375, 1)) {\n+                qm.sendNext(\"What do you want, hmmm?\");\n+                qm.dispose();\n+                return;\n+            }\n+            \n+            qm.sendNext(\"Hmmm? Is that a #brecommendation letter from the job instructor#k??! What is this, are you the one that came to save us, the Kingdom of Mushroom?\");\n+        } else if (status == 1) {\n+            qm.sendNextPrev(\"Hmmm... okay. Since the letter is from the job instructor, I suppose you are really the one. I apologize for not introducing myself to you earlier. I'm the #bHead Security Officer#k in charge of protecting King Mush. As you can see, this temporary hideout is protected by the team of security and soldiers. Our situation may be dire, but nevertheless, welcome to Kingdom of Mushroom.\");\n+        } else if (status == 2) {\n+            qm.gainItem(4032375, -1);\n+            qm.gainExp(6000);\n+            qm.forceCompleteQuest();\n+            qm.forceStartQuest(2312);\n+            qm.dispose();\n+        }\n+    }\n+}\n\\ No newline at end of file"}, {"sha": "9efd61d7f4a8a52c833e5e2d53b0dfcef5105bda", "filename": "scripts/quest/2309.js", "status": "modified", "additions": 89, "deletions": 49, "changes": 138, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/quest/2309.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/quest/2309.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/quest/2309.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -4,61 +4,101 @@\n \tDescription: \tQuest -  Kingdom of Mushroom in Danger\n =============================================================\n Version 1.0 - Script Done.(17/7/2010)\n+Version 2.0 - Script Reworked by Ronan.(16/11/2018)\n =============================================================\n */\n \n var status = -1;\n \n function start(mode, type, selection) {\n-    status++;\n-\tif (mode != 1) {\n-\t    if(type == 1 && mode == 0)\n-\t\t    status -= 2;\n-\t\telse{\n-\t\t\t//if(status == 0){\n-\t\t\t\tqm.sendOk(\"Really? It's an urgent matter, so if you have some time, please see me.\");\n-\t\t\t\tqm.dispose();\n-\t\t\t\treturn;\n-\t\t\t//} else if(status == 3){\n-\t\t\t\t//qm.sendNext(\"Okay. In that case, I'll just give you the routes to the Kingdom of Mushroom. #bNear the west entrance of Henesys,#k you'll find an #bempty house#k. Enter the house, and turn left to enter#b<Themed Dungeon : Mushroom Castle>#k. That's the entrance to the Kingdom of Mushroom. There's not much time!\");\n-\t\t\t\t//qm.forceStartQuest();\n-\t\t\t\t//return;\n-\t\t\t}\n-\t\t}\n-\t//}\n-\tif(status == 0) \n-\t\tqm.sendAcceptDecline(\"Now that you have made the job advancement, you look like you're ready for this. I have something I'd like to ask you for help. Are you willing to listen?\");\n-\tif(status == 1)\n-\t\tqm.sendNext(\"What happened is that the #bKingdom of Mushroom#k is currently in disarray. Kingdom of Mushroom is located near Henesys, featuring the peace-loving, intelligent King Mush. Recently, he began to feel ill, so he decided to appoint his only daughter #bPrincess Violetta#k. Something must have happened since then for the kingdom to be in its current state.\");\n-\tif(status == 2)\n-\t\tqm.sendNext(\"I am not aware of the exact details, but it's obvious something terrible had taken place, so I think it'll be better if you go there and assess the damage yourself. An explorer like you seem more than capable of saving Kingdom of Mushroom. I have just written you a #brecommendation letter#k, so I suggest you head over to Kingdom of Mushroom immediately and look for the #bHead Patrol Officer#k.\\r\\n\\r\\n#fUI/UIWindow.img/QuestIcon/4/0#\\r\\n#v4032375# #t4032375#\");\n-\tif(status == 3)\n-\t\tqm.sendYesNo(\"By the way, do you know where Kingdom of Mushroom is located? It'll be okay if you can find your way there, but if you don't mind, I can take you straight to the entrance.\");\n-\tif(status == 4){\n-\t\tqm.gainItem(4032375, 1);\n-\t\tqm.forceStartQuest();\n-\t\tqm.dispose();\n-\t}\n+    if (mode == -1) {\n+        qm.dispose();\n+    } else {\n+        if(mode == 0 && type > 0) {\n+            if (status != 3) {\n+                qm.sendOk(\"Really? It's an urgent matter, so if you have some time, please see me.\");\n+                qm.dispose();\n+            } else {\n+                if (qm.canHold(4032375, 1)) {\n+                    qm.sendNext(\"Okay. In that case, I'll just give you the routes to the Kingdom of Mushroom. #bNear the west entrance of Henesys,#k you'll find an #bempty house#k. Enter the house, and turn left to enter#b<Themed Dungeon : Mushroom Castle>#k. That's the entrance to the Kingdom of Mushroom. There's not much time!\");\n+                } else {\n+                    qm.sendOk(\"Please have a slot available in your Etc inventory.\");\n+                    qm.dispose();\n+                }\n+            }\n+            \n+            status++;\n+        } else {\n+            if (mode == 1)\n+                status++;\n+            else\n+                status--;\n+\n+            if (status == 0) {\n+                qm.sendAcceptDecline(\"Now that you have made the job advancement, you look like you're ready for this. I have something I'd like to ask you for help. Are you willing to listen?\");\n+            } else if (status == 1) {\n+                qm.sendNext(\"What happened is that the #bKingdom of Mushroom#k is currently in disarray. Kingdom of Mushroom is located near Henesys, featuring the peace-loving, intelligent King Mush. Recently, he began to feel ill, so he decided to appoint his only daughter #bPrincess Violetta#k. Something must have happened since then for the kingdom to be in its current state.\");\n+            } else if (status == 2) {\n+                qm.sendNext(\"I am not aware of the exact details, but it's obvious something terrible had taken place, so I think it'll be better if you go there and assess the damage yourself. An explorer like you seem more than capable of saving Kingdom of Mushroom. I have just written you a #brecommendation letter#k, so I suggest you head over to Kingdom of Mushroom immediately and look for the #bHead Patrol Officer#k.\\r\\n\\r\\n#fUI/UIWindow.img/QuestIcon/4/0#\\r\\n#v4032375# #t4032375#\");\n+            } else if (status == 3) {\n+                qm.sendYesNo(\"By the way, do you know where Kingdom of Mushroom is located? It'll be okay if you can find your way there, but if you don't mind, I can take you straight to the entrance.\");\n+            } else if (status == 4) {\n+                if (qm.canHold(4032375, 1)) {\n+                    if (!qm.haveItem(4032375, 1)) {\n+                        qm.gainItem(4032375, 1);\n+                    }\n+                    \n+                    qm.warp(106020000, 0);\n+                    qm.forceStartQuest();\n+                } else {\n+                    qm.sendOk(\"Please have a slot available in your Etc inventory.\");\n+                }\n+                \n+                qm.dispose();\n+                return;\n+            } else if (status == 5) {\n+                if (!qm.haveItem(4032375, 1)) {\n+                    qm.gainItem(4032375, 1);\n+                }\n+                \n+                qm.forceStartQuest();\n+                qm.dispose();\n+                return;\n+            }\n+        }\n+    }\n }\n \n function end(mode, type, selection) {\n-    status++;\n-\tif (mode != 1) {\n-\t    if(type == 1 && mode == 0)\n-\t\t    status -= 2;\n-\t\telse{\n-\t\t    qm.dispose();\n-\t\t\treturn;\n-\t\t}\n-\t}\n-\tif(status == 0)\n-\t\tqm.sendNext(\"Hmmm? Is that a #brecommendation letter from the job instructor#k??! What is this, are you the one that came to save us, the Kingdom of Mushroom?\");\n-\tif(status == 1)\n-\t\tqm.sendNextPrev(\"Hmmm... okay. Since the letter is from the job instructor, I suppose you are really the one. I apologize for not introducing myself to you earlier. I'm the #bHead Security Officer#k in charge of protecting King Mush. As you can see, this temporary hideout is protected by the team of security and soldiers. Our situation may be dire, but nevertheless, welcome to Kingdom of Mushroom.\");\n-\tif(status == 2){\n-\t\tqm.forceCompleteQuest();\n-\t\tqm.gainItem(4032375, -1);\n-\t\tqm.forceStartQuest(2312);\t\t\n-\t\tqm.dispose();\n-\t}\n-}\n+    if (mode == -1) {\n+        qm.dispose();\n+    } else {\n+        if(mode == 0 && type > 0) {\n+            qm.dispose();\n+            return;\n+        }\n+        \n+        if (mode == 1)\n+            status++;\n+        else\n+            status--;\n+        \n+        if (status == 0) {\n+            if (!qm.haveItem(4032375, 1)) {\n+                qm.sendNext(\"What do you want, hmmm?\");\n+                qm.dispose();\n+                return;\n+            }\n+            \n+            qm.sendNext(\"Hmmm? Is that a #brecommendation letter from the job instructor#k??! What is this, are you the one that came to save us, the Kingdom of Mushroom?\");\n+        } else if (status == 1) {\n+            qm.sendNextPrev(\"Hmmm... okay. Since the letter is from the job instructor, I suppose you are really the one. I apologize for not introducing myself to you earlier. I'm the #bHead Security Officer#k in charge of protecting King Mush. As you can see, this temporary hideout is protected by the team of security and soldiers. Our situation may be dire, but nevertheless, welcome to Kingdom of Mushroom.\");\n+        } else if (status == 2) {\n+            qm.gainItem(4032375, -1);\n+            qm.gainExp(6000);\n+            qm.forceCompleteQuest();\n+            qm.forceStartQuest(2312);\n+            qm.dispose();\n+        }\n+    }\n+}\n\\ No newline at end of file"}, {"sha": "9efd61d7f4a8a52c833e5e2d53b0dfcef5105bda", "filename": "scripts/quest/2310.js", "status": "modified", "additions": 86, "deletions": 46, "changes": 132, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/quest/2310.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/quest/2310.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/quest/2310.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -4,61 +4,101 @@\n \tDescription: \tQuest -  Kingdom of Mushroom in Danger\n =============================================================\n Version 1.0 - Script Done.(17/7/2010)\n+Version 2.0 - Script Reworked by Ronan.(16/11/2018)\n =============================================================\n */\n \n var status = -1;\n \n function start(mode, type, selection) {\n-    status++;\n-\tif (mode != 1) {\n-\t    if(type == 1 && mode == 0)\n-\t\t    status -= 2;\n-\t\telse {\n-\t\t\t//if(status == 0){\n-\t\t\t\tqm.sendOk(\"Really? It's an urgent matter, so if you have some time, please see me.\");\n-\t\t\t\tqm.dispose();\n-\t\t\t\treturn;\n-\t\t\t//} else if(status == 3){\n-\t\t\t\t//qm.sendNext(\"Okay. In that case, I'll just give you the routes to the Kingdom of Mushroom. #bNear the west entrance of Henesys,#k you'll find an #bempty house#k. Enter the house, and turn left to enter#b<Themed Dungeon : Mushroom Castle>#k. That's the entrance to the Kingdom of Mushroom. There's not much time!\");\n-\t\t\t\t//qm.forceStartQuest();\n-\t\t\t\t//return;\n+    if (mode == -1) {\n+        qm.dispose();\n+    } else {\n+        if(mode == 0 && type > 0) {\n+            if (status != 3) {\n+                qm.sendOk(\"Really? It's an urgent matter, so if you have some time, please see me.\");\n+                qm.dispose();\n+            } else {\n+                if (qm.canHold(4032375, 1)) {\n+                    qm.sendNext(\"Okay. In that case, I'll just give you the routes to the Kingdom of Mushroom. #bNear the west entrance of Henesys,#k you'll find an #bempty house#k. Enter the house, and turn left to enter#b<Themed Dungeon : Mushroom Castle>#k. That's the entrance to the Kingdom of Mushroom. There's not much time!\");\n+                } else {\n+                    qm.sendOk(\"Please have a slot available in your Etc inventory.\");\n+                    qm.dispose();\n                 }\n+            }\n+            \n+            status++;\n+        } else {\n+            if (mode == 1)\n+                status++;\n+            else\n+                status--;\n+\n+            if (status == 0) {\n+                qm.sendAcceptDecline(\"Now that you have made the job advancement, you look like you're ready for this. I have something I'd like to ask you for help. Are you willing to listen?\");\n+            } else if (status == 1) {\n+                qm.sendNext(\"What happened is that the #bKingdom of Mushroom#k is currently in disarray. Kingdom of Mushroom is located near Henesys, featuring the peace-loving, intelligent King Mush. Recently, he began to feel ill, so he decided to appoint his only daughter #bPrincess Violetta#k. Something must have happened since then for the kingdom to be in its current state.\");\n+            } else if (status == 2) {\n+                qm.sendNext(\"I am not aware of the exact details, but it's obvious something terrible had taken place, so I think it'll be better if you go there and assess the damage yourself. An explorer like you seem more than capable of saving Kingdom of Mushroom. I have just written you a #brecommendation letter#k, so I suggest you head over to Kingdom of Mushroom immediately and look for the #bHead Patrol Officer#k.\\r\\n\\r\\n#fUI/UIWindow.img/QuestIcon/4/0#\\r\\n#v4032375# #t4032375#\");\n+            } else if (status == 3) {\n+                qm.sendYesNo(\"By the way, do you know where Kingdom of Mushroom is located? It'll be okay if you can find your way there, but if you don't mind, I can take you straight to the entrance.\");\n+            } else if (status == 4) {\n+                if (qm.canHold(4032375, 1)) {\n+                    if (!qm.haveItem(4032375, 1)) {\n+                        qm.gainItem(4032375, 1);\n+                    }\n+                    \n+                    qm.warp(106020000, 0);\n+                    qm.forceStartQuest();\n+                } else {\n+                    qm.sendOk(\"Please have a slot available in your Etc inventory.\");\n+                }\n+                \n+                qm.dispose();\n+                return;\n+            } else if (status == 5) {\n+                if (!qm.haveItem(4032375, 1)) {\n+                    qm.gainItem(4032375, 1);\n+                }\n+                \n+                qm.forceStartQuest();\n+                qm.dispose();\n+                return;\n+            }\n         }\n-\t//}\n-\tif(status == 0) \n-\t\tqm.sendAcceptDecline(\"Now that you have made the job advancement, you look like you're ready for this. I have something I'd like to ask you for help. Are you willing to listen?\");\n-\tif(status == 1)\n-\t\tqm.sendNext(\"What happened is that the #bKingdom of Mushroom#k is currently in disarray. Kingdom of Mushroom is located near Henesys, featuring the peace-loving, intelligent King Mush. Recently, he began to feel ill, so he decided to appoint his only daughter #bPrincess Violetta#k. Something must have happened since then for the kingdom to be in its current state.\");\n-\tif(status == 2)\n-\t\tqm.sendNext(\"I am not aware of the exact details, but it's obvious something terrible had taken place, so I think it'll be better if you go there and assess the damage yourself. An explorer like you seem more than capable of saving Kingdom of Mushroom. I have just written you a #brecommendation letter#k, so I suggest you head over to Kingdom of Mushroom immediately and look for the #bHead Patrol Officer#k.\\r\\n\\r\\n#fUI/UIWindow.img/QuestIcon/4/0#\\r\\n#v4032375# #t4032375#\");\n-\tif(status == 3)\n-\t\tqm.sendYesNo(\"By the way, do you know where Kingdom of Mushroom is located? It'll be okay if you can find your way there, but if you don't mind, I can take you straight to the entrance.\");\n-\tif(status == 4){\n-\t\tqm.gainItem(4032375, 1);\n-\t\tqm.forceStartQuest();\n-\t\tqm.dispose();\n-\t}\n+    }\n }\n \n function end(mode, type, selection) {\n-    status++;\n-\tif (mode != 1) {\n-\t    if(type == 1 && mode == 0)\n-\t\t    status -= 2;\n-\t\telse{\n-                        qm.dispose();\n-\t\t\treturn;\n-\t\t}\n-\t}\n-\tif(status == 0)\n-\t\tqm.sendNext(\"Hmmm? Is that a #brecommendation letter from the job instructor#k??! What is this, are you the one that came to save us, the Kingdom of Mushroom?\");\n-\tif(status == 1)\n-\t\tqm.sendNextPrev(\"Hmmm... okay. Since the letter is from the job instructor, I suppose you are really the one. I apologize for not introducing myself to you earlier. I'm the #bHead Security Officer#k in charge of protecting King Mush. As you can see, this temporary hideout is protected by the team of security and soldiers. Our situation may be dire, but nevertheless, welcome to Kingdom of Mushroom.\");\n-\tif(status == 2){\n-\t\tqm.forceCompleteQuest();\n-\t\tqm.gainItem(4032375, -1);\n-\t\tqm.forceStartQuest(2312);\t\t\n-\t\tqm.dispose();\n-\t}\n+    if (mode == -1) {\n+        qm.dispose();\n+    } else {\n+        if(mode == 0 && type > 0) {\n+            qm.dispose();\n+            return;\n+        }\n+        \n+        if (mode == 1)\n+            status++;\n+        else\n+            status--;\n+        \n+        if (status == 0) {\n+            if (!qm.haveItem(4032375, 1)) {\n+                qm.sendNext(\"What do you want, hmmm?\");\n+                qm.dispose();\n+                return;\n+            }\n+            \n+            qm.sendNext(\"Hmmm? Is that a #brecommendation letter from the job instructor#k??! What is this, are you the one that came to save us, the Kingdom of Mushroom?\");\n+        } else if (status == 1) {\n+            qm.sendNextPrev(\"Hmmm... okay. Since the letter is from the job instructor, I suppose you are really the one. I apologize for not introducing myself to you earlier. I'm the #bHead Security Officer#k in charge of protecting King Mush. As you can see, this temporary hideout is protected by the team of security and soldiers. Our situation may be dire, but nevertheless, welcome to Kingdom of Mushroom.\");\n+        } else if (status == 2) {\n+            qm.gainItem(4032375, -1);\n+            qm.gainExp(6000);\n+            qm.forceCompleteQuest();\n+            qm.forceStartQuest(2312);\n+            qm.dispose();\n+        }\n+    }\n }\n\\ No newline at end of file"}, {"sha": "cf9ae4054a1809af99c7bcaa8efdd22e31b7882f", "filename": "scripts/quest/6410.js", "status": "added", "additions": 57, "deletions": 0, "changes": 57, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/quest/6410.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/quest/6410.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/quest/6410.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -0,0 +1,57 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+/* \n+\tHypnotize skill quest\n+ */\n+\n+var status = -1;\n+\n+function end(mode, type, selection) {\n+    if (mode == -1) {\n+        qm.dispose();\n+    } else {\n+        if(mode == 0 && type > 0) {\n+            qm.dispose();\n+            return;\n+        }\n+        \n+        if (mode == 1)\n+            status++;\n+        else\n+            status--;\n+        \n+        if (status == 0) {\n+            if (qm.getQuestProgress(6410, 0) == 0) {\n+                qm.sendOk(\"You must save #r#p2095000##k first!\");\n+                qm.dispose();\n+            } else {\n+                qm.sendNext(\"Again, thank you so much for rescuing me. I don't know how to repay you for all this... both Shulynch and you are the nicest people I have encountered. If you approach the mobs the same way you approached me, they may all end up becoming friends with you, as well. Please never lose the kindness you have in you.\");\n+            }\n+        } else if (status == 1) {\n+            qm.sendNext(\"(Friends with the mobs... never lose the kindness.)\\r\\n\\r\\n  #s5221009#    #b#q5221009##k\");\n+        } else if (status == 2) {\n+            qm.gainExp(1200000);\n+            qm.teachSkill(5221009, 0, 10, -1);\n+            \n+            qm.forceCompleteQuest();\n+            qm.dispose();\n+        }\n+    }\n+}\n\\ No newline at end of file"}, {"sha": "948fb8c383ba134fd0167fd3f76057ccaff9b364", "filename": "scripts/reactor/1200000.js", "status": "added", "additions": 29, "deletions": 0, "changes": 29, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/reactor/1200000.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/reactor/1200000.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/reactor/1200000.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -0,0 +1,29 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/* @Author Ronan\n+ * \n+ * 1200000.js: Bart reactor, Aerial Strike skill\n+*/\n+\n+function act() {    // string visibility thanks to ProXAIMeRx & Glvelturall\n+    rm.message(\"Failed to find Bart. Returning to the original location.\");\n+    rm.warp(120000102);\n+}\n\\ No newline at end of file"}, {"sha": "4f830d783f51830ba23bad8f1196e3d12fe755bd", "filename": "scripts/reactor/1209000.js", "status": "added", "additions": 29, "deletions": 0, "changes": 29, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/reactor/1209000.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/reactor/1209000.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/reactor/1209000.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -0,0 +1,29 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/* @Author Ronan\n+ * \n+ * 1200000.js: Bart reactor, Aerial Strike skill\n+*/\n+\n+function act() {    // string visibility thanks to ProXAIMeRx & Glvelturall\n+    if (rm.isQuestStarted(6400)) rm.setQuestProgress(6400, 0, 2);\n+    rm.message(\"Real Bart has found. Return to Jonathan through portal.\");\n+}\n\\ No newline at end of file"}, {"sha": "b0262c797848dcdc955445a5c08ddf5dc93c4341", "filename": "scripts/reactor/2001.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/reactor/2001.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/reactor/2001.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/reactor/2001.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -19,7 +19,7 @@\n     You should have received a copy of the GNU Affero General Public License\n     along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n-/* @Author Lerk Hi :()\n+/* @Author Lerk - Hi :()\n  * \n  * 2001.js: Maple Island Box - drops various items, notably quest items Old Wooden Board and Rusty Screw\n */"}, {"sha": "1e9927cf160297ccf2a0433b5a0e84e617a78395", "filename": "scripts/reactor/8098000.js", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/scripts/reactor/8098000.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/scripts/reactor/8098000.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/reactor/8098000.js?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -20,8 +20,8 @@\n     along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n /*\n- * @author RMZero213 (base)\n- * @author Moogra (fixed, clean up)\n+ * @author RMZero213 - base\n+ * @author Moogra - fixed, clean up\n  */\n function act() {\n     var map = rm.getPlayer().getMapId();"}, {"sha": "afdd3df648770c760f15fcadf7c8cff822bca7fa", "filename": "sql/db_drops.sql", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/sql/db_drops.sql", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/sql/db_drops.sql", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/sql/db_drops.sql?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -20300,7 +20300,8 @@ USE `heavenms`;\n (6130102, 2022001, 1, 1, 0, 20000),\n (6130103, 2022001, 1, 1, 0, 20000),\n (6130200, 2022001, 1, 1, 0, 20000),\n-(6130201, 2022001, 1, 1, 0, 20000);\n+(6130201, 2022001, 1, 1, 0, 20000),\n+(2220000, 1322001, 1, 1, 0, 8000);\n \n # (dropperid, itemid, minqty, maxqty, questid, chance)\n \n@@ -21534,7 +21535,7 @@ USE `heavenms`;\n  INSERT IGNORE INTO drop_data (`dropperid`, `itemid`, `minimum_quantity`, `maximum_quantity`, `questid`, `chance`)\n  SELECT 3000004, `itemid`, `minimum_quantity`, `maximum_quantity`, `questid`, `chance` FROM drop_data WHERE dropperid = 3000001;\n \n- -- Thanks to DietStory dev team\n+ -- Thanks to DietStory v1.02 dev team\n  -- There are two Jr. Boogies mob ids for some unknown reason. 3230301 had no drops, but 3230300 had all the correct drops.\n  -- Just copying the drops from the one with the correct drop data.\n  INSERT IGNORE INTO drop_data (`dropperid`, `itemid`, `minimum_quantity`, `maximum_quantity`, `questid`, `chance`)"}, {"sha": "fbf4e67d08bee417651b32558d9d0acccadef7a1", "filename": "sql/db_shopupdate.sql", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/sql/db_shopupdate.sql", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/sql/db_shopupdate.sql", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/sql/db_shopupdate.sql?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -165,10 +165,10 @@ INSERT IGNORE INTO `shopitems` (`shopid`, `itemid`, `price`, `pitch`, `position`\n (9270065, 2030100, 450, 0, 3),\n (9270022, 2030100, 450, 0, 118);\n \n-# Thanks to Vcoc\n-# GMShop: Sacks, GmEquip, Cheese & Onyx, Utils, \n-#         Arrows, Bullets, Throwings and Capsules,\n-#         Others, Equips, Mounts, Scrolls.\n+-- Thanks to Vcoc\n+-- GMShop: Sacks, GmEquip, Cheese & Onyx, Utils, \n+--        Arrows, Bullets, Throwings and Capsules,\n+--        Others, Equips, Mounts, Scrolls.\n \n DELETE FROM `shopitems` WHERE `shopid`=1337;\n INSERT INTO `shopitems` ( `shopid`, `itemid`, `price`, `position`) VALUES\n@@ -258,7 +258,7 @@ INSERT INTO `shopitems` ( `shopid`, `itemid`, `price`, `position`) VALUES\n (1337, 2210032, 1, 84),\n (1337, 2050004, 1, 85);\n \n-# Thanks to DietStory dev team\n+-- Thanks to DietStory v1.02 dev team\n INSERT INTO `shopitems` ( `shopid`, `itemid`, `price`, `pitch`, `position`) VALUES\n  (1200001, 3010001, 1000, 0, 1),\n  (1200001, 1092003, 2000, 0, 2),"}, {"sha": "b1ec0630d8a994869f92ec4ca129fdf2ff76e047", "filename": "src/client/MapleCharacter.java", "status": "modified", "additions": 19, "deletions": 12, "changes": 31, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/client/MapleCharacter.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/client/MapleCharacter.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/MapleCharacter.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -192,7 +192,6 @@\n     private int mesosTraded = 0;\n     private int possibleReports = 10;\n     private int dojoPoints, vanquisherStage, dojoStage, dojoEnergy, vanquisherKills;\n-    private int warpToId;\n     private int expRate = 1, mesoRate = 1, dropRate = 1, expCoupon = 1, mesoCoupon = 1, dropCoupon = 1;\n     private int omokwins, omokties, omoklosses, matchcardwins, matchcardties, matchcardlosses;\n     private int owlSearch;\n@@ -277,6 +276,7 @@\n     private Lock evtLock = MonitoredReentrantLockFactory.createLock(MonitoredLockType.CHARACTER_EVT, true);\n     private Lock petLock = MonitoredReentrantLockFactory.createLock(MonitoredLockType.CHARACTER_PET, true); // for meso & quest tasks as well\n     private Lock prtLock = MonitoredReentrantLockFactory.createLock(MonitoredLockType.CHARACTER_PRT);\n+    private Lock cpnLock = MonitoredReentrantLockFactory.createLock(MonitoredLockType.CHARACTER_CPN);\n     private Map<Integer, Set<Integer>> excluded = new LinkedHashMap<>();\n     private Set<Integer> excludedItems = new LinkedHashSet<>();\n     private static String[] ariantroomleader = new String[3];\n@@ -1593,7 +1593,6 @@ private void changeMapInternal(final MapleMap to, final Point pos, final byte[]\n             map.addPlayer(this);\n             visitMap(map);\n             \n-            silentPartyUpdateInternal(getParty());  // EIM script calls inside\n             prtLock.lock();\n             try {\n                 if (party != null) {\n@@ -1604,6 +1603,7 @@ private void changeMapInternal(final MapleMap to, final Point pos, final byte[]\n             } finally {\n                 prtLock.unlock();\n             }\n+            silentPartyUpdateInternal(getParty());  // EIM script calls inside\n             \n             if (getMap().getHPDec() > 0) resetHpDecreaseTask();\n         } else {\n@@ -3029,10 +3029,6 @@ public int getAllianceRank() {\n         return allianceRank;\n     }\n \n-    public int getAllowWarpToId() {\n-        return warpToId;\n-    }\n-\n     public static String getAriantRoomLeaderName(int room) {\n         return ariantroomleader[room];\n     }\n@@ -6064,8 +6060,23 @@ private void revertCouponRates() {\n     }\n     \n     public void updateCouponRates() {\n-        revertCouponRates();\n-        setCouponRates();\n+        if (cpnLock.tryLock()) {\n+            MapleInventory cashInv = this.getInventory(MapleInventoryType.CASH);\n+            \n+            effLock.lock();\n+            chrLock.lock();\n+            cashInv.lockInventory();\n+            try {\n+                revertCouponRates();\n+                setCouponRates();\n+            } finally {\n+                cpnLock.unlock();\n+                \n+                cashInv.unlockInventory();\n+                chrLock.unlock();\n+                effLock.unlock();\n+            }\n+        }\n     }\n     \n     public void resetPlayerRates() {\n@@ -8011,10 +8022,6 @@ public void sendNote(String to, String msg, byte fame) throws SQLException {\n         }\n     }\n \n-    public void setAllowWarpToId(int id) {\n-        this.warpToId = id;\n-    }\n-\n     public static void setAriantRoomLeader(int room, String charname) {\n         ariantroomleader[room] = charname;\n     }"}, {"sha": "b6c3c4108aa6a38b6e1c43e49bab592d38cb28f3", "filename": "src/client/MapleClient.java", "status": "modified", "additions": 10, "deletions": 8, "changes": 18, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/client/MapleClient.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/client/MapleClient.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/MapleClient.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -850,7 +850,7 @@ private void removePartyPlayer(World wserv) {\n                 }\n         }\n         \n-\tprivate void removePlayer(World wserv) {\n+\tprivate void removePlayer(World wserv, boolean serverTransition) {\n \t\ttry {\n                         player.setDisconnectedFromChannelWorld();\n                         player.notifyMapTransferToPartner(-1);\n@@ -859,12 +859,14 @@ private void removePlayer(World wserv) {\n                         player.closePlayerInteractions();\n                         QuestScriptManager.getInstance().dispose(this);\n                         \n-                        removePartyPlayer(wserv);\n-                        \n-                        EventInstanceManager eim = player.getEventInstance();\n-\t\t\tif (eim != null) {\n-\t\t\t\teim.playerDisconnected(player);\n-\t\t\t}\n+                        if (!serverTransition) {    // thanks MedicOP for detecting an issue with party leader change on changing channels\n+                                removePartyPlayer(wserv);\n+\n+                                EventInstanceManager eim = player.getEventInstance();\n+                                if (eim != null) {\n+                                        eim.playerDisconnected(player);\n+                                }\n+                        }\n                         \n                         if (player.getMap() != null) {\n                                 int mapId = player.getMapId();\n@@ -918,7 +920,7 @@ private void disconnectInternal(boolean shutdown, boolean cashshop) {//once per\n                         \n                         final World wserv = getWorldServer();   // obviously wserv is NOT null if this player was online on it\n                         try {\n-                                removePlayer(wserv);\n+                                removePlayer(wserv, this.serverTransition);\n                                 \n                                 if (!(channel == -1 || shutdown)) {\n                                         if (!cashshop) {"}, {"sha": "51eb44115977e6bb553984c43a86515f138a5c31", "filename": "src/client/MapleFamily.java", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/client/MapleFamily.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/client/MapleFamily.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/MapleFamily.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -31,7 +31,7 @@\n \n /**\n  *\n- * @author Jay Estrella :3 (Mr.Trash)\n+ * @author Jay Estrella - Mr.Trash :3\n  */\n public class MapleFamily {\n \tprivate static int id;"}, {"sha": "5b167d65f336e9875b4bde53765fef43197eef16", "filename": "src/client/command/CommandsExecutor.java", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/client/command/CommandsExecutor.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/client/command/CommandsExecutor.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/CommandsExecutor.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -331,6 +331,7 @@ private void registerLv5Commands(){\n         addCommand(\"debug\", 5, DebugCommand.class);\n         addCommand(\"set\", 5, SetCommand.class);\n         addCommand(\"showpackets\", 5, ShowPacketsCommand.class);\n+        addCommand(\"showmovelife\", 5, ShowMoveLifeCommand.class);\n         \n         commandsNameDesc.add(levelCommandsCursor);\n     }"}, {"sha": "845dead6a44b7218ba8825945b66434f0a4d4336", "filename": "src/client/command/commands/gm1/GotoCommand.java", "status": "modified", "additions": 4, "deletions": 5, "changes": 9, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/client/command/commands/gm1/GotoCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/client/command/commands/gm1/GotoCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/gm1/GotoCommand.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -48,13 +48,12 @@ public void execute(MapleClient c, String[] params) {\n         }\n         if (gotomaps.containsKey(params[0])) {\n             MapleMap target = c.getChannelServer().getMapFactory().getMap(gotomaps.get(params[0]));\n-            MaplePortal targetPortal = target.getPortal(0);\n-            if (player.getEventInstance() != null) {\n-                player.getEventInstance().removePlayer(player);\n-            }\n+            \n+            // expedition issue with this command detected thanks to Masterrulax\n+            MaplePortal targetPortal = target.getRandomPlayerSpawnpoint();\n             player.changeMap(target, targetPortal);\n         } else {\n-            player.dropMessage(5, \"That map does not exist.\");\n+            player.dropMessage(5, \"Area '\" + params[0] + \"' is not registered.\");\n         }\n     }\n }"}, {"sha": "6e123bcc501eaacb750f9e31a564fe1dfc2d84d4", "filename": "src/client/command/commands/gm2/WarpCommand.java", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/client/command/commands/gm2/WarpCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/client/command/commands/gm2/WarpCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/gm2/WarpCommand.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -47,9 +47,8 @@ public void execute(MapleClient c, String[] params) {\n                 player.yellowMessage(\"Map ID \" + params[0] + \" is invalid.\");\n                 return;\n             }\n-            if (player.getEventInstance() != null) {\n-                player.getEventInstance().leftParty(player);\n-            }\n+            \n+            // expedition issue with this command detected thanks to Masterrulax\n             player.changeMap(target, target.getRandomPlayerSpawnpoint());\n         } catch (Exception ex) {\n             player.yellowMessage(\"Map ID \" + params[0] + \" is invalid.\");"}, {"sha": "291c1f63abd1a9942da8a8908bfede91c8405c0e", "filename": "src/client/command/commands/gm5/ShowMoveLifeCommand.java", "status": "added", "additions": 39, "deletions": 0, "changes": 39, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/client/command/commands/gm5/ShowMoveLifeCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/client/command/commands/gm5/ShowMoveLifeCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/gm5/ShowMoveLifeCommand.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -0,0 +1,39 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.gm5;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+import constants.ServerConstants;\n+\n+public class ShowMoveLifeCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        ServerConstants.USE_DEBUG_SHOW_RCVD_MVLIFE = !ServerConstants.USE_DEBUG_SHOW_RCVD_MVLIFE;\n+    }\n+}"}, {"sha": "6b6824852b354a22de6db4c6b5b09c21e8008355", "filename": "src/client/inventory/Equip.java", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/client/inventory/Equip.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/client/inventory/Equip.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/inventory/Equip.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -487,20 +487,22 @@ private void gainLevel(MapleClient c) {\n         String lvupStr = \"'\" + MapleItemInformationProvider.getInstance().getName(this.getItemId()) + \"' is now level \" + itemLevel + \"! \";\n         String showStr = \"#e'\" + MapleItemInformationProvider.getInstance().getName(this.getItemId()) + \"'#b is now #elevel #r\" + itemLevel + \"#k#b!\";\n         \n-        Pair<String, Pair<Boolean, Boolean>> res = gainStats(stats);\n+        Pair<String, Pair<Boolean, Boolean>> res = this.gainStats(stats);\n         lvupStr += res.getLeft();\n         boolean gotSlot = res.getRight().getLeft();\n         boolean gotVicious = res.getRight().getRight();\n         \n-        if(gotVicious) {\n+        if (gotVicious) {\n             //c.getPlayer().dropMessage(6, \"A new Vicious Hammer opportunity has been found on the '\" + MapleItemInformationProvider.getInstance().getName(getItemId()) + \"'!\");\n             lvupStr += \"+VICIOUS \";\n         }\n-        if(gotSlot) {\n+        if (gotSlot) {\n             //c.getPlayer().dropMessage(6, \"A new upgrade slot has been found on the '\" + MapleItemInformationProvider.getInstance().getName(getItemId()) + \"'!\");\n             lvupStr += \"+UPGSLOT \";\n         }\n         \n+        c.getPlayer().equipChanged();\n+        \n         showLevelupMessage(showStr, c); // thanks to Polaris dev team !\n         c.getPlayer().dropMessage(6, lvupStr);\n         "}, {"sha": "3ebb08e7101338d7c8c38def25ebc9b87fefb03f", "filename": "src/client/inventory/MapleInventory.java", "status": "modified", "additions": 19, "deletions": 3, "changes": 22, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/client/inventory/MapleInventory.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/client/inventory/MapleInventory.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/inventory/MapleInventory.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -42,6 +42,7 @@\n import client.inventory.manipulator.MapleInventoryManipulator;\n import tools.FilePrinter;\n import net.server.audit.locks.MonitoredLockType;\n+import server.ThreadManager;\n \n /**\n  *\n@@ -320,7 +321,12 @@ protected short addSlot(Item item) {\n         }\n         \n         if (ItemConstants.isRateCoupon(item.getItemId())) {\n-            owner.updateCouponRates();\n+            ThreadManager.getInstance().newTask(new Runnable() {    // deadlocks with coupons rates found thanks to GabrielSin & Masterrulax\n+                @Override\n+                public void run() {\n+                    owner.updateCouponRates();\n+                }\n+            });\n         }\n \n         return slotId;\n@@ -335,7 +341,12 @@ protected void addSlotFromDB(short slot, Item item) {\n         }\n         \n         if (ItemConstants.isRateCoupon(item.getItemId())) {\n-            owner.updateCouponRates();\n+            ThreadManager.getInstance().newTask(new Runnable() {\n+                @Override\n+                public void run() {\n+                    owner.updateCouponRates();\n+                }\n+            });\n         }\n     }\n     \n@@ -349,7 +360,12 @@ public void removeSlot(short slot) {\n         }\n         \n         if (item != null && ItemConstants.isRateCoupon(item.getItemId())) {\n-            owner.updateCouponRates();\n+            ThreadManager.getInstance().newTask(new Runnable() {\n+                @Override\n+                public void run() {\n+                    owner.updateCouponRates();\n+                }\n+            });\n         }\n     }\n "}, {"sha": "4e4bdd0c0684f34f36f62b69173b92a642ebacbd", "filename": "src/client/inventory/manipulator/MapleInventoryManipulator.java", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/client/inventory/manipulator/MapleInventoryManipulator.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/client/inventory/manipulator/MapleInventoryManipulator.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/inventory/manipulator/MapleInventoryManipulator.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -47,7 +47,7 @@\n /**\n  *\n  * @author Matze\n- * @author Ronan (improved check space feature & removed redundant object calls)\n+ * @author Ronan - improved check space feature & removed redundant object calls\n  */\n public class MapleInventoryManipulator {\n "}, {"sha": "676b94ef967307ddb8240d52ec32e8cd820e672c", "filename": "src/client/newyear/NewYearCardRecord.java", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/client/newyear/NewYearCardRecord.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/client/newyear/NewYearCardRecord.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/newyear/NewYearCardRecord.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -35,7 +35,7 @@\n \n /**\n  *\n- * @author Ronan (credits to Eric for showing the New Year opcodes and handler layout)\n+ * @author Ronan - credits to Eric for showing the New Year opcodes and handler layout\n  */\n public class NewYearCardRecord {\n     private int id;"}, {"sha": "a37bf8961b7aa38d7d2cc4a965b10ede92b40bf1", "filename": "src/client/processor/AssignAPProcessor.java", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/client/processor/AssignAPProcessor.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/client/processor/AssignAPProcessor.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/processor/AssignAPProcessor.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -50,7 +50,7 @@\n \n /**\n  *\n- * @author RonanLana (synchronization of AP transaction modules)\n+ * @author RonanLana - synchronization of AP transaction modules\n  */\n public class AssignAPProcessor {\n     "}, {"sha": "111ed8ade4d8bb27daa69e03e4197e8b4802b46d", "filename": "src/client/processor/AssignSPProcessor.java", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/client/processor/AssignSPProcessor.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/client/processor/AssignSPProcessor.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/processor/AssignSPProcessor.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -36,7 +36,7 @@\n \n /**\n  *\n- * @author RonanLana (synchronization of SP transaction modules)\n+ * @author RonanLana - synchronization of SP transaction modules\n  */\n public class AssignSPProcessor {\n     "}, {"sha": "42b4e005ac98f509b1def3a7725472db40fe0617", "filename": "src/client/processor/DueyProcessor.java", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/client/processor/DueyProcessor.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/client/processor/DueyProcessor.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/processor/DueyProcessor.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -48,7 +48,7 @@\n \n /**\n  *\n- * @author RonanLana (synchronization of Duey modules)\n+ * @author RonanLana - synchronization of Duey modules\n  */\n public class DueyProcessor {\n     "}, {"sha": "96813f6711c3ad893c6e6eda09c122d957a745aa", "filename": "src/client/processor/FredrickProcessor.java", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/client/processor/FredrickProcessor.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/client/processor/FredrickProcessor.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/processor/FredrickProcessor.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -43,7 +43,7 @@\n \n /**\n  *\n- * @author RonanLana (synchronization of Fredrick modules)\n+ * @author RonanLana - synchronization of Fredrick modules\n  */\n public class FredrickProcessor {\n     private static boolean canRetrieveFromFredrick(MapleCharacter chr, List<Pair<Item, MapleInventoryType>> items) {"}, {"sha": "8264cbee8cb33a8107dcfdcb511fead81a61f399", "filename": "src/client/processor/SpawnPetProcessor.java", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/client/processor/SpawnPetProcessor.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/client/processor/SpawnPetProcessor.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/processor/SpawnPetProcessor.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -34,7 +34,7 @@\n \n /**\n  *\n- * @author RonanLana (just added locking on OdinMS' SpawnPetHandler method body)\n+ * @author RonanLana - just added locking on OdinMS' SpawnPetHandler method body\n  */\n public class SpawnPetProcessor {\n     private static MapleDataProvider dataRoot = MapleDataProviderFactory.getDataProvider(new File(System.getProperty(\"wzpath\") + \"/Item.wz\"));"}, {"sha": "01a485bd0270a492304c075aa5d945ad7bf31b14", "filename": "src/constants/GameConstants.java", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/constants/GameConstants.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/constants/GameConstants.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/constants/GameConstants.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -97,6 +97,7 @@ public static int getPlayerBonusExpRate(int slot) {\n         put(\"square\", 103040000);\n         put(\"neo\", 240070000);\n         put(\"mushking\", 106020000);\n+        put(\"dojo\", 925020001);\n         put(\"bosspq\", 970030000);\n         put(\"fm\", 910000000);\n     }};"}, {"sha": "777e9f5f61f9b2a8b4a5c1ba3e68058f3b3a9e7a", "filename": "src/constants/ServerConstants.java", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/constants/ServerConstants.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/constants/ServerConstants.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/constants/ServerConstants.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -51,12 +51,15 @@\n     //Other Configuration\n     public static boolean JAVA_8;\n     public static boolean SHUTDOWNHOOK;\n+    // JAVA_8: every static function in AbstractPlayerInteraction are to be made non-static, and code comment sections uncommented after enabling this functionality.\n+    \n     \n     //Server Flags\n     public static final boolean USE_CUSTOM_KEYSET = true;           //Enables auto-setup of the HeavenMS's custom keybindings when creating characters.\n     public static final boolean USE_DEBUG = false;                  //Will enable some text prints on the client, oriented for debugging purposes.\n     public static final boolean USE_DEBUG_SHOW_INFO_EQPEXP = false; //Prints on the cmd all equip exp gain info.\n     public static       boolean USE_DEBUG_SHOW_RCVD_PACKET = false; //Prints on the cmd all received packet ids.\n+    public static       boolean USE_DEBUG_SHOW_RCVD_MVLIFE = false; //Prints on the cmd all received move life content.\n     public static       boolean USE_SUPPLY_RATE_COUPONS = true;     //Allows rate coupons to be sold through the Cash Shop.\n     \n     public static final boolean USE_MAXRANGE = true;                //Will send and receive packets from all events on a map, rather than those of only view range.\n@@ -141,6 +144,7 @@\n     public static boolean USE_DISPLAY_NUMBERS_WITH_COMMA = true;        //Enforce comma on displayed strings (use this when USE_UNITPRICE_WITH_COMMA is active and you still want to display comma-separated values).\n     public static boolean USE_UNITPRICE_WITH_COMMA = true;              //Set this accordingly with the layout of the unitPrices on Item.wz XML's, whether it's using commas or dots to represent fractions.\n     public static final byte MIN_UNDERLEVEL_TO_EXP_GAIN = 20;           //Characters are unable to get EXP from a mob if their level are under this threshold, only if \"USE_ENFORCE_MOB_LEVEL_RANGE\" is enabled. For bosses, this attribute is doubled.\n+    public static final byte MIN_UNDERLEVEL_TO_EXP_LEECH = 40;          //Characters are unable to leech EXP from party member kills whose level difference are past this limit.\n     public static final byte MAX_MONITORED_BUFFSTATS = 5;               //Limits accounting for \"dormant\" buff effects, that should take place when stronger stat buffs expires.\n     public static final int MAX_AP = 32767;                             //Max AP allotted on the auto-assigner.\n     public static final int MAX_EVENT_LEVELS = 8;                       //Event has different levels of rewarding system.\n@@ -172,7 +176,7 @@\n     public static final boolean USE_ENHANCED_CHSCROLL = true;   //Equips even more powerful with chaos upgrade.\n     public static final boolean USE_ENHANCED_CRAFTING = true;   //Apply chaos scroll on every equip crafted.\n     public static final boolean USE_ENHANCED_CLNSLATE = true;   //Clean slates can be applied to recover successfully used slots as well.\n-    public static final int SCROLL_CHANCE_RATE = 10;            //Number of rolls for success on a scroll, set 0 for default.\n+    public static final int SCROLL_CHANCE_RATE = 10;            //Number of rolls for success on a scroll, set 1 for default.\n     public static final int CHSCROLL_STAT_RATE = 3;             //Number of rolls of stat upgrade on a successfully applied chaos scroll, set 1 for default.\n     public static final int CHSCROLL_STAT_RANGE = 6;            //Stat upgrade range (-N, N) on chaos scrolls.\n     "}, {"sha": "48b991130e2fb79d7247002abee1969f1723abd7", "filename": "src/constants/skills/NightWalker.java", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/constants/skills/NightWalker.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/constants/skills/NightWalker.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/constants/skills/NightWalker.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -39,6 +39,7 @@\n     public static final int SHADOW_PARTNER = 14111000;\n     public static final int SHADOW_WEB = 14111001;\n     public static final int VANISH = 14100005;\n+    public static final int FLASH_JUMP = 14101004;\n     public static final int VAMPIRE = 14101006;\n     public static final int VENOM = 14110004;\n }"}, {"sha": "bcf84b12de6f6462c66544968a427fd07a3beeb9", "filename": "src/net/server/audit/locks/MonitoredLockType.java", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/net/server/audit/locks/MonitoredLockType.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/net/server/audit/locks/MonitoredLockType.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/audit/locks/MonitoredLockType.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -27,6 +27,7 @@\n public enum MonitoredLockType {\n     UNDEFINED,\n     CHARACTER_CHR,\n+    CHARACTER_CPN,\n     CHARACTER_EFF,\n     CHARACTER_PET,\n     CHARACTER_PRT,"}, {"sha": "ffb1124803b3f83f242b257200b0bc2705437682", "filename": "src/net/server/channel/handlers/AutoAggroHandler.java", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/net/server/channel/handlers/AutoAggroHandler.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/net/server/channel/handlers/AutoAggroHandler.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/channel/handlers/AutoAggroHandler.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -32,8 +32,7 @@\n \n     @Override\n     public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c) {\n-        if(c.getPlayer().isHidden())\n-            return; // Don't auto aggro GM's in hide...\n+        if (c.getPlayer().isHidden()) return; // Don't auto aggro GM's in hide...\n         \n         MapleMap map = c.getPlayer().getMap();\n         int oid = slea.readInt();"}, {"sha": "a4d6a01aad8a1489534bde79d87acffbdece80b9", "filename": "src/net/server/channel/handlers/CashOperationHandler.java", "status": "modified", "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/net/server/channel/handlers/CashOperationHandler.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/net/server/channel/handlers/CashOperationHandler.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/channel/handlers/CashOperationHandler.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -63,7 +63,7 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n             final int snCS = slea.readInt();\n             CashItem cItem = CashItemFactory.getItem(snCS);\n             if (!canBuy(cItem, cs.getCash(useNX))) {\n-                FilePrinter.printError(FilePrinter.ITEM, \"Denied to sell cash item with SN \" + cItem.getSN());\n+                FilePrinter.printError(FilePrinter.ITEM, \"Denied to sell cash item with SN \" + snCS);   // preventing NPE here thanks to MedicOP\n                 c.enableCSActions();\n                 return;\n             }\n@@ -185,7 +185,10 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n                     c.enableCSActions();\n                     return;\n                 }\n-                if (chr.getStorage().gainSlots(8)) {\n+                if (chr.getStorage().gainSlots(8)) {    // thanks ABaldParrot & Thora for detecting storage issues here\n+                    FilePrinter.print(FilePrinter.STORAGE + c.getAccountName() + \".txt\", c.getPlayer().getName() + \" bought 8 slots to their account storage.\\r\\n\");\n+                    chr.setUsedStorage();\n+                    \n                     c.announce(MaplePacketCreator.showBoughtStorageSlots(chr.getStorage().getSlots()));\n                     cs.gainCash(cash, cItem, chr.getWorld());\n                     c.announce(MaplePacketCreator.showCash(chr));"}, {"sha": "dbfbf39572f73c18a4c6dac7289679e6b94ce1c4", "filename": "src/net/server/channel/handlers/GuildOperationHandler.java", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/net/server/channel/handlers/GuildOperationHandler.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/net/server/channel/handlers/GuildOperationHandler.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/channel/handlers/GuildOperationHandler.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -194,21 +194,23 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n                 restancePlayer(mc);\n                 break;\n             case 0x07:\n-                allianceId = mc.getGuild().getAllianceId();\n-                \n                 cid = slea.readInt();\n                 name = slea.readMapleAsciiString();\n                 if (cid != mc.getId() || !name.equals(mc.getName()) || mc.getGuildId() <= 0) {\n                     System.out.println(\"[hax] \" + mc.getName() + \" tried to quit guild under the name \\\"\" + name + \"\\\" and current guild id of \" + mc.getGuildId() + \".\");\n                     return;\n                 }\n+                \n+                allianceId = mc.getGuild().getAllianceId();\n+                \n                 c.announce(MaplePacketCreator.updateGP(mc.getGuildId(), 0));\n                 Server.getInstance().leaveGuild(mc.getMGC());\n                 \n                 c.announce(MaplePacketCreator.showGuildInfo(null));\n                 if(allianceId > 0) Server.getInstance().getAlliance(allianceId).updateAlliancePackets(mc);\n                 \n                 mc.getMGC().setGuildId(0);\n+                mc.getMGC().setGuildRank(5);\n                 mc.saveGuildStatus();\n                 restancePlayer(mc);\n                 break;"}, {"sha": "6ee4afb5922f59bb56cb800c89bda3a5a3ad66ad", "filename": "src/net/server/channel/handlers/InventorySortHandler.java", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/net/server/channel/handlers/InventorySortHandler.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/net/server/channel/handlers/InventorySortHandler.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/channel/handlers/InventorySortHandler.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -216,8 +216,8 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n             }\n \n             for (Item item : itemarray) {\n-                    inventory.removeSlot(item.getPosition());\n-                    mods.add(new ModifyInventory(3, item));\n+                inventory.removeSlot(item.getPosition());\n+                mods.add(new ModifyInventory(3, item));\n             }\n \n             int invTypeCriteria = (MapleInventoryType.getByType(invType) == MapleInventoryType.EQUIP) ? 3 : 1;"}, {"sha": "1d4f7c1ac842e1194d79679dc2f674ba0dd4acd3", "filename": "src/net/server/channel/handlers/ItemRewardHandler.java", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/net/server/channel/handlers/ItemRewardHandler.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/net/server/channel/handlers/ItemRewardHandler.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/channel/handlers/ItemRewardHandler.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -37,7 +37,8 @@\n import tools.data.input.SeekableLittleEndianAccessor;\n \n /**\n- * @author Jay Estrella/ Modified by kevintjuh93\n+ * @author Jay Estrella\n+ * @author kevintjuh93\n  */\n public final class ItemRewardHandler extends AbstractMaplePacketHandler {\n     @Override"}, {"sha": "672c2496f9fe10abaac7820cdc09bf049f3a284e", "filename": "src/net/server/channel/handlers/MobDamageMobFriendlyHandler.java", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/net/server/channel/handlers/MobDamageMobFriendlyHandler.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/net/server/channel/handlers/MobDamageMobFriendlyHandler.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/channel/handlers/MobDamageMobFriendlyHandler.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -47,8 +47,7 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n \t\t}\n \n \t\tint damage = Randomizer.nextInt(((monster.getMaxHp() / 13 + monster.getPADamage() * 10)) * 2 + 500) / 10; //Beng's formula.\n-\t\t//  int damage = monster.getStats().getPADamage() + monster.getStats().getPDDamage() - 1;\n-\n+                \n                 if (monster.getHp() - damage < 1) {     // friendly dies\n                         if(monster.getId() == 9300102) {\n                                 monster.getMap().broadcastMessage(MaplePacketCreator.serverNotice(6, \"The Watch Hog has been injured by the aliens. Better luck next time...\"));\n@@ -60,8 +59,10 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n                                 monster.getMap().broadcastMessage(MaplePacketCreator.serverNotice(6, \"Juliet has fainted in the middle of the combat.\"));\n                         } else if(monster.getId() == 9300138) {   //romeo\n                                 monster.getMap().broadcastMessage(MaplePacketCreator.serverNotice(6, \"Romeo has fainted in the middle of the combat.\"));\n-                        } else if(monster.getId() == 9400322 || monster.getId() == 9400327 || monster.getId() == 9400332) {\n+                        } else if(monster.getId() == 9400322 || monster.getId() == 9400327 || monster.getId() == 9400332) { //snowman\n                                 monster.getMap().broadcastMessage(MaplePacketCreator.serverNotice(6, \"The Snowman has melted on the heat of the battle.\"));\n+                        } else if(monster.getId() == 9300162) {   //delli\n+                                monster.getMap().broadcastMessage(MaplePacketCreator.serverNotice(6, \"Delli vanished after the ambush, sheets still laying on the ground...\"));\n                         }\n                         \n                         c.getPlayer().getMap().killFriendlies(monster);"}, {"sha": "4ee2f0a88b359cd78953e3ebf3c7e5ef3bd14bfc", "filename": "src/net/server/channel/handlers/MoveLifeHandler.java", "status": "modified", "additions": 57, "deletions": 51, "changes": 108, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/net/server/channel/handlers/MoveLifeHandler.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/net/server/channel/handlers/MoveLifeHandler.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/channel/handlers/MoveLifeHandler.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -26,6 +26,7 @@\n import java.awt.Point;\n import java.util.LinkedList;\n import java.util.List;\n+import constants.ServerConstants;\n import server.life.MapleMonster;\n import server.life.MapleMonsterInformationProvider;\n //import server.life.MobAttackInfo;\n@@ -63,76 +64,80 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n \t\tMapleMonster monster = (MapleMonster) mmo;\n                 List<MapleCharacter> banishPlayers = null;\n                 \n-\t\tbyte pNibbles = slea.readByte();\n+                byte pNibbles = slea.readByte();\n \t\tbyte rawActivity = slea.readByte();\n-\t\tslea.readByte();\n-\t\tslea.readByte();\n+\t\tint skillId = slea.readByte() & 0xff;\n+\t\tint skillLv = slea.readByte() & 0xff;\n \t\tshort pOption = slea.readShort();\n                 slea.skip(8);\n                 \n                 if (rawActivity >= 0) {\n \t\t\trawActivity = (byte) (rawActivity & 0xFF >> 1);\n \t\t}\n \n-\t\tboolean isAttack = inRangeInclusive(rawActivity, 12, 20);\n-\t\tboolean isSkill = inRangeInclusive(rawActivity, 21, 25);\n-\n-\t\tbyte attackId = (byte) (isAttack ? rawActivity - 12 : -1);\n-                isSkill |= (pNibbles != 0);\n-                \n-\t\tboolean nextMovementCouldBeSkill = true;\n-\t\tboolean pUnk = (pNibbles & 0xF0) != 0;\n-                \n+\t\tboolean isAttack = inRangeInclusive(rawActivity, 24, 41);\n+\t\tboolean isSkill = inRangeInclusive(rawActivity, 42, 59);\n+\t\t\n                 boolean currentController = (monster.getController() == player);\n                 \n \t\tMobSkill toUse = null;\n                 int useSkillId = 0, useSkillLevel = 0;\n                 \n-                int rnd = 0;\n+                MobSkill nextUse = null;\n+                int nextSkillId = 0, nextSkillLevel = 0;\n+                \n+                boolean nextMovementCouldBeSkill = !(isSkill || (pNibbles != 0));\n+                \n+                int castPos;\n                 if (isSkill) {\n-                        int noSkills = monster.getNoSkills();\n-                        if (noSkills > 0) {\n-                                int rndSkill = Randomizer.nextInt(noSkills);\n-\n-                                Pair<Integer, Integer> skillToUse = monster.getSkills().get(rndSkill);\n-                                useSkillId = skillToUse.getLeft();\n-                                useSkillLevel = skillToUse.getRight();\n+                        useSkillId = skillId;\n+                        useSkillLevel = skillLv;\n+                        \n+                        castPos = monster.getSkillPos(useSkillId, useSkillLevel);\n+                        if (castPos != -1) {\n                                 toUse = MobSkillFactory.getMobSkill(useSkillId, useSkillLevel);\n                                 \n-                                rnd = rndSkill;\n-                                nextMovementCouldBeSkill = false;\n-                        }\n-                }\n-                \n-                int mobMp;\n-                if (toUse != null && toUse.getHP() >= (int) (((float) monster.getHp() / monster.getMaxHp()) * 100) && monster.canUseSkill(toUse)) {\n-                        mobMp = monster.getMp();\n-                        \n-                        int animationTime = MapleMonsterInformationProvider.getInstance().getMobSkillAnimationTime(toUse);\n-                        if(animationTime > 0 && toUse.getSkillId() != 129) {\n-                                toUse.applyDelayedEffect(player, monster, true, animationTime);\n-                        } else {\n-                                banishPlayers = new LinkedList<>();\n-                                toUse.applyEffect(player, monster, true, banishPlayers);\n+                                if (monster.canUseSkill(toUse)) {\n+                                        int animationTime = MapleMonsterInformationProvider.getInstance().getMobSkillAnimationTime(toUse);\n+                                        if(animationTime > 0 && toUse.getSkillId() != 129) {\n+                                                toUse.applyDelayedEffect(player, monster, true, animationTime);\n+                                        } else {\n+                                                banishPlayers = new LinkedList<>();\n+                                                toUse.applyEffect(player, monster, true, banishPlayers);\n+                                        }\n+                                }\n                         }\n                 } else {\n-                        int atkStatus = monster.canUseAttack((attackId - 13) / 2);\n+                        castPos = (rawActivity - 24) / 2;\n+                        \n+                        int atkStatus = monster.canUseAttack(castPos, isSkill);\n                         if (atkStatus < 1) {\n                                 if (!currentController) {\n                                         return;\n                                 }\n                                 \n-                                mobMp = atkStatus < 0 ? 0 : monster.getMp();\n-                        } else {\n-                                mobMp = monster.getMp();\n+                                rawActivity = -1;\n+                                pOption = 0;\n+                        }\n+                }\n+                \n+                int mobMp = monster.getMp();\n+                if (nextMovementCouldBeSkill) {\n+                        int noSkills = monster.getNoSkills();\n+                        if (noSkills > 0) {\n+                                int rndSkill = Randomizer.nextInt(noSkills);\n+                                \n+                                Pair<Integer, Integer> skillToUse = monster.getSkills().get(rndSkill);\n+                                nextSkillId = skillToUse.getLeft();\n+                                nextSkillLevel = skillToUse.getRight();\n+                                nextUse = MobSkillFactory.getMobSkill(nextSkillId, nextSkillLevel);\n+                                \n+                                if (!(nextUse != null && nextUse.getHP() >= (int) (((float) monster.getHp() / monster.getMaxHp()) * 100) && mobMp >= nextUse.getMpCon())) {\n+                                        nextSkillId = 0;\n+                                        nextSkillLevel = 0;\n+                                        nextUse = null;\n+                                }\n                         }\n-                        \n-                        useSkillId = 0;\n-                        useSkillLevel = 0;\n-                        rawActivity = -1;\n-                        pOption = 0;\n-                        \n-                        toUse = null;\n                 }\n                 \n \t\tslea.readByte();\n@@ -151,9 +156,6 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n                                 } else {\n                                         return;\n                                 }\n-                        } else if (rawActivity == -1 && monster.isControllerKnowsAboutAggro() && !monster.isMobile() && !monster.isFirstAttack()) {\n-                                monster.setControllerHasAggro(false);\n-                                monster.setControllerKnowsAboutAggro(false);\n                         }\n \n                         aggro = monster.isControllerHasAggro();\n@@ -164,13 +166,17 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n                         monster.unlockMonster();\n                 }\n                 \n-                if (toUse != null) {\n-                        c.announce(MaplePacketCreator.moveMonsterResponse(objectid, moveid, mobMp, aggro, toUse.getSkillId(), toUse.getSkillLevel()));\n+                if (nextUse != null) {\n+                        c.announce(MaplePacketCreator.moveMonsterResponse(objectid, moveid, mobMp, aggro, nextSkillId, nextSkillLevel));\n \t\t} else {\n \t\t\tc.announce(MaplePacketCreator.moveMonsterResponse(objectid, moveid, mobMp, aggro));\n \t\t}\n                 \n \t\tif (res != null) {\n+                        if (ServerConstants.USE_DEBUG_SHOW_RCVD_MVLIFE) {\n+                                System.out.println((isSkill ? \"SKILL \" : (isAttack ? \"ATTCK \" : \" \")) + \"castPos: \" + castPos + \" rawAct: \" + rawActivity + \" opt: \" + pOption + \" skillID: \" + useSkillId + \" skillLV: \" + useSkillLevel + \" \" + \"allowSkill: \" + nextMovementCouldBeSkill);\n+                        }\n+                        \n                         map.broadcastMessage(player, MaplePacketCreator.moveMonster(objectid, nextMovementCouldBeSkill, rawActivity, useSkillId, useSkillLevel, pOption, startPos, res), monster.getPosition());\n \t\t\tupdatePosition(res, monster, -2);\n \t\t\tmap.moveMonster(monster, monster.getPosition());"}, {"sha": "c86151dc62e6a41c624527a3b7c25c7af8a0c0e9", "filename": "src/net/server/channel/handlers/PetAutoPotHandler.java", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/net/server/channel/handlers/PetAutoPotHandler.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/net/server/channel/handlers/PetAutoPotHandler.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/channel/handlers/PetAutoPotHandler.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -37,7 +37,7 @@\n \n /**\n  *\n- * @author Ronan (multi-pot consumption feature)\n+ * @author Ronan - multi-pot consumption feature\n  */\n public final class PetAutoPotHandler extends AbstractMaplePacketHandler {\n     short slot;"}, {"sha": "44a70242ab957f166d2dd5fb4aa069f2942a84f8", "filename": "src/net/server/channel/handlers/PlayerInteractionHandler.java", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/net/server/channel/handlers/PlayerInteractionHandler.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/net/server/channel/handlers/PlayerInteractionHandler.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/channel/handlers/PlayerInteractionHandler.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -49,7 +49,7 @@\n /**\n  *\n  * @author Matze\n- * @author Ronan (concurrency safety & reviewed minigames)\n+ * @author Ronan - concurrency safety & reviewed minigames\n  */\n public final class PlayerInteractionHandler extends AbstractMaplePacketHandler {\n     public enum Action {"}, {"sha": "f8b3ea62b64a5705292b0201bbcdb76a0563f3b4", "filename": "src/net/server/channel/handlers/PlayerLoggedinHandler.java", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/net/server/channel/handlers/PlayerLoggedinHandler.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/net/server/channel/handlers/PlayerLoggedinHandler.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/channel/handlers/PlayerLoggedinHandler.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -224,6 +224,7 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n             if (playerGuild == null) {\n                 player.deleteGuild(player.getGuildId());\n                 player.getMGC().setGuildId(0);\n+                player.getMGC().setGuildRank(5);\n             } else {\n                 playerGuild.getMGC(player.getId()).setCharacter(player);\n                 player.setMGC(playerGuild.getMGC(player.getId()));"}, {"sha": "aaab19a9146917938df8f43fd0adc6c90ac9c17a", "filename": "src/net/server/channel/handlers/RingActionHandler.java", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/net/server/channel/handlers/RingActionHandler.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/net/server/channel/handlers/RingActionHandler.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/channel/handlers/RingActionHandler.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -51,7 +51,7 @@\n \n /**\n  * @author Jvlaple\n- * @author Ronan (major overhaul on Ring handling mechanics)\n+ * @author Ronan - major overhaul on Ring handling mechanics\n  */\n public final class RingActionHandler extends AbstractMaplePacketHandler {\n     private static int getBoxId(int useItemId) {"}, {"sha": "1ad186209f488c570086999cc2baa4bfc1df3575", "filename": "src/net/server/channel/handlers/SpecialMoveHandler.java", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/net/server/channel/handlers/SpecialMoveHandler.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/net/server/channel/handlers/SpecialMoveHandler.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/channel/handlers/SpecialMoveHandler.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -48,7 +48,7 @@\n     public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c) {\n     \tMapleCharacter chr = c.getPlayer();\n         slea.readInt();\n-        chr.getAutobanManager().setTimestamp(4, Server.getInstance().getCurrentTimestamp(), 5);\n+        chr.getAutobanManager().setTimestamp(4, Server.getInstance().getCurrentTimestamp(), 28);\n         int skillid = slea.readInt();\n         \n         /*\n@@ -132,7 +132,11 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n         }\n         if (chr.isAlive()) {\n             if (skill.getId() != Priest.MYSTIC_DOOR) {\n-                skill.getEffect(skillLevel).applyTo(chr, pos);\n+                if (skill.getId() % 10000000 != 1005) {\n+                    skill.getEffect(skillLevel).applyTo(chr, pos);\n+                } else {\n+                    skill.getEffect(skillLevel).applyEchoOfHero(chr);\n+                }\n             } else if(chr.canDoor()) {\n                 //update door lists\n                 chr.cancelMagicDoor();"}, {"sha": "91f9ad3e6aee764be1bdc219c7a38e70d486b604", "filename": "src/net/server/channel/handlers/WhisperHandler.java", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/net/server/channel/handlers/WhisperHandler.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/net/server/channel/handlers/WhisperHandler.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/channel/handlers/WhisperHandler.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -83,12 +83,14 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n \t\t\tc.getPlayer().getAutobanManager().spam(7);\n         } else if (mode == 5) { // - /find\n             String recipient = slea.readMapleAsciiString();\n-            MapleCharacter victim = c.getChannelServer().getPlayerStorage().getCharacterByName(recipient);\n+            MapleCharacter victim = c.getWorldServer().getPlayerStorage().getCharacterByName(recipient);\n             if (victim != null && c.getPlayer().gmLevel() >= victim.gmLevel()) {\n-                if (victim.getCashShop().isOpened()) {\n+                if (victim.getCashShop().isOpened()) {  // in CashShop\n                     c.announce(MaplePacketCreator.getFindReply(victim.getName(), -1, 2));\n-                //} else if (victim.inMTS()) {\n-                //    c.announce(MaplePacketCreator.getFindReply(victim.getName(), -1, 0));\n+                } else if (victim.isAwayFromWorld()) {  // in MTS\n+                    c.announce(MaplePacketCreator.getFindReply(victim.getName(), -1, 0));\n+                } else if (victim.getClient().getChannel() != c.getChannel()) { // in another channel, issue detected thanks to MedicOP\n+                    c.announce(MaplePacketCreator.getFindReply(victim.getName(), victim.getClient().getChannel() - 1, 3));\n                 } else {\n                     c.announce(MaplePacketCreator.getFindReply(victim.getName(), victim.getMap().getId(), 1));\n                 }"}, {"sha": "13f4afee49c66ffb90c01331fc8c680445a0e212", "filename": "src/net/server/world/World.java", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/net/server/world/World.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/net/server/world/World.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/world/World.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -90,7 +90,7 @@\n /**\n  *\n  * @author kevintjuh93\n- * @author Ronan (thread-oriented world schedules, guild queue, marriages & party chars)\n+ * @author Ronan - thread-oriented world schedules, guild queue, marriages & party chars\n  */\n public class World {\n "}, {"sha": "ce87183b7fa28ec950296ffabba167608c851b32", "filename": "src/scripting/event/EventManager.java", "status": "modified", "additions": 15, "deletions": 1, "changes": 16, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/scripting/event/EventManager.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/scripting/event/EventManager.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/scripting/event/EventManager.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -174,7 +174,21 @@ public static long getLobbyDelay() {\n     \n     private List<Integer> getLobbyRange() {\n         try {\n-            return convertToIntegerArray((List<Double>)iv.invokeFunction(\"setLobbyRange\", (Object) null));\n+            if (!ServerConstants.JAVA_8) {\n+                return convertToIntegerArray((List<Double>)iv.invokeFunction(\"setLobbyRange\", (Object) null));\n+            } else {  // java 8 support here thanks to MedicOP\n+                /*\n+                ScriptObjectMirror object = (ScriptObjectMirror) iv.invokeFunction(\"setLobbyRange\", (Object) null);\n+                int[] to = object.to(int[].class);\n+                List<Integer> list = new ArrayList<>();\n+                for (int i : to) {\n+                    list.add(i);\n+                }\n+                return list;\n+                */\n+                \n+                throw new NoSuchMethodException();\n+            }\n         } catch (ScriptException | NoSuchMethodException ex) { // they didn't define a lobby range\n             List<Integer> defaultRange = new ArrayList<>();\n             defaultRange.add(0);"}, {"sha": "a80e791c8b46913cd4e581560ba8ee5ae5313e98", "filename": "src/server/MapleItemInformationProvider.java", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/server/MapleItemInformationProvider.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/server/MapleItemInformationProvider.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/MapleItemInformationProvider.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -645,8 +645,8 @@ private static double testYourLuck(double prop, int dices) {   // revamped testY\n         return Math.pow(1.0 - prop, dices);\n     }\n     \n-    public static boolean rollSuccessChance(double prop) {\n-        return Math.random() >= testYourLuck(prop / 100.0, ServerConstants.SCROLL_CHANCE_RATE);\n+    public static boolean rollSuccessChance(double propPercent) {\n+        return Math.random() >= testYourLuck(propPercent / 100.0, ServerConstants.SCROLL_CHANCE_RATE);\n     }\n     \n     private static short getMaximumShortMaxIfOverflow(int value1, int value2) {"}, {"sha": "f40ec72a07123c664e8aa507b14bb497c0db2ac3", "filename": "src/server/MapleStatEffect.java", "status": "modified", "additions": 14, "deletions": 2, "changes": 16, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/server/MapleStatEffect.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/server/MapleStatEffect.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/MapleStatEffect.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -717,6 +717,18 @@ public void applyPassive(MapleCharacter applyto, MapleMapObject obj, int attack)\n         }\n     }\n \n+    public boolean applyEchoOfHero(MapleCharacter applyfrom) {\n+        Map<Integer, MapleCharacter> mapPlayers = applyfrom.getMap().getMapPlayers();\n+        mapPlayers.remove(applyfrom.getId());\n+        \n+        boolean hwResult = applyTo(applyfrom);\n+        for (MapleCharacter chr : mapPlayers.values()) {    // Echo of Hero not buffing players in the map detected thanks to Masterrulax\n+            applyTo(applyfrom, chr, false, null, false, 1);\n+        }\n+        \n+        return hwResult;\n+    }\n+    \n     public boolean applyTo(MapleCharacter chr) {\n         return applyTo(chr, chr, true, null, false, 1);\n     }\n@@ -886,11 +898,11 @@ private boolean applyTo(MapleCharacter applyfrom, MapleCharacter applyto, boolea\n                 \n                 applyto.cancelBuffStats(MapleBuffStat.SOULARROW);  // cancel door buff\n             }\n-        }  else if (isMist()) {\n+        } else if (isMist()) {\n             Rectangle bounds = calculateBoundingBox(sourceid == NightWalker.POISON_BOMB ? pos : applyfrom.getPosition(), applyfrom.isFacingLeft());\n             MapleMist mist = new MapleMist(bounds, applyfrom, this);\n             applyfrom.getMap().spawnMist(mist, getDuration(), mist.isPoisonMist(), false, mist.isRecoveryMist());\n-        } else if(isTimeLeap()) {\n+        } else if (isTimeLeap()) {\n             applyto.removeAllCooldownsExcept(Buccaneer.TIME_LEAP, true);\n         }\n         "}, {"sha": "b6a9ec82e3ac0466746f1da0bd1f29e8ccffadde", "filename": "src/server/MapleTrade.java", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/server/MapleTrade.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/server/MapleTrade.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/MapleTrade.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -41,7 +41,7 @@\n /**\n  *\n  * @author Matze\n- * @author Ronan (concurrency safety & check available slots)\n+ * @author Ronan - concurrency safety & check available slots\n  */\n public class MapleTrade {\n     private MapleTrade partner = null;"}, {"sha": "08695880603e3d8c40defaca5810ac5996cd261d", "filename": "src/server/life/MapleLifeFactory.java", "status": "modified", "additions": 166, "deletions": 117, "changes": 283, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/server/life/MapleLifeFactory.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/server/life/MapleLifeFactory.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/life/MapleLifeFactory.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -54,130 +54,179 @@ public static AbstractLoadedMapleLife getLife(int id, String type) {\n         }\n     }\n \n-    public static MapleMonster getMonster(int mid) {\n-        try {\n-            MapleMonsterStats stats = monsterStats.get(Integer.valueOf(mid));\n-            if (stats == null) {\n-                MapleData monsterData = data.getData(StringUtil.getLeftPaddedStr(Integer.toString(mid) + \".img\", '0', 11));\n-                if (monsterData == null) {\n-                    return null;\n-                }\n-                MapleData monsterInfoData = monsterData.getChildByPath(\"info\");\n-                stats = new MapleMonsterStats();\n-                stats.setHp(MapleDataTool.getIntConvert(\"maxHP\", monsterInfoData));\n-                stats.setFriendly(MapleDataTool.getIntConvert(\"damagedByMob\", monsterInfoData, 0) == 1);\n-                stats.setPADamage(MapleDataTool.getIntConvert(\"PADamage\", monsterInfoData));\n-                stats.setPDDamage(MapleDataTool.getIntConvert(\"PDDamage\", monsterInfoData));\n-                stats.setMADamage(MapleDataTool.getIntConvert(\"MADamage\", monsterInfoData));\n-                stats.setMDDamage(MapleDataTool.getIntConvert(\"MDDamage\", monsterInfoData));  \n-                stats.setMp(MapleDataTool.getIntConvert(\"maxMP\", monsterInfoData, 0));\n-                stats.setExp(MapleDataTool.getIntConvert(\"exp\", monsterInfoData, 0));\n-                stats.setLevel(MapleDataTool.getIntConvert(\"level\", monsterInfoData));\n-                stats.setRemoveAfter(MapleDataTool.getIntConvert(\"removeAfter\", monsterInfoData, 0));\n-                stats.setBoss(MapleDataTool.getIntConvert(\"boss\", monsterInfoData, 0) > 0);\n-                stats.setExplosiveReward(MapleDataTool.getIntConvert(\"explosiveReward\", monsterInfoData, 0) > 0);\n-                stats.setFfaLoot(MapleDataTool.getIntConvert(\"publicReward\", monsterInfoData, 0) > 0);\n-                stats.setUndead(MapleDataTool.getIntConvert(\"undead\", monsterInfoData, 0) > 0);\n-                stats.setName(MapleDataTool.getString(mid + \"/name\", mobStringData, \"MISSINGNO\"));\n-                stats.setBuffToGive(MapleDataTool.getIntConvert(\"buff\", monsterInfoData, -1));\n-                stats.setCP(MapleDataTool.getIntConvert(\"getCP\", monsterInfoData, 0));\n-                stats.setRemoveOnMiss(MapleDataTool.getIntConvert(\"removeOnMiss\", monsterInfoData, 0) > 0);\n-\n-                MapleData special = monsterInfoData.getChildByPath(\"coolDamage\");\n-                if (special != null) {\n-                    int coolDmg = MapleDataTool.getIntConvert(\"coolDamage\", monsterInfoData);\n-                    int coolProb = MapleDataTool.getIntConvert(\"coolDamageProb\", monsterInfoData, 0);\n-                    stats.setCool(new Pair<>(coolDmg, coolProb));\n-                }\n-                special = monsterInfoData.getChildByPath(\"loseItem\");\n-                if (special != null) {\n-                    for (MapleData liData : special.getChildren()) {\n-                        stats.addLoseItem(new loseItem(MapleDataTool.getInt(liData.getChildByPath(\"id\")), (byte) MapleDataTool.getInt(liData.getChildByPath(\"prop\")), (byte) MapleDataTool.getInt(liData.getChildByPath(\"x\"))));\n-                    }\n-                }\n-                special = monsterInfoData.getChildByPath(\"selfDestruction\");\n-                if (special != null) {\n-                    stats.setSelfDestruction(new selfDestruction((byte) MapleDataTool.getInt(special.getChildByPath(\"action\")), MapleDataTool.getIntConvert(\"removeAfter\", special, -1), MapleDataTool.getIntConvert(\"hp\", special, -1)));\n-                }\n-                MapleData firstAttackData = monsterInfoData.getChildByPath(\"firstAttack\");\n-                int firstAttack = 0;\n-                if (firstAttackData != null) {\n-                    if (firstAttackData.getType() == MapleDataType.FLOAT) {\n-                        firstAttack = Math.round(MapleDataTool.getFloat(firstAttackData));\n-                    } else {\n-                        firstAttack = MapleDataTool.getInt(firstAttackData);\n-                    }\n-                }\n-                stats.setFirstAttack(firstAttack > 0);\n-                stats.setDropPeriod(MapleDataTool.getIntConvert(\"dropItemPeriod\", monsterInfoData, 0) * 10000);\n-\n-                stats.setTagColor(MapleDataTool.getIntConvert(\"hpTagColor\", monsterInfoData, 0));\n-                stats.setTagBgColor(MapleDataTool.getIntConvert(\"hpTagBgcolor\", monsterInfoData, 0));\n-\n-                for (MapleData idata : monsterData) {\n-                    if (!idata.getName().equals(\"info\")) {\n-                        int delay = 0;\n-                        for (MapleData pic : idata.getChildren()) {\n-                            delay += MapleDataTool.getIntConvert(\"delay\", pic, 0);\n-                        }\n-                        stats.setAnimationTime(idata.getName(), delay);\n-                    }\n-                }\n-                MapleData reviveInfo = monsterInfoData.getChildByPath(\"revive\");\n-                if (reviveInfo != null) {\n-                    List<Integer> revives = new LinkedList<>();\n-                    for (MapleData data_ : reviveInfo) {\n-                        revives.add(MapleDataTool.getInt(data_));\n-                    }\n-                    stats.setRevives(revives);\n-                }\n-                decodeElementalString(stats, MapleDataTool.getString(\"elemAttr\", monsterInfoData, \"\"));\n-                \n-                MapleMonsterInformationProvider mi = MapleMonsterInformationProvider.getInstance();\n-                MapleData monsterSkillInfoData = monsterInfoData.getChildByPath(\"skill\");\n-                if (monsterSkillInfoData != null) {\n-                    int i = 0;\n-                    List<Pair<Integer, Integer>> skills = new ArrayList<>();\n-                    while (monsterSkillInfoData.getChildByPath(Integer.toString(i)) != null) {\n-                        int skillId = MapleDataTool.getInt(i + \"/skill\", monsterSkillInfoData, 0);\n-                        int skillLv = MapleDataTool.getInt(i + \"/level\", monsterSkillInfoData, 0);\n-                        skills.add(new Pair<>(skillId, skillLv));\n-                        \n-                        MapleData monsterSkillData = monsterData.getChildByPath(\"skill\" + (i + 1));\n-                        if (monsterSkillData != null) {\n-                            int animationTime = 0;\n-                            for (MapleData effectEntry : monsterSkillData.getChildren()) {\n-                                animationTime += MapleDataTool.getIntConvert(\"delay\", effectEntry, 0);\n-                            }\n-                            \n-                            MobSkill skill = MobSkillFactory.getMobSkill(skillId, skillLv);\n-                            mi.setMobSkillAnimationTime(skill, animationTime);\n-                        }\n-                        \n-                        i++;\n-                    }\n-                    stats.setSkills(skills);\n+    private static class MobAttackInfoHolder {\n+        protected int attackPos;\n+        protected int mpCon;\n+        protected int coolTime;\n+        protected int animationTime;\n+        \n+        protected MobAttackInfoHolder(int attackPos, int mpCon, int coolTime, int animationTime) {\n+            this.attackPos = attackPos;\n+            this.mpCon = mpCon;\n+            this.coolTime = coolTime;\n+            this.animationTime = animationTime;\n+        }\n+    }\n+    \n+    private static void setMonsterAttackInfo(int mid, List<MobAttackInfoHolder> attackInfos) {\n+        if (!attackInfos.isEmpty()) {\n+            MapleMonsterInformationProvider mi = MapleMonsterInformationProvider.getInstance();\n+\n+            for (MobAttackInfoHolder attackInfo : attackInfos) {\n+                mi.setMobAttackInfo(mid, attackInfo.attackPos, attackInfo.mpCon, attackInfo.coolTime);\n+                mi.setMobAttackAnimationTime(mid, attackInfo.attackPos, attackInfo.animationTime);\n+            }\n+        }\n+    }\n+    \n+    private static Pair<MapleMonsterStats, List<MobAttackInfoHolder>> getMonsterStats(int mid) {\n+        MapleData monsterData = data.getData(StringUtil.getLeftPaddedStr(Integer.toString(mid) + \".img\", '0', 11));\n+        if (monsterData == null) {\n+            return null;\n+        }\n+        MapleData monsterInfoData = monsterData.getChildByPath(\"info\");\n+        \n+        List<MobAttackInfoHolder> attackInfos = new LinkedList<>();\n+        MapleMonsterStats stats;\n+        \n+        int linkMid = MapleDataTool.getIntConvert(\"link\", monsterInfoData, 0);\n+        if (linkMid == 0) {\n+            stats = new MapleMonsterStats();\n+        } else {\n+            Pair<MapleMonsterStats, List<MobAttackInfoHolder>> linkStats = getMonsterStats(linkMid);\n+            if (linkStats == null) {\n+                return null;\n+            }\n+            \n+            stats = linkStats.getLeft();\n+            attackInfos.addAll(linkStats.getRight());\n+        }\n+\n+        stats.setHp(MapleDataTool.getIntConvert(\"maxHP\", monsterInfoData));\n+        stats.setFriendly(MapleDataTool.getIntConvert(\"damagedByMob\", monsterInfoData, stats.isFriendly() ? 1 : 0) == 1);\n+        stats.setPADamage(MapleDataTool.getIntConvert(\"PADamage\", monsterInfoData));\n+        stats.setPDDamage(MapleDataTool.getIntConvert(\"PDDamage\", monsterInfoData));\n+        stats.setMADamage(MapleDataTool.getIntConvert(\"MADamage\", monsterInfoData));\n+        stats.setMDDamage(MapleDataTool.getIntConvert(\"MDDamage\", monsterInfoData));\n+        stats.setMp(MapleDataTool.getIntConvert(\"maxMP\", monsterInfoData, stats.getMp()));\n+        stats.setExp(MapleDataTool.getIntConvert(\"exp\", monsterInfoData, stats.getExp()));\n+        stats.setLevel(MapleDataTool.getIntConvert(\"level\", monsterInfoData));\n+        stats.setRemoveAfter(MapleDataTool.getIntConvert(\"removeAfter\", monsterInfoData, stats.removeAfter()));\n+        stats.setBoss(MapleDataTool.getIntConvert(\"boss\", monsterInfoData, stats.isBoss() ? 1 : 0) > 0);\n+        stats.setExplosiveReward(MapleDataTool.getIntConvert(\"explosiveReward\", monsterInfoData, stats.isExplosiveReward() ? 1 : 0) > 0);\n+        stats.setFfaLoot(MapleDataTool.getIntConvert(\"publicReward\", monsterInfoData, stats.isFfaLoot() ? 1 : 0) > 0);\n+        stats.setUndead(MapleDataTool.getIntConvert(\"undead\", monsterInfoData, stats.isUndead() ? 1 : 0) > 0);\n+        stats.setName(MapleDataTool.getString(mid + \"/name\", mobStringData, \"MISSINGNO\"));\n+        stats.setBuffToGive(MapleDataTool.getIntConvert(\"buff\", monsterInfoData, stats.getBuffToGive()));\n+        stats.setCP(MapleDataTool.getIntConvert(\"getCP\", monsterInfoData, stats.getCP()));\n+        stats.setRemoveOnMiss(MapleDataTool.getIntConvert(\"removeOnMiss\", monsterInfoData, stats.removeOnMiss() ? 1 : 0) > 0);\n+\n+        MapleData special = monsterInfoData.getChildByPath(\"coolDamage\");\n+        if (special != null) {\n+            int coolDmg = MapleDataTool.getIntConvert(\"coolDamage\", monsterInfoData);\n+            int coolProb = MapleDataTool.getIntConvert(\"coolDamageProb\", monsterInfoData, 0);\n+            stats.setCool(new Pair<>(coolDmg, coolProb));\n+        }\n+        special = monsterInfoData.getChildByPath(\"loseItem\");\n+        if (special != null) {\n+            for (MapleData liData : special.getChildren()) {\n+                stats.addLoseItem(new loseItem(MapleDataTool.getInt(liData.getChildByPath(\"id\")), (byte) MapleDataTool.getInt(liData.getChildByPath(\"prop\")), (byte) MapleDataTool.getInt(liData.getChildByPath(\"x\"))));\n+            }\n+        }\n+        special = monsterInfoData.getChildByPath(\"selfDestruction\");\n+        if (special != null) {\n+            stats.setSelfDestruction(new selfDestruction((byte) MapleDataTool.getInt(special.getChildByPath(\"action\")), MapleDataTool.getIntConvert(\"removeAfter\", special, -1), MapleDataTool.getIntConvert(\"hp\", special, -1)));\n+        }\n+        MapleData firstAttackData = monsterInfoData.getChildByPath(\"firstAttack\");\n+        int firstAttack = 0;\n+        if (firstAttackData != null) {\n+            if (firstAttackData.getType() == MapleDataType.FLOAT) {\n+                firstAttack = Math.round(MapleDataTool.getFloat(firstAttackData));\n+            } else {\n+                firstAttack = MapleDataTool.getInt(firstAttackData);\n+            }\n+        }\n+        stats.setFirstAttack(firstAttack > 0);\n+        stats.setDropPeriod(MapleDataTool.getIntConvert(\"dropItemPeriod\", monsterInfoData, stats.getDropPeriod() / 10000) * 10000);\n+\n+        stats.setTagColor(MapleDataTool.getIntConvert(\"hpTagColor\", monsterInfoData, 0));\n+        stats.setTagBgColor(MapleDataTool.getIntConvert(\"hpTagBgcolor\", monsterInfoData, 0));\n+\n+        for (MapleData idata : monsterData) {\n+            if (!idata.getName().equals(\"info\")) {\n+                int delay = 0;\n+                for (MapleData pic : idata.getChildren()) {\n+                    delay += MapleDataTool.getIntConvert(\"delay\", pic, 0);\n                 }\n-                \n-                int i = 0;\n-                MapleData monsterAttackData;\n-                while ((monsterAttackData = monsterData.getChildByPath(\"attack\" + (i + 1))) != null) {\n+                stats.setAnimationTime(idata.getName(), delay);\n+            }\n+        }\n+        MapleData reviveInfo = monsterInfoData.getChildByPath(\"revive\");\n+        if (reviveInfo != null) {\n+            List<Integer> revives = new LinkedList<>();\n+            for (MapleData data_ : reviveInfo) {\n+                revives.add(MapleDataTool.getInt(data_));\n+            }\n+            stats.setRevives(revives);\n+        }\n+        decodeElementalString(stats, MapleDataTool.getString(\"elemAttr\", monsterInfoData, \"\"));\n+\n+        MapleMonsterInformationProvider mi = MapleMonsterInformationProvider.getInstance();\n+        MapleData monsterSkillInfoData = monsterInfoData.getChildByPath(\"skill\");\n+        if (monsterSkillInfoData != null) {\n+            int i = 0;\n+            List<Pair<Integer, Integer>> skills = new ArrayList<>();\n+            while (monsterSkillInfoData.getChildByPath(Integer.toString(i)) != null) {\n+                int skillId = MapleDataTool.getInt(i + \"/skill\", monsterSkillInfoData, 0);\n+                int skillLv = MapleDataTool.getInt(i + \"/level\", monsterSkillInfoData, 0);\n+                skills.add(new Pair<>(skillId, skillLv));\n+\n+                MapleData monsterSkillData = monsterData.getChildByPath(\"skill\" + (i + 1));\n+                if (monsterSkillData != null) {\n                     int animationTime = 0;\n-                    for (MapleData effectEntry : monsterAttackData.getChildren()) {\n+                    for (MapleData effectEntry : monsterSkillData.getChildren()) {\n                         animationTime += MapleDataTool.getIntConvert(\"delay\", effectEntry, 0);\n                     }\n \n-                    int mpCon = MapleDataTool.getIntConvert(\"info/conMP\", monsterAttackData, 0);\n-                    int coolTime = MapleDataTool.getIntConvert(\"info/attackAfter\", monsterAttackData, 0);\n-                    mi.setMobAttackInfo(mid, i, mpCon, coolTime);\n-                    mi.setMobAttackAnimationTime(mid, i, animationTime);\n-                    i++;\n+                    MobSkill skill = MobSkillFactory.getMobSkill(skillId, skillLv);\n+                    mi.setMobSkillAnimationTime(skill, animationTime);\n                 }\n+\n+                i++;\n+            }\n+            stats.setSkills(skills);\n+        }\n+\n+        int i = 0;\n+        MapleData monsterAttackData;\n+        while ((monsterAttackData = monsterData.getChildByPath(\"attack\" + (i + 1))) != null) {\n+            int animationTime = 0;\n+            for (MapleData effectEntry : monsterAttackData.getChildren()) {\n+                animationTime += MapleDataTool.getIntConvert(\"delay\", effectEntry, 0);\n+            }\n+\n+            int mpCon = MapleDataTool.getIntConvert(\"info/conMP\", monsterAttackData, 0);\n+            int coolTime = MapleDataTool.getIntConvert(\"info/attackAfter\", monsterAttackData, 0);\n+            attackInfos.add(new MobAttackInfoHolder(i, mpCon, coolTime, animationTime));\n+            i++;\n+        }\n+\n+        MapleData banishData = monsterInfoData.getChildByPath(\"ban\");\n+        if (banishData != null) {\n+            stats.setBanishInfo(new BanishInfo(MapleDataTool.getString(\"banMsg\", banishData), MapleDataTool.getInt(\"banMap/0/field\", banishData, -1), MapleDataTool.getString(\"banMap/0/portal\", banishData, \"sp\")));\n+        }\n+        \n+        return new Pair<>(stats, attackInfos);\n+    }\n+    \n+    public static MapleMonster getMonster(int mid) {\n+        try {\n+            MapleMonsterStats stats = monsterStats.get(Integer.valueOf(mid));\n+            if (stats == null) {\n+                Pair<MapleMonsterStats, List<MobAttackInfoHolder>> mobStats = getMonsterStats(mid);\n+                stats = mobStats.getLeft();\n+                setMonsterAttackInfo(mid, mobStats.getRight());\n                 \n-                MapleData banishData = monsterInfoData.getChildByPath(\"ban\");\n-                if (banishData != null) {\n-                    stats.setBanishInfo(new BanishInfo(MapleDataTool.getString(\"banMsg\", banishData), MapleDataTool.getInt(\"banMap/0/field\", banishData, -1), MapleDataTool.getString(\"banMap/0/portal\", banishData, \"sp\")));\n-                }\n                 monsterStats.put(Integer.valueOf(mid), stats);\n             }\n             MapleMonster ret = new MapleMonster(mid, stats);"}, {"sha": "ce83d11348233f46a1159925ff233467a6c53efd", "filename": "src/server/life/MapleMonster.java", "status": "modified", "additions": 66, "deletions": 33, "changes": 99, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/server/life/MapleMonster.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/server/life/MapleMonster.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/life/MapleMonster.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -402,7 +402,7 @@ public boolean isAttackedBy(MapleCharacter chr) {\n         return takenDamage.containsKey(chr.getId());\n     }\n \n-    private void distributeExperienceToParty(int pid, float exp, int killer, Set<MapleCharacter> underleveled, int minThresholdLevel) {\n+    private void distributeExperienceToParty(int pid, float exp, int killer, int killerLevel, Set<MapleCharacter> underleveled, int minThresholdLevel) {\n         List<MapleCharacter> members = new LinkedList<>();\n         MapleCharacter pchar = getMap().getAnyCharacterFromParty(pid);\n         if(pchar != null) {\n@@ -415,32 +415,33 @@ private void distributeExperienceToParty(int pid, float exp, int killer, Set<Map\n             \n             members.add(chr);\n         }\n-            \n-        int partyLevel = 0;\n-        int leechCount = 0;\n+        \n+        List<MapleCharacter> expSharers = new LinkedList<>();\n+        int expSharersLevel = 0;\n         for (MapleCharacter mc : members) {\n             if (mc.getLevel() >= minThresholdLevel) {    //NO EXP WILL BE GIVEN for those who are underleveled!\n-                partyLevel += mc.getLevel();\n-                leechCount++;\n+                if (Math.abs(killerLevel - mc.getLevel()) < ServerConstants.MIN_UNDERLEVEL_TO_EXP_LEECH) {\n+                    // thanks Thora for pointing out leech level limitation\n+                    \n+                    expSharersLevel += mc.getLevel();\n+                    expSharers.add(mc);\n+                }\n             } else {\n                 underleveled.add(mc);\n             }\n         }\n \n         final int mostDamageCid = getHighestDamagerId();\n \n-        for (MapleCharacter mc : members) {\n+        for (MapleCharacter mc : expSharers) {\n             int id = mc.getId();\n-            int level = mc.getLevel();\n-            if (level >= minThresholdLevel) {\n-                boolean isKiller = killer == id;\n-                boolean mostDamage = mostDamageCid == id;\n-                float xp = ((0.80f * exp * level) / partyLevel);\n-                if (mostDamage) {\n-                    xp += (0.20f * exp);\n-                }\n-                giveExpToCharacter(mc, xp, isKiller, leechCount);\n+            boolean isKiller = killer == id;\n+            boolean mostDamage = mostDamageCid == id;\n+            float xp = ((0.80f * exp * mc.getLevel()) / expSharersLevel);\n+            if (mostDamage) {\n+                xp += (0.20f * exp);\n             }\n+            giveExpToCharacter(mc, xp, isKiller, expSharers.size());\n         }\n     }\n \n@@ -464,7 +465,7 @@ private void distributeExperience(int killerId) {\n         }\n         \n         EventInstanceManager eim = getMap().getEventInstance();\n-        int minThresholdLevel = calcThresholdLevel(eim != null);\n+        int minThresholdLevel = calcThresholdLevel(eim != null), killerLevel = Integer.MAX_VALUE;\n         int exp = getExp();\n         long totalHealth = maxHpPlusHeal.get();\n         Map<Integer, Float> expDist = new HashMap<>();\n@@ -482,15 +483,14 @@ private void distributeExperience(int killerId) {\n         for (MapleCharacter mc : mapChrs) {\n             Float mcExp = expDist.remove(mc.getId());\n             if (mcExp != null) {\n+                float xp = mcExp;\n                 boolean isKiller = (mc.getId() == killerId);\n                 if (isKiller) {\n                     if (eim != null) {\n                         eim.monsterKilled(mc, this);\n                     }\n-                }\n-                \n-                float xp = mcExp;\n-                if (isKiller) {\n+                    \n+                    killerLevel = mc.getLevel();\n                     xp += exp2;\n                 }\n                 \n@@ -529,7 +529,7 @@ private void distributeExperience(int killerId) {\n         }\n         \n         for (Entry<Integer, Float> party : partyExp.entrySet()) {\n-            distributeExperienceToParty(party.getKey(), party.getValue(), killerId, underleveled, minThresholdLevel);\n+            distributeExperienceToParty(party.getKey(), party.getValue(), killerId, killerLevel, underleveled, minThresholdLevel);\n         }\n         \n         for(MapleCharacter mc : underleveled) {\n@@ -573,10 +573,12 @@ private void giveExpToCharacter(MapleCharacter attacker, float exp, boolean isKi\n         }\n     }\n \n-    private void removeController() {\n+    private Pair<MapleCharacter, Boolean> removeController() {\n         this.lockMonster();\n         try {\n             MapleCharacter chrController = getController();\n+            boolean hadAggro = isControllerHasAggro();\n+            \n             if (chrController != null) { // this can/should only happen when a hidden gm attacks the monster\n                 chrController.announce(MaplePacketCreator.stopControllingMonster(this.getObjectId()));\n                 chrController.stopControllingMonster(this);\n@@ -585,6 +587,8 @@ private void removeController() {\n             setController(null);\n             setControllerHasAggro(false);\n             setControllerKnowsAboutAggro(false);\n+            \n+            return new Pair<>(chrController, hadAggro);\n         } finally {\n             this.unlockMonster();\n         }\n@@ -593,9 +597,8 @@ private void removeController() {\n     public MapleCharacter killBy(final MapleCharacter killer) {\n         distributeExperience(killer != null ? killer.getId() : 0);\n         \n-        removeController();\n-        \n-        final List<Integer> toSpawn = this.getRevives(); // this doesn't work (?)\n+        final Pair<MapleCharacter, Boolean> lastController = removeController();\n+        final List<Integer> toSpawn = this.getRevives();\n         if (toSpawn != null) {\n             final MapleMap reviveMap = map;\n             if (toSpawn.contains(9300216) && reviveMap.getId() > 925000000 && reviveMap.getId() < 926000000) {\n@@ -630,6 +633,9 @@ public MapleCharacter killBy(final MapleCharacter killer) {\n                 TimerManager.getInstance().schedule(new Runnable() {\n                     @Override\n                     public void run() {\n+                        MapleCharacter controller = lastController.getLeft();\n+                        boolean aggro = lastController.getRight();\n+                        \n                         for (Integer mid : toSpawn) {\n                             final MapleMonster mob = MapleLifeFactory.getMonster(mid);\n                             mob.setPosition(getPosition());\n@@ -641,7 +647,7 @@ public void run() {\n                             }\n                             reviveMap.spawnMonster(mob);\n \n-                            if(mob.getId() >= 8810010 && mob.getId() <= 8810017 && reviveMap.isHorntailDefeated()) {\n+                            if (mob.getId() >= 8810010 && mob.getId() <= 8810017 && reviveMap.isHorntailDefeated()) {\n                                 boolean htKilled = false;\n                                 MapleMonster ht = reviveMap.getMonsterById(8810018);\n                                 \n@@ -663,6 +669,8 @@ public void run() {\n                                 for(int i = 8810017; i >= 8810010; i--) {\n                                     reviveMap.killMonster(reviveMap.getMonsterById(i), killer, true);\n                                 }\n+                            } else if (controller != null) {\n+                                mob.switchController(controller, aggro);\n                             }\n                             \n                             if(eim != null) {\n@@ -1176,10 +1184,10 @@ public void run() {\n     }\n     \n     public void refreshMobPosition() {\n-        updateMobPosition(getPosition());\n+        resetMobPosition(getPosition());\n     }\n     \n-    public void updateMobPosition(Point newPoint) {\n+    public void resetMobPosition(Point newPoint) {\n         removeController();\n         setPosition(newPoint);\n         map.broadcastMessage(MaplePacketCreator.moveMonster(this.getObjectId(), false, -1, 0, 0, 0, this.getPosition(), this.getIdleMovement()));\n@@ -1276,11 +1284,25 @@ public boolean hasSkill(int skillId, int level) {\n         return stats.hasSkill(skillId, level);\n     }\n     \n+    public int getSkillPos(int skillId, int level) {\n+        int pos = 0;\n+        for (Pair<Integer, Integer> ms : this.getSkills()) {\n+            if (ms.getLeft() == skillId && ms.getRight() == level) {\n+                return pos;\n+            }\n+            \n+            pos++;\n+        }\n+        \n+        return -1;\n+    }\n+    \n     public boolean canUseSkill(MobSkill toUse) {\n         if (toUse == null) {\n             return false;\n         }\n         \n+        int useLimit = toUse.getLimit();\n         if (toUse.getSkillId() == 200) {\n             int i = 0;\n             for (MapleMapObject mo : getMap().getMapObjects()) {\n@@ -1291,13 +1313,16 @@ public boolean canUseSkill(MobSkill toUse) {\n             if (i > 100) {\n                 return false;\n             }\n+            if (map.isDojoMap()) {  // spawns in dojo should be unlimited\n+                useLimit = 0;\n+            }\n         }\n         \n-        if (toUse.getLimit() > 0) {\n+        if (useLimit > 0) {\n             monsterLock.lock();\n             try {\n                 Integer times = this.skillsUsed.get(new Pair<>(toUse.getSkillId(), toUse.getSkillLevel()));\n-                if (times != null && times >= toUse.getLimit()) {\n+                if (times != null && times >= useLimit) {\n                     return false;\n                 }\n             } finally {\n@@ -1307,20 +1332,24 @@ public boolean canUseSkill(MobSkill toUse) {\n         \n         monsterLock.lock();\n         try {\n+            /*\n             for (Pair<Integer, Integer> skill : usedSkills) {\n                 if (skill.getLeft() == toUse.getSkillId() && skill.getRight() == toUse.getSkillLevel()) {\n                     return false;\n                 }\n             }\n+            */\n             \n             int mpCon = toUse.getMpCon();\n             if (mp < mpCon) {\n                 return false;\n             }\n             \n+            /*\n             if (!this.applyAnimationIfRoaming(-1, toUse)) {\n                 return false;\n             }\n+            */\n             \n             this.usedSkill(toUse);\n         } finally {\n@@ -1380,26 +1409,30 @@ private void clearSkill(int skillId, int level) {\n         }\n     }\n     \n-    public int canUseAttack(int attackPos) {\n+    public int canUseAttack(int attackPos, boolean isSkill) {\n         monsterLock.lock();\n         try {\n+            /*\n             if (usedAttacks.contains(attackPos)) {\n                 return -1;\n             }\n+            */\n             \n             Pair<Integer, Integer> attackInfo = MapleMonsterInformationProvider.getInstance().getMobAttackInfo(this.getId(), attackPos);\n             if (attackInfo == null) {\n-                return usedAttacks.isEmpty() ? 0 : -1;\n+                return -1;\n             }\n             \n             int mpCon = attackInfo.getLeft();\n             if (mp < mpCon) {\n                 return -1;\n             }\n             \n+            /*\n             if (!this.applyAnimationIfRoaming(attackPos, null)) {\n                 return -1;\n             }\n+            */\n             \n             usedAttack(attackPos, mpCon, attackInfo.getRight());\n             return 1;"}, {"sha": "bc97e2794c8d8f2f4cbb2d7624d27e00a31fc4bc", "filename": "src/server/life/MapleMonsterStats.java", "status": "modified", "additions": 8, "deletions": 4, "changes": 12, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/server/life/MapleMonsterStats.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/server/life/MapleMonsterStats.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/life/MapleMonsterStats.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -37,7 +37,7 @@\n  */\n public class MapleMonsterStats {\n     private boolean changeable;\n-    private int exp, hp, mp, level, PADamage, PDDamage, MADamage, MDDamage, dropPeriod, cp, buffToGive, removeAfter;\n+    private int exp, hp, mp, level, PADamage, PDDamage, MADamage, MDDamage, dropPeriod, cp, buffToGive = -1, removeAfter;\n     private boolean boss, undead, ffaLoot, isExplosiveReward, firstAttack, removeOnMiss;\n     private String name;\n     private Map<String, Integer> animationTimes = new HashMap<String, Integer>();\n@@ -151,7 +151,7 @@ public void setUndead(boolean undead) {\n         this.undead = undead;\n     }\n \n-    public boolean getUndead() {\n+    public boolean isUndead() {\n         return undead;\n     }\n \n@@ -193,8 +193,12 @@ public void setTagBgColor(int tagBgColor) {\n     }\n \n     public void setSkills(List<Pair<Integer, Integer>> skills) {\n-        for (Pair<Integer, Integer> skill : skills) {\n-            this.skills.add(skill);\n+        for (int i = this.skills.size(); i < skills.size(); i++) {\n+            this.skills.add(null);\n+        }\n+        \n+        for (int i = 0; i < skills.size(); i++) {\n+            this.skills.set(i, skills.get(i));\n         }\n     }\n "}, {"sha": "0c1e8ce75912776a75dcf80c9188a197c488d018", "filename": "src/server/maps/MapleHiredMerchant.java", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/server/maps/MapleHiredMerchant.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/server/maps/MapleHiredMerchant.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/maps/MapleHiredMerchant.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -51,7 +51,7 @@\n /**\n  *\n  * @author XoticStory\n- * @author Ronan (concurrency protection)\n+ * @author Ronan - concurrency protection\n  */\n public class MapleHiredMerchant extends AbstractMapleMapObject {\n     private int ownerId, itemId, mesos = 0;"}, {"sha": "9c078e9a7e3b45f521ea7226eb34de12fcb90a80", "filename": "src/server/maps/MapleMap.java", "status": "modified", "additions": 49, "deletions": 20, "changes": 69, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/server/maps/MapleMap.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/server/maps/MapleMap.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/maps/MapleMap.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -1539,7 +1539,40 @@ public final void shuffleReactors(List<Object> list) {\n             mr.setPosition(points.remove(points.size() - 1));\n         }\n     }\n-\n+    \n+    private MapleCharacter getNextControllerCandidate() {\n+        int mincontrolled = Integer.MAX_VALUE;\n+        MapleCharacter newController = null;\n+        \n+        int mincontrolleddead = Integer.MAX_VALUE;\n+        MapleCharacter newControllerDead = null;\n+        \n+        chrRLock.lock();\n+        try {\n+            for (MapleCharacter chr : characters) {\n+                if (!chr.isHidden()) {\n+                    int ctrlMonsSize = chr.getControlledMonsters().size();\n+                    \n+                    if (chr.isAlive()) {\n+                        if (ctrlMonsSize < mincontrolled) {\n+                            mincontrolled = ctrlMonsSize;\n+                            newController = chr;\n+                        }\n+                    } else {\n+                        if (ctrlMonsSize < mincontrolleddead) {\n+                            mincontrolleddead = ctrlMonsSize;\n+                            newControllerDead = chr;\n+                        }\n+                    }\n+                }\n+            }\n+        } finally {\n+            chrRLock.unlock();\n+        }\n+        \n+        return newController != null ? newController : newControllerDead;\n+    }\n+    \n     /**\n      * Automagically finds a new controller for the given monster from the chars\n      * on the map...\n@@ -1553,29 +1586,28 @@ public void updateMonsterController(MapleMonster monster) {\n                 return;\n             }\n             \n+            MapleCharacter newController;\n             MapleCharacter chrController = monster.getController();\n             if (chrController != null) {\n                 if (chrController.getMap() != this) {\n                     chrController.stopControllingMonster(monster);\n+                    newController = getNextControllerCandidate();\n                 } else {\n-                    return;\n-                }\n-            }\n-            int mincontrolled = -1;\n-            MapleCharacter newController = null;\n-            chrRLock.lock();\n-            try {\n-                for (MapleCharacter chr : characters) {\n-                    int ctrlMonsSize = chr.getControlledMonsters().size();\n+                    if (chrController.isAlive()) {\n+                        return;\n+                    }\n                     \n-                    if (!chr.isHidden() && (ctrlMonsSize < mincontrolled || mincontrolled == -1)) {\n-                        mincontrolled = ctrlMonsSize;\n-                        newController = chr;\n+                    newController = getNextControllerCandidate();\n+                    if (newController == null || !newController.isAlive()) {\n+                        return;\n                     }\n+                    \n+                    chrController.stopControllingMonster(monster);\n                 }\n-            } finally {\n-                chrRLock.unlock();\n+            } else {\n+                newController = getNextControllerCandidate();\n             }\n+            \n             if (newController != null) { // was a new controller found? (if not no one is on the map)\n                 if (monster.isFirstAttack()) {\n                     newController.controlMonster(monster, true);\n@@ -2364,11 +2396,8 @@ public void addPlayer(final MapleCharacter chr) {\n             chr.cancelEffectFromBuffStat(MapleBuffStat.MONSTER_RIDING);\n             chr.cancelBuffStats(MapleBuffStat.MONSTER_RIDING);\n         }\n-        if (mapid == 923010000) { // Kenta's Mount Quest\n-            if(getMonsterById(9300102) == null) {\n-                spawnMonsterOnGroundBelow(MapleLifeFactory.getMonster(9300102), new Point(77, 426));\n-            }\n-        } else if (mapid == 200090060) { // To Rien\n+        \n+        if (mapid == 200090060) { // To Rien\n             int travelTime = getWorldServer().getTransportationTime(1 * 60 * 1000);\n             chr.announce(MaplePacketCreator.getClock(travelTime / 1000));\n             TimerManager.getInstance().schedule(new Runnable() {"}, {"sha": "1233fce37d0f65572574c6c64a68502e8ec98a7b", "filename": "src/server/maps/MaplePlayerShop.java", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/server/maps/MaplePlayerShop.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/server/maps/MaplePlayerShop.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/maps/MaplePlayerShop.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -46,7 +46,7 @@\n /**\n  *\n  * @author Matze\n- * @author Ronan (concurrency protection)\n+ * @author Ronan - concurrency protection\n  */\n public class MaplePlayerShop extends AbstractMapleMapObject {\n     private AtomicBoolean open = new AtomicBoolean(false);"}, {"sha": "3e87d53c5eda12ad555caedb053b0c6c8e1c62a7", "filename": "src/server/maps/MapleTVEffect.java", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/server/maps/MapleTVEffect.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/server/maps/MapleTVEffect.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/maps/MapleTVEffect.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -30,7 +30,7 @@\n /*\n  * MapleTVEffect\n  * @author MrXotic\n- * @author Ronan (made MapleTV mechanics synchronous)\n+ * @author Ronan - made MapleTV mechanics synchronous\n  */\n public class MapleTVEffect {\n \t"}, {"sha": "65f7c4c4b6ab891dbf0ae8a76eb952052178972c", "filename": "src/server/quest/MapleQuest.java", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/server/quest/MapleQuest.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/server/quest/MapleQuest.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/quest/MapleQuest.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -45,7 +45,7 @@\n /**\n  *\n  * @author Matze\n- * @author Ronan (support for medal quests)\n+ * @author Ronan - support for medal quests\n  */\n public class MapleQuest {\n "}, {"sha": "802c2ef47f2f047b086e72617ca00db65502a5b2", "filename": "src/tools/DatabaseConnection.java", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/tools/DatabaseConnection.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/tools/DatabaseConnection.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/tools/DatabaseConnection.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -11,9 +11,9 @@\n import constants.ServerConstants;\n \n /**\n- * @author Frz (Big Daddy)\n- * @author The Real Spookster (some modifications to this beautiful code)\n- * @author Ronan (some connection pool to this beautiful code)\n+ * @author Frz - Big Daddy\n+ * @author The Real Spookster - some modifications to this beautiful code\n+ * @author Ronan - some connection pool to this beautiful code\n  */\n public class DatabaseConnection {\n     private static HikariDataSource ds;"}, {"sha": "1d4955637d822f31c2dc0499aac417a0def1bd19", "filename": "src/tools/MaplePacketCreator.java", "status": "modified", "additions": 0, "deletions": 18, "changes": 18, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/src/tools/MaplePacketCreator.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/src/tools/MaplePacketCreator.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/tools/MaplePacketCreator.java?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -2293,24 +2293,6 @@ private static void serializeMovementList(LittleEndianWriter lew, List<LifeMovem\n                 return mplew.getPacket();\n         }\n         \n-        /*\n-        public static byte[] moveMonster(int useskill, int skill, int skill_1, int skill_2, int skill_3, int skill_4, int oid, Point startPos, List<LifeMovementFragment> moves) {\n-                final MaplePacketLittleEndianWriter mplew = new MaplePacketLittleEndianWriter();\n-                mplew.writeShort(SendOpcode.MOVE_MONSTER.getValue());\n-                mplew.writeInt(oid);\n-                mplew.write(0);\n-                mplew.write(useskill);\n-                mplew.write(skill);\n-                mplew.write(skill_1);\n-                mplew.write(skill_2);\n-                mplew.write(skill_3);\n-                mplew.write(skill_4);\n-                mplew.writePos(startPos);\n-                serializeMovementList(mplew, moves);\n-                return mplew.getPacket();\n-        }\n-        */\n-        \n         public static byte[] summonAttack(int cid, int summonOid, byte direction, List<SummonAttackEntry> allDamage) {\n                 final MaplePacketLittleEndianWriter mplew = new MaplePacketLittleEndianWriter();\n                 //b2 00 29 f7 00 00 9a a3 04 00 c8 04 01 94 a3 04 00 06 ff 2b 00"}, {"sha": "0fcd125a848be1a868fa8ad8eee992fc62ac3c28", "filename": "tools/MapleIdRetriever/handbook/Use.txt", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/tools/MapleIdRetriever/handbook/Use.txt", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/tools/MapleIdRetriever/handbook/Use.txt", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/tools/MapleIdRetriever/handbook/Use.txt?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -1177,7 +1177,7 @@\n 2280000 - Lava Bottle - A glass bottle that contains an actual lava, which is waiting to be spilled out. Drink this lava, and the lava will consume the body with fire, which will enable the drinker to master Fire Demon.\n 2280001 - Black Cloud Machine - A mechanical device that produces black clouds. Enables the character to acquire the Smokescreen skill using the clouds.\n 2280002 - Firm Hand - A stimulant packaged inside a bottle that resembles a clenched fist. Drinking the stimulant will allow the character to acquire The Will of a Warrior.\n-2280003 - [Skill Book] Maple Hero - You can learn #cMaple Hero# with this book.rnJob : All 4th jobsrnCondition : #cMaple Hero# not acquired.\n+2280003 - [Skill Book] Maple Warrior - You can learn #cMaple Warrior# with this book.rnJob : All 4th jobsrnCondition : #cMaple Warrior# not acquired.\n 2280004 - [Skill Book] Infinity - You can learn #Infinity# with this book.rnJob : 4th Advancement MagicianrnCondition : #cInfinity# not acquired\n 2280005 - [Skill Book] Dragon's Breath - You can learn #cDragon's Breath# with this book.wnJob : 4th Advancement BowmanrnCondition : #cDragon's Breath# not acquired\n 2280006 - [Skill Book] Taunt - You can learn #cTaunt# with this book.rnJob : 4th Advancement ThiefrnCondition : #cTaunt# not acquired\n@@ -1283,7 +1283,7 @@\n 2290093 - [Mastery Book] Assassinate - This increases the master level of #cAssassinate# up to 30 with 50% of chance.rnClass : ShadowerrnCondition : Skill level above 15\n 2290094 - [Mastery Book] Smokescreen - This increases the master level of #cSmokescreen# up to 20 with 70% of chance.rnClass : ShadowerrnCondition : Skill level above 5\n 2290095 - [Mastery Book] Smokescreen - This increases the master level of #cSmokescreen# up to 30 with 50% of chance.rnClass : ShadowerrnCondition : Skill level above 15\n-2290096 - [Mastery Book] Maple Hero 20 - This increases the master level of #cMaple Hero# up to 20 with 70% of chance.rnJob : All 4th Advancement JobsrnCondition : Skill level above 5\n+2290096 - [Mastery Book] Maple Warrior 20 - This increases the master level of #cMaple Warrior# up to 20 with 70% of chance.rnJob : All 4th Advancement JobsrnCondition : Skill level above 5\n 2290097 - [Mastery Book] Dragon Strike - With a 70% success rate, it raises the Master Level of #cDragon Strike# to 20.nJob : BuccaneernRequirement : At least Level 5 in this skill\n 2290098 - [Mastery Book] Dragon Strike - With a 50% success rate, it raises the Master Level of #cDragon Strike# to 30.nJob : BuccaneernRequirement : At least Level 15 in this skill\n 2290099 - [Mastery Book] Energy Orb - With a 70% success rate, it raises the Master Level of #cEnergy Orb# to 20.nJob : BuccaneernRequirement : At least Level 5 in this skill\n@@ -1312,7 +1312,7 @@\n 2290122 - [Mastery Book] Battleship Torpedo - With a 50% success rate, it raises the Master Level of #cBattleship Torpedo# to 30.nJob : CorsairnRequirement : At least Level 15 in this skill\n 2290123 - [Mastery Book] Hypnotize - With a 70% success rate, it raises the Master Level of #cHypnotize# to 20.nJob : CorsairnRequirement : At least Level 5 in this skill\n 2290124 - [Mastery Book] Bullseye - With a 70% success rate, it raises the Master Level of #cBullseye# to 20.nJob : CorsairnRequirement : At least Level 5 in this skill\n-2290125 - [Mastery Book] Maple Hero 30 - This increases the master level of #cMaple Hero# up to 30 with 50% of chance.rnJob : All 4th Advancement JobsrnCondition : Skill level above 15\n+2290125 - [Mastery Book] Maple Warrior 30 - This increases the master level of #cMaple Warrior# up to 30 with 50% of chance.rnJob : All 4th Advancement JobsrnCondition : Skill level above 15\n 2310000 - The Owl of Minerva - #cThe Owl of Minerva#, which represents wisdom, can be used to search for items sold at the Free Market. #cDisappears right after showing the results of the item search#.\n 2320000 - Teleport Rock - Remembers 5 maps of your choice. This rock will enable you to #cteleport to the map you remembered#. It can even allow you to #cmove to the map where a certain character is#, provided that the person is in the same channel at the same world.\n 2330000 - Bullet - A bullet made out of steel. A set contains numerous bullets and once they are used up, they'll need to be recharged.\\nAttack + 10"}, {"sha": "c160084925bae4827ec28281ac2b3c5cde420822", "filename": "wz/Map.wz/Map/Map2/240070502.img.xml", "status": "modified", "additions": 1326, "deletions": 1340, "changes": 2666, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/wz/Map.wz/Map/Map2/240070502.img.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/wz/Map.wz/Map/Map2/240070502.img.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/wz/Map.wz/Map/Map2/240070502.img.xml?ref=0910dc24282732922e045e23dc3179a089d925b8"}, {"sha": "d5b771cefe7e0e2c2e2e07c8eec5728b6c7ea291", "filename": "wz/Map.wz/Map/Map9/925010300.img.xml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/wz/Map.wz/Map/Map9/925010300.img.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/wz/Map.wz/Map/Map9/925010300.img.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/wz/Map.wz/Map/Map9/925010300.img.xml?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -6,7 +6,7 @@\n     <int name=\"town\" value=\"1\"/>\n     <int name=\"swim\" value=\"0\"/>\n     <int name=\"returnMap\" value=\"120000101\"/>\n-    <int name=\"forcedReturn\" value=\"999999999\"/>\n+    <int name=\"forcedReturn\" value=\"925010200\"/>\n     <float name=\"mobRate\" value=\"1.0\"/>\n     <string name=\"bgm\" value=\"Bgm11/DownTown\"/>\n     <string name=\"mapMark\" value=\"Quest\"/>"}, {"sha": "747256410877afd6cbd77eabfa4c58835253c1d4", "filename": "wz/Quest.wz/Check.img.xml", "status": "modified", "additions": 1, "deletions": 12, "changes": 13, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/wz/Quest.wz/Check.img.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/wz/Quest.wz/Check.img.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/wz/Quest.wz/Check.img.xml?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -59883,12 +59883,6 @@\n     </imgdir>\n     <imgdir name=\"1\">\n       <int name=\"npc\" value=\"1092012\"/>\n-      <int name=\"infoNumber\" value=\"6364\"/>\n-      <imgdir name=\"infoex\">\n-        <imgdir name=\"0\">\n-          <string name=\"value\" value=\"2\"/>\n-        </imgdir>\n-      </imgdir>\n     </imgdir>\n   </imgdir>\n   <imgdir name=\"6370\">\n@@ -60008,12 +60002,7 @@\n     </imgdir>\n     <imgdir name=\"1\">\n       <int name=\"npc\" value=\"2095000\"/>\n-      <int name=\"infoNumber\" value=\"6411\"/>\n-      <imgdir name=\"infoex\">\n-        <imgdir name=\"0\">\n-          <string name=\"value\" value=\"p2\"/>\n-        </imgdir>\n-      </imgdir>\n+      <string name=\"endscript\" value=\"q6410e\"/>\n     </imgdir>\n   </imgdir>\n   <imgdir name=\"6700\">"}, {"sha": "acfbca680f7d13c5641a77747f02ec8b90002798", "filename": "wz/Quest.wz/Say.img.xml", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/wz/Quest.wz/Say.img.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/wz/Quest.wz/Say.img.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/wz/Quest.wz/Say.img.xml?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -57476,7 +57476,7 @@\n   <imgdir name=\"6325\">\n     <imgdir name=\"0\">\n       <int name=\"ask\" value=\"1\"/>\n-      <string name=\"0\" value=\"Hmmm? What is it? Did you lose something?\\n#b#L0#I lost the Maple Hero Skill Book...#l\\n#k\"/>\n+      <string name=\"0\" value=\"Hmmm? What is it? Did you lose something?\\n#b#L0#I lost the Maple Warrior Skill Book...#l\\n#k\"/>\n       <string name=\"1\" value=\"What? You lost something that valuable? Seriously, you weren&apos;t like this before, but ever since you woke up from that deep sleep, you&apos;ve been losing things left and right. Hold on one second\u2026\"/>\n       <imgdir name=\"stop\">\n         <imgdir name=\"0\">\n@@ -57491,7 +57491,7 @@\n       </imgdir>\n     </imgdir>\n     <imgdir name=\"1\">\n-      <string name=\"0\" value=\"Okay, here&apos;s another copy of the Maple Hero Skill Book. Take it.\"/>\n+      <string name=\"0\" value=\"Okay, here&apos;s another copy of the Maple Warrior Skill Book. Take it.\"/>\n       <imgdir name=\"yes\">\n         <string name=\"0\" value=\"Maybe you&apos;re acting slow and dull because the world&apos;s currently at peace. What are you going to do if the Black Mage shows up again? Get your act together!\"/>\n       </imgdir>"}, {"sha": "3025495d16153a1ce7100e0dc67370edee1d3192", "filename": "wz/String.wz/Consume.img.xml", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0910dc24282732922e045e23dc3179a089d925b8/wz/String.wz/Consume.img.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0910dc24282732922e045e23dc3179a089d925b8/wz/String.wz/Consume.img.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/wz/String.wz/Consume.img.xml?ref=0910dc24282732922e045e23dc3179a089d925b8", "patch": "@@ -4704,8 +4704,8 @@\n     <string name=\"desc\" value=\"A stimulant packaged inside a bottle that resembles a clenched fist. Drinking the stimulant will allow the character to acquire The Will of a Warrior.\"/>\n   </imgdir>\n   <imgdir name=\"2280003\">\n-    <string name=\"name\" value=\"[Skill Book] Maple Hero\"/>\n-    <string name=\"desc\" value=\"You can learn #cMaple Hero# with this book.rnJob : All 4th jobsrnCondition : #cMaple Hero# not acquired.\"/>\n+    <string name=\"name\" value=\"[Skill Book] Maple Warrior\"/>\n+    <string name=\"desc\" value=\"You can learn #cMaple Warrior# with this book.rnJob : All 4th jobsrnCondition : #cMaple Warrior# not acquired.\"/>\n   </imgdir>\n   <imgdir name=\"2280004\">\n     <string name=\"name\" value=\"[Skill Book] Infinity\"/>\n@@ -9085,8 +9085,8 @@\n     <string name=\"desc\" value=\"This increases the master level of #cSmokescreen# up to 30 with 50% of chance.\\r\\nClass : Shadower\\r\\nCondition : Skill level above 15\"/>\n   </imgdir>\n   <imgdir name=\"2290096\">\n-    <string name=\"name\" value=\"[Mastery Book] Maple Hero 20\"/>\n-    <string name=\"desc\" value=\"This increases the master level of #cMaple Hero# up to 20 with 70% of chance.\\r\\nJob : All 4th Advancement Jobs\\r\\nCondition : Skill level above 5\"/>\n+    <string name=\"name\" value=\"[Mastery Book] Maple Warrior 20\"/>\n+    <string name=\"desc\" value=\"This increases the master level of #cMaple Warrior# up to 20 with 70% of chance.\\r\\nJob : All 4th Advancement Jobs\\r\\nCondition : Skill level above 5\"/>\n   </imgdir>\n   <imgdir name=\"2290097\">\n     <string name=\"name\" value=\"[Mastery Book] Dragon Strike\"/>\n@@ -9201,8 +9201,8 @@\n     <string name=\"desc\" value=\"With a 70% success rate, it raises the Master Level of #cBullseye# to 20.nJob : Corsair\\r\\nRequirement : At least Level 5 in this skill\"/>\n   </imgdir>\n   <imgdir name=\"2290125\">\n-    <string name=\"name\" value=\"[Mastery Book] Maple Hero 30\"/>\n-    <string name=\"desc\" value=\"This increases the master level of #cMaple Hero# up to 30 with 50% of chance.\\r\\nJob : All 4th Advancement Jobs\\r\\nCondition : Skill level above 15\"/>\n+    <string name=\"name\" value=\"[Mastery Book] Maple Warrior 30\"/>\n+    <string name=\"desc\" value=\"This increases the master level of #cMaple Warrior# up to 30 with 50% of chance.\\r\\nJob : All 4th Advancement Jobs\\r\\nCondition : Skill level above 15\"/>\n   </imgdir>\n   <imgdir name=\"2022303\">\n     <string name=\"name\" value=\"MISSING NAME\"/>"}]}]},
