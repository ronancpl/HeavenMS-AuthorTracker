{"fetchDate": "2019-12-19", "content": [{"sha": "d50b7b69600ae6256c8b8b9b7ff4871dbf628d18", "node_id": "MDY6Q29tbWl0NDUwODIwMjM6ZDUwYjdiNjk2MDBhZTYyNTZjOGI4YjliN2ZmNDg3MWRiZjYyOGQxOA==", "commit": {"author": {"name": "ronancpl", "email": "rcpl2010@gmail.com", "date": "2018-06-23T16:00:28Z"}, "committer": {"name": "ronancpl", "email": "rcpl2010@gmail.com", "date": "2018-06-23T16:00:28Z"}, "message": "Experimental Character/Client Closure + Morph & Crash skills patch\n\nPlayer Trade is now enabled inside PQ & events.\nRefactored minigame code, now using enums rather than strings for logistics.\nFixed Transformations not applying stat buffs properly.\nWarrior's Crash skills now acts accordingly with their description (rather than applying all combined debuffs).\nAdded a server flag for Crash skills, to apply mob immunity debuffs as well.\nFixed Shark Wave not stacking charges.\nDragon Roar now properly stuns the mobs (stun effect won't show up, though).\nRefactored empty method on MapleCharacter, now freeing more resources.\n[EXPERIMENTAL] Upon lifetime's end of the object, empty function will be called alongside MapleClient's clear, should issues arise from that, it's TBD.", "tree": {"sha": "4290e0501241c1b46d553156566edcd99d3e4081", "url": "https://api.github.com/repos/ronancpl/HeavenMS/git/trees/4290e0501241c1b46d553156566edcd99d3e4081"}, "url": "https://api.github.com/repos/ronancpl/HeavenMS/git/commits/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18", "comment_count": 1, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18", "html_url": "https://github.com/ronancpl/HeavenMS/commit/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18", "comments_url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/comments", "author": {"login": "ronancpl", "id": 9257761, "node_id": "MDQ6VXNlcjkyNTc3NjE=", "avatar_url": "https://avatars2.githubusercontent.com/u/9257761?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ronancpl", "html_url": "https://github.com/ronancpl", "followers_url": "https://api.github.com/users/ronancpl/followers", "following_url": "https://api.github.com/users/ronancpl/following{/other_user}", "gists_url": "https://api.github.com/users/ronancpl/gists{/gist_id}", "starred_url": "https://api.github.com/users/ronancpl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ronancpl/subscriptions", "organizations_url": "https://api.github.com/users/ronancpl/orgs", "repos_url": "https://api.github.com/users/ronancpl/repos", "events_url": "https://api.github.com/users/ronancpl/events{/privacy}", "received_events_url": "https://api.github.com/users/ronancpl/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ronancpl", "id": 9257761, "node_id": "MDQ6VXNlcjkyNTc3NjE=", "avatar_url": "https://avatars2.githubusercontent.com/u/9257761?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ronancpl", "html_url": "https://github.com/ronancpl", "followers_url": "https://api.github.com/users/ronancpl/followers", "following_url": "https://api.github.com/users/ronancpl/following{/other_user}", "gists_url": "https://api.github.com/users/ronancpl/gists{/gist_id}", "starred_url": "https://api.github.com/users/ronancpl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ronancpl/subscriptions", "organizations_url": "https://api.github.com/users/ronancpl/orgs", "repos_url": "https://api.github.com/users/ronancpl/repos", "events_url": "https://api.github.com/users/ronancpl/events{/privacy}", "received_events_url": "https://api.github.com/users/ronancpl/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c4d6531177c45bedb5f36db2b96d41e3286b9789", "url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/c4d6531177c45bedb5f36db2b96d41e3286b9789", "html_url": "https://github.com/ronancpl/HeavenMS/commit/c4d6531177c45bedb5f36db2b96d41e3286b9789"}], "stats": {"total": 550, "additions": 387, "deletions": 163}, "files": [{"sha": "187491f2ef7210c8d526f6f125ba12fba5ab24c5", "filename": "README.md", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/README.md", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/README.md", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/README.md?ref=d50b7b69600ae6256c8b8b9b7ff4871dbf628d18", "patch": "@@ -53,7 +53,7 @@ Recommended localhost: https://hostr.co/m2bVtnizCtmD\n \n Status: <span style=\"color:green\">__Released__</span>.\n \n-HeavenMS development achieved an acceptable state-of-art and will get into a halt. A heartfelt thanks for everyone that contributed in some way for the progress of this server!\n+HeavenMS development achieved an acceptable state-of-the-art and will get into a halt. A heartfelt thanks for everyone that contributed in some way for the progress of this server!\n \n Although development is halted, support for fixing features that were implemented here is still up. You can still actively help us improve the server by issuing pull requests with informative details about what's changing.\n \n@@ -153,7 +153,7 @@ The client's set-up is quite straightforward:\n 2. Once done, erase these files: \"HShield\" (folder), \"ASPLauncher.exe\", \"MapleStory.exe\" and \"patcher.exe\".\n 3. Extract into the client folder the \"localhost.exe\" from the provided link.\n 4. Overwrite the original WZ files with the ones provided from either one of those folders on the Google Drive:\n-\t- \"rev???_wz\" (last published RELEASE, referring to commit of same number).\n+\t- \"commit???_wz\" (last published RELEASE, referring to commit of same number).\n \t- \"current_wz\" (latest source update).\n \n #### Editing localhost IP target"}, {"sha": "f51a54bc6b6d116170b6ff71b7ab498448aeafb2", "filename": "docs/fieldlimits.txt", "status": "added", "additions": 27, "deletions": 0, "changes": 27, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/docs/fieldlimits.txt", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/docs/fieldlimits.txt", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/docs/fieldlimits.txt?ref=d50b7b69600ae6256c8b8b9b7ff4871dbf628d18", "patch": "@@ -0,0 +1,27 @@\n+Provided by Arnah, source: http://forum.ragezone.com/f702/release-harepacker-resurrected-1149521/index2.html\n+\n+Field limits (v95):\n+FIELDOPT_MOVELIMIT = 0x1,  \n+FIELDOPT_SKILLLIMIT = 0x2,  \n+FIELDOPT_SUMMONLIMIT = 0x4,  \n+FIELDOPT_MYSTICDOORLIMIT = 0x8,  \n+FIELDOPT_MIGRATELIMIT = 0x10,  \n+FIELDOPT_PORTALSCROLLLIMIT = 0x20,  \n+FIELDOPT_TELEPORTITEMLIMIT = 0x40,  \n+FIELDOPT_MINIGAMELIMIT = 0x80,  \n+FIELDOPT_SPECIFICPORTALSCROLLLIMIT = 0x100,  \n+FIELDOPT_TAMINGMOBLIMIT = 0x200,  \n+FIELDOPT_STATCHANGEITEMCONSUMELIMIT = 0x400,  \n+FIELDOPT_PARTYBOSSCHANGELIMIT = 0x800,  \n+FIELDOPT_NOMOBCAPACITYLIMIT = 0x1000,  \n+FIELDOPT_WEDDINGINVITATIONLIMIT = 0x2000,  \n+FIELDOPT_CASHWEATHERCONSUMELIMIT = 0x4000,  \n+FIELDOPT_NOPET = 0x8000,  \n+FIELDOPT_ANTIMACROLIMIT = 0x10000,  \n+FIELDOPT_FALLDOWNLIMIT = 0x20000,  \n+FIELDOPT_SUMMONNPCLIMIT = 0x40000,  \n+FIELDOPT_NOEXPDECREASE = 0x80000,  \n+FIELDOPT_NODAMAGEONFALLING = 0x100000,  \n+FIELDOPT_PARCELOPENLIMIT = 0x200000, \n+FIELDOPT_DROPLIMIT = 0x400000,  \n+FIELDOPT_ROCKETBOOSTER_LIMIT = 0x800000,\n\\ No newline at end of file"}, {"sha": "6f68216c1f24f12938010743e38a0203ebbf4d30", "filename": "docs/issues.txt", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/docs/issues.txt", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/docs/issues.txt", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/docs/issues.txt?ref=d50b7b69600ae6256c8b8b9b7ff4871dbf628d18", "patch": "@@ -12,6 +12,7 @@ Known issues:\n - Deadlocks may start appearing if the server stays online long enough with many players logged in.\n - If there are multiple bosses that shows HPBar on the map, if a player hits more than one the HPBar may start flickering on the screen.\n - Sometimes battleship may behave oddly with the enhanced buff system, making the character d/c in certain scenarios.\n+- Dragon Roar doesn't show the stun effect to players.\n ---------------------------\n \n ---------------------------"}, {"sha": "e8afa71c51576c317977cb9d704b6972594887bf", "filename": "docs/mychanges_ptbr.txt", "status": "modified", "additions": 14, "deletions": 1, "changes": 15, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/docs/mychanges_ptbr.txt", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/docs/mychanges_ptbr.txt", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/docs/mychanges_ptbr.txt?ref=d50b7b69600ae6256c8b8b9b7ff4871dbf628d18", "patch": "@@ -1049,4 +1049,17 @@ Corrigido Heaven's Hammer e Combo Tempest n\u00e3o mostrando dano aos jogadores.\n Corrigido exploit onde jogadores poderiam criar minirooms em certos casos onde os mesmos n\u00e3o poderiam faz\u00ea-lo.\n Quest itens dropados de mobs que n\u00e3o vis\u00edveis pelo jogador atacante agora s\u00e3o mostrados mais nas pontas, de forma que o conjunto de drops agora aparente n\u00e3o ter espa\u00e7o com itens invis\u00edveis no meio.\n Corrigido Horntail n\u00e3o atruibuindo quest progress corretamente para a quest The Last Hour of Horntail.\n-Removido skill books agora desnecess\u00e1rios do drop data, uma vez que j\u00e1 foi implementado as quests para conseguir elas.\n\\ No newline at end of file\n+Removido skill books agora desnecess\u00e1rios do drop data, uma vez que j\u00e1 foi implementado as quests para conseguir elas.\n+\n+16 Junho 2018,\n+Corrigido Trade n\u00e3o podendo ser realizado dentro de PQ, problema ocorrendo devido a uma mudan\u00e7a feita no \u00faltimo commit.\n+Refatorado minigames, agora utilizando enums ao inv\u00e9s de strings.\n+Corrigido Transformations n\u00e3o recebendo stat buffs corretamente.\n+Corrigido skills Crash agora atuando dentro de suas respectivas reparti\u00e7\u00f5es.\n+Adicionado server flag para permitir skills Crash retirar invencibilidades do mob.\n+Corrigido Shark Wave n\u00e3o realizando contabiliza\u00e7\u00e3o de charges ao aplicar dano.\n+Dragon Roar agora aplica stun em mobs (efeito de stun aparentemente n\u00e3o est\u00e1 sendo mostrado aos jogadores).\n+\n+22 Junho 2018,\n+Refatorado m\u00e9todo de empty em MapleCharacter, agora verificando e liberando mais recursos.\n+Corrigido exploit onde pacotes referentes \u00e0 chairs poderiam ser processados e reenviados aos outros em casos onde o personagem est\u00e1 fora do world server.\n\\ No newline at end of file"}, {"sha": "79679a6727a0cd9eebd2eb6725100d7c8a064d09", "filename": "scripts/npc/2020008.js", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/scripts/npc/2020008.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/scripts/npc/2020008.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/2020008.js?ref=d50b7b69600ae6256c8b8b9b7ff4871dbf628d18", "patch": "@@ -56,8 +56,8 @@ function start() {\n     \n     var jobBase = parseInt(cm.getJobId() / 100);\n     var jobStyle = 1;\n-    if (!(cm.getPlayer().getLevel() >= 70 && jobBase == jobStyle)){\n-        if(cm.getPlayer().getLevel() >= 70 && jobBase % 10 == jobStyle) {\n+    if (!(cm.getPlayer().getLevel() >= 70 && jobBase == jobStyle && cm.getJobId() % 10 == 0)){\n+        if(cm.getPlayer().getLevel() >= 50 && jobBase % 10 == jobStyle) {\n             status++;\n             action(1, 0, 1);\n             return;"}, {"sha": "0ed7c474772a0866e732ca1a2a756f720861b85c", "filename": "scripts/npc/2020009.js", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/scripts/npc/2020009.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/scripts/npc/2020009.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/2020009.js?ref=d50b7b69600ae6256c8b8b9b7ff4871dbf628d18", "patch": "@@ -28,8 +28,8 @@ actionx = {\"Mental\" : false, \"Physical\" : false};\n function start() {\n     var jobBase = parseInt(cm.getJobId() / 100);\n     var jobStyle = 2;\n-    if (!(cm.getPlayer().getLevel() >= 70 && jobBase == jobStyle)){\n-        if(cm.getPlayer().getLevel() >= 70 && jobBase % 10 == jobStyle) {\n+    if (!(cm.getPlayer().getLevel() >= 70 && jobBase == jobStyle && cm.getJobId() % 10 == 0)){\n+        if(cm.getPlayer().getLevel() >= 50 && jobBase % 10 == jobStyle) {\n             status++;\n             action(1, 0, 1);\n             return;"}, {"sha": "8cadcdca12d3717bf50cd2bb2871da2f59120803", "filename": "scripts/npc/2020010.js", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/scripts/npc/2020010.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/scripts/npc/2020010.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/2020010.js?ref=d50b7b69600ae6256c8b8b9b7ff4871dbf628d18", "patch": "@@ -30,8 +30,8 @@ actionx = {\"Mental\" : false, \"Physical\" : false};\n function start() {\n     var jobBase = parseInt(cm.getJobId() / 100);\n     var jobStyle = 3;\n-    if (!(cm.getPlayer().getLevel() >= 70 && jobBase == jobStyle)){\n-        if(cm.getPlayer().getLevel() >= 70 && jobBase % 10 == jobStyle) {\n+    if (!(cm.getPlayer().getLevel() >= 70 && jobBase == jobStyle && cm.getJobId() % 10 == 0)){\n+        if(cm.getPlayer().getLevel() >= 50 && jobBase % 10 == jobStyle) {\n             status++;\n             action(1, 0, 1);\n             return;"}, {"sha": "980ec018d3ff6dac1d821baf30fa97234bccdf3b", "filename": "scripts/npc/2020011.js", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/scripts/npc/2020011.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/scripts/npc/2020011.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/2020011.js?ref=d50b7b69600ae6256c8b8b9b7ff4871dbf628d18", "patch": "@@ -28,8 +28,8 @@ actionx = {\"Mental\" : false, \"Physical\" : false};\n function start() {\n     var jobBase = parseInt(cm.getJobId() / 100);\n     var jobStyle = 4;\n-    if (!(cm.getPlayer().getLevel() >= 70 && jobBase == jobStyle)){\n-        if(cm.getPlayer().getLevel() >= 70 && jobBase % 10 == jobStyle) {\n+    if (!(cm.getPlayer().getLevel() >= 70 && jobBase == jobStyle && cm.getJobId() % 10 == 0)){\n+        if(cm.getPlayer().getLevel() >= 50 && jobBase % 10 == jobStyle) {\n             status++;\n             action(1, 0, 1);\n             return;"}, {"sha": "d8c6615f574e2397c9c6e579ea9338a1656ee9f2", "filename": "scripts/npc/2020013.js", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/scripts/npc/2020013.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/scripts/npc/2020013.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/2020013.js?ref=d50b7b69600ae6256c8b8b9b7ff4871dbf628d18", "patch": "@@ -28,8 +28,8 @@ actionx = {\"Mental\" : false, \"Physical\" : false};\n function start() {\n     var jobBase = parseInt(cm.getJobId() / 100);\n     var jobStyle = 5;\n-    if (!(cm.getPlayer().getLevel() >= 70 && jobBase == jobStyle)){\n-        if(cm.getPlayer().getLevel() >= 70 && jobBase % 10 == jobStyle) {\n+    if (!(cm.getPlayer().getLevel() >= 70 && jobBase == jobStyle && cm.getJobId() % 10 == 0)){\n+        if(cm.getPlayer().getLevel() >= 50 && jobBase % 10 == jobStyle) {\n             status++;\n             action(1, 0, 1);\n             return;"}, {"sha": "d063cc6ca281db321120bb0533654975bbb7bdc1", "filename": "scripts/npc/2080000.js", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/scripts/npc/2080000.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/scripts/npc/2080000.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/2080000.js?ref=d50b7b69600ae6256c8b8b9b7ff4871dbf628d18", "patch": "@@ -40,9 +40,8 @@ function start() {\n     var options = new Array(\"What's a stimulator?\",\"Create a Warrior weapon\",\"Create a Bowman weapon\",\"Create a Magician weapon\",\"Create a Thief weapon\",\"Create a Pirate Weapon\",\n         \"Create a Warrior weapon with a Stimulator\",\"Create a Bowman weapon with a Stimulator\",\"Create a Magician weapon with a Stimulator\",\"Create a Thief weapon with a Stimulator\",\"Create a Pirate Weapon with a Stimulator\");\n         \n-    if(cm.isQuestStarted(7301)) options.push(\"Make #t4001078#\");\n+    if(cm.isQuestStarted(7301) || cm.isQuestStarted(7303)) options.push(\"Make #t4001078#\");\n     \n-        \n     for (var i = 0; i < options.length; i++){\n         selStr += \"\\r\\n#L\" + i + \"# \" + options[i] + \"#l\";\n     }"}, {"sha": "3dda183df6163402ce78eec03647211d29c4d1ce", "filename": "scripts/npc/credits.js", "status": "modified", "additions": 10, "deletions": 1, "changes": 11, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/scripts/npc/credits.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/scripts/npc/credits.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/credits.js?ref=d50b7b69600ae6256c8b8b9b7ff4871dbf628d18", "patch": "@@ -11,7 +11,8 @@ var name_tree = [];\n var role_tree = [];\n var name_cursor, role_cursor;\n \n-// make sure the server names are lexicograffically EQUALS to the correspondent function.\n+// new server names are to be appended at the start of the name stack, building up the chronology.\n+// make sure the server names are lexicograffically equivalent to their correspondent function.\n var servers = [\"HeavenMS\", \"MapleSolaxia\", \"MoopleDEV\", \"MetroMS\", \"BubblesDEV\", \"ThePackII\", \"OdinMS\", \"Contributors\"];\n var servers_history = [];\n \n@@ -24,6 +25,14 @@ function setHistory(from, to) {\n         servers_history.push([from, to]);\n }\n \n+/*\n+function writeServerStaff_MapleNext() {\n+        addPerson(\"John Doe\", \"The role\");\n+\n+        setHistory(INITIAL_YEAR [, CURRENT_YEAR]);\n+}\n+*/\n+\n function writeServerStaff_HeavenMS() {\n         addPerson(\"Ronan\", \"Developer\");\n         addPerson(\"Vcoc\", \"Freelance Developer\");"}, {"sha": "4516ec5b8ce2d35a53c005b4f1cf9577299c5f8f", "filename": "src/client/MapleCharacter.java", "status": "modified", "additions": 48, "deletions": 29, "changes": 77, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/src/client/MapleCharacter.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/src/client/MapleCharacter.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/MapleCharacter.java?ref=d50b7b69600ae6256c8b8b9b7ff4871dbf628d18", "patch": "@@ -88,6 +88,7 @@\n import server.maps.MapleMapObject;\n import server.maps.MapleMapObjectType;\n import server.maps.MapleMiniGame;\n+import server.maps.MapleMiniGame.MiniGameResult;\n import server.maps.MaplePlayerShop;\n import server.maps.MaplePlayerShopItem;\n import server.maps.MapleSummon;\n@@ -3600,9 +3601,18 @@ public int compare( Pair<MapleStatEffect, Pair<Integer, Integer>> o1, Pair<Maple\n             toUpdateEffects.add(new Pair<>(mse.getBuffSourceId(), retrievedEffects.get(mse.getBuffSourceId())));\n         }\n         \n+        List<Pair<MapleBuffStat, Integer>> activeStatups = new LinkedList<>();\n         for(Pair<Integer, Pair<MapleStatEffect, Long>> lmse: toUpdateEffects) {\n             Pair<MapleStatEffect, Long> msel = lmse.getRight();\n-            msel.getLeft().updateBuffEffect(this, getActiveStatupsFromSourceid(lmse.getLeft()), msel.getRight());\n+            \n+            for(Pair<MapleBuffStat, Integer> statup : getActiveStatupsFromSourceid(lmse.getLeft())) {\n+                if(!isSingletonStatup(statup.getLeft())) {\n+                    activeStatups.add(statup);\n+                }\n+            }\n+            \n+            msel.getLeft().updateBuffEffect(this, activeStatups, msel.getRight());\n+            activeStatups.clear();\n         }\n         \n         if (this.isRidingBattleship()) {\n@@ -4450,21 +4460,21 @@ public MapleMiniGame getMiniGame() {\n         return miniGame;\n     }\n \n-    public int getMiniGamePoints(String type, boolean omok) {\n+    public int getMiniGamePoints(MiniGameResult type, boolean omok) {\n         if (omok) {\n             switch (type) {\n-                case \"wins\":\n+                case WIN:\n                     return omokwins;\n-                case \"losses\":\n+                case LOSS:\n                     return omoklosses;\n                 default:\n                     return omokties;\n             }\n         } else {\n             switch (type) {\n-                case \"wins\":\n+                case WIN:\n                     return matchcardwins;\n-                case \"losses\":\n+                case LOSS:\n                     return matchcardlosses;\n                 default:\n                     return matchcardties;\n@@ -5460,7 +5470,7 @@ public void levelUp(boolean takeexp) {\n                 this.yellowMessage(\"You reached level \" + level + \". Congratulations! As a token of your success, your inventory has been expanded a little bit.\");\n             }            \n         }\n-        if (level % 20 == 0 && ServerConstants.USE_ADD_RATES_BY_LEVEL == true) { //For the drop & meso rate\n+        if (level % 20 == 0 && ServerConstants.USE_ADD_RATES_BY_LEVEL == true) { //For the rate upgrade\n             revertLastPlayerRates();\n             setPlayerRates();\n             this.yellowMessage(\"You managed to get level \" + level + \"! Getting experience and items seems a little easier now, huh?\");\n@@ -8613,33 +8623,42 @@ public void setPartyQuest(PartyQuest pq) {\n     }\n \n     public final void empty(final boolean remove) {\n-        if (dragonBloodSchedule != null) {\n-            dragonBloodSchedule.cancel(false);\n-        }\n-        if (hpDecreaseTask != null) {\n-            hpDecreaseTask.cancel(false);\n-        }\n-        if (beholderHealingSchedule != null) {\n-            beholderHealingSchedule.cancel(false);\n-        }\n-        if (beholderBuffSchedule != null) {\n-            beholderBuffSchedule.cancel(false);\n-        }\n-        if (berserkSchedule != null) {\n-            berserkSchedule.cancel(false);\n-        }\n-        if (recoveryTask != null) {\n-            recoveryTask.cancel(false);\n-        }\n-        if (extraRecoveryTask != null) {\n-            extraRecoveryTask.cancel(false);\n-        }\n-        \n+        if (dragonBloodSchedule != null) { dragonBloodSchedule.cancel(true); }\n+        dragonBloodSchedule = null;\n+\n+        if (hpDecreaseTask != null) { hpDecreaseTask.cancel(true); }\n+        hpDecreaseTask = null;\n+\n+        if (beholderHealingSchedule != null) { beholderHealingSchedule.cancel(true); }\n+        beholderHealingSchedule = null;\n+\n+        if (beholderBuffSchedule != null) { beholderBuffSchedule.cancel(true); }\n+        beholderBuffSchedule = null;\n+\n+        if (berserkSchedule != null) { berserkSchedule.cancel(true); }\n+        berserkSchedule = null;\n+\n         unregisterChairBuff();\n         cancelBuffExpireTask();\n         cancelDiseaseExpireTask();\n         cancelSkillCooldownTask();\n         cancelExpirationTask();\n+\n+        if (questExpireTask != null) { questExpireTask.cancel(true); }\n+        questExpireTask = null;\n+\n+        if (recoveryTask != null) { recoveryTask.cancel(true); }\n+        recoveryTask = null;\n+\n+        if (extraRecoveryTask != null) { extraRecoveryTask.cancel(true); }\n+        extraRecoveryTask = null;\n+\n+        // already done on unregisterChairBuff\n+        /* if (chairRecoveryTask != null) { chairRecoveryTask.cancel(true); }\n+        chairRecoveryTask = null; */\n+\n+        if (pendantOfSpirit != null) { pendantOfSpirit.cancel(true); }\n+        pendantOfSpirit = null;\n         \n         petLock.lock();\n         try {"}, {"sha": "1831e1facc5812ac0199cf44ec6c47b75f0682ca", "filename": "src/client/MapleClient.java", "status": "modified", "additions": 12, "deletions": 5, "changes": 17, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/src/client/MapleClient.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/src/client/MapleClient.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/MapleClient.java?ref=d50b7b69600ae6256c8b8b9b7ff4871dbf628d18", "patch": "@@ -843,7 +843,7 @@ public final synchronized void disconnect(boolean shutdown, boolean cashshop) {/\n                                 player.saveCooldowns();\n                                 player.saveToDB(true);\n                             \n-\t\t\t\tplayer = null;\n+                                clear();\n \t\t\t\treturn;\n \t\t\t}\n                         \n@@ -935,25 +935,32 @@ public final synchronized void disconnect(boolean shutdown, boolean cashshop) {/\n                                         player.saveCooldowns();\n                                         player.saveToDB();\n                                 }\n-                                player = null;\n \t\t\t}\n \t\t}\n \t\tif (!serverTransition && isLoggedIn()) {\n \t\t\tupdateLoginState(MapleClient.LOGIN_NOTLOGGEDIN);\n \t\t\tsession.removeAttribute(MapleClient.CLIENT_KEY); // prevents double dcing during login\n \t\t\tsession.close(false);\n-\t\t}\n-\t\tengines.clear();\n+                        \n+                        clear();\n+\t\t} else {\n+                        engines.clear();\n+                }\n \t}\n \n \tprivate void clear() {  //usable when defining client = null shortly after\n+                // player hard reference removal thanks to Steve (kaito1410)\n+                if (this.player != null) {\n+                    this.player.empty(true); // clears schedules and stuff\n+                }\n+            \n                 Server.getInstance().unregisterLoginState(this);\n             \n \t\tthis.accountName = null;\n \t\tthis.macs = null;\n \t\tthis.hwid = null;\n \t\tthis.birthday = null;\n-\t\t//this.engines = null;\n+\t\tthis.engines = null;\n \t\tthis.player = null;\n \t\tthis.receive = null;\n \t\tthis.send = null;"}, {"sha": "60cc28f578ede287db58791f80ee8a8a4b61b51e", "filename": "src/client/MapleJob.java", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/src/client/MapleJob.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/src/client/MapleJob.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/MapleJob.java?ref=d50b7b69600ae6256c8b8b9b7ff4871dbf628d18", "patch": "@@ -120,8 +120,9 @@ public boolean isBeginner(MapleJob beginners) {\n     \t\t\t|| DAWNWARRIOR1 == beginners || NIGHTWALKER1 == beginners || BLAZEWIZARD1 == beginners;\n      }\n     \n-    public boolean isA(MapleJob basejob) {        \n-        return getId() >= basejob.getId() && getId() / 100 == basejob.getId() / 100;\n+    public boolean isA(MapleJob basejob) {  // thanks Steve (kaito1410) for pointing out an improvement here\n+        int basebranch = basejob.getId() / 10;\n+        return (getId() / 10 == basebranch && getId() >= basejob.getId()) || (basebranch % 10 == 0 && getId() / 100 == basejob.getId() / 100);\n     }\n     \n     public int getJobNiche() {"}, {"sha": "a9a3cd6973887a3063e0201ca22f71ecc92440f0", "filename": "src/constants/CharsetConstants.java", "status": "added", "additions": 48, "deletions": 0, "changes": 48, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/src/constants/CharsetConstants.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/src/constants/CharsetConstants.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/constants/CharsetConstants.java?ref=d50b7b69600ae6256c8b8b9b7ff4871dbf628d18", "patch": "@@ -0,0 +1,48 @@\n+/*\n+ * To change this license header, choose License Headers in Project Properties.\n+ * To change this template file, choose Tools | Templates\n+ * and open the template in the editor.\n+ */\n+ \n+package constants;\n+ \n+/*\n+ * Courtesy of GabrielSin (gabrielsin@playellin.net)\n+ * Ellin\n+ * MapleStory Server\n+ * CharsetConstants\n+ */\n+ \n+public class CharsetConstants {\n+   \n+    public static MapleLanguageType MAPLE_TYPE = MapleLanguageType.LANGUAGE_PT_BR;\n+   \n+    public enum MapleLanguageType {\n+        LANGUAGE_PT_BR(1, \"ISO-8859-1\"),\n+        LANGUAGE_US(2, \"US-ASCII\");\n+        final byte type;\n+        final String ascii;\n+ \n+        private MapleLanguageType(int type, String ascii) {\n+            this.type = (byte) type;\n+            this.ascii = ascii;\n+        }\n+ \n+        public String getAscii() {\n+            return ascii;\n+        }\n+ \n+        public byte getType() {\n+            return type;\n+        }\n+ \n+        public static MapleLanguageType getByType(byte type) {\n+            for (MapleLanguageType l : MapleLanguageType.values()) {\n+                if (l.getType() == type) {\n+                    return l;\n+                }\n+            }\n+            return LANGUAGE_PT_BR;\n+        }\n+    }\n+}\n\\ No newline at end of file"}, {"sha": "8761c07d63057a3a12262decfa193ff196db67db", "filename": "src/constants/ServerConstants.java", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/src/constants/ServerConstants.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/src/constants/ServerConstants.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/constants/ServerConstants.java?ref=d50b7b69600ae6256c8b8b9b7ff4871dbf628d18", "patch": "@@ -140,6 +140,7 @@\n     \n     //Other Skills Configuration\n     public static final boolean USE_FAST_REUSE_HERO_WILL = true;//Greatly reduce cooldown on Hero's Will.\n+    public static final boolean USE_ANTI_IMMUNITY_CRASH = true; //Crash skills additionally removes the mob's invincibility buffs.\n     \n     //Character Configuration\n     public static final boolean USE_ADD_SLOTS_BY_LEVEL = true;  //Slots are added each 20 levels."}, {"sha": "1558680b89b6c2269ce3a7345cb0c09a461e4456", "filename": "src/constants/skills/ThunderBreaker.java", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/src/constants/skills/ThunderBreaker.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/src/constants/skills/ThunderBreaker.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/constants/skills/ThunderBreaker.java?ref=d50b7b69600ae6256c8b8b9b7ff4871dbf628d18", "patch": "@@ -38,4 +38,5 @@\n     public static final int TRANSFORMATION = 15111002;\n     public static final int SPEED_INFUSION = 15111005;\n     public static final int SPARK = 15111006;\n+    public static final int SHARK_WAVE = 15111007;\n }"}, {"sha": "c3bb66ce506d81714380168d56214e79ef0526a4", "filename": "src/net/server/PlayerStorage.java", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/src/net/server/PlayerStorage.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/src/net/server/PlayerStorage.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/PlayerStorage.java?ref=d50b7b69600ae6256c8b8b9b7ff4871dbf628d18", "patch": "@@ -21,6 +21,7 @@\n */\n package net.server;\n \n+import client.MapleClient;\n import client.MapleCharacter;\n import java.util.Collection;\n import java.util.Iterator;\n@@ -93,7 +94,11 @@ public final void disconnectAll() {\n \ttry {\t    \n             final Iterator<MapleCharacter> chrit = storage.values().iterator();\n \t    while (chrit.hasNext()) {\n-                chrit.next().getClient().disconnect(true, false);\n+                MapleClient client = chrit.next().getClient();\n+                if(client != null) {\n+                    client.disconnect(true, false);\n+                }\n+                \n                 chrit.remove();\n             }\n \t} finally {"}, {"sha": "d8bb3416b8bffedd6cd81d3c15eb6b34bbd0f3d7", "filename": "src/net/server/channel/handlers/AbstractDealDamageHandler.java", "status": "modified", "additions": 7, "deletions": 10, "changes": 17, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/src/net/server/channel/handlers/AbstractDealDamageHandler.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/src/net/server/channel/handlers/AbstractDealDamageHandler.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/channel/handlers/AbstractDealDamageHandler.java?ref=d50b7b69600ae6256c8b8b9b7ff4871dbf628d18", "patch": "@@ -29,7 +29,6 @@\n import java.util.Map;\n \n import net.AbstractMaplePacketHandler;\n-import server.MapleItemInformationProvider;\n import server.MapleStatEffect;\n import server.TimerManager;\n import server.life.Element;\n@@ -43,7 +42,6 @@\n import server.maps.MapleMapItem;\n import server.maps.MapleMapObject;\n import server.maps.MapleMapObjectType;\n-import server.partyquest.Pyramid;\n import tools.MaplePacketCreator;\n import tools.Pair;\n import tools.Randomizer;\n@@ -55,13 +53,9 @@\n import client.Skill;\n import client.SkillFactory;\n import client.autoban.AutobanFactory;\n-import client.inventory.Equip;\n-import client.inventory.Item;\n-import client.inventory.MapleInventoryType;\n import client.status.MonsterStatus;\n import client.status.MonsterStatusEffect;\n import constants.GameConstants;\n-import constants.ItemConstants;\n import constants.ServerConstants;\n import constants.skills.Aran;\n import constants.skills.Assassin;\n@@ -304,7 +298,7 @@ public void run() {\n                         }\n                     } else if (attack.skill == Marauder.ENERGY_DRAIN || attack.skill == ThunderBreaker.ENERGY_DRAIN || attack.skill == NightWalker.VAMPIRE || attack.skill == Assassin.DRAIN) {\n                         player.addHP(Math.min(monster.getMaxHp(), Math.min((int) ((double) totDamage * (double) SkillFactory.getSkill(attack.skill).getEffect(player.getSkillLevel(SkillFactory.getSkill(attack.skill))).getX() / 100.0), player.getMaxHp() / 2)));\n-                    } else if (attack.skill == Bandit.STEAL) {                    \t\n+                    } else if (attack.skill == Bandit.STEAL) {\n                         Skill steal = SkillFactory.getSkill(Bandit.STEAL);\n                         if (monster.getStolen().size() < 1) { // One steal per mob <3\n                             if (steal.getEffect(player.getSkillLevel(steal)).makeChanceResult()) {\n@@ -480,9 +474,12 @@ public void run() {\n                             }\n                         }\n                     }\n-                    if (totDamageToOneMonster > 0 && attackEffect != null && attackEffect.getMonsterStati().size() > 0) {\n-                        if (attackEffect.makeChanceResult()) {\n-                            monster.applyStatus(player, new MonsterStatusEffect(attackEffect.getMonsterStati(), theSkill, null, false), attackEffect.isPoison(), attackEffect.getDuration());\n+                    if (totDamageToOneMonster > 0 && attackEffect != null) {\n+                        Map<MonsterStatus, Integer> attackEffectStati = attackEffect.getMonsterStati();\n+                        if(!attackEffectStati.isEmpty()) {\n+                            if (attackEffect.makeChanceResult()) {\n+                                monster.applyStatus(player, new MonsterStatusEffect(attackEffectStati, theSkill, null, false), attackEffect.isPoison(), attackEffect.getDuration());\n+                            }\n                         }\n                     }\n                     if (attack.skill == Paladin.HEAVENS_HAMMER) {"}, {"sha": "e226841e13765dff1e01a9103e2c4fa374a0d9da", "filename": "src/net/server/channel/handlers/CancelChairHandler.java", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/src/net/server/channel/handlers/CancelChairHandler.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/src/net/server/channel/handlers/CancelChairHandler.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/channel/handlers/CancelChairHandler.java?ref=d50b7b69600ae6256c8b8b9b7ff4871dbf628d18", "patch": "@@ -33,6 +33,7 @@\n     public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c) {\n         int id = slea.readShort();\n         MapleCharacter mc = c.getPlayer();\n+        if(!mc.isLoggedinWorld()) return;\n         \n         if (id == -1) { // Cancel Chair\n             mc.setChair(0);"}, {"sha": "f6d58f54c6102eeb5b48e958a95139a768e7d6f1", "filename": "src/net/server/channel/handlers/PlayerInteractionHandler.java", "status": "modified", "additions": 38, "deletions": 20, "changes": 58, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/src/net/server/channel/handlers/PlayerInteractionHandler.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/src/net/server/channel/handlers/PlayerInteractionHandler.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/channel/handlers/PlayerInteractionHandler.java?ref=d50b7b69600ae6256c8b8b9b7ff4871dbf628d18", "patch": "@@ -31,17 +31,15 @@\n import constants.ItemConstants;\n import constants.ServerConstants;\n \n-import java.util.Arrays;\n-\n import net.AbstractMaplePacketHandler;\n import server.MapleItemInformationProvider;\n import server.MapleTrade;\n import constants.GameConstants;\n import server.maps.FieldLimit;\n import server.maps.MapleHiredMerchant;\n import server.maps.MapleMapObject;\n-import server.maps.MapleMapObjectType;\n import server.maps.MapleMiniGame;\n+import server.maps.MapleMiniGame.MiniGameType;\n import server.maps.MaplePlayerShop;\n import server.maps.MaplePlayerShopItem;\n import tools.FilePrinter;\n@@ -111,6 +109,22 @@ public byte getCode() {\n         }\n     }\n \n+    private static int estabilishMiniroomStatus(MapleCharacter chr, boolean isMinigame) {\n+        if (isMinigame && FieldLimit.CANNOTMINIGAME.check(chr.getMap().getFieldLimit())) {\n+            return 11;\n+        }\n+\n+        if (chr.getChalkboard() != null) {\n+            return 13;\n+        }\n+\n+        if(chr.getEventInstance() != null) {\n+            return 5;\n+        }\n+        \n+        return 0;\n+    }\n+    \n     @Override\n     public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c) {\n         byte mode = slea.readByte();\n@@ -122,17 +136,13 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n                 return;\n             }\n             \n-            if(chr.getEventInstance() != null) {\n-                chr.getClient().announce(MaplePacketCreator.getMiniRoomError(5));\n-                return;\n-            }\n-            \n             byte createType = slea.readByte();\n             if (createType == 3) {// trade\n                 MapleTrade.startTrade(chr);\n             } else if (createType == 1) { // omok mini game\n-                if (chr.getChalkboard() != null || FieldLimit.CANNOTMINIGAME.check(chr.getMap().getFieldLimit())) {\n-                    chr.getClient().announce(MaplePacketCreator.getMiniRoomError(11));\n+                int status = estabilishMiniroomStatus(chr, true);\n+                if (status > 0) {\n+                    chr.getClient().announce(MaplePacketCreator.getMiniRoomError(status));\n                     return;\n                 }\n                 \n@@ -143,13 +153,14 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n                 MapleMiniGame game = new MapleMiniGame(chr, desc, pw);\n                 chr.setMiniGame(game);\n                 game.setPieceType(type);\n-                game.setGameType(\"omok\");\n+                game.setGameType(MiniGameType.OMOK);\n                 chr.getMap().addMapObject(game);\n                 chr.getMap().broadcastMessage(MaplePacketCreator.addOmokBox(chr, 1, 0));\n                 game.sendOmok(c, type);\n             } else if (createType == 2) { // matchcard\n-                if (chr.getChalkboard() != null || FieldLimit.CANNOTMINIGAME.check(chr.getMap().getFieldLimit())) {\n-                    chr.getClient().announce(MaplePacketCreator.getMiniRoomError(11));\n+                int status = estabilishMiniroomStatus(chr, true);\n+                if (status > 0) {\n+                    chr.getClient().announce(MaplePacketCreator.getMiniRoomError(status));\n                     return;\n                 }\n                 \n@@ -166,16 +177,23 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n                 } else if (type == 2) {\n                     game.setMatchesToWin(15);\n                 }\n-                game.setGameType(\"matchcard\");\n+                game.setGameType(MiniGameType.MATCH_CARD);\n                 chr.setMiniGame(game);\n                 chr.getMap().addMapObject(game);\n                 chr.getMap().broadcastMessage(MaplePacketCreator.addMatchCardBox(chr, 1, 0));\n                 game.sendMatchCard(c, type);\n             } else if (createType == 4 || createType == 5) { // shop\n-                if (!chr.getMap().getMapObjectsInRange(chr.getPosition(), 23000, Arrays.asList(MapleMapObjectType.SHOP, MapleMapObjectType.HIRED_MERCHANT)).isEmpty()) {\n-                    chr.getClient().announce(MaplePacketCreator.getMiniRoomError(14));\n+                if(!GameConstants.isFreeMarketRoom(chr.getMapId())) {\n+                    chr.getClient().announce(MaplePacketCreator.getMiniRoomError(15));\n                     return;\n                 }\n+                \n+                int status = estabilishMiniroomStatus(chr, false);\n+                if (status > 0) {\n+                    chr.getClient().announce(MaplePacketCreator.getMiniRoomError(status));\n+                    return;\n+                }\n+                \n                 String desc = slea.readMapleAsciiString();\n                 slea.skip(3);\n                 int itemId = slea.readInt();\n@@ -184,7 +202,7 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n                     return;\n                 }\n \n-                if (GameConstants.isFreeMarketRoom(chr.getMapId()) || itemId > 5030000 && itemId < 5030012 || itemId > 5140000 && itemId < 5140006) {\n+                if (itemId > 5030000 && itemId < 5030012 || itemId > 5140000 && itemId < 5140006) {\n                     if (createType == 4) {\n                         MaplePlayerShop shop = new MaplePlayerShop(chr, desc);\n                         chr.setPlayerShop(shop);\n@@ -230,15 +248,15 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n                     String pw = slea.available() > 1 ? slea.readMapleAsciiString() : \"\";\n                     \n                     MapleMiniGame game = (MapleMiniGame) ob;\n-                    if(game.checkPassword(pw) || game.checkPassword(chr.getName())) {\n+                    if(game.checkPassword(pw)) {\n                         if (game.hasFreeSlot() && !game.isVisitor(chr)) {\n                             game.addVisitor(chr);\n                             chr.setMiniGame(game);\n                             switch (game.getGameType()) {\n-                                case \"omok\":\n+                                case OMOK:\n                                     game.sendOmok(c, game.getPieceType());\n                                     break;\n-                                case \"matchcard\":\n+                                case MATCH_CARD:\n                                     game.sendMatchCard(c, game.getPieceType());\n                                     break;\n                             }"}, {"sha": "73ba52fa2fd985fdf07869b62d4d73f4a3fff6dc", "filename": "src/net/server/channel/handlers/RangedAttackHandler.java", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/src/net/server/channel/handlers/RangedAttackHandler.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/src/net/server/channel/handlers/RangedAttackHandler.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/channel/handlers/RangedAttackHandler.java?ref=d50b7b69600ae6256c8b8b9b7ff4871dbf628d18", "patch": "@@ -30,6 +30,7 @@\n import client.MapleBuffStat;\n import client.MapleCharacter;\n import client.MapleClient;\n+import client.MapleJob;\n import client.Skill;\n import client.SkillFactory;\n import client.inventory.Item;\n@@ -77,6 +78,13 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n         if (attack.skill == Buccaneer.ENERGY_ORB || attack.skill == ThunderBreaker.SPARK || attack.skill == Shadower.TAUNT || attack.skill == NightLord.TAUNT) {\n             chr.getMap().broadcastMessage(chr, MaplePacketCreator.rangedAttack(chr, attack.skill, attack.skilllevel, attack.stance, attack.numAttackedAndDamage, 0, attack.allDamage, attack.speed, attack.direction, attack.display), false);\n             applyAttack(attack, chr, 1);\n+        } else if (attack.skill == ThunderBreaker.SHARK_WAVE && chr.getSkillLevel(ThunderBreaker.SHARK_WAVE) > 0) {\n+            chr.getMap().broadcastMessage(chr, MaplePacketCreator.rangedAttack(chr, attack.skill, attack.skilllevel, attack.stance, attack.numAttackedAndDamage, 0, attack.allDamage, attack.speed, attack.direction, attack.display), false);\n+            applyAttack(attack, chr, 1);\n+            \n+            for (int i = 0; i < attack.numAttacked; i++) {\n+                chr.handleEnergyChargeGain();\n+            }\n         } else if (attack.skill == Aran.COMBO_SMASH || attack.skill == Aran.COMBO_FENRIR || attack.skill == Aran.COMBO_TEMPEST) {\n             chr.getMap().broadcastMessage(chr, MaplePacketCreator.rangedAttack(chr, attack.skill, attack.skilllevel, attack.stance, attack.numAttackedAndDamage, 0, attack.allDamage, attack.speed, attack.direction, attack.display), false);\n             if (attack.skill == Aran.COMBO_SMASH && chr.getCombo() >= 30) {"}, {"sha": "f82e506ec29c3e9c34bc5a7a21bb3b1a75b64408", "filename": "src/server/MapleStatEffect.java", "status": "modified", "additions": 13, "deletions": 8, "changes": 21, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/src/server/MapleStatEffect.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/src/server/MapleStatEffect.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/MapleStatEffect.java?ref=d50b7b69600ae6256c8b8b9b7ff4871dbf628d18", "patch": "@@ -376,9 +376,6 @@ private static MapleStatEffect loadFromData(MapleData source, int sourceid, bool\n                 case DragonKnight.DRAGON_BLOOD:\n                     statups.add(new Pair<>(MapleBuffStat.DRAGONBLOOD, Integer.valueOf(ret.x)));\n                     break;\n-                case DragonKnight.DRAGON_ROAR:\n-                    ret.hpR = -x / 100.0;\n-                    break;\n                 case Hero.STANCE:\n                 case Paladin.STANCE:\n                 case DarkKnight.STANCE:\n@@ -571,7 +568,7 @@ private static MapleStatEffect loadFromData(MapleData source, int sourceid, bool\n                 case Crusader.ARMOR_CRASH:\n                 case DragonKnight.POWER_CRASH:\n                 case WhiteKnight.MAGIC_CRASH:\n-                    monsterStatus.put(MonsterStatus.SEAL_SKILL,  Integer.valueOf(1));\n+                    monsterStatus.put(MonsterStatus.SEAL_SKILL, Integer.valueOf(1));\n                     break;\n                 case Rogue.DISORDER:\n                     monsterStatus.put(MonsterStatus.WATK, Integer.valueOf(ret.x));\n@@ -588,6 +585,10 @@ private static MapleStatEffect loadFromData(MapleData source, int sourceid, bool\n                     monsterStatus.put(MonsterStatus.WATK, Integer.valueOf(ret.x));\n                     monsterStatus.put(MonsterStatus.WDEF, Integer.valueOf(ret.y));\n                     break;\n+                case DragonKnight.DRAGON_ROAR:\n+                    ret.hpR = -x / 100.0;\n+                    monsterStatus.put(MonsterStatus.STUN, Integer.valueOf(1));\n+                    break;\n                 case Crusader.AXE_COMA:\n                 case Crusader.SWORD_COMA:\n                 case Crusader.SHOUT:\n@@ -1007,7 +1008,7 @@ public void silentApplyBuff(MapleCharacter chr, long localStartTime) {\n \n     public final void applyComboBuff(final MapleCharacter applyto, int combo) {\n         final List<Pair<MapleBuffStat, Integer>> stat = Collections.singletonList(new Pair<>(MapleBuffStat.ARAN_COMBO, combo));\n-        applyto.getClient().announce(MaplePacketCreator.giveBuff(sourceid, 99999, stat));\n+        applyto.announce(MaplePacketCreator.giveBuff(sourceid, 99999, stat));\n \n         final long starttime = System.currentTimeMillis();\n //\tfinal CancelEffectAction cancelAction = new CancelEffectAction(applyto, this, starttime);\n@@ -1021,8 +1022,7 @@ public void updateBuffEffect(MapleCharacter target, List<Pair<MapleBuffStat, Int\n         \n         long leftDuration = (starttime + localDuration) - System.currentTimeMillis();\n         if(leftDuration > 0) {\n-            byte[] buff = MaplePacketCreator.giveBuff((skill ? sourceid : -sourceid), (int)leftDuration, activeStats);\n-            target.getClient().announce(buff);\n+            target.announce(MaplePacketCreator.giveBuff((skill ? sourceid : -sourceid), (int)leftDuration, activeStats));\n         }\n     }\n \n@@ -1080,7 +1080,12 @@ private void applyBuffEffect(MapleCharacter applyfrom, MapleCharacter applyto, b\n             localsourceid = ridingMountId;\n             localstatups = Collections.singletonList(new Pair<>(MapleBuffStat.MONSTER_RIDING, 0));\n         } else if (isSkillMorph()) {\n-            localstatups = Collections.singletonList(new Pair<>(MapleBuffStat.MORPH, getMorph(applyto)));\n+            for(int i = 0; i < localstatups.size(); i++) {\n+                if(localstatups.get(i).getLeft().equals(MapleBuffStat.MORPH)) {\n+                    localstatups.set(i, new Pair<>(MapleBuffStat.MORPH, getMorph(applyto)));\n+                    break;\n+                }\n+            }\n         }\n         if (primary) {\n             localDuration = alchemistModifyVal(applyfrom, localDuration, false);"}, {"sha": "5f0108bb5c54ed8b5531e9625ebfa0f567e7ddfd", "filename": "src/server/life/MapleMonster.java", "status": "modified", "additions": 29, "deletions": 13, "changes": 42, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/src/server/life/MapleMonster.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/src/server/life/MapleMonster.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/life/MapleMonster.java?ref=d50b7b69600ae6256c8b8b9b7ff4871dbf628d18", "patch": "@@ -30,11 +30,14 @@\n import client.status.MonsterStatus;\n import client.status.MonsterStatusEffect;\n import constants.ServerConstants;\n+import constants.skills.Crusader;\n+import constants.skills.DragonKnight;\n import constants.skills.FPMage;\n import constants.skills.ILMage;\n import constants.skills.NightLord;\n import constants.skills.NightWalker;\n import constants.skills.Shadower;\n+import constants.skills.WhiteKnight;\n import java.awt.Point;\n import java.lang.ref.WeakReference;\n import java.util.ArrayList;\n@@ -990,22 +993,35 @@ public void run() {\n         effect.setCancelTask(timerManager.schedule(cancelTask, duration));\n     }\n \n+    private void debuffMobStat(MonsterStatus stat) {\n+        if (isBuffed(stat)) {\n+            final MonsterStatusEffect oldEffect = stati.get(stat);\n+            byte[] packet = MaplePacketCreator.cancelMonsterStatus(getObjectId(), oldEffect.getStati());\n+            map.broadcastMessage(packet, getPosition());\n+\n+            MapleCharacter controller = getController();\n+            if (controller != null && !controller.isMapObjectVisible(MapleMonster.this)) {\n+                controller.getClient().announce(packet);\n+            }\n+            stati.remove(stat);\n+        }\n+    }\n+    \n     public void debuffMob(int skillid) {\n-        //skillid is not going to be used for now until I get warrior debuff working\n-        MonsterStatus[] stats = {MonsterStatus.WEAPON_ATTACK_UP, MonsterStatus.WEAPON_DEFENSE_UP, MonsterStatus.MAGIC_ATTACK_UP, MonsterStatus.MAGIC_DEFENSE_UP};\n+        MonsterStatus[] stats = {MonsterStatus.WEAPON_ATTACK_UP, MonsterStatus.WEAPON_DEFENSE_UP, MonsterStatus.MAGIC_ATTACK_UP};\n         statiLock.lock();\n         try {\n-            for (int i = 0; i < stats.length; i++) {\n-                if (isBuffed(stats[i])) {\n-                    final MonsterStatusEffect oldEffect = stati.get(stats[i]);\n-                    byte[] packet = MaplePacketCreator.cancelMonsterStatus(getObjectId(), oldEffect.getStati());\n-                    map.broadcastMessage(packet, getPosition());\n-\n-                    MapleCharacter controller = getController();\n-                    if (controller != null && !controller.isMapObjectVisible(MapleMonster.this)) {\n-                        controller.getClient().announce(packet);\n-                    }\n-                    stati.remove(stats[i]);\n+            int i = (skillid == Crusader.ARMOR_CRASH ? 1 : (skillid == WhiteKnight.MAGIC_CRASH ? 2 : 0));\n+            debuffMobStat(stats[i]);\n+            \n+            if(ServerConstants.USE_ANTI_IMMUNITY_CRASH) {\n+                if (skillid == Crusader.ARMOR_CRASH) {\n+                    if(!isBuffed(MonsterStatus.WEAPON_REFLECT)) debuffMobStat(MonsterStatus.WEAPON_IMMUNITY);\n+                    if(!isBuffed(MonsterStatus.MAGIC_REFLECT)) debuffMobStat(MonsterStatus.MAGIC_IMMUNITY);\n+                } else if (skillid == WhiteKnight.MAGIC_CRASH) {\n+                    if(!isBuffed(MonsterStatus.MAGIC_REFLECT)) debuffMobStat(MonsterStatus.MAGIC_IMMUNITY);\n+                } else {\n+                    if(!isBuffed(MonsterStatus.WEAPON_REFLECT)) debuffMobStat(MonsterStatus.WEAPON_IMMUNITY);\n                 }\n             }\n         } finally {"}, {"sha": "507cac4a5686343afab9ac866afb7d38e10e06a1", "filename": "src/server/maps/MapleMiniGame.java", "status": "modified", "additions": 35, "deletions": 17, "changes": 52, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/src/server/maps/MapleMiniGame.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/src/server/maps/MapleMiniGame.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/maps/MapleMiniGame.java?ref=d50b7b69600ae6256c8b8b9b7ff4871dbf628d18", "patch": "@@ -31,12 +31,13 @@\n /**\n  *\n  * @author Matze\n+ * @author Ronan (refactored String GameType to enum MiniGameType)\n  */\n public class MapleMiniGame extends AbstractMapleMapObject {\n     private MapleCharacter owner;\n     private MapleCharacter visitor;\n     private String password;\n-    private String GameType = null;\n+    private MiniGameType GameType = MiniGameType.UNDEFINED;\n     private int[] piece = new int[250];\n     private List<Integer> list4x3 = new ArrayList<>();\n     private List<Integer> list5x4 = new ArrayList<>();\n@@ -49,6 +50,23 @@\n     private int ownerpoints = 0;\n     private int matchestowin = 0;\n \n+    public static enum MiniGameType {\n+        UNDEFINED(0), OMOK(1), MATCH_CARD(2);\n+        private int value = 0;\n+\n+        private MiniGameType(int value) {\n+            this.value = value;\n+        }\n+        \n+        public int getValue() {\n+            return value;\n+        }\n+    }\n+    \n+    public static enum MiniGameResult {\n+        WIN, LOSS, TIE;\n+    }\n+    \n     public MapleMiniGame(MapleCharacter owner, String description, String password) {\n         this.owner = owner;\n         this.description = description;\n@@ -70,27 +88,26 @@ public boolean hasFreeSlot() {\n     public boolean isOwner(MapleCharacter c) {\n         return owner.equals(c);\n     }\n-\n+    \n     public void addVisitor(MapleCharacter challenger) {\n         visitor = challenger;\n-        if (GameType.equals(\"omok\")) {\n-            this.getOwner().getClient().announce(MaplePacketCreator.getMiniGameNewVisitor(challenger, 1));\n-            this.getOwner().getMap().broadcastMessage(MaplePacketCreator.addOmokBox(owner, 2, 0));\n-        }\n-        if (GameType.equals(\"matchcard\")) {\n-            this.getOwner().getClient().announce(MaplePacketCreator.getMatchCardNewVisitor(challenger, 1));\n-            this.getOwner().getMap().broadcastMessage(MaplePacketCreator.addMatchCardBox(owner, 2, 0));\n+        MapleCharacter owner = this.getOwner();\n+        if (GameType == MiniGameType.OMOK) {\n+            owner.announce(MaplePacketCreator.getMiniGameNewVisitor(challenger, 1));\n+            owner.getMap().broadcastMessage(MaplePacketCreator.addOmokBox(owner, 2, 0));\n+        } else if (GameType == MiniGameType.MATCH_CARD) {\n+            owner.announce(MaplePacketCreator.getMatchCardNewVisitor(challenger, 1));\n+            owner.getMap().broadcastMessage(MaplePacketCreator.addMatchCardBox(owner, 2, 0));\n         }\n     }\n \n     public void removeVisitor(MapleCharacter challenger) {\n         if (visitor == challenger) {\n             visitor = null;\n             this.getOwner().getClient().announce(MaplePacketCreator.getMiniGameRemoveVisitor());\n-            if (GameType.equals(\"omok\")) {\n+            if (GameType == MiniGameType.OMOK) {\n                 this.getOwner().getMap().broadcastMessage(MaplePacketCreator.addOmokBox(owner, 1, 0));\n-            }\n-            if (GameType.equals(\"matchcard\")) {\n+            } else if (GameType == MiniGameType.MATCH_CARD) {\n                 this.getOwner().getMap().broadcastMessage(MaplePacketCreator.addMatchCardBox(owner, 1, 0));\n             }\n         }\n@@ -156,9 +173,9 @@ public int getPieceType() {\n         return piecetype;\n     }\n \n-    public void setGameType(String game) {\n+    public void setGameType(MiniGameType game) {\n         GameType = game;\n-        if (game.equals(\"matchcard\")) {\n+        if (GameType == MiniGameType.MATCH_CARD) {\n             if (matchestowin == 6) {\n                 for (int i = 0; i < 6; i++) {\n                     list4x3.add(i);\n@@ -178,7 +195,7 @@ public void setGameType(String game) {\n         }\n     }\n \n-    public String getGameType() {\n+    public MiniGameType getGameType() {\n         return GameType;\n     }\n \n@@ -217,8 +234,9 @@ public int getLoser() {\n     }\n \n     public void broadcast(final byte[] packet) {\n-        if (owner.getClient() != null && owner.getClient().getSession() != null) {\n-            owner.getClient().announce(packet);\n+        MapleClient c = owner.getClient();\n+        if (c != null && c.getSession() != null) {\n+            c.announce(packet);\n         }\n         broadcastToVisitor(packet);\n     }"}, {"sha": "7db90e26e85a7cd54013b6d58491c711e2e1536b", "filename": "src/tools/MaplePacketCreator.java", "status": "modified", "additions": 38, "deletions": 39, "changes": 77, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/src/tools/MaplePacketCreator.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/src/tools/MaplePacketCreator.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/tools/MaplePacketCreator.java?ref=d50b7b69600ae6256c8b8b9b7ff4871dbf628d18", "patch": "@@ -68,6 +68,7 @@\n import server.maps.MapleMapItem;\n import server.maps.MapleMist;\n import server.maps.MapleMiniGame;\n+import server.maps.MapleMiniGame.MiniGameResult;\n import server.maps.MaplePlayerShop;\n import server.maps.MaplePlayerShopItem;\n import server.maps.MapleReactor;\n@@ -672,7 +673,6 @@ private static void addMonsterBookInfo(final MaplePacketLittleEndianWriter mplew\n          * Gets a successful authentication packet.\n          *\n          * @param c\n-         * @param account The account name.\n          * @return the successful authentication packet\n          */\n         public static byte[] getAuthSuccess(MapleClient c) {\n@@ -683,9 +683,8 @@ private static void addMonsterBookInfo(final MaplePacketLittleEndianWriter mplew\n                 mplew.writeInt(c.getAccID());\n                 mplew.write(c.getGender());\n                 \n-                mplew.writeBool(c.getGMLevel() > 0);\n-                \n-                mplew.write((c.getGMLevel() > 0 && Server.getInstance().canFly(c.getAccID())) ? 0x80 : 0); // Admin Byte. 0x80,0x40,0x20.. Rubbish.\n+                mplew.writeBool(c.getGMLevel() > 1);    // thanks Steve(kaito1410) for pointing this out\n+                mplew.write((c.getGMLevel() > 1 && Server.getInstance().canFly(c.getAccID())) ? 0x80 : 0); // Admin Byte. 0x80,0x40,0x20.. Rubbish.\n                 mplew.write(0); // Country Code.\n                 \n                 mplew.writeMapleAsciiString(c.getAccountName());\n@@ -1967,9 +1966,9 @@ private static void encodeParentlessMobSpawnEffect(MaplePacketLittleEndianWriter\n                         MapleMiniGame miniGame = chr.getMiniGame();\n                         if (miniGame != null && miniGame.isOwner(chr)) {\n                                 if (miniGame.hasFreeSlot()) {\n-                                        spawnAnnounceBox(mplew, miniGame, 1, 0, 1, 0);\n+                                        spawnAnnounceBox(mplew, miniGame, 0, 1, 0);\n                                 } else {\n-                                        spawnAnnounceBox(mplew, miniGame, 1, 0, 2, 1);\n+                                        spawnAnnounceBox(mplew, miniGame, 0, 2, 1);\n                                 }\n                         } else {\n                                 mplew.write(0);\n@@ -2141,8 +2140,8 @@ private static void addAnnounceBox(final MaplePacketLittleEndianWriter mplew, Ma\n                 mplew.write(0);\n         }\n \n-        private static void addAnnounceBox(final MaplePacketLittleEndianWriter mplew, MapleMiniGame game, int gametype, int type, int ammount, int joinable) {\n-                mplew.write(gametype);\n+        private static void addAnnounceBox(final MaplePacketLittleEndianWriter mplew, MapleMiniGame game, int type, int ammount, int joinable) {\n+                mplew.write(game.getGameType().getValue());\n                 mplew.writeInt(game.getObjectId()); // gameid/shopid\n                 mplew.writeMapleAsciiString(game.getDescription()); // desc\n                 mplew.writeMapleAsciiString(game.getPassword());\n@@ -2152,14 +2151,14 @@ private static void addAnnounceBox(final MaplePacketLittleEndianWriter mplew, Ma\n                 mplew.write(joinable);\n         }\n         \n-        private static void spawnAnnounceBox(final MaplePacketLittleEndianWriter mplew, MapleMiniGame game, int gametype, int type, int ammount, int joinable) {\n-                mplew.write(gametype);\n+        private static void spawnAnnounceBox(final MaplePacketLittleEndianWriter mplew, MapleMiniGame game, int type, int ammount, int joinable) {\n+                mplew.write(game.getGameType().getValue());\n                 mplew.writeInt(game.getObjectId()); // gameid/shopid\n                 mplew.writeMapleAsciiString(game.getDescription()); // desc\n-                mplew.write(0);\n+                mplew.writeBool(!game.getPassword().isEmpty());    // password here, thanks GabrielSin!\n                 mplew.write(type);\n                 mplew.write(ammount);\n-                mplew.write(2);\n+                mplew.write(2);         //player capacity\n                 mplew.write(joinable);\n         }\n         \n@@ -4937,17 +4936,17 @@ private static void addPetInfo(final MaplePacketLittleEndianWriter mplew, MapleP\n                 mplew.write(0xFF);\n                 mplew.write(0);\n                 mplew.writeInt(1);\n-                mplew.writeInt(minigame.getOwner().getMiniGamePoints(\"wins\", true));\n-                mplew.writeInt(minigame.getOwner().getMiniGamePoints(\"ties\", true));\n-                mplew.writeInt(minigame.getOwner().getMiniGamePoints(\"losses\", true));\n+                mplew.writeInt(minigame.getOwner().getMiniGamePoints(MiniGameResult.WIN, true));\n+                mplew.writeInt(minigame.getOwner().getMiniGamePoints(MiniGameResult.TIE, true));\n+                mplew.writeInt(minigame.getOwner().getMiniGamePoints(MiniGameResult.LOSS, true));\n                 mplew.writeInt(2000);\n                 if (minigame.getVisitor() != null) {\n                         MapleCharacter visitor = minigame.getVisitor();\n                         mplew.write(1);\n                         mplew.writeInt(1);\n-                        mplew.writeInt(visitor.getMiniGamePoints(\"wins\", true));\n-                        mplew.writeInt(visitor.getMiniGamePoints(\"ties\", true));\n-                        mplew.writeInt(visitor.getMiniGamePoints(\"losses\", true));\n+                        mplew.writeInt(visitor.getMiniGamePoints(MiniGameResult.WIN, true));\n+                        mplew.writeInt(visitor.getMiniGamePoints(MiniGameResult.TIE, true));\n+                        mplew.writeInt(visitor.getMiniGamePoints(MiniGameResult.LOSS, true));\n                         mplew.writeInt(2000);\n                 }\n                 mplew.write(0xFF);\n@@ -5047,9 +5046,9 @@ private static void addPetInfo(final MaplePacketLittleEndianWriter mplew, MapleP\n                 addCharLook(mplew, c, false);\n                 mplew.writeMapleAsciiString(c.getName());\n                 mplew.writeInt(1);\n-                mplew.writeInt(c.getMiniGamePoints(\"wins\", true));\n-                mplew.writeInt(c.getMiniGamePoints(\"ties\", true));\n-                mplew.writeInt(c.getMiniGamePoints(\"losses\", true));\n+                mplew.writeInt(c.getMiniGamePoints(MiniGameResult.WIN, true));\n+                mplew.writeInt(c.getMiniGamePoints(MiniGameResult.TIE, true));\n+                mplew.writeInt(c.getMiniGamePoints(MiniGameResult.LOSS, true));\n                 mplew.writeInt(2000);\n                 return mplew.getPacket();\n         }\n@@ -5075,14 +5074,14 @@ private static void addPetInfo(final MaplePacketLittleEndianWriter mplew, MapleP\n                 }\n                 mplew.write(0); // owner\n                 mplew.writeInt(1); // unknown\n-                mplew.writeInt(game.getOwner().getMiniGamePoints(\"wins\", omok) + win); // wins\n-                mplew.writeInt(game.getOwner().getMiniGamePoints(\"ties\", omok) + tie); // ties\n-                mplew.writeInt(game.getOwner().getMiniGamePoints(\"losses\", omok) + lose); // losses\n+                mplew.writeInt(game.getOwner().getMiniGamePoints(MiniGameResult.WIN, omok) + win); // wins\n+                mplew.writeInt(game.getOwner().getMiniGamePoints(MiniGameResult.TIE, omok) + tie); // ties\n+                mplew.writeInt(game.getOwner().getMiniGamePoints(MiniGameResult.LOSS, omok) + lose); // losses\n                 mplew.writeInt(2000); // points\n                 mplew.writeInt(1); // start of visitor; unknown\n-                mplew.writeInt(game.getVisitor().getMiniGamePoints(\"wins\", omok) + lose); // wins\n-                mplew.writeInt(game.getVisitor().getMiniGamePoints(\"ties\", omok) + tie); // ties\n-                mplew.writeInt(game.getVisitor().getMiniGamePoints(\"losses\", omok) + win); // losses\n+                mplew.writeInt(game.getVisitor().getMiniGamePoints(MiniGameResult.WIN, omok) + lose); // wins\n+                mplew.writeInt(game.getVisitor().getMiniGamePoints(MiniGameResult.TIE, omok) + tie); // ties\n+                mplew.writeInt(game.getVisitor().getMiniGamePoints(MiniGameResult.LOSS, omok) + win); // losses\n                 mplew.writeInt(2000); // points\n                 game.getOwner().setMiniGamePoints(game.getVisitor(), result, omok);\n                 return mplew.getPacket();\n@@ -5136,17 +5135,17 @@ private static void addPetInfo(final MaplePacketLittleEndianWriter mplew, MapleP\n                 mplew.write(0xFF);\n                 mplew.write(0);\n                 mplew.writeInt(2);\n-                mplew.writeInt(minigame.getOwner().getMiniGamePoints(\"wins\", false));\n-                mplew.writeInt(minigame.getOwner().getMiniGamePoints(\"ties\", false));\n-                mplew.writeInt(minigame.getOwner().getMiniGamePoints(\"losses\", false));\n+                mplew.writeInt(minigame.getOwner().getMiniGamePoints(MiniGameResult.WIN, false));\n+                mplew.writeInt(minigame.getOwner().getMiniGamePoints(MiniGameResult.TIE, false));\n+                mplew.writeInt(minigame.getOwner().getMiniGamePoints(MiniGameResult.LOSS, false));\n                 mplew.writeInt(2000);\n                 if (minigame.getVisitor() != null) {\n                         MapleCharacter visitor = minigame.getVisitor();\n                         mplew.write(1);\n                         mplew.writeInt(2);\n-                        mplew.writeInt(visitor.getMiniGamePoints(\"wins\", false));\n-                        mplew.writeInt(visitor.getMiniGamePoints(\"ties\", false));\n-                        mplew.writeInt(visitor.getMiniGamePoints(\"losses\", false));\n+                        mplew.writeInt(visitor.getMiniGamePoints(MiniGameResult.WIN, false));\n+                        mplew.writeInt(visitor.getMiniGamePoints(MiniGameResult.TIE, false));\n+                        mplew.writeInt(visitor.getMiniGamePoints(MiniGameResult.LOSS, false));\n                         mplew.writeInt(2000);\n                 }\n                 mplew.write(0xFF);\n@@ -5182,9 +5181,9 @@ private static void addPetInfo(final MaplePacketLittleEndianWriter mplew, MapleP\n                 addCharLook(mplew, c, false);\n                 mplew.writeMapleAsciiString(c.getName());\n                 mplew.writeInt(1);\n-                mplew.writeInt(c.getMiniGamePoints(\"wins\", false));\n-                mplew.writeInt(c.getMiniGamePoints(\"ties\", false));\n-                mplew.writeInt(c.getMiniGamePoints(\"losses\", false));\n+                mplew.writeInt(c.getMiniGamePoints(MiniGameResult.WIN, false));\n+                mplew.writeInt(c.getMiniGamePoints(MiniGameResult.TIE, false));\n+                mplew.writeInt(c.getMiniGamePoints(MiniGameResult.LOSS, false));\n                 mplew.writeInt(2000);\n                 return mplew.getPacket();\n         }\n@@ -5267,7 +5266,7 @@ private static void addPetInfo(final MaplePacketLittleEndianWriter mplew, MapleP\n                 final MaplePacketLittleEndianWriter mplew = new MaplePacketLittleEndianWriter();\n                 mplew.writeShort(SendOpcode.UPDATE_CHAR_BOX.getValue());\n                 mplew.writeInt(c.getId());\n-                addAnnounceBox(mplew, c.getMiniGame(), 1, 0, ammount, type);\n+                addAnnounceBox(mplew, c.getMiniGame(), 0, ammount, type);\n                 return mplew.getPacket();\n         }\n \n@@ -5283,11 +5282,11 @@ private static void addPetInfo(final MaplePacketLittleEndianWriter mplew, MapleP\n                 final MaplePacketLittleEndianWriter mplew = new MaplePacketLittleEndianWriter();\n                 mplew.writeShort(SendOpcode.UPDATE_CHAR_BOX.getValue());\n                 mplew.writeInt(c.getId());\n-                addAnnounceBox(mplew, c.getMiniGame(), 2, 0, ammount, type);\n+                addAnnounceBox(mplew, c.getMiniGame(), 0, ammount, type);\n                 return mplew.getPacket();\n         }\n \n-        public static byte[] removeMatchcardBox(MapleCharacter c) {\n+        public static byte[] removeMatchCardBox(MapleCharacter c) {\n                 final MaplePacketLittleEndianWriter mplew = new MaplePacketLittleEndianWriter();\n                 mplew.writeShort(SendOpcode.UPDATE_CHAR_BOX.getValue());\n                 mplew.writeInt(c.getId());"}, {"sha": "91779e4d57434927717580da9404f47d7010fcaa", "filename": "src/tools/data/output/GenericLittleEndianWriter.java", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/src/tools/data/output/GenericLittleEndianWriter.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/src/tools/data/output/GenericLittleEndianWriter.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/tools/data/output/GenericLittleEndianWriter.java?ref=d50b7b69600ae6256c8b8b9b7ff4871dbf628d18", "patch": "@@ -23,6 +23,7 @@\n \n import java.awt.Point;\n import java.nio.charset.Charset;\n+import constants.CharsetConstants.MapleLanguageType;\n \n /**\n  * Provides a generic writer of a little-endian sequence of bytes.\n@@ -32,7 +33,7 @@\n  * @since Revision 323\n  */\n public class GenericLittleEndianWriter implements LittleEndianWriter {\n-    private static Charset ASCII = Charset.forName(\"US-ASCII\");\n+    private static Charset ASCII = Charset.forName(MapleLanguageType.LANGUAGE_US.getAscii());\n     private ByteOutputStream bos;\n \n     /**"}, {"sha": "000d0fbdfc6bb89db36b323f3cc423a097570b28", "filename": "wz/Item.wz/Consume/0202.img.xml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/wz/Item.wz/Consume/0202.img.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/wz/Item.wz/Consume/0202.img.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/wz/Item.wz/Consume/0202.img.xml?ref=d50b7b69600ae6256c8b8b9b7ff4871dbf628d18", "patch": "@@ -2125,7 +2125,7 @@\n       <int name=\"mp\" value=\"100\"/>\n       <int name=\"hp\" value=\"100\"/>\n       <int name=\"pad\" value=\"120\"/>\n-      <int name=\"pdd\" value=\"100\"/>\n+      <int name=\"pdd\" value=\"120\"/>\n       <int name=\"acc\" value=\"30\"/>\n       <int name=\"eva\" value=\"30\"/>\n       <int name=\"speed\" value=\"10\"/>"}, {"sha": "e55bf5efa22ce84ad1f044161bec483a62def577", "filename": "wz/Skill.wz/131.img.xml", "status": "modified", "additions": 30, "deletions": 0, "changes": 30, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/wz/Skill.wz/131.img.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/wz/Skill.wz/131.img.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/wz/Skill.wz/131.img.xml?ref=d50b7b69600ae6256c8b8b9b7ff4871dbf628d18", "patch": "@@ -1702,6 +1702,7 @@\n           <vector name=\"lt\" x=\"-110\" y=\"-132\"/>\n           <vector name=\"rb\" x=\"110\" y=\"33\"/>\n           <int name=\"mobCount\" value=\"15\"/>\n+          <int name=\"time\" value=\"4\"/>\n         </imgdir>\n         <imgdir name=\"2\">\n           <string name=\"hs\" value=\"h2\"/>\n@@ -1712,6 +1713,7 @@\n           <vector name=\"lt\" x=\"-120\" y=\"-140\"/>\n           <vector name=\"rb\" x=\"120\" y=\"40\"/>\n           <int name=\"mobCount\" value=\"15\"/>\n+          <int name=\"time\" value=\"4\"/>\n         </imgdir>\n         <imgdir name=\"3\">\n           <string name=\"hs\" value=\"h3\"/>\n@@ -1722,6 +1724,7 @@\n           <vector name=\"lt\" x=\"-130\" y=\"-147\"/>\n           <vector name=\"rb\" x=\"130\" y=\"48\"/>\n           <int name=\"mobCount\" value=\"15\"/>\n+          <int name=\"time\" value=\"4\"/>\n         </imgdir>\n         <imgdir name=\"4\">\n           <string name=\"hs\" value=\"h4\"/>\n@@ -1732,6 +1735,7 @@\n           <vector name=\"lt\" x=\"-140\" y=\"-155\"/>\n           <vector name=\"rb\" x=\"140\" y=\"55\"/>\n           <int name=\"mobCount\" value=\"15\"/>\n+          <int name=\"time\" value=\"4\"/>\n         </imgdir>\n         <imgdir name=\"5\">\n           <string name=\"hs\" value=\"h5\"/>\n@@ -1742,6 +1746,7 @@\n           <vector name=\"lt\" x=\"-150\" y=\"-162\"/>\n           <vector name=\"rb\" x=\"150\" y=\"63\"/>\n           <int name=\"mobCount\" value=\"15\"/>\n+          <int name=\"time\" value=\"4\"/>\n         </imgdir>\n         <imgdir name=\"6\">\n           <string name=\"hs\" value=\"h6\"/>\n@@ -1752,6 +1757,7 @@\n           <vector name=\"lt\" x=\"-160\" y=\"-170\"/>\n           <vector name=\"rb\" x=\"160\" y=\"70\"/>\n           <int name=\"mobCount\" value=\"15\"/>\n+          <int name=\"time\" value=\"4\"/>\n         </imgdir>\n         <imgdir name=\"7\">\n           <string name=\"hs\" value=\"h7\"/>\n@@ -1762,6 +1768,7 @@\n           <vector name=\"lt\" x=\"-170\" y=\"-177\"/>\n           <vector name=\"rb\" x=\"170\" y=\"78\"/>\n           <int name=\"mobCount\" value=\"15\"/>\n+          <int name=\"time\" value=\"4\"/>\n         </imgdir>\n         <imgdir name=\"8\">\n           <string name=\"hs\" value=\"h8\"/>\n@@ -1772,6 +1779,7 @@\n           <vector name=\"lt\" x=\"-180\" y=\"-185\"/>\n           <vector name=\"rb\" x=\"180\" y=\"85\"/>\n           <int name=\"mobCount\" value=\"15\"/>\n+          <int name=\"time\" value=\"4\"/>\n         </imgdir>\n         <imgdir name=\"9\">\n           <string name=\"hs\" value=\"h9\"/>\n@@ -1782,6 +1790,7 @@\n           <vector name=\"lt\" x=\"-190\" y=\"-192\"/>\n           <vector name=\"rb\" x=\"190\" y=\"93\"/>\n           <int name=\"mobCount\" value=\"15\"/>\n+          <int name=\"time\" value=\"4\"/>\n         </imgdir>\n         <imgdir name=\"10\">\n           <string name=\"hs\" value=\"h10\"/>\n@@ -1792,6 +1801,7 @@\n           <vector name=\"lt\" x=\"-200\" y=\"-200\"/>\n           <vector name=\"rb\" x=\"200\" y=\"100\"/>\n           <int name=\"mobCount\" value=\"15\"/>\n+          <int name=\"time\" value=\"4\"/>\n         </imgdir>\n         <imgdir name=\"11\">\n           <string name=\"hs\" value=\"h11\"/>\n@@ -1802,6 +1812,7 @@\n           <vector name=\"lt\" x=\"-210\" y=\"-207\"/>\n           <vector name=\"rb\" x=\"210\" y=\"108\"/>\n           <int name=\"mobCount\" value=\"15\"/>\n+          <int name=\"time\" value=\"3\"/>\n         </imgdir>\n         <imgdir name=\"12\">\n           <string name=\"hs\" value=\"h12\"/>\n@@ -1812,6 +1823,7 @@\n           <vector name=\"lt\" x=\"-220\" y=\"-215\"/>\n           <vector name=\"rb\" x=\"220\" y=\"115\"/>\n           <int name=\"mobCount\" value=\"15\"/>\n+          <int name=\"time\" value=\"3\"/>\n         </imgdir>\n         <imgdir name=\"13\">\n           <string name=\"hs\" value=\"h13\"/>\n@@ -1822,6 +1834,7 @@\n           <vector name=\"lt\" x=\"-230\" y=\"-222\"/>\n           <vector name=\"rb\" x=\"230\" y=\"123\"/>\n           <int name=\"mobCount\" value=\"15\"/>\n+          <int name=\"time\" value=\"3\"/>\n         </imgdir>\n         <imgdir name=\"14\">\n           <string name=\"hs\" value=\"h14\"/>\n@@ -1832,6 +1845,7 @@\n           <vector name=\"lt\" x=\"-240\" y=\"-230\"/>\n           <vector name=\"rb\" x=\"240\" y=\"130\"/>\n           <int name=\"mobCount\" value=\"15\"/>\n+          <int name=\"time\" value=\"3\"/>\n         </imgdir>\n         <imgdir name=\"15\">\n           <string name=\"hs\" value=\"h15\"/>\n@@ -1842,6 +1856,7 @@\n           <vector name=\"lt\" x=\"-250\" y=\"-237\"/>\n           <vector name=\"rb\" x=\"250\" y=\"138\"/>\n           <int name=\"mobCount\" value=\"15\"/>\n+          <int name=\"time\" value=\"3\"/>\n         </imgdir>\n         <imgdir name=\"16\">\n           <string name=\"hs\" value=\"h16\"/>\n@@ -1852,6 +1867,7 @@\n           <vector name=\"lt\" x=\"-260\" y=\"-245\"/>\n           <vector name=\"rb\" x=\"260\" y=\"145\"/>\n           <int name=\"mobCount\" value=\"15\"/>\n+          <int name=\"time\" value=\"3\"/>\n         </imgdir>\n         <imgdir name=\"17\">\n           <string name=\"hs\" value=\"h17\"/>\n@@ -1862,6 +1878,7 @@\n           <vector name=\"lt\" x=\"-270\" y=\"-252\"/>\n           <vector name=\"rb\" x=\"270\" y=\"153\"/>\n           <int name=\"mobCount\" value=\"15\"/>\n+          <int name=\"time\" value=\"3\"/>\n         </imgdir>\n         <imgdir name=\"18\">\n           <string name=\"hs\" value=\"h18\"/>\n@@ -1872,6 +1889,7 @@\n           <vector name=\"lt\" x=\"-280\" y=\"-260\"/>\n           <vector name=\"rb\" x=\"280\" y=\"160\"/>\n           <int name=\"mobCount\" value=\"15\"/>\n+          <int name=\"time\" value=\"3\"/>\n         </imgdir>\n         <imgdir name=\"19\">\n           <string name=\"hs\" value=\"h19\"/>\n@@ -1882,6 +1900,7 @@\n           <vector name=\"lt\" x=\"-290\" y=\"-267\"/>\n           <vector name=\"rb\" x=\"290\" y=\"168\"/>\n           <int name=\"mobCount\" value=\"15\"/>\n+          <int name=\"time\" value=\"3\"/>\n         </imgdir>\n         <imgdir name=\"20\">\n           <string name=\"hs\" value=\"h20\"/>\n@@ -1892,6 +1911,7 @@\n           <vector name=\"lt\" x=\"-300\" y=\"-275\"/>\n           <vector name=\"rb\" x=\"300\" y=\"175\"/>\n           <int name=\"mobCount\" value=\"15\"/>\n+          <int name=\"time\" value=\"3\"/>\n         </imgdir>\n         <imgdir name=\"21\">\n           <string name=\"hs\" value=\"h21\"/>\n@@ -1902,6 +1922,7 @@\n           <vector name=\"lt\" x=\"-310\" y=\"-282\"/>\n           <vector name=\"rb\" x=\"310\" y=\"183\"/>\n           <int name=\"mobCount\" value=\"15\"/>\n+          <int name=\"time\" value=\"2\"/>\n         </imgdir>\n         <imgdir name=\"22\">\n           <string name=\"hs\" value=\"h22\"/>\n@@ -1912,6 +1933,7 @@\n           <vector name=\"lt\" x=\"-320\" y=\"-290\"/>\n           <vector name=\"rb\" x=\"320\" y=\"190\"/>\n           <int name=\"mobCount\" value=\"15\"/>\n+          <int name=\"time\" value=\"2\"/>\n         </imgdir>\n         <imgdir name=\"23\">\n           <string name=\"hs\" value=\"h23\"/>\n@@ -1922,6 +1944,7 @@\n           <vector name=\"lt\" x=\"-330\" y=\"-297\"/>\n           <vector name=\"rb\" x=\"330\" y=\"198\"/>\n           <int name=\"mobCount\" value=\"15\"/>\n+          <int name=\"time\" value=\"2\"/>\n         </imgdir>\n         <imgdir name=\"24\">\n           <string name=\"hs\" value=\"h24\"/>\n@@ -1932,6 +1955,7 @@\n           <vector name=\"lt\" x=\"-340\" y=\"-305\"/>\n           <vector name=\"rb\" x=\"340\" y=\"205\"/>\n           <int name=\"mobCount\" value=\"15\"/>\n+          <int name=\"time\" value=\"2\"/>\n         </imgdir>\n         <imgdir name=\"25\">\n           <string name=\"hs\" value=\"h25\"/>\n@@ -1942,6 +1966,7 @@\n           <vector name=\"lt\" x=\"-350\" y=\"-312\"/>\n           <vector name=\"rb\" x=\"350\" y=\"213\"/>\n           <int name=\"mobCount\" value=\"15\"/>\n+          <int name=\"time\" value=\"2\"/>\n         </imgdir>\n         <imgdir name=\"26\">\n           <string name=\"hs\" value=\"h26\"/>\n@@ -1952,6 +1977,7 @@\n           <vector name=\"lt\" x=\"-360\" y=\"-320\"/>\n           <vector name=\"rb\" x=\"360\" y=\"220\"/>\n           <int name=\"mobCount\" value=\"15\"/>\n+          <int name=\"time\" value=\"2\"/>\n         </imgdir>\n         <imgdir name=\"27\">\n           <string name=\"hs\" value=\"h27\"/>\n@@ -1962,6 +1988,7 @@\n           <vector name=\"lt\" x=\"-370\" y=\"-327\"/>\n           <vector name=\"rb\" x=\"370\" y=\"228\"/>\n           <int name=\"mobCount\" value=\"15\"/>\n+          <int name=\"time\" value=\"2\"/>\n         </imgdir>\n         <imgdir name=\"28\">\n           <string name=\"hs\" value=\"h28\"/>\n@@ -1972,6 +1999,7 @@\n           <vector name=\"lt\" x=\"-380\" y=\"-335\"/>\n           <vector name=\"rb\" x=\"380\" y=\"235\"/>\n           <int name=\"mobCount\" value=\"15\"/>\n+          <int name=\"time\" value=\"2\"/>\n         </imgdir>\n         <imgdir name=\"29\">\n           <string name=\"hs\" value=\"h29\"/>\n@@ -1982,6 +2010,7 @@\n           <vector name=\"lt\" x=\"-390\" y=\"-342\"/>\n           <vector name=\"rb\" x=\"390\" y=\"243\"/>\n           <int name=\"mobCount\" value=\"15\"/>\n+          <int name=\"time\" value=\"2\"/>\n         </imgdir>\n         <imgdir name=\"30\">\n           <string name=\"hs\" value=\"h30\"/>\n@@ -1992,6 +2021,7 @@\n           <vector name=\"lt\" x=\"-400\" y=\"-350\"/>\n           <vector name=\"rb\" x=\"400\" y=\"250\"/>\n           <int name=\"mobCount\" value=\"15\"/>\n+          <int name=\"time\" value=\"2\"/>\n         </imgdir>\n       </imgdir>\n       <imgdir name=\"effect\">"}, {"sha": "f7b13e95262d9db600a88e9f7bcda4211b769f97", "filename": "wz/String.wz/Skill.img.xml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/wz/String.wz/Skill.img.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/d50b7b69600ae6256c8b8b9b7ff4871dbf628d18/wz/String.wz/Skill.img.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/wz/String.wz/Skill.img.xml?ref=d50b7b69600ae6256c8b8b9b7ff4871dbf628d18", "patch": "@@ -3215,7 +3215,7 @@\n     <string name=\"h7\" value=\"Use 16 MP, 53% HP, Damage 132%, Attack Range 170%, Stun for 4 Seconds\"/>\n     <string name=\"h8\" value=\"Use 16 MP, 52% HP, Damage 138%, Attack Range 180%, Stun for 4 Seconds\"/>\n     <string name=\"h9\" value=\"Use 16 MP, 51% HP, Damage 144%, Attack Range 190%, Stun for 4 Seconds\"/>\n-    <string name=\"h10\" value=\"Use 24 MP, 50% HP, Damage 150%, Attack Range 200%, Stun for 3 Seconds\"/>\n+    <string name=\"h10\" value=\"Use 24 MP, 50% HP, Damage 150%, Attack Range 200%, Stun for 4 Seconds\"/>\n     <string name=\"h11\" value=\"Use 24 MP, 49% HP, Damage 155%, Attack Range 210%, Stun for 3 Seconds\"/>\n     <string name=\"h12\" value=\"Use 24 MP, 48% HP, Damage 160%, Attack Range 220%, Stun for 3 Seconds\"/>\n     <string name=\"h13\" value=\"Use 24 MP, 47% HP, Damage 165%, Attack Range 230%, Stun for 3 Seconds\"/>"}]}]},
