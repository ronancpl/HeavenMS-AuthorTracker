{"fetchDate": "2019-12-19", "content": [{"sha": "ee40626c7df5dd90d6286c1dfe3bc2f3b0e15f68", "node_id": "MDY6Q29tbWl0NDUwODIwMjM6ZWU0MDYyNmM3ZGY1ZGQ5MGQ2Mjg2YzFkZmUzYmMyZjNiMGUxNWY2OA==", "commit": {"author": {"name": "MedicOP", "email": "MedicOP@users.noreply.github.com", "date": "2019-01-02T21:22:00Z"}, "committer": {"name": "Ronan Lana", "email": "rcpl2010@gmail.com", "date": "2019-01-02T21:22:00Z"}, "message": "Server flag to log autobans (#296)", "tree": {"sha": "2c0279d65893a159b32e13de993e8a1a8f5d6958", "url": "https://api.github.com/repos/ronancpl/HeavenMS/git/trees/2c0279d65893a159b32e13de993e8a1a8f5d6958"}, "url": "https://api.github.com/repos/ronancpl/HeavenMS/git/commits/ee40626c7df5dd90d6286c1dfe3bc2f3b0e15f68", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/ee40626c7df5dd90d6286c1dfe3bc2f3b0e15f68", "html_url": "https://github.com/ronancpl/HeavenMS/commit/ee40626c7df5dd90d6286c1dfe3bc2f3b0e15f68", "comments_url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/ee40626c7df5dd90d6286c1dfe3bc2f3b0e15f68/comments", "author": {"login": "MedicOP", "id": 18251099, "node_id": "MDQ6VXNlcjE4MjUxMDk5", "avatar_url": "https://avatars3.githubusercontent.com/u/18251099?v=4", "gravatar_id": "", "url": "https://api.github.com/users/MedicOP", "html_url": "https://github.com/MedicOP", "followers_url": "https://api.github.com/users/MedicOP/followers", "following_url": "https://api.github.com/users/MedicOP/following{/other_user}", "gists_url": "https://api.github.com/users/MedicOP/gists{/gist_id}", "starred_url": "https://api.github.com/users/MedicOP/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/MedicOP/subscriptions", "organizations_url": "https://api.github.com/users/MedicOP/orgs", "repos_url": "https://api.github.com/users/MedicOP/repos", "events_url": "https://api.github.com/users/MedicOP/events{/privacy}", "received_events_url": "https://api.github.com/users/MedicOP/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ronancpl", "id": 9257761, "node_id": "MDQ6VXNlcjkyNTc3NjE=", "avatar_url": "https://avatars2.githubusercontent.com/u/9257761?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ronancpl", "html_url": "https://github.com/ronancpl", "followers_url": "https://api.github.com/users/ronancpl/followers", "following_url": "https://api.github.com/users/ronancpl/following{/other_user}", "gists_url": "https://api.github.com/users/ronancpl/gists{/gist_id}", "starred_url": "https://api.github.com/users/ronancpl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ronancpl/subscriptions", "organizations_url": "https://api.github.com/users/ronancpl/orgs", "repos_url": "https://api.github.com/users/ronancpl/repos", "events_url": "https://api.github.com/users/ronancpl/events{/privacy}", "received_events_url": "https://api.github.com/users/ronancpl/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "fc935d5f878126ff4fb165e6f50eb7ca9cb3e425", "url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/fc935d5f878126ff4fb165e6f50eb7ca9cb3e425", "html_url": "https://github.com/ronancpl/HeavenMS/commit/fc935d5f878126ff4fb165e6f50eb7ca9cb3e425"}], "stats": {"total": 46, "additions": 25, "deletions": 21}, "files": [{"sha": "32bf79a67c8ce7aa7d83517d684a96d2cd118058", "filename": "src/client/autoban/AutobanFactory.java", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/ee40626c7df5dd90d6286c1dfe3bc2f3b0e15f68/src/client/autoban/AutobanFactory.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/ee40626c7df5dd90d6286c1dfe3bc2f3b0e15f68/src/client/autoban/AutobanFactory.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/autoban/AutobanFactory.java?ref=ee40626c7df5dd90d6286c1dfe3bc2f3b0e15f68", "patch": "@@ -80,19 +80,19 @@ public long getExpire() {\n \t}\n \n \tpublic void addPoint(AutobanManager ban, String reason) {\n-            if(ServerConstants.USE_AUTOBAN == true) {\n \t\tban.addPoint(this, reason);\n-            }\n \t}\n \t\n \tpublic void alert(MapleCharacter chr, String reason) {\n             if(ServerConstants.USE_AUTOBAN == true) {\n-\t\tFilePrinter.printError(\"autobanwarning.txt\", (chr != null ? MapleCharacter.makeMapleReadable(chr.getName()) : \"\") + \" caused \" + this.name() + \" \" + reason + \"\\r\\n\");\n \t\tif (chr != null && MapleLogger.ignored.contains(chr.getName())){\n \t\t\treturn;\n \t\t}\n \t\tServer.getInstance().broadcastGMMessage((chr != null ? chr.getWorld() : 0), MaplePacketCreator.sendYellowTip((chr != null ? MapleCharacter.makeMapleReadable(chr.getName()) : \"\") + \" caused \" + this.name() + \" \" + reason));\n             }\n+        if (ServerConstants.USE_AUTOBAN_LOG) {\n+\t\t\tFilePrinter.printError(\"autobanwarning.txt\", (chr != null ? MapleCharacter.makeMapleReadable(chr.getName()) : \"\") + \" caused \" + this.name() + \" \" + reason + \"\\r\\n\");\n+\t\t}\n \t}\n \t\n \tpublic void autoban(MapleCharacter chr, String value) {"}, {"sha": "6f86cdca286dfb78eb24959f022ce3968ca78a85", "filename": "src/client/autoban/AutobanManager.java", "status": "modified", "additions": 21, "deletions": 18, "changes": 39, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/ee40626c7df5dd90d6286c1dfe3bc2f3b0e15f68/src/client/autoban/AutobanManager.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/ee40626c7df5dd90d6286c1dfe3bc2f3b0e15f68/src/client/autoban/AutobanManager.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/autoban/AutobanManager.java?ref=ee40626c7df5dd90d6286c1dfe3bc2f3b0e15f68", "patch": "@@ -36,27 +36,30 @@ public void addPoint(AutobanFactory fac, String reason) {\n     \tif (chr.isGM() || chr.isBanned()){\n     \t\treturn;\n     \t}\n-        if (lastTime.containsKey(fac)) {\n-            if (lastTime.get(fac) < (Server.getInstance().getCurrentTime() - fac.getExpire())) {\n-                points.put(fac, points.get(fac) / 2); //So the points are not completely gone.\n+    \tif (ServerConstants.USE_AUTOBAN) {\n+            if (lastTime.containsKey(fac)) {\n+                if (lastTime.get(fac) < (Server.getInstance().getCurrentTime() - fac.getExpire())) {\n+                    points.put(fac, points.get(fac) / 2); //So the points are not completely gone.\n+                }\n             }\n-        }\n-        if (fac.getExpire() != -1)\n-            lastTime.put(fac, Server.getInstance().getCurrentTime());\n-        \n-        if (points.containsKey(fac)) {\n-            points.put(fac, points.get(fac) + 1);\n-        } else\n-            points.put(fac, 1);\n+            if (fac.getExpire() != -1)\n+                lastTime.put(fac, Server.getInstance().getCurrentTime());\n+\n+            if (points.containsKey(fac)) {\n+                points.put(fac, points.get(fac) + 1);\n+            } else\n+                points.put(fac, 1);\n \n-        if (points.get(fac) >= fac.getMaximum()) {\n-        \tchr.autoban(reason);\n-            //chr.autoban(\"Autobanned for \" + fac.name() + \" ;\" + reason, 1);\n-            //chr.sendPolice(\"You have been blocked by #bMooplePolice for the HACK reason#k.\");\n+            if (points.get(fac) >= fac.getMaximum()) {\n+                chr.autoban(reason);\n+                //chr.autoban(\"Autobanned for \" + fac.name() + \" ;\" + reason, 1);\n+                //chr.sendPolice(\"You have been blocked by #bMooplePolice for the HACK reason#k.\");\n+            }\n+        }\n+        if (ServerConstants.USE_AUTOBAN_LOG) {\n+            // Lets log every single point too.\n+            FilePrinter.printError(\"autobanwarning.txt\", MapleCharacter.makeMapleReadable(chr.getName()) + \" caused \" + fac.name() + \" \" + reason + \"\\r\\n\");\n         }\n-        \n-        // Lets log every single point too.\n-        FilePrinter.printError(\"autobanwarning.txt\", MapleCharacter.makeMapleReadable(chr.getName()) + \" caused \" + fac.name() + \" \" + reason + \"\\r\\n\");\n     }\n \n     public void addMiss() {"}, {"sha": "ed404d50f7498436e6dcce681a2374d17c5159c0", "filename": "src/constants/ServerConstants.java", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/ee40626c7df5dd90d6286c1dfe3bc2f3b0e15f68/src/constants/ServerConstants.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/ee40626c7df5dd90d6286c1dfe3bc2f3b0e15f68/src/constants/ServerConstants.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/constants/ServerConstants.java?ref=ee40626c7df5dd90d6286c1dfe3bc2f3b0e15f68", "patch": "@@ -78,6 +78,7 @@\n     public static final boolean USE_PARTY_FOR_STARTERS = true;      //Players level 10 or below can create/invite other players on the given level range.\n     public static final boolean USE_AUTOASSIGN_STARTERS_AP = false; //Beginners level 10 or below have their AP autoassigned (they can't choose to levelup a stat). Set true if the localhost doesn't support AP assigning for beginners level 10 or below.\n     public static final boolean USE_AUTOBAN = false;                //Commands the server to detect infractors automatically.\n+    public static final boolean USE_AUTOBAN_LOG = true;             //Log autoban related messages. Still logs even with USE_AUTOBAN disabled.\n     public static final boolean USE_AUTOSAVE = true;                //Enables server autosaving feature (saves characters to DB each 1 hour).\n     public static final boolean USE_SERVER_AUTOASSIGNER = true;     //HeavenMS-builtin autoassigner, uses algorithm based on distributing AP accordingly with required secondary stat on equipments.\n     public static final boolean USE_REFRESH_RANK_MOVE = true;"}]}]},
