{"fetchDate": "2019-12-19", "content": [{"sha": "7c9f9c9fdeff477b56ba3dc5f6ef3aa1a25e1a44", "node_id": "MDY6Q29tbWl0NDUwODIwMjM6N2M5ZjljOWZkZWZmNDc3YjU2YmEzZGM1ZjZlZjNhYTFhMjVlMWE0NA==", "commit": {"author": {"name": "ronancpl", "email": "rcpl2010@gmail.com", "date": "2015-11-06T15:27:46Z"}, "committer": {"name": "ronancpl", "email": "rcpl2010@gmail.com", "date": "2015-11-06T15:27:46Z"}, "message": "MapleSolaxiaV2 Revision 1\n\nMinor changes about how ranking moves are reflected in-game.", "tree": {"sha": "cc112a406009adc798df781d297b905fdd29eb14", "url": "https://api.github.com/repos/ronancpl/HeavenMS/git/trees/cc112a406009adc798df781d297b905fdd29eb14"}, "url": "https://api.github.com/repos/ronancpl/HeavenMS/git/commits/7c9f9c9fdeff477b56ba3dc5f6ef3aa1a25e1a44", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/7c9f9c9fdeff477b56ba3dc5f6ef3aa1a25e1a44", "html_url": "https://github.com/ronancpl/HeavenMS/commit/7c9f9c9fdeff477b56ba3dc5f6ef3aa1a25e1a44", "comments_url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/7c9f9c9fdeff477b56ba3dc5f6ef3aa1a25e1a44/comments", "author": {"login": "ronancpl", "id": 9257761, "node_id": "MDQ6VXNlcjkyNTc3NjE=", "avatar_url": "https://avatars2.githubusercontent.com/u/9257761?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ronancpl", "html_url": "https://github.com/ronancpl", "followers_url": "https://api.github.com/users/ronancpl/followers", "following_url": "https://api.github.com/users/ronancpl/following{/other_user}", "gists_url": "https://api.github.com/users/ronancpl/gists{/gist_id}", "starred_url": "https://api.github.com/users/ronancpl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ronancpl/subscriptions", "organizations_url": "https://api.github.com/users/ronancpl/orgs", "repos_url": "https://api.github.com/users/ronancpl/repos", "events_url": "https://api.github.com/users/ronancpl/events{/privacy}", "received_events_url": "https://api.github.com/users/ronancpl/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ronancpl", "id": 9257761, "node_id": "MDQ6VXNlcjkyNTc3NjE=", "avatar_url": "https://avatars2.githubusercontent.com/u/9257761?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ronancpl", "html_url": "https://github.com/ronancpl", "followers_url": "https://api.github.com/users/ronancpl/followers", "following_url": "https://api.github.com/users/ronancpl/following{/other_user}", "gists_url": "https://api.github.com/users/ronancpl/gists{/gist_id}", "starred_url": "https://api.github.com/users/ronancpl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ronancpl/subscriptions", "organizations_url": "https://api.github.com/users/ronancpl/orgs", "repos_url": "https://api.github.com/users/ronancpl/repos", "events_url": "https://api.github.com/users/ronancpl/events{/privacy}", "received_events_url": "https://api.github.com/users/ronancpl/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4cb24a5e3f5b2ac245906b6d5ddc1fa562a17797", "url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/4cb24a5e3f5b2ac245906b6d5ddc1fa562a17797", "html_url": "https://github.com/ronancpl/HeavenMS/commit/4cb24a5e3f5b2ac245906b6d5ddc1fa562a17797"}], "stats": {"total": 37, "additions": 29, "deletions": 8}, "files": [{"sha": "ffe73bef8eef9f7dcee97de42e3663160ba9f51e", "filename": "mychanges_ptbr.txt", "status": "modified", "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/7c9f9c9fdeff477b56ba3dc5f6ef3aa1a25e1a44/mychanges_ptbr.txt", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/7c9f9c9fdeff477b56ba3dc5f6ef3aa1a25e1a44/mychanges_ptbr.txt", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/mychanges_ptbr.txt?ref=7c9f9c9fdeff477b56ba3dc5f6ef3aa1a25e1a44", "patch": "@@ -52,7 +52,7 @@ Testei o script do chscroll crafter.\n \n 10 --- 11 Agosto 2015,\n NPC crafters, Accessories e chscroll funcionam OK.\n-cORRIGIDO BUG DE CRAFTER Q TIRAVA ITEM SE INCOMPLETO!\n+CORRIGIDO BUG DE CRAFTER Q TIRAVA ITEM SE INCOMPLETO!\n Inclui constante USE_PERFECT_SCROLLING.\n \n 12 --- 14 Agosto 2015,\n@@ -70,4 +70,7 @@ Resolvi alguns problemas com scripts do aviao e do metro.\n 25 --- 26 Agosto 2015,\n Mecanismos de evitar queda de HP por mapa (red bean, air bubble, soft white bun) funcionam.\n Correcao de bug que nao contabilizava queda de hp qdo um char loga em um mapa.\n-Correcao de bug que nao retirava corretamente recursos de projeteis.\n\\ No newline at end of file\n+Correcao de bug que nao retirava corretamente recursos de projeteis.\n+\n+6 Novembro 2015,\n+Movimentacao no ranking agora eh contabilizado corretamente.\n\\ No newline at end of file"}, {"sha": "9325b077398bf8cad23fa8a549d159a6eb1969ec", "filename": "src/constants/ServerConstants.java", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/7c9f9c9fdeff477b56ba3dc5f6ef3aa1a25e1a44/src/constants/ServerConstants.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/7c9f9c9fdeff477b56ba3dc5f6ef3aa1a25e1a44/src/constants/ServerConstants.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/constants/ServerConstants.java?ref=7c9f9c9fdeff477b56ba3dc5f6ef3aa1a25e1a44", "patch": "@@ -32,10 +32,12 @@\n     public static final boolean USE_PARTY_SEARCH = false;\n     public static final boolean USE_AUTOBAN = false;            //commands the server to detect infractors automatically.\n     public static final boolean USE_ANOTHER_AUTOASSIGN = true;  //based on distributing AP accordingly with higher secondary stat on equipments.\n+    public static final boolean USE_REFRESH_RANK_MOVE = true;\n     \n     public static final int MAX_AP = 999;\n     public static final long BLOCK_DUEY_RACE_COND = (long)(0.5 * 1000);\n-    public static final long PET_LOOT_UPON_ATTACK = (long)(0.8 * 1000);    //time the pet must wait before trying to pick items up.\n+    public static final long PET_LOOT_UPON_ATTACK = (long)(0.7 * 1000);            //time the pet must wait before trying to pick items up.\n+    \n     //Some Gameplay Enhancing Configurations\n     public static final boolean USE_PERFECT_SCROLLING = true;   //scrolls doesn't use slots upon failure.\n     public static final boolean USE_ENHANCED_CHSCROLL = true;   //equips even more powerful with chaos upgrade"}, {"sha": "ee9a00b550569322a0b6b913e09e65e9bcae6ab4", "filename": "src/net/server/RankingWorker.java", "status": "modified", "additions": 17, "deletions": 1, "changes": 18, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/7c9f9c9fdeff477b56ba3dc5f6ef3aa1a25e1a44/src/net/server/RankingWorker.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/7c9f9c9fdeff477b56ba3dc5f6ef3aa1a25e1a44/src/net/server/RankingWorker.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/RankingWorker.java?ref=7c9f9c9fdeff477b56ba3dc5f6ef3aa1a25e1a44", "patch": "@@ -27,6 +27,7 @@\n import java.sql.SQLException;\n import client.MapleJob;\n import tools.DatabaseConnection;\n+import constants.ServerConstants;\n \n /**\n  * @author Matze\n@@ -35,11 +36,17 @@\n public class RankingWorker implements Runnable {\n     private Connection con;\n     private long lastUpdate = System.currentTimeMillis();\n-\n+    \n     public void run() {\n         try {\n             con = DatabaseConnection.getConnection();\n             con.setAutoCommit(false);\n+            \n+            if(ServerConstants.USE_REFRESH_RANK_MOVE == true) {\n+                resetMoveRank(true);\n+                resetMoveRank(false);\n+            }\n+            \n             updateRanking(null);\n             for (int i = 0; i < 3; i += 2) {\n                 for (int j = 1; j < 6; j++) {\n@@ -50,13 +57,22 @@ public void run() {\n             con.setAutoCommit(true);\n             lastUpdate = System.currentTimeMillis();\n         } catch (SQLException ex) {\n+            ex.printStackTrace();\n+            \n             try {\n                 con.rollback();\n                 con.setAutoCommit(true);\n             } catch (SQLException ex2) {\n+                ex2.printStackTrace();\n             }\n         }\n     }\n+    \n+    private void resetMoveRank(boolean job) throws SQLException {\n+        String query = \"UPDATE characters SET \" + (job == true ? \"jobRankMove = 0\" : \"rankMove = 0\");\n+        PreparedStatement reset = con.prepareStatement(query);\n+        ResultSet rs = reset.executeQuery();\n+    }\n \n     private void updateRanking(MapleJob job) throws SQLException {\n         String sqlCharSelect = \"SELECT c.id, \" + (job != null ? \"c.jobRank, c.jobRankMove\" : \"c.rank, c.rankMove\") + \", a.lastlogin AS lastlogin, a.loggedin FROM characters AS c LEFT JOIN accounts AS a ON c.accountid = a.id WHERE c.gm = 0 \";"}, {"sha": "6a2ab57eb0731064a26d394c0e1b8a98f853bc48", "filename": "src/net/server/Server.java", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/7c9f9c9fdeff477b56ba3dc5f6ef3aa1a25e1a44/src/net/server/Server.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/7c9f9c9fdeff477b56ba3dc5f6ef3aa1a25e1a44/src/net/server/Server.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/Server.java?ref=7c9f9c9fdeff477b56ba3dc5f6ef3aa1a25e1a44", "patch": "@@ -168,11 +168,11 @@ public void run() {\n         MapleItemInformationProvider.getInstance().getAllItems();\n \n         CashItemFactory.getSpecialCashItems();\n-        System.out.println(\"Items loaded in \" + ((System.currentTimeMillis() - timeToTake) / 1000.0) + \" seconds\\r\\n\");\n+        System.out.println(\"Items loaded in \" + ((System.currentTimeMillis() - timeToTake) / 1000.0) + \" seconds\");\n         \n-\t\ttimeToTake = System.currentTimeMillis();\n-\t\tMapleQuest.loadAllQuest();\n-\t\tSystem.out.println(\"Quest loaded in \" + ((System.currentTimeMillis() - timeToTake) / 1000.0) + \" seconds\\r\\n\");\n+\ttimeToTake = System.currentTimeMillis();\n+\tMapleQuest.loadAllQuest();\n+\tSystem.out.println(\"Quest loaded in \" + ((System.currentTimeMillis() - timeToTake) / 1000.0) + \" seconds\\r\\n\");\n \t\t\n \t\t\n         try {"}]}]},
