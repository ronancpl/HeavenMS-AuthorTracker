{"fetchDate": "2019-12-19", "content": [{"sha": "ba303432fffc130fba70cf28b529a9d348a30fa0", "node_id": "MDY6Q29tbWl0NDUwODIwMjM6YmEzMDM0MzJmZmZjMTMwZmJhNzBjZjI4YjUyOWE5ZDM0OGEzMGZhMA==", "commit": {"author": {"name": "asafgb", "email": "asafshazar@gmail.com", "date": "2018-10-27T02:59:19Z"}, "committer": {"name": "Ronan Lana", "email": "rcpl2010@gmail.com", "date": "2018-10-27T02:59:19Z"}, "message": "Fix npcs script (#266)\n\n* fix the npcs\r\n\r\n* add java8 compability\r\n\r\n* .", "tree": {"sha": "6b0c31c96f65dec27bf249e37865de4d81e8e912", "url": "https://api.github.com/repos/ronancpl/HeavenMS/git/trees/6b0c31c96f65dec27bf249e37865de4d81e8e912"}, "url": "https://api.github.com/repos/ronancpl/HeavenMS/git/commits/ba303432fffc130fba70cf28b529a9d348a30fa0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/ba303432fffc130fba70cf28b529a9d348a30fa0", "html_url": "https://github.com/ronancpl/HeavenMS/commit/ba303432fffc130fba70cf28b529a9d348a30fa0", "comments_url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/ba303432fffc130fba70cf28b529a9d348a30fa0/comments", "author": {"login": "asafgb", "id": 7683957, "node_id": "MDQ6VXNlcjc2ODM5NTc=", "avatar_url": "https://avatars0.githubusercontent.com/u/7683957?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asafgb", "html_url": "https://github.com/asafgb", "followers_url": "https://api.github.com/users/asafgb/followers", "following_url": "https://api.github.com/users/asafgb/following{/other_user}", "gists_url": "https://api.github.com/users/asafgb/gists{/gist_id}", "starred_url": "https://api.github.com/users/asafgb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asafgb/subscriptions", "organizations_url": "https://api.github.com/users/asafgb/orgs", "repos_url": "https://api.github.com/users/asafgb/repos", "events_url": "https://api.github.com/users/asafgb/events{/privacy}", "received_events_url": "https://api.github.com/users/asafgb/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ronancpl", "id": 9257761, "node_id": "MDQ6VXNlcjkyNTc3NjE=", "avatar_url": "https://avatars2.githubusercontent.com/u/9257761?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ronancpl", "html_url": "https://github.com/ronancpl", "followers_url": "https://api.github.com/users/ronancpl/followers", "following_url": "https://api.github.com/users/ronancpl/following{/other_user}", "gists_url": "https://api.github.com/users/ronancpl/gists{/gist_id}", "starred_url": "https://api.github.com/users/ronancpl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ronancpl/subscriptions", "organizations_url": "https://api.github.com/users/ronancpl/orgs", "repos_url": "https://api.github.com/users/ronancpl/repos", "events_url": "https://api.github.com/users/ronancpl/events{/privacy}", "received_events_url": "https://api.github.com/users/ronancpl/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "589492572a308d823c5903645ba7adff98b6b3ef", "url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/589492572a308d823c5903645ba7adff98b6b3ef", "html_url": "https://github.com/ronancpl/HeavenMS/commit/589492572a308d823c5903645ba7adff98b6b3ef"}], "stats": {"total": 16, "additions": 13, "deletions": 3}, "files": [{"sha": "fd912b9658995a56f269909fe149eb4605e574c3", "filename": "src/scripting/event/EventInstanceManager.java", "status": "modified", "additions": 7, "deletions": 2, "changes": 9, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/ba303432fffc130fba70cf28b529a9d348a30fa0/src/scripting/event/EventInstanceManager.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/ba303432fffc130fba70cf28b529a9d348a30fa0/src/scripting/event/EventInstanceManager.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/scripting/event/EventInstanceManager.java?ref=ba303432fffc130fba70cf28b529a9d348a30fa0", "patch": "@@ -987,9 +987,14 @@ public MapleMonster getMonster(int mid) {\n         }\n         \n         private List<Integer> convertToIntegerArray(List<Double> list) {\n-                List<Integer> intList = new ArrayList<>();\n+            List<Integer> intList;\n+            if(ServerConstants.JAVA_8)\n+                 intList=new ArrayList<Integer> (new ArrayList(java.util.Arrays.asList(list.toArray())));\n+            else\n+            {\n+                 intList = new ArrayList<>();\n                 for(Double d: list) intList.add(d.intValue());\n-\n+            }\n                 return intList;\n         }\n         "}, {"sha": "8a961be132194431ac4bc97c2c1dc29a6c84332c", "filename": "src/scripting/event/EventManager.java", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/ba303432fffc130fba70cf28b529a9d348a30fa0/src/scripting/event/EventManager.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/ba303432fffc130fba70cf28b529a9d348a30fa0/src/scripting/event/EventManager.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/scripting/event/EventManager.java?ref=ba303432fffc130fba70cf28b529a9d348a30fa0", "patch": "@@ -60,6 +60,7 @@\n import net.server.audit.locks.MonitoredLockType;\n import net.server.audit.locks.MonitoredReentrantLock;\n import net.server.audit.locks.factory.MonitoredReentrantLockFactory;\n+import jdk.nashorn.api.scripting.ScriptUtils;\n \n /**\n  *\n@@ -645,7 +646,11 @@ public boolean startInstance(int lobbyId, EventInstanceManager eim, String ldr,\n             Object p = iv.invokeFunction(\"getEligibleParty\", party.getPartyMembers());\n             \n             if(p != null) {\n-                List<MaplePartyCharacter> lmpc = new ArrayList<>((List<MaplePartyCharacter>) p);\n+                List<MaplePartyCharacter> lmpc;\n+                if(ServerConstants.JAVA_8)\n+                    lmpc = new ArrayList<>(((Map<String, MaplePartyCharacter>)(ScriptUtils.convert(p, Map.class))).values());\n+                else\n+                    lmpc = new ArrayList<>((List<MaplePartyCharacter>) p);\n                 party.setEligibleMembers(lmpc);\n                 return lmpc;\n             }"}]}]},
