{"fetchDate": "2019-12-19", "content": [{"sha": "28258530e4920ad5eb6a12f64d099ed6f64d9f87", "node_id": "MDY6Q29tbWl0NDUwODIwMjM6MjgyNTg1MzBlNDkyMGFkNWViNmExMmY2NGQwOTllZDZmNjRkOWY4Nw==", "commit": {"author": {"name": "ronancpl", "email": "rcpl2010@gmail.com", "date": "2017-09-25T05:16:24Z"}, "committer": {"name": "ronancpl", "email": "rcpl2010@gmail.com", "date": "2017-09-25T05:16:24Z"}, "message": "Water of Life + Fixed GPQ & Buff system\n\nAdded Water of Life. Fixed Shuang (GPQ) npc dc'ing the leader when first\ntrying to enter the waiting area. Fixed some cases with the revamped\nbuff system, that would not properly check for the best buffs in some\nscenarios, and would throw exceptions, caused by not properly protecting\naccess to critical data.", "tree": {"sha": "a631d967c2eca569ec0c67f5fb530e977aa286b5", "url": "https://api.github.com/repos/ronancpl/HeavenMS/git/trees/a631d967c2eca569ec0c67f5fb530e977aa286b5"}, "url": "https://api.github.com/repos/ronancpl/HeavenMS/git/commits/28258530e4920ad5eb6a12f64d099ed6f64d9f87", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/28258530e4920ad5eb6a12f64d099ed6f64d9f87", "html_url": "https://github.com/ronancpl/HeavenMS/commit/28258530e4920ad5eb6a12f64d099ed6f64d9f87", "comments_url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/28258530e4920ad5eb6a12f64d099ed6f64d9f87/comments", "author": {"login": "ronancpl", "id": 9257761, "node_id": "MDQ6VXNlcjkyNTc3NjE=", "avatar_url": "https://avatars2.githubusercontent.com/u/9257761?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ronancpl", "html_url": "https://github.com/ronancpl", "followers_url": "https://api.github.com/users/ronancpl/followers", "following_url": "https://api.github.com/users/ronancpl/following{/other_user}", "gists_url": "https://api.github.com/users/ronancpl/gists{/gist_id}", "starred_url": "https://api.github.com/users/ronancpl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ronancpl/subscriptions", "organizations_url": "https://api.github.com/users/ronancpl/orgs", "repos_url": "https://api.github.com/users/ronancpl/repos", "events_url": "https://api.github.com/users/ronancpl/events{/privacy}", "received_events_url": "https://api.github.com/users/ronancpl/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ronancpl", "id": 9257761, "node_id": "MDQ6VXNlcjkyNTc3NjE=", "avatar_url": "https://avatars2.githubusercontent.com/u/9257761?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ronancpl", "html_url": "https://github.com/ronancpl", "followers_url": "https://api.github.com/users/ronancpl/followers", "following_url": "https://api.github.com/users/ronancpl/following{/other_user}", "gists_url": "https://api.github.com/users/ronancpl/gists{/gist_id}", "starred_url": "https://api.github.com/users/ronancpl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ronancpl/subscriptions", "organizations_url": "https://api.github.com/users/ronancpl/orgs", "repos_url": "https://api.github.com/users/ronancpl/repos", "events_url": "https://api.github.com/users/ronancpl/events{/privacy}", "received_events_url": "https://api.github.com/users/ronancpl/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7bbf5127977f7a84f41fa7e68a9c4b93f209d338", "url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/7bbf5127977f7a84f41fa7e68a9c4b93f209d338", "html_url": "https://github.com/ronancpl/HeavenMS/commit/7bbf5127977f7a84f41fa7e68a9c4b93f209d338"}], "stats": {"total": 363, "additions": 316, "deletions": 47}, "files": [{"sha": "d1f32ddfdecd6baf4e34695fc02d128bd628529b", "filename": "README.md", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/28258530e4920ad5eb6a12f64d099ed6f64d9f87/README.md", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/28258530e4920ad5eb6a12f64d099ed6f64d9f87/README.md", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/README.md?ref=28258530e4920ad5eb6a12f64d099ed6f64d9f87", "patch": "@@ -20,6 +20,11 @@ Server files: https://github.com/ronancpl/MapleSolaxiaV2\n \n Client files & general tools: https://drive.google.com/drive/folders/0BzDsHSr-0V4MYVJ0TWIxd05hYUk\n \n+---\n+### Donation\n+\n+If you liked what you have seen on the project, donate a little something as a helping hand for my contributions towards Maple development. Paypal: https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=3K8KVTWRLFBQ4\n+\n ---\n ### Preparing the ambient \n "}, {"sha": "1dddac2c40f525717ac5afd5ff34a77833a4f638", "filename": "build/built-jar.properties", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/built-jar.properties", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/built-jar.properties", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/built-jar.properties?ref=28258530e4920ad5eb6a12f64d099ed6f64d9f87", "patch": "@@ -1,4 +1,4 @@\n-#Fri, 22 Sep 2017 22:54:29 -0300\n+#Mon, 25 Sep 2017 01:46:09 -0300\n \n \n C\\:\\\\Nexon\\\\MapleSolaxia\\\\MapleSolaxiaV2="}, {"sha": "11c1d8ea58c241182d7e27731426bb0395b8c03f", "filename": "build/classes/client/MapleCharacter$10.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/client/MapleCharacter$10.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/client/MapleCharacter$10.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$10.class?ref=28258530e4920ad5eb6a12f64d099ed6f64d9f87"}, {"sha": "712368a6e78828805663a8e59758b1e4393a066b", "filename": "build/classes/client/MapleCharacter$11.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/client/MapleCharacter$11.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/client/MapleCharacter$11.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$11.class?ref=28258530e4920ad5eb6a12f64d099ed6f64d9f87"}, {"sha": "e736acf9ee9b0f959353790531fcd11c74a8b912", "filename": "build/classes/client/MapleCharacter$12.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/client/MapleCharacter$12.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/client/MapleCharacter$12.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$12.class?ref=28258530e4920ad5eb6a12f64d099ed6f64d9f87"}, {"sha": "34bde9a6aa2613b1a5d0a2009147ed9cf4842cfd", "filename": "build/classes/client/MapleCharacter$13.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/client/MapleCharacter$13.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/client/MapleCharacter$13.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$13.class?ref=28258530e4920ad5eb6a12f64d099ed6f64d9f87"}, {"sha": "6037fe54ffa36c949dc2a2af0946771ef0efb9e0", "filename": "build/classes/client/MapleCharacter$14.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/client/MapleCharacter$14.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/client/MapleCharacter$14.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$14.class?ref=28258530e4920ad5eb6a12f64d099ed6f64d9f87"}, {"sha": "db05f3875a5d4d30a36278e67673b9fc16f50506", "filename": "build/classes/client/MapleCharacter$15.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/client/MapleCharacter$15.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/client/MapleCharacter$15.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$15.class?ref=28258530e4920ad5eb6a12f64d099ed6f64d9f87"}, {"sha": "62129b955a9c9df4e070697a36334bd542887116", "filename": "build/classes/client/MapleCharacter$16.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/client/MapleCharacter$16.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/client/MapleCharacter$16.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$16.class?ref=28258530e4920ad5eb6a12f64d099ed6f64d9f87"}, {"sha": "0430f5e9076cb6579d70d92a1cde29a067be2763", "filename": "build/classes/client/MapleCharacter$17.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/client/MapleCharacter$17.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/client/MapleCharacter$17.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$17.class?ref=28258530e4920ad5eb6a12f64d099ed6f64d9f87"}, {"sha": "28b558a69ede6fa85cbba6d8f2d4ff1c3a72f8a9", "filename": "build/classes/client/MapleCharacter$18.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/client/MapleCharacter$18.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/client/MapleCharacter$18.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$18.class?ref=28258530e4920ad5eb6a12f64d099ed6f64d9f87"}, {"sha": "b66acd2e28c9d7b677cbec3a7734627d6dd2d1b7", "filename": "build/classes/client/MapleCharacter$19.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/client/MapleCharacter$19.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/client/MapleCharacter$19.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$19.class?ref=28258530e4920ad5eb6a12f64d099ed6f64d9f87"}, {"sha": "64197dcb4eb676bcf6404006f1528b836061ae6b", "filename": "build/classes/client/MapleCharacter$8.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/client/MapleCharacter$8.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/client/MapleCharacter$8.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$8.class?ref=28258530e4920ad5eb6a12f64d099ed6f64d9f87"}, {"sha": "675644a5d1c789feca32bcee23afbb71b15f9d7e", "filename": "build/classes/client/MapleCharacter$9.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/client/MapleCharacter$9.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/client/MapleCharacter$9.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$9.class?ref=28258530e4920ad5eb6a12f64d099ed6f64d9f87"}, {"sha": "6c5ff192ab3782e324536cc43520087c62f8cf0a", "filename": "build/classes/client/MapleCharacter$FameStatus.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/client/MapleCharacter$FameStatus.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/client/MapleCharacter$FameStatus.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$FameStatus.class?ref=28258530e4920ad5eb6a12f64d099ed6f64d9f87"}, {"sha": "8b4b8c77f70c87aadf50aaf9ff1ece0639c851b9", "filename": "build/classes/client/MapleCharacter$MapleBuffStatValueHolder.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/client/MapleCharacter$MapleBuffStatValueHolder.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/client/MapleCharacter$MapleBuffStatValueHolder.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$MapleBuffStatValueHolder.class?ref=28258530e4920ad5eb6a12f64d099ed6f64d9f87"}, {"sha": "65e9a347501767335cf0031898e998829a615305", "filename": "build/classes/client/MapleCharacter$MapleCoolDownValueHolder.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/client/MapleCharacter$MapleCoolDownValueHolder.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/client/MapleCharacter$MapleCoolDownValueHolder.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$MapleCoolDownValueHolder.class?ref=28258530e4920ad5eb6a12f64d099ed6f64d9f87"}, {"sha": "40d7d03d26631c4cca7ec5e708ba1adc62e236be", "filename": "build/classes/client/MapleCharacter$SkillEntry.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/client/MapleCharacter$SkillEntry.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/client/MapleCharacter$SkillEntry.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$SkillEntry.class?ref=28258530e4920ad5eb6a12f64d099ed6f64d9f87"}, {"sha": "d5e8d6a72909cf39dae9c140cdf68c95825e6a38", "filename": "build/classes/client/MapleCharacter.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/client/MapleCharacter.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/client/MapleCharacter.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter.class?ref=28258530e4920ad5eb6a12f64d099ed6f64d9f87"}, {"sha": "458e585da8d6ab05283c1f619ce45154b402e761", "filename": "build/classes/constants/ServerConstants.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/constants/ServerConstants.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/constants/ServerConstants.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/constants/ServerConstants.class?ref=28258530e4920ad5eb6a12f64d099ed6f64d9f87"}, {"sha": "46a4fd0c17ea89048a0ee79b661b90df93442902", "filename": "build/classes/net/PacketProcessor.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/net/PacketProcessor.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/net/PacketProcessor.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/net/PacketProcessor.class?ref=28258530e4920ad5eb6a12f64d099ed6f64d9f87"}, {"sha": "359d3127670c2a2683605312eea8ee60bc7f1251", "filename": "build/classes/net/RecvOpcode.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/net/RecvOpcode.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/net/RecvOpcode.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/net/RecvOpcode.class?ref=28258530e4920ad5eb6a12f64d099ed6f64d9f87"}, {"sha": "e912b997e73bed0efd47d3d171b379c74c3c7366", "filename": "build/classes/net/server/PlayerBuffValueHolder.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/net/server/PlayerBuffValueHolder.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/net/server/PlayerBuffValueHolder.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/net/server/PlayerBuffValueHolder.class?ref=28258530e4920ad5eb6a12f64d099ed6f64d9f87"}, {"sha": "bf8fba220549f3f0e41a7f171ef4296eea37c50c", "filename": "build/classes/net/server/channel/handlers/CancelBuffHandler.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/net/server/channel/handlers/CancelBuffHandler.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/net/server/channel/handlers/CancelBuffHandler.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/net/server/channel/handlers/CancelBuffHandler.class?ref=28258530e4920ad5eb6a12f64d099ed6f64d9f87"}, {"sha": "6081003ad5ecdf0b49f24afa31f10bcf58c75d8c", "filename": "build/classes/net/server/channel/handlers/PlayerLoggedinHandler.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/net/server/channel/handlers/PlayerLoggedinHandler.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/net/server/channel/handlers/PlayerLoggedinHandler.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/net/server/channel/handlers/PlayerLoggedinHandler.class?ref=28258530e4920ad5eb6a12f64d099ed6f64d9f87"}, {"sha": "a05872ab412923dd7225ff102b98969a926eae8c", "filename": "build/classes/scripting/AbstractPlayerInteraction.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/scripting/AbstractPlayerInteraction.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/scripting/AbstractPlayerInteraction.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/scripting/AbstractPlayerInteraction.class?ref=28258530e4920ad5eb6a12f64d099ed6f64d9f87"}, {"sha": "208c597db730a1bbf35c49dcf5463dec144a137f", "filename": "build/classes/server/MapleStatEffect.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/server/MapleStatEffect.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/28258530e4920ad5eb6a12f64d099ed6f64d9f87/build/classes/server/MapleStatEffect.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/MapleStatEffect.class?ref=28258530e4920ad5eb6a12f64d099ed6f64d9f87"}, {"sha": "a0c8db00eed9562d44813e6842262cd8d384ac6c", "filename": "dist/MapleSolaxia.jar", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/28258530e4920ad5eb6a12f64d099ed6f64d9f87/dist/MapleSolaxia.jar", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/28258530e4920ad5eb6a12f64d099ed6f64d9f87/dist/MapleSolaxia.jar", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/dist/MapleSolaxia.jar?ref=28258530e4920ad5eb6a12f64d099ed6f64d9f87"}, {"sha": "145f6b6f7c534dec7ee15e189243b39a198a1418", "filename": "docs/feature_list.txt", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/28258530e4920ad5eb6a12f64d099ed6f64d9f87/docs/feature_list.txt", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/28258530e4920ad5eb6a12f64d099ed6f64d9f87/docs/feature_list.txt", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/docs/feature_list.txt?ref=28258530e4920ad5eb6a12f64d099ed6f64d9f87", "patch": "@@ -32,7 +32,7 @@ Quests:\n * Quests can now reward properly items when matching a reward item with the player's job.\n * Loads of quests have been patched.\n * Quest rewards according to jobs works properly.\n-* Rewarding system now checks for stacking opportunities on the inventory before checking for new slots.\n+* Enchanced rewarding system: checks for stacking opportunities on the inventory before checking for new slots.\n \n Player Social Network:\n * Guild and Alliance system fully functional.\n@@ -60,6 +60,7 @@ Server potentials:\n * Mastery book announcer displays droppers of needed books of a player, by reading underlying DB.\n * Every skill/mastery book is now droppable by mobs.\n * Inventory auto-gather and auto-sorting feature.\n+* Enhanced buff system: smartly checks for the best available buff effects to be active on the player.\n * Enhanced AP auto-assigner: exactly matches AP with the needed for the player's current level, surplus assigned to the primary attribute.\n * Added Boss HP Bar for dozens of bosses (needs provided custom wz).\n * If multiple bosses are on the same area, client will prioritize Boss HP bar of the target of the player."}, {"sha": "52b8e1004576db2f3a0a8da10440d99c3f30152b", "filename": "docs/mychanges_ptbr.txt", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/28258530e4920ad5eb6a12f64d099ed6f64d9f87/docs/mychanges_ptbr.txt", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/28258530e4920ad5eb6a12f64d099ed6f64d9f87/docs/mychanges_ptbr.txt", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/docs/mychanges_ptbr.txt?ref=28258530e4920ad5eb6a12f64d099ed6f64d9f87", "patch": "@@ -545,4 +545,8 @@ Completamente reestruturado sistema de buffs. Nova flag permite perman\n \n 22 Setembro 2017,\n Adicionado buffs para GPQ.\n-Consertado GPQ n\ufffdo iniciando devido a problemas com o script de evento.\n\\ No newline at end of file\n+Consertado GPQ n\ufffdo iniciando devido a problemas com o script de evento.\n+\n+23 Setembro 2017,\n+Adicionado Water of Life.\n+Consertado bug com sistema novo de buffs ao entrar no cash shop e em outros cen\ufffdrios onde n\ufffdo se detectava o melhor buff corretamente.\n\\ No newline at end of file"}, {"sha": "5af0ed1acce427edd53bc66d6b2b5f2bf3272c28", "filename": "nbproject/private/private.xml", "status": "modified", "additions": 1, "deletions": 9, "changes": 10, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/28258530e4920ad5eb6a12f64d099ed6f64d9f87/nbproject/private/private.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/28258530e4920ad5eb6a12f64d099ed6f64d9f87/nbproject/private/private.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/nbproject/private/private.xml?ref=28258530e4920ad5eb6a12f64d099ed6f64d9f87", "patch": "@@ -2,14 +2,6 @@\n <project-private xmlns=\"http://www.netbeans.org/ns/project-private/1\">\n     <editor-bookmarks xmlns=\"http://www.netbeans.org/ns/editor-bookmarks/2\" lastBookmarkId=\"1\"/>\n     <open-files xmlns=\"http://www.netbeans.org/ns/projectui-open-files/2\">\n-        <group>\n-            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/scripts/event/GuildQuest.js</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/scripts/npc/9040000.js</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/scripting/event/EventInstanceManager.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/client/MapleCharacter.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/scripting/event/EventManager.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/scripts/npc/1052013.js</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/scripts/event/AmoriaPQ.js</file>\n-        </group>\n+        <group/>\n     </open-files>\n </project-private>"}, {"sha": "628c566701a3c662188ffbd2cb6df3c3e29c046c", "filename": "scripts/event/GuildQuest.js", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/28258530e4920ad5eb6a12f64d099ed6f64d9f87/scripts/event/GuildQuest.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/28258530e4920ad5eb6a12f64d099ed6f64d9f87/scripts/event/GuildQuest.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/event/GuildQuest.js?ref=28258530e4920ad5eb6a12f64d099ed6f64d9f87", "patch": "@@ -25,7 +25,7 @@\n */\n \n var isPq = true;\n-var minPlayers = 1, maxPlayers = 30;\n+var minPlayers = 6, maxPlayers = 30;\n var minLevel = 1, maxLevel = 255;\n var entryMap = 990000000;\n var exitMap = 990001100;\n@@ -201,10 +201,10 @@ function scheduledTimeout(eim) {\n                         } else {\n                                 eim.startEventTimer(eventTime * 60000);\n                                 \n-                                //if(isTeamAllJobs(eim)) {\n+                                if(isTeamAllJobs(eim)) {\n                                         var rnd = Math.floor(Math.random() * 4);\n                                         eim.applyEventPlayersItemBuff(2023000 + rnd);\n-                                //}\n+                                }\n                         }\n                 } else {\n                         end(eim);"}, {"sha": "c08fe6fa6fc3c23145efbf61c9cd92c7aa7ca7d0", "filename": "scripts/npc/1032102.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/28258530e4920ad5eb6a12f64d099ed6f64d9f87/scripts/npc/1032102.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/28258530e4920ad5eb6a12f64d099ed6f64d9f87/scripts/npc/1032102.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/1032102.js?ref=28258530e4920ad5eb6a12f64d099ed6f64d9f87", "patch": "@@ -104,7 +104,7 @@ function action(mode, type, selection) {\n \t\t\t}\n \t\t} else if (status == 2) {\n \t\t\tif (selection == 0) {\n-\t\t\t\tMapleInventoryManipulator.removeFromSlot(cm.getC(), MapleInventoryType.CASH, 1, 1, true);\n+\t\t\t\tMapleInventoryManipulator.removeFromSlot(cm.getClient(), MapleInventoryType.CASH, 1, 1, true);\n \t\t\t\tcm.sendOk(\"Your cash first slot is removed.\");\n \t\t\t} else if (selection == 1) {\n \t\t\t\tif (cm.haveItem(5000029, 2)) {"}, {"sha": "b687e9ead05843caf5df20b3e48f186eabb0ffbd", "filename": "scripts/npc/waterOfLife.js", "status": "added", "additions": 95, "deletions": 0, "changes": 95, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/28258530e4920ad5eb6a12f64d099ed6f64d9f87/scripts/npc/waterOfLife.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/28258530e4920ad5eb6a12f64d099ed6f64d9f87/scripts/npc/waterOfLife.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/waterOfLife.js?ref=28258530e4920ad5eb6a12f64d099ed6f64d9f87", "patch": "@@ -0,0 +1,95 @@\n+/*\n+\tThis file is part of the OdinMS Maple Story Server\n+    Copyright (C) 2008 Patrick Huy <patrick.huy@frz.cc>\n+\t\t       Matthias Butz <matze@odinms.de>\n+\t\t       Jan Christian Meyer <vimes@odinms.de>\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+/* Mar the Fairy\n+\tHandles Water of Life\n+ */\n+\n+importPackage(Packages.client.inventory);\n+importPackage(Packages.server);\n+\n+var status;\n+var dList;\n+ \n+function start() {\n+        status = -1;\n+        dList = cm.getDriedPets();\n+        if(dList.size() == 0) {\n+                cm.playerMessage(5, \"You currently do not own a pet that needs to be treated with Water of Life.\");\n+                cm.dispose();\n+                return;\n+        }\n+        \n+        action(1, 0, 0);\n+}\n+\n+function action(mode, type, selection) {\n+        if (mode == -1) {\n+                cm.dispose();\n+        } else {\n+                if (mode == 0 && type > 0) {\n+                        cm.dispose();\n+                        return;\n+                }\n+                if (mode == 1)\n+                        status++;\n+                else\n+                        status--;\n+    \n+                if (status == 0) {\n+                        cm.sendYesNo(\"I am Mar the Fairy. You have the #bWater of Life#k... With this, I can bring a doll back to life with my magic. What do you think? Do you want to use this item and reawaken your pet ...?\");\n+                        \n+                } else if (status == 1) {\n+                        var talkStr = \"So which pet you want to reawaken? Please choose the pet you'd most like to reawaken...\\r\\n\\r\\n\";\n+                        \n+                        var listStr = \"\";\n+                        var i = 0;\n+                        \n+                        var dIter = dList.iterator();\n+                        while (dIter.hasNext()){\n+                            var dPet = dIter.next();\n+                            \n+                            listStr += \"#b#L\" + i + \"# \" + dPet.getName() + \" #k - Lv \" + dPet.getLevel() + \" Closeness \" + dPet.getCloseness();\n+                            listStr += \"#l\\r\\n\";\n+                            \n+                            i++;\n+                        }\n+                        \n+                        cm.sendSimple(talkStr + listStr);\n+                } else if (status == 2) {\n+                        var sPet = dList.get(selection);\n+                        \n+                        if(sPet != null) {\n+                            cm.sendNext(\"Your doll has now reawaken as your pet! However, my magic isn't perfect, so I can't promise an eternal life for your pet... Please take care of that pet before the Water of Life dries. Well then, good bye...\");\n+                            \n+                            var it = cm.getPlayer().getInventory(MapleInventoryType.CASH).getItem(sPet.getPosition());\n+                            it.setExpiration(Date.now() + (1000 * 60 * 60 * 24 * 90));\n+                            cm.getPlayer().forceUpdateItem(it);\n+                            \n+                            cm.gainItem(5180000, -1);\n+                        } else {\n+                            cm.sendNext(\"Oh, well then. Good bye...\");\n+                        }\n+                    \n+                        cm.dispose();\n+                }\n+        }\n+}\n\\ No newline at end of file"}, {"sha": "b9f949b68d47aa5a2d97f54e9bd61a90835bb8e8", "filename": "scripts/quest/8185.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/28258530e4920ad5eb6a12f64d099ed6f64d9f87/scripts/quest/8185.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/28258530e4920ad5eb6a12f64d099ed6f64d9f87/scripts/quest/8185.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/quest/8185.js?ref=28258530e4920ad5eb6a12f64d099ed6f64d9f87", "patch": "@@ -92,7 +92,7 @@ function end(mode, type, selection) {\n \t\t\t\t\tname = MapleItemInformationProvider.getInstance().getName(after);\n \t\t\t} */\n \t\t\t\n-                        //qm.unequipPet(qm.getC());\n+                        //qm.unequipPet(qm.getClient());\n \t\t\tqm.gainItem(5380000, -1);\n                         qm.gainMeso(-10000);\n                         qm.evolvePet(i, after);"}, {"sha": "e9cb6eec5511cd04241557fd077a5a643666d5b0", "filename": "sql/db_drops.sql", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/28258530e4920ad5eb6a12f64d099ed6f64d9f87/sql/db_drops.sql", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/28258530e4920ad5eb6a12f64d099ed6f64d9f87/sql/db_drops.sql", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/sql/db_drops.sql?ref=28258530e4920ad5eb6a12f64d099ed6f64d9f87", "patch": "@@ -19820,6 +19820,15 @@ USE `maplesolaxia`;\n (9420501, 1492005, 1, 1, 0, 2000),\n (8820001, 2388043, 1, 1, 0, 24000);\n \n+  # zhelms, pink bean customs\n+  DELETE FROM temp_data WHERE itemid=1002357;\n+  INSERT IGNORE INTO temp_data (`dropperid`, `itemid`, `minimum_quantity`, `maximum_quantity`, `questid`, `chance`) VALUES\n+(8800002, 1002357, 1, 1, 0, 300000),\n+(8800002, 1002390, 1, 1, 0, 80000),\n+(8800002, 1002430, 1, 1, 0, 40000),\n+(8820001, 1002971, 1, 1, 0, 80000),\n+(8820001, 1052202, 1, 1, 0, 80000);\n+\n   # delete item drops from bosses in inactive form\n   DELETE FROM temp_data WHERE dropperid=4220001;\n   DELETE FROM temp_data WHERE dropperid=5220001;"}, {"sha": "909e01a0d1dc8e52bd8a0535369800a5befc4eef", "filename": "src/client/MapleCharacter.java", "status": "modified", "additions": 48, "deletions": 19, "changes": 67, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/28258530e4920ad5eb6a12f64d099ed6f64d9f87/src/client/MapleCharacter.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/28258530e4920ad5eb6a12f64d099ed6f64d9f87/src/client/MapleCharacter.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/MapleCharacter.java?ref=28258530e4920ad5eb6a12f64d099ed6f64d9f87", "patch": "@@ -151,11 +151,12 @@\n import server.maps.MapleMapItem;\n \n public class MapleCharacter extends AbstractAnimatedMapleMapObject {\n+    private static NumberFormat nf = new DecimalFormat(\"#,###,###,###\");\n     private static final String LEVEL_200 = \"[Congrats] %s has reached Level 200! Congratulate %s on such an amazing achievement!\";\n-\n     private static final String[] BLOCKED_NAMES = {\"admin\", \"owner\", \"moderator\", \"intern\", \"donor\", \"administrator\", \"help\", \"helper\", \"alert\", \"notice\", \"maplestory\", \"Solaxia\", \"fuck\", \"wizet\", \"fucking\", \"negro\", \"fuk\", \"fuc\", \"penis\", \"pussy\", \"asshole\", \"gay\",\n         \"nigger\", \"homo\", \"suck\", \"cum\", \"shit\", \"shitty\", \"condom\", \"security\", \"official\", \"rape\", \"nigga\", \"sex\", \"tit\", \"boner\", \"orgy\", \"clit\", \"asshole\", \"fatass\", \"bitch\", \"support\", \"gamemaster\", \"cock\", \"gaay\", \"gm\",\n         \"operate\", \"master\", \"sysop\", \"party\", \"GameMaster\", \"community\", \"message\", \"event\", \"test\", \"meso\", \"Scania\", \"renewal\", \"yata\", \"AsiaSoft\", \"henesys\"};\n+    \n     private int world;\n     private int accountid, id;\n     private int rank, rankMove, jobRank, jobRankMove;\n@@ -260,7 +261,6 @@\n     private Lock chrLock = new ReentrantLock();\n     private Lock effLock = new ReentrantLock();\n     private Lock petLock = new ReentrantLock();\n-    private NumberFormat nf = new DecimalFormat(\"#,###,###,###\");\n     private Map<Integer, Set<Integer>> excluded = new LinkedHashMap<>();\n     private Set<Integer> excludedItems = new LinkedHashSet<>();\n     private List<MapleRing> crushRings = new ArrayList<>();\n@@ -2095,22 +2095,26 @@ public void buffExpireTask() {\n                 @Override\n                 public void run() {\n                     Set<Entry<Integer, Long>> es;\n+                    List<MapleBuffStatValueHolder> toCancel = new ArrayList<>();\n                     \n                     effLock.lock();\n                     chrLock.lock();\n                     try {\n                         es = new LinkedHashSet<>(buffExpires.entrySet());\n+                        \n+                        long curTime = System.currentTimeMillis();\n+                        for(Entry<Integer, Long> bel : es) {\n+                            if(curTime >= bel.getValue()) {\n+                                toCancel.add(buffEffects.get(bel.getKey()).entrySet().iterator().next().getValue());    //rofl\n+                            }\n+                        }\n                     } finally {\n                         chrLock.unlock();\n                         effLock.unlock();\n                     }\n                     \n-                    long curTime = System.currentTimeMillis();\n-                    for(Entry<Integer, Long> bel : es) {\n-                        if(curTime >= bel.getValue()) {\n-                            MapleBuffStatValueHolder mbsvh = buffEffects.get(bel.getKey()).entrySet().iterator().next().getValue(); // rofl\n-                            cancelEffect(mbsvh.effect, false, mbsvh.startTime);\n-                        }\n+                    for(MapleBuffStatValueHolder mbsvh : toCancel) {\n+                        cancelEffect(mbsvh.effect, false, mbsvh.startTime);\n                     }\n                 }\n             }, 1500);\n@@ -2181,17 +2185,23 @@ public void run() {\n                     for (MapleInventory inv : inventory) {\n                         for (Item item : inv.list()) {\n                             expiration = item.getExpiration();\n+                            \n                             if (expiration != -1 && (expiration < currenttime) && ((item.getFlag() & ItemConstants.LOCK) == ItemConstants.LOCK)) {\n                                 byte aids = item.getFlag();\n                                 aids &= ~(ItemConstants.LOCK);\n                                 item.setFlag(aids); //Probably need a check, else people can make expiring items into permanent items...\n                                 item.setExpiration(-1);\n                                 forceUpdateItem(item);   //TEST :3\n                             } else if (expiration != -1 && expiration < currenttime) {\n-                                client.announce(MaplePacketCreator.itemExpired(item.getItemId()));\n-                                toberemove.add(item);\n-                                if(ItemConstants.isRateCoupon(item.getItemId())) {\n-                                    deletedCoupon = true;\n+                                if(!ItemConstants.isPet(item.getItemId()) || ServerConstants.USE_ERASE_PET_ON_EXPIRATION) {\n+                                    client.announce(MaplePacketCreator.itemExpired(item.getItemId()));\n+                                    toberemove.add(item);\n+                                    if(ItemConstants.isRateCoupon(item.getItemId())) {\n+                                        deletedCoupon = true;\n+                                    }\n+                                } else {\n+                                    item.setExpiration(-1);\n+                                    forceUpdateItem(item);\n                                 }\n                             }\n                         }\n@@ -2472,7 +2482,7 @@ public MapleStatEffect getBuffEffect(MapleBuffStat stat) {\n         effLock.lock();\n         chrLock.lock();\n         try {\n-            return buffEffects.keySet();\n+            return new LinkedHashSet<>(buffEffects.keySet());\n         } finally {\n             chrLock.unlock();\n             effLock.unlock();\n@@ -2500,12 +2510,14 @@ public MapleStatEffect getBuffEffect(MapleBuffStat stat) {\n         effLock.lock();\n         chrLock.lock();\n         try {\n+            long curtime = System.currentTimeMillis();\n+            \n             Map<Integer, PlayerBuffValueHolder> ret = new LinkedHashMap<>();\n             for(Map<MapleBuffStat, MapleBuffStatValueHolder> bel : buffEffects.values()) {\n                 for(MapleBuffStatValueHolder mbsvh : bel.values()) {\n                     int srcid = mbsvh.effect.getBuffSourceId();\n                     if(!ret.containsKey(srcid)) {\n-                        ret.put(srcid, new PlayerBuffValueHolder(mbsvh.startTime, mbsvh.effect));\n+                        ret.put(srcid, new PlayerBuffValueHolder((int)(curtime - mbsvh.startTime), mbsvh.effect));\n                     }\n                 }\n             }\n@@ -2826,16 +2838,32 @@ private void updateEffects(Set<MapleBuffStat> removedStats) {\n         chrLock.lock();\n         try {\n             Map<Integer, Pair<MapleStatEffect, Long>> retrievedEffects = new LinkedHashMap<>();\n+            Map<MapleBuffStat, Pair<Integer, Integer>> maxStatups = new LinkedHashMap<>();\n             \n             for(Entry<Integer, Map<MapleBuffStat, MapleBuffStatValueHolder>> bel : buffEffects.entrySet()) {\n                 for(Entry<MapleBuffStat, MapleBuffStatValueHolder> belv : bel.getValue().entrySet()) {\n                     if(removedStats.contains(belv.getKey())) {\n-                        retrievedEffects.put(bel.getKey(), new Pair<>(belv.getValue().effect, belv.getValue().startTime));\n+                        if(!retrievedEffects.containsKey(bel.getKey())) {\n+                            retrievedEffects.put(bel.getKey(), new Pair<>(belv.getValue().effect, belv.getValue().startTime));\n+                        }\n+                        \n+                        Pair<Integer, Integer> thisStat = maxStatups.get(belv.getKey());\n+                        if(thisStat == null || belv.getValue().value > thisStat.getRight()) {\n+                            maxStatups.put(belv.getKey(), new Pair<>(bel.getKey(), belv.getValue().value));\n+                        }\n                     }\n                 }\n             }\n             \n-            for(Entry<Integer, Pair<MapleStatEffect, Long>> lmse: retrievedEffects.entrySet()) {\n+            Map<Integer, Pair<MapleStatEffect, Long>> bestEffects = new LinkedHashMap<>();\n+            for(Entry<MapleBuffStat, Pair<Integer, Integer>> lmse: maxStatups.entrySet()) {\n+                Integer srcid = lmse.getValue().getLeft();\n+                if(!bestEffects.containsKey(srcid)) {\n+                    bestEffects.put(srcid, retrievedEffects.get(srcid));\n+                }\n+            }\n+            \n+            for(Entry<Integer, Pair<MapleStatEffect, Long>> lmse: bestEffects.entrySet()) {\n                 lmse.getValue().getLeft().updateBuffEffect(this, getActiveStatupsFromSourceid(lmse.getKey()), lmse.getValue().getRight());\n             }\n         } finally {\n@@ -6933,9 +6961,10 @@ private void silentEnforceMaxHpMp() {\n         setHp(getHp(), true);\n     }\n \n-    public void silentGiveBuffs(List<PlayerBuffValueHolder> buffs) {\n-        for (PlayerBuffValueHolder mbsvh : buffs) {\n-            mbsvh.effect.silentApplyBuff(this, mbsvh.startTime);\n+    public void silentGiveBuffs(List<Pair<Long, PlayerBuffValueHolder>> buffs) {\n+        for (Pair<Long, PlayerBuffValueHolder> mbsv : buffs) {\n+            PlayerBuffValueHolder mbsvh = mbsv.getRight();\n+            mbsvh.effect.silentApplyBuff(this, mbsv.getLeft());\n         }\n     }\n "}, {"sha": "2798aaaa0d109adf5b8501d3114d988b5e44e330", "filename": "src/constants/ServerConstants.java", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/28258530e4920ad5eb6a12f64d099ed6f64d9f87/src/constants/ServerConstants.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/28258530e4920ad5eb6a12f64d099ed6f64d9f87/src/constants/ServerConstants.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/constants/ServerConstants.java?ref=28258530e4920ad5eb6a12f64d099ed6f64d9f87", "patch": "@@ -49,6 +49,7 @@\n     public static final boolean USE_REFRESH_RANK_MOVE = true;\n     public static final boolean USE_ENFORCE_MDOOR_POSITION = true;  //Forces mystic door to be spawned near spawnpoints. (since things bugs out other way, and this helps players to locate the door faster)\n     public static final boolean USE_ERASE_UNTRADEABLE_DROP = true;  //Forces flagged untradeable items to disappear when dropped.\n+    public static final boolean USE_ERASE_PET_ON_EXPIRATION = false;//Forces pets to be removed from inventory when expire time comes, rather than converting it to a doll.\n     public static final boolean USE_BUFF_MOST_SIGNIFICANT = true;   //When applying buffs, the player will stick with the highest stat boost among the listed, rather than overwriting stats.\n     \n     //Server Rates And Experience"}, {"sha": "1bdb882c8d4459f810c76df9e815380df55f2e9b", "filename": "src/net/PacketProcessor.java", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/28258530e4920ad5eb6a12f64d099ed6f64d9f87/src/net/PacketProcessor.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/28258530e4920ad5eb6a12f64d099ed6f64d9f87/src/net/PacketProcessor.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/PacketProcessor.java?ref=28258530e4920ad5eb6a12f64d099ed6f64d9f87", "patch": "@@ -245,6 +245,7 @@ public void reset(int channel) {\n             registerHandler(RecvOpcode.MONSTER_CARNIVAL, new MonsterCarnivalHandler());\n             registerHandler(RecvOpcode.REMOTE_STORE, new RemoteStoreHandler());\n             registerHandler(RecvOpcode.WEDDING_ACTION, new WeddingHandler());\n+            registerHandler(RecvOpcode.WATER_OF_LIFE, new UseWaterOfLifeHandler());\n             registerHandler(RecvOpcode.ADMIN_CHAT, new AdminChatHandler());\n             registerHandler(RecvOpcode.MOVE_DRAGON, new MoveDragonHandler());\n         }"}, {"sha": "46aadc06e0c4f824cc6bd4763e6837f791edad90", "filename": "src/net/RecvOpcode.java", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/28258530e4920ad5eb6a12f64d099ed6f64d9f87/src/net/RecvOpcode.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/28258530e4920ad5eb6a12f64d099ed6f64d9f87/src/net/RecvOpcode.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/RecvOpcode.java?ref=28258530e4920ad5eb6a12f64d099ed6f64d9f87", "patch": "@@ -116,6 +116,7 @@\n     USE_ITEM_REWARD(0x70),\n     MAKER_SKILL(0x71),\n     USE_REMOTE(0x74),\n+    WATER_OF_LIFE(0x75),\n     ADMIN_CHAT(0x76),\n     PARTYCHAT(0x77),\n     WHISPER(0x78),"}, {"sha": "af5874971c2aeeeb9a263cfed5ec255b344ac9c1", "filename": "src/net/server/PlayerBuffValueHolder.java", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/28258530e4920ad5eb6a12f64d099ed6f64d9f87/src/net/server/PlayerBuffValueHolder.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/28258530e4920ad5eb6a12f64d099ed6f64d9f87/src/net/server/PlayerBuffValueHolder.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/PlayerBuffValueHolder.java?ref=28258530e4920ad5eb6a12f64d099ed6f64d9f87", "patch": "@@ -28,11 +28,11 @@\n  * @author Danny\n  */\n public class PlayerBuffValueHolder {\n-    public long startTime;\n+    public int usedTime;\n     public MapleStatEffect effect;\n \n-    public PlayerBuffValueHolder(long startTime, MapleStatEffect effect) {\n-        this.startTime = startTime;\n+    public PlayerBuffValueHolder(int usedTime, MapleStatEffect effect) {\n+        this.usedTime = usedTime;\n         this.effect = effect;\n     }\n }"}, {"sha": "23c421e59deb19e36fe10c52cdfef882315ce267", "filename": "src/net/server/channel/handlers/CancelBuffHandler.java", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/28258530e4920ad5eb6a12f64d099ed6f64d9f87/src/net/server/channel/handlers/CancelBuffHandler.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/28258530e4920ad5eb6a12f64d099ed6f64d9f87/src/net/server/channel/handlers/CancelBuffHandler.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/channel/handlers/CancelBuffHandler.java?ref=28258530e4920ad5eb6a12f64d099ed6f64d9f87", "patch": "@@ -41,7 +41,6 @@\n     @Override\n     public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c) {\n         int sourceid = slea.readInt();\n-        if(sourceid < 0) sourceid = -sourceid;  //oh my...\n         \n         switch (sourceid) {\n             case FPArchMage.BIG_BANG:"}, {"sha": "6bdddcd6060375b867526829dc18f2d146d08cb4", "filename": "src/net/server/channel/handlers/PlayerLoggedinHandler.java", "status": "modified", "additions": 25, "deletions": 1, "changes": 26, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/28258530e4920ad5eb6a12f64d099ed6f64d9f87/src/net/server/channel/handlers/PlayerLoggedinHandler.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/28258530e4920ad5eb6a12f64d099ed6f64d9f87/src/net/server/channel/handlers/PlayerLoggedinHandler.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/channel/handlers/PlayerLoggedinHandler.java?ref=28258530e4920ad5eb6a12f64d099ed6f64d9f87", "patch": "@@ -25,6 +25,7 @@\n import java.sql.PreparedStatement;\n import java.sql.ResultSet;\n import java.sql.SQLException;\n+import java.util.ArrayList;\n import java.util.List;\n \n import net.AbstractMaplePacketHandler;\n@@ -39,9 +40,11 @@\n import net.server.world.World;\n import tools.DatabaseConnection;\n import tools.MaplePacketCreator;\n+import tools.Pair;\n import tools.data.input.SeekableLittleEndianAccessor;\n import client.BuddylistEntry;\n import client.CharacterNameAndId;\n+import client.MapleBuffStat;\n import client.MapleCharacter;\n import client.MapleClient;\n import client.MapleFamily;\n@@ -50,6 +53,8 @@\n import client.inventory.MaplePet;\n import constants.GameConstants;\n import constants.ServerConstants;\n+import java.util.Collections;\n+import java.util.Comparator;\n \n public final class PlayerLoggedinHandler extends AbstractMaplePacketHandler {\n \n@@ -107,7 +112,8 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n         \n         List<PlayerBuffValueHolder> buffs = server.getPlayerBuffStorage().getBuffsFromStorage(cid);\n         if (buffs != null) {\n-            player.silentGiveBuffs(buffs);\n+            List<Pair<Long, PlayerBuffValueHolder>> timedBuffs = getLocalStartTimes(buffs);\n+            player.silentGiveBuffs(timedBuffs);\n         }\n         Connection con = null;\n         PreparedStatement ps = null;\n@@ -286,4 +292,22 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n         \n         player.receivePartyMemberHP();\n     }\n+    \n+    private List<Pair<Long, PlayerBuffValueHolder>> getLocalStartTimes(List<PlayerBuffValueHolder> lpbvl) {\n+        List<Pair<Long, PlayerBuffValueHolder>> timedBuffs = new ArrayList<>();\n+        long curtime = System.currentTimeMillis();\n+        \n+        for(PlayerBuffValueHolder pb : lpbvl) {\n+            timedBuffs.add(new Pair<>(curtime - pb.usedTime, pb));\n+        }\n+        \n+        Collections.sort(timedBuffs, new Comparator<Pair<Long, PlayerBuffValueHolder>>() {\n+            @Override\n+            public int compare(Pair<Long, PlayerBuffValueHolder> p1, Pair<Long, PlayerBuffValueHolder> p2) {\n+                return p1.getLeft().compareTo(p2.getLeft());\n+            }\n+        });\n+        \n+        return timedBuffs;\n+    }\n }"}, {"sha": "49439db7d6a4963dc1492e0e3b2c8e6d3acdf905", "filename": "src/net/server/channel/handlers/UseWaterOfLifeHandler.java", "status": "added", "additions": 34, "deletions": 0, "changes": 34, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/28258530e4920ad5eb6a12f64d099ed6f64d9f87/src/net/server/channel/handlers/UseWaterOfLifeHandler.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/28258530e4920ad5eb6a12f64d099ed6f64d9f87/src/net/server/channel/handlers/UseWaterOfLifeHandler.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/channel/handlers/UseWaterOfLifeHandler.java?ref=28258530e4920ad5eb6a12f64d099ed6f64d9f87", "patch": "@@ -0,0 +1,34 @@\n+/*\n+ This file is part of the OdinMS Maple Story Server\n+ Copyright (C) 2008 Patrick Huy <patrick.huy@frz.cc>\n+ Matthias Butz <matze@odinms.de>\n+ Jan Christian Meyer <vimes@odinms.de>\n+\n+ This program is free software: you can redistribute it and/or modify\n+ it under the terms of the GNU Affero General Public License as\n+ published by the Free Software Foundation version 3 as published by\n+ the Free Software Foundation. You may not use, modify or distribute\n+ this program under any other version of the GNU Affero General Public\n+ License.\n+\n+ This program is distributed in the hope that it will be useful,\n+ but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+ GNU Affero General Public License for more details.\n+\n+ You should have received a copy of the GNU Affero General Public License\n+ along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+ */\n+package net.server.channel.handlers;\n+\n+import client.MapleClient;\n+import net.AbstractMaplePacketHandler;\n+import tools.data.input.SeekableLittleEndianAccessor;\n+\n+public final class UseWaterOfLifeHandler extends AbstractMaplePacketHandler {\n+\n+    @Override\n+    public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c) {\n+        c.getAbstractPlayerInteraction().openNpc(1032102, \"waterOfLife\");\n+    }\n+}\n\\ No newline at end of file"}, {"sha": "833994943bd27af302fcaec979d52a7a55512bba", "filename": "src/scripting/AbstractPlayerInteraction.java", "status": "modified", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/28258530e4920ad5eb6a12f64d099ed6f64d9f87/src/scripting/AbstractPlayerInteraction.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/28258530e4920ad5eb6a12f64d099ed6f64d9f87/src/scripting/AbstractPlayerInteraction.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/scripting/AbstractPlayerInteraction.java?ref=28258530e4920ad5eb6a12f64d099ed6f64d9f87", "patch": "@@ -901,4 +901,21 @@ public MapleExpedition getExpedition(MapleExpeditionType type) {\n         public long getJailTimeLeft() {\n                 return getPlayer().getJailExpirationTimeLeft();\n         }\n+        \n+        public List<MaplePet> getDriedPets() {\n+                List<MaplePet> list = new LinkedList<>();\n+            \n+                long curTime = System.currentTimeMillis();\n+                for(Item it : getPlayer().getInventory(MapleInventoryType.CASH).list()) {\n+                        if(ItemConstants.isPet(it.getItemId()) && it.getExpiration() < curTime) {\n+                                MaplePet pet = it.getPet();\n+                                if (pet != null) {\n+                                        list.add(pet);\n+                                }\n+                        }\n+                }\n+                \n+                return list;\n+        }\n+        \n }"}, {"sha": "31903ab2f73caee7cb5dd3b64e9647bebd61f506", "filename": "src/server/MapleStatEffect.java", "status": "modified", "additions": 3, "deletions": 5, "changes": 8, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/28258530e4920ad5eb6a12f64d099ed6f64d9f87/src/server/MapleStatEffect.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/28258530e4920ad5eb6a12f64d099ed6f64d9f87/src/server/MapleStatEffect.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/MapleStatEffect.java?ref=28258530e4920ad5eb6a12f64d099ed6f64d9f87", "patch": "@@ -978,16 +978,14 @@ private Rectangle calculateBoundingBox(Point posFrom, boolean facingLeft) {\n         Rectangle bounds = new Rectangle(mylt.x, mylt.y, myrb.x - mylt.x, myrb.y - mylt.y);\n         return bounds;\n     }\n-\n-    public void silentApplyBuff(MapleCharacter chr, long starttime) {\n+    \n+    public void silentApplyBuff(MapleCharacter chr, long localStartTime) {\n         int localDuration = duration;\n         localDuration = alchemistModifyVal(chr, localDuration, false);\n         //CancelEffectAction cancelAction = new CancelEffectAction(chr, this, starttime);\n         //ScheduledFuture<?> schedule = TimerManager.getInstance().schedule(cancelAction, ((starttime + localDuration) - System.currentTimeMillis()));\n         \n-        if(starttime + localDuration <= System.currentTimeMillis()) return;\n-        \n-        chr.registerEffect(this, starttime, (starttime + localDuration), true);\n+        chr.registerEffect(this, localStartTime, localStartTime + localDuration, true);\n         SummonMovementType summonMovementType = getSummonMovementType();\n         if (summonMovementType != null) {\n             final MapleSummon tosummon = new MapleSummon(chr, sourceid, chr.getPosition(), summonMovementType);"}, {"sha": "3f24f0770985eaca85e36c0110e3b7fa1c9b7db0", "filename": "wz/Etc.wz/Commodity.img.xml", "status": "modified", "additions": 60, "deletions": 1, "changes": 61, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/28258530e4920ad5eb6a12f64d099ed6f64d9f87/wz/Etc.wz/Commodity.img.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/28258530e4920ad5eb6a12f64d099ed6f64d9f87/wz/Etc.wz/Commodity.img.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/wz/Etc.wz/Commodity.img.xml?ref=28258530e4920ad5eb6a12f64d099ed6f64d9f87", "patch": "@@ -83731,7 +83731,7 @@\n   </imgdir>\n   <imgdir name=\"8166\">\n     <int name=\"SN\" value=\"60000002\"/>\n-    <int name=\"ItemId\" value=\"5000014\"/>\n+    <int name=\"ItemId\" value=\"5000015\"/>\n     <int name=\"Count\" value=\"1\"/>\n     <int name=\"Price\" value=\"6700\"/>\n     <int name=\"Period\" value=\"0\"/>\n@@ -91605,11 +91605,70 @@\n     <int name=\"Period\" value=\"90\"/>\n     <int name=\"OnSale\" value=\"0\"/>\n   </imgdir>\n+  <imgdir name=\"8941\">\n+    <int name=\"Count\" value=\"1\"/>\n+    <int name=\"Gender\" value=\"2\"/>\n+    <int name=\"ItemId\" value=\"5000013\"/>\n+    <int name=\"OnSale\" value=\"1\"/>\n+    <int name=\"Period\" value=\"90\"/>\n+    <int name=\"Price\" value=\"5900\"/>\n+    <int name=\"Priority\" value=\"7\"/>\n+    <int name=\"SN\" value=\"60001000\"/>\n+  </imgdir>\n   <imgdir name=\"8940\">\n     <int name=\"SN\" value=\"92000020\"/>\n     <int name=\"ItemId\" value=\"5041000\"/>\n     <int name=\"Count\" value=\"2\"/>\n     <int name=\"Period\" value=\"90\"/>\n     <int name=\"OnSale\" value=\"0\"/>\n   </imgdir>\n+  <imgdir name=\"8946\">\n+    <int name=\"Count\" value=\"1\"/>\n+    <int name=\"Gender\" value=\"2\"/>\n+    <int name=\"ItemId\" value=\"5000060\"/>\n+    <int name=\"OnSale\" value=\"1\"/>\n+    <int name=\"Price\" value=\"20000\"/>\n+    <int name=\"Priority\" value=\"6\"/>\n+    <int name=\"SN\" value=\"60001005\"/>\n+  </imgdir>\n+  <imgdir name=\"8945\">\n+    <int name=\"Count\" value=\"1\"/>\n+    <int name=\"Gender\" value=\"2\"/>\n+    <int name=\"ItemId\" value=\"5000034\"/>\n+    <int name=\"OnSale\" value=\"1\"/>\n+    <int name=\"Period\" value=\"90\"/>\n+    <int name=\"Price\" value=\"5800\"/>\n+    <int name=\"Priority\" value=\"7\"/>\n+    <int name=\"SN\" value=\"60001004\"/>\n+  </imgdir>\n+  <imgdir name=\"8944\">\n+    <int name=\"Count\" value=\"1\"/>\n+    <int name=\"Gender\" value=\"2\"/>\n+    <int name=\"ItemId\" value=\"5000045\"/>\n+    <int name=\"OnSale\" value=\"1\"/>\n+    <int name=\"Period\" value=\"90\"/>\n+    <int name=\"Price\" value=\"5600\"/>\n+    <int name=\"Priority\" value=\"7\"/>\n+    <int name=\"SN\" value=\"60001003\"/>\n+  </imgdir>\n+  <imgdir name=\"8943\">\n+    <int name=\"Count\" value=\"1\"/>\n+    <int name=\"Gender\" value=\"2\"/>\n+    <int name=\"ItemId\" value=\"5000044\"/>\n+    <int name=\"OnSale\" value=\"1\"/>\n+    <int name=\"Period\" value=\"90\"/>\n+    <int name=\"Price\" value=\"6900\"/>\n+    <int name=\"Priority\" value=\"7\"/>\n+    <int name=\"SN\" value=\"60001002\"/>\n+  </imgdir>\n+  <imgdir name=\"8942\">\n+    <int name=\"Count\" value=\"1\"/>\n+    <int name=\"Gender\" value=\"2\"/>\n+    <int name=\"ItemId\" value=\"5000039\"/>\n+    <int name=\"OnSale\" value=\"1\"/>\n+    <int name=\"Period\" value=\"90\"/>\n+    <int name=\"Price\" value=\"5800\"/>\n+    <int name=\"Priority\" value=\"7\"/>\n+    <int name=\"SN\" value=\"60001001\"/>\n+  </imgdir>\n </imgdir>"}]}]},
