{"fetchDate": "2019-12-19", "content": [{"sha": "c17e4c93a388b5f3ecffae990318c381b1d68cf0", "node_id": "MDY6Q29tbWl0NDUwODIwMjM6YzE3ZTRjOTNhMzg4YjVmM2VjZmZhZTk5MDMxOGMzODFiMWQ2OGNmMA==", "commit": {"author": {"name": "ronancpl", "email": "rcpl2010@gmail.com", "date": "2017-04-17T18:44:12Z"}, "committer": {"name": "ronancpl", "email": "rcpl2010@gmail.com", "date": "2017-04-17T18:44:12Z"}, "message": "Hit Reactor animation fix + deny spawn points\n\nFixed reactor sometimes not animating between state changes and\nintroduced mechanic to deny spawning mobs at spawn points.", "tree": {"sha": "efc77f5506bdc8e0bc3f52314e8eeba2e252d4c2", "url": "https://api.github.com/repos/ronancpl/HeavenMS/git/trees/efc77f5506bdc8e0bc3f52314e8eeba2e252d4c2"}, "url": "https://api.github.com/repos/ronancpl/HeavenMS/git/commits/c17e4c93a388b5f3ecffae990318c381b1d68cf0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/c17e4c93a388b5f3ecffae990318c381b1d68cf0", "html_url": "https://github.com/ronancpl/HeavenMS/commit/c17e4c93a388b5f3ecffae990318c381b1d68cf0", "comments_url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/c17e4c93a388b5f3ecffae990318c381b1d68cf0/comments", "author": {"login": "ronancpl", "id": 9257761, "node_id": "MDQ6VXNlcjkyNTc3NjE=", "avatar_url": "https://avatars2.githubusercontent.com/u/9257761?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ronancpl", "html_url": "https://github.com/ronancpl", "followers_url": "https://api.github.com/users/ronancpl/followers", "following_url": "https://api.github.com/users/ronancpl/following{/other_user}", "gists_url": "https://api.github.com/users/ronancpl/gists{/gist_id}", "starred_url": "https://api.github.com/users/ronancpl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ronancpl/subscriptions", "organizations_url": "https://api.github.com/users/ronancpl/orgs", "repos_url": "https://api.github.com/users/ronancpl/repos", "events_url": "https://api.github.com/users/ronancpl/events{/privacy}", "received_events_url": "https://api.github.com/users/ronancpl/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ronancpl", "id": 9257761, "node_id": "MDQ6VXNlcjkyNTc3NjE=", "avatar_url": "https://avatars2.githubusercontent.com/u/9257761?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ronancpl", "html_url": "https://github.com/ronancpl", "followers_url": "https://api.github.com/users/ronancpl/followers", "following_url": "https://api.github.com/users/ronancpl/following{/other_user}", "gists_url": "https://api.github.com/users/ronancpl/gists{/gist_id}", "starred_url": "https://api.github.com/users/ronancpl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ronancpl/subscriptions", "organizations_url": "https://api.github.com/users/ronancpl/orgs", "repos_url": "https://api.github.com/users/ronancpl/repos", "events_url": "https://api.github.com/users/ronancpl/events{/privacy}", "received_events_url": "https://api.github.com/users/ronancpl/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6791a3d47567a59d7d02803ae82d8ade3a948987", "url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/6791a3d47567a59d7d02803ae82d8ade3a948987", "html_url": "https://github.com/ronancpl/HeavenMS/commit/6791a3d47567a59d7d02803ae82d8ade3a948987"}], "stats": {"total": 451, "additions": 347, "deletions": 104}, "files": [{"sha": "8e87b39dc0331f6f858331cc33f3ecc527f8c770", "filename": "mychanges_ptbr.txt", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/c17e4c93a388b5f3ecffae990318c381b1d68cf0/mychanges_ptbr.txt", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/c17e4c93a388b5f3ecffae990318c381b1d68cf0/mychanges_ptbr.txt", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/mychanges_ptbr.txt?ref=c17e4c93a388b5f3ecffae990318c381b1d68cf0", "patch": "@@ -151,4 +151,7 @@ Adi\n Adi\ufffd\ufffdo de expedi\ufffd\ufffdes PiratePQ e EllinPQ.\n \n 11 - 12 Abril 2017,\n-Implementa\ufffd\ufffdo do PiratePQ.\n\\ No newline at end of file\n+Implementa\ufffd\ufffdo do PiratePQ.\n+\n+17 Abril 2017,\n+Corre\ufffd\ufffdo de bugs envolvendo reactors no PiratePQ, e potencialmente em outros pontos tamb\ufffdm.\n\\ No newline at end of file"}, {"sha": "bf7c8c57d62c6f3d760fcb95f8e457b07c76aa1f", "filename": "nbproject/private/private.xml", "status": "modified", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/c17e4c93a388b5f3ecffae990318c381b1d68cf0/nbproject/private/private.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/c17e4c93a388b5f3ecffae990318c381b1d68cf0/nbproject/private/private.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/nbproject/private/private.xml?ref=c17e4c93a388b5f3ecffae990318c381b1d68cf0", "patch": "@@ -3,6 +3,21 @@\n     <editor-bookmarks xmlns=\"http://www.netbeans.org/ns/editor-bookmarks/2\" lastBookmarkId=\"0\"/>\n     <open-files xmlns=\"http://www.netbeans.org/ns/projectui-open-files/2\">\n         <group>\n+            <file>file:/C:/Nexon/MapleSolaxia/src/scripting/reactor/ReactorActionManager.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/scripts/reactor/2519003.js</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/src/tools/data/output/GenericLittleEndianWriter.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/scripts/reactor/2519002.js</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/scripts/reactor/2519001.js</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/src/server/maps/MapleMapFactory.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/src/client/command/Commands.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/src/client/MapleCharacter.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/src/tools/MaplePacketCreator.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/scripts/reactor/2519000.js</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/src/server/life/SpawnPoint.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/src/server/maps/MapleReactorStats.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/src/scripting/reactor/ReactorScriptManager.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/src/constants/ServerConstants.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/src/server/maps/MapleReactor.java</file>\n             <file>file:/C:/Nexon/MapleSolaxia/src/server/maps/MapleMap.java</file>\n         </group>\n     </open-files>"}, {"sha": "2c1afd8b2ccb809850f70770f1a4f1487d85dad6", "filename": "scripts/reactor/2519000.js", "status": "modified", "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/c17e4c93a388b5f3ecffae990318c381b1d68cf0/scripts/reactor/2519000.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/c17e4c93a388b5f3ecffae990318c381b1d68cf0/scripts/reactor/2519000.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/reactor/2519000.js?ref=c17e4c93a388b5f3ecffae990318c381b1d68cf0", "patch": "@@ -23,6 +23,13 @@\n  *@author Ronan\n  */\n  \n+importPackage(Packages.tools);\n+importPackage(java.awt);\n+ \n function act() {\n-    rm.getPlayer().getMap().setAllowSpawnPointInRange(false, rm.getReactor().getPosition(), 120.0);\n-}\n+    var denyWidth = 320, denyHeight = 150;\n+    var denyPos = rm.getReactor().getPosition();\n+    var denyArea = new Rectangle(denyPos.getX() - denyWidth / 2, denyPos.getY() - denyHeight / 2, denyWidth, denyHeight);\n+    \n+    rm.getReactor().getMap().setAllowSpawnPointInBox(false, denyArea);\n+}\n\\ No newline at end of file"}, {"sha": "4694f1bd655829f210ba76f8b29e043d3a4499bd", "filename": "scripts/reactor/2519001.js", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/c17e4c93a388b5f3ecffae990318c381b1d68cf0/scripts/reactor/2519001.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/c17e4c93a388b5f3ecffae990318c381b1d68cf0/scripts/reactor/2519001.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/reactor/2519001.js?ref=c17e4c93a388b5f3ecffae990318c381b1d68cf0", "patch": "@@ -23,6 +23,13 @@\n  *@author Ronan\n  */\n  \n+importPackage(Packages.tools);\n+importPackage(java.awt);\n+ \n function act() {\n-    rm.getPlayer().getMap().setAllowSpawnPointInRange(false, rm.getReactor().getPosition(), 120.0);\n+    var denyWidth = 320, denyHeight = 150;\n+    var denyPos = rm.getReactor().getPosition();\n+    var denyArea = new Rectangle(denyPos.getX() - denyWidth / 2, denyPos.getY() - denyHeight / 2, denyWidth, denyHeight);\n+    \n+    rm.getReactor().getMap().setAllowSpawnPointInBox(false, denyArea);\n }"}, {"sha": "c62b1807c8d1d49601ab8f45272cdc913b4ac50a", "filename": "scripts/reactor/2519002.js", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/c17e4c93a388b5f3ecffae990318c381b1d68cf0/scripts/reactor/2519002.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/c17e4c93a388b5f3ecffae990318c381b1d68cf0/scripts/reactor/2519002.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/reactor/2519002.js?ref=c17e4c93a388b5f3ecffae990318c381b1d68cf0", "patch": "@@ -23,6 +23,13 @@\n  *@author Ronan\n  */\n  \n+importPackage(Packages.tools);\n+importPackage(java.awt);\n+ \n function act() {\n-    rm.getPlayer().getMap().setAllowSpawnPointInRange(false, rm.getReactor().getPosition(), 120.0);\n+    var denyWidth = 320, denyHeight = 150;\n+    var denyPos = rm.getReactor().getPosition();\n+    var denyArea = new Rectangle(denyPos.getX() - denyWidth / 2, denyPos.getY() - denyHeight / 2, denyWidth, denyHeight);\n+    \n+    rm.getReactor().getMap().setAllowSpawnPointInBox(false, denyArea);\n }"}, {"sha": "792cc95287c14c3620a8da0d8c380e332c49e783", "filename": "scripts/reactor/2519003.js", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/c17e4c93a388b5f3ecffae990318c381b1d68cf0/scripts/reactor/2519003.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/c17e4c93a388b5f3ecffae990318c381b1d68cf0/scripts/reactor/2519003.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/reactor/2519003.js?ref=c17e4c93a388b5f3ecffae990318c381b1d68cf0", "patch": "@@ -23,6 +23,13 @@\n  *@author Ronan\n  */\n  \n+importPackage(Packages.tools);\n+importPackage(java.awt);\n+ \n function act() {\n-    rm.getPlayer().getMap().setAllowSpawnPointInRange(false, rm.getReactor().getPosition(), 120.0);\n+    var denyWidth = 320, denyHeight = 150;\n+    var denyPos = rm.getReactor().getPosition();\n+    var denyArea = new Rectangle(denyPos.getX() - denyWidth / 2, denyPos.getY() - denyHeight / 2, denyWidth, denyHeight);\n+    \n+    rm.getReactor().getMap().setAllowSpawnPointInBox(false, denyArea);\n }"}, {"sha": "4c075230b90dd341136a9a08dfa4ce8c71ffdd84", "filename": "src/client/command/Commands.java", "status": "modified", "additions": 9, "deletions": 1, "changes": 10, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/c17e4c93a388b5f3ecffae990318c381b1d68cf0/src/client/command/Commands.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/c17e4c93a388b5f3ecffae990318c381b1d68cf0/src/client/command/Commands.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/Commands.java?ref=c17e4c93a388b5f3ecffae990318c381b1d68cf0", "patch": "@@ -315,7 +315,7 @@ public static boolean executePlayerCommand(MapleClient c, String[] sub, char hea\n \t\t\treturn false;\n \t\t}\n \t\tswitch (sub[0]) {\n-\t\tcase \"help\":\n+                case \"help\":\n \t\tcase \"commands\":\n \t\t\tplayer.yellowMessage(\"After you vote, talk to Rooney to get a leaf and redeem it for prizes!\");\n \t\t\tplayer.message(\"@dispose: Fixes your character if it is stuck.\");\n@@ -636,6 +636,14 @@ public static boolean executePlayerCommand(MapleClient c, String[] sub, char hea\n \t\t\t\t}\n \t\t\t}\n \t\t\tbreak;\n+                    \n+                //debug only\n+                case \"map\":\n+                        if(ServerConstants.USE_DEBUG) {\n+                            player.dropMessage(\"Current map position: (\" + player.getPosition().getX() + \", \" + player.getPosition().getY() + \").\");\n+                            break;\n+                        }\n+                    \n \t\tdefault:\n \t\t\tif (player.gmLevel() == 0) {\n \t\t\t\tplayer.yellowMessage(\"Player Command \" + heading + sub[0] + \" does not exist, see @help for a list of commands.\");"}, {"sha": "670f58cd1a23d365010c27d00f875f62271128ef", "filename": "src/constants/ServerConstants.java", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/c17e4c93a388b5f3ecffae990318c381b1d68cf0/src/constants/ServerConstants.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/c17e4c93a388b5f3ecffae990318c381b1d68cf0/src/constants/ServerConstants.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/constants/ServerConstants.java?ref=c17e4c93a388b5f3ecffae990318c381b1d68cf0", "patch": "@@ -24,7 +24,7 @@\n     public static boolean JAVA_8;\n     public static boolean SHUTDOWNHOOK;\n     //Gameplay Configurations\n-    public static final boolean USE_MAXRANGE = true;            //will send and receive packets from all events of a map.\n+    public static final boolean USE_MAXRANGE = true;        //will send and receive packets from all events of a map, rather than those of only view range.\n     public static final boolean USE_DEBUG = true;\n     public static final boolean USE_MTS = false;\n     public static final boolean USE_FAMILY_SYSTEM = false;"}, {"sha": "d502ee464f51f94579f0b0a337d264ec39fd9515", "filename": "src/net/server/channel/handlers/ReactorHitHandler.java", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/c17e4c93a388b5f3ecffae990318c381b1d68cf0/src/net/server/channel/handlers/ReactorHitHandler.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/c17e4c93a388b5f3ecffae990318c381b1d68cf0/src/net/server/channel/handlers/ReactorHitHandler.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/channel/handlers/ReactorHitHandler.java?ref=c17e4c93a388b5f3ecffae990318c381b1d68cf0", "patch": "@@ -41,7 +41,7 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n         int skillid = slea.readInt();\n         MapleReactor reactor = c.getPlayer().getMap().getReactorByOid(oid);\n         if (reactor != null && reactor.isAlive()) {\n-            reactor.hitReactor(charPos, stance, skillid,c);\n+            reactor.hitReactor(charPos, stance, skillid, c, false);\n         }\n     }\n }"}, {"sha": "3288dd69d8c1e1788821b05aff106b1ba648e444", "filename": "src/server/life/SpawnPoint.java", "status": "modified", "additions": 7, "deletions": 3, "changes": 10, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/c17e4c93a388b5f3ecffae990318c381b1d68cf0/src/server/life/SpawnPoint.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/c17e4c93a388b5f3ecffae990318c381b1d68cf0/src/server/life/SpawnPoint.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/life/SpawnPoint.java?ref=c17e4c93a388b5f3ecffae990318c381b1d68cf0", "patch": "@@ -31,7 +31,7 @@\n     private long nextPossibleSpawn;\n     private int mobInterval = 5000;\n     private AtomicInteger spawnedMonsters = new AtomicInteger(0);\n-    private boolean immobile;\n+    private boolean immobile, denySpawn = false;\n \n     public SpawnPoint(final MapleMonster monster, Point pos, boolean immobile, int mobTime, int mobInterval, int team) {\n         this.monster = monster.getId();\n@@ -50,11 +50,15 @@ public int getSpawned() {\n     }\n     \n     public void setDenySpawn(boolean val) {\n-        spawnedMonsters.set((val == false) ? 0 : 1);\n+        denySpawn = val;\n+    }\n+    \n+    public boolean getDenySpawn() {\n+        return denySpawn;\n     }\n \n     public boolean shouldSpawn() {\n-    \tif (mobTime < 0 || spawnedMonsters.get() > 0) {\n+    \tif (denySpawn || mobTime < 0 || spawnedMonsters.get() > 0) {\n             return false;\n         }\n        "}, {"sha": "7bd34c9611a5ad874540cc5bcd8cf2d738ad99d1", "filename": "src/server/maps/MapleMap.java", "status": "modified", "additions": 62, "deletions": 34, "changes": 96, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/c17e4c93a388b5f3ecffae990318c381b1d68cf0/src/server/maps/MapleMap.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/c17e4c93a388b5f3ecffae990318c381b1d68cf0/src/server/maps/MapleMap.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/maps/MapleMap.java?ref=c17e4c93a388b5f3ecffae990318c381b1d68cf0", "patch": "@@ -290,7 +290,7 @@ private void spawnAndAddRangedMapObject(MapleMapObject mapobject, DelayedPacketC\n             this.mapobjects.put(curOID, mapobject);\n             for (MapleCharacter chr : characters) {\n                 if (condition == null || condition.canSpawn(chr)) {\n-                    if (chr.getPosition().distanceSq(mapobject.getPosition()) <= 722500) {\n+                    if (chr.getPosition().distanceSq(mapobject.getPosition()) <= getRangedDistance()) {\n                         packetbakery.sendPackets(chr.getClient());\n                         chr.addVisibleMapObject(mapobject);\n                     }\n@@ -310,7 +310,7 @@ private void spawnRangedMapObject(MapleMapObject mapobject, DelayedPacketCreatio\n             mapobject.setObjectId(curOID);\n             for (MapleCharacter chr : characters) {\n                 if (condition == null || condition.canSpawn(chr)) {\n-                    if (chr.getPosition().distanceSq(mapobject.getPosition()) <= 722500) {\n+                    if (chr.getPosition().distanceSq(mapobject.getPosition()) <= getRangedDistance()) {\n                         packetbakery.sendPackets(chr.getClient());\n                         chr.addVisibleMapObject(mapobject);\n                     }\n@@ -796,7 +796,14 @@ public void destroyReactor(int oid) {\n         broadcastMessage(MaplePacketCreator.destroyReactor(reactor));\n         reactor.setAlive(false);\n         removeMapObject(reactor);\n-        reactor.setTimerActive(false);\n+        \n+        reactor.lockReactor();\n+        try {\n+            reactor.setShouldCollect(true);\n+        } finally {\n+            reactor.unlockReactor();\n+        }\n+        \n         if (reactor.getDelay() > 0) {\n             tMan.schedule(new Runnable() {\n                 @Override\n@@ -814,7 +821,14 @@ public void resetReactors() {\n                 if (o.getType() == MapleMapObjectType.REACTOR) {\n                     final MapleReactor r = ((MapleReactor) o);\n                     r.setState((byte) 0);\n-                    r.setTimerActive(false);\n+                    \n+                    r.lockReactor();\n+                    try {\n+                        r.setShouldCollect(true);\n+                    } finally {\n+                        r.unlockReactor();\n+                    }\n+                    \n                     broadcastMessage(MaplePacketCreator.triggerReactor(r, 0));\n                 }\n             }\n@@ -1314,11 +1328,8 @@ private void activateItemReactors(final MapleMapItem drop, final MapleClient c)\n                 if (react.getReactItem((byte) 0).getLeft() == item.getItemId() && react.getReactItem((byte) 0).getRight() == item.getQuantity()) {\n \n                     if (react.getArea().contains(drop.getPosition())) {\n-                        if (!react.isTimerActive()) {\n-                            TimerManager.getInstance().schedule(new ActivateItemReactor(drop, react, c), 5000);\n-                            react.setTimerActive(true);\n-                            break;\n-                        }\n+                        TimerManager.getInstance().schedule(new ActivateItemReactor(drop, react, c), 5000);\n+                        break;\n                     }\n                 }\n             }\n@@ -1633,7 +1644,7 @@ public void removePlayer(MapleCharacter chr) {\n     public void broadcastMessage(final byte[] packet) {\n         broadcastMessage(null, packet, Double.POSITIVE_INFINITY, null);\n     }\n-\n+    \n     public void broadcastGMMessage(final byte[] packet) {\n         broadcastGMMessage(null, packet, Double.POSITIVE_INFINITY, null);\n     }\n@@ -1658,7 +1669,7 @@ public void broadcastMessage(MapleCharacter source, final byte[] packet, boolean\n      * @param ranged\n      */\n     public void broadcastMessage(MapleCharacter source, final byte[] packet, boolean repeatToSource, boolean ranged) {\n-        broadcastMessage(repeatToSource ? null : source, packet, ranged ? 722500 : Double.POSITIVE_INFINITY, source.getPosition());\n+        broadcastMessage(repeatToSource ? null : source, packet, ranged ? getRangedDistance() : Double.POSITIVE_INFINITY, source.getPosition());\n     }\n \n     /**\n@@ -1878,11 +1889,11 @@ public MapleCharacter getCharacterById(int id) {\n \n     private void updateMapObjectVisibility(MapleCharacter chr, MapleMapObject mo) {\n         if (!chr.isMapObjectVisible(mo)) { // monster entered view range\n-            if (mo.getType() == MapleMapObjectType.SUMMON || mo.getPosition().distanceSq(chr.getPosition()) <= 722500) {\n+            if (mo.getType() == MapleMapObjectType.SUMMON || mo.getPosition().distanceSq(chr.getPosition()) <= getRangedDistance()) {\n                 chr.addVisibleMapObject(mo);\n                 mo.sendSpawnData(chr.getClient());\n             }\n-        } else if (mo.getType() != MapleMapObjectType.SUMMON && mo.getPosition().distanceSq(chr.getPosition()) > 722500) {\n+        } else if (mo.getType() != MapleMapObjectType.SUMMON && mo.getPosition().distanceSq(chr.getPosition()) > getRangedDistance()) {\n             chr.removeVisibleMapObject(mo);\n             mo.sendDestroyData(chr.getClient());\n         }\n@@ -2081,30 +2092,38 @@ public ActivateItemReactor(MapleMapItem mapitem, MapleReactor reactor, MapleClie\n \n         @Override\n         public void run() {\n-            if (mapitem != null && mapitem == getMapObject(mapitem.getObjectId())) {\n-                mapitem.itemLock.lock();\n-                try {\n-                    TimerManager tMan = TimerManager.getInstance();\n-                    if (mapitem.isPickedUp()) {\n-                        return;\n-                    }\n-                    MapleMap.this.broadcastMessage(MaplePacketCreator.removeItemFromMap(mapitem.getObjectId(), 0, 0), mapitem.getPosition());\n-                    MapleMap.this.removeMapObject(mapitem);\n-                    reactor.hitReactor(c);\n-                    reactor.setTimerActive(false);\n-                    if (reactor.getDelay() > 0) {\n-                        tMan.schedule(new Runnable() {\n-                            @Override\n-                            public void run() {\n-                                reactor.setState((byte) 0);\n-                                broadcastMessage(MaplePacketCreator.triggerReactor(reactor, 0));\n-                            }\n-                        }, reactor.getDelay());\n+            reactor.lockReactor();\n+            try {\n+                if (reactor.getShouldCollect() == true && mapitem != null && mapitem == getMapObject(mapitem.getObjectId())) {\n+                    mapitem.itemLock.lock();\n+                    try {\n+                        TimerManager tMan = TimerManager.getInstance();\n+                        if (mapitem.isPickedUp()) {\n+                            return;\n+                        }\n+\n+                        reactor.setShouldCollect(false);\n+                        MapleMap.this.broadcastMessage(MaplePacketCreator.removeItemFromMap(mapitem.getObjectId(), 0, 0), mapitem.getPosition());\n+                        MapleMap.this.removeMapObject(mapitem);\n+                        reactor.hitReactor(c, true);\n+\n+                        if (reactor.getDelay() > 0) {\n+                            tMan.schedule(new Runnable() {\n+                                @Override\n+                                public void run() {\n+                                    reactor.setState((byte) 0);\n+                                    broadcastMessage(MaplePacketCreator.triggerReactor(reactor, 0));\n+                                }\n+                            }, reactor.getDelay());\n+                        }\n+                    } finally {\n+                        mapitem.itemLock.unlock();\n                     }\n-                } finally {\n-                    mapitem.itemLock.unlock();\n                 }\n             }\n+            finally {\n+                reactor.unlockReactor();\n+            }\n         }\n     }\n     \n@@ -2168,6 +2187,15 @@ public void respawn() {\n             chrRLock.unlock();\n         }\n         \n+        /*\n+        System.out.println(\"----------------------------------\");\n+        for (SpawnPoint spawnPoint : monsterSpawn) {\n+            System.out.println(\"sp \" + spawnPoint.getPosition().getX() + \", \" + spawnPoint.getPosition().getY() + \": \" + spawnPoint.getDenySpawn());\n+        }\n+        System.out.println(\"try \" + monsterSpawn.size() + \" - \" + spawnedMonstersOnMap.get());\n+        System.out.println(\"----------------------------------\");\n+        */\n+        \n         short numShouldSpawn = (short) ((monsterSpawn.size() - spawnedMonstersOnMap.get()));//Fking lol'd\n         if (numShouldSpawn > 0) {\n             List<SpawnPoint> randomSpawn = new ArrayList<>(monsterSpawn);"}, {"sha": "9f840d353b671b4ed783638325f073e10f0b6618", "filename": "src/server/maps/MapleReactor.java", "status": "modified", "additions": 75, "deletions": 52, "changes": 127, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/c17e4c93a388b5f3ecffae990318c381b1d68cf0/src/server/maps/MapleReactor.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/c17e4c93a388b5f3ecffae990318c381b1d68cf0/src/server/maps/MapleReactor.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/maps/MapleReactor.java?ref=c17e4c93a388b5f3ecffae990318c381b1d68cf0", "patch": "@@ -26,6 +26,8 @@\n \n import java.awt.Rectangle;\n import java.util.List;\n+import java.util.concurrent.locks.Lock;\n+import java.util.concurrent.locks.ReentrantLock;\n \n import scripting.reactor.ReactorScriptManager;\n import server.TimerManager;\n@@ -43,21 +45,30 @@\n     private int delay;\n     private MapleMap map;\n     private String name;\n-    private boolean timerActive;\n     private boolean alive;\n+    private boolean shouldCollect = true;\n+    private Lock reactorLock = new ReentrantLock(true);\n \n     public MapleReactor(MapleReactorStats stats, int rid) {\n         this.stats = stats;\n         this.rid = rid;\n         alive = true;\n     }\n-\n-    public void setTimerActive(boolean active) {\n-        this.timerActive = active;\n+    \n+    public void setShouldCollect(boolean collect) {\n+        this.shouldCollect = collect;\n     }\n-\n-    public boolean isTimerActive() {\n-        return timerActive;\n+    \n+    public boolean getShouldCollect() {\n+        return shouldCollect;\n+    }\n+    \n+    public void lockReactor() {\n+        reactorLock.lock();\n+    }\n+    \n+    public void unlockReactor() {\n+        reactorLock.unlock();\n     }\n \n     public void setState(byte state) {\n@@ -67,6 +78,10 @@ public void setState(byte state) {\n     public byte getState() {\n         return state;\n     }\n+    \n+    public MapleReactorStats getStats() {\n+        return stats;\n+    }\n \n     public int getId() {\n         return rid;\n@@ -129,67 +144,75 @@ public void sendSpawnData(MapleClient client) {\n \n     public void forceHitReactor(final byte newState) {\n         setState((byte) newState);\n-        setTimerActive(false);\n+        try {\n+            this.lockReactor();\n+            this.setShouldCollect(true);\n+        }\n+        finally {\n+            this.unlockReactor();\n+        }\n         map.broadcastMessage(MaplePacketCreator.triggerReactor(this, (short) 0));\n     }\n     \n     public void delayedHitReactor(final MapleClient c, long delay) {\n         TimerManager.getInstance().schedule(new Runnable() {\n             @Override\n             public void run() {\n-                hitReactor(c);\n+                hitReactor(c, false);\n             }\n         }, delay);\n     }\n \n-    public void hitReactor(MapleClient c) {\n-        hitReactor(0, (short) 0, 0, c);\n+    public void hitReactor(MapleClient c, boolean itemDrop) {\n+        hitReactor(0, (short) 0, 0, c, itemDrop);\n     }\n-\n-    public synchronized void hitReactor(int charPos, short stance, int skillid, MapleClient c) {\n-            try {\n-                    if(!this.isAlive()) {\n-                            return;\n-                    }\n-                    if(ServerConstants.USE_DEBUG == true) c.getPlayer().dropMessage(5, \"Hitted REACTOR \" + this.getId() + \" with POS \" + charPos + \" , STANCE \" + stance + \" , SkillID \" + skillid);\n-                    if (stats.getType(state) < 999 && stats.getType(state) != -1) {//type 2 = only hit from right (kerning swamp plants), 00 is air left 02 is ground left\n-                        if (!(stats.getType(state) == 2 && (stance == 0 || stance == 2))) { //get next state\t\n-                                    for (byte b = 0; b < stats.getStateSize(state); b++) {//YAY?\n-                                            List<Integer> activeSkills = stats.getActiveSkills(state, b);\n-                                            if (activeSkills != null) {\n-                                                    if (!activeSkills.contains(skillid)) continue;\n-                                            }\n-                                            state = stats.getNextState(state, b);\n-                                            if (stats.getNextState(state, b) == -1) {//end of reactor\n-                                                    if (stats.getType(state) < 100) {//reactor broken\n-                                                            if (delay > 0) {\n-                                                                    map.destroyReactor(getObjectId());\n-                                                            } else {//trigger as normal\n-                                                                    map.broadcastMessage(MaplePacketCreator.triggerReactor(this, stance));\n-                                                            }\n-                                                    } else {//item-triggered on final step\n-                                                            map.broadcastMessage(MaplePacketCreator.triggerReactor(this, stance));\n-                                                    }\n-\n-                                                    if(ServerConstants.USE_DEBUG == true) c.getPlayer().dropMessage(5, \"REACTOR \" + this.getId() + \" activated\");\n-                                                    ReactorScriptManager.getInstance().act(c, this);\n-                                            } else { //reactor not broken yet\n-                                                    map.broadcastMessage(MaplePacketCreator.triggerReactor(this, stance));\n-                                                    if (state == stats.getNextState(state, b)) {//current state = next state, looping reactor\n-                                                            ReactorScriptManager.getInstance().act(c, this);\n-                                                    }\n-                                            }\n-                                            break;\n-                                    }\n+    \n+    public synchronized void hitReactor(int charPos, short stance, int skillid, MapleClient c, boolean itemDrop) {\n+        try {\n+            if(!this.isAlive()) {\n+                return;\n+            }\n+            if(ServerConstants.USE_DEBUG == true) c.getPlayer().dropMessage(5, \"Hitted REACTOR \" + this.getId() + \" with POS \" + charPos + \" , STANCE \" + stance + \" , SkillID \" + skillid + \" , STATE \" + stats.getType(state) + \" STATESIZE \" + stats.getStateSize(state));\n+            int reactorType = stats.getType(state);\n+            \n+            if (reactorType < 999 && reactorType != -1) {//type 2 = only hit from right (kerning swamp plants), 00 is air left 02 is ground left\n+                if (!(reactorType == 2 && (stance == 0 || stance == 2))) { //get next state\n+                    for (byte b = 0; b < stats.getStateSize(state); b++) {//YAY?\n+                        List<Integer> activeSkills = stats.getActiveSkills(state, b);\n+                        if (activeSkills != null) {\n+                            if (!activeSkills.contains(skillid)) continue;\n+                        }\n+                        state = stats.getNextState(state, b);\n+                        if (stats.getNextState(state, b) == -1) {//end of reactor\n+                            if (reactorType < 100) {//reactor broken\n+                                if (delay > 0) {\n+                                    map.destroyReactor(getObjectId());\n+                                } else {//trigger as normal\n+                                    map.broadcastMessage(MaplePacketCreator.triggerReactor(this, stance));\n+                                }\n+                            } else {//item-triggered on final step\n+                                map.broadcastMessage(MaplePacketCreator.triggerReactor(this, stance));\n                             }\n-                    } else {\n-                            state++;\n-                            map.broadcastMessage(MaplePacketCreator.triggerReactor(this, stance));\n+                            \n                             ReactorScriptManager.getInstance().act(c, this);\n+                        } else { //reactor not broken yet\n+                            if (itemDrop) state++; // Duh, if the reactor is triggered by itemdrop, go directly to next state (in this case, instead of staying at 1, it goes to 2)! :)\n+                            map.broadcastMessage(MaplePacketCreator.triggerReactor(this, stance));\n+                            if (state == stats.getNextState(state, b) || itemDrop) {//current state = next state, looping reactor\n+                                ReactorScriptManager.getInstance().act(c, this);\n+                            }\n+                        }\n+                        break;\n                     }\n-            } catch(Exception e) {\n-                    e.printStackTrace();\n+                }\n+            } else {\n+                state++;\n+                map.broadcastMessage(MaplePacketCreator.triggerReactor(this, stance));\n+                ReactorScriptManager.getInstance().act(c, this);\n             }\n+        } catch(Exception e) {\n+            e.printStackTrace();\n+        }\n     }\n \n     public Rectangle getArea() {"}, {"sha": "a6ce2db854cb8789cf3ecf13260a2635adb6c1bb", "filename": "wz/Reactor.wz/2519000.img.xml", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/c17e4c93a388b5f3ecffae990318c381b1d68cf0/wz/Reactor.wz/2519000.img.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/c17e4c93a388b5f3ecffae990318c381b1d68cf0/wz/Reactor.wz/2519000.img.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/wz/Reactor.wz/2519000.img.xml?ref=c17e4c93a388b5f3ecffae990318c381b1d68cf0", "patch": "@@ -67,8 +67,8 @@\n     </imgdir>\n   </imgdir>\n   <imgdir name=\"1\">\n-    <canvas name=\"0\" width=\"1\" height=\"1\">\n-      <vector name=\"origin\" x=\"0\" y=\"0\"/>\n+    <canvas name=\"0\" width=\"100\" height=\"121\">\n+      <vector name=\"origin\" x=\"49\" y=\"121\"/>\n     </canvas>\n   </imgdir>\n   <string name=\"action\" value=\"davyScript0\"/>"}, {"sha": "9596befad77732ff3f2072c5fa625cbbaa12cb52", "filename": "wz/Reactor.wz/2519001.img.xml", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/c17e4c93a388b5f3ecffae990318c381b1d68cf0/wz/Reactor.wz/2519001.img.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/c17e4c93a388b5f3ecffae990318c381b1d68cf0/wz/Reactor.wz/2519001.img.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/wz/Reactor.wz/2519001.img.xml?ref=c17e4c93a388b5f3ecffae990318c381b1d68cf0", "patch": "@@ -67,8 +67,8 @@\n     </imgdir>\n   </imgdir>\n   <imgdir name=\"1\">\n-    <canvas name=\"0\" width=\"1\" height=\"1\">\n-      <vector name=\"origin\" x=\"0\" y=\"0\"/>\n+    <canvas name=\"0\" width=\"92\" height=\"124\">\n+      <vector name=\"origin\" x=\"47\" y=\"124\"/>\n     </canvas>\n   </imgdir>\n   <string name=\"action\" value=\"davyScript1\"/>"}, {"sha": "7fc97417ef169e6a4c04505adbec24a13c9fa906", "filename": "wz/Reactor.wz/2519002.img.xml", "status": "modified", "additions": 68, "deletions": 1, "changes": 69, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/c17e4c93a388b5f3ecffae990318c381b1d68cf0/wz/Reactor.wz/2519002.img.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/c17e4c93a388b5f3ecffae990318c381b1d68cf0/wz/Reactor.wz/2519002.img.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/wz/Reactor.wz/2519002.img.xml?ref=c17e4c93a388b5f3ecffae990318c381b1d68cf0", "patch": "@@ -2,7 +2,74 @@\n <imgdir name=\"2519002.img\">\n   <imgdir name=\"info\">\n     <string name=\"info\" value=\"\ud574\uc801\uc120 \ubb38\"/>\n-    <string name=\"link\" value=\"2519000\"/>\n   </imgdir>\n   <string name=\"action\" value=\"davyScript2\"/>\n+  <imgdir name=\"0\">\n+    <canvas name=\"0\" width=\"100\" height=\"121\">\n+      <vector name=\"origin\" x=\"49\" y=\"121\"/>\n+      <int name=\"z\" value=\"0\"/>\n+    </canvas>\n+    <imgdir name=\"event\">\n+      <imgdir name=\"0\">\n+        <int name=\"type\" value=\"100\"/>\n+        <int name=\"state\" value=\"1\"/>\n+        <string name=\"0\" value=\"4001117\"/>\n+        <int name=\"1\" value=\"1\"/>\n+        <vector name=\"lt\" x=\"-27\" y=\"-21\"/>\n+        <vector name=\"rb\" x=\"31\" y=\"7\"/>\n+      </imgdir>\n+    </imgdir>\n+    <imgdir name=\"hit\">\n+      <canvas name=\"0\" width=\"100\" height=\"121\">\n+        <vector name=\"origin\" x=\"49\" y=\"121\"/>\n+        <int name=\"z\" value=\"0\"/>\n+        <int name=\"delay\" value=\"130\"/>\n+      </canvas>\n+      <canvas name=\"1\" width=\"100\" height=\"121\">\n+        <vector name=\"origin\" x=\"49\" y=\"121\"/>\n+        <int name=\"z\" value=\"0\"/>\n+        <int name=\"delay\" value=\"130\"/>\n+      </canvas>\n+      <canvas name=\"2\" width=\"100\" height=\"121\">\n+        <vector name=\"origin\" x=\"49\" y=\"121\"/>\n+        <int name=\"z\" value=\"0\"/>\n+        <int name=\"delay\" value=\"130\"/>\n+      </canvas>\n+      <canvas name=\"3\" width=\"100\" height=\"121\">\n+        <vector name=\"origin\" x=\"49\" y=\"121\"/>\n+        <int name=\"z\" value=\"0\"/>\n+        <int name=\"delay\" value=\"130\"/>\n+      </canvas>\n+      <canvas name=\"4\" width=\"100\" height=\"121\">\n+        <vector name=\"origin\" x=\"49\" y=\"121\"/>\n+        <int name=\"z\" value=\"0\"/>\n+        <int name=\"delay\" value=\"130\"/>\n+      </canvas>\n+      <canvas name=\"5\" width=\"100\" height=\"121\">\n+        <vector name=\"origin\" x=\"49\" y=\"121\"/>\n+        <int name=\"z\" value=\"0\"/>\n+        <int name=\"delay\" value=\"130\"/>\n+      </canvas>\n+      <canvas name=\"6\" width=\"100\" height=\"121\">\n+        <vector name=\"origin\" x=\"49\" y=\"121\"/>\n+        <int name=\"z\" value=\"0\"/>\n+        <int name=\"delay\" value=\"130\"/>\n+      </canvas>\n+      <canvas name=\"7\" width=\"100\" height=\"121\">\n+        <vector name=\"origin\" x=\"49\" y=\"121\"/>\n+        <int name=\"z\" value=\"0\"/>\n+        <int name=\"delay\" value=\"130\"/>\n+      </canvas>\n+      <canvas name=\"8\" width=\"100\" height=\"121\">\n+        <vector name=\"origin\" x=\"49\" y=\"121\"/>\n+        <int name=\"z\" value=\"0\"/>\n+        <int name=\"delay\" value=\"130\"/>\n+      </canvas>\n+    </imgdir>\n+  </imgdir>\n+  <imgdir name=\"1\">\n+    <canvas name=\"0\" width=\"100\" height=\"121\">\n+      <vector name=\"origin\" x=\"49\" y=\"121\"/>\n+    </canvas>\n+  </imgdir>\n </imgdir>"}, {"sha": "257d7a6eb5d07684c2a5a401813b3c332efd576d", "filename": "wz/Reactor.wz/2519003.img.xml", "status": "modified", "additions": 68, "deletions": 1, "changes": 69, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/c17e4c93a388b5f3ecffae990318c381b1d68cf0/wz/Reactor.wz/2519003.img.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/c17e4c93a388b5f3ecffae990318c381b1d68cf0/wz/Reactor.wz/2519003.img.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/wz/Reactor.wz/2519003.img.xml?ref=c17e4c93a388b5f3ecffae990318c381b1d68cf0", "patch": "@@ -2,7 +2,74 @@\n <imgdir name=\"2519003.img\">\n   <imgdir name=\"info\">\n     <string name=\"info\" value=\"\ud574\uc801\uc120 \ubb38\"/>\n-    <string name=\"link\" value=\"2519001\"/>\n   </imgdir>\n   <string name=\"action\" value=\"davyScript3\"/>\n+  <imgdir name=\"0\">\n+    <canvas name=\"0\" width=\"92\" height=\"124\">\n+      <vector name=\"origin\" x=\"47\" y=\"124\"/>\n+      <int name=\"z\" value=\"0\"/>\n+    </canvas>\n+    <imgdir name=\"event\">\n+      <imgdir name=\"0\">\n+        <int name=\"type\" value=\"100\"/>\n+        <int name=\"state\" value=\"1\"/>\n+        <string name=\"0\" value=\"4001117\"/>\n+        <int name=\"1\" value=\"1\"/>\n+        <vector name=\"lt\" x=\"-27\" y=\"-21\"/>\n+        <vector name=\"rb\" x=\"31\" y=\"7\"/>\n+      </imgdir>\n+    </imgdir>\n+    <imgdir name=\"hit\">\n+      <canvas name=\"0\" width=\"92\" height=\"124\">\n+        <vector name=\"origin\" x=\"47\" y=\"124\"/>\n+        <int name=\"z\" value=\"0\"/>\n+        <int name=\"delay\" value=\"100\"/>\n+      </canvas>\n+      <canvas name=\"1\" width=\"92\" height=\"124\">\n+        <vector name=\"origin\" x=\"47\" y=\"124\"/>\n+        <int name=\"z\" value=\"0\"/>\n+        <int name=\"delay\" value=\"100\"/>\n+      </canvas>\n+      <canvas name=\"2\" width=\"92\" height=\"124\">\n+        <vector name=\"origin\" x=\"47\" y=\"124\"/>\n+        <int name=\"z\" value=\"0\"/>\n+        <int name=\"delay\" value=\"100\"/>\n+      </canvas>\n+      <canvas name=\"3\" width=\"92\" height=\"124\">\n+        <vector name=\"origin\" x=\"47\" y=\"124\"/>\n+        <int name=\"z\" value=\"0\"/>\n+        <int name=\"delay\" value=\"100\"/>\n+      </canvas>\n+      <canvas name=\"4\" width=\"92\" height=\"124\">\n+        <vector name=\"origin\" x=\"47\" y=\"124\"/>\n+        <int name=\"z\" value=\"0\"/>\n+        <int name=\"delay\" value=\"100\"/>\n+      </canvas>\n+      <canvas name=\"5\" width=\"92\" height=\"124\">\n+        <vector name=\"origin\" x=\"47\" y=\"124\"/>\n+        <int name=\"z\" value=\"0\"/>\n+        <int name=\"delay\" value=\"100\"/>\n+      </canvas>\n+      <canvas name=\"6\" width=\"92\" height=\"124\">\n+        <vector name=\"origin\" x=\"47\" y=\"124\"/>\n+        <int name=\"z\" value=\"0\"/>\n+        <int name=\"delay\" value=\"100\"/>\n+      </canvas>\n+      <canvas name=\"7\" width=\"92\" height=\"124\">\n+        <vector name=\"origin\" x=\"47\" y=\"124\"/>\n+        <int name=\"z\" value=\"0\"/>\n+        <int name=\"delay\" value=\"100\"/>\n+      </canvas>\n+      <canvas name=\"8\" width=\"92\" height=\"124\">\n+        <vector name=\"origin\" x=\"47\" y=\"124\"/>\n+        <int name=\"z\" value=\"0\"/>\n+        <int name=\"delay\" value=\"100\"/>\n+      </canvas>\n+    </imgdir>\n+  </imgdir>\n+  <imgdir name=\"1\">\n+    <canvas name=\"0\" width=\"92\" height=\"124\">\n+      <vector name=\"origin\" x=\"47\" y=\"124\"/>\n+    </canvas>\n+  </imgdir>\n </imgdir>"}]}]},
