{"fetchDate": "2019-12-19", "content": [{"sha": "0a2e382c3b1733e1525cb80b452bd65043e8ad91", "node_id": "MDY6Q29tbWl0NDUwODIwMjM6MGEyZTM4MmMzYjE3MzNlMTUyNWNiODBiNDUyYmQ2NTA0M2U4YWQ5MQ==", "commit": {"author": {"name": "ronancpl", "email": "rcpl2010@gmail.com", "date": "2017-08-04T03:04:46Z"}, "committer": {"name": "ronancpl", "email": "rcpl2010@gmail.com", "date": "2017-08-04T03:04:46Z"}, "message": "Savior Commit\n\nFixed some bugs regarding dojo, updated drop data, minor tweaks on\nMystic Doors, added expeditions for Showa Manor, Zakum and Pink Bean,\nsmart search for item slots on quest/npc rewarding system, attempt on\nboss HPbar to focus on player's current target, quests with selectable\nrewards now hands the item correctly, after the first PQ instance next\nones are loaded more smoothly.", "tree": {"sha": "c5074c477fe0e1a3907d454efa214bff60f38551", "url": "https://api.github.com/repos/ronancpl/HeavenMS/git/trees/c5074c477fe0e1a3907d454efa214bff60f38551"}, "url": "https://api.github.com/repos/ronancpl/HeavenMS/git/commits/0a2e382c3b1733e1525cb80b452bd65043e8ad91", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/0a2e382c3b1733e1525cb80b452bd65043e8ad91", "html_url": "https://github.com/ronancpl/HeavenMS/commit/0a2e382c3b1733e1525cb80b452bd65043e8ad91", "comments_url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/0a2e382c3b1733e1525cb80b452bd65043e8ad91/comments", "author": {"login": "ronancpl", "id": 9257761, "node_id": "MDQ6VXNlcjkyNTc3NjE=", "avatar_url": "https://avatars2.githubusercontent.com/u/9257761?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ronancpl", "html_url": "https://github.com/ronancpl", "followers_url": "https://api.github.com/users/ronancpl/followers", "following_url": "https://api.github.com/users/ronancpl/following{/other_user}", "gists_url": "https://api.github.com/users/ronancpl/gists{/gist_id}", "starred_url": "https://api.github.com/users/ronancpl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ronancpl/subscriptions", "organizations_url": "https://api.github.com/users/ronancpl/orgs", "repos_url": "https://api.github.com/users/ronancpl/repos", "events_url": "https://api.github.com/users/ronancpl/events{/privacy}", "received_events_url": "https://api.github.com/users/ronancpl/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ronancpl", "id": 9257761, "node_id": "MDQ6VXNlcjkyNTc3NjE=", "avatar_url": "https://avatars2.githubusercontent.com/u/9257761?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ronancpl", "html_url": "https://github.com/ronancpl", "followers_url": "https://api.github.com/users/ronancpl/followers", "following_url": "https://api.github.com/users/ronancpl/following{/other_user}", "gists_url": "https://api.github.com/users/ronancpl/gists{/gist_id}", "starred_url": "https://api.github.com/users/ronancpl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ronancpl/subscriptions", "organizations_url": "https://api.github.com/users/ronancpl/orgs", "repos_url": "https://api.github.com/users/ronancpl/repos", "events_url": "https://api.github.com/users/ronancpl/events{/privacy}", "received_events_url": "https://api.github.com/users/ronancpl/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c09bc02c85071c7a832974f5606403398af590e5", "url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/c09bc02c85071c7a832974f5606403398af590e5", "html_url": "https://github.com/ronancpl/HeavenMS/commit/c09bc02c85071c7a832974f5606403398af590e5"}], "stats": {"total": 31417, "additions": 24805, "deletions": 6612}, "files": [{"sha": "4ef345a40600cfbf773c2a49304f22cccb3f936b", "filename": "MobBookUpdate/build/built-jar.properties", "status": "removed", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/c09bc02c85071c7a832974f5606403398af590e5/MobBookUpdate/build/built-jar.properties", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/c09bc02c85071c7a832974f5606403398af590e5/MobBookUpdate/build/built-jar.properties", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/MobBookUpdate/build/built-jar.properties?ref=c09bc02c85071c7a832974f5606403398af590e5", "patch": "@@ -1,4 +0,0 @@\n-#Tue, 30 May 2017 23:02:51 -0300\n-\n-\n-C\\:\\\\Nexon\\\\MapleSolaxia\\\\MapleSolaxiaV2\\\\MobBookUpdate="}, {"sha": "691fe58c74fc97a22eb370d7205063f992ae23e7", "filename": "MonsterDropCreator.bat", "status": "removed", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/c09bc02c85071c7a832974f5606403398af590e5/MonsterDropCreator.bat", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/c09bc02c85071c7a832974f5606403398af590e5/MonsterDropCreator.bat", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/MonsterDropCreator.bat?ref=c09bc02c85071c7a832974f5606403398af590e5", "patch": "@@ -1,4 +0,0 @@\n-@echo off\n-set CLASSPATH=.;dist\\*;\n-java -Dwzpath=wz\\ tools.MonsterDropCreator false\n-pause\n\\ No newline at end of file"}, {"sha": "c7e809e0b07d1fca0843ffcbaa1640668b7cae02", "filename": "README_wzchanges.txt", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/README_wzchanges.txt", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/README_wzchanges.txt", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/README_wzchanges.txt?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -8,15 +8,15 @@ Map.wz/MapX/*:\n \n Item.wz/*:\n \tFixed lacking \"slotMax\" properties in some items.\n-\tSet flag \"Quest Item\" for Springy Worm.\n+\tSet flag \"Quest Item\" for some items.\n \n Quest.wz/*:\n \tFixed a bunch of quests, now giving the proper output. Added new quests.\n \n String.wz/*:\n \tFixed some NPC speeches.\n-\tUpdated MonsterBook with current drop data on the sql's DB, using\n-Ronan Lana's MobBookUpdate facility.\n+\tUpdated MonsterBook with current drop data on the sql's DB, using Ronan's\n+MobBookUpdate facility.\n \n \n P.S.:"}, {"sha": "012cb85e32651389ae3a26922cb1c966f9b50247", "filename": "build/built-jar.properties", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/built-jar.properties", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/built-jar.properties", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/built-jar.properties?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -1,4 +1,4 @@\n-#Mon, 17 Jul 2017 14:21:39 -0300\n+#Thu, 03 Aug 2017 23:09:50 -0300\n \n \n C\\:\\\\Nexon\\\\MapleSolaxia\\\\MapleSolaxiaV2="}, {"sha": "ccdd55b24b32e7fc1c5b18d0a272baad4b468891", "filename": "build/classes/client/MapleBuffStat.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleBuffStat.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleBuffStat.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleBuffStat.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "b5b242666775ae2245b7eccdbee5fcb4c6c22cdf", "filename": "build/classes/client/MapleCharacter$1.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$1.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$1.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$1.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "6c2a085eba8f44f1e2fb1415a6cfd845a0f460d2", "filename": "build/classes/client/MapleCharacter$10.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$10.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$10.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$10.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "af607a7c4683895e7e490e807fb64767884fd82a", "filename": "build/classes/client/MapleCharacter$11.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$11.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$11.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$11.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "c313f32d5a56b5fdcee373169245f2bc0f321573", "filename": "build/classes/client/MapleCharacter$12.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$12.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$12.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$12.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "975a14b3504719515c6dffb7234c4abc25375f3b", "filename": "build/classes/client/MapleCharacter$13.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$13.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$13.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$13.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "d6561bafa620849b8ff6a0b4ba43025f4756527c", "filename": "build/classes/client/MapleCharacter$14.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$14.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$14.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$14.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "efa4c97a5b4d41c6f04009337830fc7da86b6858", "filename": "build/classes/client/MapleCharacter$15.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$15.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$15.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$15.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "ac068a98d229e893fc5b24c140b733b188894daa", "filename": "build/classes/client/MapleCharacter$16.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$16.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$16.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$16.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "c4eef43afe19b943731d9c9b9e2f606d6fae3c66", "filename": "build/classes/client/MapleCharacter$17.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$17.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$17.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$17.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "846e797ca014e9cac239b41a6ec3f98a5baf7d1c", "filename": "build/classes/client/MapleCharacter$18.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$18.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$18.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$18.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "196ca5c309003b476f97fb5d480158ea2fa91a9f", "filename": "build/classes/client/MapleCharacter$19.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$19.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$19.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$19.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "c3e3c2bf0306e40d42d07f9c9a7d4aa1967447d8", "filename": "build/classes/client/MapleCharacter$2.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$2.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$2.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$2.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "56589a900b2e96778a83b58c35538b777ed195b5", "filename": "build/classes/client/MapleCharacter$20.class", "status": "added", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$20.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$20.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$20.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "d96db286d52826a88651032ffb718370641adbe6", "filename": "build/classes/client/MapleCharacter$3.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$3.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$3.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$3.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "aaf7128a2195cf95a4594d670fc20b2a6d660375", "filename": "build/classes/client/MapleCharacter$4.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$4.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$4.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$4.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "777e1174137e3035ed1d1e8fe15baef73653a732", "filename": "build/classes/client/MapleCharacter$5.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$5.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$5.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$5.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "acb08344390c5ec81ed42cf9ff5154bb2c6d82f4", "filename": "build/classes/client/MapleCharacter$6.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$6.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$6.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$6.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "4f72d84731f947111ddf12ea44e3d7f5912467fe", "filename": "build/classes/client/MapleCharacter$7.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$7.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$7.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$7.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "43ab177661261d6db915da4f398e9b8d83607af4", "filename": "build/classes/client/MapleCharacter$8.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$8.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$8.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$8.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "5719399944166bbb4b5b9fe85261b97bc971f9be", "filename": "build/classes/client/MapleCharacter$9.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$9.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$9.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$9.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "b924e7599ac1091b6c4a8763728b4de4bf50015e", "filename": "build/classes/client/MapleCharacter$CancelCooldownAction.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$CancelCooldownAction.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$CancelCooldownAction.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$CancelCooldownAction.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "612db1ebef142d19d843c6c323202fdd175b7ef7", "filename": "build/classes/client/MapleCharacter$FameStatus.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$FameStatus.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$FameStatus.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$FameStatus.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "7035a5065de57307415eef575beee367b81e7284", "filename": "build/classes/client/MapleCharacter$MapleBuffStatValueHolder.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$MapleBuffStatValueHolder.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$MapleBuffStatValueHolder.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$MapleBuffStatValueHolder.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "66022be946d70931edb2db38b7b207b77edfad56", "filename": "build/classes/client/MapleCharacter$MapleCoolDownValueHolder.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$MapleCoolDownValueHolder.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$MapleCoolDownValueHolder.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$MapleCoolDownValueHolder.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "8f63655b39cff925b2f4ea35e0764db379c5bfcc", "filename": "build/classes/client/MapleCharacter$SkillEntry.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$SkillEntry.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter$SkillEntry.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$SkillEntry.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "358e0f1564cb87e1c65a2465df5395f62b313ede", "filename": "build/classes/client/MapleCharacter.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleCharacter.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "77502c8a71e59fb0ed2bb8bb2c295f8e80e3a6c3", "filename": "build/classes/client/MapleClient$1.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleClient$1.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleClient$1.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleClient$1.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "6de564b57e274a641e51dccd2a549db76d475a0b", "filename": "build/classes/client/MapleClient$CharNameAndId.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleClient$CharNameAndId.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleClient$CharNameAndId.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleClient$CharNameAndId.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "c8daf85dc9807ca5e2b142cdcdc5698569e04609", "filename": "build/classes/client/MapleClient.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleClient.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleClient.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleClient.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "1ddc7736e9e0508658d34ee96e2ff18461522245", "filename": "build/classes/client/MapleDiseaseValueHolder.class", "status": "added", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleDiseaseValueHolder.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/MapleDiseaseValueHolder.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleDiseaseValueHolder.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "cff43e3f866775a868e00becf2a6cf0492d32d34", "filename": "build/classes/client/command/Commands$1.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/command/Commands$1.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/command/Commands$1.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/command/Commands$1.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "8af227dc25b72719cdcb381fe1a38ef407316ec6", "filename": "build/classes/client/command/Commands.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/command/Commands.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/command/Commands.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/command/Commands.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "2d17a7e7613faecdec371d5e0c332d72def9b8ae", "filename": "build/classes/client/inventory/MapleInventory.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/inventory/MapleInventory.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/client/inventory/MapleInventory.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/inventory/MapleInventory.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "aa29dccc024bc88eab002cb68ce8ef60af1a4fc6", "filename": "build/classes/constants/ItemConstants.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/constants/ItemConstants.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/constants/ItemConstants.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/constants/ItemConstants.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "d0277361a16cbb817abefeadddc394e4d32c3ef7", "filename": "build/classes/constants/ServerConstants.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/constants/ServerConstants.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/constants/ServerConstants.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/constants/ServerConstants.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "e18e61046864730b56268219bba10edd3a359b6e", "filename": "build/classes/net/server/channel/Channel$1.class", "status": "added", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/net/server/channel/Channel$1.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/net/server/channel/Channel$1.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/net/server/channel/Channel$1.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "90801e77f60c4779bedcb5a028f9b807887a8413", "filename": "build/classes/net/server/channel/Channel$respawnMaps.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/net/server/channel/Channel$respawnMaps.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/net/server/channel/Channel$respawnMaps.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/net/server/channel/Channel$respawnMaps.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "254dbd39c9e11f47a3b4e51eb9dffabc150a1d2f", "filename": "build/classes/net/server/channel/Channel.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/net/server/channel/Channel.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/net/server/channel/Channel.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/net/server/channel/Channel.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "e85c140d1990e3554ce2daf0f8a0dad578b36d91", "filename": "build/classes/net/server/channel/handlers/CancelChairHandler.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/net/server/channel/handlers/CancelChairHandler.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/net/server/channel/handlers/CancelChairHandler.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/net/server/channel/handlers/CancelChairHandler.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "d1869aab1e0a64a5e8a49b7520e854b3dc2cc08f", "filename": "build/classes/net/server/channel/handlers/CashOperationHandler.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/net/server/channel/handlers/CashOperationHandler.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/net/server/channel/handlers/CashOperationHandler.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/net/server/channel/handlers/CashOperationHandler.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "8797672530b4b55271291021736f66c40f0f953f", "filename": "build/classes/net/server/channel/handlers/DoorHandler.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/net/server/channel/handlers/DoorHandler.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/net/server/channel/handlers/DoorHandler.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/net/server/channel/handlers/DoorHandler.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "30e714b28f2701507202e1990e8f2d6bdbd92bcd", "filename": "build/classes/net/server/channel/handlers/EnterMTSHandler.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/net/server/channel/handlers/EnterMTSHandler.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/net/server/channel/handlers/EnterMTSHandler.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/net/server/channel/handlers/EnterMTSHandler.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "7742d4f43304585f85012f8df164b45594f4d96d", "filename": "build/classes/net/server/channel/handlers/GeneralChatHandler.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/net/server/channel/handlers/GeneralChatHandler.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/net/server/channel/handlers/GeneralChatHandler.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/net/server/channel/handlers/GeneralChatHandler.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "297eee9ff9dde8b294612ef784a96b7bad53d075", "filename": "build/classes/net/server/channel/handlers/NPCTalkHandler.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/net/server/channel/handlers/NPCTalkHandler.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/net/server/channel/handlers/NPCTalkHandler.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/net/server/channel/handlers/NPCTalkHandler.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "d7818b89cf389325e01b8a16465de72cc265e92f", "filename": "build/classes/net/server/channel/handlers/SpecialMoveHandler.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/net/server/channel/handlers/SpecialMoveHandler.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/net/server/channel/handlers/SpecialMoveHandler.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/net/server/channel/handlers/SpecialMoveHandler.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "9cad40708803c174667561c77821cad5013d4db3", "filename": "build/classes/net/server/channel/handlers/StorageHandler.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/net/server/channel/handlers/StorageHandler.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/net/server/channel/handlers/StorageHandler.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/net/server/channel/handlers/StorageHandler.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "d2a582538ec26184b72b9a220b4e257bf9ef3213", "filename": "build/classes/net/server/channel/handlers/WhisperHandler.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/net/server/channel/handlers/WhisperHandler.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/net/server/channel/handlers/WhisperHandler.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/net/server/channel/handlers/WhisperHandler.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "6a20d80984a871c9985d69b1da322e51e103f27d", "filename": "build/classes/net/server/world/MapleParty$1.class", "status": "added", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/net/server/world/MapleParty$1.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/net/server/world/MapleParty$1.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/net/server/world/MapleParty$1.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "91de42acd5af7bece40aeed0247b79a37ffa57f6", "filename": "build/classes/net/server/world/MapleParty.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/net/server/world/MapleParty.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/net/server/world/MapleParty.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/net/server/world/MapleParty.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "26fa34cd0ba8b6aee16db703d1e98ba0ef1da3d7", "filename": "build/classes/scripting/AbstractPlayerInteraction.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/scripting/AbstractPlayerInteraction.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/scripting/AbstractPlayerInteraction.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/scripting/AbstractPlayerInteraction.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "1e39f0b70ee3dc82f4390ac218ce4d263a7846e8", "filename": "build/classes/scripting/event/EventInstanceManager$1.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/scripting/event/EventInstanceManager$1.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/scripting/event/EventInstanceManager$1.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/scripting/event/EventInstanceManager$1.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "56fdf626350ffa1d171bd26147be4fe672b7057b", "filename": "build/classes/scripting/event/EventInstanceManager$2.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/scripting/event/EventInstanceManager$2.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/scripting/event/EventInstanceManager$2.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/scripting/event/EventInstanceManager$2.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "1517f53831e254f7e3571f365d0bcaf096cf7aab", "filename": "build/classes/scripting/event/EventInstanceManager$3.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/scripting/event/EventInstanceManager$3.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/scripting/event/EventInstanceManager$3.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/scripting/event/EventInstanceManager$3.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "bfd16fa15a519b078ae062d39bf4aade9989e284", "filename": "build/classes/scripting/event/EventInstanceManager.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/scripting/event/EventInstanceManager.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/scripting/event/EventInstanceManager.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/scripting/event/EventInstanceManager.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "c7591f8263dad0b647888be2250599fb55bfd388", "filename": "build/classes/scripting/event/EventManager$1.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/scripting/event/EventManager$1.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/scripting/event/EventManager$1.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/scripting/event/EventManager$1.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "5586d9ff9a794357b4b2768363d09bf7b3da187b", "filename": "build/classes/scripting/event/EventManager$2.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/scripting/event/EventManager$2.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/scripting/event/EventManager$2.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/scripting/event/EventManager$2.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "b28630116ab6be929b021463fa842acd8d209459", "filename": "build/classes/scripting/event/EventManager$3.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/scripting/event/EventManager$3.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/scripting/event/EventManager$3.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/scripting/event/EventManager$3.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "cd1c215d76c356368b959eb964e77c7340b3dcf9", "filename": "build/classes/scripting/event/EventManager$EventManagerWorker.class", "status": "added", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/scripting/event/EventManager$EventManagerWorker.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/scripting/event/EventManager$EventManagerWorker.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/scripting/event/EventManager$EventManagerWorker.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "9a8a6c3938e7ca0626870ac3835d19a0d60e7f60", "filename": "build/classes/scripting/event/EventManager.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/scripting/event/EventManager.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/scripting/event/EventManager.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/scripting/event/EventManager.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "1c479857e2556b389f13e4665302724294bbd0b7", "filename": "build/classes/scripting/npc/NPCConversationManager.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/scripting/npc/NPCConversationManager.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/scripting/npc/NPCConversationManager.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/scripting/npc/NPCConversationManager.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "d91aebff3fdc81d2d89013ae831a7673cc07d82b", "filename": "build/classes/scripting/reactor/ReactorActionManager$1.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/scripting/reactor/ReactorActionManager$1.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/scripting/reactor/ReactorActionManager$1.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/scripting/reactor/ReactorActionManager$1.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "8b8825b90677cde29a6972631c46d8ea87f11dee", "filename": "build/classes/scripting/reactor/ReactorActionManager$2.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/scripting/reactor/ReactorActionManager$2.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/scripting/reactor/ReactorActionManager$2.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/scripting/reactor/ReactorActionManager$2.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "cde02d0c19b0a3f91f5c55ba7c0405863c5bf3d7", "filename": "build/classes/scripting/reactor/ReactorActionManager.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/scripting/reactor/ReactorActionManager.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/scripting/reactor/ReactorActionManager.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/scripting/reactor/ReactorActionManager.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "6243beaab3e2208073e41680b09edc58d0a71074", "filename": "build/classes/server/MapleInventoryManipulator.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/MapleInventoryManipulator.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/MapleInventoryManipulator.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/MapleInventoryManipulator.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "210ab0012c6d9970526227e6571b243f02abb03d", "filename": "build/classes/server/MapleStatEffect$CancelEffectAction.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/MapleStatEffect$CancelEffectAction.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/MapleStatEffect$CancelEffectAction.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/MapleStatEffect$CancelEffectAction.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "a61eea1b9ec81e82ed1f6e5449de80e55e054ba0", "filename": "build/classes/server/MapleStatEffect.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/MapleStatEffect.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/MapleStatEffect.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/MapleStatEffect.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "87c6ef45f88007bf130723a784d5df48d28505f6", "filename": "build/classes/server/MapleTrade.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/MapleTrade.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/MapleTrade.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/MapleTrade.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "4538c8bb700ec8b94a24e3d9234e43ded70d7562", "filename": "build/classes/server/events/gm/MapleOxQuiz.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/events/gm/MapleOxQuiz.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/events/gm/MapleOxQuiz.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/events/gm/MapleOxQuiz.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "ac43df8126d06cd1b016aa8fb6224b7ec21ff3f6", "filename": "build/classes/server/expeditions/MapleExpedition$1.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/expeditions/MapleExpedition$1.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/expeditions/MapleExpedition$1.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/expeditions/MapleExpedition$1.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "d68d882bce4f998711dd2d5c54497a5735c97f14", "filename": "build/classes/server/expeditions/MapleExpedition.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/expeditions/MapleExpedition.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/expeditions/MapleExpedition.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/expeditions/MapleExpedition.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "b12e901f3f00269fc9335533592c56ab8814b69d", "filename": "build/classes/server/expeditions/MapleExpeditionType.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/expeditions/MapleExpeditionType.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/expeditions/MapleExpeditionType.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/expeditions/MapleExpeditionType.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "5eba265f2ec57bec9f54a8ada67e8b29c9da1812", "filename": "build/classes/server/life/MapleMonster$1.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/life/MapleMonster$1.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/life/MapleMonster$1.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/life/MapleMonster$1.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "618f519d78c2e4de7bf7d23b82f5878d78eeccf6", "filename": "build/classes/server/life/MapleMonster$2.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/life/MapleMonster$2.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/life/MapleMonster$2.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/life/MapleMonster$2.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "788cc59f21dd0340a4a2cf22ae2017e000347f5d", "filename": "build/classes/server/life/MapleMonster$3.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/life/MapleMonster$3.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/life/MapleMonster$3.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/life/MapleMonster$3.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "23fc9f55d19cc06c20faeb1c7b00dae9ed80995e", "filename": "build/classes/server/life/MapleMonster$4.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/life/MapleMonster$4.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/life/MapleMonster$4.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/life/MapleMonster$4.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "b6a2002be1fe5a035cf32b19fda863da339be67c", "filename": "build/classes/server/life/MapleMonster$5.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/life/MapleMonster$5.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/life/MapleMonster$5.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/life/MapleMonster$5.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "f688c2755ac6c5fc0cac1db4cc3a9bab9adb57b7", "filename": "build/classes/server/life/MapleMonster$6.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/life/MapleMonster$6.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/life/MapleMonster$6.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/life/MapleMonster$6.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "eb348b26c35c40d55467652ca0dd29b5bac845f6", "filename": "build/classes/server/life/MapleMonster$DamageTask.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/life/MapleMonster$DamageTask.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/life/MapleMonster$DamageTask.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/life/MapleMonster$DamageTask.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "7b68b19c7a2eaea8392f65d7b2b0285a81bb79c1", "filename": "build/classes/server/life/MapleMonster.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/life/MapleMonster.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/life/MapleMonster.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/life/MapleMonster.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "c884928094b4fe9c8ba05dc59d35b32603e5f025", "filename": "build/classes/server/maps/MapleDoor.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleDoor.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleDoor.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/maps/MapleDoor.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "4f91573cfb4d9ffec7d8b8453073f5559f7a1776", "filename": "build/classes/server/maps/MapleDoorObject.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleDoorObject.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleDoorObject.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/maps/MapleDoorObject.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "8897dab3a660e4608d0855ec411c51844867f711", "filename": "build/classes/server/maps/MapleMap$1.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$1.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$1.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/maps/MapleMap$1.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "aaaf9484847eef0ccc4a5a056b64114c331bff28", "filename": "build/classes/server/maps/MapleMap$10.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$10.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$10.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/maps/MapleMap$10.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "3a5a79f04f2378e2f75678a60e82acf298adb251", "filename": "build/classes/server/maps/MapleMap$11.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$11.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$11.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/maps/MapleMap$11.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "13c0392d2546287da46230113b06e4b138b89a2a", "filename": "build/classes/server/maps/MapleMap$12.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$12.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$12.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/maps/MapleMap$12.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "865db71b2ccf996d3446d9e7b40986159a66dddd", "filename": "build/classes/server/maps/MapleMap$13.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$13.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$13.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/maps/MapleMap$13.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "7358ab1aabc2c50aff5ed3d42adbd4e75ccf2499", "filename": "build/classes/server/maps/MapleMap$14.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$14.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$14.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/maps/MapleMap$14.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "d2e720f800309644e381c530af0488dbfd1ae119", "filename": "build/classes/server/maps/MapleMap$15.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$15.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$15.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/maps/MapleMap$15.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "c6aaaf83f85c909d22dcb523a667a56071fc96d5", "filename": "build/classes/server/maps/MapleMap$16.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$16.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$16.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/maps/MapleMap$16.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "cf83f27c8493a93b0b2e0c6e5b515ba6ccce038f", "filename": "build/classes/server/maps/MapleMap$17.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$17.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$17.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/maps/MapleMap$17.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "563fda4ecd7709fe1ab7d1b030ef8116457181da", "filename": "build/classes/server/maps/MapleMap$18.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$18.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$18.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/maps/MapleMap$18.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "23afc5f1f20f617a6443f10b05e756bf5f1b632d", "filename": "build/classes/server/maps/MapleMap$19.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$19.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$19.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/maps/MapleMap$19.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "cba9f211439fd6c0567fe966edd7d4187fe79978", "filename": "build/classes/server/maps/MapleMap$2.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$2.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$2.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/maps/MapleMap$2.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "2cc51da1d48e3d5422130f27c5934f0e8143297d", "filename": "build/classes/server/maps/MapleMap$20.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$20.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$20.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/maps/MapleMap$20.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "d781a1a22f33970e9906ee5b567318c8d6f86213", "filename": "build/classes/server/maps/MapleMap$21.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$21.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$21.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/maps/MapleMap$21.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "109ce04921ea0391bf67775549e97af6e8163b89", "filename": "build/classes/server/maps/MapleMap$22.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$22.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$22.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/maps/MapleMap$22.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "4757210001d50f37e53ac308912538211c63f7ef", "filename": "build/classes/server/maps/MapleMap$23.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$23.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$23.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/maps/MapleMap$23.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "506c881cf807028b8d913bcb28a5406cf4e036ce", "filename": "build/classes/server/maps/MapleMap$24.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$24.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$24.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/maps/MapleMap$24.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "f412de4a0c41c706d2e0471f1c0f5d7e5f7286a9", "filename": "build/classes/server/maps/MapleMap$25.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$25.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$25.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/maps/MapleMap$25.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "507fe8953818d61f13aada0212807dff9f36adce", "filename": "build/classes/server/maps/MapleMap$26.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$26.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$26.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/maps/MapleMap$26.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "49cc508eaa8e1b5353e84a18743c27a838afdf37", "filename": "build/classes/server/maps/MapleMap$27.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$27.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$27.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/maps/MapleMap$27.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "227b5892ca58a13e37c9e3cbbb3f90203296b081", "filename": "build/classes/server/maps/MapleMap$28$1.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$28$1.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$28$1.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/maps/MapleMap$28$1.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "afab86635b511d5584ed8a81625d2dbec77341f3", "filename": "build/classes/server/maps/MapleMap$28.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$28.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$28.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/maps/MapleMap$28.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "e9dd9d30ecc61f5ab008ed1ebc45b9c59cec6cf8", "filename": "build/classes/server/maps/MapleMap$29.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$29.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$29.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/maps/MapleMap$29.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "d33ddf0d7e1f2f6be377219f55b30da61436af87", "filename": "build/classes/server/maps/MapleMap$3.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$3.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$3.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/maps/MapleMap$3.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "4fb84fb9e984b1d4bd6438f1aa0423720625423a", "filename": "build/classes/server/maps/MapleMap$4.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$4.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$4.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/maps/MapleMap$4.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "486d71a222b419a1f2d9933ff05618507b5d7c59", "filename": "build/classes/server/maps/MapleMap$5.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$5.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$5.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/maps/MapleMap$5.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "8f50a93546dac8ca53153d0fb7cd967e140bdc9a", "filename": "build/classes/server/maps/MapleMap$6.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$6.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$6.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/maps/MapleMap$6.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "e8d472bbb2904a4a9d6b95a704b3ec00e5172b2a", "filename": "build/classes/server/maps/MapleMap$7.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$7.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$7.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/maps/MapleMap$7.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "f6e5018df0e2d0c8c5d569167de50f334ccccfbe", "filename": "build/classes/server/maps/MapleMap$8.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$8.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$8.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/maps/MapleMap$8.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "5f691c4a1d56a9ff1baac82a9f7c1bb51aeff75e", "filename": "build/classes/server/maps/MapleMap$9.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$9.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$9.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/maps/MapleMap$9.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "ba2913c473f9de52a8af5f94ee422342ddfe4a5f", "filename": "build/classes/server/maps/MapleMap$ActivateItemReactor$1.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$ActivateItemReactor$1.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$ActivateItemReactor$1.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/maps/MapleMap$ActivateItemReactor$1.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "1c4342ac47c3c4b3b174d44b3d2a5795a869bc2d", "filename": "build/classes/server/maps/MapleMap$ActivateItemReactor.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$ActivateItemReactor.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$ActivateItemReactor.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/maps/MapleMap$ActivateItemReactor.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "d65fa13a5776643a86659bde0fa1c7d1a143452e", "filename": "build/classes/server/maps/MapleMap$ExpireMapItemJob.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$ExpireMapItemJob.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap$ExpireMapItemJob.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/maps/MapleMap$ExpireMapItemJob.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "1ee0a529a351b0271b391858657437e22864c4e9", "filename": "build/classes/server/maps/MapleMap.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMap.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/maps/MapleMap.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "e427e6ccc23ee9f9f69c9dac1ac259977c5a1762", "filename": "build/classes/server/maps/MapleMapItem.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMapItem.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleMapItem.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/maps/MapleMapItem.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "8beb49714824dc4a605f8054a6a9cefe63f1421f", "filename": "build/classes/server/maps/MapleReactor.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleReactor.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/maps/MapleReactor.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/maps/MapleReactor.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "563093107b2d7cf7cd03bd71d4e7ff882455b1c9", "filename": "build/classes/server/quest/actions/ItemAction$1.class", "status": "added", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/quest/actions/ItemAction$1.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/quest/actions/ItemAction$1.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/quest/actions/ItemAction$1.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "f784e631d737da2c7681da16f5269c8f207f668d", "filename": "build/classes/server/quest/actions/ItemAction$ItemData.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/quest/actions/ItemAction$ItemData.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/quest/actions/ItemAction$ItemData.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/quest/actions/ItemAction$ItemData.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "25a805a4ac7611de844dc9526105fe630db773d6", "filename": "build/classes/server/quest/actions/ItemAction.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/quest/actions/ItemAction.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/server/quest/actions/ItemAction.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/server/quest/actions/ItemAction.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "c3a90e038750e34804717734890deda76e22d116", "filename": "build/classes/tools/MaplePacketCreator$2.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/tools/MaplePacketCreator$2.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/tools/MaplePacketCreator$2.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/tools/MaplePacketCreator$2.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "cb26ef2a22888e42a760bf35f42db733edefab01", "filename": "build/classes/tools/MaplePacketCreator.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/tools/MaplePacketCreator.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/build/classes/tools/MaplePacketCreator.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/tools/MaplePacketCreator.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "562c3638513d0836ef311357ec00831c49576e7b", "filename": "dist/MapleSolaxia.jar", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/dist/MapleSolaxia.jar", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/dist/MapleSolaxia.jar", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/dist/MapleSolaxia.jar?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "2ac1466b525a0777f4c8b65623b7320f20c728cd", "filename": "feature_list.txt", "status": "modified", "additions": 14, "deletions": 4, "changes": 18, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/feature_list.txt", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/feature_list.txt", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/feature_list.txt?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -10,7 +10,7 @@ Feature list:\n PQs:\n * HPQ/KPQ/LPQ/LMPQ/OPQ/EllinPQ/PiratePQ/HorntailPQ 100%.\n * CWKPQ as Expedition-based event 100%.\n-* Expeditions: Scarga/Horntail 100%.\n+* Expeditions: Scarga/Horntail/Showa/Zakum/Pinkbean 100%.\n * GuildPQ 100% + Guild queue with multi-lobby systems available.\n * Brand-new PQ: Boss Rush PQ 100%.\n * BalrogPQ semi-functional.\n@@ -20,6 +20,8 @@ Quests:\n * Doll house quest 100%.\n * Quests can now reward properly items when matching a reward item with the player's job.\n * Loads of quests have been patched.\n+* Quest rewards according to jobs works properly.\n+* Rewarding system now checks for stacking opportunities on the inventory before checking for new slots.\n \n Player Social Network:\n * Guild and Alliance system fully functional.\n@@ -42,16 +44,24 @@ Server potentials:\n * Gain fame by quests.\n * Every monsterbook card is now droppable by overworld mobs.\n * Monsterbook displays drop data info conformant with the underlying DB (needs custom wz). See more on the MobBookUpdate feature.\n+* Mastery book announcer displaying droppers of needed books of a player, read underlying DB.\n+* Inventory auto-gather and auto-sorting feature.\n+* Enhanced AP auto-assigner: exactly matches AP with the needed for the player's current level, surplus assigned to the primary attribute.\n * Added Boss HP Bar for dozens of bosses (needs provided custom wz).\n+* If multiple bosses on the same area, client will prioritize Boss HP bar of the target of the player.\n * Custom jail system (needs provided custom wz).\n * Delete Character 100% (requires ENABLE_PIC activated).\n+* Boats, elevator and other travelling mechanics fully working.\n \n Admin/GM commands:\n+* Server commands layered by GM levels.\n * New commands.\n-* Zakum/Horntail/Pinkbean 100%.\n+* Spawn Zakum/Horntail/Pinkbean 100%.\n \n Project:\n * Organized project code.\n-* Highly configurable server (see server flags at ServerConstants).\n-* Fixed/added some missing packets for MoveEnvironment and summons.\n+* Highly configurable server (see all server flags at ServerConstants).\n+* Fixed/added some missing packets for MoveEnvironment, summons and others.\n+* Reviewed some Java object aspects that needed concurrency protection.\n+\n ---------------------------\n\\ No newline at end of file"}, {"sha": "eeb0904e4fb46b92cb98a1f804bec6f50f64824f", "filename": "mychanges_ptbr.txt", "status": "modified", "additions": 47, "deletions": 1, "changes": 48, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/mychanges_ptbr.txt", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/mychanges_ptbr.txt", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/mychanges_ptbr.txt?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -381,4 +381,50 @@ Corrigido bugs com \"buffmap\" desconectando players em certos casos.\n \n 16 - 17 Julho 2017,\n Adicionados HTPQ e expedi\ufffd\ufffdo Horntail.\n-Corrigido bugs com levelup de equipamentos provocando Integer overflow (stats negativos) nos clientes.\n\\ No newline at end of file\n+Corrigido bugs com levelup de equipamentos provocando Integer overflow (stats negativos) nos clientes.\n+Corrigido ataque de Octopus (summon) n\ufffdo revelando dire\ufffd\ufffdo a clientes de terceiros.\n+Corrigido caso onde player usando chair morre sem desequipar a chair, levando clientes a mostrar chairs ao lado do player.\n+Nova feature: cura extra de chairs de mapa.\n+\n+18 - 19 Julho 2017,\n+Corrigido varias falhas de concorrencia na classe dos players.\n+Corrigido reator das portas do dojo as vezes lancando nulls.\n+Adicionado sistema de lobbys pro Dojo (multiplas partys podendo acessar salas do Dojo concorrentemente, com limite).\n+Adicionado prote\ufffd\ufffdo de acesso concorrente a certas propriedades dos players.\n+\n+21 Julho 2017,\n+Corrigido scripts dojang_Eff (agora aplicando para todos) e dojang_1st (agora somente para o primeiro player entrando no mapa).\n+Dojo agora funcional, com sistema de lobbys aplicado.\n+Bosses no dojo agora dropam buffs e mobs po\ufffd\ufffdes.\n+\n+22 - 23 Julho 2017,\n+Corrigido v\ufffdrios aspectos err\ufffdneos referente ao funcionamento das Mystic Doors.\n+Comando adicionado: recharge.\n+Adicionado/modificado alguns scripts de portais relacionados a mapas de skills de 4th job.\n+\n+24 Julho 2017,\n+Adicionada mec\ufffdnica permitindo quests entregarem itens mesmo que n\ufffdo haja slots vazios para garantir tal a\ufffd\ufffdo.\n+\n+25 Julho 2017,\n+Adicionadas barras de HP para bosses da regi\ufffdo de Zipangu/Showa.\n+Adicionada expedi\ufffd\ufffdo para bosses de Showa.\n+Adicionados chairs a venda por NPCs ao longo de Maple World.\n+\n+26 - 27 Julho 2017,\n+HP Bar de bosses agora aparecem de forma inteligente, de acordo com quem o jogador est\ufffd alvejando.\n+Adicionadas expedi\ufffd\ufffdes para Zakum e Pinkbean.\n+\n+31 Julho 2017,\n+Otimizado carregamento de skills ao iniciar o server.\n+Workaround em bosses tais como Riche e Ice Witch, anteriormente inderrot\ufffdveis.\n+\n+01 Agosto 2017,\n+Adicionado drop data para tais bosses anteriormente inderrot\ufffdveis.\n+\n+02 Agosto 2017,\n+Consertado bug em alguns eventos, relacionado \ufffd fun\ufffd\ufffdo isEventLeader.\n+Consertado quests n\ufffdo dando item certo apropriadamente, no caso de escolhas.\n+\n+03 Agosto 2017,\n+Quests agora retiram itens antes de entregar recompensas.\n+Ap\ufffds a primeira inicializa\ufffd\ufffdo, PQs inicializar\ufffdo mais r\ufffdpido, uma vez que h\ufffd um sistema preparador de EIMs ativo.\n\\ No newline at end of file"}, {"sha": "6f4919039558a18c1415146ddf3cbc50377193c8", "filename": "nbproject/private/private.xml", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/nbproject/private/private.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/nbproject/private/private.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/nbproject/private/private.xml?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -3,10 +3,16 @@\n     <editor-bookmarks xmlns=\"http://www.netbeans.org/ns/editor-bookmarks/2\" lastBookmarkId=\"1\"/>\n     <open-files xmlns=\"http://www.netbeans.org/ns/projectui-open-files/2\">\n         <group>\n-            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/client/inventory/Equip.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/client/inventory/ItemFactory.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/server/maps/MapleMapFactory.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/scripting/event/EventScriptManager.java</file>\n             <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/client/command/Commands.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/scripting/event/EventInstanceManager.java</file>\n             <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/constants/ServerConstants.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/server/maps/MapleMap.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/net/server/RankingWorker.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/scripting/event/EventManager.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/net/server/channel/Channel.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/scripting/reactor/ReactorActionManager.java</file>\n         </group>\n     </open-files>\n </project-private>"}, {"sha": "1ee03e83580624a25062b0ae84dd92df25b72d4f", "filename": "scripts/event/AreaBossBamboo.js", "status": "added", "additions": 54, "deletions": 0, "changes": 54, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/event/AreaBossBamboo.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/event/AreaBossBamboo.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/event/AreaBossBamboo.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -0,0 +1,54 @@\n+/*\n+\tThis file is part of the OdinMS Maple Story Server\n+    Copyright (C) 2008 Patrick Huy <patrick.huy@frz.cc>\n+\t\t       Matthias Butz <matze@odinms.de>\n+\t\t       Jan Christian Meyer <vimes@odinms.de>\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+/**\n+-- Odin JavaScript --------------------------------------------------------------------------------\n+\tBamboo Warrior Spawner\n+-- Edited by --------------------------------------------------------------------------------------\n+\tRonan (based on xQuasar's King Clang spawner)\n+\n+**/\n+function init() {\n+    scheduleNew();\n+}\n+\n+function scheduleNew() {\n+    setupTask = em.schedule(\"start\", 0);    //spawns upon server start. Each 3 hours an server event checks if boss exists, if not spawns it instantly.\n+}\n+\n+function cancelSchedule() {\n+    if (setupTask != null)\n+        setupTask.cancel(true);\n+}\n+\n+function start() {\n+    var mapObj = em.getChannelServer().getMapFactory().getMap(800020120);\n+    var mobObj = Packages.server.life.MapleLifeFactory.getMonster(6090002);\n+\t\n+\tif(mapObj.getMonsterById(6090002) != null) {\n+\t\tem.schedule(\"start\", 3 * 60 *60 * 1000);\n+\t\treturn;\n+\t}\n+\t\n+    mapObj.spawnMonsterOnGroundBelow(mobObj, new Packages.java.awt.Point(560, 50));\n+    mapObj.broadcastMessage(Packages.tools.MaplePacketCreator.serverNotice(6, \"From amongst the ruins shrouded by the mists, Bamboo Warrior appears.\"));\n+\tem.schedule(\"start\", 3 * 60 *60 * 1000);\n+}\n\\ No newline at end of file"}, {"sha": "548d992507fc26fe8f08cd566a9fe7c8ec536a05", "filename": "scripts/event/AreaBossCentipede.js", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/event/AreaBossCentipede.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/event/AreaBossCentipede.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/event/AreaBossCentipede.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -21,9 +21,9 @@\n */\n /**\n -- Odin JavaScript --------------------------------------------------------------------------------\n-\tDeo Spawner\n+\tCentipede Spawner\n -- Edited by --------------------------------------------------------------------------------------\n-\tThreeStep (based on xQuasar's King Clang spawner)\n+\tRonan (based on xQuasar's King Clang spawner)\n \n **/\n function init() {"}, {"sha": "15c4378bae218bc9518847a0064c8e8a6d8e13a2", "filename": "scripts/event/HorntailBattle.js", "status": "renamed", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/event/HorntailBattle.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/event/HorntailBattle.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/event/HorntailBattle.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -6,7 +6,7 @@\n importPackage(Packages.server.life);\n \n var isPq = true;\n-var minPlayers = 1, maxPlayers = 30;\n+var minPlayers = 6, maxPlayers = 30;\n var minLevel = 100, maxLevel = 255;\n var entryMap = 240060000;\n var exitMap = 240050600;", "previous_filename": "scripts/event/HorntailFight.js"}, {"sha": "b9db13363599157b9cd4fa89ec20c6f7e826027d", "filename": "scripts/event/HorntailPQ.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/event/HorntailPQ.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/event/HorntailPQ.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/event/HorntailPQ.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -4,7 +4,7 @@\n */\n \n var isPq = true;\n-var minPlayers = 1, maxPlayers = 6;\n+var minPlayers = 6, maxPlayers = 6;\n var minLevel = 120, maxLevel = 255;\n var entryMap = 240050100;\n var exitMap = 240050500;"}, {"sha": "52b7c192e3cecd1611268b7508f167a3726dfb39", "filename": "scripts/event/OrbisPQ_old.js", "status": "removed", "additions": 0, "deletions": 298, "changes": 298, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/c09bc02c85071c7a832974f5606403398af590e5/scripts/event/OrbisPQ_old.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/c09bc02c85071c7a832974f5606403398af590e5/scripts/event/OrbisPQ_old.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/event/OrbisPQ_old.js?ref=c09bc02c85071c7a832974f5606403398af590e5", "patch": "@@ -1,298 +0,0 @@\n-/* \n- * This file is part of the OdinMS Maple Story Server\n-    Copyright (C) 2008 Patrick Huy <patrick.huy@frz.cc> \n-                       Matthias Butz <matze@odinms.de>\n-                       Jan Christian Meyer <vimes@odinms.de>\n-\n-    This program is free software: you can redistribute it and/or modify\n-    it under the terms of the GNU Affero General Public License version 3\n-    as published by the Free Software Foundation. You may not use, modify\n-    or distribute this program under any other version of the\n-    GNU Affero General Public License.\n-\n-    This program is distributed in the hope that it will be useful,\n-    but WITHOUT ANY WARRANTY; without even the implied warranty of\n-    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n-    GNU Affero General Public License for more details.\n-\n-    You should have received a copy of the GNU Affero General Public License\n-    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n-\t\n-\tTHIS  FILE WAS MADE BY JVLAPLE. REMOVING THIS NOTICE MEANS YOU CAN'T USE THIS SCRIPT OR ANY OTHER SCRIPT PROVIDED BY JVLAPLE.\n- */\n-\n-/*\n- * @Author Jvlaple\n- * \n- * Orbis Party Quest\n- */\n-\n-importPackage(java.lang);\n-importPackage(Packages.world);\n-importPackage(Packages.client);\n-importPackage(Packages.server.maps);\n-importPackage(Packages.server.life);\n-importPackage(Packages.scripting.npc);\n-\n-var exitMap;\n-var instanceId;\n-var minPlayers = 1;\n-\n-function init() {\n-    instanceId = 1;\n-}\n-\n-\n-\n-function monsterValue(eim, mobId) {\n-    return 1;\n-}\n-\n-function setup() {\n-    instanceId = em.getChannelServer().getInstanceId();\n-    exitMap = em.getChannelServer().getMapFactory().getMap(920011200); //Teh exit map :) <---------t\n-    var instanceName = \"OrbisPQ\" + instanceId;\n-    var eim = em.newInstance(instanceName);\n-    var mf = eim.getMapFactory();\n-    em.getChannelServer().addInstanceId();\n-    var map = mf.getMap(920010000);//wutt\n-    //map.shuffleReactors();\n-    // eim.addMapInstance(920010000,map);\n-    //var firstPortal = eim.getMapInstance(920010000).getPortal(\"in00\");\n-    //firstPortal.setScriptName(\"hontale_BtoB1\");\n-    //Fuck this timer\n-    //eim.setProperty(\"bulbWay\", 0);\n-    //Define all Maps and PortalScripts\n-    var centerMap = eim.getMapInstance(920010100);\n-    centerMap.getPortal(13).setScriptName(\"orbisPQSealedRoom\");\n-    centerMap.getPortal(4).setScriptName(\"orbisPQWalkway\");\n-    centerMap.getPortal(12).setScriptName(\"orbisPQStorage\");\n-    centerMap.getPortal(5).setScriptName(\"orbisPQLobby\");\n-    centerMap.getPortal(14).setScriptName(\"orbisPQOnTheWayUp\");\n-    centerMap.getPortal(15).setScriptName(\"orbisPQLounge\");\n-    centerMap.getPortal(16).setScriptName(\"orbisPQRoomOfDarkness\");\n-    var walkwayMap = eim.getMapInstance(920010200);\n-    var storageMap = eim.getMapInstance(920010300);\n-    var lobbyMap = eim.getMapInstance(920010400);\n-    var sealedRoomMap = eim.getMapInstance(920010500);\n-    var loungeMap = eim.getMapInstance(920010600);\n-    var onTheWayUpMap = eim.getMapInstance(920010700);\n-    var bossMap = eim.getMapInstance(920010800);\n-    var jailMap = eim.getMapInstance(920010900);\n-    var roomOfDarknessMap = eim.getMapInstance(920011000);\n-    var bonusMap = eim.getMapInstance(920011100);\n-    var endMap = eim.getMapInstance(920011300);\n-    walkwayMap.getPortal(13).setScriptName(\"orbisPQWalkwayExit\");\n-    storageMap.getPortal(1).setScriptName(\"orbisPQStorageExit\");\n-    lobbyMap.getPortal(8).setScriptName(\"orbisPQLobbyExit\");\n-    sealedRoomMap.getPortal(3).setScriptName(\"orbisPQSRExit\");\n-    loungeMap.getPortal(17).setScriptName(\"orbisPQLoungeExit\");\n-    onTheWayUpMap.getPortal(23).setScriptName(\"orbisPQOnTheWayUpExit\");\n-    bossMap.getPortal(1).setScriptName(\"orbisPQGardenExit\");\n-    roomOfDarknessMap.getPortal(1).setScriptName(\"orbisPQRoomOfDarknessExit\");\n-    //-->Fuck we are done with portals -.-\n-    eim.setProperty(\"killedCellions\", \"0\");\n-    eim.setProperty(\"papaSpawned\", \"no\");\n-    em.schedule(\"timeOut\", 60 * 60000);\n-    em.schedule(\"broadcastClock\", 1500);\n-    eim.setProperty(\"entryTimestamp\",System.currentTimeMillis() + (60 * 60000));\n-\t\n-    return eim;\n-}\n-\n-function afterSetup(eim) {}\n-\n-function playerEntry(eim, player) {\n-    var map = eim.getMapInstance(920010000);\n-    player.changeMap(map, map.getPortal(0));\n-    player.getClient().getSession().write(net.sf.odinms.tools.MaplePacketCreator.getClock((Long.parseLong(eim.getProperty(\"entryTimestamp\")) - System.currentTimeMillis()) / 1000));\n-    var texttt = \"Hi, my name is Eak, the Chamberlain of the Goddess. Don't be alarmed; you won't be able to see me right now. Back when the Goddess turned into a block of stone, I simultaneously lost my own power. If you gather up the power of the Magic Cloud of Orbis, however, then I'll be able to recover my body and re-transform back to my original self. Please collect #b20#k Magic Clouds and bring them back to me. Right now, you'll only see me as a tiny, flickering light.\"\n-    player.getClient().getSession().write(net.sf.odinms.tools.MaplePacketCreator.getNPCTalk(2013001, /*(byte)*/ 0, texttt, \"00 00\"));\n-//player.getClient().getSession().write(net.sf.odinms.scripting.npc.NPCScriptManager.dispose(eim.getClient()));\n-//THE CLOCK IS SHIT\n-//player.getClient().getSession().write(net.sf.odinms.tools.MaplePacketCreator.getClock(1800));\n-}\n-\n-function playerDead(eim, player) {\n-}\n-\n-function playerRevive(eim, player) {\n-    if (eim.isLeader(player)) { //check for party leader\n-        //boot whole party and end\n-        var party = eim.getPlayers();\n-        for (var i = 0; i < party.size(); i++) {\n-            playerExit(eim, party.get(i));\n-        }\n-        eim.dispose();\n-    }\n-    else { //boot dead player\n-        // If only 5 players are left, uncompletable:\n-        var party = eim.getPlayers();\n-        if (party.size() <= minPlayers) {\n-            for (var i = 0; i < party.size(); i++) {\n-                playerExit(eim,party.get(i));\n-            }\n-            eim.dispose();\n-        }\n-        else\n-            playerExit(eim, player);\n-    }\n-}\n-\n-function playerDisconnected(eim, player) {\n-    if (eim.isLeader(player)) { //check for party leader\n-        //PWN THE PARTY (KICK OUT)\n-        var party = eim.getPlayers();\n-        for (var i = 0; i < party.size(); i++) {\n-            if (party.get(i).equals(player)) {\n-                removePlayer(eim, player);\n-            }\n-            else {\n-                playerExit(eim, party.get(i));\n-            }\n-        }\n-        eim.dispose();\n-    }\n-    else { //KICK THE D/CED CUNT\n-        // If only 5 players are left, uncompletable:\n-        var party = eim.getPlayers();\n-        if (party.size() < minPlayers) {\n-            for (var i = 0; i < party.size(); i++) {\n-                playerExit(eim,party.get(i));\n-            }\n-            eim.dispose();\n-        }\n-        else\n-            playerExit(eim, player);\n-    }\n-}\n-\n-function leftParty(eim, player) {\t\t\t\n-    // If only 5 players are left, uncompletable:\n-    var party = eim.getPlayers();\n-    if (party.size() <= minPlayers) {\n-        for (var i = 0; i < party.size(); i++) {\n-            playerExit(eim,party.get(i));\n-        }\n-        eim.dispose();\n-    }\n-    else\n-        playerExit(eim, player);\n-}\n-\n-function disbandParty(eim) {\n-    //boot whole party and end\n-    var party = eim.getPlayers();\n-    for (var i = 0; i < party.size(); i++) {\n-        playerExit(eim, party.get(i));\n-    }\n-    eim.dispose();\n-}\n-\n-function playerUnregistered(eim, player) {}\n-\n-function playerExit(eim, player) {\n-    eim.unregisterPlayer(player);\n-    player.cancelAllBuffs(); //We don't want people going out with wonky blessing >=(\n-    player.changeMap(exitMap, exitMap.getPortal(0));\n-}\n-\n-//Those offline cuntts\n-function removePlayer(eim, player) {\n-    eim.unregisterPlayer(player);\n-    player.getMap().removePlayer(player);\n-    player.setMap(exitMap);\n-}\n-\n-function clearPQ(eim) {\n-    // W00t! Bonus!!\n-    var iter = eim.getPlayers().iterator();\n-    var bonusMap = eim.getMapInstance(920011100);\n-    while (iter.hasNext()) {\n-        var player = iter.next();\n-        player.changeMap(bonusMap, bonusMap.getPortal(0));\n-        eim.setProperty(\"entryTimestamp\",System.currentTimeMillis() + (1 * 60000));\n-        player.getClient().getSession().write(net.sf.odinms.tools.MaplePacketCreator.getClock(60));\n-    }\n-    eim.schedule(\"finish\", 60000)\n-}\n-\n-function finish(eim) {\n-    var dMap = eim.getMapInstance(920011300);\n-    var iter = eim.getPlayers().iterator();\n-    while (iter.hasNext()) {\n-        var player = iter.next();\n-        eim.unregisterPlayer(player);\n-        player.changeMap(dMap, dMap.getPortal(0));\n-    }\n-    eim.dispose();\n-}\n-\n-function monsterKilled(mob, eim) {}\n-\n-function allMonstersDead(eim) {} //Open Portal? o.O\n-\n-function cancelSchedule() {\n-}\n-\n-function timeOut() {\n-    var iter = em.getInstances().iterator();\n-    while (iter.hasNext()) {\n-        var eim = iter.next();\n-        if (eim.getPlayerCount() > 0) {\n-            var pIter = eim.getPlayers().iterator();\n-            while (pIter.hasNext()) {\n-                playerExit(eim, pIter.next());\n-            }\n-        }\n-        eim.dispose();\n-    }\n-}\n-\n-function playerClocks(eim, player) {\n-    if (player.getMap().hasTimer() == false){\n-        player.getClient().getSession().write(net.sf.odinms.tools.MaplePacketCreator.getClock((Long.parseLong(eim.getProperty(\"entryTimestamp\")) - System.currentTimeMillis()) / 1000));\n-    //player.getMap().setTimer(true);\n-    }\n-}\n-\n-function playerTimer(eim, player) {\n-    if (player.getMap().hasTimer() == false) {\n-        player.getMap().setTimer(true);\n-    }\n-}\n-\n-function broadcastClock(eim, player) {\n-    //var party = eim.getPlayers();\n-    var iter = em.getInstances().iterator();\n-    while (iter.hasNext()) {\n-        var eim = iter.next();\n-        if (eim.getPlayerCount() > 0) {\n-            var pIter = eim.getPlayers().iterator();\n-            while (pIter.hasNext()) {\n-                playerClocks(eim, pIter.next());\n-            }\n-        }\n-    //em.schedule(\"broadcastClock\", 1600);\n-    }\n-    // for (var kkl = 0; kkl < party.size(); kkl++) {\n-    // party.get(kkl).getMap().setTimer(true);\n-    // }\n-    var iterr = em.getInstances().iterator();\n-    while (iterr.hasNext()) {\n-        var eim = iterr.next();\n-        if (eim.getPlayerCount() > 0) {\n-            var pIterr = eim.getPlayers().iterator();\n-            while (pIterr.hasNext()) {\n-                //playerClocks(eim, pIter.next());\n-                playerTimer(eim, pIterr.next());\n-            }\n-        }\n-    //em.schedule(\"broadcastClock\", 1600);\n-    }\n-    em.schedule(\"broadcastClock\", 1600);\n-}\n-\n-function dispose() {\n-\n-}\n\\ No newline at end of file"}, {"sha": "e39b1fe2be3de8ad04ec4294b27a175e2c4199c9", "filename": "scripts/event/PinkBeanBattle.js", "status": "added", "additions": 262, "deletions": 0, "changes": 262, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/event/PinkBeanBattle.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/event/PinkBeanBattle.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/event/PinkBeanBattle.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -0,0 +1,262 @@\n+/**\n+ * @author: Ronan\n+ * @event: Pink Bean Battle\n+*/\n+\n+importPackage(Packages.server.life);\n+importPackage(Packages.client.inventory);\n+\n+var isPq = true;\n+var minPlayers = 6, maxPlayers = 30;\n+var minLevel = 120, maxLevel = 255;\n+var entryMap = 270050100;\n+var exitMap = 270050300;\n+var recruitMap = 270050000;\n+var clearMap = 270050300;\n+\n+var minMapId = 270050100;\n+var maxMapId = 270050300;\n+\n+var eventTime = 100;     // 100 minutes\n+\n+var lobbyRange = [0, 0];\n+\n+function init() {\n+        setEventRequirements();\n+}\n+\n+function setLobbyRange() {\n+        return lobbyRange;\n+}\n+\n+function setEventRequirements() {\n+        var reqStr = \"\";\n+        \n+        reqStr += \"\\r\\n    Number of players: \";\n+        if(maxPlayers - minPlayers >= 1) reqStr += minPlayers + \" ~ \" + maxPlayers;\n+        else reqStr += minPlayers;\n+        \n+        reqStr += \"\\r\\n    Level range: \";\n+        if(maxLevel - minLevel >= 1) reqStr += minLevel + \" ~ \" + maxLevel;\n+        else reqStr += minLevel;\n+        \n+        reqStr += \"\\r\\n    Time limit: \";\n+        reqStr += eventTime + \" minutes\";\n+        \n+        em.setProperty(\"party\", reqStr);\n+}\n+\n+function setEventExclusives(eim) {\n+        var itemSet = [];\n+        eim.setExclusiveItems(itemSet);\n+}\n+\n+function setEventRewards(eim) {\n+        var itemSet, itemQty, evLevel, expStages, mesoStages;\n+\n+        evLevel = 1;    //Rewards at clear PQ\n+        itemSet = [];\n+        itemQty = [];\n+        eim.setEventRewards(evLevel, itemSet, itemQty);\n+        \n+        expStages = [];    //bonus exp given on CLEAR stage signal\n+        eim.setEventClearStageExp(expStages);\n+        \n+        mesoStages = [];    //bonus meso given on CLEAR stage signal\n+        eim.setEventClearStageMeso(mesoStages);\n+}\n+\n+function afterSetup(eim) {\n+    eim.dropMessage(5, \"The first wave will start within 15 seconds, prepare yourselves.\");\n+    eim.schedule(\"startWave\", 15 * 1000);\n+}\n+\n+function setup(channel) {\n+    var eim = em.newInstance(\"PinkBean\" + channel);\n+    eim.setProperty(\"canJoin\", 1);\n+    eim.setProperty(\"defeatedBoss\", 0);\n+    eim.setProperty(\"fallenPlayers\", 0);\n+    \n+    eim.setProperty(\"stage\", 1);\n+    eim.setProperty(\"channel\", channel);\n+\n+    var level = 1;\n+    eim.getInstanceMap(270050100).resetPQ(level);\n+    eim.getInstanceMap(270050200).resetPQ(level);\n+    eim.getInstanceMap(270050300).resetPQ(level);\n+    \n+    var mob = MapleLifeFactory.getMonster(8820000);\n+    eim.getInstanceMap(270050100).spawnMonsterOnGroundBelow(mob, new java.awt.Point(0, -42));\n+    \n+    eim.startEventTimer(eventTime * 60000);\n+    setEventRewards(eim);\n+    setEventExclusives(eim);\n+    \n+    return eim;\n+}\n+\n+function playerEntry(eim, player) {\n+    eim.dropMessage(5, \"[Expedition] \" + player.getName() + \" has entered the map.\");\n+    var map = eim.getMapInstance(entryMap);\n+    player.changeMap(map, map.getPortal(0));\n+}\n+\n+function scheduledTimeout(eim) {\n+    end(eim);\n+}\n+\n+function changedMap(eim, player, mapid) {\n+    if (mapid < minMapId || mapid > maxMapId) {\n+\tif (eim.isEventTeamLackingNow(true, minPlayers, player)) {\n+            eim.dropMessage(5, \"[Expedition] Either the leader has quitted the event or there is no longer the minimum number of members required to continue this event.\");\n+            eim.unregisterPlayer(player);\n+            end(eim);\n+        }\n+        else {\n+            eim.dropMessage(5, \"[Expedition] \" + player.getName() + \" has left the event.\");\n+            eim.unregisterPlayer(player);\n+        }\n+    }\n+}\n+\n+function changedLeader(eim, leader) {}\n+\n+function playerDead(eim, player) {\n+    var count = eim.getIntProperty(\"fallenPlayers\");\n+    count = count + 1;\n+    \n+    eim.setIntProperty(\"fallenPlayers\", count);\n+    \n+    if(count == 5) {\n+        eim.dropMessage(5, \"[Expedition] Too much players have fallen, Pink Bean is now deemed undefeatable, the expedition is over.\");\n+        end(eim);\n+    } else if(count == 4) {\n+        eim.dropMessage(5, \"[Expedition] Pink Bean is glowing stronger than ever, last stand mode everyone!\");\n+    } else if(count == 3) {\n+        eim.dropMessage(5, \"[Expedition] Casualty count is starting to get out of control. Take care folks.\");\n+    }\n+}\n+\n+function playerRevive(eim, player) {\n+    return true;\n+}\n+\n+function playerDisconnected(eim, player) {\n+    if (eim.isEventTeamLackingNow(true, minPlayers, player)) {\n+        eim.dropMessage(5, \"[Expedition] Either the leader has quitted the event or there is no longer the minimum number of members required to continue this event.\");\n+        eim.unregisterPlayer(player);\n+        end(eim);\n+    }\n+    else {\n+        eim.dropMessage(5, \"[Expedition] \" + player.getName() + \" has left the event.\");\n+        eim.unregisterPlayer(player);\n+    }\n+}\n+\n+function leftParty (eim, player) {}\n+\n+function disbandParty (eim) {}\n+\n+function monsterValue(eim, mobId) {\n+    return 1;\n+}\n+\n+function playerUnregistered(eim, player) {}\n+\n+function playerExit(eim, player) {\n+    eim.unregisterPlayer(player);\n+    player.changeMap(exitMap, 0);\n+}\n+\n+function end(eim) {\n+    var party = eim.getPlayers();\n+    for (var i = 0; i < party.size(); i++) {\n+        playerExit(eim, party.get(i));\n+    }\n+    eim.dispose();\n+}\n+\n+function giveRandomEventReward(eim, player) {\n+    eim.giveEventReward(player);\n+}\n+\n+function clearPQ(eim) {\n+    eim.stopEventTimer();\n+    eim.setEventCleared();\n+}\n+\n+function isPinkBean(mob) {\n+    var mobid = mob.getId();\n+    return (mobid == 8820001);\n+}\n+\n+function isJrBoss(mob) {\n+    var mobid = mob.getId();\n+    return (mobid >= 8820002 && mobid <= 8820006);\n+}\n+\n+function noJrBossesLeft(map) {\n+    return map.countMonster(8820002, 8820006) == 0;\n+}\n+\n+function spawnJrBoss(mobObj, gotKilled) {\n+    if(gotKilled) {\n+        spawnid = mobObj.getId() + 17;\n+        \n+    } else {\n+        mobObj.getMap().killMonster(mobObj.getId());\n+        spawnid = mobObj.getId() - 17;\n+    }\n+    \n+    var mob = MapleLifeFactory.getMonster(spawnid);\n+    mobObj.getMap().spawnMonsterOnGroundBelow(mob, mobObj.getPosition());\n+}\n+\n+function monsterKilled(mob, eim) {\n+    if(isPinkBean(mob)) {\n+        eim.setIntProperty(\"defeatedBoss\", 1);\n+        eim.showClearEffect(mob.getMap().getId());\n+        mob.getMap().killAllMonstersNotFriendly();\n+        eim.clearPQ();\n+        \n+        var ch = eim.getIntProperty(\"channel\");\n+        mob.getMap().broadcastPinkBeanVictory(ch);\n+    } else if(isJrBoss(mob)) {\n+        if(noJrBossesLeft(mob.getMap())) {\n+            var stage = eim.getIntProperty(\"stage\");\n+            \n+            if(stage == 5) {\n+                var iid = 4001193;\n+                var itemObj = new Item(iid, 0, 1);\n+                var mapObj = eim.getMapFactory().getMap(270050100);\n+                var reactObj = mapObj.getReactorById(2708000);\n+                var dropper = eim.getPlayers().get(0);\n+                mapObj.spawnItemDrop(dropper, dropper, itemObj, reactObj.getPosition(), true, true);\n+\n+\n+                eim.dropMessage(6, \"With the last of his guardians' fall, Pink Bean loses his invulnerability. The real fight starts now!\");\n+            } else {\n+                stage++;\n+                eim.setIntProperty(\"stage\", stage);\n+                \n+                eim.dropMessage(5, \"The next wave will start within 15 seconds, prepare yourselves.\");\n+                eim.schedule(\"startWave\", 15 * 1000);\n+            }\n+        }\n+    } \n+}\n+\n+function startWave(eim) {\n+    var mapObj = eim.getMapInstance(270050100);\n+    var stage = eim.getProperty(\"stage\");\n+    \n+    for(var i = 1; i <= stage; i++) {\n+        spawnJrBoss(mapObj.getMonsterById(8820019 + (i % 5)), false);\n+    }\n+}\n+\n+function allMonstersDead(eim) {}\n+\n+function cancelSchedule() {}\n+\n+function dispose(eim) {}"}, {"sha": "99c6827366df8d205d50eb890399953210118ca1", "filename": "scripts/event/ScargaBattle.js", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/event/ScargaBattle.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/event/ScargaBattle.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/event/ScargaBattle.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -5,7 +5,7 @@\n \n var isPq = true;\n var minPlayers = 6, maxPlayers = 30;\n-var minLevel = 70, maxLevel = 255;\n+var minLevel = 100, maxLevel = 255;\n var entryMap = 551030200;\n var exitMap = 551030100;\n var recruitMap = 551030100;\n@@ -52,8 +52,8 @@ function setEventRewards(eim) {\n         var itemSet, itemQty, evLevel, expStages, mesoStages;\n \n         evLevel = 1;    //Rewards at clear PQ\n-        itemSet = [];\n-        itemQty = [];\n+        itemSet = [1102145, 1102084, 1102085, 1102086, 1102087, 1052165, 1052166, 1052167, 1402013, 1332030, 1032030, 1032070, 4003000, 4000030, 4006000, 4006001, 4005000, 4005001, 4005002, 4005003, 4005004, 2022016, 2022263, 2022264, 2022015, 2022306, 2022307, 2022306, 2022113];\n+        itemQty = [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 50, 50, 120, 120, 4, 4, 4, 4, 2, 125, 125, 125, 30, 30, 30, 30, 30];\n         eim.setEventRewards(evLevel, itemSet, itemQty);\n         \n         expStages = [];    //bonus exp given on CLEAR stage signal"}, {"sha": "ec9d042fed8ce63b46cfaa0e9d8e80cdca6c29a4", "filename": "scripts/event/ShowaBattle.js", "status": "added", "additions": 190, "deletions": 0, "changes": 190, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/event/ShowaBattle.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/event/ShowaBattle.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/event/ShowaBattle.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -0,0 +1,190 @@\n+/**\n+ * @author: Ronan\n+ * @event: Showa Boss Battle\n+*/\n+\n+var isPq = true;\n+var minPlayers = 3, maxPlayers = 30;\n+var minLevel = 100, maxLevel = 255;\n+var entryMap = 801040100;\n+var exitMap = 801040004;\n+var recruitMap = 801040004;\n+var clearMap = 801040101;\n+\n+var minMapId = 801040100;\n+var maxMapId = 801040100;\n+\n+var eventTime = 60;     // 60 minutes for boss stg\n+\n+var lobbyRange = [0, 0];\n+\n+function init() {\n+        setEventRequirements();\n+}\n+\n+function setLobbyRange() {\n+        return lobbyRange;\n+}\n+\n+function setEventRequirements() {\n+        var reqStr = \"\";\n+        \n+        reqStr += \"\\r\\n    Number of players: \";\n+        if(maxPlayers - minPlayers >= 1) reqStr += minPlayers + \" ~ \" + maxPlayers;\n+        else reqStr += minPlayers;\n+        \n+        reqStr += \"\\r\\n    Level range: \";\n+        if(maxLevel - minLevel >= 1) reqStr += minLevel + \" ~ \" + maxLevel;\n+        else reqStr += minLevel;\n+        \n+        reqStr += \"\\r\\n    Time limit: \";\n+        reqStr += eventTime + \" minutes\";\n+        \n+        em.setProperty(\"party\", reqStr);\n+}\n+\n+function setEventExclusives(eim) {\n+        var itemSet = [];\n+        eim.setExclusiveItems(itemSet);\n+}\n+\n+function setEventRewards(eim) {\n+        var itemSet, itemQty, evLevel, expStages, mesoStages;\n+\n+        evLevel = 1;    //Rewards at clear PQ\n+        itemSet = [1102145, 1102084, 1102085, 1102086, 1102087, 1052165, 1052166, 1052167, 1402013, 1332030, 1032030, 1032070, 4003000, 4000030, 4006000, 4006001, 4005000, 4005001, 4005002, 4005003, 4005004, 2022016, 2022263, 2022264, 2022015, 2022306, 2022307, 2022306, 2022113];\n+        itemQty = [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 40, 40, 100, 100, 2, 2, 2, 2, 1, 100, 100, 100, 40, 40, 40, 40, 40];\n+        eim.setEventRewards(evLevel, itemSet, itemQty);\n+        \n+        expStages = [];    //bonus exp given on CLEAR stage signal\n+        eim.setEventClearStageExp(expStages);\n+        \n+        mesoStages = [];    //bonus meso given on CLEAR stage signal\n+        eim.setEventClearStageMeso(mesoStages);\n+}\n+\n+function afterSetup(eim) {}\n+\n+function setup(channel) {\n+    var eim = em.newInstance(\"Showa\" + channel);\n+    eim.setProperty(\"canJoin\", 1);\n+\n+    var level = 1;\n+    eim.getInstanceMap(801040100).resetPQ(level);\n+    \n+    respawnStages(eim);\n+    eim.startEventTimer(eventTime * 60000);\n+    setEventRewards(eim);\n+    setEventExclusives(eim);\n+    \n+    return eim;\n+}\n+\n+function respawnStages(eim) {\n+    eim.getInstanceMap(801040100).instanceMapRespawn();\n+\n+    eim.schedule(\"respawnStages\", 15 * 1000);\n+}\n+\n+function playerEntry(eim, player) {\n+    eim.dropMessage(5, \"[Expedition] \" + player.getName() + \" has entered the map.\");\n+    var map = eim.getMapInstance(entryMap);\n+    player.changeMap(map, map.getPortal(0));\n+}\n+\n+function scheduledTimeout(eim) {\n+    end(eim);\n+}\n+\n+function changedMap(eim, player, mapid) {\n+    if (mapid < minMapId || mapid > maxMapId) {\n+\tif (eim.isEventTeamLackingNow(true, minPlayers, player)) {\n+            eim.dropMessage(5, \"[Expedition] Either the leader has quitted the event or there is no longer the minimum number of members required to continue this event.\");\n+            eim.unregisterPlayer(player);\n+            end(eim);\n+        }\n+        else {\n+            eim.dropMessage(5, \"[Expedition] \" + player.getName() + \" has left the event.\");\n+            eim.unregisterPlayer(player);\n+        }\n+    }\n+}\n+\n+function changedLeader(eim, leader) {}\n+\n+function playerDead(eim, player) {}\n+\n+function playerRevive(eim, player) {\n+    if (eim.isEventTeamLackingNow(true, minPlayers, player)) {\n+        eim.unregisterPlayer(player);\n+        eim.dropMessage(5, \"[Expedition] Either the leader has quitted the event or there is no longer the minimum number of members required to continue this event.\");\n+        end(eim);\n+    }\n+    else {\n+        eim.dropMessage(5, \"[Expedition] \" + player.getName() + \" has left the event.\");\n+        eim.unregisterPlayer(player);\n+    }\n+}\n+\n+function playerDisconnected(eim, player) {\n+    if (eim.isEventTeamLackingNow(true, minPlayers, player)) {\n+        eim.dropMessage(5, \"[Expedition] Either the leader has quitted the event or there is no longer the minimum number of members required to continue this event.\");\n+        eim.unregisterPlayer(player);\n+        end(eim);\n+    }\n+    else {\n+        eim.dropMessage(5, \"[Expedition] \" + player.getName() + \" has left the event.\");\n+        eim.unregisterPlayer(player);\n+    }\n+}\n+\n+function leftParty (eim, player) {}\n+\n+function disbandParty (eim) {}\n+\n+function monsterValue(eim, mobId) {\n+    return 1;\n+}\n+\n+function playerUnregistered(eim, player) {}\n+\n+function playerExit(eim, player) {\n+    eim.unregisterPlayer(player);\n+    player.changeMap(exitMap, 0);\n+}\n+\n+function end(eim) {\n+    var party = eim.getPlayers();\n+    for (var i = 0; i < party.size(); i++) {\n+        playerExit(eim, party.get(i));\n+    }\n+    eim.dispose();\n+}\n+\n+function giveRandomEventReward(eim, player) {\n+    eim.giveEventReward(player);\n+}\n+\n+function clearPQ(eim) {\n+    eim.getInstanceMap(801040100).killAllMonstersNotFriendly();\n+    \n+    eim.stopEventTimer();\n+    eim.setEventCleared();\n+}\n+\n+function isTheBoss(mob) {\n+        return mob.getId() == 9400300;\n+}\n+\n+function monsterKilled(mob, eim) {\n+    if(isTheBoss(mob)) {\n+        eim.showClearEffect();\n+        eim.clearPQ();\n+    }\n+}\n+\n+function allMonstersDead(eim) {}\n+\n+function cancelSchedule() {}\n+\n+function dispose(eim) {}\n\\ No newline at end of file"}, {"sha": "88c5448bdd01785ac4c4af1fcdae9dfec0b03a94", "filename": "scripts/event/ZakumBattle.js", "status": "modified", "additions": 147, "deletions": 150, "changes": 297, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/event/ZakumBattle.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/event/ZakumBattle.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/event/ZakumBattle.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -1,195 +1,192 @@\n-/* \n- * This file is part of the OdinMS Maple Story Server\n-    Copyright (C) 2008 Patrick Huy <patrick.huy@frz.cc> \n-                       Matthias Butz <matze@odinms.de>\n-                       Jan Christian Meyer <vimes@odinms.de>\n-\n-    This program is free software: you can redistribute it and/or modify\n-    it under the terms of the GNU Affero General Public License version 3\n-    as published by the Free Software Foundation. You may not use, modify\n-    or distribute this program under any other version of the\n-    GNU Affero General Public License.\n-\n-    This program is distributed in the hope that it will be useful,\n-    but WITHOUT ANY WARRANTY; without even the implied warranty of\n-    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n-    GNU Affero General Public License for more details.\n-\n-    You should have received a copy of the GNU Affero General Public License\n-    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n- */\n-\n-/*\n- * @Author Stereo\n- * @Modified By XkelvinchiaX(Kelvin)\n- * @Modified By Moogra\n- * @Modified By SharpAceX(Alan)\n- * Zakum Battle\n- */\n-\n-var exitMap;\n-var altarMap;\n-var minPlayers = 1;\n-var fightTime = 75;\n-var altarTime = 15;\n-var gate;\n+/**\n+ * @author: Ronan\n+ * @event: Zakum Battle\n+*/\n+\n+importPackage(Packages.server.life);\n+\n+var isPq = true;\n+var minPlayers = 6, maxPlayers = 30;\n+var minLevel = 50, maxLevel = 255;\n+var entryMap = 280030000;\n+var exitMap = 211042400;\n+var recruitMap = 211042400;\n+var clearMap = 211042400;\n+\n+var minMapId = 280030000;\n+var maxMapId = 280030000;\n+\n+var eventTime = 60;     // 60 minutes\n+\n+var lobbyRange = [0, 0];\n \n function init() {\n-    em.setProperty(\"shuffleReactors\",\"false\");\n-\texitMap = em.getChannelServer().getMapFactory().getMap(211042300);\n-\taltarMap = em.getChannelServer().getMapFactory().getMap(280030000);// Last Mission: Zakum's Altar\n-\tgate = exitMap.getReactorByName(\"gate\");\n-\tgate.setState(0);//Open gate\n+        setEventRequirements();\n+}\n+\n+function setLobbyRange() {\n+        return lobbyRange;\n+}\n+\n+function setEventRequirements() {\n+        var reqStr = \"\";\n+        \n+        reqStr += \"\\r\\n    Number of players: \";\n+        if(maxPlayers - minPlayers >= 1) reqStr += minPlayers + \" ~ \" + maxPlayers;\n+        else reqStr += minPlayers;\n+        \n+        reqStr += \"\\r\\n    Level range: \";\n+        if(maxLevel - minLevel >= 1) reqStr += minLevel + \" ~ \" + maxLevel;\n+        else reqStr += minLevel;\n+        \n+        reqStr += \"\\r\\n    Time limit: \";\n+        reqStr += eventTime + \" minutes\";\n+        \n+        em.setProperty(\"party\", reqStr);\n+}\n+\n+function setEventExclusives(eim) {\n+        var itemSet = [];\n+        eim.setExclusiveItems(itemSet);\n }\n \n-function setup() {\n-    var eim = em.newInstance(\"ZakumBattle_\" + em.getProperty(\"channel\"));\n-\tvar timer = 1000 * 60 * fightTime;\n-\teim.setProperty(\"summoned\", \"false\");\n-    em.schedule(\"timeOut\", eim, timer);\n-\tem.schedule(\"altarTimeOut\", eim, 1000 * 60 * altarTime);\n-    eim.startEventTimer(timer);\n-\tgate.setState(1);//Close gate\n-\treturn eim;\n+function setEventRewards(eim) {\n+        var itemSet, itemQty, evLevel, expStages, mesoStages;\n+\n+        evLevel = 1;    //Rewards at clear PQ\n+        itemSet = [];\n+        itemQty = [];\n+        eim.setEventRewards(evLevel, itemSet, itemQty);\n+        \n+        expStages = [];    //bonus exp given on CLEAR stage signal\n+        eim.setEventClearStageExp(expStages);\n+        \n+        mesoStages = [];    //bonus meso given on CLEAR stage signal\n+        eim.setEventClearStageMeso(mesoStages);\n }\n \n function afterSetup(eim) {}\n \n-function playerEntry(eim,player) {\n-\tvar altar = eim.getMapInstance(altarMap.getId());\n-    player.changeMap(altar, altar.getPortal(0));\n+function setup(channel) {\n+    var eim = em.newInstance(\"Zakum\" + channel);\n+    eim.setProperty(\"canJoin\", 1);\n+    eim.setProperty(\"defeatedBoss\", 0);\n \n-\tplayer.dropMessage(5, \"The Zakum Shrine will close if you do not summon Zakum in \" + altarTime + \" minutes.\");\n-    if (altarMap == null)\n-        debug(eim, \"The altar map was not properly linked.\");\n+    var level = 1;\n+    eim.getInstanceMap(280030000).resetPQ(level);\n+    \n+    eim.startEventTimer(eventTime * 60000);\n+    setEventRewards(eim);\n+    setEventExclusives(eim);\n+    \n+    return eim;\n }\n \n-function playerRevive(eim,player) {\n-    player.setHp(500);\n-    player.setStance(0);\n-    eim.unregisterPlayer(player);\n-    player.changeMap(exitMap, exitMap.getPortal(0));\n-    var exped = eim.getPlayers();\n-    if (exped.size() < minPlayers)\n-        end(eim,\"There are not enough players remaining, the Zakum battle is over.\");\n-    return false;\n+function playerEntry(eim, player) {\n+    eim.dropMessage(5, \"[Expedition] \" + player.getName() + \" has entered the map.\");\n+    var map = eim.getMapInstance(entryMap);\n+    player.changeMap(map, map.getPortal(0));\n }\n \n-function playerDead(eim,player) {\n+function scheduledTimeout(eim) {\n+    end(eim);\n }\n \n-function playerDisconnected(eim,player) {\n-    var exped = eim.getPlayers();\n-    if (player.getName().equals(eim.getProperty(\"leader\"))) {\n-        var iter = exped.iterator();\n-        while (iter.hasNext()) {\n-            iter.next().getPlayer().dropMessage(6, \"The leader of the expedition has disconnected.\");\n-\t\t}\n-    }\n-    //If the expedition is too small.\n-    if (exped.size() < minPlayers) {\n-        end(eim,\"There are not enough players remaining. The Battle is over.\");\n+function changedMap(eim, player, mapid) {\n+    if (mapid < minMapId || mapid > maxMapId) {\n+\tif (eim.isEventTeamLackingNow(true, minPlayers, player)) {\n+            eim.dropMessage(5, \"[Expedition] Either the leader has quitted the event or there is no longer the minimum number of members required to continue this event.\");\n+            eim.unregisterPlayer(player);\n+            end(eim);\n+        }\n+        else {\n+            eim.dropMessage(5, \"[Expedition] \" + player.getName() + \" has left the event.\");\n+            eim.unregisterPlayer(player);\n+        }\n     }\n }\n \n-function monsterValue(eim,mobId) { // potentially display time of death? does not seem to work\n-    if (mobId == 8800002) { // 3rd body\n-        var iter = eim.getPlayers().iterator();\n-        while (iter.hasNext()) {\n-            iter.next().dropMessage(6, \"Congratulations on defeating Zakum!\");\n-\t\t}\n+function changedLeader(eim, leader) {}\n+\n+function playerDead(eim, player) {}\n+\n+function playerRevive(eim, player) {\n+    if (eim.isEventTeamLackingNow(true, minPlayers, player)) {\n+        eim.unregisterPlayer(player);\n+        eim.dropMessage(5, \"[Expedition] Either the leader has quitted the event or there is no longer the minimum number of members required to continue this event.\");\n+        end(eim);\n+    }\n+    else {\n+        eim.dropMessage(5, \"[Expedition] \" + player.getName() + \" has left the event.\");\n+        eim.unregisterPlayer(player);\n     }\n-    return -1;\n }\n \n-function leftParty(eim,player) { // do nothing in Zakum\n+function playerDisconnected(eim, player) {\n+    if (eim.isEventTeamLackingNow(true, minPlayers, player)) {\n+        eim.dropMessage(5, \"[Expedition] Either the leader has quitted the event or there is no longer the minimum number of members required to continue this event.\");\n+        eim.unregisterPlayer(player);\n+        end(eim);\n+    }\n+    else {\n+        eim.dropMessage(5, \"[Expedition] \" + player.getName() + \" has left the event.\");\n+        eim.unregisterPlayer(player);\n+    }\n }\n \n-function disbandParty(eim) { // do nothing in Zakum\n+function leftParty (eim, player) {}\n+\n+function disbandParty (eim) {}\n+\n+function monsterValue(eim, mobId) {\n+    return 1;\n }\n \n-function playerUnregistered(eim, player) {}\n+function playerUnregistered(eim, player) {\n+    if(eim.isEventCleared()) {\n+        em.completeQuest(player, 100200, 2030010);\n+    }\n+}\n \n-function playerExit(eim,player) {\n+function playerExit(eim, player) {\n     eim.unregisterPlayer(player);\n-    player.changeMap(exitMap, exitMap.getPortal(0));\n-    if (eim.getPlayers().size() < minPlayers) {//not enough after someone left\n-        end(eim, \"There are no longer enough players to continue, and those remaining shall be warped out.\");\n-\t}\n+    player.changeMap(exitMap, 0);\n }\n \n-function end(eim,msg) {\n-    var iter = eim.getPlayers().iterator();\n-    while (iter.hasNext()) {\n-        var player = iter.next();\n-        player.getPlayer().dropMessage(6,msg);\n-        eim.unregisterPlayer(player);\n-        if (player != null){\n-            player.changeMap(exitMap, exitMap.getPortal(0));\n-\t\t}\n+function end(eim) {\n+    var party = eim.getPlayers();\n+    for (var i = 0; i < party.size(); i++) {\n+        playerExit(eim, party.get(i));\n     }\n-\tgate.setState(0);//Open gate\n     eim.dispose();\n }\n \n-function removePlayer(eim,player) {\n-    eim.unregisterPlayer(player);\n-    player.getMap().removePlayer(player);\n-    player.setMap(exitMap);\n+function giveRandomEventReward(eim, player) {\n+    eim.giveEventReward(player);\n }\n \n-function clearPQ(eim) { //When the hell does this get executed?\n-    end(eim,\"As the sound of battle fades away, you feel strangely unsatisfied.\");\n+function clearPQ(eim) {\n+    eim.stopEventTimer();\n+    eim.setEventCleared();\n+}\n \n+function isZakum(mob) {\n+    var mobid = mob.getId();\n+    return (mobid == 8800002);\n }\n \n-function finish(eim) {\n-    var iter = eim.getPlayers().iterator();\n-    while (iter.hasNext()) {\n-        var player = iter.next();\n-        eim.unregisterPlayer(player);\n-        player.changeMap(exitMap, exitMap.getPortal(0));\n+function monsterKilled(mob, eim) {\n+    if(isZakum(mob)) {\n+        eim.setIntProperty(\"defeatedBoss\", 1);\n+        eim.showClearEffect(mob.getMap().getId());\n+        eim.clearPQ();\n+        \n+        mob.getMap().broadcastZakumVictory();\n     }\n-    eim.dispose();\n }\n \n-function monsterKilled(mob, eim) {}\n-\n function allMonstersDead(eim) {}\n \n function cancelSchedule() {}\n \n-function altarTimeOut(eim) {\n-    if (eim != null && eim.getProperty(\"summoned\").equals(\"false\")) {\n-        if (eim.getPlayerCount() > 0) {\n-            var pIter = eim.getPlayers().iterator();\n-            while (pIter.hasNext()){\n-\t\t\t\tvar player = pIter.next();\n-\t\t\t\tplayer.dropMessage(6, \"The Shrine has closed since you did not summon Zakum within \" + altarTime + \" minutes.\");\n-                playerExit(eim, player);\n-\t\t\t}\n-        }\n-        eim.dispose();\n-    }\n-}\n-\n-function timeOut(eim) {\n-    if (eim != null) {\n-        if (eim.getPlayerCount() > 0) {\n-            var pIter = eim.getPlayers().iterator();\n-            while (pIter.hasNext()){\n-\t\t\t\tvar player = pIter.next();\n-\t\t\t\tplayer.dropMessage(6, \"You have run out of time to defeat Zakum!\");\n-                playerExit(eim, player);\n-\t\t\t}\n-        }\n-        eim.dispose();\n-    }\n-}\n-\n-function debug(eim,msg) {\n-    var iter = eim.getPlayers().iterator();\n-    while (iter.hasNext()) {\n-        iter.next().getClient().getSession().write(Packages.tools.MaplePacketCreator.serverNotice(6,msg));\n-    }\n-}\n\\ No newline at end of file\n+function dispose(eim) {}"}, {"sha": "689e3071495f22383557105866ce87b20123aad9", "filename": "scripts/event/ZakumPQ.js", "status": "modified", "additions": 188, "deletions": 126, "changes": 314, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/event/ZakumPQ.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/event/ZakumPQ.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/event/ZakumPQ.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -1,165 +1,227 @@\n-/* \n- * This file is part of the OdinMS Maple Story Server\n-    Copyright (C) 2008 Patrick Huy <patrick.huy@frz.cc> \n-                       Matthias Butz <matze@odinms.de>\n-                       Jan Christian Meyer <vimes@odinms.de>\n-\n-    This program is free software: you can redistribute it and/or modify\n-    it under the terms of the GNU Affero General Public License version 3\n-    as published by the Free Software Foundation. You may not use, modify\n-    or distribute this program under any other version of the\n-    GNU Affero General Public License.\n-\n-    This program is distributed in the hope that it will be useful,\n-    but WITHOUT ANY WARRANTY; without even the implied warranty of\n-    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n-    GNU Affero General Public License for more details.\n-\n-    You should have received a copy of the GNU Affero General Public License\n-    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n- */\n-\n-/*\n- * @Author Lerk\n- * \n- * Zakum Party Quest \n- */\n-\n-var exitMap;\n-var instanceId;\n+/**\n+ * @author: Ronan\n+ * @event: Zakum PQ\n+*/\n+\n+var isPq = true;\n+var minPlayers = 1, maxPlayers = 6;\n+var minLevel = 50, maxLevel = 255;\n+var entryMap = 280010000;\n+var exitMap = 211042300;\n+var recruitMap = 211042300;\n+var clearMap = 211042300;\n+\n+var minMapId = 280010000;\n+var maxMapId = 280011006;\n+\n+var eventTime = 30;     // 30 minutes\n+\n+var lobbyRange = [0, 0];\n \n function init() {\n-    instanceId = 1;\n-    em.setProperty(\"shuffleReactors\",\"true\");\n+        setEventRequirements();\n }\n \n-function monsterValue(eim, mobId) {\n-    return 1;\n-}\n-\n-function setup() {\n-    exitMap = em.getChannelServer().getMapFactory().getMap(280090000); //room of tragedy\n-    var instanceName = \"ZakumPQ\" + instanceId;\n-\t\n-    //ZPQ maps, center area then 1-1 through 16-6 increasing gradually\n-    //var instanceMaps = new Array(280010000, 280010010, 280010011, 280010020, 280010030, 280010031, 280010040, 280010041, 280010050, 280010060,\n-    //\t280010070, 280010071, 280010080, 280010081, 280010090, 280010091, 280010100, 280010101, 280010110, 280010120, 280010130, 280010140,\n-    //\t280010150, 280011000, 280011001, 280011002, 280011003, 280011004, 280011005, 280011006);\n-    var eim = em.newInstance(instanceName);\n-\t\n-    var mf = eim.getMapFactory();\n-\t\n-    instanceId++;\n-\t\n-    var map = mf.getMap(280010000);\n-    map.shuffleReactors();\n-\t\n-    //no time limit yet until clock can be visible in all maps\n-    //em.schedule(\"timeOut\", 30 * 60000);\n-\t\n-    return eim;\n+function setLobbyRange() {\n+        return lobbyRange;\n+}\n+\n+function setEventRequirements() {\n+        var reqStr = \"\";\n+        \n+        reqStr += \"\\r\\n    Number of players: \";\n+        if(maxPlayers - minPlayers >= 1) reqStr += minPlayers + \" ~ \" + maxPlayers;\n+        else reqStr += minPlayers;\n+        \n+        reqStr += \"\\r\\n    Level range: \";\n+        if(maxLevel - minLevel >= 1) reqStr += minLevel + \" ~ \" + maxLevel;\n+        else reqStr += minLevel;\n+        \n+        reqStr += \"\\r\\n    Time limit: \";\n+        reqStr += eventTime + \" minutes\";\n+        \n+        em.setProperty(\"party\", reqStr);\n+}\n+\n+function setEventExclusives(eim) {\n+        var itemSet = [4001015, 4001016, 4001018];\n+        eim.setExclusiveItems(itemSet);\n+}\n+\n+function setEventRewards(eim) {\n+        var itemSet, itemQty, evLevel, expStages;\n+\n+        evLevel = 1;    //Rewards at clear PQ\n+        itemSet = [];\n+        itemQty = [];\n+        eim.setEventRewards(evLevel, itemSet, itemQty);\n+        \n+        expStages = [];    //bonus exp given on CLEAR stage signal\n+        eim.setEventClearStageExp(expStages);\n+}\n+\n+function getEligibleParty(party) {      //selects, from the given party, the team that is allowed to attempt this event\n+        var eligible = [];\n+        var hasLeader = false;\n+        \n+        if(party.size() > 0) {\n+                var partyList = party.toArray();\n+\n+                for(var i = 0; i < party.size(); i++) {\n+                        var ch = partyList[i];\n+\n+                        if(ch.getMapId() == recruitMap && ch.getLevel() >= minLevel && ch.getLevel() <= maxLevel) {\n+                                if(ch.isLeader()) hasLeader = true;\n+                                eligible.push(ch);\n+                        }\n+                }\n+        }\n+        \n+        if(!(hasLeader && eligible.length >= minPlayers && eligible.length <= maxPlayers)) eligible = [];\n+        return eligible;\n+}\n+\n+function setup(level, lobbyid) {\n+        var eim = em.newInstance(\"PreZakum\" + lobbyid);\n+        eim.setProperty(\"level\", level);\n+        eim.setProperty(\"gotDocuments\", 0);\n+        \n+        eim.getInstanceMap(280010000).resetPQ(level);\n+        eim.getInstanceMap(280010010).resetPQ(level);\n+        eim.getInstanceMap(280010011).resetPQ(level);\n+        eim.getInstanceMap(280010020).resetPQ(level);\n+        eim.getInstanceMap(280010030).resetPQ(level);\n+        eim.getInstanceMap(280010031).resetPQ(level);\n+        eim.getInstanceMap(280010040).resetPQ(level);\n+        eim.getInstanceMap(280010041).resetPQ(level);\n+        eim.getInstanceMap(280010050).resetPQ(level);\n+        eim.getInstanceMap(280010060).resetPQ(level);\n+        eim.getInstanceMap(280010070).resetPQ(level);\n+        eim.getInstanceMap(280010071).resetPQ(level);\n+        eim.getInstanceMap(280010080).resetPQ(level);\n+        eim.getInstanceMap(280010081).resetPQ(level);\n+        eim.getInstanceMap(280010090).resetPQ(level);\n+        eim.getInstanceMap(280010091).resetPQ(level);\n+        eim.getInstanceMap(280010100).resetPQ(level);\n+        eim.getInstanceMap(280010101).resetPQ(level);\n+        eim.getInstanceMap(280010110).resetPQ(level);\n+        eim.getInstanceMap(280010120).resetPQ(level);\n+        eim.getInstanceMap(280010130).resetPQ(level);\n+        eim.getInstanceMap(280010140).resetPQ(level);\n+        eim.getInstanceMap(280010150).resetPQ(level);\n+        eim.getInstanceMap(280011000).resetPQ(level);\n+        eim.getInstanceMap(280011001).resetPQ(level);\n+        eim.getInstanceMap(280011002).resetPQ(level);\n+        eim.getInstanceMap(280011003).resetPQ(level);\n+        eim.getInstanceMap(280011004).resetPQ(level);\n+        eim.getInstanceMap(280011005).resetPQ(level);\n+        eim.getInstanceMap(280011006).resetPQ(level);\n+        \n+        respawnStages(eim);\n+        \n+        eim.startEventTimer(eventTime * 60000);\n+        setEventRewards(eim);\n+        setEventExclusives(eim);\n+        \n+        return eim;\n }\n \n function afterSetup(eim) {}\n \n+function respawnStages(eim) {}\n+\n function playerEntry(eim, player) {\n-    var map = eim.getMapInstance(280010000);\n-    player.changeMap(map, map.getPortal(0));\n-\t\n-//TODO: hold time across map changes\n-//player.getClient().getSession().write(tools.MaplePacketCreator.getClock(1800));\n+        var map = eim.getMapInstance(entryMap);\n+        player.changeMap(map, map.getPortal(0));\n }\n \n-function playerRevive(eim, player) {\n-    if (eim.isLeader(player)) { //check for party leader\n-        //boot whole party and end\n-        var party = eim.getPlayers();\n-        for (var i = 0; i < party.size(); i++) {\n-            playerExit(eim, party.get(i));\n+function scheduledTimeout(eim) {\n+        end(eim);\n+}\n+\n+function playerUnregistered(eim, player) {}\n+\n+function playerExit(eim, player) {\n+        eim.unregisterPlayer(player);\n+        player.changeMap(exitMap, 0);\n+}\n+\n+function changedMap(eim, player, mapid) {\n+        if (mapid < minMapId || mapid > maxMapId) {\n+                if (eim.isEventTeamLackingNow(true, minPlayers, player)) {\n+                        eim.unregisterPlayer(player);\n+                        end(eim);\n+                }\n+                else\n+                        eim.unregisterPlayer(player);\n         }\n-        eim.dispose();\n-    }\n-    else { //boot dead player\n-        playerExit(eim, player);\n-    }\n-    return false; // don't execute the standard reviving code\n }\n \n-function playerDead(eim, player) {\n+function changedLeader(eim, leader) {\n+        var mapid = leader.getMapId();\n+        if (!eim.isEventCleared() && (mapid < minMapId || mapid > maxMapId)) {\n+                end(eim);\n+        }\n+}\n+\n+function playerDead(eim, player) {}\n+\n+function playerRevive(eim, player) { // player presses ok on the death pop up.\n+        if (eim.isEventTeamLackingNow(true, minPlayers, player)) {\n+                eim.unregisterPlayer(player);\n+                end(eim);\n+        }\n+        else\n+                eim.unregisterPlayer(player);\n }\n \n function playerDisconnected(eim, player) {\n-    if (eim.isLeader(player)) { //check for party leader\n-        //boot whole party and end\n-        var party = eim.getPlayers();\n-        for (var i = 0; i < party.size(); i++) {\n-            if (party.get(i).equals(player)) {\n-                removePlayer(eim, player);\n-            }\n-            else {\n-                playerExit(eim, party.get(i));\n-            }\n+        if (eim.isEventTeamLackingNow(true, minPlayers, player)) {\n+                eim.unregisterPlayer(player);\n+                end(eim);\n         }\n-        eim.dispose();\n-    }\n-    else { //boot d/ced player\n-        removePlayer(eim, player);\n-    }\n+        else\n+                eim.unregisterPlayer(player);\n }\n \n function leftParty(eim, player) {\n-    playerExit(eim, player);\n+        if (eim.isEventTeamLackingNow(false, minPlayers, player)) {\n+                eim.unregisterPlayer(player);\n+                end(eim);\n+        }\n+        else\n+                eim.unregisterPlayer(player);\n }\n \n function disbandParty(eim) {\n-    //boot whole party and end\n-    var party = eim.getPlayers();\n-    for (var i = 0; i < party.size(); i++) {\n-        playerExit(eim, party.get(i));\n-    }\n-    eim.dispose();\n+        end(eim);\n }\n \n-function playerUnregistered(eim, player) {}\n+function monsterValue(eim, mobId) {\n+        return 1;\n+}\n \n-function playerExit(eim, player) {\n-    eim.unregisterPlayer(player);\n-    player.changeMap(exitMap, exitMap.getPortal(0));\n+function end(eim) {\n+        var party = eim.getPlayers();\n+        for (var i = 0; i < party.size(); i++) {\n+                playerExit(eim, party.get(i));\n+        }\n+        eim.dispose();\n }\n \n-//for offline players\n-function removePlayer(eim, player) {\n-    eim.unregisterPlayer(player);\n-    player.getMap().removePlayer(player);\n-    player.setMap(exitMap);\n+function giveRandomEventReward(eim, player) {\n+        eim.giveEventReward(player);\n }\n \n function clearPQ(eim) {\n-    //ZPQ does nothing special with winners\n-    var party = eim.getPlayers();\n-    for (var i = 0; i < party.size(); i++) {\n-        playerExit(eim, party.get(i));\n-    }\n-    eim.dispose();\n+        eim.stopEventTimer();\n+        eim.setEventCleared();\n }\n \n function monsterKilled(mob, eim) {}\n \n function allMonstersDead(eim) {}\n \n-function cancelSchedule() {\n-}\n+function cancelSchedule() {}\n \n-function timeOut() {\n-    var iter = em.getInstances().iterator();\n-    while (iter.hasNext()) {\n-        var eim = iter.next();\n-        if (eim.getPlayerCount() > 0) {\n-            var pIter = eim.getPlayers().iterator();\n-            while (pIter.hasNext()) {\n-                playerExit(eim, pIter.next());\n-            }\n-        }\n-        eim.dispose();\n-    }\n-}\n\\ No newline at end of file\n+function dispose(eim) {}"}, {"sha": "339269740433ed6b5aee4b87a3d514d9629e772d", "filename": "scripts/map/onFirstUserEnter/dojang_1st.js", "status": "added", "additions": 50, "deletions": 0, "changes": 50, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/map/onFirstUserEnter/dojang_1st.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/map/onFirstUserEnter/dojang_1st.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/map/onFirstUserEnter/dojang_1st.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -0,0 +1,50 @@\n+/*\n+\tThis file is part of the OdinMS Maple Story Server\n+    Copyright (C) 2008 Patrick Huy <patrick.huy@frz.cc>\n+\t\t       Matthias Butz <matze@odinms.de>\n+\t\t       Jan Christian Meyer <vimes@odinms.de>\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+/*\n+ *@Author:     Moogra, Traitor, Ronan\n+ *@Map(s):     All Dojo fighting maps\n+ *@Function:   Spawns dojo monsters and handles time\n+*/\n+\n+\n+function start(ms) {\n+    ms.getPlayer().resetEnteredScript();\n+    var stage = Math.floor(ms.getMapId() / 100) % 100;\n+    var callBoss = false;\n+    \n+    if (stage % 6 == 1) {\n+        ms.getClient().getChannelServer().startDojoSchedule(ms.getMapId());\n+    } else if(stage % 6 == 0) {\n+        ms.getClient().getChannelServer().dismissDojoSchedule(ms.getMapId(), ms.getParty());\n+    }\n+        \n+    callBoss = ms.getClient().getChannelServer().setDojoProgress(ms.getMapId());\n+    \n+    if (stage % 6 > 0) {\n+        var realstage = stage - ((stage / 6) | 0);\n+        var mob = ms.getMonsterLifeFactory(9300183 + realstage);\n+        if (callBoss && mob != null && ms.getPlayer().getMap().getMonsterById(9300216) == null) {\n+            mob.setBoss(false);\n+            ms.getPlayer().getMap().spawnDojoMonster(mob);\n+        }\n+    }\n+}\n\\ No newline at end of file"}, {"sha": "21a5d69fe7e38b6c01599546d2199df8f130b18f", "filename": "scripts/map/onUserEnter/babyPigMap.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/map/onUserEnter/babyPigMap.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/map/onUserEnter/babyPigMap.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/map/onUserEnter/babyPigMap.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -22,5 +22,5 @@\n \n function start(ms) {   \t       \n \tms.unlockUI();\n-\tms.forceStartQuest(22015);\n+\tms.getClient().getQM().forceStartQuest(22015);\n }\n\\ No newline at end of file"}, {"sha": "8fc8cbd0ab9732981024cd2e959cdf62a5a43926", "filename": "scripts/map/onUserEnter/dojang_Eff.js", "status": "added", "additions": 42, "deletions": 0, "changes": 42, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/map/onUserEnter/dojang_Eff.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/map/onUserEnter/dojang_Eff.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/map/onUserEnter/dojang_Eff.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -0,0 +1,42 @@\n+/*\n+\tThis file is part of the OdinMS Maple Story Server\n+    Copyright (C) 2008 Patrick Huy <patrick.huy@frz.cc>\n+\t\t       Matthias Butz <matze@odinms.de>\n+\t\t       Jan Christian Meyer <vimes@odinms.de>\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+/*\n+ *@Author:     Moogra, Traitor, Ronan\n+ *@Map(s):     All Dojo fighting maps\n+ *@Function:   Displays info for the player when entering a dojo map\n+*/\n+\n+\n+function start(ms) {\n+    ms.getPlayer().resetEnteredScript();\n+    var stage = Math.floor(ms.getPlayer().getMap().getId() / 100) % 100;\n+    \n+    ms.getPlayer().showDojoClock();\n+    if (stage % 6 > 0) {\n+        var realstage = stage - ((stage / 6) | 0);\n+        ms.dojoEnergy();\n+        \n+        ms.playSound(\"Dojang/start\");\n+        ms.showEffect(\"dojang/start/stage\");\n+        ms.showEffect(\"dojang/start/number/\" + realstage);\n+    }\n+}\n\\ No newline at end of file"}, {"sha": "ee34234e9a168f6bf4ee942e96fe78da83366090", "filename": "scripts/map/onUserEnter/dojang_Msg.js", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/map/onUserEnter/dojang_Msg.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/map/onUserEnter/dojang_Msg.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/map/onUserEnter/dojang_Msg.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -28,7 +28,9 @@ var messages = Array(\"Your courage for challenging the Mu Lung Dojo is commendab\n \n function start(ms) {\n     if (ms.getPlayer().getMap().getId() == 925020000) {\n-        ms.getPlayer().startMapEffect(messages[(Math.random() * messages.length) | 0], 5120024);\n+        if(ms.getPlayer().getMap().findClosestPlayerSpawnpoint(ms.getPlayer().getPosition()).getId() == 0) {\n+            ms.getPlayer().startMapEffect(messages[(Math.random() * messages.length) | 0], 5120024);\n+        }\n     } else {\n         ms.getPlayer().resetEnteredScript(); //in case the person dcs in here we set it at dojang_tuto portal\n         ms.getPlayer().startMapEffect(\"Ha! Let's see what you got! I won't let you leave unless you defeat me first!\", 5120024);"}, {"sha": "a84188d257baea34d8079f1ba168c2a0dc772621", "filename": "scripts/npc/1052107.js", "status": "added", "additions": 52, "deletions": 0, "changes": 52, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/1052107.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/1052107.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/1052107.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -0,0 +1,52 @@\n+/*\n+\tThis file is part of the OdinMS Maple Story Server\n+    Copyright (C) 2008 Patrick Huy <patrick.huy@frz.cc>\n+\t\t       Matthias Butz <matze@odinms.de>\n+\t\t       Jan Christian Meyer <vimes@odinms.de>\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+/* Small Street Light\n+\tKerning deep Subway areas\n+\tNothing at all.\n+ */\n+\n+var status;\n+ \n+function start() {\n+        status = -1;\n+        action(1, 0, 0);\n+}\n+\n+function action(mode, type, selection) {\n+        if (mode == -1) {\n+                cm.dispose();\n+        } else {\n+                if (mode == 0 && status == 0) {\n+                        cm.dispose();\n+                        return;\n+                }\n+                if (mode == 1)\n+                        status++;\n+                else\n+                        status--;\n+    \n+                if(status == 0) {\n+                        cm.sendOk(\"A small focus of light lighting in the immersive darkness.\");\n+                        cm.dispose();\n+                }\n+        }\n+}"}, {"sha": "43cc74e55d2878216c839a54135f6abf67165a2c", "filename": "scripts/npc/1052115.js", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/1052115.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/1052115.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/1052115.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -65,8 +65,8 @@ function action(mode, type, selection) {\n \t\t\t\tcm.sendOk(\"Please defeat at least 10,000 monsters in the Station and look for me again. Kills : \" + mons);\n \t\t\t} else if (cm.canHold(1142141) && !cm.haveItem(1142141)){\n \t\t\t\tcm.gainItem(1142141,1);\n-\t\t\t\tcm.forceStartQuest(29931);\n-\t\t\t\tcm.forceCompleteQuest(29931);\n+\t\t\t\tcm.startQuest(29931);\n+\t\t\t\tcm.completeQuest(29931);\n \t\t\t} else {\n \t\t\t\tcm.sendOk(\"Please make room.\");\n \t\t\t}"}, {"sha": "62004c36130c0101e326f6f7ad830b557ab63316", "filename": "scripts/npc/2020008.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/2020008.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/2020008.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/2020008.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -117,7 +117,7 @@ function action(mode, type, selection){\n         } else {\n             if (cm.getPlayer().getLevel() >= 50){\n             \tcm.sendNext(\"Ok, go.\");\n-                cm.getPlayer().setPartyQuestItemObtained(\"z\");\n+                if(!cm.isQuestStarted(100200)) cm.startQuest(100200);\n             }else\n                 cm.sendNext(\"You're weak.\");\n             cm.dispose();"}, {"sha": "4977ef2c0ddb510ffebb2c74bf8096cd8164225e", "filename": "scripts/npc/2020009.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/2020009.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/2020009.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/2020009.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -105,7 +105,7 @@ function action(mode, type, selection){\n             } else {\n                 if (cm.getPlayer().getLevel() >= 50){\n             \t    cm.sendNext(\"Ok, go.\");\n-                    cm.getPlayer().setPartyQuestItemObtained(\"z\");\n+                    if(!cm.isQuestStarted(100200)) cm.startQuest(100200);\n                 }else\n                     cm.sendNext(\"You're weak.\");\n                 cm.dispose();"}, {"sha": "b9c12ac88229d60d68ca73ec5e31ecca766f6106", "filename": "scripts/npc/2020010.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/2020010.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/2020010.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/2020010.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -106,7 +106,7 @@ function action(mode, type, selection){\n             } else {\n             \tif (cm.getPlayer().getLevel() >= 50){\n             \t\tcm.sendNext(\"Ok, go.\");\n-                \tcm.getPlayer().setPartyQuestItemObtained(\"z\");\n+                \tif(!cm.isQuestStarted(100200)) cm.startQuest(100200);\n             \t}else\n                 \tcm.sendNext(\"You're weak.\");\n             \tcm.dispose();"}, {"sha": "36a00592a18bbeffc067dc5b6cb7bc1408976790", "filename": "scripts/npc/2020011.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/2020011.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/2020011.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/2020011.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -105,7 +105,7 @@ function action(mode, type, selection){\n         } else {\n             if (cm.getPlayer().getLevel() >= 50){\n             \tcm.sendNext(\"Ok, go.\");\n-                cm.getPlayer().setPartyQuestItemObtained(\"z\");\n+                if(!cm.isQuestStarted(100200)) cm.startQuest(100200);\n             }else\n                 cm.sendNext(\"You're weak.\");\n             cm.dispose();"}, {"sha": "f782ed590f6a8b6713d7f8eb3a7861757404d413", "filename": "scripts/npc/2020013.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/2020013.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/2020013.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/2020013.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -104,7 +104,7 @@ function action(mode, type, selection){\n         } else {\n             if (cm.getPlayer().getLevel() >= 50){\n             \tcm.sendNext(\"Ok, go.\");\n-                cm.getPlayer().setPartyQuestItemObtained(\"z\");\n+                if(!cm.isQuestStarted(100200)) cm.startQuest(100200);\n             }else\n                 cm.sendNext(\"You're weak.\");\n             cm.dispose();"}, {"sha": "b3ff9c82ee593250f7af244b1816bf4b1d84454c", "filename": "scripts/npc/2030008.js", "status": "modified", "additions": 73, "deletions": 137, "changes": 210, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/2030008.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/2030008.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/2030008.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -1,14 +1,15 @@\n /*\n \tThis file is part of the OdinMS Maple Story Server\n-    Copyright (C) 2008 Patrick Huy <patrick.huy@frz.cc> \n-                       Matthias Butz <matze@odinms.de>\n-                       Jan Christian Meyer <vimes@odinms.de>\n+    Copyright (C) 2008 Patrick Huy <patrick.huy@frz.cc>\n+\t\t       Matthias Butz <matze@odinms.de>\n+\t\t       Jan Christian Meyer <vimes@odinms.de>\n \n     This program is free software: you can redistribute it and/or modify\n-    it under the terms of the GNU Affero General Public License version 3\n-    as published by the Free Software Foundation. You may not use, modify\n-    or distribute this program under any other version of the\n-    GNU Affero General Public License.\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n \n     This program is distributed in the hope that it will be useful,\n     but WITHOUT ANY WARRANTY; without even the implied warranty of\n@@ -18,174 +19,109 @@\n     You should have received a copy of the GNU Affero General Public License\n     along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n-\n /* Adobis\n  * \n- * El Nath: The Door to Zakum (211042300)\n+ * El Nath - The Door to Zakum (211042300)\n+ * \n+ * Vs Zakum Recruiter NPC\n  * \n- * Zakum Quest NPC \n- \n- * Custom Quest 100200 = whether you can do Zakum\n- * Custom Quest 100201 = Collecting Gold Teeth <- indicates it's been started\n- * Custom Quest 100203 = Collecting Gold Teeth <- indicates it's finished\n- * 4031061 = Piece of Fire Ore - stage 1 reward\n- * 4031062 = Breath of Fire    - stage 2 reward\n- * 4001017 = Eye of Fire       - stage 3 reward\n- * 4000082 = Zombie's Gold Tooth (stage 3 req)\n+ * Custom Quest 100200 = Whether you can start Zakum PQ\n+ * Custom Quest 100201 = Whether you have done the trials\n */\n \n var status;\n-var mapId = 211042300;\n-var stage;\n-var teethmode;\n-var minLevel = 50;\n+var em;\n+var selectedType;\n+var gotAllDocs;\n \n function start() {\n-    if (cm.getPlayer().getLevel() >= minLevel) {\n-        if (cm.isQuestCompleted(100200) && !cm.isQuestStarted(100200)) {\n-            cm.startQuest(100200);\n-            cm.sendOk(\"You want to be permitted to do the Zakum Dungeon Quest?  Well, I, #bAdobis#k... judge you to be suitable.  You should be safe roaming around the dungeon.  Just be careful...\");\n-            cm.dispose();\n-            return;\n-        }\n-        else if (cm.isQuestStarted(100201)) {\n-            teethmode = 1;\n-            cm.sendNext(\"Have you got the items I asked for?  This ain't no charity.\");\n-        }\n-        else\n-            cm.sendSimple(\"Beware, for the power of olde has not been forgotten... #b\\r\\n#L0#Enter the Unknown Dead Mine (Stage 1)#l\\r\\n#L1#Face the Breath of Lava (Stage 2)#l\\r\\n#L2#Forging the Eyes of Fire (Stage 3)#l\");\n-        if (cm.isQuestCompleted(100201))\n-            teethmode = 2;\n-    }\n-    else {\n-        cm.sendOk(\"Please come back to me when you've become stronger.  I've seen a few adventurers in my day, and you're far too weak to complete my tasks.\");\n-        cm.dispose();\n-    }\n+    status = -1;\n+    action(1, 0, 0);\n }\n \n function action(mode, type, selection) {\n     if (mode == -1)\n         cm.dispose();\n     else {\n-        if (mode == 0 && status == 0) {\n+        if (mode == 0) {\n             cm.dispose();\n             return;\n         }\n         if (mode == 1)\n             status++;\n         else\n             status--;\n-        if (status == 1) {\n-            if (teethmode == 1) {\n-                if (cm.haveItem(4031061,1) && cm.haveItem(4031062,1) && cm.haveItem(4000082,30)) {\n-                    cm.gainItem(4031061,-1);\n-                    cm.gainItem(4031062,-1);\n-                    cm.gainItem(4000082,-30);\n-                    cm.gainItem(4001017,5);\n-                    cm.sendNext(\"Thank you for the teeth!  Next time you see me, I'll be blinging harder than #rJaws#k! Goodbye and good luck!\");\n-                    cm.completeQuest(100201);\n-                    cm.completeQuest(100200);\n-                    cm.dispose();\n-                }\n-                else {\n-                    cm.sendNext(\"You shtill didn't get me my teef! Howsh a man shupposhed to conshentrate wifout teef?\");\n+        \n+        if(!cm.isQuestStarted(100200)) {\n+            cm.sendOk(\"Beware, for the power of olde has not been forgotten... \");\n+            cm.dispose();\n+            return;\n+        }\n+        \n+        em = cm.getEventManager(\"ZakumPQ\");\n+        if(em == null) {\n+            cm.sendOk(\"The Zakum PQ has encountered an error.\");\n+            cm.dispose();\n+            return;\n+        }\n+        \n+        if (status == 0) {\n+            cm.sendSimple(\"#e#b<Party Quest: Zakum Campaign>\\r\\n#k#n\" + em.getProperty(\"party\") + \"\\r\\n\\r\\nBeware, for the power of olde has not been forgotten... #b\\r\\n#L0#Enter the Unknown Dead Mine (Stage 1)#l\\r\\n#L1#Face the Breath of Lava (Stage 2)#l\\r\\n#L2#Forging the Eyes of Fire (Stage 3)#l\");\n+        }\n+        else if (status == 1) {\n+            if (selection == 0) {\n+                if (cm.getParty() == null) {\n+                    cm.sendOk(\"You can participate in the party quest only if you are in a party.\");\n                     cm.dispose();\n-                }\n-                return;\n-            }\n-            if (selection == 0) { //ZPQ\n-                if (cm.getParty() == null) { //no party\n-                    cm.sendNext(\"Please talk to me again when you have formed a party.\");\n+                } else if(!cm.isLeader()) {\n+                    cm.sendOk(\"Your party leader must talk to me to start this party quest.\");\n                     cm.dispose();\n-                }\n-                else if (!cm.isLeader()) { //not party leader\n-                    cm.sendNext(\"Please have the leader of your party speak with me.\");\n-                    cm.dispose();\n-                }\n-                else {\n-                    //TODO: add zakum variable to characters, check that instead; less hassle\n-                    var party = cm.getParty().getMembers();\n-                    mapId = cm.getPlayer().getMapId();\n-                    var next = true;\n-                    for (var i = 0; i < party.size(); i++)\n-                        if ((party.get(i).getLevel() < 50) || (party.get(i).getMapid() != mapId))\n-                            next = false;\n-                    if (next) {\n-                        //all requirements met, make an instance and start it up\n-                        //cm.startPQ(\"ZakumPQ\");\n-                        var em = cm.getEventManager(\"ZakumPQ\");\n-                        if (em == null) {\n-                            cm.sendOk(\"This trial is currently under construction.\");\n-                        } else {\n-                            if(!em.startInstance(cm.getParty(), cm.getPlayer().getMap())) {\n-                                cm.sendOk(\"A party in your name is already registered in this event.\");\n-                                cm.dispose();\n-                                return;\n-                            }\n-                            party = cm.getPlayer().getEventInstance().getPlayers();\n-                            cm.removeFromParty(4001015, party);\n-                            cm.removeFromParty(4001018, party);\n-                            cm.removeFromParty(4001016, party);\n+                } else {\n+                    var eli = em.getEligibleParty(cm.getParty());\n+                    if(eli.size() > 0) {\n+                        if(!em.startInstance(cm.getParty(), cm.getPlayer().getMap(), 1)) {\n+                            cm.sendOk(\"Another party has already entered the #rParty Quest#k in this channel. Please try another channel, or wait for the current party to finish.\");\n                         }\n-                        cm.dispose();\n                     }\n                     else {\n-                        cm.sendNext(\"Please make sure all of your members are qualified to begin my trials...\");\n-                        cm.dispose();\n+                        cm.sendOk(\"You cannot start this party quest yet, because either your party is not in the range size, some of your party members are not eligible to attempt it or they are not in this map. If you're having trouble finding party members, try Party Search.\");\n                     }\n+\n+                    cm.dispose();\n                 }\n-            }\n-            else if (selection == 1) { //Zakum Jump Quest\n-                stage = 1;\n+            } else if(selection == 1) {\n                 if (cm.haveItem(4031061) && !cm.haveItem(4031062))\n                     cm.sendYesNo(\"Would you like to attempt the #bBreath of Lava#k?  If you fail, there is a very real chance you will die.\");\n                 else {\n-                    if (cm.haveItem(4031062))\n-                        cm.sendNext(\"You've already got the #bBreath of Lava#k, you don't need to do this stage.\");\n-                    else\n-                        cm.sendNext(\"Please complete the earlier trials first.\");\n+                    if (cm.haveItem(4031062)) cm.sendNext(\"You've already got the #bBreath of Lava#k, you don't need to do this stage.\");\n+                    else cm.sendNext(\"Please complete the earlier trials first.\");\n+                    \n                     cm.dispose();\n                 }\n-            }\n-            else if (selection == 2) { //Golden Tooth Collection\n-                stage = 2;\n-                if (teethmode == 2 && cm.haveItem(4031061) && cm.haveItem(4031062))\n-                    cm.sendYesNo(\"If you want more #bEyes of Fire#k, you need to bring me the same #b30 Zombie's Lost Gold Tooth#k.  Turns out gold dentures don't last long, and I need a new one.\\r\\nDo you have those teeth for me?\");\n-                else if (cm.haveItem(4031061) && cm.haveItem(4031062))\n-                    cm.sendYesNo(\"Okay, you've completed the earlier trials.  Now, with a little hard work I can get you the #bseeds of Zakum#k necessary to enter combat.  But first, my teeths are not as good as they used to be.  You ever seen a dentist in Maple Story?  Well, I heard the Miner Zombies have gold teeth.  I'd like you to collect #b30 Zombie's Lost Gold Tooth#k so I can build myself some dentures.  Then I'll be able to get you the items you desire.\\r\\nRequired:\\r\\n#i4000082##b x 30\");\n-                else {\n-                    cm.sendNext(\"Please complete the earlier trials before attempting this one.\");\n-                    cm.dispose();\n-                }\n-            }\n-        }\n-        else if (status == 2) {\n-            if (stage == 1) {\n-                cm.warp(280020000); // Breath of Lava I\n-                cm.dispose();\n-            }\n-            if (stage == 2) {\n-                if (teethmode == 2) {\n-                    if (cm.haveItem(4031061,1) && cm.haveItem(4031062,1) && cm.haveItem(4000082,30)) { // take away items, give eyes of fire, complete quest\n-                        cm.gainItem(4031061,-1);\n-                        cm.gainItem(4031062,-1);\n-                        cm.gainItem(4000082,-30);\n-                        cm.gainItem(4001017,5);\n-                        cm.sendNext(\"Thank you for the teeth!  Next time you see me, I'll be blinging harder than #rJaws#k!  Goodbye and good luck!\");\n+            } else {\n+                if(cm.haveItem(4031061) && cm.haveItem(4031062)) {\n+                    if(!cm.haveItem(4000082, 30)) {\n+                        cm.sendOk(\"You have completed the trials, however there still the need of #b30 #t4000082##k to forge the #t4001017#.\");\n+                    } else {\n                         cm.completeQuest(100201);\n-                        cm.completeQuest(100200);\n-                        cm.dispose();\n-                    }\n-                    else {\n-                        cm.sendNext(\"You don't have any teeth yet!  Don't try to pull a fast one on me.\");\n-                        cm.dispose();\n+                        cm.gainItem(4031061, -1);\n+                        cm.gainItem(4031062, -1);\n+                        cm.gainItem(4000082, -30);\n+\n+                        cm.gainItem(4001017, 1);\n+                        cm.sendNext(\"You have completed the trials, from now on having my approval to challenge Zakum.\");\n                     }\n-                }\n-                else {\n-                    cm.startQuest(100201);\n+                    \n+                    cm.dispose();\n+                } else {\n+                    cm.sendOk(\"You lack some of the required items to forge the #b#t4001017##k.\");\n                     cm.dispose();\n                 }\n             }\n         }\n+        else if (status == 2) {\n+            cm.warp(280020000);\n+            cm.dispose();\n+        }\n     }\n }"}, {"sha": "20fde5ea3eadebaa6fedc1ab0736e116ca025c9b", "filename": "scripts/npc/2030010.js", "status": "modified", "additions": 7, "deletions": 14, "changes": 21, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/2030010.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/2030010.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/2030010.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -31,26 +31,19 @@\n  importPackage(Packages.server.expeditions);\n  \n function start() {\n-    cm.sendYesNo(\"If you leave now, you'll have to start over. Are you sure you want to leave?\");\n+    if(cm.getMapId() == 280030000) {\n+        if(!cm.getEventInstance().isEventCleared()) cm.sendYesNo(\"If you leave now, you'll have to start over. Are you sure you want to leave?\");\n+        else cm.sendYesNo(\"You guys finally overthrew Zakum, what a superb feat! Congratulations! Are you sure you want to leave now?\");\n+    } else {\n+        cm.sendYesNo(\"If you leave now, you'll have to start over. Are you sure you want to leave?\");\n+    }\n }\n \n function action(mode, type, selection) {\n-\tvar zakum = MapleExpeditionType.ZAKUM;\n-    var expedition = cm.getExpedition(zakum);\n     if (mode < 1)\n         cm.dispose();\n     else {\n-        if (cm.getPlayer().getMap().getCharacters().size() < 2){\n-            cm.getPlayer().getMap().killAllMonsters();\n-            cm.getPlayer().getMap().resetReactors();\n-\t\t\tif (expedition != null){\n-\t\t\t\tcm.endExpedition(expedition);\n-\t\t\t}\n-        }\n-        if (cm.getPlayer().getEventInstance() != null)\n-            cm.getPlayer().getEventInstance().removePlayer(cm.getPlayer());\n-        else\n-            cm.warp(211042300);\n+        cm.warp(211042300);\n         cm.dispose();\n     }\n }\n\\ No newline at end of file"}, {"sha": "aa65cd80ee2a49b06cd18ce8fb493c29547e4935", "filename": "scripts/npc/2030013.js", "status": "modified", "additions": 124, "deletions": 92, "changes": 216, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/2030013.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/2030013.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/2030013.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -21,6 +21,7 @@\n /*Adobis\n  *\n  *@author SharpAceX (Alan)\n+ *@author Ronan\n  */\n importPackage(Packages.server.expeditions);\n importPackage(Packages.tools);\n@@ -30,7 +31,12 @@ var status = 0;\n var expedition;\n var player;\n var em;\n-var zakum = MapleExpeditionType.ZAKUM;\n+var exped = MapleExpeditionType.ZAKUM;\n+var expedName = \"Zakum\";\n+var expedBoss = \"Zakum\";\n+var expedMap = \"Zakum's Altar\";\n+var expedItem = 4001017;\n+\n var list = \"What would you like to do?#b\\r\\n\\r\\n#L1#View current Expedition members#l\\r\\n#L2#Start the fight!#l\\r\\n#L3#Stop the expedition.#l\";\n \n function start() {\n@@ -40,114 +46,140 @@ function start() {\n function action(mode, type, selection) {\n \n     player = cm.getPlayer();\n-    expedition = cm.getExpedition(zakum);\n+    expedition = cm.getExpedition(exped);\n     em = cm.getEventManager(\"ZakumBattle\");\n \n-    if (mode < 1) {\n+    if (mode == -1) {\n         cm.dispose();\n-        return;\n-    }\n-    if (status == 0) {\n-        //cm.removeExpedition(expedition);\n-        if (player.getClient().getChannel() != 1) { //Only channel 1\n-            cm.sendOk(\"Sorry, Zakum may only be challenged on #bChannel 1#k.\");\n+    } else {\n+        if (mode == 0) {\n             cm.dispose();\n-        } else if (player.getLevel() < zakum.getMinLevel() && player.getLevel() > zakum.getMaxLevel()) { //Don't fit requirement\n-            cm.sendOk(\"You do not meet the criteria to take on Zakum!\");\n-            cm.dispose();\n-        } else if (expedition == null) { //Start an expedition\n-            cm.sendSimple(\"Would you like to assemble a team to take on the mighty #rZakum#k?\\r\\n#b#L1#Lets get this going!#l\\r\\n\\#L2#No, I think I'll wait a bit...#l\");\n-            status = 1;\n-        } else if (expedition.isLeader(player)) { //If you're the leader, manage the exped\n-            cm.sendSimple(list);\n-            status = 2;\n-        } else if (expedition.isRegistering()) { //If the expedition is registering\n-            if (expedition.contains(player)) { //If you're in it but it hasn't started, be patient\n-                cm.sendOk(\"You have already registered for the expedition. Please wait for \" + expedition.getLeader().getName() + \" to begin the expedition.\");\n-                cm.dispose();\n-            } else { //If you aren't in it, you're going to get added\n-                cm.sendOk(expedition.addMember(cm.getPlayer()));\n+            return;\n+        }\n+\n+        if (status == 0) {\n+            if (player.getLevel() < exped.getMinLevel() && player.getLevel() > exped.getMaxLevel()) { //Don't fit requirement\n+                cm.sendOk(\"You do not meet the criteria to battle \" + expedBoss + \"!\");\n                 cm.dispose();\n+            } else if (expedition == null) { //Start an expedition\n+                cm.sendSimple(\"#e#b<Expedition: \" + expedName + \">\\r\\n#k#n\" + em.getProperty(\"party\") + \"\\r\\n\\r\\nWould you like to assemble a team to take on #r\" + expedBoss + \"#k?\\r\\n#b#L1#Lets get this going!#l\\r\\n\\#L2#No, I think I'll wait a bit...#l\");\n+                status = 1;\n+            } else if (expedition.isLeader(player)) { //If you're the leader, manage the exped\n+                cm.sendSimple(list);\n+                status = 2;\n+            } else if (expedition.isRegistering()) { //If the expedition is registering\n+                if (expedition.contains(player)) { //If you're in it but it hasn't started, be patient\n+                    cm.sendOk(\"You have already registered for the expedition. Please wait for #r\" + expedition.getLeader().getName() + \"#k to begin the expedition.\");\n+                    cm.dispose();\n+                } else { //If you aren't in it, you're going to get added\n+                    cm.sendOk(expedition.addMember(cm.getPlayer()));\n+                    cm.dispose();\n+                }\n+            } else if (expedition.isInProgress()) { //Only if the expedition is in progress\n+                if (expedition.contains(player)) { //If you're registered, warp you in\n+                    var eim = em.getInstance(expedName + player.getClient().getChannel());\n+                    if(eim.getIntProperty(\"canJoin\") == 1) {\n+                        eim.registerPlayer(player);\n+                    } else {\n+                        cm.sendOk(\"Your expedition already started the battle against \" + expedBoss + \". Lets pray for those brave souls.\");\n+                    }\n+                    \n+                    cm.dispose();\n+                } else { //If you're not in by now, tough luck\n+                    cm.sendOk(\"Another expedition has taken the initiative to challenge \" + expedBoss + \", lets pray for those brave souls.\");\n+                    cm.dispose();\n+                }\n             }\n-        } else if (expedition.isInProgress()) { //Only if the expedition is in progress\n-            if (expedition.contains(player)) { //If you're registered, warp you in\n-                em.getInstance(\"ZakumBattle_\" + player.getClient().getChannel()).registerPlayer(player);\n+        } else if (status == 1) {\n+            if (selection == 1) {\n+                if (!cm.haveItem(expedItem)) {\n+                    cm.sendOk(\"As the expedition leader, you must have on your inventory a #b#t\" + expedItem + \"##k to battle \" + expedBoss + \"!\");\n+                    cm.dispose();\n+                    return;\n+                }\n+                \n+                expedition = cm.getExpedition(exped);\n+                if(expedition != null) {\n+                    cm.sendOk(\"Someone already taken the initiative to be the leader of the expedition. Try joining them!\");\n+                    cm.dispose();\n+                    return;\n+                }\n+                \n+                cm.createExpedition(exped);\n+                cm.sendOk(\"The #r\" + expedBoss + \" Expedition#k has been created.\\r\\n\\r\\nTalk to me again to view the current team, or start the fight!\");\n                 cm.dispose();\n-            } else { //If you're not in by now, tough luck\n-                cm.sendOk(\"Another expedition has taken the initiative to fight Zakum, lets pray for those brave souls.\");\n+                return;\n+            } else if (selection == 2) {\n+                cm.sendOk(\"Sure, not everyone's up to challenging \" + expedBoss + \".\");\n                 cm.dispose();\n+                return;\n             }\n-        }\n-    } else if (status == 1) {\n-        if (selection == 1) {\n-            cm.createExpedition(zakum);\n-            cm.sendOk(\"The #rZakum Expedition#k has been created.\\r\\n\\r\\nTalk to me again to view the current team, or start the fight!\");\n-            cm.dispose();\n-            return;\n-        } else if (selection == 2) {\n-            cm.sendOk(\"Sure, not everyone's up to challenging the might of Zakum.\");\n-            cm.dispose();\n-            return;\n-        }\n-    } else if (status == 2) {\n-        if (selection == 1) {\n-            if (expedition == null) {\n-                cm.sendOk(\"The expedition could not be loaded.\");\n+        } else if (status == 2) {\n+            if (selection == 1) {\n+                if (expedition == null) {\n+                    cm.sendOk(\"The expedition could not be loaded.\");\n+                    cm.dispose();\n+                    return;\n+                }\n+                var size = expedition.getMembers().size();\n+                if (size == 1) {\n+                    cm.sendOk(\"You are the only member of the expedition.\");\n+                    cm.dispose();\n+                    return;\n+                }\n+                var text = \"The following members make up your expedition (Click on them to expel them):\\r\\n\";\n+                text += \"\\r\\n\\t\\t1.\" + expedition.getLeader().getName();\n+                for (var i = 1; i < size; i++) {\n+                    text += \"\\r\\n#b#L\" + (i + 1) + \"#\" + (i + 1) + \". \" + expedition.getMembers().get(i).getName() + \"#l\\n\";\n+                }\n+                cm.sendSimple(text);\n+                status = 6;\n+            } else if (selection == 2) {\n+                var min = exped.getMinSize();\n+                \n+                var size = expedition.getMembers().size();\n+                if (size < min) {\n+                    cm.sendOk(\"You need at least \" + min + \" players registered in your expedition.\");\n+                    cm.dispose();\n+                    return;\n+                }\n+                \n+                cm.sendOk(\"The expedition will begin and you will now be escorted to the #b\" + expedMap + \"#k.\");\n+                status = 4;\n+            } else if (selection == 3) {\n+                player.getMap().broadcastMessage(MaplePacketCreator.serverNotice(6, expedition.getLeader().getName() + \" has ended the expedition.\"));\n+                cm.endExpedition(expedition);\n+                cm.sendOk(\"The expedition has now ended. Sometimes the best strategy is to run away.\");\n                 cm.dispose();\n                 return;\n             }\n-            var size = expedition.getMembers().size();\n-            if (size == 1) {\n-                cm.sendOk(\"You are the only member of the expedition.\");\n+        } else if (status == 4) {\n+            if (em == null) {\n+                cm.sendOk(\"The event could not be initialized, please report this on the forum.\");\n                 cm.dispose();\n                 return;\n             }\n-            var text = \"The following members make up your expedition (Click on them to expel them):\\r\\n\";\n-            text += \"\\r\\n\\t\\t1.\" + expedition.getLeader().getName();\n-            for (var i = 1; i < size; i++) {\n-                text += \"\\r\\n#b#L\" + (i + 1) + \"#\" + (i + 1) + \". \" + expedition.getMembers().get(i).getName() + \"#l\\n\";\n+\n+            em.setProperty(\"leader\", player.getName());\n+            em.setProperty(\"channel\", player.getClient().getChannel());\n+            if(!em.startInstance(expedition)) {\n+                cm.sendOk(\"Another expedition has taken the initiative to challenge \" + expedBoss + \", lets pray for those brave souls.\");\n+                cm.dispose();\n+                return;\n             }\n-            cm.sendSimple(text);\n-            status = 6;\n-        } else if (selection == 2) {\n-            cm.sendOk(\"The expedition will begin and you will now be escorted to the #bEntrance to Zakum Altar#k.\");\n-            status = 4;\n-        } else if (selection == 3) {\n-\t\t\tplayer.getMap().broadcastMessage(MaplePacketCreator.removeClock());\n-\t\t\tplayer.getMap().broadcastMessage(MaplePacketCreator.serverNotice(6, expedition.getLeader().getName() + \" has ended the expedition.\"));\n-\t\t\tcm.endExpedition(expedition);\n-            cm.sendOk(\"The expedition has now ended. Sometimes the best strategy is to run away.\");\n-\t\t\tcm.dispose();\n-            return;\n-        }\n-    } else if (status == 4) {\n-        var min = 1; //zakum.getMinSize();\n-        var size = expedition.getMembers().size();\n-        if (size < min) {\n-            cm.sendOk(\"You need at least \" + min + \" players registered in your expedition.\");\n-            cm.dispose();\n-            return;\n-        }\n-        if (em == null) {\n-            cm.sendOk(\"The event could not be found, please report this on the forum.\");\n+            \n             cm.dispose();\n             return;\n-        }\n-        cm.sendOk(\"Good luck! Zakum is a worthy foe!\");\n-\t\tem.setProperty(\"leader\", player.getName());\n-        em.setProperty(\"channel\", player.getClient().getChannel());\n-        em.startInstance(expedition);\n-        cm.dispose();\n-        return;\n-    } else if (status == 6) {\n-        if (selection > 0) {\n-           var banned = expedition.getMembers().get(selection);\n-            expedition.ban(banned);\n-            cm.sendOk(\"You have banned \" + banned.getName() + \" from the expedition.\");\n-            cm.dispose();\n-        } else {\n-            cm.sendSimple(list);\n-            status = 2;\n+        } else if (status == 6) {\n+            if (selection > 0) {\n+                var banned = expedition.getMembers().get(selection - 1);\n+                expedition.ban(banned);\n+                cm.sendOk(\"You have banned \" + banned.getName() + \" from the expedition.\");\n+                cm.dispose();\n+            } else {\n+                cm.sendSimple(list);\n+                status = 2;\n+            }\n         }\n     }\n-}\n\\ No newline at end of file\n+}"}, {"sha": "a5e9ffc5b8ef8b3d367d902ffc38549166035999", "filename": "scripts/npc/2032002.js", "status": "modified", "additions": 78, "deletions": 32, "changes": 110, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/2032002.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/2032002.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/2032002.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -28,68 +28,114 @@\n \n var status;\n var selectedType;\n-var scrolls;\n+var gotAllDocs;\n \n function start() {\n-    cm.sendSimple(\"...#b\\r\\n#L0#What am I supposed to do here?#l\\r\\n#L1#I brought items!#l\\r\\n#L2#I want to get out!#l\");\n+    status = -1;\n+    action(1, 0, 0);\n }\n \n function action(mode, type, selection) {\n     if (mode == -1)\n         cm.dispose();\n     else {\n-        if (mode == 0 && status == 0) {\n+        if (mode == 0) {\n             cm.dispose();\n             return;\n         }\n         if (mode == 1)\n             status++;\n         else\n             status--;\n-        if (status == 1) {\n-            selectedType = selection;\n-            if (selection == 0) {\n-                cm.sendNext(\"To reveal the power of Zakum, you'll have to recreate its core. Hidden somewhere in this dungeon is a \\\"Fire Ore\\\" which is one of the necessary materials for that core. Find it, and bring it to me.\\r\\n\\r\\nOh, and could you do me a favour? There's also a number of Paper Documents lying under rocks around here. If you can get 30 of them, I can reward you for your efforts.\")\n-                cm.dispose();\n+        \n+        var eim = cm.getPlayer().getEventInstance();\n+        \n+        if (status == 0) {\n+            if(!eim.isEventCleared()) {\n+                cm.sendSimple(\"...#b\\r\\n#L0#What am I supposed to do here?#l\\r\\n#L1#I brought items!#l\\r\\n#L2#I want to get out!#l\");\n+            } else {\n+                cm.sendNext(\"You completed this ordeal, now receive your prize.\");\n             }\n-            else if (selection == 1) {\n-                if (!cm.haveItem(4001018)) { //documents\n-                    cm.sendNext(\"Please bring the Fire Ore with you.\")\n+        }\n+        else if (status == 1) {\n+            if(!eim.isEventCleared()) {\n+                selectedType = selection;\n+                if (selection == 0) {\n+                    cm.sendNext(\"To reveal the power of Zakum, you'll have to recreate its core. Hidden somewhere in this dungeon is a #b\\\"Fire Ore\\\"#k which is one of the necessary materials for that core. Find it, and bring it to me.\\r\\n\\r\\nOh, and could you do me a favour? There's also a number of #bPaper Documents#k lying under rocks around here. If you can get 30 of them, I can reward you for your efforts.\");\n                     cm.dispose();\n+                    return;\n                 }\n-                else {\n-                    if (!cm.haveItem(4001015, 30)) { //documents\n-                        cm.sendYesNo(\"So, you brought the fire ore with you? In that case, I can give you and your party a piece of it that should be more than enough to make the core of Zakum. Make sure your whole party has room in their inventory before proceeding.\");\n-                        scrolls = false;\n+                else if (selection == 1) {\n+                    if(!cm.isEventLeader()) {\n+                        cm.sendNext(\"Please let your leader bring the materials to me to complete this ordeal.\");\n+                        cm.dispose();\n+                        return;\n+                    }\n+\n+                    if (!cm.haveItem(4001018)) { //fire ore\n+                        cm.sendNext(\"Please bring the #bFire Ore#k with you.\");\n+                        cm.dispose();\n+                    }\n+                    else {\n+                        gotAllDocs = cm.haveItem(4001015, 30);\n+                        if (!gotAllDocs) { //documents\n+                            cm.sendYesNo(\"So, you brought the fire ore with you? In that case, I can give you and your party a piece of it that should be more than enough to make the core of Zakum. Make sure your whole party has room in their inventory before proceeding.\");\n+                        } else {\n+                            cm.sendYesNo(\"So, you brought the fire ore and the documents with you? In that case, I can give you and your party a piece of it that should be more than enough to make the core of Zakum. As well, since you brought the documents with you, I can also give you a special item which will #bbring you to the mine's entrance at any time#k. Make sure your whole party has room in their inventory before proceeding.\");\n+                        }\n+                    }\n+                } else if (selection == 2)\n+                    cm.sendYesNo(\"Are you sure you want to exit? If you're the party leader, your party will also be removed from the mines.\");\n+            } else {\n+                if(eim.getProperty(\"gotDocuments\") == 1) {\n+                    if(eim.gridCheck(cm.getPlayer()) == -1) {\n+                        if(cm.canHoldAll([2030007, 4031061], [5, 1])) {\n+                            cm.gainItem(2030007, 5);\n+                            cm.gainItem(4031061, 1);\n+\n+                            eim.gridInsert(cm.getPlayer(), 1);\n+                        } else {\n+                            cm.sendOk(\"Make sure you have room in your inventory before proceeding.\");\n+                        }\n                     } else {\n-                        cm.sendYesNo(\"So, you brought the fire ore and the documents with you? In that case, I can give you and your party a piece of it that should be more than enough to make the core of Zakum. As well, since you brought the documents with you, I can also give you a special item which will bring you to the mine's entrance at any time. Make sure your whole party has room in their inventory before proceeding.\");\n-                        scrolls = true;\n+                        cm.sendOk(\"You have already received your share. You can now exit the mines through the portal over there.\");\n+                    }\n+                } else {\n+                    if(eim.gridCheck(cm.getPlayer()) == -1) {\n+                        if(cm.canHold(4031061, 1)) {\n+                            cm.gainItem(4031061, 1);\n+\n+                            eim.gridInsert(cm.getPlayer(), 1);\n+                        } else {\n+                            cm.sendOk(\"Make sure you have room in your inventory before proceeding.\");\n+                        }\n+                    } else {\n+                        cm.sendOk(\"You have already received your share. You can now exit the mines through the portal over there.\");\n                     }\n                 }\n-            } else if (selection == 2)\n-                cm.sendYesNo(\"Are you sure you want to exit? If you're the party leader, your party will also be removed from the mines.\")\n+                \n+                cm.dispose();\n+            }\n+            \n         }\n         else if (status == 2) {\n-            var eim = cm.getPlayer().getEventInstance();\n             if (selectedType == 1) {\n-                var party = eim.getPlayers();\n                 cm.gainItem(4001018, -1);\n-                if (scrolls)\n+                \n+                if(gotAllDocs) {\n                     cm.gainItem(4001015, -30);\n-                cm.givePartyItems(4031061, 1, party);\n-                if (scrolls) {\n-                    cm.givePartyItems(2030007, 5, party);\n-                    cm.givePartyExp(20000, party);\n-                } else\n-                    cm.givePartyExp(12000, party);\n+                    \n+                    eim.setProperty(\"gotDocuments\", 1);\n+                    eim.giveEventPlayersExp(20000);\n+                } else {\n+                    eim.giveEventPlayersExp(12000);\n+                }\n+                \n                 eim.clearPQ();\n                 cm.dispose();\n             }\n             else if (selectedType == 2) {\n-                if (cm.isLeader())\n-                    eim.disbandParty();\n-                else\n-                    eim.leaveParty(cm.getPlayer());\n+                cm.warp(211042300);\n                 cm.dispose();\n             }\n         }"}, {"sha": "fc40ba717f918e08cd1442add8e337386e838499", "filename": "scripts/npc/2032003.js", "status": "modified", "additions": 16, "deletions": 11, "changes": 27, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/2032003.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/2032003.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/2032003.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -23,30 +23,35 @@\n  * \n  * Adobis's Mission I : Breath of Lava <Level 2> (280020001)\n  * Zakum Quest NPC \n- * Custom Quest 100202 -> Done this stage once\n  */\n  \n-var status;\n+var status = -1;\n  \n function start() {\n-    cm.sendNext(\"Congratulations on getting this far!  Well, I suppose I'd better give you your #bBreath of Fire#k.  You've certainly earned it!\");\n+    action(1, 0, 0);\n }\n  \n function action(mode, type, selection) {\n     if (mode < 1)\n         cm.dispose();\n     else {\n         status++;\n-        if (status == 1)\n-            cm.sendNextPrev(\"Well, time for you to head off.\");\n-        else if (status == 2) {\n+        \n+        if (status == 0) {\n+            cm.sendNext(\"Congratulations on getting this far!  Well, I suppose I'd better give you your #bBreath of Fire#k.  You've certainly earned it!\");\n+        } else if (status == 1) {\n+            if(!cm.canHold(4031062)) {\n+                cm.sendOk(\"Try freeing a slot to receive the #b#t4031062##k.\");\n+                cm.dispose();\n+                return;\n+            }\n+            \n+            cm.sendNext(\"Well, time for you to head off.\");\n+        } else if (status == 2) {\n             cm.gainItem(4031062,1);\n+            cm.gainExp(10000 * cm.getPlayer().getExpRate());\n             cm.warp(211042300);\n-            if (cm.isQuestCompleted(100202)) {\n-                cm.startQuest(100202);\n-                cm.completeQuest(100202);\n-                cm.gainExp(10000 * qm.getPlayer().getExpRate());\n-            }\n+            \n             cm.dispose();\n         }\n     }"}, {"sha": "3af52cd0847283a053417ba736cca88da1a383c3", "filename": "scripts/npc/2040043.js", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/2040043.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/2040043.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/2040043.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -122,15 +122,15 @@ function action(mode, type, selection) {\n                                             }\n                                         }\n \n-                                        if (playersOnCombo == 5 || cm.getPlayer().gmLevel() > 0) {\n+                                        if (playersOnCombo == 5 || cm.getPlayer().gmLevel() > 1) {\n                                             var combo = eim.getProperty(\"stage\" + stage + \"combo\").split(',');\n                                             var correctCombo = true;\n                                             for (i = 0; i < objset.length && correctCombo; i++)\n                                                 if (parseInt(combo[i]) != objset[i]) {\n                                                     //cm.mapMessage(5, \"Combo failed on \" + (i + 1));\n                                                     correctCombo = false;\n                                                 }\n-                                            if (correctCombo || cm.getPlayer().gmLevel() > 0) {\n+                                            if (correctCombo || cm.getPlayer().gmLevel() > 1) {\n                                                 eim.setProperty(\"statusStg\" + stage, 1);\n                                                 clearStage(stage, eim, curMap);\n                                                 cm.dispose();"}, {"sha": "f83fa8fd1f61c0034ca8da524879091f125b45b0", "filename": "scripts/npc/2081005.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/2081005.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/2081005.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/2081005.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -33,7 +33,7 @@ function isTransformed(ch) {\n \n function start() {\n     if(!(isTransformed(cm.getPlayer()) || cm.haveItem(4001086))) {\n-        cm.sendOk(\"This is the cave of the mighty Horntail, supreme ruler of the Leafre Canyons, outsiders are not welcome. Get lost!\");\n+        cm.sendOk(\"This is the cave of the mighty Horntail, supreme ruler of the Leafre Canyons. Only those #bdeemed worthy#k to meet him can pass here, #boutsiders#k are not welcome. Get lost!\");\n         cm.dispose();\n         return;\n     }"}, {"sha": "767a9a63d08159dbb4b9ac6fc5da2415223f389c", "filename": "scripts/npc/2081100.js", "status": "modified", "additions": 74, "deletions": 54, "changes": 128, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/2081100.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/2081100.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/2081100.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -25,62 +25,82 @@\n  *@Purpose: Handles 4th job.\n  */\n \n+var status;\n+ \n function start() {\n-\tif(cm.getLevel() < 120 || Math.round(cm.getJobId() / 100) != 1) {\n-\t\tcm.sendOk(\"Please don't bother me right now, I am trying to concentrate.\");\n-\t\tcm.dispose();\n-    } else if (!cm.isQuestCompleted(6904)) {\n-        cm.sendOk(\"You have not yet passed my trials. I can not advance you until you do so.\");\n-        cm.dispose();\n-    } else if ( cm.getJobId() % 100 % 10 != 2) {\n-        cm.sendYesNo(\"You did a marvellous job passing my test. Are you ready to advance to your 4th job?\");\n-\t} else {\n-\t\tcm.sendSimple(\"If I must, I can teach you the art of your class.\\r\\n#b#L0#Teach me the skills of my class.#l\");\n-\t\t//cm.dispose();\n-\t}\n+        status = -1;\n+        action(1, 0, 0);\n }\n \n function action(mode, type, selection) {\n-    if (mode >= 1 && cm.getJobId() % 100 % 10 != 2) {\n-\t\tcm.changeJobById(cm.getJobId() + 1);\n-\t\tif(cm.getJobId() == 112) {\n-\t\t\tcm.teachSkill(1121001, 0, 10, -1);\n-\t\t\tcm.teachSkill(1120004, 0, 10, -1);\n-\t\t\tcm.teachSkill(1121008, 0, 10, -1);\n-\t\t} else if(cm.getJobId() == 122) {\n-\t\t\tcm.teachSkill(1221001, 0, 10, -1);\n-\t\t\tcm.teachSkill(1220005, 0, 10, -1);\n-\t\t\tcm.teachSkill(1221009, 0, 10, -1);\n-\t\t} else if(cm.getJobId() == 132) {\n-\t\t\tcm.teachSkill(1321001, 0, 10, -1);\n-\t\t\tcm.teachSkill(1320005, 0, 10, -1);\n-\t\t\tcm.teachSkill(1321007, 0, 10, -1);\n-\t\t}\n-\t} else if(mode >= 0 && cm.getJobId() % 100 % 10 == 2) {\n-\t\t// TEMP until I can get the quest fixed...\n-\t\tif(cm.getJobId() == 112) {\n-\t\t\tif(cm.getPlayer().getSkillLevel(1121010) == 0)\n-\t\t\t\tcm.teachSkill(1121010 , 0, 10, -1);\n-\t\t\tif(cm.getPlayer().getSkillLevel(1120005) == 0)\n-\t\t\t\tcm.teachSkill(1120005 , 0, 10, -1);\n-\t\t\tif(cm.getPlayer().getSkillLevel(1121002) == 0)\n-\t\t\t\tcm.teachSkill(1121002 , 0, 10, -1);\n-\t\t}  else if(cm.getJobId() == 122) {\n-\t\t\tif(cm.getPlayer().getSkillLevel(1221002) == 0)\n-\t\t\t\tcm.teachSkill(1221002, 0, 10, -1);\n-\t\t\tif(cm.getPlayer().getSkillLevel(1221003) == 0)\n-\t\t\t\tcm.teachSkill(1221003, 0, 10, -1);\n-\t\t\tif(cm.getPlayer().getSkillLevel(1221004) == 0)\n-\t\t\t\tcm.teachSkill(1221004, 0, 10, -1);\n-\t\t} else if(cm.getJobId() == 132) {\n-\t\t\tif(cm.getPlayer().getSkillLevel(1321002) == 0)\n-\t\t\t\tcm.teachSkill(1321002, 0, 10, -1);\n-\t\t\tif(cm.getPlayer().getSkillLevel(1320008) == 0)\n-\t\t\t\tcm.teachSkill(1320008, 0, 10, -1);\n-\t\t\tif(cm.getPlayer().getSkillLevel(1320009) == 0)\n-\t\t\t\tcm.teachSkill(1320009, 0, 10, -1);\n-\t\t}\n-\t\tcm.sendOk(\"It is done. Leave me now.\");\n-\t}\n-    cm.dispose();\n+        if (mode == -1) {\n+                cm.dispose();\n+        } else {\n+                if (mode == 0 && status == 0) {\n+                        cm.dispose();\n+                        return;\n+                }\n+                if (mode == 1)\n+                        status++;\n+                else\n+                        status--;\n+    \n+                if(status == 0) {\n+                        if(cm.getLevel() < 120 || Math.round(cm.getJobId() / 100) != 1) {\n+                                cm.sendOk(\"Please don't bother me right now, I am trying to concentrate.\");\n+                                cm.dispose();\n+                        } else if (!cm.isQuestCompleted(6904)) {\n+                                cm.sendOk(\"You have not yet passed my trials. I can not advance you until you do so.\");\n+                                cm.dispose();\n+                        } else if ( cm.getJobId() % 100 % 10 != 2) {\n+                                cm.sendYesNo(\"You did a marvellous job passing my test. Are you ready to advance to your 4th job?\");\n+                        } else {\n+                                cm.sendSimple(\"If I must, I can teach you the art of your class.\\r\\n#b#L0#Teach me the skills of my class.#l\");\n+                        }\n+                } else if(status == 1) {\n+                        if (mode >= 1 && cm.getJobId() % 100 % 10 != 2) {\n+                                cm.changeJobById(cm.getJobId() + 1);\n+                                if(cm.getJobId() == 112) {\n+                                        cm.teachSkill(1121001, 0, 10, -1);\n+                                        cm.teachSkill(1120004, 0, 10, -1);\n+                                        cm.teachSkill(1121008, 0, 10, -1);\n+                                } else if(cm.getJobId() == 122) {\n+                                        cm.teachSkill(1221001, 0, 10, -1);\n+                                        cm.teachSkill(1220005, 0, 10, -1);\n+                                        cm.teachSkill(1221009, 0, 10, -1);\n+                                } else if(cm.getJobId() == 132) {\n+                                        cm.teachSkill(1321001, 0, 10, -1);\n+                                        cm.teachSkill(1320005, 0, 10, -1);\n+                                        cm.teachSkill(1321007, 0, 10, -1);\n+                                }\n+                        } else if(mode >= 0 && cm.getJobId() % 100 % 10 == 2) {\n+                                // TEMP until I can get the quest fixed...\n+                                if(cm.getJobId() == 112) {\n+                                        if(cm.getPlayer().getSkillLevel(1121010) == 0)\n+                                                cm.teachSkill(1121010 , 0, 10, -1);\n+                                        if(cm.getPlayer().getSkillLevel(1120005) == 0)\n+                                                cm.teachSkill(1120005 , 0, 10, -1);\n+                                        if(cm.getPlayer().getSkillLevel(1121002) == 0)\n+                                                cm.teachSkill(1121002 , 0, 10, -1);\n+                                }  else if(cm.getJobId() == 122) {\n+                                        if(cm.getPlayer().getSkillLevel(1221002) == 0)\n+                                                cm.teachSkill(1221002, 0, 10, -1);\n+                                        if(cm.getPlayer().getSkillLevel(1221003) == 0)\n+                                                cm.teachSkill(1221003, 0, 10, -1);\n+                                        if(cm.getPlayer().getSkillLevel(1221004) == 0)\n+                                                cm.teachSkill(1221004, 0, 10, -1);\n+                                } else if(cm.getJobId() == 132) {\n+                                        if(cm.getPlayer().getSkillLevel(1321002) == 0)\n+                                                cm.teachSkill(1321002, 0, 10, -1);\n+                                        if(cm.getPlayer().getSkillLevel(1320008) == 0)\n+                                                cm.teachSkill(1320008, 0, 10, -1);\n+                                        if(cm.getPlayer().getSkillLevel(1320009) == 0)\n+                                                cm.teachSkill(1320009, 0, 10, -1);\n+                                }\n+                                cm.sendOk(\"It is done. Leave me now.\");\n+                        }\n+                        \n+                        cm.dispose();\n+                }\n+        }\n }\n\\ No newline at end of file"}, {"sha": "f18e4f8dde6dbccd84d91f29a57a23d45511c116", "filename": "scripts/npc/2081200.js", "status": "modified", "additions": 72, "deletions": 52, "changes": 124, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/2081200.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/2081200.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/2081200.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -25,59 +25,79 @@\n  *@Purpose: Handles 4th job.\n  */\n \n- function start() {\n-\tif(cm.getLevel() < 120 || Math.round(cm.getJobId() / 100) != 2) {\n-\t\tcm.sendOk(\"Please don't bother me right now, I am trying to concentrate.\");\n-\t\tcm.dispose();\n-    } else if (!cm.isQuestCompleted(6914)) {\n-        cm.sendOk(\"You have not yet passed my trials. I can not advance you until you do so.\");\n-        cm.dispose();\n-    } else if ( cm.getJobId() % 100 % 10 != 2) {\n-        cm.sendYesNo(\"You did a marvellous job passing my test. Are you ready to advance to your 4th job?\");\n-\t} else {\n-\t\tcm.sendSimple(\"If I must, I can teach you the art of your class.\\r\\n#b#L0#Teach me the skills of my class.#l\");\n-\t\t//cm.dispose();\n-\t}\n+var status;\n+ \n+function start() {\n+        status = -1;\n+        action(1, 0, 0);\n }\n \n function action(mode, type, selection) {\n-    if (mode >= 1 && cm.getJobId() % 100 % 10 != 2) {\n-\t\tcm.changeJobById(cm.getJobId() + 1);\n-\t\tif(cm.getJobId() == 212) {\n-\t\t\tcm.teachSkill(2121001, 0, 10, -1);\n-\t\t\tcm.teachSkill(2121002, 0, 10, -1);\n-\t\t\tcm.teachSkill(2121006, 0, 10, -1);\n-\t\t} else if(cm.getJobId() == 222) {\n-\t\t\tcm.teachSkill(2221001, 0, 10, -1);\n-\t\t\tcm.teachSkill(2221002, 0, 10, -1);\n-\t\t\tcm.teachSkill(2221006, 0, 10, -1);\n-\t\t} else if(cm.getJobId() == 232) {\n-\t\t\tcm.teachSkill(2321001, 0, 10, -1);\n-\t\t\tcm.teachSkill(2321002, 0, 10, -1);\n-\t\t\tcm.teachSkill(2321005, 0, 10, -1);\n-\t\t}\n-\t} else if( mode >= 1 && cm.getJobId() % 100 % 10 == 2) {\n-\t\tif(cm.getJobId() == 212) {\n-\t\t\tif(cm.getPlayer().getSkillLevel(2121007) == 0)\n-\t\t\t\tcm.teachSkill(2121007 , 0, 10, -1);\n-\t\t\tif(cm.getPlayer().getSkillLevel(2121005) == 0)\n-\t\t\t\tcm.teachSkill(2121005 , 0, 10, -1);\n-\t\t\tif(cm.getPlayer().getSkillLevel(2121005) == 0)\n-\t\t\t\tcm.teachSkill(2121005 , 0, 10, -1);\n-\t\t} else if(cm.getJobId() == 222) {\n-\t\t\tif(cm.getPlayer().getSkillLevel(2221007) == 0)\n-\t\t\t\tcm.teachSkill(2221007 , 0, 10, -1);\n-\t\t\tif(cm.getPlayer().getSkillLevel(2221005) == 0)\n-\t\t\t\tcm.teachSkill(2221005 , 0, 10, -1);\n-\t\t\tif(cm.getPlayer().getSkillLevel(2221003) == 0)\n-\t\t\t\tcm.teachSkill(2221003 , 0, 10, -1);\n-\t\t} else if(cm.getJobId() == 232) {\n-\t\t\tif (cm.getPlayer().getSkillLevel(2321008) < 1)\n-\t    \t\t  cm.teachSkill(2321008, 0, 10,-1); // Genesis \n-\t    \tif (cm.getPlayer().getSkillLevel(2321006) < 1)\n-\t\t    \tcm.teachSkill(2321006, 0, 10,-1); // res\n-\t\t}\n-\t\tcm.sendOk(\"It is done. Leave me now.\");\n-\t}\n-    cm.dispose();\n+        if (mode == -1) {\n+                cm.dispose();\n+        } else {\n+                if (mode == 0 && status == 0) {\n+                        cm.dispose();\n+                        return;\n+                }\n+                if (mode == 1)\n+                        status++;\n+                else\n+                        status--;\n+    \n+                if(status == 0) {\n+                        if(cm.getLevel() < 120 || Math.round(cm.getJobId() / 100) != 2) {\n+                                cm.sendOk(\"Please don't bother me right now, I am trying to concentrate.\");\n+                                cm.dispose();\n+                        } else if (!cm.isQuestCompleted(6914)) {\n+                                cm.sendOk(\"You have not yet passed my trials. I can not advance you until you do so.\");\n+                                cm.dispose();\n+                        } else if ( cm.getJobId() % 100 % 10 != 2) {\n+                                cm.sendYesNo(\"You did a marvellous job passing my test. Are you ready to advance to your 4th job?\");\n+                        } else {\n+                                cm.sendSimple(\"If I must, I can teach you the art of your class.\\r\\n#b#L0#Teach me the skills of my class.#l\");\n+                                //cm.dispose();\n+                        }\n+                } else if(status == 1) {\n+                        if (mode >= 1 && cm.getJobId() % 100 % 10 != 2) {\n+                                cm.changeJobById(cm.getJobId() + 1);\n+                                if(cm.getJobId() == 212) {\n+                                        cm.teachSkill(2121001, 0, 10, -1);\n+                                        cm.teachSkill(2121002, 0, 10, -1);\n+                                        cm.teachSkill(2121006, 0, 10, -1);\n+                                } else if(cm.getJobId() == 222) {\n+                                        cm.teachSkill(2221001, 0, 10, -1);\n+                                        cm.teachSkill(2221002, 0, 10, -1);\n+                                        cm.teachSkill(2221006, 0, 10, -1);\n+                                } else if(cm.getJobId() == 232) {\n+                                        cm.teachSkill(2321001, 0, 10, -1);\n+                                        cm.teachSkill(2321002, 0, 10, -1);\n+                                        cm.teachSkill(2321005, 0, 10, -1);\n+                                }\n+                        } else if( mode >= 1 && cm.getJobId() % 100 % 10 == 2) {\n+                                if(cm.getJobId() == 212) {\n+                                        if(cm.getPlayer().getSkillLevel(2121007) == 0)\n+                                                cm.teachSkill(2121007 , 0, 10, -1);\n+                                        if(cm.getPlayer().getSkillLevel(2121005) == 0)\n+                                                cm.teachSkill(2121005 , 0, 10, -1);\n+                                        if(cm.getPlayer().getSkillLevel(2121005) == 0)\n+                                                cm.teachSkill(2121005 , 0, 10, -1);\n+                                } else if(cm.getJobId() == 222) {\n+                                        if(cm.getPlayer().getSkillLevel(2221007) == 0)\n+                                                cm.teachSkill(2221007 , 0, 10, -1);\n+                                        if(cm.getPlayer().getSkillLevel(2221005) == 0)\n+                                                cm.teachSkill(2221005 , 0, 10, -1);\n+                                        if(cm.getPlayer().getSkillLevel(2221003) == 0)\n+                                                cm.teachSkill(2221003 , 0, 10, -1);\n+                                } else if(cm.getJobId() == 232) {\n+                                        if (cm.getPlayer().getSkillLevel(2321008) < 1)\n+                                                cm.teachSkill(2321008, 0, 10,-1); // Genesis \n+                                        if (cm.getPlayer().getSkillLevel(2321006) < 1)\n+                                                cm.teachSkill(2321006, 0, 10,-1); // res\n+                                }\n+                                cm.sendOk(\"It is done. Leave me now.\");\n+                        }\n+                        cm.dispose();\n+                }\n+        }\n }\n\\ No newline at end of file"}, {"sha": "2034be3293aa97eccc639f5cd2b3afc05e31b6d3", "filename": "scripts/npc/2081300.js", "status": "modified", "additions": 64, "deletions": 43, "changes": 107, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/2081300.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/2081300.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/2081300.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -25,50 +25,71 @@\n  *@Purpose: Handles 4th job.\n  */\n \n+var status;\n+ \n function start() {\n-\tif(cm.getLevel() < 120 || Math.round(cm.getJobId() / 100) != 3) {\n-\t\tcm.sendOk(\"Please don't bother me right now, I am trying to concentrate.\");\n-\t\tcm.dispose();\n-    } else if (!cm.isQuestCompleted(6924)) { \n-        cm.sendOk(\"You have not yet passed my trials. I can not advance you until you do so.\");\n-        cm.dispose();\n-    } else if ( cm.getJobId() % 100 % 10 != 2) {\n-        cm.sendYesNo(\"You did a marvellous job passing my test. Are you ready to advance to your 4th job?\");\n-\t} else {\n-\t\tcm.sendSimple(\"If I must, I can teach you the art of your class.\\r\\n#b#L0#Teach me the skills of my class.#l\");\n-\t\t//cm.dispose();\n-\t}\n+        status = -1;\n+        action(1, 0, 0);\n }\n \n function action(mode, type, selection) {\n-\tif (mode >= 1 && cm.getJobId() % 100 % 10 != 2) {\n-\t\tcm.changeJobById(cm.getJobId() + 1);\n-\t\tif(cm.getJobId() == 312) {\n-\t\t\tcm.teachSkill(3121002, 0, 10, -1);\n-\t\t\tcm.teachSkill(3120005, 0, 10, -1);\n-\t\t\tcm.teachSkill(3121007, 0, 10, -1);\n-\t\t} else if(cm.getJobId() == 322) {\n-\t\t\tcm.teachSkill(3221002, 0, 10, -1);\n-\t\t\tcm.teachSkill(3220004, 0, 10, -1);\n-\t\t\tcm.teachSkill(3221006, 0, 10, -1);\n-\t\t}\n-\t} else if(mode >= 0 && cm.getJobId() % 100 % 10 == 2) {\n-\t\tif(cm.getJobId() == 312) {\n-\t\t\tif(cm.getPlayer().getSkillLevel(3121008) == 0)\n-\t\t\t\tcm.teachSkill(3121008 , 0, 10, -1);\n-\t\t\tif(cm.getPlayer().getSkillLevel(3121006) == 0)\n-\t\t\t\tcm.teachSkill(3121006 , 0, 10, -1);\n-\t\t\tif(cm.getPlayer().getSkillLevel(3121004) == 0)\n-\t\t\t\tcm.teachSkill(3121004 , 0, 10, -1);\n-\t\t} else if(cm.getJobId() == 322) {\n-\t\t\tif(cm.getPlayer().getSkillLevel(3221007) == 0)\n-\t\t\t\tcm.teachSkill(3221007 , 0, 10, -1);\n-\t\t\tif(cm.getPlayer().getSkillLevel(3221005) == 0)\n-\t\t\t\tcm.teachSkill(3221005 , 0, 10, -1);\n-\t\t\tif(cm.getPlayer().getSkillLevel(3221001) == 0)\n-\t\t\t\tcm.teachSkill(3221001 , 0, 10, -1);\n-\t\t}\n-\t\tcm.sendOk(\"It is done. Leave me now.\");\n-\t}\n-    cm.dispose();\n-}\n\\ No newline at end of file\n+        if (mode == -1) {\n+                cm.dispose();\n+        } else {\n+                if (mode == 0 && status == 0) {\n+                        cm.dispose();\n+                        return;\n+                }\n+                if (mode == 1)\n+                        status++;\n+                else\n+                        status--;\n+    \n+                if(status == 0) {\n+                        if(cm.getLevel() < 120 || Math.round(cm.getJobId() / 100) != 3) {\n+                                cm.sendOk(\"Please don't bother me right now, I am trying to concentrate.\");\n+                                cm.dispose();\n+                        } else if (!cm.isQuestCompleted(6924)) { \n+                                cm.sendOk(\"You have not yet passed my trials. I can not advance you until you do so.\");\n+                                cm.dispose();\n+                        } else if ( cm.getJobId() % 100 % 10 != 2) {\n+                                cm.sendYesNo(\"You did a marvellous job passing my test. Are you ready to advance to your 4th job?\");\n+                        } else {\n+                                cm.sendSimple(\"If I must, I can teach you the art of your class.\\r\\n#b#L0#Teach me the skills of my class.#l\");\n+                                //cm.dispose();\n+                        }\n+                } else if(status == 1) {\n+                        if (mode >= 1 && cm.getJobId() % 100 % 10 != 2) {\n+                                cm.changeJobById(cm.getJobId() + 1);\n+                                if(cm.getJobId() == 312) {\n+                                        cm.teachSkill(3121002, 0, 10, -1);\n+                                        cm.teachSkill(3120005, 0, 10, -1);\n+                                        cm.teachSkill(3121007, 0, 10, -1);\n+                                } else if(cm.getJobId() == 322) {\n+                                        cm.teachSkill(3221002, 0, 10, -1);\n+                                        cm.teachSkill(3220004, 0, 10, -1);\n+                                        cm.teachSkill(3221006, 0, 10, -1);\n+                                }\n+                        } else if(mode >= 0 && cm.getJobId() % 100 % 10 == 2) {\n+                                if(cm.getJobId() == 312) {\n+                                        if(cm.getPlayer().getSkillLevel(3121008) == 0)\n+                                                cm.teachSkill(3121008 , 0, 10, -1);\n+                                        if(cm.getPlayer().getSkillLevel(3121006) == 0)\n+                                                cm.teachSkill(3121006 , 0, 10, -1);\n+                                        if(cm.getPlayer().getSkillLevel(3121004) == 0)\n+                                                cm.teachSkill(3121004 , 0, 10, -1);\n+                                } else if(cm.getJobId() == 322) {\n+                                        if(cm.getPlayer().getSkillLevel(3221007) == 0)\n+                                                cm.teachSkill(3221007 , 0, 10, -1);\n+                                        if(cm.getPlayer().getSkillLevel(3221005) == 0)\n+                                                cm.teachSkill(3221005 , 0, 10, -1);\n+                                        if(cm.getPlayer().getSkillLevel(3221001) == 0)\n+                                                cm.teachSkill(3221001 , 0, 10, -1);\n+                                }\n+                                cm.sendOk(\"It is done. Leave me now.\");\n+                        }\n+                        \n+                        cm.dispose();\n+                }\n+        }\n+}"}, {"sha": "244faaa34b72406fe12001609341ceda8f234938", "filename": "scripts/npc/2081400.js", "status": "modified", "additions": 60, "deletions": 39, "changes": 99, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/2081400.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/2081400.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/2081400.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -25,46 +25,67 @@\n  *@Purpose: Handles 4th job.\n  */\n \n+var status;\n+ \n function start() {\n-\tif(cm.getLevel() < 120 || Math.round(cm.getJobId() / 100) != 4) {\n-\t\tcm.sendOk(\"Please don't bother me right now, I am trying to concentrate.\");\n-\t\tcm.dispose();\n-    } else if (!cm.isQuestCompleted(6934)) {\n-        cm.sendOk(\"You have not yet passed my trials. I can not advance you until you do so.\");\n-        cm.dispose();\n-    } else if ( cm.getJobId() % 100 % 10 != 2) {\n-        cm.sendYesNo(\"You did a marvellous job passing my test. Are you ready to advance to your 4th job?\");\n-\t} else {\n-\t\tcm.sendSimple(\"If I must, I can teach you the art of your class.\\r\\n#b#L0#Teach me the skills of my class.#l\");\n-\t\t//cm.dispose();\n-\t}\n+        status = -1;\n+        action(1, 0, 0);\n }\n \n function action(mode, type, selection) {\n-    if (mode >= 1 && cm.getJobId() % 100 % 10 != 2) {\n-\t\tcm.changeJobById(cm.getJobId() + 1);\n-\t\tif(cm.getJobId() == 412) {\n-\t\t\tcm.teachSkill(4120002, 0, 10, -1);\n-\t\t\tcm.teachSkill(4120005, 0, 10, -1);\n-\t\t\tcm.teachSkill(4121006, 0, 10, -1);\n-\t\t} else if(cm.getJobId() == 422) {\n-\t\t\tcm.teachSkill(4220002, 0, 10, -1);\n-\t\t\tcm.teachSkill(4220005, 0, 10, -1);\n-\t\t\tcm.teachSkill(4221007, 0, 10, -1);\n-\t\t}\n-\t} else if(mode >= 1 && cm.getJobId() % 100 % 10 == 2) {\n-\t\tif(cm.getJobId() == 412) {\n-\t\t\tif(cm.getPlayer().getSkillLevel(4121008) == 0)\n-\t\t\t\tcm.teachSkill(4121008 , 0, 10, -1);\n-\t\t\tif(cm.getPlayer().getSkillLevel(4121004) == 0)\n-\t\t\t\tcm.teachSkill(4121004 , 0, 10, -1);\n-\t\t} else if(cm.getJobId() == 422) {\n-\t\t\tif(cm.getPlayer().getSkillLevel(4221004) == 0)\n-\t\t\t\tcm.teachSkill(4221004 , 0, 10, -1);\n-\t\t\tif(cm.getPlayer().getSkillLevel(4221001) == 0)\n-\t\t\t\tcm.teachSkill(4221001 , 0, 10, -1);\n-\t\t}\n-\t\tcm.sendOk(\"It is done. Leave me now.\");\n-\t}\n-    cm.dispose();\n-}\n\\ No newline at end of file\n+        if (mode == -1) {\n+                cm.dispose();\n+        } else {\n+                if (mode == 0 && status == 0) {\n+                        cm.dispose();\n+                        return;\n+                }\n+                if (mode == 1)\n+                        status++;\n+                else\n+                        status--;\n+    \n+                if(status == 0) {\n+                        if(cm.getLevel() < 120 || Math.round(cm.getJobId() / 100) != 4) {\n+                                cm.sendOk(\"Please don't bother me right now, I am trying to concentrate.\");\n+                                cm.dispose();\n+                        } else if (!cm.isQuestCompleted(6934)) {\n+                                cm.sendOk(\"You have not yet passed my trials. I can not advance you until you do so.\");\n+                                cm.dispose();\n+                        } else if ( cm.getJobId() % 100 % 10 != 2) {\n+                                cm.sendYesNo(\"You did a marvellous job passing my test. Are you ready to advance to your 4th job?\");\n+                        } else {\n+                                cm.sendSimple(\"If I must, I can teach you the art of your class.\\r\\n#b#L0#Teach me the skills of my class.#l\");\n+                                //cm.dispose();\n+                        }\n+                } else if(status == 1) {\n+                        if (mode >= 1 && cm.getJobId() % 100 % 10 != 2) {\n+                                cm.changeJobById(cm.getJobId() + 1);\n+                                if(cm.getJobId() == 412) {\n+                                        cm.teachSkill(4120002, 0, 10, -1);\n+                                        cm.teachSkill(4120005, 0, 10, -1);\n+                                        cm.teachSkill(4121006, 0, 10, -1);\n+                                } else if(cm.getJobId() == 422) {\n+                                        cm.teachSkill(4220002, 0, 10, -1);\n+                                        cm.teachSkill(4220005, 0, 10, -1);\n+                                        cm.teachSkill(4221007, 0, 10, -1);\n+                                }\n+                        } else if(mode >= 1 && cm.getJobId() % 100 % 10 == 2) {\n+                                if(cm.getJobId() == 412) {\n+                                        if(cm.getPlayer().getSkillLevel(4121008) == 0)\n+                                                cm.teachSkill(4121008 , 0, 10, -1);\n+                                        if(cm.getPlayer().getSkillLevel(4121004) == 0)\n+                                                cm.teachSkill(4121004 , 0, 10, -1);\n+                                } else if(cm.getJobId() == 422) {\n+                                        if(cm.getPlayer().getSkillLevel(4221004) == 0)\n+                                                cm.teachSkill(4221004 , 0, 10, -1);\n+                                        if(cm.getPlayer().getSkillLevel(4221001) == 0)\n+                                                cm.teachSkill(4221001 , 0, 10, -1);\n+                                }\n+                                cm.sendOk(\"It is done. Leave me now.\");\n+                        }\n+                        \n+                        cm.dispose();\n+                }\n+        }\n+}"}, {"sha": "a6e24d36abbab1dfe9266873b8779ba99cdee5b7", "filename": "scripts/npc/2081500.js", "status": "modified", "additions": 72, "deletions": 51, "changes": 123, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/2081500.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/2081500.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/2081500.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -25,58 +25,79 @@\n  *@Purpose: Handles 4th job.\n  */\n \n+var status;\n+ \n function start() {\n-\tif(cm.getLevel() < 120 || Math.round(cm.getJobId() / 100) != 5) {\n-\t\tcm.sendOk(\"Please don't bother me right now, I am trying to concentrate.\");\n-\t\tcm.dispose();\n-    } else if (!cm.isQuestCompleted(6944)) {\n-        cm.sendOk(\"You have not yet passed my trials. I can not advance you until you do so.\");\n-        cm.dispose();\n-    } else if ( cm.getJobId() % 100 % 10 != 2) {\n-        cm.sendYesNo(\"You did a marvellous job passing my test. Are you ready to advance to your 4th job?\");\n-\t} else {\n-\t\tcm.sendSimple(\"If I must, I can teach you the art of your class.\\r\\n#b#L0#Teach me the skills of my class.#l\");\n-\t\t//cm.dispose();\n-\t}\n+        status = -1;\n+        action(1, 0, 0);\n }\n \n function action(mode, type, selection) {\n-    if (mode >= 1 && cm.getJobId() % 100 % 10 != 2) {\n-\t\tcm.changeJobById(cm.getJobId() + 1);\n-\t\tif(cm.getJobId() == 512) {\n-\t\t\tcm.teachSkill(5121001, 0, 10, -1);\n-\t\t\tcm.teachSkill(5121002, 0, 10, -1);\n-\t\t\tcm.teachSkill(5121007, 0, 10, -1);\n-\t\t\tcm.teachSkill(5121009, 0, 10, -1);\n-\t\t} else if(cm.getJobId() == 522) {\n-\t\t\tcm.teachSkill(5220001, 0, 10, -1);\n-\t\t\tcm.teachSkill(5220002, 0, 10, -1);\n-\t\t\tcm.teachSkill(5221004, 0, 10, -1);\n-\t\t\tcm.teachSkill(5220011, 0, 10, -1);\n-\t\t}\n-\t} else if(mode >= 1 && cm.getJobId() % 100 % 10 == 2) {\n-\t\tif(cm.getJobId() == 512) {\n-\t\t\tif(cm.getPlayer().getSkillLevel(5121003) == 0)\n-\t\t\t\tcm.teachSkill(5121003, 0, 10, -1);\n-\t\t\tif(cm.getPlayer().getSkillLevel(5121004) == 0)\n-\t\t\t\tcm.teachSkill(5121004, 0, 10, -1);\n-\t\t\tif(cm.getPlayer().getSkillLevel(5121005) == 0)\n-\t\t\t\tcm.teachSkill(5121005, 0, 10, -1);\n-\t\t\tif(cm.getPlayer().getSkillLevel(5121010) == 0)\n-\t\t\t\tcm.teachSkill(5121010, 0, 10, -1);\n-\t\t} else if(cm.getJobId() == 522) {\n-\t\t\tif(cm.getPlayer().getSkillLevel(5221006) == 0)\n-\t\t\t\tcm.teachSkill(5221006, 0, 10, -1);\n-\t\t\tif(cm.getPlayer().getSkillLevel(5221007) == 0)\n-\t\t\t\tcm.teachSkill(5221007, 0, 10, -1);\n-\t\t\tif(cm.getPlayer().getSkillLevel(5221008) == 0)\n-\t\t\t\tcm.teachSkill(5221008, 0, 10, -1);\n-\t\t\tif(cm.getPlayer().getSkillLevel(5221009) == 0)\n-\t\t\t\tcm.teachSkill(5221009, 0, 10, -1);\n-\t\t\tif(cm.getPlayer().getSkillLevel(5221003) == 0)\n-\t\t\t\tcm.teachSkill(5221003, 0, 10, -1);\n-\t\t}\n-\t\tcm.sendOk(\"It is done. Leave me now.\");\n-\t}\n-    cm.dispose();\n-}\n\\ No newline at end of file\n+        if (mode == -1) {\n+                cm.dispose();\n+        } else {\n+                if (mode == 0 && status == 0) {\n+                        cm.dispose();\n+                        return;\n+                }\n+                if (mode == 1)\n+                        status++;\n+                else\n+                        status--;\n+    \n+                if(status == 0) {\n+                        if(cm.getLevel() < 120 || Math.round(cm.getJobId() / 100) != 5) {\n+                                cm.sendOk(\"Please don't bother me right now, I am trying to concentrate.\");\n+                                cm.dispose();\n+                        } else if (!cm.isQuestCompleted(6944)) {\n+                                cm.sendOk(\"You have not yet passed my trials. I can not advance you until you do so.\");\n+                                cm.dispose();\n+                        } else if ( cm.getJobId() % 100 % 10 != 2) {\n+                                cm.sendYesNo(\"You did a marvellous job passing my test. Are you ready to advance to your 4th job?\");\n+                        } else {\n+                                cm.sendSimple(\"If I must, I can teach you the art of your class.\\r\\n#b#L0#Teach me the skills of my class.#l\");\n+                                //cm.dispose();\n+                        }\n+                } else if(status == 1) {\n+                        if (mode >= 1 && cm.getJobId() % 100 % 10 != 2) {\n+                                cm.changeJobById(cm.getJobId() + 1);\n+                                if(cm.getJobId() == 512) {\n+                                        cm.teachSkill(5121001, 0, 10, -1);\n+                                        cm.teachSkill(5121002, 0, 10, -1);\n+                                        cm.teachSkill(5121007, 0, 10, -1);\n+                                        cm.teachSkill(5121009, 0, 10, -1);\n+                                } else if(cm.getJobId() == 522) {\n+                                        cm.teachSkill(5220001, 0, 10, -1);\n+                                        cm.teachSkill(5220002, 0, 10, -1);\n+                                        cm.teachSkill(5221004, 0, 10, -1);\n+                                        cm.teachSkill(5220011, 0, 10, -1);\n+                                }\n+                        } else if(mode >= 1 && cm.getJobId() % 100 % 10 == 2) {\n+                                if(cm.getJobId() == 512) {\n+                                        if(cm.getPlayer().getSkillLevel(5121003) == 0)\n+                                                cm.teachSkill(5121003, 0, 10, -1);\n+                                        if(cm.getPlayer().getSkillLevel(5121004) == 0)\n+                                                cm.teachSkill(5121004, 0, 10, -1);\n+                                        if(cm.getPlayer().getSkillLevel(5121005) == 0)\n+                                                cm.teachSkill(5121005, 0, 10, -1);\n+                                        if(cm.getPlayer().getSkillLevel(5121010) == 0)\n+                                                cm.teachSkill(5121010, 0, 10, -1);\n+                                } else if(cm.getJobId() == 522) {\n+                                        if(cm.getPlayer().getSkillLevel(5221006) == 0)\n+                                                cm.teachSkill(5221006, 0, 10, -1);\n+                                        if(cm.getPlayer().getSkillLevel(5221007) == 0)\n+                                                cm.teachSkill(5221007, 0, 10, -1);\n+                                        if(cm.getPlayer().getSkillLevel(5221008) == 0)\n+                                                cm.teachSkill(5221008, 0, 10, -1);\n+                                        if(cm.getPlayer().getSkillLevel(5221009) == 0)\n+                                                cm.teachSkill(5221009, 0, 10, -1);\n+                                        if(cm.getPlayer().getSkillLevel(5221003) == 0)\n+                                                cm.teachSkill(5221003, 0, 10, -1);\n+                                }\n+                                cm.sendOk(\"It is done. Leave me now.\");\n+                        }\n+                        \n+                        cm.dispose();\n+                }\n+        }\n+}"}, {"sha": "ad98d3336ca1842a86c5126e4b1290f93e136597", "filename": "scripts/npc/2083004.js", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/2083004.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/2083004.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/2083004.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -45,7 +45,7 @@ function action(mode, type, selection) {\n \n     player = cm.getPlayer();\n     expedition = cm.getExpedition(exped);\n-    em = cm.getEventManager(\"HorntailFight\");\n+    em = cm.getEventManager(\"HorntailBattle\");\n \n     if (mode == -1) {\n         cm.dispose();\n@@ -127,8 +127,8 @@ function action(mode, type, selection) {\n                 cm.sendSimple(text);\n                 status = 6;\n             } else if (selection == 2) {\n-                //var min = exped.getMinSize();\n-                var min = 1;\n+                var min = exped.getMinSize();\n+                \n                 var size = expedition.getMembers().size();\n                 if (size < min) {\n                     cm.sendOk(\"You need at least \" + min + \" players registered in your expedition.\");"}, {"sha": "e8014c8a26f88501e1078496a572d2c83dc3d234", "filename": "scripts/npc/2091005.js", "status": "modified", "additions": 296, "deletions": 215, "changes": 511, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/2091005.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/2091005.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/2091005.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -20,7 +20,7 @@\n     along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n /*\n-* @Author: Moogra, XxOsirisxX\n+* @Author: Moogra, XxOsirisxX, Ronan\n * @NPC:    2091005\n * @Name:   So Gong\n * @Map(s): Dojo Hall\n@@ -36,261 +36,342 @@ var belt_points = Array(10, 90, 200, 460, 850); /* Watered down version */\n \n var status = -1;\n var selectedMenu = -1;\n+var dojoWarp = 0;\n \n function start() {\n-\tif(disabled) {\n-\t\tcm.sendOk(\"My master has requested that the dojo be #rclosed#k at this time so I can't let you in.\");\n-\t\tcm.dispose();\n-\t\treturn;\n-\t}\n-\t\n-    if (isRestingSpot(cm.getPlayer().getMap().getId())) {\n-        var text = \"I'm surprised you made it this far! But it won't be easy from here on out. You still want the challenge?\\r\\n\\r\\n#b#L0#I want to continue#l\\r\\n#L1#I want to leave#l\\r\\n\";\n-        if (!cm.getPlayer().getDojoParty()) {\n-            text += \"#L2#I want to record my score up to this point#l\";\n-        }\n-        cm.sendSimple(text);\n-    } else if (cm.getPlayer().getLevel() >= 25) {\n-        if (cm.getPlayer().getMap().getId() == 925020001) {\n-            cm.sendSimple(\"My master is the strongest person in Mu Lung, and you want to challenge him? Fine, but you'll regret it later.\\r\\n\\r\\n#b#L0#I want to challenge him alone.#l\\r\\n#L1#I want to challenge him with a party.#l\\r\\n\\r\\n#L2#I want to receive a belt.#l\\r\\n#L3#I want to reset my training points.#l\\r\\n#L4#I want to receive a medal.#l\\r\\n#L5#What is a Mu Lung Dojo?#l\");\n-        } else {\n-            cm.sendYesNo(\"What, you're giving up? You just need to get to the next level! Do you really want to quit and leave?\");\n-        }\n-    } else {\n-        cm.sendOk(\"Hey! Are you mocking my master? Who do you think you are to challenge him? This is a joke! You should at least be level #b25#k.\");\n+    if(disabled) {\n+        cm.sendOk(\"My master has requested that the dojo be #rclosed#k at this time so I can't let you in.\");\n         cm.dispose();\n-\treturn;\n+        return;\n     }\n+    \n+    action(1, 0, 0);\n }\n \n function action(mode, type, selection) {\n     if (mode == -1) {\n+        cm.getPlayer().setDojoStage(dojoWarp);\n         cm.dispose();\n-    } else if (cm.getPlayer().getMap().getId() == 925020001) {\n-        if (mode >= 0) {\n-            if (status == -1)\n-                selectedMenu = selection;\n-            status++; //there is no prev.\n-            if (selectedMenu == 0) { //I want to challenge him alone.\n-                if (!cm.getPlayer().hasEntered(\"dojang_Msg\") && !cm.getPlayer().getFinishedDojoTutorial()) { //kind of hackish...\n-                    if (status == 0) {\n-                        cm.sendYesNo(\"Hey there! You! This is your first time, huh? Well, my master doesn't just meet with anyone. He's a busy man. And judging by your looks, I don't think he'd bother. Ha! But, today's your lucky day... I tell you what, if you can defeat me, I'll allow you to see my Master. So what do you say?\");\n-                    } else if (status == 1) {\n-                        if (mode == 0) {\n-                            cm.sendNext(\"Haha! Who are you trying to impress with a heart like that?\\r\\nGo back home where you belong!\");\n-\t\t\t    cm.dispose();\n-\t\t\t    return;\n+    } else {\n+        if (mode == 0) {\n+            cm.dispose();\n+            return;\n+        }\n+        if (mode == 1)\n+            status++;\n+        \n+        if(status == 0) {\n+            if (isRestingSpot(cm.getPlayer().getMap().getId())) {\n+                var text = \"I'm surprised you made it this far! But it won't be easy from here on out. You still want the challenge?\\r\\n\\r\\n#b#L0#I want to continue#l\\r\\n#L1#I want to leave#l\\r\\n\";\n+                if (!cm.getPlayer().getDojoParty()) {\n+                    text += \"#L2#I want to record my score up to this point#l\";\n+                }\n+                cm.sendSimple(text);\n+            } else if (cm.getPlayer().getLevel() >= 25) {\n+                if (cm.getPlayer().getMap().getId() == 925020001) {\n+                    cm.sendSimple(\"My master is the strongest person in Mu Lung, and you want to challenge him? Fine, but you'll regret it later.\\r\\n\\r\\n#b#L0#I want to challenge him alone.#l\\r\\n#L1#I want to challenge him with a party.#l\\r\\n\\r\\n#L2#I want to receive a belt.#l\\r\\n#L3#I want to reset my training points.#l\\r\\n#L4#I want to receive a medal.#l\\r\\n#L5#What is a Mu Lung Dojo?#l\");\n+                } else {\n+                    cm.sendYesNo(\"What, you're giving up? You just need to get to the next level! Do you really want to quit and leave?\");\n+                }\n+            } else {\n+                cm.sendOk(\"Hey! Are you mocking my master? Who do you think you are to challenge him? This is a joke! You should at least be level #b25#k.\");\n+                cm.dispose();\n+                return;\n+            }\n+        } else {\n+            if (cm.getPlayer().getMap().getId() == 925020001) {\n+                if (mode >= 0) {\n+                    if (status == 1)\n+                        selectedMenu = selection;\n+                    if (selectedMenu == 0) { //I want to challenge him alone.\n+                        if (!cm.getPlayer().hasEntered(\"dojang_Msg\") && !cm.getPlayer().getFinishedDojoTutorial()) { //kind of hackish...\n+                            if (status == 1) {\n+                                cm.sendYesNo(\"Hey there! You! This is your first time, huh? Well, my master doesn't just meet with anyone. He's a busy man. And judging by your looks, I don't think he'd bother. Ha! But, today's your lucky day... I tell you what, if you can defeat me, I'll allow you to see my Master. So what do you say?\");\n+                            } else if (status == 2) {\n+                                if (mode == 0) {\n+                                    cm.sendNext(\"Haha! Who are you trying to impress with a heart like that?\\r\\nGo back home where you belong!\");\n+                                    cm.dispose();\n+                                    return;\n+                                } else {\n+                                    var avDojo = cm.getClient().getChannelServer().getAvailableDojo(true);\n+\n+                                    if(avDojo < 0) {\n+                                        if(avDojo == -1) cm.sendOk(\"All Dojo's are being used already. Wait for awhile before trying again.\");\n+                                        else cm.sendOk(\"Your party already is using the dojo. Wait for them to finish to enter.\");\n+                                    }\n+                                    else {\n+                                        cm.getClient().getChannelServer().getMapFactory().getMap(925020010 + avDojo).resetMapObjects();\n+                                        cm.getClient().getChannelServer().resetDojo(925020010 + avDojo);\n+                                        cm.warp(925020010 + avDojo, 0);\n+                                    }\n+\n+                                    cm.dispose();\n+                                    return;\n+                                }\n+                            }\n+                        } else if (cm.getPlayer().getDojoStage() > 0) {\n+                            if (status == 1) {\n+                                dojoWarp = cm.getPlayer().getDojoStage();\n+                                cm.getPlayer().setDojoStage(0);\n+                                cm.sendYesNo(\"The last time you took the challenge by yourself, you went up to level \" + dojoWarp + \". I can take you there right now. Do you want to go there?\");\n+                            } else {\n+                                var avDojo = cm.getClient().getChannelServer().getAvailableDojo(false);\n+\n+                                if(avDojo < 0) {\n+                                    if(avDojo == -1) cm.sendOk(\"All Dojo's are being used already. Wait for awhile before trying again.\");\n+                                    else cm.sendOk(\"Your party already is using the dojo. Wait for them to finish to enter.\");\n+                                    cm.getPlayer().setDojoStage(dojoWarp);\n+                                }\n+                                else {\n+                                    var warpDojoMap = ((mode == 1) ? 925020000 + (dojoWarp + 1) * 100 + avDojo : 925020100 + avDojo);\n+                                    cm.getClient().getChannelServer().resetDojoMap(warpDojoMap);\n+                                    cm.getClient().getChannelServer().resetDojo(warpDojoMap);\n+                                    cm.warp(warpDojoMap, 0);\n+                                }\n+\n+                                cm.dispose();\n+                            }\n                         } else {\n-                           if(cm.getClient().getChannelServer().getMapFactory().getMap(925020010).getCharacters().size() > 0) {\n-\t\t\t\t\t\t\t\tcm.sendOk(\"Someone is already in Dojo\");\n+                            var avDojo = cm.getClient().getChannelServer().getAvailableDojo(false);\n+\n+                            if(avDojo < 0) {\n+                                if(avDojo == -1) cm.sendOk(\"All Dojo's are being used already. Wait for awhile before trying again.\");\n+                                else cm.sendOk(\"Your party already is using the dojo. Wait for them to finish to enter.\");\n+                            }\n+                            else {\n+                                cm.getClient().getChannelServer().resetDojoMap(925020100 + avDojo);\n+                                cm.getClient().getChannelServer().resetDojo(925020100 + avDojo);\n+                                cm.warp(925020100 + avDojo, 0);\n                             }\n-\t\t\t   else {\n-                            cm.warp(925020010, 0);\n-                            cm.getPlayer().setFinishedDojoTutorial();\n-\t\t\t   }\n \n-\t\t\t\tcm.dispose();\n-\t\t\t\treturn;\n+                            cm.dispose();\n+                            return;\n                         }\n-                    }\n-                } else if (cm.getPlayer().getDojoStage() > 0) {\n-                    if (status == 0) {\n-                        cm.sendYesNo(\"The last time you took the challenge by yourself, you went up to level \" + cm.getPlayer().getDojoStage() + \". I can take you there right now. Do you want to go there?\");\n-                    } else {\n-                        cm.warp(mode == 1 ? 925020000 + cm.getPlayer().getDojoStage() * 100 : 925020100, 0);\n+                    } else if (selectedMenu == 1) { //I want to challenge him with a party.\n+                        var party = cm.getPlayer().getParty();\n+                        if (party == null) {\n+                            cm.sendNext(\"Where do you think you're going? You're not even the party leader! Go tell your party leader to talk to me.\");\n+                            cm.dispose();\n+                            return;\n+                        }\n+                        \n+                        if (party.getLeader().getId() != cm.getPlayer().getId()) {\n+                            cm.sendNext(\"Where do you think you're going? You're not even the party leader! Go tell your party leader to talk to me.\");\n+                            cm.dispose();\n+                            return;\n+                        }\n+\n+                        //else if (party.getMembers().size() == 1) {\n+                        //    cm.sendNext(\"You're going to take on the challenge as a one-man party?\");\n+                        //}\n+\n+                        else if (!isBetween(party, 30)) {\n+                            cm.sendNext(\"Your partys level ranges are too broad to enter. Please make sure all of your party members are within #r30 levels#k of each other.\");\n+                            cm.dispose();\n+                            return;\n+                        } else {\n+                            var avDojo = cm.getClient().getChannelServer().getAvailableDojo(true, cm.getParty());\n+\n+                            if(avDojo < 0) {\n+                                if(avDojo == -1) cm.sendOk(\"All Dojo's are being used already. Wait for awhile before trying again.\");\n+                                else cm.sendOk(\"Your party already is using the dojo. Wait for them to finish to enter.\");\n+                            }\n+                            else {\n+                                cm.getClient().getChannelServer().resetDojoMap(925030100 + avDojo);\n+                                cm.getClient().getChannelServer().resetDojo(925030100 + avDojo);\n+                                cm.warpParty(925030100 + avDojo);\n+                            }\n+\n+                            cm.dispose();\n+                            return;\n+                        }\n+\n+                    } else if (selectedMenu == 2) { //I want to receive a belt.\n+                        if (!cm.canHold(belts[0])) {\n+                            cm.sendNext(\"Make room in your EQUIP inventory before trying to claim a belt!\");\n+                            cm.dispose();\n+                            return;\n+                        }\n+                        if (mode < 1) {\n+                            cm.dispose();\n+                            return;\n+                        }\n+                        if (status == 1) {\n+                            var selStr = \"You have #b\" + cm.getPlayer().getDojoPoints() + \"#k training points. Master prefers those with great talent. If you obtain more points than the average, you can receive a belt depending on your score.\\r\\n\";\n+                            for (var i = 0; i < belts.length; i++) {\n+                                if (cm.getPlayer().getItemQuantity(belts[i], true) > 0) {\n+                                    selStr += \"\\r\\n#L\" + i + \"##i\" + belts[i] + \"# #t\" + belts[i] + \"# (Obtained)\";\n+                                } else\n+                                    selStr += \"\\r\\n#L\" + i + \"##i\" + belts[i] + \"# #t\" + belts[i] + \"#\";\n+                            }\n+                            cm.sendSimple(selStr);\n+                        } else if (status == 2) {\n+                            var belt = belts[selection];\n+                            var level = belt_level[selection];\n+                            var points = belt_points[selection];\n+                            if (cm.getPlayer().getDojoPoints() > points) {\n+                                if (cm.getPlayer().getLevel() > level) {\n+                                    cm.gainItem(belt, 1);\n+                                    cm.sendNext(\"There is the #i\" + belt + \"# #b#t\" + belt + \"##k. You have proven your valor to ascend on the Dojo ranks. Well done!\");\n+                                }\n+                                else\n+                                    cm.sendNext(\"In order to receive #i\" + belt + \"# #b#t\" + belt + \"##k, you have to be at least over level #b\" + level + \"#k and you need to have earned at least #b\" + points + \" training points#k.\\r\\n\\r\\nIf you want to obtain this belt, you need #r\" + (points - cm.getPlayer().getDojoPoints()) + \"#k more training points.\");\n+                            } else\n+                                cm.sendNext(\"In order to receive #i\" + belt + \"# #b#t\" + belt + \"##k, you have to be at least over level #b\" + level + \"#k and you need to have earned at least #b\" + points + \" training points#k.\\r\\n\\r\\nIf you want to obtain this belt, you need #r\" + (points - cm.getPlayer().getDojoPoints()) + \"#k more training points.\");\n+\n+                            cm.dispose();\n+                            return;\n+                        }\n+                    } else if (selectedMenu == 3) { //I want to reset my training points.\n+                        if (status == 1) {\n+                            cm.sendYesNo(\"You do know that if you reset your training points, it returns to 0, right? Although, that's not always a bad thing. If you can start earning training points again after you reset, you can receive the belts once more. Do you want to reset your training points now?\");\n+                        } else if (status == 2) {\n+                            if (mode == 0) {\n+                                cm.sendNext(\"Do you need to gather yourself or something? Come back after you take a deep breath.\");\n+                            } else {\n+                                cm.getPlayer().setDojoPoints(0);\n+                                cm.sendNext(\"There! All your training points have been reset. Think of it as a new beginning and train hard!\");\n+                            }\n+                            cm.dispose();\n+                            return;\n+                        }\n+                    } else if (selectedMenu == 4) { //I want to receive a medal.\n+                        if (status == 1 && cm.getPlayer().getVanquisherStage() <= 0) {\n+                            cm.sendYesNo(\"You haven't attempted the medal yet? If you defeat one type of monster in Mu Lung Dojo #b100 times#k you can receive a title called #b#t\" + (1142033 + cm.getPlayer().getVanquisherStage()) + \"##k. It looks like you haven't even earned the #b#t\" + (1142033 + cm.getPlayer().getVanquisherStage()) + \"##k... Do you want to try out for the #b#t\" + (1142033 + cm.getPlayer().getVanquisherStage()) + \"##k?\");\n+                        } else if (status == 2 || cm.getPlayer().getVanquisherStage() > 0) {\n+                            if (mode == 0) {\n+                                cm.sendNext(\"If you don't want to, that's fine.\");\n+                            } else {\n+                                if (cm.getPlayer().getDojoStage() > 37) {\n+                                    cm.sendNext(\"You have completed all medals challenges.\");\n+                                } else if (cm.getPlayer().getVanquisherKills() < 100 && cm.getPlayer().getVanquisherStage() > 0)\n+                                    cm.sendNext(\"You still need #b\" + (100 - cm.getPlayer().getVanquisherKills()) + \"#k in order to obtain the #b#t\" + (1142032 + cm.getPlayer().getVanquisherStage()) + \"##k. Please try a little harder. As a reminder, only the mosnters that have been summoned by our Master in Mu Lung Dojo are considered. Oh, and make sure you're not hunting the monsters and exiting!#r If you don't go to the next level after defeating the monster, it doesn't count as a win#k.\");\n+                                else if (cm.getPlayer().getVanquisherStage() <= 0) {\n+                                    cm.getPlayer().setVanquisherStage(1);\n+                                } else {\n+                                    cm.sendNext(\"You have obtained #b#t\" + (1142032 + cm.getPlayer().getVanquisherStage()) + \"##k.\");\n+                                    cm.gainItem(1142033 + cm.getPlayer().getVanquisherStage(), 1);\n+                                    cm.getPlayer().setVanquisherStage(cm.c.getPlayer().getVanquisherStage() + 1);\n+                                    cm.getPlayer().setVanquisherKills(0);\n+                                }\n+                            }\n+\n+                            cm.dispose();\n+                            return;\n+                        }\n+                        else {\n+                            cm.dispose();\n+                            return;\n+                        }\n+                    } else if (selectedMenu == 5) { //What is a Mu Lung Dojo?\n+                        cm.sendNext(\"Our master is the strongest person in Mu Lung. The place he built is called the Mu Lung Dojo, a building that is #r38 stories#k tall! You can train yourself as you go up each level. Of course, it'll be hard for someone at your level to reach the top.\");\n                         cm.dispose();\n+                        return;\n                     }\n                 } else {\n-\t\t\t\t\tfor (var i = 1 ; i < 39; i++) { //only 32 stages, but 38 maps\n-\t\t\t\t\t\tif(cm.getClient().getChannelServer().getMapFactory().getMap(925020000 + 100 * i).getCharacters().size() > 0) {\n-\t\t\t\t\t\t\tcm.sendOk(\"Someone is already in the Dojo.\" + i);\n-\t\t\t\t\t\t\tcm.dispose();\n-\t\t\t\t\t\t\treturn;\n-\t\t\t\t\t\t}\n-\t\t\t\t\t}\n-                    cm.getClient().getChannelServer().getMapFactory().getMap(925020100).resetReactors();\n-                    cm.getClient().getChannelServer().getMapFactory().getMap(925020100).killAllMonsters();\n-                    cm.warp(925020100, 0);\n-                    cm.dispose();\n-\t\t    return;\n-                }\n-            } else if (selectedMenu == 1) { //I want to challenge him with a party.\n-                var party = cm.getPlayer().getParty();\n-                if (party == null) {\n-                    cm.sendNext(\"Where do you think you're going? You're not even the party leader! Go tell your party leader to talk to me.\");\n                     cm.dispose();\n                     return;\n                 }\n-                var lowest = cm.getPlayer().getLevel();\n-                var highest = lowest;\n-                for (var x = 0; x < party.getMembers().size(); x++) {\n-                    var lvl = party.getMembers().get(x).getLevel();\n-                    if (lvl > highest)\n-                        highest = lvl;\n-                    else if (lvl < lowest)\n-                        lowest = lvl;\n-                }\n-                var isBetween30 = highest - lowest < 30;\n-                if (party.getLeader().getId() != cm.getPlayer().getId()) {\n-                    cm.sendNext(\"Where do you think you're going? You're not even the party leader! Go tell your party leader to talk to me.\");\n-                    cm.dispose();\n-                    return;\n-                }\n-\n-\t\t//else if (party.getMembers().size() == 1) {\n-                //    cm.sendNext(\"You're going to take on the challenge as a one-man party?\");\n-                //}\n-\n-\t\t else if (!isBetween30) {\n-                    cm.sendNext(\"Your partys level ranges are too broad to enter. Please make sure all of your party members are within #r30 levels#k of each other.\");\n-                    cm.dispose();\n-\t\t    return;\n-                } else {\n-                    for (var i = 1 ; i < 39; i++) { //only 32 stages, but 38 maps\n-                            if(cm.getClient().getChannelServer().getMapFactory().getMap(925020000 + 100 * i).getCharacters().size() > 0) {\n-                                    cm.sendOk(\"Someone is already in the Dojo.\");\n-                                    cm.dispose();\n-                                    return;\n+            } else if (isRestingSpot(cm.getPlayer().getMap().getId())) {\n+                if (selectedMenu == -1)\n+                    selectedMenu = selection;\n+                \n+                if (selectedMenu == 0) {\n+                    var hasParty = (cm.getParty() != null);\n+                    \n+                    var firstEnter = false;\n+                    var avDojo = cm.getClient().getChannelServer().lookupPartyDojo(cm.getParty());\n+                    if(avDojo < 0) {\n+                        if(hasParty) {\n+                            if(!cm.isPartyLeader()) {\n+                                cm.sendOk(\"You are not the leader! Call your party leader to talk to me if you wish to continue.\");\n+                                cm.dispose();\n+                                return;\n                             }\n+                            \n+                            if(!isBetween(cm.getParty(), 35)) {\n+                                cm.sendOk(\"Your partys level ranges are too broad to enter. Please make sure all of your party members are within #r35 levels#k of each other.\");\n+                                cm.dispose();\n+                                return;\n+                            }\n+                        }\n+                        \n+                        avDojo = cm.getClient().getChannelServer().getAvailableDojo(hasParty, cm.getParty());\n+                        firstEnter = true;\n                     }\n-                    cm.getClient().getChannelServer().getMapFactory().getMap(925020100).resetReactors();\n-                    cm.getClient().getChannelServer().getMapFactory().getMap(925020100).killAllMonsters();\n-                    cm.warpParty(925020100);\n-                    cm.dispose();\n-\t\t    return;\n-                }\n \n-            } else if (selectedMenu == 2) { //I want to receive a belt.\n-                if (!cm.canHold(belts[0])) {\n-\t\t    cm.sendNext(\"Make room in your EQUIP inventory before trying to claim a belt!\");\n-                    cm.dispose();\n-                    return;\n-\t\t}\n-\t\tif (mode < 1) {\n-                    cm.dispose();\n-                    return;\n-                }\n-                if (status == 0) {\n-                    var selStr = \"You have #b\" + cm.getPlayer().getDojoPoints() + \"#k training points. Master prefers those with great talent. If you obtain more points than the average, you can receive a belt depending on your score.\\r\\n\";\n-                    for (var i = 0; i < belts.length; i++) {\n-                        if (cm.getPlayer().getItemQuantity(belts[i], true) > 0) {\n-                            selStr += \"\\r\\n#L\" + i + \"##i\" + belts[i] + \"# #t\" + belts[i] + \"# (Obtained)\";\n-                        } else\n-                            selStr += \"\\r\\n#L\" + i + \"##i\" + belts[i] + \"# #t\" + belts[i] + \"#\";\n+                    if(avDojo < 0) {\n+                        if(avDojo == -1) cm.sendOk(\"All Dojo's are being used already. Wait for awhile before trying again.\");\n+                        else cm.sendOk(\"Your party already is using the dojo. Wait for them to finish to enter.\");\n+                    }\n+                    else {\n+                        var baseStg = hasParty ? 925030000 : 925020000;\n+                        var nextStg = Math.floor((cm.getPlayer().getMap().getId() + 100) / 100) % 100;\n+\n+                        var dojoWarpMap = baseStg + (nextStg * 100) + avDojo;\n+                        if(firstEnter) {\n+                            cm.getClient().getChannelServer().resetDojoMap(dojoWarpMap);\n+                            cm.getClient().getChannelServer().resetDojo(dojoWarpMap, nextStg - 1);\n+                        }\n+                        \n+                        if(!hasParty || !cm.isLeader()) cm.warp(dojoWarpMap, 0);\n+                        else cm.warpParty(dojoWarpMap, 0);\n                     }\n-                    cm.sendSimple(selStr);\n-                } else if (status == 1) {\n-                    var belt = belts[selection];\n-                    var level = belt_level[selection];\n-                    var points = belt_points[selection];\n-                    if (cm.getPlayer().getDojoPoints() > points) {\n-                        if (cm.getPlayer().getLevel() > level) {\n-                            cm.gainItem(belt, 1);\n-\t\t\t    cm.sendNext(\"There is the #i\" + belt + \"# #b#t\" + belt + \"##k. You have proven your valor to ascend on the Dojo ranks. Well done!\");\n-\t\t\t}\n-                        else\n-                            cm.sendNext(\"In order to receive #i\" + belt + \"# #b#t\" + belt + \"##k, you have to be at least over level #b\" + level + \"#k and you need to have earned at least #b\" + points + \" training points#k.\\r\\n\\r\\nIf you want to obtain this belt, you need #r\" + (points - cm.getPlayer().getDojoPoints()) + \"#k more training points.\");\n-                    } else\n-                        cm.sendNext(\"In order to receive #i\" + belt + \"# #b#t\" + belt + \"##k, you have to be at least over level #b\" + level + \"#k and you need to have earned at least #b\" + points + \" training points#k.\\r\\n\\r\\nIf you want to obtain this belt, you need #r\" + (points - cm.getPlayer().getDojoPoints()) + \"#k more training points.\");\n \n                     cm.dispose();\n                     return;\n-                }\n-            } else if (selectedMenu == 3) { //I want to reset my training points.\n-                if (status == 0) {\n-                    cm.sendYesNo(\"You do know that if you reset your training points, it returns to 0, right? Although, that's not always a bad thing. If you can start earning training points again after you reset, you can receive the belts once more. Do you want to reset your training points now?\");\n-                } else if (status == 1) {\n-                    if (mode == 0) {\n-                        cm.sendNext(\"Do you need to gather yourself or something? Come back after you take a deep breath.\");\n+                } else if (selectedMenu == 1) { //I want to leave\n+                    if (status == 1) {\n+                        cm.sendYesNo(\"So, you're giving up? You're really going to leave?\");\n                     } else {\n-                        cm.getPlayer().setDojoPoints(0);\n-                        cm.sendNext(\"There! All your training points have been reset. Think of it as a new beginning and train hard!\");\n+                        if (mode == 1) {\n+                            cm.warp(925020002);\n+                        }\n+                        cm.dispose();\n+                        return;\n                     }\n-                    cm.dispose();\n-\t\t    return;\n-                }\n-            } else if (selectedMenu == 4) { //I want to receive a medal.\n-                if (status == 0 && cm.getPlayer().getVanquisherStage() <= 0) {\n-                    cm.sendYesNo(\"You haven't attempted the medal yet? If you defeat one type of monster in Mu Lung Dojo #b100 times#k you can receive a title called #b#t\" + (1142033 + cm.getPlayer().getVanquisherStage()) + \"##k. It looks like you haven't even earned the #b#t\" + (1142033 + cm.getPlayer().getVanquisherStage()) + \"##k... Do you want to try out for the #b#t\" + (1142033 + cm.getPlayer().getVanquisherStage()) + \"##k?\");\n-                } else if (status == 1 || cm.getPlayer().getVanquisherStage() > 0) {\n-                    if (mode == 0) {\n-                        cm.sendNext(\"If you don't want to, that's fine.\");\n+                } else if (selectedMenu == 2) { //I want to record my score up to this point\n+                    if (status == 1) {\n+                        cm.sendYesNo(\"If you record your score, you can start where you left off the next time. Isn't that convenient? Do you want to record your current score?\");\n                     } else {\n-                        if (cm.getPlayer().getDojoStage() > 37) {\n-                            cm.sendNext(\"You have completed all medals challenges.\");\n-                        } else if (cm.getPlayer().getVanquisherKills() < 100 && cm.getPlayer().getVanquisherStage() > 0)\n-                            cm.sendNext(\"You still need #b\" + (100 - cm.getPlayer().getVanquisherKills()) + \"#k in order to obtain the #b#t\" + (1142032 + cm.getPlayer().getVanquisherStage()) + \"##k. Please try a little harder. As a reminder, only the mosnters that have been summoned by our Master in Mu Lung Dojo are considered. Oh, and make sure you're not hunting the monsters and exiting!#r If you don't go to the next level after defeating the monster, it doesn't count as a win#k.\");\n-                        else if (cm.getPlayer().getVanquisherStage() <= 0) {\n-                            cm.getPlayer().setVanquisherStage(1);\n+                        if (mode == 0) {\n+                            cm.sendNext(\"You think you can go even higher? Good luck!\");\n+                        } else if (cm.getPlayer().getDojoStage() == Math.floor(cm.getMapId() / 100) % 100) {\n+                            cm.sendOk(\"Looks like you came all the way up here without recording your score. Sorry, but you can't record now.\");\n                         } else {\n-                            cm.sendNext(\"You have obtained #b#t\" + (1142032 + cm.getPlayer().getVanquisherStage()) + \"##k.\");\n-                            cm.gainItem(1142033 + cm.getPlayer().getVanquisherStage(), 1);\n-                            cm.getPlayer().setVanquisherStage(cm.c.getPlayer().getVanquisherStage() + 1);\n-                            cm.getPlayer().setVanquisherKills(0);\n+                            cm.sendNext(\"I recorded your score. If you tell me the next time you go up, you'll be able to start where you left off.\");\n+                            cm.getPlayer().setDojoStage(Math.floor(cm.getMapId() / 100) % 100);\n                         }\n+                        cm.dispose();\n+                        return;\n                     }\n-\n-                    cm.dispose();\n-\t\t    return;\n-                }\n-\t\telse {\n-                    cm.dispose();\n-\t\t    return;\n-\t\t}\n-            } else if (selectedMenu == 5) { //What is a Mu Lung Dojo?\n-                cm.sendNext(\"Our master is the strongest person in Mu Lung. The place he built is called the Mu Lung Dojo, a building that is 38 stories tall! You can train yourself as you go up each level. Of course, it'll be hard for someone at your level to reach the top.\");\n-                cm.dispose();\n-                return;\n-            }\n-        } else {\n-            cm.dispose();\n-\t    return;\n-\t}\n-    } else if (isRestingSpot(cm.getPlayer().getMap().getId())) {\n-        if (selectedMenu == -1)\n-            selectedMenu = selection;\n-        status++;\n-        if (selectedMenu == 0) {\n-            cm.warp(cm.getPlayer().getMap().getId() + 100, 0);\n-            cm.dispose();\n-\t    return;\n-        } else if (selectedMenu == 1) { //I want to leave\n-            if (status == 0) {\n-                cm.sendAcceptDecline(\"So, you're giving up? You're really going to leave?\");\n-            } else {\n-                if (mode == 1) {\n-                    cm.warp(925020002);\n                 }\n-                cm.dispose();\n-                return;\n-            }\n-        } else if (selectedMenu == 2) { //I want to record my score up to this point\n-            if (status == 0) {\n-                cm.sendYesNo(\"If you record your score, you can start where you left off the next time. Isn't that convenient? Do you want to record your current score?\");\n             } else {\n                 if (mode == 0) {\n-                    cm.sendNext(\"You think you can go even higher? Good luck!\");\n-                } else if (925020000 + cm.getPlayer().getDojoStage() * 100 == cm.getMapId()) {\n-                    cm.sendOk(\"Looks like you came all the way up here without recording your score. Sorry, but you can't record now.\");\n-                } else {\n-                    cm.sendNext(\"I recorded your score. If you tell me the next time you go up, you'll be able to start where you left off.\");\n-                    cm.getPlayer().setDojoStage((cm.getMapId() - 925020000) / 100);\n+                    cm.sendNext(\"Stop changing your mind! Soon, you'll be crying, begging me to go back.\");\n+                } else if (mode == 1) {\n+                    cm.warp(925020002, 0);\n+                    cm.getPlayer().message(\"Can you make up your mind please?\");\n                 }\n                 cm.dispose();\n-                return;\n             }\n         }\n-    } else {\n-        if (mode == 0) {\n-            cm.sendNext(\"Stop changing your mind! Soon, you'll be crying, begging me to go back.\");\n-        } else if (mode == 1) {\n-            cm.warp(925020002, 0);\n-            cm.getPlayer().message(\"Can you make up your mind please?\");\n-        }\n-        cm.dispose();\n     }\n }\n \n function isRestingSpot(id) {\n-    return (id / 100 - 9250200) % 6 == 0;\n+    return (Math.floor(id / 100) % 100) % 6 == 0 && id != 925020001;\n+}\n+\n+function isBetween(party, range) {\n+    var lowest = cm.getPlayer().getLevel();\n+    var highest = lowest;\n+    for (var x = 0; x < party.getMembers().size(); x++) {\n+        var lvl = party.getMembers().get(x).getLevel();\n+        if (lvl > highest)\n+            highest = lvl;\n+        else if (lvl < lowest)\n+            lowest = lvl;\n+    }\n+    return (highest - lowest) <= range;\n }"}, {"sha": "86f90bbffb02b2bb073ba7b9ba6de957f02d5571", "filename": "scripts/npc/2096000.js", "status": "added", "additions": 52, "deletions": 0, "changes": 52, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/2096000.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/2096000.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/2096000.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -0,0 +1,52 @@\n+/*\n+\tThis file is part of the OdinMS Maple Story Server\n+    Copyright (C) 2008 Patrick Huy <patrick.huy@frz.cc>\n+\t\t       Matthias Butz <matze@odinms.de>\n+\t\t       Jan Christian Meyer <vimes@odinms.de>\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+/* Practice Chart\n+\tPractice Field : Beginner (250020000)\n+\tNothing at all.\n+ */\n+\n+var status;\n+ \n+function start() {\n+        status = -1;\n+        action(1, 0, 0);\n+}\n+\n+function action(mode, type, selection) {\n+        if (mode == -1) {\n+                cm.dispose();\n+        } else {\n+                if (mode == 0 && status == 0) {\n+                        cm.dispose();\n+                        return;\n+                }\n+                if (mode == 1)\n+                        status++;\n+                else\n+                        status--;\n+    \n+                if(status == 0) {\n+                        cm.sendOk(\"Amateurs train on this map. Adepts train on the next. Professionals train on the last, where the boss will be awaiting.\");\n+                        cm.dispose();\n+                }\n+        }\n+}"}, {"sha": "210faf5fa7a5e62e9566a4808897e5fffd1938fb", "filename": "scripts/npc/2141001.js", "status": "modified", "additions": 170, "deletions": 206, "changes": 376, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/2141001.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/2141001.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/2141001.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -1,216 +1,180 @@\n /*\n-\tNPC Name: \t\tThe Forgotten Temple Manager\n-\tMap(s): \t\tDeep in the Shrine - Forgotten Twilight\n-\tDescription: \t\tPink Bean battle starter\n-*/\n-var status = -1;\n+\tThis file is part of the OdinMS Maple Story Server\n+    Copyright (C) 2008 Patrick Huy <patrick.huy@frz.cc> \n+                       Matthias Butz <matze@odinms.de>\n+                       Jan Christian Meyer <vimes@odinms.de>\n \n-function start() {\n-    if (cm.getPlayer().getLevel() < 120) {\n-            cm.sendOk(\"There is a level requirement of 120 to attempt Pink Bean.\");\n-            cm.dispose();\n-            return;\n-    }\n-    if (cm.getPlayer().getClient().getChannel() != 5) {\n-            cm.sendOk(\"Pink Bean may only be attempted on channel 5.\");\n-            cm.dispose();\n-            return;\n-    }\n-    var em = cm.getEventManager(\"PinkBeanBattle\");\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License version 3\n+    as published by the Free Software Foundation. You may not use, modify\n+    or distribute this program under any other version of the\n+    GNU Affero General Public License.\n \n-    if (em == null) {\n-\tcm.sendOk(\"The event isn't started, please contact a GM.\");\n-\tcm.dispose();\n-\treturn;\n-    }\n-    var eim_status = em.getProperty(\"state\");\n-\t    var marr = cm.getQuestRecord(160104);\n-\t    var data = marr.getCustomData();\n-\t    if (data == null) {\n-\t\tmarr.setCustomData(\"0\");\n-\t        data = \"0\";\n-\t    }\n-\t    var time = parseInt(data);\n-\tif (eim_status == null || eim_status.equals(\"0\")) {\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+/* The Forgotten Temple Manager\n+ * \n+ * Deep Place of Temple - Forgotten Twilight (270050000)\n+ * Vs Pink Bean Recruiter NPC\n+ * \n+ * @author Ronan\n+ */\n+importPackage(Packages.server.expeditions);\n+importPackage(Packages.tools);\n+importPackage(Packages.scripting.event);\n \n-    var squadAvailability = cm.getSquadAvailability(\"PinkBean\");\n-    if (squadAvailability == -1) {\n-\tstatus = 0;\n-\t    if (time + (12 * 3600000) >= cm.getCurrentTime() && !cm.getPlayer().isGM()) {\n-\t\tcm.sendOk(\"You have already went to PinkBean in the past 12 hours. Time left: \" + cm.getReadableMillis(cm.getCurrentTime(), time + (12 * 3600000)));\n-\t\tcm.dispose();\n-\t\treturn;\n-\t    }\n-\tcm.sendYesNo(\"Are you interested in becoming the leader of the expedition Squad?\");\n+var status = 0;\n+var expedition;\n+var player;\n+var em;\n+var exped = MapleExpeditionType.PINKBEAN;\n+var expedName = \"Twilight of the Gods\";\n+var expedBoss = \"Pink Bean\";\n+var expedMap = \"Twilight of Gods\";\n \n-    } else if (squadAvailability == 1) {\n-\t    if (time + (12 * 3600000) >= cm.getCurrentTime() && !cm.getPlayer().isGM()) {\n-\t\tcm.sendOk(\"You have already went to PinkBean in the past 12 hours. Time left: \" + cm.getReadableMillis(cm.getCurrentTime(), time + (12 * 3600000)));\n-\t\tcm.dispose();\n-\t\treturn;\n-\t    }\n-\t// -1 = Cancelled, 0 = not, 1 = true\n-\tvar type = cm.isSquadLeader(\"PinkBean\");\n-\tif (type == -1) {\n-\t    cm.sendOk(\"The squad has ended, please re-register.\");\n-\t    cm.dispose();\n-\t} else if (type == 0) {\n-\t    var memberType = cm.isSquadMember(\"PinkBean\");\n-\t    if (memberType == 2) {\n-\t\tcm.sendOk(\"You been banned from the squad.\");\n-\t\tcm.dispose();\n-\t    } else if (memberType == 1) {\n-\t\tstatus = 5;\n-\t\tcm.sendSimple(\"What would you like to do? \\r\\n#b#L0#Join the squad to Twilight of the Gods#l \\r\\n#b#L1#Leave the squad to Twilight of the Gods#l \\r\\n#b#L2#See the list of members on the squad#l\");\n-\t    } else if (memberType == -1) {\n-\t\tcm.sendOk(\"The squad has ended, please re-register.\");\n-\t\tcm.dispose();\n-\t    } else {\n-\t\tstatus = 5;\n-\t\tcm.sendSimple(\"What would you like to do? \\r\\n#b#L0#Join the squad to Twilight of the Gods#l \\r\\n#b#L1#Leave the squad to Twilight of the Gods#l \\r\\n#b#L2#See the list of members on the squad#l\");\n-\t    }\n-\t} else { // Is leader\n-\t    status = 10;\n-\t    cm.sendSimple(\"What do you want to do, expedition leader? \\r\\n#b#L0#View expedition list#l \\r\\n#b#L1#Kick from expedition#l \\r\\n#b#L2#Remove user from ban list#l \\r\\n#r#L3#Select expedition team and enter#l\");\n-\t// TODO viewing!\n-\t}\n-\t    } else {\n-\t\t\tvar eim = cm.getDisconnected(\"PinkBeanBattle\");\n-\t\t\tif (eim == null) {\n-\t\t\t\tvar squd = cm.getSquad(\"PinkBean\");\n-\t\t\t\tif (squd != null) {\n-\t    if (time + (12 * 3600000) >= cm.getCurrentTime() && !cm.getPlayer().isGM()) {\n-\t\tcm.sendOk(\"You have already went to PinkBean in the past 12 hours. Time left: \" + cm.getReadableMillis(cm.getCurrentTime(), time + (12 * 3600000)));\n-\t\tcm.dispose();\n-\t\treturn;\n-\t    }\n-\t\t\t\t\tcm.sendYesNo(\"The squad's battle against the boss has already begun.\\r\\n\" + squd.getNextPlayer());\n-\t\t\t\t\tstatus = 3;\n-\t\t\t\t} else {\n-\t\t\t\t\tcm.sendOk(\"The squad's battle against the boss has already begun.\");\n-\t\t\t\t\tcm.safeDispose();\n-\t\t\t\t}\n-\t\t\t} else {\n-\t\t\t\tcm.sendYesNo(\"Ah, you have returned. Would you like to join your squad in the fight again?\");\n-\t\t\t\tstatus = 2;\n-\t\t\t}\n-\t    }\n-\t} else {\n-\t\t\tvar eim = cm.getDisconnected(\"PinkBeanBattle\");\n-\t\t\tif (eim == null) {\n-\t\t\t\tvar squd = cm.getSquad(\"PinkBean\");\n-\t\t\t\tif (squd != null) {\n-\t    if (time + (12 * 3600000) >= cm.getCurrentTime() && !cm.getPlayer().isGM()) {\n-\t\tcm.sendOk(\"You have already went to PinkBean in the past 12 hours. Time left: \" + cm.getReadableMillis(cm.getCurrentTime(), time + (12 * 3600000)));\n-\t\tcm.dispose();\n-\t\treturn;\n-\t    }\n-\t\t\t\t\tcm.sendYesNo(\"The squad's battle against the boss has already begun.\\r\\n\" + squd.getNextPlayer());\n-\t\t\t\t\tstatus = 3;\n-\t\t\t\t} else {\n-\t\t\t\t\tcm.sendOk(\"The squad's battle against the boss has already begun.\");\n-\t\t\t\t\tcm.safeDispose();\n-\t\t\t\t}\n-\t\t\t} else {\n-\t\t\t\tcm.sendYesNo(\"Ah, you have returned. Would you like to join your squad in the fight again?\");\n-\t\t\t\tstatus = 2;\n-\t\t\t}\n-\t}\n+var list = \"What would you like to do?#b\\r\\n\\r\\n#L1#View current Expedition members#l\\r\\n#L2#Start the fight!#l\\r\\n#L3#Stop the expedition.#l\";\n+\n+function start() {\n+    action(1, 0, 0);\n }\n \n function action(mode, type, selection) {\n-    switch (status) {\n-\tcase 0:\n-\t    if (mode == 1) {\n-\t\t\tif (cm.registerSquad(\"PinkBean\", 5, \" has been named the Leader of the squad. If you would you like to join please register for the Expedition Squad within the time period.\")) {\n-\t\t\t\tcm.sendOk(\"You have been named the Leader of the Squad. For the next 5 minutes, you can add the members of the Expedition Squad.\");\n-\t\t\t} else {\n-\t\t\t\tcm.sendOk(\"An error has occurred adding your squad.\");\n-\t\t\t}\n-\t    }\n-\t    cm.dispose();\n-\t    break;\n-\tcase 2:\n-\t\tif (!cm.reAdd(\"PinkBeanBattle\", \"PinkBean\")) {\n-\t\t\tcm.sendOk(\"Error... please try again.\");\n-\t\t}\n-\t\tcm.safeDispose();\n-\t\tbreak;\n-\tcase 3:\n-\t\tif (mode == 1) {\n-\t\t\tvar squd = cm.getSquad(\"PinkBean\");\n-\t\t\tif (squd != null && !squd.getAllNextPlayer().contains(cm.getPlayer().getName())) {\n-\t\t\t\tsqud.setNextPlayer(cm.getPlayer().getName());\n-\t\t\t\tcm.sendOk(\"You have reserved the spot.\");\n-\t\t\t}\n-\t\t}\n-\t\tcm.dispose();\n-\t\tbreak;\n-\tcase 5:\n-\t    if (selection == 0) { // join\n-\t\tvar ba = cm.addMember(\"PinkBean\", true);\n-\t\tif (ba == 2) {\n-\t\t    cm.sendOk(\"The squad is currently full, please try again later.\");\n-\t\t} else if (ba == 1) {\n-\t\t    cm.sendOk(\"You have joined the squad successfully\");\n-\t\t} else {\n-\t\t    cm.sendOk(\"You are already part of the squad.\");\n-\t\t}\n-\t    } else if (selection == 1) {// withdraw\n-\t\tvar baa = cm.addMember(\"PinkBean\", false);\n-\t\tif (baa == 1) {\n-\t\t    cm.sendOk(\"You have withdrawed from the squad successfully\");\n-\t\t} else {\n-\t\t    cm.sendOk(\"You are not part of the squad.\");\n-\t\t}\n-\t    } else if (selection == 2) {\n-\t\tif (!cm.getSquadList(\"PinkBean\", 0)) {\n-\t\t    cm.sendOk(\"Due to an unknown error, the request for squad has been denied.\");\n-\t\t}\n-\t    }\n-\t    cm.dispose();\n-\t    break;\n-\tcase 10:\n-\t    if (mode == 1) {\n-\t\tif (selection == 0) {\n-\t\t    if (!cm.getSquadList(\"PinkBean\", 0)) {\n-\t\t\tcm.sendOk(\"Due to an unknown error, the request for squad has been denied.\");\n-\t\t    }\n-\t\t    cm.dispose();\n-\t\t} else if (selection == 1) {\n-\t\t    status = 11;\n-\t\t    if (!cm.getSquadList(\"PinkBean\", 1)) {\n-\t\t\tcm.sendOk(\"Due to an unknown error, the request for squad has been denied.\");\n-\t\t\tcm.dispose();\n-\t\t    }\n-\t\t} else if (selection == 2) {\n-\t\t    status = 12;\n-\t\t    if (!cm.getSquadList(\"PinkBean\", 2)) {\n-\t\t\tcm.sendOk(\"Due to an unknown error, the request for squad has been denied.\");\n-\t\t\tcm.dispose();\n-\t\t    }\n-\t\t} else if (selection == 3) { // get inside\n-\t\t    if (cm.getSquad(\"PinkBean\") != null) {\n-\t\t\tvar dd = cm.getEventManager(\"PinkBeanBattle\");\n-\t\t\tdd.startInstance(cm.getSquad(\"PinkBean\"), cm.getMap(), 160104);\n-\t\t    } else {\n-\t\t\tcm.sendOk(\"Due to an unknown error, the request for squad has been denied.\");\n-\t\t    }\n-\t\t    cm.dispose();\n-\t\t}\n-\t    } else {\n-\t\tcm.dispose();\n-\t    }\n-\t    break;\n-\tcase 11:\n-\t    cm.banMember(\"PinkBean\", selection);\n-\t    cm.dispose();\n-\t    break;\n-\tcase 12:\n-\t    if (selection != -1) {\n-\t\tcm.acceptMember(\"PinkBean\", selection);\n-\t    }\n-\t    cm.dispose();\n-\t    break;\n+\n+    player = cm.getPlayer();\n+    expedition = cm.getExpedition(exped);\n+    em = cm.getEventManager(\"PinkBeanBattle\");\n+\n+    if (mode == -1) {\n+        cm.dispose();\n+    } else {\n+        if (mode == 0) {\n+            cm.dispose();\n+            return;\n+        }\n+\n+        if (status == 0) {\n+            if (player.getLevel() < exped.getMinLevel() && player.getLevel() > exped.getMaxLevel()) { //Don't fit requirement\n+                cm.sendOk(\"You do not meet the criteria to battle \" + expedBoss + \"!\");\n+                cm.dispose();\n+            } else if (expedition == null) { //Start an expedition\n+                cm.sendSimple(\"#e#b<Expedition: \" + expedName + \">\\r\\n#k#n\" + em.getProperty(\"party\") + \"\\r\\n\\r\\nWould you like to assemble a team to take on #r\" + expedBoss + \"#k?\\r\\n#b#L1#Lets get this going!#l\\r\\n\\#L2#No, I think I'll wait a bit...#l\");\n+                status = 1;\n+            } else if (expedition.isLeader(player)) { //If you're the leader, manage the exped\n+                cm.sendSimple(list);\n+                status = 2;\n+            } else if (expedition.isRegistering()) { //If the expedition is registering\n+                if (expedition.contains(player)) { //If you're in it but it hasn't started, be patient\n+                    cm.sendOk(\"You have already registered for the expedition. Please wait for #r\" + expedition.getLeader().getName() + \"#k to begin the expedition.\");\n+                    cm.dispose();\n+                } else { //If you aren't in it, you're going to get added\n+                    cm.sendOk(expedition.addMember(cm.getPlayer()));\n+                    cm.dispose();\n+                }\n+            } else if (expedition.isInProgress()) { //Only if the expedition is in progress\n+                if (expedition.contains(player)) { //If you're registered, warp you in\n+                    var eim = em.getInstance(expedName + player.getClient().getChannel());\n+                    if(eim.getIntProperty(\"canJoin\") == 1) {\n+                        eim.registerPlayer(player);\n+                    } else {\n+                        cm.sendOk(\"Your expedition already started the battle against \" + expedBoss + \". Lets pray for those brave souls.\");\n+                    }\n+                    \n+                    cm.dispose();\n+                } else { //If you're not in by now, tough luck\n+                    cm.sendOk(\"Another expedition has taken the initiative to challenge \" + expedBoss + \", lets pray for those brave souls.\");\n+                    cm.dispose();\n+                }\n+            }\n+        } else if (status == 1) {\n+            if (selection == 1) {\n+                expedition = cm.getExpedition(exped);\n+                if(expedition != null) {\n+                    cm.sendOk(\"Someone already taken the initiative to be the leader of the expedition. Try joining them!\");\n+                    cm.dispose();\n+                    return;\n+                }\n+                \n+                cm.createExpedition(exped);\n+                cm.sendOk(\"The #r\" + expedBoss + \" Expedition#k has been created.\\r\\n\\r\\nTalk to me again to view the current team, or start the fight!\");\n+                cm.dispose();\n+                return;\n+            } else if (selection == 2) {\n+                cm.sendOk(\"Sure, not everyone's up to challenging \" + expedBoss + \".\");\n+                cm.dispose();\n+                return;\n+            }\n+        } else if (status == 2) {\n+            if (selection == 1) {\n+                if (expedition == null) {\n+                    cm.sendOk(\"The expedition could not be loaded.\");\n+                    cm.dispose();\n+                    return;\n+                }\n+                var size = expedition.getMembers().size();\n+                if (size == 1) {\n+                    cm.sendOk(\"You are the only member of the expedition.\");\n+                    cm.dispose();\n+                    return;\n+                }\n+                var text = \"The following members make up your expedition (Click on them to expel them):\\r\\n\";\n+                text += \"\\r\\n\\t\\t1.\" + expedition.getLeader().getName();\n+                for (var i = 1; i < size; i++) {\n+                    text += \"\\r\\n#b#L\" + (i + 1) + \"#\" + (i + 1) + \". \" + expedition.getMembers().get(i).getName() + \"#l\\n\";\n+                }\n+                cm.sendSimple(text);\n+                status = 6;\n+            } else if (selection == 2) {\n+                var min = exped.getMinSize();\n+                \n+                var size = expedition.getMembers().size();\n+                if (size < min) {\n+                    cm.sendOk(\"You need at least \" + min + \" players registered in your expedition.\");\n+                    cm.dispose();\n+                    return;\n+                }\n+                \n+                cm.sendOk(\"The expedition will begin and you will now be escorted to the #b\" + expedMap + \"#k.\");\n+                status = 4;\n+            } else if (selection == 3) {\n+                player.getMap().broadcastMessage(MaplePacketCreator.serverNotice(6, expedition.getLeader().getName() + \" has ended the expedition.\"));\n+                cm.endExpedition(expedition);\n+                cm.sendOk(\"The expedition has now ended. Sometimes the best strategy is to run away.\");\n+                cm.dispose();\n+                return;\n+            }\n+        } else if (status == 4) {\n+            if (em == null) {\n+                cm.sendOk(\"The event could not be initialized, please report this on the forum.\");\n+                cm.dispose();\n+                return;\n+            }\n+\n+            em.setProperty(\"leader\", player.getName());\n+            em.setProperty(\"channel\", player.getClient().getChannel());\n+            if(!em.startInstance(expedition)) {\n+                cm.sendOk(\"Another expedition has taken the initiative to challenge \" + expedBoss + \", lets pray for those brave souls.\");\n+                cm.dispose();\n+                return;\n+            }\n+            \n+            cm.dispose();\n+            return;\n+        } else if (status == 6) {\n+            if (selection > 0) {\n+                var banned = expedition.getMembers().get(selection - 1);\n+                expedition.ban(banned);\n+                cm.sendOk(\"You have banned \" + banned.getName() + \" from the expedition.\");\n+                cm.dispose();\n+            } else {\n+                cm.sendSimple(list);\n+                status = 2;\n+            }\n+        }\n     }\n }\n\\ No newline at end of file"}, {"sha": "6bb9fcc3d6748a4c7f81fde5c951bb8e97230108", "filename": "scripts/npc/2141002.js", "status": "modified", "additions": 41, "deletions": 4, "changes": 45, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/2141002.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/2141002.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/2141002.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -4,13 +4,50 @@\n \tDescription: \t\tPink Bean\n  */\n \n+var status;\n+\n function start() {\n-    cm.sendYesNo(\"Do you want to get out now?\");\n+    status = -1;\n+    action(1, 0, 0);\n }\n \n function action(mode, type, selection) {\n-    if (mode == 1) {\n-\tcm.warp(270050000, 0);\n+    if (mode == -1)\n+        cm.dispose();\n+    else {\n+        if (mode == 0) {\n+            cm.dispose();\n+            return;\n+        }\n+        if (mode == 1)\n+            status++;\n+        else\n+            status--;\n+        \n+        var eim = cm.getEventInstance();\n+        if(!eim.isEventCleared()) {\n+            if (status == 0) {\n+                cm.sendYesNo(\"Do you want to get out now?\");\n+            }\n+            else if (status == 1) {\n+                cm.warp(270050000, 0);\n+                cm.dispose();\n+            }\n+        \n+        } else {\n+            if (status == 0) {\n+                cm.sendYesNo(\"Pink Bean has been defeated! You guys sure are true heroes of this land! In no time, Temple of Time will shine again as bright as ever, all thanks to your efforts! Hooray to our heroes!! Are you ready to go now?\");\n+            }\n+            else if (status == 1) {\n+                if(eim.giveEventReward(cm.getPlayer(), 1)) {\n+                    cm.warp(270050000);\n+                }\n+                else {\n+                    cm.sendOk(\"You cannot receive an event prize without having an empty room in your EQUIP, USE, SET-UP or ETC inventory.\");\n+                }\n+                \n+                cm.dispose();\n+            }\n+        }\n     }\n-    cm.dispose();\n }\n\\ No newline at end of file"}, {"sha": "b0e26cb84c849ab37420adc64947a1c39f27f4bb", "filename": "scripts/npc/9000037.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/9000037.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/9000037.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/9000037.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -126,7 +126,7 @@ function action(mode, type, selection) {\n                                         if (cm.getParty() == null) {\n                                                 cm.sendOk(\"You can participate in the party quest only if you are in a party.\");\n                                                 cm.dispose();\n-                                        } else if(!cm.isEventLeader()) {\n+                                        } else if(!cm.isLeader()) {\n                                                 cm.sendOk(\"Your party leader must talk to me to start this party quest.\");\n                                                 cm.dispose();\n                                         } else {"}, {"sha": "ea4f8fdb8bb9d87c85a6dada75cfba487bcaae0e", "filename": "scripts/npc/9010022.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/9010022.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/9010022.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/9010022.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -59,7 +59,7 @@ function action(mode, type, selection) {\n                     cm.warp(980010000, 3); \n                     break; \n                 case 1: \n-                    cm.warp(925020000); \n+                    cm.warp(925020000, 0); \n                     break; \n                 case 2: \n                     cm.warp(980000000, 3); "}, {"sha": "b60eee316ef08cb0edda24017935bea1e488eed2", "filename": "scripts/npc/9020000.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/9020000.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/9020000.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/9020000.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -51,7 +51,7 @@ function action(mode, type, selection) {\n                                         if (cm.getParty() == null) {\n                                                 cm.sendOk(\"You can participate in the party quest only if you are in a party.\");\n                                                 cm.dispose();\n-                                        } else if(!cm.isEventLeader()) {\n+                                        } else if(!cm.isLeader()) {\n                                                 cm.sendOk(\"Your party leader must talk to me to start this party quest.\");\n                                                 cm.dispose();\n                                         } else {"}, {"sha": "55f90f51b61af84ea691267e3c77b4751c6a770f", "filename": "scripts/npc/9110002.js", "status": "added", "additions": 63, "deletions": 0, "changes": 63, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/9110002.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/9110002.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/9110002.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -0,0 +1,63 @@\n+/*\n+\tThis file is part of the OdinMS Maple Story Server\n+    Copyright (C) 2008 Patrick Huy <patrick.huy@frz.cc> \n+\t\t\t\t\t   Matthias Butz <matze@odinms.de>\n+\t\t\t\t\t   Jan Christian Meyer <vimes@odinms.de>\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/**\n+-- Odin JavaScript --------------------------------------------------------------------------------\n+\tKino Konoko - Zipangu - Mushroom Shrine(800000000)\n+-- By ---------------------------------------------------------------------------------------------\n+\tRonan\n+-- Version Info -----------------------------------------------------------------------------------\n+\t1.0 - First Version by Ronan        \n+---------------------------------------------------------------------------------------------------\n+**/\n+\n+var status;\n+\n+function start() {\n+        status = -1;\n+        action(1, 0, 0);\n+}\n+\n+function action(mode, type, selection) {\n+        if (mode == -1) {\n+                cm.dispose();\n+        } else {\n+                if (mode == 0 && status == 0) {\n+                        cm.dispose();\n+                        return;\n+                }\n+                if (mode == 1)\n+                        status++;\n+                else\n+                        status--;\n+    \n+                if(status == 0) {\n+                        if(cm.isQuestCompleted(8074)) {\n+                                cm.openNpc(9110002);\n+                        } else {\n+                                cm.sendOk(\"Musssshhhhroooom Shrine~~~\");\n+                        }\n+                        \n+                        cm.dispose();\n+                }\n+        }\n+}"}, {"sha": "09e41bf0dbb5b701e117ee45ee4dfa9cbc46e674", "filename": "scripts/npc/9120201.js", "status": "modified", "additions": 169, "deletions": 16, "changes": 185, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/9120201.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/9120201.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/9120201.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -1,15 +1,14 @@\n /*\n \tThis file is part of the OdinMS Maple Story Server\n-    Copyright (C) 2008 Patrick Huy <patrick.huy@frz.cc>\n-\t\t       Matthias Butz <matze@odinms.de>\n-\t\t       Jan Christian Meyer <vimes@odinms.de>\n+    Copyright (C) 2008 Patrick Huy <patrick.huy@frz.cc> \n+                       Matthias Butz <matze@odinms.de>\n+                       Jan Christian Meyer <vimes@odinms.de>\n \n     This program is free software: you can redistribute it and/or modify\n-    it under the terms of the GNU Affero General Public License as\n-    published by the Free Software Foundation version 3 as published by\n-    the Free Software Foundation. You may not use, modify or distribute\n-    this program under any other version of the GNU Affero General Public\n-    License.\n+    it under the terms of the GNU Affero General Public License version 3\n+    as published by the Free Software Foundation. You may not use, modify\n+    or distribute this program under any other version of the\n+    GNU Affero General Public License.\n \n     This program is distributed in the hope that it will be useful,\n     but WITHOUT ANY WARRANTY; without even the implied warranty of\n@@ -19,13 +18,167 @@\n     You should have received a copy of the GNU Affero General Public License\n     along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n-/* Konpei (9120201)\n-* Bain Armory Version\n-*/\n+/*Konpei\n+ *\n+ *@author Ronan\n+ */\n+importPackage(Packages.server.expeditions);\n+importPackage(Packages.tools);\n+importPackage(Packages.scripting.event);\n+\n+var status = 0;\n+var expedition;\n+var player;\n+var em;\n+var exped = MapleExpeditionType.SHOWA;\n+var expedName = \"Showa Gang\";\n+var expedBoss = \"The Boss\";\n+var expedMap = \"Nightmarish Last Days\";\n+var expedItem = 4000138;\n+\n+var list = \"What would you like to do?#b\\r\\n\\r\\n#L1#View current Expedition members#l\\r\\n#L2#Start the fight!#l\\r\\n#L3#Stop the expedition.#l\";\n \n function start() {\n-    if (cm.getPlayerCount(801040100) == 0)\n-        cm.resetMap(801040100);\n-    cm.warp(801040100);\n-    cm.dispose();\n-} \n+    action(1, 0, 0);\n+}\n+\n+function action(mode, type, selection) {\n+\n+    player = cm.getPlayer();\n+    expedition = cm.getExpedition(exped);\n+    em = cm.getEventManager(\"ShowaBattle\");\n+\n+    if (mode == -1) {\n+        cm.dispose();\n+    } else {\n+        if (mode == 0) {\n+            cm.dispose();\n+            return;\n+        }\n+\n+        if (status == 0) {\n+            if (player.getLevel() < exped.getMinLevel() && player.getLevel() > exped.getMaxLevel()) { //Don't fit requirement\n+                cm.sendOk(\"You do not meet the criteria to battle \" + expedBoss + \"!\");\n+                cm.dispose();\n+            } else if (expedition == null) { //Start an expedition\n+                cm.sendSimple(\"#e#b<Expedition: \" + expedName + \">\\r\\n#k#n\" + em.getProperty(\"party\") + \"\\r\\n\\r\\nWould you like to assemble a team to take on #r\" + expedBoss + \"#k?\\r\\n#b#L1#Lets get this going!#l\\r\\n\\#L2#No, I think I'll wait a bit...#l\");\n+                status = 1;\n+            } else if (expedition.isLeader(player)) { //If you're the leader, manage the exped\n+                cm.sendSimple(list);\n+                status = 2;\n+            } else if (expedition.isRegistering()) { //If the expedition is registering\n+                if (expedition.contains(player)) { //If you're in it but it hasn't started, be patient\n+                    cm.sendOk(\"You have already registered for the expedition. Please wait for #r\" + expedition.getLeader().getName() + \"#k to begin the expedition.\");\n+                    cm.dispose();\n+                } else { //If you aren't in it, you're going to get added\n+                    cm.sendOk(expedition.addMember(cm.getPlayer()));\n+                    cm.dispose();\n+                }\n+            } else if (expedition.isInProgress()) { //Only if the expedition is in progress\n+                if (expedition.contains(player)) { //If you're registered, warp you in\n+                    var eim = em.getInstance(expedName + player.getClient().getChannel());\n+                    if(eim.getIntProperty(\"canJoin\") == 1) {\n+                        eim.registerPlayer(player);\n+                    } else {\n+                        cm.sendOk(\"Your expedition already started the battle against \" + expedBoss + \". Lets pray for those brave souls.\");\n+                    }\n+                    \n+                    cm.dispose();\n+                } else { //If you're not in by now, tough luck\n+                    cm.sendOk(\"Another expedition has taken the initiative to challenge \" + expedBoss + \", lets pray for those brave souls.\");\n+                    cm.dispose();\n+                }\n+            }\n+        } else if (status == 1) {\n+            if (selection == 1) {\n+                if (!cm.haveItem(expedItem)) {\n+                    cm.sendOk(\"As the expedition leader, you must have on your inventory a #b#t\" + expedItem + \"##k to battle \" + expedBoss + \"!\");\n+                    cm.dispose();\n+                    return;\n+                }\n+                \n+                expedition = cm.getExpedition(exped);\n+                if(expedition != null) {\n+                    cm.sendOk(\"Someone already taken the initiative to be the leader of the expedition. Try joining them!\");\n+                    cm.dispose();\n+                    return;\n+                }\n+                \n+                cm.createExpedition(exped);\n+                cm.sendOk(\"The #r\" + expedBoss + \" Expedition#k has been created.\\r\\n\\r\\nTalk to me again to view the current team, or start the fight!\");\n+                cm.dispose();\n+                return;\n+            } else if (selection == 2) {\n+                cm.sendOk(\"Sure, not everyone's up to challenging \" + expedBoss + \".\");\n+                cm.dispose();\n+                return;\n+            }\n+        } else if (status == 2) {\n+            if (selection == 1) {\n+                if (expedition == null) {\n+                    cm.sendOk(\"The expedition could not be loaded.\");\n+                    cm.dispose();\n+                    return;\n+                }\n+                var size = expedition.getMembers().size();\n+                if (size == 1) {\n+                    cm.sendOk(\"You are the only member of the expedition.\");\n+                    cm.dispose();\n+                    return;\n+                }\n+                var text = \"The following members make up your expedition (Click on them to expel them):\\r\\n\";\n+                text += \"\\r\\n\\t\\t1.\" + expedition.getLeader().getName();\n+                for (var i = 1; i < size; i++) {\n+                    text += \"\\r\\n#b#L\" + (i + 1) + \"#\" + (i + 1) + \". \" + expedition.getMembers().get(i).getName() + \"#l\\n\";\n+                }\n+                cm.sendSimple(text);\n+                status = 6;\n+            } else if (selection == 2) {\n+                var min = exped.getMinSize();\n+                \n+                var size = expedition.getMembers().size();\n+                if (size < min) {\n+                    cm.sendOk(\"You need at least \" + min + \" players registered in your expedition.\");\n+                    cm.dispose();\n+                    return;\n+                }\n+                \n+                cm.sendOk(\"The expedition will begin and you will now be escorted to the #b\" + expedMap + \"#k.\");\n+                status = 4;\n+            } else if (selection == 3) {\n+                player.getMap().broadcastMessage(MaplePacketCreator.serverNotice(6, expedition.getLeader().getName() + \" has ended the expedition.\"));\n+                cm.endExpedition(expedition);\n+                cm.sendOk(\"The expedition has now ended. Sometimes the best strategy is to run away.\");\n+                cm.dispose();\n+                return;\n+            }\n+        } else if (status == 4) {\n+            if (em == null) {\n+                cm.sendOk(\"The event could not be initialized, please report this on the forum.\");\n+                cm.dispose();\n+                return;\n+            }\n+\n+            em.setProperty(\"leader\", player.getName());\n+            em.setProperty(\"channel\", player.getClient().getChannel());\n+            if(!em.startInstance(expedition)) {\n+                cm.sendOk(\"Another expedition has taken the initiative to challenge \" + expedBoss + \", lets pray for those brave souls.\");\n+                cm.dispose();\n+                return;\n+            }\n+            \n+            cm.dispose();\n+            return;\n+        } else if (status == 6) {\n+            if (selection > 0) {\n+                var banned = expedition.getMembers().get(selection - 1);\n+                expedition.ban(banned);\n+                cm.sendOk(\"You have banned \" + banned.getName() + \" from the expedition.\");\n+                cm.dispose();\n+            } else {\n+                cm.sendSimple(list);\n+                status = 2;\n+            }\n+        }\n+    }\n+}"}, {"sha": "0135fc719728b09ea2aa839dabb41bf67fafeb11", "filename": "scripts/npc/9120202.js", "status": "modified", "additions": 49, "deletions": 2, "changes": 51, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/9120202.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/9120202.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/9120202.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -19,7 +19,54 @@\n     You should have received a copy of the GNU Affero General Public License\n     along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n+/* Konpei\n+ * \n+ * @Author Ronan\n+ */\n+ \n+var status;\n+ \n function start() {\n-    cm.warp(801040004, 0);\n-    cm.dispose();\n+    status = -1;\n+    action(1, 0, 0);\n+}\n+\n+function action(mode, type, selection) {\n+        if (mode == -1) {\n+                cm.dispose();\n+        } else {\n+                if (mode == 0 && status == 0) {\n+                        cm.dispose();\n+                        return;\n+                }\n+                if (mode == 1)\n+                        status++;\n+                else\n+                        status--;\n+    \n+                var eim = cm.getEventInstance();\n+                if(!eim.isEventCleared()) {\n+                        if (status == 0) {\n+                                cm.sendYesNo(\"If you leave now, you won't be able to return. Are you sure you want to leave?\");\n+                        } else if (status == 1) {\n+                                cm.warp(801040004, 1);\n+                                cm.dispose();\n+                        }\n+                } else {\n+                        if(status == 0) {\n+                                cm.sendNext(\"You guys did it, great job! Now our city is free from the tyranny of their mobs! As representative of the city, please accept this as a prize for your efforts, as I get you back to town.\");\n+                        }\n+\n+                        if(status == 1) {\n+                                var eim = cm.getEventInstance();\n+                                if(!eim.giveEventReward(cm.getPlayer())) {\n+                                        cm.sendNext(\"Please make room on your inventory first...\");\n+                                } else {\n+                                        cm.warp(801040101);\n+                                }\n+\n+                                cm.dispose();\n+                        }\n+                }\n+        }\n }\n\\ No newline at end of file"}, {"sha": "69c77ad35353c2485e658057dc13656fafa4d014", "filename": "scripts/npc/9120203.js", "status": "added", "additions": 60, "deletions": 0, "changes": 60, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/9120203.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/9120203.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/9120203.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -0,0 +1,60 @@\n+/*\n+\tThis file is part of the OdinMS Maple Story Server\n+    Copyright (C) 2008 Patrick Huy <patrick.huy@frz.cc> \n+\t\t\t\t\t   Matthias Butz <matze@odinms.de>\n+\t\t\t\t\t   Jan Christian Meyer <vimes@odinms.de>\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/**\n+-- Odin JavaScript --------------------------------------------------------------------------------\n+\tKonpei - Near the Hideout (Beautiful Sky)(801040101)\n+-- By ---------------------------------------------------------------------------------------------\n+\tRonan\n+-- Version Info -----------------------------------------------------------------------------------\n+\t1.0 - First Version by Ronan\n+---------------------------------------------------------------------------------------------------\n+**/\n+\n+var status;\n+\n+function start() {\n+        status = -1;\n+        action(1, 0, 0);\n+}\n+\n+function action(mode, type, selection) {\n+        if (mode == -1) {\n+                cm.dispose();\n+        } else {\n+                if (mode == 0 && status == 0) {\n+                        cm.dispose();\n+                        return;\n+                }\n+                if (mode == 1)\n+                        status++;\n+                else\n+                        status--;\n+    \n+                if (status == 0) {\n+                        cm.sendNext(\"Ah, The Boss has been defeated. What a happy day this turns out to be! Congratulations, everyone. Follow this way back to town.\");\n+                } else if (status == 1) {\n+                        cm.warp(801000000);\n+                        cm.dispose();\n+                }\n+        }\n+}"}, {"sha": "0f3929af137beef2cd6399fe6fc98e7611f3e3d1", "filename": "scripts/npc/9201097.js", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/9201097.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/9201097.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/9201097.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -21,6 +21,7 @@ eQuestPrizes[0] = new Array ([1002801,1],  // Raven Ninja Bandana\n     [1472031,1],        // Black Mamba\n     [2044701,1],        // Claw for ATT 60%\n     [2044501,1],        // Bow for ATT 60%\n+    [3010041,1],        // Skull Throne\n     [0, 750000]);       // Mesos\n     \n eQuestPrizes[1] = new Array ([1332077,1],  // Raven's Beak\n@@ -31,6 +32,7 @@ eQuestPrizes[1] = new Array ([1332077,1],  // Raven's Beak\n     [2043201,1],        // One Handed BW for Att 60%\n     [2044401,1],        // Polearm for Att 60%\n     [2044301,1],        // Spear for Att 60%\n+    [3010041,1],        // Skull Throne\n     [0,1250000]);       // Mesos\n     \n eQuestPrizes[2] = new Array ([1472072,1],   //Raven's Claw\n@@ -42,6 +44,7 @@ eQuestPrizes[2] = new Array ([1472072,1],   //Raven's Claw\n     [2043023,1],        // One-Handed Sword for Att 100%[2]\n     [2043101,1],        // One-Handed Axe for Att 60%\n     [2043301,1],        // Dagger for Att 60%\n+    [3010040,1],        // The Stirge Seat\n     [0,2500000]);       // Mesos\n     \n eQuestPrizes[3] = new Array ([1002801,1],   //Raven Ninja Bandana\n@@ -51,6 +54,7 @@ eQuestPrizes[3] = new Array ([1002801,1],   //Raven Ninja Bandana\n     [4032015,1],        // Tao of Shadows\n     [2043701,1],        // Wand for Magic Att 60%\n     [2043801,1],        // Staff for Magic Att 60%\n+    [3010040,1],        // The Stirge Seat\n     [0,1750000]);       // Mesos\n \n eQuestPrizes[4] = new Array ([0,3500000]);\t// Mesos\n@@ -96,7 +100,7 @@ function action(mode, type, selection) {\n \trequiredItem = eQuestChoices[selection];\n         \n         if(selection < 4) qnt = 50;\n-        else qnt=25;\n+        else qnt = 25;\n         \n \tcm.sendYesNo(\"Let's see, you want to trade your #b\" + qnt +  \" #t\" + requiredItem + \"##k with my stuff, right? Before trading make sure you have an empty slot available on your use or etc. inventory. Now, do you want to trade with me?\");\n     }else if (status == 4){"}, {"sha": "d1ff9858638514aba5e590e7546b68457babd78f", "filename": "scripts/npc/9201134.js", "status": "modified", "additions": 20, "deletions": 5, "changes": 25, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/9201134.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/9201134.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/9201134.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -44,11 +44,26 @@ function action(mode, type, selection) {\n                 else\n                         status--;\n     \n-                if (status == 0) {\n-                        cm.sendYesNo(\"If you leave now, you won't be able to return. Are you sure you want to leave?\");\n-                } else if (status == 1) {\n-                        cm.warp(551030100, 2);\n-                        cm.dispose();\n+                var eim = cm.getEventInstance();\n+                if(!eim.isEventCleared()) {\n+                        if (status == 0) {\n+                                cm.sendYesNo(\"If you leave now, you won't be able to return. Are you sure you want to leave?\");\n+                        } else if (status == 1) {\n+                                cm.warp(551030100, 2);\n+                                cm.dispose();\n+                        }\n+                } else {\n+                        if (status == 0) {\n+                                cm.sendNext(\"You guys defeated both Scarlion and Targa! Wonderful! Take this memento as a prize for your bravery.\");\n+                        } else if (status == 1) {\n+                                if(!eim.giveEventReward(cm.getPlayer())) {\n+                                        cm.sendNext(\"Please make room on your inventory first!\");\n+                                } else {\n+                                        cm.warp(551030100, 2);\n+                                }\n+\n+                                cm.dispose();\n+                        }\n                 }\n         }\n }\n\\ No newline at end of file"}, {"sha": "0258f48c6573d6b5ecddce2d33256d4f0f886d94", "filename": "scripts/npc/9201143.js", "status": "modified", "additions": 249, "deletions": 11, "changes": 260, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/9201143.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/9201143.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/9201143.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -1,11 +1,249 @@\n-/* @Author SharpAceX \n-        Name: Steward \n-        Map(s): Foyer \n-        Info: Steward \n-        NPC ID: 9201143.js \n-*/ \n-\n-function start() { \n-\tcm.sendNext(\"At your service, my friend.\"); \n-\tcm.dispose(); \n-}\n\\ No newline at end of file\n+/* @Author SharpAceX / Ronan\n+        Name: Steward\n+        Map(s): Foyer\n+        Info: Steward / Commands\n+        NPC ID: 9201143.js\n+*/\n+\n+var status;\n+\n+var comm_lv6 = [];\n+var desc_lv6 = [];\n+\n+var comm_lv5 = [];\n+var desc_lv5 = [];\n+\n+var comm_lv4 = [];\n+var desc_lv4 = [];\n+\n+var comm_lv3 = [];\n+var desc_lv3 = [];\n+\n+var comm_lv2 = [];\n+var desc_lv2 = [];\n+\n+var comm_lv1 = [];\n+var desc_lv1 = [];\n+\n+var levels = [\"Common\", \"Donator\", \"JrGM\", \"GM\", \"SuperGM\", \"Developer\", \"Admin\"];\n+\n+var comm_cursor, desc_cursor;\n+\n+function addCommand(comm, desc) {\n+        comm_cursor.add(comm);\n+        desc_cursor.add(desc);\n+}\n+\n+function writeSolaxiaCommandsLv6() {    //Admin\n+        comm_cursor = comm_lv6;\n+        desc_cursor = desc_lv6;\n+\n+        addCommand(\"\", \"\");\n+        addCommand(\"\", \"\");\n+        addCommand(\"\", \"\");\n+        addCommand(\"\", \"\");\n+        addCommand(\"\", \"\");\n+        addCommand(\"\", \"\");\n+        addCommand(\"\", \"\");\n+        addCommand(\"\", \"\");\n+        addCommand(\"\", \"\");\n+        addCommand(\"\", \"\");\n+        addCommand(\"\", \"\");\n+        addCommand(\"\", \"\");\n+}\n+\n+function writeSolaxiaCommandsLv5() {    //Developer\n+        comm_cursor = comm_lv5;\n+        desc_cursor = desc_lv5;\n+\n+        addCommand(\"\", \"\");\n+        addCommand(\"\", \"\");\n+        addCommand(\"\", \"\");\n+        addCommand(\"\", \"\");\n+        addCommand(\"\", \"\");\n+        addCommand(\"\", \"\");\n+        addCommand(\"\", \"\");\n+        addCommand(\"\", \"\");\n+        addCommand(\"\", \"\");\n+        addCommand(\"\", \"\");\n+        addCommand(\"\", \"\");\n+        addCommand(\"\", \"\");\n+}\n+\n+function writeSolaxiaCommandsLv4() {    //SuperGM\n+        comm_cursor = comm_lv4;\n+        desc_cursor = desc_lv4;\n+\n+        addCommand(\"\", \"\");\n+        addCommand(\"\", \"\");\n+        addCommand(\"\", \"\");\n+        addCommand(\"\", \"\");\n+        addCommand(\"\", \"\");\n+        addCommand(\"\", \"\");\n+        addCommand(\"\", \"\");\n+        addCommand(\"\", \"\");\n+        addCommand(\"\", \"\");\n+        addCommand(\"\", \"\");\n+        addCommand(\"\", \"\");\n+        addCommand(\"\", \"\");\n+}\n+\n+function writeSolaxiaCommandsLv3() {    //GM\n+        comm_cursor = comm_lv3;\n+        desc_cursor = desc_lv3;\n+\n+        addCommand(\"\", \"\");\n+        addCommand(\"\", \"\");\n+        addCommand(\"\", \"\");\n+        addCommand(\"\", \"\");\n+        addCommand(\"\", \"\");\n+        addCommand(\"\", \"\");\n+        addCommand(\"\", \"\");\n+        addCommand(\"\", \"\");\n+        addCommand(\"\", \"\");\n+        addCommand(\"\", \"\");\n+        addCommand(\"\", \"\");\n+        addCommand(\"\", \"\");\n+}\n+\n+function writeSolaxiaCommandsLv2() {    //JrGM\n+        comm_cursor = comm_lv2;\n+        desc_cursor = desc_lv2;\n+\n+        addCommand(\"hide\", \"\");\n+        addCommand(\"unhide\", \"\");\n+        addCommand(\"sp\", \"\");\n+        addCommand(\"ap\", \"\");\n+        addCommand(\"empowerme\", \"\");\n+        addCommand(\"buffmap\", \"\");\n+        addCommand(\"buff\", \"\");\n+        addCommand(\"bomb\", \"\");\n+        addCommand(\"dc\", \"\");\n+        addCommand(\"cleardrops\", \"\");\n+        addCommand(\"clearslot\", \"\");\n+        addCommand(\"warp\", \"\");\n+        addCommand(\"warpto\", \"\");\n+        addCommand(\"summon\", \"\");\n+        addCommand(\"gmshop\", \"\");\n+        addCommand(\"heal\", \"\");\n+        addCommand(\"item\", \"\");\n+        addCommand(\"level\", \"\");\n+        addCommand(\"levelpro\", \"\");\n+        addCommand(\"setstat\", \"\");\n+        addCommand(\"maxstat\", \"\");\n+        addCommand(\"maxskill\", \"\");\n+        addCommand(\"mesos\", \"\");\n+        addCommand(\"search\", \"\");\n+        addCommand(\"jail\", \"\");\n+        addCommand(\"unjail\", \"\");\n+        addCommand(\"unbug\", \"\");\n+}\n+\n+function writeSolaxiaCommandsLv1() {    //Donator\n+        comm_cursor = comm_lv1;\n+        desc_cursor = desc_lv1;\n+\n+        addCommand(\"buffme\", \"\");\n+        addCommand(\"goto\", \"\");\n+        addCommand(\"recharge\", \"\");\n+        addCommand(\"whereami\", \"\");\n+}\n+\n+function writeSolaxiaCommandsLv0() {    //Common\n+        comm_cursor = comm_lv0;\n+        desc_cursor = desc_lv0;\n+\n+        addCommand(\"commands\", \"\");\n+        addCommand(\"time\", \"\");\n+        addCommand(\"staff\", \"\");\n+        addCommand(\"uptime\", \"\");\n+        addCommand(\"gacha\", \"\");\n+        addCommand(\"whatdropsfrom\", \"\");\n+        addCommand(\"whodrops\", \"\");\n+        addCommand(\"dispose\", \"\");\n+        addCommand(\"equiplv\", \"\");\n+        addCommand(\"rates\", \"\");\n+        addCommand(\"online\", \"\");\n+        addCommand(\"gm\", \"\");\n+        addCommand(\"bug\", \"\");\n+        addCommand(\"joinevent\", \"\");\n+        addCommand(\"leaveevent\", \"\");\n+        addCommand(\"bosshp\", \"\");\n+        addCommand(\"ranks\", \"\");\n+        \n+        \n+}\n+\n+function writeSolaxiaCommands() {\n+        writeSolaxiaCommandsLv0();  //Common\n+        writeSolaxiaCommandsLv1();  //Donator\n+        writeSolaxiaCommandsLv2();  //JrGM\n+        writeSolaxiaCommandsLv3();  //GM\n+        writeSolaxiaCommandsLv4();  //Developer\n+        writeSolaxiaCommandsLv5();  //SuperGM\n+        writeSolaxiaCommandsLv6();  //Admin\n+}\n+\n+function start() {\n+        if(cm.getPlayer.getCS()) {\n+                writeSolaxiaCommands();\n+                action(1, 0, 0);\n+        } else {\n+                cm.sendNext(\"At your service, my friend.\");\n+                cm.dispose();\n+        }\n+}\n+\n+function action(mode, type, selection) {\n+        if (mode == -1) {\n+                cm.dispose();\n+        } else {\n+                if (mode == 0 && status == 0) {\n+                        cm.dispose();\n+                        return;\n+                }\n+                if (mode == 1)\n+                        status++;\n+                else\n+                        status--;\n+\n+                if (status == 0) {\n+                        var sendStr = \"There are all available commands for you:\\r\\n\\r\\n#b\";\n+                        for(var i = 0; i < cm.getGmLevel(); i++) {\n+                            sendStr += \"#L\" + i + \"#\" + levels[i] + \"#l\\r\\n\";\n+                        }\n+\n+                        cm.sendSimple(sendStr);\n+                } else if(status == 1) {\n+                        var lvComm, lvDesc;\n+\n+                        if(selection == 0) {\n+                                lvComm = comm_lv1;\n+                                lvDesc = desc_lv1;\n+                        } else if(selection == 1) {\n+                                lvComm = comm_lv2;\n+                                lvDesc = desc_lv2;\n+                        } else if(selection == 2) {\n+                                lvComm = comm_lv3;\n+                                lvDesc = desc_lv3;\n+                        } else if(selection == 3) {\n+                                lvComm = comm_lv4;\n+                                lvDesc = desc_lv4;\n+                        } else if(selection == 4) {\n+                                lvComm = comm_lv5;\n+                                lvDesc = desc_lv5;\n+                        } else {\n+                                lvComm = comm_lv6;\n+                                lvDesc = desc_lv6;\n+                        }\n+\n+                        var sendStr = \"The following commands are available for #b\" + levels[selection] + \"#k:\\r\\n\\r\\n\";\n+                        for(var i = 0; i < lvComm.length; i++) {\n+                            sendStr += \"  #L\" + i + \"# \" + lvComm[i] + \" - \" + lvDesc[i];\n+                            sendStr += \"#l\\r\\n\";\n+                        }\n+\n+                        cm.sendPrev(sendStr);\n+                }\n+        }\n+}"}, {"sha": "f53a81360d6940e3c93dc0a96e20cbf67a5c62f7", "filename": "scripts/npc/9220004.js", "status": "modified", "additions": 14, "deletions": 8, "changes": 22, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/9220004.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/npc/9220004.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/9220004.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -4,13 +4,7 @@ By Ronan\n **/ \n var status = -1;\n function start() { \n-        if(cm.getMap().getMonsters().size() > 1) {  //reactor as a monster? wtf\n-                cm.sendOk(\"Defeat all monsters before talking to me.\"); \n-                cm.dispose();\n-                return;\n-        }\n-    \n-\taction(1, 0, 0); \n+        action(1, 0, 0); \n } \n function action(mode, type, selection) { \n \tif (mode == -1) { \n@@ -26,11 +20,23 @@ function action(mode, type, selection) {\n                         status--; \n                  \n                 if (status == 0) { \n-                        cm.sendSimple(\"#b<Raid Quest: Happyville>#k\\r\\nA raid is nothing but joining many people in an attempt to defeat extremely powerful creatures. Here is no different. Here, everyone can take part in defeating the spawned creature. At the moment the are none, what will you do?\\r\\n#b\\r\\n#L0#Spawn Kid Snowman.\\r\\n#L1#Spawn Lost Rudolph.\\r\\n#L2#Nothing, just chilling.#k\");\n+                        cm.sendSimple(\"#b<Raid Quest: Happyville>#k\\r\\nA raid is nothing but many people joining up in an attempt to defeat extremely powerful creatures. Here is no different. Here, everyone can take part in defeating the spawned creature. What will you do?\\r\\n#b\\r\\n#L0#Spawn Kid Snowman.\\r\\n#L1#Spawn Lost Rudolph.\\r\\n#L2#Nothing, just chilling.#k\");\n                 } else if(status == 1) {\n                         if(selection == 0) {\n+                                if(cm.getMap().getMonsters().size() > 1) {  //reactor as a monster? wtf\n+                                        cm.sendOk(\"Eliminate all mobs in the area to call Kid Snowman.\"); \n+                                        cm.dispose();\n+                                        return;\n+                                }\n+                            \n                                 cm.getMap().spawnMonsterOnGroundBelow(9500317, 1700, 80);\n                         } else if(selection == 1) {\n+                                if(cm.getMap().getMonsters().size() > 6) {  //reactor as a monster? wtf\n+                                        cm.sendOk(\"The place is too crowded right now. Eliminate some mobs before trying again.\"); \n+                                        cm.dispose();\n+                                        return;\n+                                }\n+                            \n                                 cm.getMap().spawnMonsterOnGroundBelow(9500320, 1700, 80);\n                         } else {\n                                 cm.sendOk(\"Fine then.\");"}, {"sha": "aa4a80a50507c05ecdd29ea80ec0117fa8ec141b", "filename": "scripts/portal/PPinkOut.js", "status": "added", "additions": 30, "deletions": 0, "changes": 30, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/portal/PPinkOut.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/portal/PPinkOut.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/PPinkOut.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -0,0 +1,30 @@\n+/*\n+\tThis file is part of the OdinMS Maple Story Server\n+    Copyright (C) 2008 Patrick Huy <patrick.huy@frz.cc> \n+                       Matthias Butz <matze@odinms.de>\n+                       Jan Christian Meyer <vimes@odinms.de>\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License version 3\n+    as published by the Free Software Foundation. You may not use, modify\n+    or distribute this program under any other version of the\n+    GNU Affero General Public License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+Vs Pink Bean - Clear stage portal\n+@author Ronan\n+*/\n+\n+function enter(pi) {\n+        pi.warp(270050000);\n+        return true;\n+}\n\\ No newline at end of file"}, {"sha": "d0903ce2b5ed1d8cc676ba9af3a546f5c7a25f7e", "filename": "scripts/portal/Pinkin.js", "status": "added", "additions": 30, "deletions": 0, "changes": 30, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/portal/Pinkin.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/portal/Pinkin.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/Pinkin.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -0,0 +1,30 @@\n+/*\n+\tThis file is part of the OdinMS Maple Story Server\n+    Copyright (C) 2008 Patrick Huy <patrick.huy@frz.cc> \n+                       Matthias Butz <matze@odinms.de>\n+                       Jan Christian Meyer <vimes@odinms.de>\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License version 3\n+    as published by the Free Software Foundation. You may not use, modify\n+    or distribute this program under any other version of the\n+    GNU Affero General Public License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+Vs Pink Bean - Ressurection stage portal\n+@author Ronan\n+*/\n+\n+function enter(pi) {\n+        pi.warp(270050100);\n+        return true;\n+}\n\\ No newline at end of file"}, {"sha": "06e377c7651b7f5e7dfee472f08c7bcfe82f5dc1", "filename": "scripts/portal/Zakum03.js", "status": "added", "additions": 39, "deletions": 0, "changes": 39, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/portal/Zakum03.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/portal/Zakum03.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/Zakum03.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -0,0 +1,39 @@\n+/*\n+\tThis file is part of the OdinMS Maple Story Server\n+    Copyright (C) 2008 Patrick Huy <patrick.huy@frz.cc>\n+\t\t       Matthias Butz <matze@odinms.de>\n+\t\t       Jan Christian Meyer <vimes@odinms.de>\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+/*\n+    Zakum PQ portal\n+*/\n+ \n+function enter(pi) {\n+    if (!pi.getEventInstance().isEventCleared()) {\n+        pi.getPlayer().dropMessage(5,\"Your team has not yet completed the trials. Fetch the Fire Ore and give it to Aura first.\");\n+        return false;\n+    }\n+    \n+    if (pi.getEventInstance().gridCheck(pi.getPlayer()) == -1) {\n+        pi.getPlayer().dropMessage(5,\"Your have yet to claim your prize. Talk to Aura.\");\n+        return false;\n+    }\n+    \n+    pi.warp(211042300);\n+    return true;\n+}\n\\ No newline at end of file"}, {"sha": "5fc6b8f1061c3fa35e87d035a30a92f061a7ed6a", "filename": "scripts/portal/Zakum05.js", "status": "modified", "additions": 9, "deletions": 8, "changes": 17, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/portal/Zakum05.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/portal/Zakum05.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/Zakum05.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -24,15 +24,16 @@\n */\n  \n function enter(pi) {\n-    if (!pi.haveItem(4001017)) {\n-        pi.getPlayer().dropMessage(6,\"You do not have the Eye of Fire.  You may not face the boss.\");\n+    if (!pi.isQuestStarted(100200)) {\n+        pi.getPlayer().dropMessage(5,\"You need approval from the masters to battle. You may not attempt the boss right now.\");\n         return false;\n-    } \n-\t//var exped = pi.getEventManager(\"ZakumBattle\").getInstance(\"ZakumBattle_\" + pi.getPlayer().getClient().getChannel());\n-\t//if (exped != null) {\n-\t//\tpi.getPlayer().dropMessage(6,\"The battle at Zakum's Altar is currently underway.\");\n-    //    return false;\n-\t//}\n+    }\n+    \n+    if (!pi.isQuestCompleted(100201)) {\n+        pi.getPlayer().dropMessage(5,\"You do not have completed all the trials yet. You may not attempt the boss right now.\");\n+        return false;\n+    }\n+    \n     pi.warp(211042400,\"west00\");\n     return true;\n }\n\\ No newline at end of file"}, {"sha": "5c58a3db64afb4aa3445877e486acf0e9e409be7", "filename": "scripts/portal/dojang_exit.js", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/portal/dojang_exit.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/portal/dojang_exit.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/dojang_exit.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -20,15 +20,15 @@\n     along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n /*\t\n- * @author:  kevintjuh93/moogra\n+ * @author:  kevintjuh93, moogra\n  * @portal:  dojang_exit\n  * @purpose: warps user out\n  */\n \n function enter(pi) {\n-\tvar map = pi.getPlayer().getSavedLocation(\"MIRROR\");\n-\tif(map == -1)\n-\t\tmap = 100000000;\n+    var map = pi.getPlayer().getSavedLocation(\"MIRROR\");\n+    if(map == -1) map = 100000000;\n+    \n     pi.warp(map);\n     return true;\n }\n\\ No newline at end of file"}, {"sha": "47ab1df13a11c1848a73ee80b7a0861b71b49b34", "filename": "scripts/portal/dojang_next.js", "status": "modified", "additions": 15, "deletions": 7, "changes": 22, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/portal/dojang_next.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/portal/dojang_next.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/dojang_next.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -20,16 +20,24 @@\n     along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n /**\n- * @Author Moogra\n+ * @Author Moogra, Ronan\n  */\n function enter(pi) {\n-    if (pi.getPlayer().getMap().getReactorByName(\"door\").getState() == 1) {\n-        if ((pi.getPlayer().getMapId() / 100) % 100 != 38) {\n-            if (pi.getPlayer().getMap().getCharacters().size() == 1) {\n-                pi.resetMap(pi.getPlayer().getMapId());\n-            }\n+    var gate = pi.getPlayer().getMap().getReactorByName(\"door\");\n+    \n+    if ((gate != null && gate.getState() == 1) || pi.getMap().countMonsters() == 0) {\n+        if (Math.floor(pi.getPlayer().getMapId() / 100) % 100 < 38) {\n             pi.getPlayer().message(\"You received \" + pi.getPlayer().addDojoPointsByMap() + \" training points. Your total training points score is now \" + pi.getPlayer().getDojoPoints() + \".\");\n-            pi.warp(pi.getPlayer().getMap().getId() + 100, 0);\n+            \n+            if(((Math.floor((pi.getPlayer().getMap().getId() + 100) / 100)) % 100) % 6 == 0) {\n+                if(Math.floor(pi.getPlayer().getMapId() / 10000) == 92503) {\n+                    pi.warpParty(pi.getPlayer().getMap().getId() + 100, 925030100, 925033804);\n+                } else {\n+                    pi.warp(pi.getPlayer().getMap().getId() + 100, 0);\n+                }\n+            } else {\n+                pi.warp(pi.getPlayer().getMap().getId() + 100, 0);\n+            }\n         } else {\n             pi.warp(925020003, 0);\n             pi.getPlayer().gainExp(2000 * pi.getPlayer().getDojoPoints(), true, true, true);"}, {"sha": "b28d114f18584d3960e65a229a6d767ffd0b93e6", "filename": "scripts/portal/dojang_tuto.js", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/portal/dojang_tuto.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/portal/dojang_tuto.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/dojang_tuto.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -28,9 +28,11 @@\n function enter(pi) {\n     if (pi.getPlayer().getMap().getMonsterById(9300216) != null) {\n         pi.getPlayer().enteredScript(\"dojang_Msg\", pi.getPlayer().getMap().getId());\n+        pi.getPlayer().setFinishedDojoTutorial();\n         pi.warp(925020001, 0);\n+        return true;\n     } else {\n         pi.getPlayer().message(\"So Gong: Haha! You're going to run away like a coward? I won't let you get away that easily!\");\n+        return false;\n     }\n-    return true;\n }\n\\ No newline at end of file"}, {"sha": "776510f5476a80fafcec51d8a513cffeeeb90238", "filename": "scripts/portal/dojang_up.js", "status": "modified", "additions": 11, "deletions": 11, "changes": 22, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/portal/dojang_up.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/portal/dojang_up.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/dojang_up.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -28,17 +28,17 @@\n \n function enter(pi) {\n     try {\n-\t    if (pi.getPlayer().getMap().getMonsterById(9300216) != null) {\n-\t        pi.goDojoUp();\n-\t        pi.getPlayer().getMap().setReactorState();\n-\t        var stage = (pi.getPlayer().getMapId() / 100) % 100;\n-\t        if ((stage - (stage / 6) | 0) == pi.getPlayer().getVanquisherStage() && !pi.getPlayer().getDojoParty()) // we can also try 5 * stage / 6 | 0 + 1\n-\t            pi.getPlayer().setVanquisherKills(pi.getPlayer().getVanquisherKills() + 1);\n-\t    } else {\n-\t        pi.getPlayer().message(\"There are still some monsters remaining.\");\n-\t    }\n-\t    pi.enableActions();\n-\t    return true;\n+        if (pi.getPlayer().getMap().getMonsterById(9300216) != null) {\n+            pi.goDojoUp();\n+            pi.getPlayer().getMap().setReactorState();\n+            var stage = Math.floor(pi.getPlayer().getMapId() / 100) % 100;\n+            if ((stage - (stage / 6) | 0) == pi.getPlayer().getVanquisherStage() && !pi.getPlayer().getDojoParty()) // we can also try 5 * stage / 6 | 0 + 1\n+                pi.getPlayer().setVanquisherKills(pi.getPlayer().getVanquisherKills() + 1);\n+        } else {\n+            pi.getPlayer().message(\"There are still some monsters remaining.\");\n+        }\n+        pi.enableActions();\n+        return true;\n     } catch(err) {\n         pi.getPlayer().dropMessage(err);\n     }"}, {"sha": "447ab087f86059b20c3a6d1df496c1fe726170aa", "filename": "scripts/portal/hontale_morph2.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/portal/hontale_morph2.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/portal/hontale_morph2.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/hontale_morph2.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -24,6 +24,6 @@ Leave the Cave of Life - Entrance Map and go back to the Peak of the Big Nest (2\n */\n \n function enter(pi) {\n-\tpi.warp(240040600, \"st00\");\n+\tpi.warp(240040600, 4);\n \treturn true;\n }"}, {"sha": "30aad2558aabbe0a9986ae12c6bcb633c9441e88", "filename": "scripts/portal/s4berserk.js", "status": "modified", "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/portal/s4berserk.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/portal/s4berserk.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/s4berserk.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -25,8 +25,15 @@\n  */\n function enter(pi) {\n     if(pi.isQuestStarted(6153)) {\n-        pi.warp(910500200, 0);\n-        return true;\n+        if(pi.getWarpMap(910500200).countPlayers() == 0) {\n+            pi.resetMapObjects(910500200);\n+            pi.warp(910500200, 0);\n+            \n+            return true;\n+        } else {\n+            pi.getPlayer().message(\"Some other player is currently inside.\");\n+            return false;\n+        }\n     } else {\n         pi.getPlayer().message(\"A mysterious force won't let you in.\");\n         return false;"}, {"sha": "347f761d2c628830c92819c430661b7d837bd1f6", "filename": "scripts/portal/s4berserk_move.js", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/portal/s4berserk_move.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/portal/s4berserk_move.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/s4berserk_move.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -20,7 +20,7 @@\n     along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n function enter(pi) {\n-    if (pi.getPlayer().getEventInstance().getProperty(\"canWarp\")) {\n+    if (pi.getPlayer().getMap().countMonsters() == 0) {\n         pi.warp(910500200, \"out01\");\n         return true;\n     }"}, {"sha": "e77061440be8cfa82206b5b0f0de0628bfd183a5", "filename": "scripts/portal/s4firehawk.js", "status": "modified", "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/portal/s4firehawk.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/portal/s4firehawk.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/s4firehawk.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -25,8 +25,15 @@\n  */\n function enter(pi) {\n     if(pi.isQuestStarted(6240)) {\n-        pi.warp(921100200, 0);\n-        return true;\n+        if(pi.getWarpMap(921100200).countPlayers() == 0) {\n+            pi.resetMapObjects(921100200);\n+            pi.warp(921100200, 0);\n+            \n+            return true;\n+        } else {\n+            pi.getPlayer().message(\"Some other player is currently inside.\");\n+            return false;\n+        }\n     } else {\n         pi.getPlayer().message(\"A mysterious force won't let you in.\");\n         return false;"}, {"sha": "164d1afda00c33b2e3130bdf0864068b0a738cbd", "filename": "scripts/portal/s4hitman.js", "status": "modified", "additions": 11, "deletions": 3, "changes": 14, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/portal/s4hitman.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/portal/s4hitman.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/s4hitman.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -25,9 +25,17 @@\n  */\n function enter(pi) {\n     if(pi.isQuestStarted(6202)) {\n-        pi.getPlayer().getClient().getChannelServer().getMapFactory().getMap(910200000).resetReactors(); // Make sure they actually can do what they need...\n-        pi.warp(910200000, 0);\n-        return true;\n+        if(pi.getWarpMap(910200000).countPlayers() == 0) {\n+            pi.resetMapObjects(910200000);\n+            pi.warp(910200000, 0);\n+            \n+            return true;\n+        } else {\n+            pi.getPlayer().message(\"Some other player is currently inside.\");\n+            return false;\n+        }\n     }\n+    \n+    pi.getPlayer().message(\"A mysterious force won't let you in.\");\n     return false;\n }\n\\ No newline at end of file"}, {"sha": "1fd1f06a0ce1c9ecb7470b5513d267c9f931b6c3", "filename": "scripts/portal/s4iceeagle.js", "status": "modified", "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/portal/s4iceeagle.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/portal/s4iceeagle.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/s4iceeagle.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -25,8 +25,15 @@\n  */\n function enter(pi) {\n     if(pi.isQuestStarted(6242)) {\n-        pi.warp(921100210, 0);\n-        return true;\n+        if(pi.getWarpMap(921100210).countPlayers() == 0) {\n+            pi.resetMapObjects(921100210);\n+            pi.warp(921100210, 0);\n+            \n+            return true;\n+        } else {\n+            pi.getPlayer().message(\"Some other player is currently inside.\");\n+            return false;\n+        }\n     } else {\n         pi.getPlayer().message(\"A mysterious force won't let you in.\");\n         return false;"}, {"sha": "3443a1c32d3f2ff24157f73cf2e5614efbefa8a8", "filename": "scripts/portal/s4nest.js", "status": "modified", "additions": 14, "deletions": 2, "changes": 16, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/portal/s4nest.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/portal/s4nest.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/s4nest.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -24,6 +24,18 @@\n  * @purpose Warps to the Junior Balrog map for the Rush Skill.\n  */\n function enter(pi) {\n-    pi.warp(924000100, 0);\n-    return true;\n+    if(pi.isQuestStarted(6241) || pi.isQuestStarted(6243)) {\n+        if(pi.getWarpMap(924000100).countPlayers() == 0) {\n+            pi.resetMapObjects(924000100);\n+            pi.warp(924000100, 0);\n+            \n+            return true;\n+        } else {\n+            pi.getPlayer().message(\"Some other player is currently inside.\");\n+            return false;\n+        }\n+    }\n+    \n+    pi.getPlayer().message(\"A mysterious force won't let you in.\");\n+    return false;\n }\n\\ No newline at end of file"}, {"sha": "27823bbcbfe6c3a0647c43cce5bf9c30931542c0", "filename": "scripts/portal/s4resur_enter.js", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/portal/s4resur_enter.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/portal/s4resur_enter.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/s4resur_enter.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -27,8 +27,8 @@ function enter(pi) {\n     if(pi.isQuestStarted(6134)) {\n         pi.warp(922020000, 0);\n         return true;\n-    } else {\n-        pi.getPlayer().message(\"A mysterious force won't let you in.\");\n-        return false;\n     }\n+    \n+    pi.getPlayer().message(\"A mysterious force won't let you in.\");\n+    return false;\n }\n\\ No newline at end of file"}, {"sha": "0a5a4b67364b58f9c6903bf66628115b44f65768", "filename": "scripts/portal/s4resur_out.js", "status": "modified", "additions": 10, "deletions": 4, "changes": 14, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/portal/s4resur_out.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/portal/s4resur_out.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/s4resur_out.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -21,13 +21,19 @@\n */\n /**\n  * @author DiscoveryMS (Twdtwd)\n- * @purpose Warps to the Forgotten Passage and gives you the needed item for the resurection.\n+ * @purpose Warps to the Forgotten Passage and gives you the needed item for the resurrection.\n  */\n function enter(pi) {\n     if(pi.isQuestStarted(6134)) {\n-        pi.warp(220070400, 3);\n-        pi.gainItem(4031448, 1);\n-        return true;\n+        if(pi.canHold(4031448)) {\n+            pi.gainItem(4031448, 1);\n+            pi.warp(220070400, 3);\n+        \n+            return true;\n+        } else {\n+            pi.getPlayer().message(\"Make room on your ETC to receive the quest item.\");\n+            return false;\n+        }\n     } else {\n         pi.warp(220070400, 3);\n         return true;"}, {"sha": "ef20aff809870fe8eea43a4f2d5dfc782425a0c4", "filename": "scripts/portal/s4resurrection.js", "status": "modified", "additions": 15, "deletions": 3, "changes": 18, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/portal/s4resurrection.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/portal/s4resurrection.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/s4resurrection.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -20,10 +20,22 @@\n     along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n /**\n- * @author DiscoveryMS (Twdtwd)\n+ * @author DiscoveryMS (Twdtwd), Ronan\n  * @purpose Warps to the Cold Cave for Resurection.\n  */\n function enter(pi) {\n-    pi.warp(923000100, 0);\n-    return true;\n+    if(pi.haveItem(4001108)) {\n+        if(pi.getWarpMap(923000100).countPlayers() == 0) {\n+            pi.resetMapObjects(923000100);\n+            pi.warp(923000100, 0);\n+            \n+            return true;\n+        } else {\n+            pi.getPlayer().message(\"Some other player is currently inside.\");\n+            return false;\n+        }\n+    }\n+    \n+    pi.getPlayer().message(\"A mysterious force won't let you in.\");\n+    return false;\n }\n\\ No newline at end of file"}, {"sha": "8b7f7b748c9a1fbd966f12424d5ee8783fc875d0", "filename": "scripts/portal/s4rush.js", "status": "modified", "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/portal/s4rush.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/portal/s4rush.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/s4rush.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -25,8 +25,15 @@\n  */\n function enter(pi) {\n     if(pi.isQuestStarted(6110)) {\n-        pi.warp(910500100, 0);\n-        return true;\n+        if(pi.getWarpMap(910500100).countPlayers() == 0) {\n+            pi.resetMapObjects(910500100);\n+            pi.warp(910500100, 0);\n+            \n+            return true;\n+        } else {\n+            pi.getPlayer().message(\"Some other player is currently inside.\");\n+            return false;\n+        }\n     } else {\n         pi.getPlayer().message(\"A mysterious force won't let you in.\");\n         return false;"}, {"sha": "e56b134e1aaa2545fcec4002e3eac2e28822b0f0", "filename": "scripts/portal/s4tornado_enter.js", "status": "modified", "additions": 11, "deletions": 2, "changes": 13, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/portal/s4tornado_enter.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/portal/s4tornado_enter.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/s4tornado_enter.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -25,8 +25,17 @@\n  */\n function enter(pi) {\n     if(pi.isQuestStarted(6230) || pi.haveItem(4001110)) {\n-        pi.warp(922020200, 1);\n-        return true;\n+        if(pi.getWarpMap(922020200).countPlayers() == 0) {\n+            pi.resetMapObjects(922020200);\n+            pi.warp(922020200, 0);\n+            \n+            return true;\n+        } else {\n+            pi.getPlayer().message(\"Some other player is currently inside.\");\n+            return false;\n+        }\n     }\n+    \n+    pi.getPlayer().message(\"A mysterious force won't let you in.\");\n     return false;\n }\n\\ No newline at end of file"}, {"sha": "c06753da3bf1b1f703528bebcd9a62e1bd0821da", "filename": "scripts/reactor/1052000.js", "status": "added", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/reactor/1052000.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/reactor/1052000.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/reactor/1052000.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -0,0 +1,3 @@\n+function act() {\n+\trm.dropItems();\n+}\n\\ No newline at end of file"}, {"sha": "c06753da3bf1b1f703528bebcd9a62e1bd0821da", "filename": "scripts/reactor/1052002.js", "status": "added", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/reactor/1052002.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/reactor/1052002.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/reactor/1052002.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -0,0 +1,3 @@\n+function act() {\n+\trm.dropItems();\n+}\n\\ No newline at end of file"}, {"sha": "1349013a15555034f5e2c1a2e7261f12e914453b", "filename": "scripts/reactor/2119000.js", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/reactor/2119000.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/reactor/2119000.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/reactor/2119000.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -19,6 +19,8 @@\n     You should have received a copy of the GNU Affero General Public License\n     along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n-function act() {\n-    rm.spawnMonster(9400711, 1);\n-}\n\\ No newline at end of file\n+function hit() {\n+    rm.hitMonsterWithReactor(6090000, 14);\n+}\n+\n+function act() {}\n\\ No newline at end of file"}, {"sha": "1349013a15555034f5e2c1a2e7261f12e914453b", "filename": "scripts/reactor/2119001.js", "status": "added", "additions": 26, "deletions": 0, "changes": 26, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/reactor/2119001.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/reactor/2119001.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/reactor/2119001.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -0,0 +1,26 @@\n+/*\n+\tThis file is part of the OdinMS Maple Story Server\n+    Copyright (C) 2008 Patrick Huy <patrick.huy@frz.cc>\n+\t\t       Matthias Butz <matze@odinms.de>\n+\t\t       Jan Christian Meyer <vimes@odinms.de>\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+function hit() {\n+    rm.hitMonsterWithReactor(6090000, 14);\n+}\n+\n+function act() {}\n\\ No newline at end of file"}, {"sha": "1349013a15555034f5e2c1a2e7261f12e914453b", "filename": "scripts/reactor/2119002.js", "status": "added", "additions": 26, "deletions": 0, "changes": 26, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/reactor/2119002.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/reactor/2119002.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/reactor/2119002.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -0,0 +1,26 @@\n+/*\n+\tThis file is part of the OdinMS Maple Story Server\n+    Copyright (C) 2008 Patrick Huy <patrick.huy@frz.cc>\n+\t\t       Matthias Butz <matze@odinms.de>\n+\t\t       Jan Christian Meyer <vimes@odinms.de>\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+function hit() {\n+    rm.hitMonsterWithReactor(6090000, 14);\n+}\n+\n+function act() {}\n\\ No newline at end of file"}, {"sha": "1349013a15555034f5e2c1a2e7261f12e914453b", "filename": "scripts/reactor/2119003.js", "status": "added", "additions": 26, "deletions": 0, "changes": 26, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/reactor/2119003.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/reactor/2119003.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/reactor/2119003.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -0,0 +1,26 @@\n+/*\n+\tThis file is part of the OdinMS Maple Story Server\n+    Copyright (C) 2008 Patrick Huy <patrick.huy@frz.cc>\n+\t\t       Matthias Butz <matze@odinms.de>\n+\t\t       Jan Christian Meyer <vimes@odinms.de>\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+function hit() {\n+    rm.hitMonsterWithReactor(6090000, 14);\n+}\n+\n+function act() {}\n\\ No newline at end of file"}, {"sha": "ce19e0bf7f0dca461aa5a3ad626140f7c4257c8b", "filename": "scripts/reactor/2119004.js", "status": "added", "additions": 25, "deletions": 0, "changes": 25, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/reactor/2119004.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/reactor/2119004.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/reactor/2119004.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -0,0 +1,25 @@\n+/*\n+\tThis file is part of the OdinMS Maple Story Server\n+    Copyright (C) 2008 Patrick Huy <patrick.huy@frz.cc>\n+\t\t       Matthias Butz <matze@odinms.de>\n+\t\t       Jan Christian Meyer <vimes@odinms.de>\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+function hit() {\n+    rm.hitMonsterWithReactor(6090001, 4);\n+    rm.getReactor().setEventState(Math.floor(Math.random() * 3));\n+}\n\\ No newline at end of file"}, {"sha": "ce19e0bf7f0dca461aa5a3ad626140f7c4257c8b", "filename": "scripts/reactor/2119005.js", "status": "added", "additions": 25, "deletions": 0, "changes": 25, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/reactor/2119005.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/reactor/2119005.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/reactor/2119005.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -0,0 +1,25 @@\n+/*\n+\tThis file is part of the OdinMS Maple Story Server\n+    Copyright (C) 2008 Patrick Huy <patrick.huy@frz.cc>\n+\t\t       Matthias Butz <matze@odinms.de>\n+\t\t       Jan Christian Meyer <vimes@odinms.de>\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+function hit() {\n+    rm.hitMonsterWithReactor(6090001, 4);\n+    rm.getReactor().setEventState(Math.floor(Math.random() * 3));\n+}\n\\ No newline at end of file"}, {"sha": "ce19e0bf7f0dca461aa5a3ad626140f7c4257c8b", "filename": "scripts/reactor/2119006.js", "status": "added", "additions": 25, "deletions": 0, "changes": 25, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/reactor/2119006.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/reactor/2119006.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/reactor/2119006.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -0,0 +1,25 @@\n+/*\n+\tThis file is part of the OdinMS Maple Story Server\n+    Copyright (C) 2008 Patrick Huy <patrick.huy@frz.cc>\n+\t\t       Matthias Butz <matze@odinms.de>\n+\t\t       Jan Christian Meyer <vimes@odinms.de>\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+function hit() {\n+    rm.hitMonsterWithReactor(6090001, 4);\n+    rm.getReactor().setEventState(Math.floor(Math.random() * 3));\n+}\n\\ No newline at end of file"}, {"sha": "999646a0e0e55fec1ddd915bc73b8e02d3c124e0", "filename": "scripts/reactor/2229009.js", "status": "added", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/reactor/2229009.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/reactor/2229009.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/reactor/2229009.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -0,0 +1,24 @@\n+/*\n+\tThis file is part of the OdinMS Maple Story Server\n+    Copyright (C) 2008 Patrick Huy <patrick.huy@frz.cc>\n+\t\t       Matthias Butz <matze@odinms.de>\n+\t\t       Jan Christian Meyer <vimes@odinms.de>\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+function hit() {\n+    rm.hitMonsterWithReactor(6090003, 1);\n+}\n\\ No newline at end of file"}, {"sha": "73c35f07fdf23023e67220fa8e39ea97c60fc7ac", "filename": "scripts/reactor/2708000.js", "status": "added", "additions": 43, "deletions": 0, "changes": 43, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/reactor/2708000.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/reactor/2708000.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/reactor/2708000.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -0,0 +1,43 @@\n+/*\n+\tThis file is part of the OdinMS Maple Story Server\n+    Copyright (C) 2008 Patrick Huy <patrick.huy@frz.cc> \n+\t\t       Matthias Butz <matze@odinms.de>\n+\t\t       Jan Christian Meyer <vimes@odinms.de>\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+importPackage(Packages.server.life);\n+\n+function spawnJrBoss(mobObj) {\n+    mobObj.getMap().killMonster(mobObj.getId());\n+    var spawnid = mobObj.getId() - 17;\n+    \n+    var mob = MapleLifeFactory.getMonster(spawnid);\n+    mobObj.getMap().spawnMonsterOnGroundBelow(mob, mobObj.getPosition());\n+}\n+\n+function hit() {\n+    var mapObj = rm.getMap();\n+    \n+    //spawnJrBoss(mapObj.getMonsterById(8820019));\n+    //spawnJrBoss(mapObj.getMonsterById(8820020));\n+    //spawnJrBoss(mapObj.getMonsterById(8820021));\n+    //spawnJrBoss(mapObj.getMonsterById(8820022));\n+    //spawnJrBoss(mapObj.getMonsterById(8820023));\n+    \n+    mapObj.killMonster(8820000);\n+}\n\\ No newline at end of file"}, {"sha": "f4f08d7db55347481c1222d42fd2af17e17ce82b", "filename": "scripts/reactor/8001000.js", "status": "added", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/reactor/8001000.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/scripts/reactor/8001000.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/reactor/8001000.js?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -0,0 +1,24 @@\n+/*\n+\tThis file is part of the OdinMS Maple Story Server\n+    Copyright (C) 2008 Patrick Huy <patrick.huy@frz.cc>\n+\t\t       Matthias Butz <matze@odinms.de>\n+\t\t       Jan Christian Meyer <vimes@odinms.de>\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+function act(){\n+        rm.spawnMonster(9400112);\n+}\n\\ No newline at end of file"}, {"sha": "2c08aad984bf8ad027b663d8c2ca9b03d0945712", "filename": "sql/db_database.sql", "status": "modified", "additions": 35, "deletions": 37, "changes": 72, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/sql/db_database.sql", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/sql/db_database.sql", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/sql/db_database.sql?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -8,7 +8,8 @@ SET time_zone = \"+00:00\";\n /*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;\n /*!40101 SET NAMES utf8 */;\n \n-CREATE DATABASE IF NOT EXISTS `maplesolaxia` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;\n+DROP DATABASE IF EXISTS `maplesolaxia`;\n+CREATE DATABASE `maplesolaxia` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;\n USE `maplesolaxia`;\n \n CREATE TABLE IF NOT EXISTS `accounts` (\n@@ -12872,14 +12873,6 @@ CREATE TABLE IF NOT EXISTS `gifts` (\n   PRIMARY KEY (`id`)\n ) ENGINE=InnoDB DEFAULT CHARSET=latin1 AUTO_INCREMENT=1 ;\n \n-CREATE TABLE IF NOT EXISTS `gmlog` (\n-  `id` int(11) NOT NULL AUTO_INCREMENT,\n-  `cid` int(11) NOT NULL DEFAULT '0',\n-  `command` tinytext NOT NULL,\n-  `when` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,\n-  PRIMARY KEY (`id`)\n-) ENGINE=InnoDB DEFAULT CHARSET=latin1 AUTO_INCREMENT=1 ;\n-\n CREATE TABLE IF NOT EXISTS `guilds` (\n   `guildid` int(10) unsigned NOT NULL AUTO_INCREMENT,\n   `leader` int(10) unsigned NOT NULL DEFAULT '0',\n@@ -16227,7 +16220,7 @@ INSERT INTO `monstercarddata` (`id`, `cardid`, `mobid`) VALUES\n (287, 2388040, 8220004),\n (288, 2388041, 8220005),\n (289, 2388042, 8220006),\n-(290, 2388043, 8820000),\n+(290, 2388043, 8820001),\n (291, 2380013, 9300274),\n (292, 2388055, 8830000),\n (293, 2380014, 1110130),\n@@ -20267,17 +20260,17 @@ INSERT INTO `shopitems` (`shopitemid`, `shopid`, `itemid`, `price`, `pitch`, `po\n (2976, 9270022, 2000002, 320, 0, 208),\n (2977, 9270022, 2000001, 160, 0, 212),\n (2978, 9270022, 2000000, 50, 0, 216),\n-(2979, 9270027, 2022215, 6800, 0, 104),\n-(2980, 9270027, 2022214, 3200, 0, 108),\n-(2981, 9270027, 2022211, 6400, 0, 112),\n-(2982, 9270027, 2022210, 3200, 0, 116),\n-(2983, 9270027, 2022209, 1600, 0, 120),\n-(2984, 9270027, 2022208, 1000, 0, 124),\n-(2985, 9270027, 2022207, 2600, 0, 128),\n-(2986, 9270027, 2022206, 2200, 0, 132),\n-(2987, 9270027, 2022205, 1800, 0, 136),\n-(2988, 9270027, 2022204, 1200, 0, 140),\n-(2989, 9270027, 2022203, 800, 0, 144),\n+(2979, 9270027, 2022215, 6800, 0, 112),\n+(2980, 9270027, 2022214, 3200, 0, 116),\n+(2981, 9270027, 2022211, 6400, 0, 120),\n+(2982, 9270027, 2022210, 3200, 0, 124),\n+(2983, 9270027, 2022209, 1600, 0, 128),\n+(2984, 9270027, 2022208, 1000, 0, 132),\n+(2985, 9270027, 2022207, 2600, 0, 136),\n+(2986, 9270027, 2022206, 2200, 0, 140),\n+(2987, 9270027, 2022205, 1800, 0, 144),\n+(2988, 9270027, 2022204, 1200, 0, 148),\n+(2989, 9270027, 2022203, 800, 0, 152),\n (2990, 9999992, 1812006, 1, 0, 112),\n (2991, 9999992, 1832000, 1, 0, 114),\n (2992, 9999992, 1812005, 1, 0, 116),\n@@ -20928,7 +20921,6 @@ INSERT INTO `shopitems` (`shopitemid`, `shopid`, `itemid`, `price`, `pitch`, `po\n (20227, 9270056, 1040085, 200000, 0, 436),\n (20228, 9270056, 1040000, 200000, 0, 440),\n (20229, 9270056, 1002004, 160000, 0, 444),\n-\n (20230, 9270065, 2061000, 1, 0, 1),\n (20231, 9270065, 2060000, 1, 0, 2),\n (20232, 9270065, 2030000, 400, 0, 3),\n@@ -20938,20 +20930,22 @@ INSERT INTO `shopitems` (`shopitemid`, `shopid`, `itemid`, `price`, `pitch`, `po\n (20236, 9270065, 2050000, 200, 0, 7),\n (20237, 9270065, 2022215, 6800, 0, 8),\n (20238, 9270065, 2022214, 3200, 0, 9),\n-(20239, 9270065, 2022211, 6400, 0, 10),\n-(20240, 9270065, 2022210, 3200, 0, 11),\n-(20241, 9270065, 2022209, 1600, 0, 12),\n-(20242, 9270065, 2022208, 1000, 0, 13),\n-(20243, 9270065, 2022207, 2600, 0, 14),\n-(20244, 9270065, 2022206, 2200, 0, 15),\n-(20245, 9270065, 2022205, 1800, 0, 16),\n-(20246, 9270065, 2022204, 1200, 0, 17),\n-(20247, 9270065, 2022203, 800, 0, 18),\n-(20248, 9270065, 2022480, 12000, 0, 19),\n-(20249, 9270065, 2022479, 3800, 0, 20),\n-(20250, 9270065, 2022478, 3200, 0, 21),\n-(20251, 9270065, 2022477, 9200, 0, 22),\n-(20252, 9270065, 2022476, 4200, 0, 23);\n+(20239, 9270065, 2022213, 6800, 0, 10),\n+(20240, 9270065, 2022212, 3200, 0, 11),\n+(20241, 9270065, 2022211, 6400, 0, 12),\n+(20242, 9270065, 2022210, 3200, 0, 13),\n+(20243, 9270065, 2022209, 1600, 0, 14),\n+(20244, 9270065, 2022208, 1000, 0, 15),\n+(20245, 9270065, 2022207, 2600, 0, 16),\n+(20246, 9270065, 2022206, 2200, 0, 17),\n+(20247, 9270065, 2022205, 1800, 0, 18),\n+(20248, 9270065, 2022204, 1200, 0, 19),\n+(20249, 9270065, 2022203, 800, 0, 20),\n+(20250, 9270065, 2022480, 12000, 0, 21),\n+(20251, 9270065, 2022479, 3800, 0, 22),\n+(20252, 9270065, 2022478, 3200, 0, 23),\n+(20253, 9270065, 2022477, 9200, 0, 24),\n+(20254, 9270065, 2022476, 4200, 0, 25);\n \n CREATE TABLE IF NOT EXISTS `shops` (\n   `shopid` int(10) unsigned NOT NULL AUTO_INCREMENT,\n@@ -21183,7 +21177,11 @@ INSERT INTO `shopitems` ( `shopid`, `itemid`, `price`, `position`) VALUES\n ( 57, 3992035, 500, 112), \n ( 57, 3992036, 500, 113), \n ( 57, 3992037, 500, 114), \n-( 57, 3992038, 500, 115);\n+( 57, 3992038, 500, 115),\n+\n+-- missing CBD shop data\n+(9270027, 2022213, 6800, 0, 104),\n+(9270027, 2022212, 3200, 0, 108);\n \n CREATE TABLE IF NOT EXISTS `skillmacros` (\n   `id` int(11) NOT NULL AUTO_INCREMENT,"}, {"sha": "4355a482cb4e3e897392ab6a86333891bcec59ce", "filename": "sql/db_drops.sql", "status": "modified", "additions": 585, "deletions": 10, "changes": 595, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/sql/db_drops.sql", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/sql/db_drops.sql", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/sql/db_drops.sql?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -10626,7 +10626,8 @@\n (6130204, 1040107, 1, 1, 0, 700), \n (6130204, 1060095, 1, 1, 0, 700), \n (6130204, 1052119, 1, 1, 0, 700), \n-(6090001, 2384037, 1, 4, 0, 20000), \n+(6090001, 3010045, 1, 1, 0, 100000), \n+(6090001, 2384037, 1, 1, 0, 20000), \n (6300000, 4000049, 1, 1, 0, 200000), \n (9300258, 4000049, 1, 1, 0, 200000), \n (6300000, 4000021, 1, 1, 0, 200000), \n@@ -19154,14 +19155,60 @@\n (9300076, 4001082, 1, 1, 7302, 40000),\n (9300078, 4001080, 1, 1, 7302, 40000),\n (9300078, 4001081, 1, 1, 7302, 40000),\n-(9300078, 4001082, 1, 1, 7302, 40000);\n+(9300078, 4001082, 1, 1, 7302, 40000),\n+(6090000, 1032042, 1, 1, 0, 8000),\n+(6090000, 1122001, 1, 1, 0, 8000),\n+(6090000, 1112407, 1, 1, 0, 8000),\n+(6090000, 1302026, 1, 1, 0, 8000),\n+(6090000, 1442054, 1, 1, 0, 8000),\n+(6090001, 1032045, 1, 1, 0, 8000),\n+(6090001, 1122002, 1, 1, 0, 8000),\n+(6090001, 1112407, 1, 1, 0, 8000),\n+(6090001, 1302028, 1, 1, 0, 8000),\n+(6090001, 1442018, 1, 1, 0, 8000),\n+(6090002, 1032021, 1, 1, 0, 8000),\n+(6090002, 1122003, 1, 1, 0, 8000),\n+(6090002, 1112408, 1, 1, 0, 8000),\n+(6090002, 1302025, 1, 1, 0, 8000),\n+(6090002, 1442030, 1, 1, 0, 8000),\n+(6090003, 1032050, 1, 1, 0, 8000),\n+(6090003, 1122004, 1, 1, 0, 8000),\n+(6090003, 1112408, 1, 1, 0, 8000),\n+(6090003, 1302027, 1, 1, 0, 8000),\n+(6090003, 1442050, 1, 1, 0, 8000),\n+(6090004, 1032026, 1, 1, 0, 8000),\n+(6090004, 1122005, 1, 1, 0, 8000),\n+(6090004, 1112408, 1, 1, 0, 8000),\n+(6090004, 1302017, 1, 1, 0, 8000),\n+(6090004, 1442055, 1, 1, 0, 8000),\n+(5090000, 1032044, 1, 1, 0, 8000),\n+(5090000, 1122006, 1, 1, 0, 8000),\n+(5090000, 1112407, 1, 1, 0, 8000),\n+(5090000, 1302029, 1, 1, 0, 8000),\n+(5090000, 1442066, 1, 1, 0, 8000),\n+(5090001, 1092052, 1, 1, 0, 8000),\n+(5090001, 1102026, 1, 1, 0, 8000),\n+(5090001, 1052166, 1, 1, 0, 8000),\n+(5090001, 1082150, 1, 1, 0, 8000),\n+(5090001, 1132009, 1, 1, 0, 8000),\n+(6090000, 0, 1500, 2000, 0, 400000),\n+(6090001, 0, 700, 777, 0, 400000),\n+(6090002, 0, 1500, 1700, 0, 400000),\n+(6090003, 0, 600, 800, 0, 400000),\n+(6090004, 0, 1000, 1100, 0, 400000),\n+(5090000, 0, 800, 920, 0, 400000),\n+(5090001, 0, 1700, 1750, 0, 400000);\n \n # (dropperid, itemid, minqty, maxqty, questid, chance)\n \n   # delete item drops from other mobs named Freezer\n   DELETE FROM temp_data WHERE dropperid=9300090;\n   DELETE FROM temp_data WHERE dropperid=9420501;\n \n+  # delete item drops from clones of Pink Bean\n+  DELETE FROM temp_data WHERE dropperid=8820000;\n+  DELETE FROM temp_data WHERE dropperid>=8820010 AND dropperid<=8820014;\n+\n   # reinsert other Freezer's data\n   INSERT IGNORE INTO temp_data (`dropperid`, `itemid`, `minimum_quantity`, `maximum_quantity`, `questid`, `chance`) VALUES\n (9420501, 0, 92, 138, 0, 400000),\n@@ -19189,15 +19236,18 @@\n (9420501, 1072297, 1, 1, 0, 2000),\n (9420501, 1482001, 1, 1, 0, 2000),\n (9420501, 1482005, 1, 1, 0, 2000),\n-(9420501, 1492005, 1, 1, 0, 2000);\n-\n-  INSERT IGNORE INTO temp_data (`dropperid`, `itemid`, `minimum_quantity`, `maximum_quantity`, `questid`, `chance`) VALUES\n-(9300090, 0, 1500, 4000, 0, 400000),\n-(9300090, 4001114, 1, 1, 0, 400000);\n+(9420501, 1492005, 1, 1, 0, 2000),\n+(8820001, 2388043, 1, 1, 0, 24000);\n \n   # delete item drops from Seruf in inactive form\n   DELETE FROM temp_data WHERE dropperid=4220001;\n \n+  # delete item drops from summoned Slimes\n+  DELETE FROM temp_data WHERE dropperid=9500100;\n+\n+# delete item drops from Dojo summoned mobs\n+  DELETE FROM temp_data WHERE dropperid>=9300217 AND dropperid<=9300270;\n+\n   UPDATE IGNORE temp_data SET chance=700 WHERE itemid=1302056;\n \n   UPDATE IGNORE temp_data SET dropperid=9000002 WHERE dropperid=9000000;\n@@ -19249,7 +19299,6 @@\n   UPDATE drop_data SET chance=24000 WHERE (itemid >= 2388000 AND itemid < 2390000);\n \n   #update quest mob items\n-  UPDATE drop_data SET questid=8255 WHERE itemid=4032133;\n   UPDATE drop_data SET questid=3232 WHERE itemid=4031098;\n   UPDATE drop_data SET questid=3452 WHERE itemid=4001125;\n   UPDATE drop_data SET questid=28248 WHERE itemid=4001360;\n@@ -19285,16 +19334,534 @@\n   DELETE FROM drop_data WHERE dropperid >= 9300061 AND dropperid <= 9300064;\n   DELETE FROM drop_data WHERE dropperid >= 9300081 AND dropperid <= 9300083;\n \n+  # remove items being dropped from summoned mobs in PQs\n+\n+  DELETE FROM drop_data WHERE dropperid >= 9300015 AND dropperid <= 9300017;\n+  DELETE FROM drop_data WHERE dropperid >= 9300054 AND dropperid <= 9300056;\n+  DELETE FROM drop_data WHERE dropperid >= 9300143 AND dropperid <= 9300144;\n+  DELETE FROM drop_data WHERE dropperid >= 8810019 AND dropperid <= 8810023;\n+  DELETE FROM drop_data WHERE dropperid = 9500100;\n+\n   # remove key of dimension dropping outside PQ\n   DELETE FROM drop_data WHERE itemid=4001023 AND dropperid!=9300012;\n \n   # make Sword Earrings not drop by normal means, just like Shield Earrings\n   DELETE FROM drop_data WHERE itemid=1032030;\n \n-  # remove every not-card drop from bosses out of their natural habitat\n+  # remove every non-card drop from bosses out of their natural habitat\n   DELETE FROM drop_data WHERE dropperid >= 9300184 AND dropperid < 9300215 AND (itemid < 2380000 OR itemid >= 2390000);\n   DELETE FROM drop_data WHERE dropperid >= 9500337 AND dropperid < 9500364 AND (itemid < 2380000 OR itemid >= 2390000);\n \n+  # reinsert dojo loot\n+  INSERT IGNORE INTO drop_data (`dropperid`, `itemid`, `minimum_quantity`, `maximum_quantity`, `questid`, `chance`) VALUES\n+(9300184, 2022359, 1, 1, 0, 200000),\n+(9300184, 2022360, 1, 1, 0, 200000),\n+(9300184, 2022361, 1, 1, 0, 200000),\n+(9300184, 2022362, 1, 1, 0, 200000),\n+(9300184, 2022363, 1, 1, 0, 200000),\n+(9300184, 2022364, 1, 1, 0, 200000),\n+(9300184, 2022365, 1, 1, 0, 200000),\n+(9300184, 2022366, 1, 1, 0, 200000),\n+(9300184, 2022367, 1, 1, 0, 200000),\n+(9300185, 2022359, 1, 1, 0, 200000),\n+(9300185, 2022360, 1, 1, 0, 200000),\n+(9300185, 2022361, 1, 1, 0, 200000),\n+(9300185, 2022362, 1, 1, 0, 200000),\n+(9300185, 2022363, 1, 1, 0, 200000),\n+(9300185, 2022364, 1, 1, 0, 200000),\n+(9300185, 2022365, 1, 1, 0, 200000),\n+(9300185, 2022366, 1, 1, 0, 200000),\n+(9300185, 2022367, 1, 1, 0, 200000),\n+(9300186, 2022359, 1, 1, 0, 200000),\n+(9300186, 2022360, 1, 1, 0, 200000),\n+(9300186, 2022361, 1, 1, 0, 200000),\n+(9300186, 2022362, 1, 1, 0, 200000),\n+(9300186, 2022363, 1, 1, 0, 200000),\n+(9300186, 2022364, 1, 1, 0, 200000),\n+(9300186, 2022365, 1, 1, 0, 200000),\n+(9300186, 2022366, 1, 1, 0, 200000),\n+(9300186, 2022367, 1, 1, 0, 200000),\n+(9300187, 2022359, 1, 1, 0, 200000),\n+(9300187, 2022360, 1, 1, 0, 200000),\n+(9300187, 2022361, 1, 1, 0, 200000),\n+(9300187, 2022362, 1, 1, 0, 200000),\n+(9300187, 2022363, 1, 1, 0, 200000),\n+(9300187, 2022364, 1, 1, 0, 200000),\n+(9300187, 2022365, 1, 1, 0, 200000),\n+(9300187, 2022366, 1, 1, 0, 200000),\n+(9300187, 2022367, 1, 1, 0, 200000),\n+(9300188, 2022359, 1, 1, 0, 200000),\n+(9300188, 2022360, 1, 1, 0, 200000),\n+(9300188, 2022361, 1, 1, 0, 200000),\n+(9300188, 2022362, 1, 1, 0, 200000),\n+(9300188, 2022363, 1, 1, 0, 200000),\n+(9300188, 2022364, 1, 1, 0, 200000),\n+(9300188, 2022365, 1, 1, 0, 200000),\n+(9300188, 2022366, 1, 1, 0, 200000),\n+(9300188, 2022367, 1, 1, 0, 200000),\n+(9300189, 2022368, 1, 1, 0, 200000),\n+(9300189, 2022369, 1, 1, 0, 200000),\n+(9300189, 2022370, 1, 1, 0, 200000),\n+(9300189, 2022371, 1, 1, 0, 200000),\n+(9300189, 2022372, 1, 1, 0, 200000),\n+(9300189, 2022373, 1, 1, 0, 200000),\n+(9300189, 2022374, 1, 1, 0, 200000),\n+(9300189, 2022375, 1, 1, 0, 200000),\n+(9300189, 2022376, 1, 1, 0, 200000),\n+(9300190, 2022368, 1, 1, 0, 200000),\n+(9300190, 2022369, 1, 1, 0, 200000),\n+(9300190, 2022370, 1, 1, 0, 200000),\n+(9300190, 2022371, 1, 1, 0, 200000),\n+(9300190, 2022372, 1, 1, 0, 200000),\n+(9300190, 2022373, 1, 1, 0, 200000),\n+(9300190, 2022374, 1, 1, 0, 200000),\n+(9300190, 2022375, 1, 1, 0, 200000),\n+(9300190, 2022376, 1, 1, 0, 200000),\n+(9300191, 2022368, 1, 1, 0, 200000),\n+(9300191, 2022369, 1, 1, 0, 200000),\n+(9300191, 2022370, 1, 1, 0, 200000),\n+(9300191, 2022371, 1, 1, 0, 200000),\n+(9300191, 2022372, 1, 1, 0, 200000),\n+(9300191, 2022373, 1, 1, 0, 200000),\n+(9300191, 2022374, 1, 1, 0, 200000),\n+(9300191, 2022375, 1, 1, 0, 200000),\n+(9300191, 2022376, 1, 1, 0, 200000),\n+(9300192, 2022368, 1, 1, 0, 200000),\n+(9300192, 2022369, 1, 1, 0, 200000),\n+(9300192, 2022370, 1, 1, 0, 200000),\n+(9300192, 2022371, 1, 1, 0, 200000),\n+(9300192, 2022372, 1, 1, 0, 200000),\n+(9300192, 2022373, 1, 1, 0, 200000),\n+(9300192, 2022374, 1, 1, 0, 200000),\n+(9300192, 2022375, 1, 1, 0, 200000),\n+(9300192, 2022376, 1, 1, 0, 200000),\n+(9300193, 2022368, 1, 1, 0, 200000),\n+(9300193, 2022369, 1, 1, 0, 200000),\n+(9300193, 2022370, 1, 1, 0, 200000),\n+(9300193, 2022371, 1, 1, 0, 200000),\n+(9300193, 2022372, 1, 1, 0, 200000),\n+(9300193, 2022373, 1, 1, 0, 200000),\n+(9300193, 2022374, 1, 1, 0, 200000),\n+(9300193, 2022375, 1, 1, 0, 200000),\n+(9300193, 2022376, 1, 1, 0, 200000),\n+(9300194, 2022377, 1, 1, 0, 200000),\n+(9300194, 2022378, 1, 1, 0, 200000),\n+(9300194, 2022379, 1, 1, 0, 200000),\n+(9300194, 2022380, 1, 1, 0, 200000),\n+(9300194, 2022381, 1, 1, 0, 200000),\n+(9300194, 2022382, 1, 1, 0, 200000),\n+(9300194, 2022383, 1, 1, 0, 200000),\n+(9300194, 2022384, 1, 1, 0, 200000),\n+(9300194, 2022385, 1, 1, 0, 200000),\n+(9300195, 2022377, 1, 1, 0, 200000),\n+(9300195, 2022378, 1, 1, 0, 200000),\n+(9300195, 2022379, 1, 1, 0, 200000),\n+(9300195, 2022380, 1, 1, 0, 200000),\n+(9300195, 2022381, 1, 1, 0, 200000),\n+(9300195, 2022382, 1, 1, 0, 200000),\n+(9300195, 2022383, 1, 1, 0, 200000),\n+(9300195, 2022384, 1, 1, 0, 200000),\n+(9300195, 2022385, 1, 1, 0, 200000),\n+(9300196, 2022377, 1, 1, 0, 200000),\n+(9300196, 2022378, 1, 1, 0, 200000),\n+(9300196, 2022379, 1, 1, 0, 200000),\n+(9300196, 2022380, 1, 1, 0, 200000),\n+(9300196, 2022381, 1, 1, 0, 200000),\n+(9300196, 2022382, 1, 1, 0, 200000),\n+(9300196, 2022383, 1, 1, 0, 200000),\n+(9300196, 2022384, 1, 1, 0, 200000),\n+(9300196, 2022385, 1, 1, 0, 200000),\n+(9300197, 2022377, 1, 1, 0, 200000),\n+(9300197, 2022378, 1, 1, 0, 200000),\n+(9300197, 2022379, 1, 1, 0, 200000),\n+(9300197, 2022380, 1, 1, 0, 200000),\n+(9300197, 2022381, 1, 1, 0, 200000),\n+(9300197, 2022382, 1, 1, 0, 200000),\n+(9300197, 2022383, 1, 1, 0, 200000),\n+(9300197, 2022384, 1, 1, 0, 200000),\n+(9300197, 2022385, 1, 1, 0, 200000),\n+(9300198, 2022377, 1, 1, 0, 200000),\n+(9300198, 2022378, 1, 1, 0, 200000),\n+(9300198, 2022379, 1, 1, 0, 200000),\n+(9300198, 2022380, 1, 1, 0, 200000),\n+(9300198, 2022381, 1, 1, 0, 200000),\n+(9300198, 2022382, 1, 1, 0, 200000),\n+(9300198, 2022383, 1, 1, 0, 200000),\n+(9300198, 2022384, 1, 1, 0, 200000),\n+(9300198, 2022385, 1, 1, 0, 200000),\n+(9300199, 2022386, 1, 1, 0, 200000),\n+(9300199, 2022387, 1, 1, 0, 200000),\n+(9300199, 2022388, 1, 1, 0, 200000),\n+(9300199, 2022389, 1, 1, 0, 200000),\n+(9300199, 2022390, 1, 1, 0, 200000),\n+(9300199, 2022391, 1, 1, 0, 200000),\n+(9300199, 2022392, 1, 1, 0, 200000),\n+(9300199, 2022393, 1, 1, 0, 200000),\n+(9300199, 2022394, 1, 1, 0, 200000),\n+(9300200, 2022386, 1, 1, 0, 200000),\n+(9300200, 2022387, 1, 1, 0, 200000),\n+(9300200, 2022388, 1, 1, 0, 200000),\n+(9300200, 2022389, 1, 1, 0, 200000),\n+(9300200, 2022390, 1, 1, 0, 200000),\n+(9300200, 2022391, 1, 1, 0, 200000),\n+(9300200, 2022392, 1, 1, 0, 200000),\n+(9300200, 2022393, 1, 1, 0, 200000),\n+(9300200, 2022394, 1, 1, 0, 200000),\n+(9300201, 2022386, 1, 1, 0, 200000),\n+(9300201, 2022387, 1, 1, 0, 200000),\n+(9300201, 2022388, 1, 1, 0, 200000),\n+(9300201, 2022389, 1, 1, 0, 200000),\n+(9300201, 2022390, 1, 1, 0, 200000),\n+(9300201, 2022391, 1, 1, 0, 200000),\n+(9300201, 2022392, 1, 1, 0, 200000),\n+(9300201, 2022393, 1, 1, 0, 200000),\n+(9300201, 2022394, 1, 1, 0, 200000),\n+(9300202, 2022386, 1, 1, 0, 200000),\n+(9300202, 2022387, 1, 1, 0, 200000),\n+(9300202, 2022388, 1, 1, 0, 200000),\n+(9300202, 2022389, 1, 1, 0, 200000),\n+(9300202, 2022390, 1, 1, 0, 200000),\n+(9300202, 2022391, 1, 1, 0, 200000),\n+(9300202, 2022392, 1, 1, 0, 200000),\n+(9300202, 2022393, 1, 1, 0, 200000),\n+(9300202, 2022394, 1, 1, 0, 200000),\n+(9300203, 2022386, 1, 1, 0, 200000),\n+(9300203, 2022387, 1, 1, 0, 200000),\n+(9300203, 2022388, 1, 1, 0, 200000),\n+(9300203, 2022389, 1, 1, 0, 200000),\n+(9300203, 2022390, 1, 1, 0, 200000),\n+(9300203, 2022391, 1, 1, 0, 200000),\n+(9300203, 2022392, 1, 1, 0, 200000),\n+(9300203, 2022393, 1, 1, 0, 200000),\n+(9300203, 2022394, 1, 1, 0, 200000),\n+(9300204, 2022395, 1, 1, 0, 200000),\n+(9300204, 2022396, 1, 1, 0, 200000),\n+(9300204, 2022397, 1, 1, 0, 200000),\n+(9300204, 2022398, 1, 1, 0, 200000),\n+(9300204, 2022399, 1, 1, 0, 200000),\n+(9300204, 2022400, 1, 1, 0, 200000),\n+(9300204, 2022401, 1, 1, 0, 200000),\n+(9300204, 2022402, 1, 1, 0, 200000),\n+(9300204, 2022403, 1, 1, 0, 200000),\n+(9300205, 2022395, 1, 1, 0, 200000),\n+(9300205, 2022396, 1, 1, 0, 200000),\n+(9300205, 2022397, 1, 1, 0, 200000),\n+(9300205, 2022398, 1, 1, 0, 200000),\n+(9300205, 2022399, 1, 1, 0, 200000),\n+(9300205, 2022400, 1, 1, 0, 200000),\n+(9300205, 2022401, 1, 1, 0, 200000),\n+(9300205, 2022402, 1, 1, 0, 200000),\n+(9300205, 2022403, 1, 1, 0, 200000),\n+(9300206, 2022395, 1, 1, 0, 200000),\n+(9300206, 2022396, 1, 1, 0, 200000),\n+(9300206, 2022397, 1, 1, 0, 200000),\n+(9300206, 2022398, 1, 1, 0, 200000),\n+(9300206, 2022399, 1, 1, 0, 200000),\n+(9300206, 2022400, 1, 1, 0, 200000),\n+(9300206, 2022401, 1, 1, 0, 200000),\n+(9300206, 2022402, 1, 1, 0, 200000),\n+(9300206, 2022403, 1, 1, 0, 200000),\n+(9300207, 2022395, 1, 1, 0, 200000),\n+(9300207, 2022396, 1, 1, 0, 200000),\n+(9300207, 2022397, 1, 1, 0, 200000),\n+(9300207, 2022398, 1, 1, 0, 200000),\n+(9300207, 2022399, 1, 1, 0, 200000),\n+(9300207, 2022400, 1, 1, 0, 200000),\n+(9300207, 2022401, 1, 1, 0, 200000),\n+(9300207, 2022402, 1, 1, 0, 200000),\n+(9300207, 2022403, 1, 1, 0, 200000),\n+(9300208, 2022395, 1, 1, 0, 200000),\n+(9300208, 2022396, 1, 1, 0, 200000),\n+(9300208, 2022397, 1, 1, 0, 200000),\n+(9300208, 2022398, 1, 1, 0, 200000),\n+(9300208, 2022399, 1, 1, 0, 200000),\n+(9300208, 2022400, 1, 1, 0, 200000),\n+(9300208, 2022401, 1, 1, 0, 200000),\n+(9300208, 2022402, 1, 1, 0, 200000),\n+(9300208, 2022403, 1, 1, 0, 200000),\n+(9300209, 2022404, 1, 1, 0, 200000),\n+(9300209, 2022405, 1, 1, 0, 200000),\n+(9300209, 2022406, 1, 1, 0, 200000),\n+(9300209, 2022407, 1, 1, 0, 200000),\n+(9300209, 2022408, 1, 1, 0, 200000),\n+(9300209, 2022409, 1, 1, 0, 200000),\n+(9300209, 2022410, 1, 1, 0, 200000),\n+(9300209, 2022411, 1, 1, 0, 200000),\n+(9300209, 2022412, 1, 1, 0, 200000),\n+(9300210, 2022404, 1, 1, 0, 200000),\n+(9300210, 2022405, 1, 1, 0, 200000),\n+(9300210, 2022406, 1, 1, 0, 200000),\n+(9300210, 2022407, 1, 1, 0, 200000),\n+(9300210, 2022408, 1, 1, 0, 200000),\n+(9300210, 2022409, 1, 1, 0, 200000),\n+(9300210, 2022410, 1, 1, 0, 200000),\n+(9300210, 2022411, 1, 1, 0, 200000),\n+(9300210, 2022412, 1, 1, 0, 200000),\n+(9300211, 2022404, 1, 1, 0, 200000),\n+(9300211, 2022405, 1, 1, 0, 200000),\n+(9300211, 2022406, 1, 1, 0, 200000),\n+(9300211, 2022407, 1, 1, 0, 200000),\n+(9300211, 2022408, 1, 1, 0, 200000),\n+(9300211, 2022409, 1, 1, 0, 200000),\n+(9300211, 2022410, 1, 1, 0, 200000),\n+(9300211, 2022411, 1, 1, 0, 200000),\n+(9300211, 2022412, 1, 1, 0, 200000),\n+(9300212, 2022404, 1, 1, 0, 200000),\n+(9300212, 2022405, 1, 1, 0, 200000),\n+(9300212, 2022406, 1, 1, 0, 200000),\n+(9300212, 2022407, 1, 1, 0, 200000),\n+(9300212, 2022408, 1, 1, 0, 200000),\n+(9300212, 2022409, 1, 1, 0, 200000),\n+(9300212, 2022410, 1, 1, 0, 200000),\n+(9300212, 2022411, 1, 1, 0, 200000),\n+(9300212, 2022412, 1, 1, 0, 200000),\n+(9300213, 2022404, 1, 1, 0, 200000),\n+(9300213, 2022405, 1, 1, 0, 200000),\n+(9300213, 2022406, 1, 1, 0, 200000),\n+(9300213, 2022407, 1, 1, 0, 200000),\n+(9300213, 2022408, 1, 1, 0, 200000),\n+(9300213, 2022409, 1, 1, 0, 200000),\n+(9300213, 2022410, 1, 1, 0, 200000),\n+(9300213, 2022411, 1, 1, 0, 200000),\n+(9300213, 2022412, 1, 1, 0, 200000),\n+(9300214, 2022413, 1, 1, 0, 200000),\n+(9300214, 2022414, 1, 1, 0, 200000),\n+(9300214, 2022415, 1, 1, 0, 200000),\n+(9300214, 2022416, 1, 1, 0, 200000),\n+(9300214, 2022417, 1, 1, 0, 200000),\n+(9300214, 2022418, 1, 1, 0, 200000),\n+(9300214, 2022419, 1, 1, 0, 200000),\n+(9300214, 2022420, 1, 1, 0, 200000),\n+(9300214, 2022421, 1, 1, 0, 200000),\n+(9300215, 2022413, 1, 1, 0, 200000),\n+(9300215, 2022414, 1, 1, 0, 200000),\n+(9300215, 2022415, 1, 1, 0, 200000),\n+(9300215, 2022416, 1, 1, 0, 200000),\n+(9300215, 2022417, 1, 1, 0, 200000),\n+(9300215, 2022418, 1, 1, 0, 200000),\n+(9300215, 2022419, 1, 1, 0, 200000),\n+(9300215, 2022420, 1, 1, 0, 200000),\n+(9300215, 2022421, 1, 1, 0, 200000);\n+\n+  INSERT IGNORE INTO drop_data (`dropperid`, `itemid`, `minimum_quantity`, `maximum_quantity`, `questid`, `chance`) VALUES\n+(9300217, 2022430, 1, 1, 0, 200000),\n+(9300217, 2022431, 1, 1, 0, 200000),\n+(9300217, 2022432, 1, 1, 0, 200000),\n+(9300217, 2022433, 1, 1, 0, 200000),\n+(9300218, 2022430, 1, 1, 0, 200000),\n+(9300218, 2022431, 1, 1, 0, 200000),\n+(9300218, 2022432, 1, 1, 0, 200000),\n+(9300218, 2022433, 1, 1, 0, 200000),\n+(9300219, 2022430, 1, 1, 0, 200000),\n+(9300219, 2022431, 1, 1, 0, 200000),\n+(9300219, 2022432, 1, 1, 0, 200000),\n+(9300219, 2022433, 1, 1, 0, 200000),\n+(9300220, 2022430, 1, 1, 0, 200000),\n+(9300220, 2022431, 1, 1, 0, 200000),\n+(9300220, 2022432, 1, 1, 0, 200000),\n+(9300220, 2022433, 1, 1, 0, 200000),\n+(9300221, 2022430, 1, 1, 0, 200000),\n+(9300221, 2022431, 1, 1, 0, 200000),\n+(9300221, 2022432, 1, 1, 0, 200000),\n+(9300221, 2022433, 1, 1, 0, 200000),\n+(9300222, 2022430, 1, 1, 0, 200000),\n+(9300222, 2022431, 1, 1, 0, 200000),\n+(9300222, 2022432, 1, 1, 0, 200000),\n+(9300222, 2022433, 1, 1, 0, 200000),\n+(9300223, 2022430, 1, 1, 0, 200000),\n+(9300223, 2022431, 1, 1, 0, 200000),\n+(9300223, 2022432, 1, 1, 0, 200000),\n+(9300223, 2022433, 1, 1, 0, 200000),\n+(9300224, 2022430, 1, 1, 0, 200000),\n+(9300224, 2022431, 1, 1, 0, 200000),\n+(9300224, 2022432, 1, 1, 0, 200000),\n+(9300224, 2022433, 1, 1, 0, 200000),\n+(9300225, 2022430, 1, 1, 0, 200000),\n+(9300225, 2022431, 1, 1, 0, 200000),\n+(9300225, 2022432, 1, 1, 0, 200000),\n+(9300225, 2022433, 1, 1, 0, 200000),\n+(9300226, 2022430, 1, 1, 0, 200000),\n+(9300226, 2022431, 1, 1, 0, 200000),\n+(9300226, 2022432, 1, 1, 0, 200000),\n+(9300226, 2022433, 1, 1, 0, 200000),\n+(9300227, 2022430, 1, 1, 0, 200000),\n+(9300227, 2022431, 1, 1, 0, 200000),\n+(9300227, 2022432, 1, 1, 0, 200000),\n+(9300227, 2022433, 1, 1, 0, 200000),\n+(9300228, 2022430, 1, 1, 0, 200000),\n+(9300228, 2022431, 1, 1, 0, 200000),\n+(9300228, 2022432, 1, 1, 0, 200000),\n+(9300228, 2022433, 1, 1, 0, 200000),\n+(9300229, 2022430, 1, 1, 0, 200000),\n+(9300229, 2022431, 1, 1, 0, 200000),\n+(9300229, 2022432, 1, 1, 0, 200000),\n+(9300229, 2022433, 1, 1, 0, 200000),\n+(9300230, 2022430, 1, 1, 0, 200000),\n+(9300230, 2022431, 1, 1, 0, 200000),\n+(9300230, 2022432, 1, 1, 0, 200000),\n+(9300230, 2022433, 1, 1, 0, 200000),\n+(9300231, 2022430, 1, 1, 0, 200000),\n+(9300231, 2022431, 1, 1, 0, 200000),\n+(9300231, 2022432, 1, 1, 0, 200000),\n+(9300231, 2022433, 1, 1, 0, 200000),\n+(9300232, 2022430, 1, 1, 0, 200000),\n+(9300232, 2022431, 1, 1, 0, 200000),\n+(9300232, 2022432, 1, 1, 0, 200000),\n+(9300232, 2022433, 1, 1, 0, 200000),\n+(9300233, 2022430, 1, 1, 0, 200000),\n+(9300233, 2022431, 1, 1, 0, 200000),\n+(9300233, 2022432, 1, 1, 0, 200000),\n+(9300233, 2022433, 1, 1, 0, 200000),\n+(9300234, 2022430, 1, 1, 0, 200000),\n+(9300234, 2022431, 1, 1, 0, 200000),\n+(9300234, 2022432, 1, 1, 0, 200000),\n+(9300234, 2022433, 1, 1, 0, 200000),\n+(9300235, 2022430, 1, 1, 0, 200000),\n+(9300235, 2022431, 1, 1, 0, 200000),\n+(9300235, 2022432, 1, 1, 0, 200000),\n+(9300235, 2022433, 1, 1, 0, 200000),\n+(9300236, 2022430, 1, 1, 0, 200000),\n+(9300236, 2022431, 1, 1, 0, 200000),\n+(9300236, 2022432, 1, 1, 0, 200000),\n+(9300236, 2022433, 1, 1, 0, 200000),\n+(9300237, 2022430, 1, 1, 0, 200000),\n+(9300237, 2022431, 1, 1, 0, 200000),\n+(9300237, 2022432, 1, 1, 0, 200000),\n+(9300237, 2022433, 1, 1, 0, 200000),\n+(9300238, 2022430, 1, 1, 0, 200000),\n+(9300238, 2022431, 1, 1, 0, 200000),\n+(9300238, 2022432, 1, 1, 0, 200000),\n+(9300238, 2022433, 1, 1, 0, 200000),\n+(9300239, 2022430, 1, 1, 0, 200000),\n+(9300239, 2022431, 1, 1, 0, 200000),\n+(9300239, 2022432, 1, 1, 0, 200000),\n+(9300239, 2022433, 1, 1, 0, 200000),\n+(9300240, 2022430, 1, 1, 0, 200000),\n+(9300240, 2022431, 1, 1, 0, 200000),\n+(9300240, 2022432, 1, 1, 0, 200000),\n+(9300240, 2022433, 1, 1, 0, 200000),\n+(9300241, 2022430, 1, 1, 0, 200000),\n+(9300241, 2022431, 1, 1, 0, 200000),\n+(9300241, 2022432, 1, 1, 0, 200000),\n+(9300241, 2022433, 1, 1, 0, 200000),\n+(9300242, 2022430, 1, 1, 0, 200000),\n+(9300242, 2022431, 1, 1, 0, 200000),\n+(9300242, 2022432, 1, 1, 0, 200000),\n+(9300242, 2022433, 1, 1, 0, 200000),\n+(9300243, 2022430, 1, 1, 0, 200000),\n+(9300243, 2022431, 1, 1, 0, 200000),\n+(9300243, 2022432, 1, 1, 0, 200000),\n+(9300243, 2022433, 1, 1, 0, 200000),\n+(9300244, 2022430, 1, 1, 0, 200000),\n+(9300244, 2022431, 1, 1, 0, 200000),\n+(9300244, 2022432, 1, 1, 0, 200000),\n+(9300244, 2022433, 1, 1, 0, 200000),\n+(9300245, 2022430, 1, 1, 0, 200000),\n+(9300245, 2022431, 1, 1, 0, 200000),\n+(9300245, 2022432, 1, 1, 0, 200000),\n+(9300245, 2022433, 1, 1, 0, 200000),\n+(9300246, 2022430, 1, 1, 0, 200000),\n+(9300246, 2022431, 1, 1, 0, 200000),\n+(9300246, 2022432, 1, 1, 0, 200000),\n+(9300246, 2022433, 1, 1, 0, 200000),\n+(9300247, 2022430, 1, 1, 0, 200000),\n+(9300247, 2022431, 1, 1, 0, 200000),\n+(9300247, 2022432, 1, 1, 0, 200000),\n+(9300247, 2022433, 1, 1, 0, 200000),\n+(9300248, 2022430, 1, 1, 0, 200000),\n+(9300248, 2022431, 1, 1, 0, 200000),\n+(9300248, 2022432, 1, 1, 0, 200000),\n+(9300248, 2022433, 1, 1, 0, 200000),\n+(9300249, 2022430, 1, 1, 0, 200000),\n+(9300249, 2022431, 1, 1, 0, 200000),\n+(9300249, 2022432, 1, 1, 0, 200000),\n+(9300249, 2022433, 1, 1, 0, 200000),\n+(9300250, 2022430, 1, 1, 0, 200000),\n+(9300250, 2022431, 1, 1, 0, 200000),\n+(9300250, 2022432, 1, 1, 0, 200000),\n+(9300250, 2022433, 1, 1, 0, 200000),\n+(9300251, 2022430, 1, 1, 0, 200000),\n+(9300251, 2022431, 1, 1, 0, 200000),\n+(9300251, 2022432, 1, 1, 0, 200000),\n+(9300251, 2022433, 1, 1, 0, 200000),\n+(9300252, 2022430, 1, 1, 0, 200000),\n+(9300252, 2022431, 1, 1, 0, 200000),\n+(9300252, 2022432, 1, 1, 0, 200000),\n+(9300252, 2022433, 1, 1, 0, 200000),\n+(9300253, 2022430, 1, 1, 0, 200000),\n+(9300253, 2022431, 1, 1, 0, 200000),\n+(9300253, 2022432, 1, 1, 0, 200000),\n+(9300253, 2022433, 1, 1, 0, 200000),\n+(9300254, 2022430, 1, 1, 0, 200000),\n+(9300254, 2022431, 1, 1, 0, 200000),\n+(9300254, 2022432, 1, 1, 0, 200000),\n+(9300254, 2022433, 1, 1, 0, 200000),\n+(9300255, 2022430, 1, 1, 0, 200000),\n+(9300255, 2022431, 1, 1, 0, 200000),\n+(9300255, 2022432, 1, 1, 0, 200000),\n+(9300255, 2022433, 1, 1, 0, 200000),\n+(9300256, 2022430, 1, 1, 0, 200000),\n+(9300256, 2022431, 1, 1, 0, 200000),\n+(9300256, 2022432, 1, 1, 0, 200000),\n+(9300256, 2022433, 1, 1, 0, 200000),\n+(9300257, 2022430, 1, 1, 0, 200000),\n+(9300257, 2022431, 1, 1, 0, 200000),\n+(9300257, 2022432, 1, 1, 0, 200000),\n+(9300257, 2022433, 1, 1, 0, 200000),\n+(9300258, 2022430, 1, 1, 0, 200000),\n+(9300258, 2022431, 1, 1, 0, 200000),\n+(9300258, 2022432, 1, 1, 0, 200000),\n+(9300258, 2022433, 1, 1, 0, 200000),\n+(9300259, 2022430, 1, 1, 0, 200000),\n+(9300259, 2022431, 1, 1, 0, 200000),\n+(9300259, 2022432, 1, 1, 0, 200000),\n+(9300259, 2022433, 1, 1, 0, 200000),\n+(9300260, 2022430, 1, 1, 0, 200000),\n+(9300260, 2022431, 1, 1, 0, 200000),\n+(9300260, 2022432, 1, 1, 0, 200000),\n+(9300260, 2022433, 1, 1, 0, 200000),\n+(9300261, 2022430, 1, 1, 0, 200000),\n+(9300261, 2022431, 1, 1, 0, 200000),\n+(9300261, 2022432, 1, 1, 0, 200000),\n+(9300261, 2022433, 1, 1, 0, 200000),\n+(9300262, 2022430, 1, 1, 0, 200000),\n+(9300262, 2022431, 1, 1, 0, 200000),\n+(9300262, 2022432, 1, 1, 0, 200000),\n+(9300262, 2022433, 1, 1, 0, 200000),\n+(9300263, 2022430, 1, 1, 0, 200000),\n+(9300263, 2022431, 1, 1, 0, 200000),\n+(9300263, 2022432, 1, 1, 0, 200000),\n+(9300263, 2022433, 1, 1, 0, 200000),\n+(9300264, 2022430, 1, 1, 0, 200000),\n+(9300264, 2022431, 1, 1, 0, 200000),\n+(9300264, 2022432, 1, 1, 0, 200000),\n+(9300264, 2022433, 1, 1, 0, 200000),\n+(9300265, 2022430, 1, 1, 0, 200000),\n+(9300265, 2022431, 1, 1, 0, 200000),\n+(9300265, 2022432, 1, 1, 0, 200000),\n+(9300265, 2022433, 1, 1, 0, 200000),\n+(9300266, 2022430, 1, 1, 0, 200000),\n+(9300266, 2022431, 1, 1, 0, 200000),\n+(9300266, 2022432, 1, 1, 0, 200000),\n+(9300266, 2022433, 1, 1, 0, 200000),\n+(9300267, 2022430, 1, 1, 0, 200000),\n+(9300267, 2022431, 1, 1, 0, 200000),\n+(9300267, 2022432, 1, 1, 0, 200000),\n+(9300267, 2022433, 1, 1, 0, 200000),\n+(9300268, 2022430, 1, 1, 0, 200000),\n+(9300268, 2022431, 1, 1, 0, 200000),\n+(9300268, 2022432, 1, 1, 0, 200000),\n+(9300268, 2022433, 1, 1, 0, 200000),\n+(9300269, 2022430, 1, 1, 0, 200000),\n+(9300269, 2022431, 1, 1, 0, 200000),\n+(9300269, 2022432, 1, 1, 0, 200000),\n+(9300269, 2022433, 1, 1, 0, 200000),\n+(9300270, 2022430, 1, 1, 0, 200000),\n+(9300270, 2022431, 1, 1, 0, 200000),\n+(9300270, 2022432, 1, 1, 0, 200000),\n+(9300270, 2022433, 1, 1, 0, 200000),\n+(6090002, 4000414, 1, 1, 0, 400000);\n+\n   # update quest reactor items\n   UPDATE reactordrops SET questid=2086 WHERE itemid=4031165;\n   UPDATE reactordrops SET questid=3407 WHERE itemid=4031141;\n@@ -19463,7 +20030,15 @@\n     (2001013, 4001045, 1, -1),\n     (2001014, 4001045, 1, -1),\n     (2001015, 4001045, 1, -1),\n-    (2402006, 4001093, 1, -1);\n+    (2402006, 4001093, 1, -1),\n+    (6102002, 1102205, 50, -1),\n+    (6102003, 1102205, 50, -1),\n+    (6102004, 1102205, 50, -1),\n+    (6102005, 1102205, 50, -1),\n+    (6102002, 2022277, 5, -1),\n+    (6102003, 2022277, 5, -1),\n+    (6102004, 2022277, 5, -1),\n+    (6102005, 2022277, 5, -1);\n \n   # updates info for all cards on monster book\n   DROP TABLE `monstercarddata`;"}, {"sha": "081779f836e62b58cdca9a8cdfdccdc51af84892", "filename": "sql/db_shopupdate.sql", "status": "modified", "additions": 22, "deletions": 2, "changes": 24, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/sql/db_shopupdate.sql", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/sql/db_shopupdate.sql", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/sql/db_shopupdate.sql?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -4,8 +4,9 @@ UPDATE shopitems SET itemid=2120000, price=100 WHERE shopitemid=20;\n UPDATE shopitems SET itemid=1812000, price=1000 WHERE shopitemid=21;\n UPDATE shopitems SET itemid=1812001, price=1000 WHERE shopitemid=22;\n \n-# Scroll shop at Spindle\n+# Scroll shop at Spindle, chair shop at Kino Konoko\n INSERT INTO `shops` (`shopid`,`npcid`) VALUES\n+(9110002,9110002),\n (9201082,9201082);\n \n INSERT IGNORE INTO `shopitems` (`shopitemid`, `shopid`, `itemid`, `price`, `pitch`, `position`) VALUES\n@@ -81,4 +82,23 @@ INSERT IGNORE INTO `shopitems` (`shopitemid`, `shopid`, `itemid`, `price`, `pitc\n (994782, 9201082, 2030007, 1800000, 0, 70),\n (994783, 9201082, 4001017, 60000000, 0, 71);\n \n-UPDATE shopitems SET price = 11*price WHERE (`position` >= 27 and `position` <= 67 and `shopid` = 9201082);\n\\ No newline at end of file\n+UPDATE shopitems SET price = 11*price WHERE (`position` >= 27 and `position` <= 67 and `shopid` = 9201082);\n+\n+INSERT IGNORE INTO `shopitems` (`shopid`, `itemid`, `price`, `pitch`, `position`) VALUES\n+(9120002, 3010005, 5000, 0, 80),\n+(9120002, 3010004, 5000, 0, 84),\n+(9120002, 3010006, 5000, 0, 88),\n+(9120002, 3010003, 5000, 0, 92),\n+(9120002, 3010002, 5000, 0, 96),\n+(9120002, 2061003, 40, 0, 100),\n+(9201020, 3010011, 1200, 0, 92),\n+(9201020, 3010009, 4200, 0, 96),\n+(9201020, 3010014, 15000, 0, 100),\n+(1031100, 3010015, 20000, 0, 100),\n+(1081000, 3010013, 100000, 0, 100),\n+(9110002, 3010019, 200000, 0, 80),\n+(9110002, 3010017, 1000000, 0, 84),\n+(9110002, 3010016, 1000000, 0, 88),\n+(9110002, 3010008, 1000000, 0, 92),\n+(9110002, 3010007, 1000000, 0, 96),\n+(9110002, 3011000, 4200000, 0, 100);"}, {"sha": "a6c930aeda897ce49d4be7a9220a1dbcb40906f9", "filename": "src/client/MapleBuffStat.java", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/client/MapleBuffStat.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/client/MapleBuffStat.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/MapleBuffStat.java?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -41,9 +41,9 @@\n     HAMSTRING(0x800L),\n     BLIND(0x1000L),\n     CONCENTRATE(0x2000L),\n-     //4000L\n+    HPREC(0x4000L),\n     ECHO_OF_HERO(0x8000L),\n-    //10000L\n+    MPREC(0x10000L),\n     GHOST_MORPH(0x20000L),\n     AURA(0x40000L),\n     CONFUSE(0x80000L),\n@@ -63,7 +63,7 @@\n     BERSERK_FURY(0x8000000L),\n     DIVINE_BODY(0x10000000L),\n     SPARK(0x20000000L),\n-    //40000000L\n+    //0x40000000L\n     FINALATTACK(0x80000000L),\n     BATTLESHIP(0xA00000040L), // weird one\n     WATK(0x100000000L),"}, {"sha": "c233f8fef7bbb35925cedfdfe518b4208f6f1bbc", "filename": "src/client/MapleCharacter.java", "status": "modified", "additions": 518, "deletions": 223, "changes": 741, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/client/MapleCharacter.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/client/MapleCharacter.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/MapleCharacter.java?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -54,7 +54,6 @@\n \n import net.server.PlayerBuffValueHolder;\n import net.server.PlayerCoolDownValueHolder;\n-import net.server.PlayerDiseaseValueHolder;\n import net.server.Server;\n import net.server.channel.Channel;\n import net.server.guild.MapleAlliance;\n@@ -182,7 +181,6 @@\n     private int mapid;\n     private int gender;\n     private int currentPage, currentType = 0, currentTab = 1;\n-    private int chair;\n     private int itemEffect;\n     private int guildid, guildRank, allianceRank;\n     private int messengerposition = 4;\n@@ -202,7 +200,7 @@\n     private int expRate = 1, mesoRate = 1, dropRate = 1, expCoupon = 1, mesoCoupon = 1, dropCoupon = 1;\n     private int omokwins, omokties, omoklosses, matchcardwins, matchcardties, matchcardlosses;\n     private int married;\n-    private long dojoFinish, lastfametime, lastUsedCashItem, lastHealed, lastMesoDrop = -1, jailExpiration = -1;\n+    private long lastfametime, lastUsedCashItem, lastHealed, lastMesoDrop = -1, jailExpiration = -1;\n     private transient int localmaxhp, localmaxmp, localstr, localdex, localluk, localint_, magic, watk;\n     private boolean hidden, canDoor = true, Berserk, hasMerchant, whiteChat = false;\n     private int linkedLevel = 0;\n@@ -215,6 +213,7 @@\n     private AtomicInteger exp = new AtomicInteger();\n     private AtomicInteger gachaexp = new AtomicInteger();\n     private AtomicInteger meso = new AtomicInteger();\n+    private AtomicInteger chair = new AtomicInteger();\n     private int merchantmeso;\n     private BuddyList buddylist;\n     private EventInstanceManager eventInstance = null;\n@@ -224,7 +223,7 @@\n     private MaplePartyCharacter mpc = null;\n     private MapleInventory[] inventory;\n     private MapleJob job = MapleJob.BEGINNER;\n-    private MapleMap map, dojoMap;//Make a Dojo pq instance\n+    private MapleMap map;\n     private MapleMessenger messenger = null;\n     private MapleMiniGame miniGame;\n     private MapleMount maplemount;\n@@ -235,6 +234,9 @@\n     private MapleSkinColor skinColor = MapleSkinColor.NORMAL;\n     private MapleStorage storage = null;\n     private MapleTrade trade = null;\n+    private MonsterBook monsterbook;\n+    private MapleRing marriageRing;\n+    private CashShop cashshop;\n     private SavedLocation savedLocations[];\n     private SkillMacro[] skillMacros = new SkillMacro[5];\n     private List<Integer> lastmonthfameids;\n@@ -249,34 +251,32 @@\n     private Map<Integer, MapleKeyBinding> keymap = new LinkedHashMap<>();\n     private Map<Integer, MapleSummon> summons = new LinkedHashMap<>();\n     private Map<Integer, MapleCoolDownValueHolder> coolDowns = new LinkedHashMap<>(50);\n-    private EnumMap<MapleDisease, DiseaseValueHolder> diseases = new EnumMap<>(MapleDisease.class);\n+    private EnumMap<MapleDisease, MapleDiseaseValueHolder> diseases = new EnumMap<>(MapleDisease.class);\n     private Map<Integer, MapleDoor> doors = new LinkedHashMap<>();\n     private ScheduledFuture<?> dragonBloodSchedule;\n-    private ScheduledFuture<?> mapTimeLimitTask = null;\n     private ScheduledFuture<?>[] fullnessSchedule = new ScheduledFuture<?>[3];\n     private ScheduledFuture<?> hpDecreaseTask;\n     private ScheduledFuture<?> beholderHealingSchedule, beholderBuffSchedule, BerserkSchedule;\n     private ScheduledFuture<?> expiretask;\n-    private ScheduledFuture<?> recoveryTask;\n+    private ScheduledFuture<?> recoveryTask = null;\n+    private ScheduledFuture<?> extraRecoveryTask = null;\n+    private ScheduledFuture<?> chairRecoveryTask = null;\n+    private ScheduledFuture<?> pendantOfSpirit = null; //1122017\n     private List<ScheduledFuture<?>> timers = new ArrayList<>();\n-    private Lock couponLock = new ReentrantLock();\n+    private Lock chrLock = new ReentrantLock();\n     private NumberFormat nf = new DecimalFormat(\"#,###,###,###\");\n     private ArrayList<Integer> excluded = new ArrayList<>();\n-    private MonsterBook monsterbook;\n     private List<MapleRing> crushRings = new ArrayList<>();\n     private List<MapleRing> friendshipRings = new ArrayList<>();\n-    private MapleRing marriageRing;\n     private static String[] ariantroomleader = new String[3];\n     private static int[] ariantroomslot = new int[3];\n-    private CashShop cashshop;\n     private long portaldelay = 0, lastcombo = 0;\n     private short combocounter = 0;\n     private List<String> blockedPortals = new ArrayList<>();\n     private Map<Short, String> area_info = new LinkedHashMap<>();\n     private AutobanManager autoban;\n     private boolean isbanned = false;\n-    private ScheduledFuture<?> pendantOfSpirit = null; //1122017\n-    private byte pendantExp = 0, lastmobcount = 0;\n+    private byte pendantExp = 0, lastmobcount = 0, doorSlot = -1;\n     private List<Integer> trockmaps = new ArrayList<>();\n     private List<Integer> viptrockmaps = new ArrayList<>();\n     private Map<String, MapleEvents> events = new LinkedHashMap<>();\n@@ -290,6 +290,10 @@\n     private int newWarpMap = -1;\n     private boolean canWarpMap = true;  //only one \"warp\" must be used per call, and this will define the right one.\n     private int canWarpCounter = 0;     //counts how many times \"inner warps\" have been called.\n+    private byte extraHpRec = 0, extraMpRec = 0;\n+    private short extraRecInterval;\n+    private int targetHpBarHash = 0;\n+    private long targetHpBarTime = 0;\n \n     private MapleCharacter() {\n         useCS = false;\n@@ -456,7 +460,7 @@ public int addDojoPointsByMap() {\n         int pts = 0;\n         if (dojoPoints < 17000) {\n             pts = 1 + ((getMap().getId() - 1) / 100 % 100) / 6;\n-            if (!dojoParty) {\n+            if (!getDojoParty()) {\n                 pts++;\n             }\n             this.dojoPoints += pts;\n@@ -465,11 +469,21 @@ public int addDojoPointsByMap() {\n     }\n \n     public void addDoor(Integer owner, MapleDoor door) {\n-        doors.put(owner, door);\n+        chrLock.lock();\n+        try {\n+            doors.put(owner, door);\n+        } finally {\n+            chrLock.unlock();\n+        }\n     }\n     \n     public void removeDoor(Integer owner) {\n-        doors.remove(owner);\n+        chrLock.lock();\n+        try {\n+            doors.remove(owner);\n+        } finally {\n+            chrLock.unlock();\n+        }\n     }\n \n     public void addExcluded(int x) {\n@@ -699,9 +713,23 @@ public int calculateMaxBaseDamage(int watk) {\n \n     public void cancelAllBuffs(boolean disconnect) {\n         if (disconnect) {\n-            effects.clear();\n+            chrLock.lock();\n+            try {\n+                effects.clear();\n+            } finally {\n+                chrLock.unlock();\n+            }\n         } else {\n-            for (MapleBuffStatValueHolder mbsvh : new ArrayList<>(effects.values())) {\n+            List<MapleBuffStatValueHolder> mbsvhList;\n+            \n+            chrLock.lock();\n+            try {\n+                mbsvhList = new ArrayList<>(effects.values());\n+            } finally {\n+                chrLock.unlock();\n+            }\n+            \n+            for (MapleBuffStatValueHolder mbsvh : mbsvhList) {\n                 cancelEffect(mbsvh.effect, false, mbsvh.startTime);\n             }\n         }\n@@ -757,10 +785,15 @@ public void newClient(MapleClient c) {\n     }\n \n     public void cancelBuffEffects() {\n-        for (MapleBuffStatValueHolder mbsvh : effects.values()) {\n-            mbsvh.schedule.cancel(false);\n+        chrLock.lock();\n+        try {\n+            for (MapleBuffStatValueHolder mbsvh : effects.values()) {\n+                mbsvh.schedule.cancel(false);\n+            }\n+            this.effects.clear();\n+        } finally {\n+            chrLock.unlock();\n         }\n-        this.effects.clear();\n     }\n \n     public String getMedalText() {\n@@ -816,11 +849,16 @@ private void cancelEffect(MapleStatEffect effect, boolean overwrite, long startT\n             }\n         }\n         if (effect.isMagicDoor()) {\n-            MapleDoor destroyDoor = doors.remove(this.getId());\n+            MapleDoor destroyDoor;\n+                    \n+            chrLock.lock();\n+            try {\n+                destroyDoor = doors.remove(this.getId());\n+            } finally {\n+                chrLock.unlock();\n+            }\n             \n             if (destroyDoor != null) {\n-                destroyDoor.freeAllocatedPortal();\n-                \n                 destroyDoor.getTarget().removeMapObject(destroyDoor.getAreaDoor());\n                 destroyDoor.getTown().removeMapObject(destroyDoor.getTownDoor());\n                 \n@@ -864,7 +902,14 @@ private void cancelEffect(MapleStatEffect effect, boolean overwrite, long startT\n     }\n \n     public void cancelEffectFromBuffStat(MapleBuffStat stat) {\n-        MapleBuffStatValueHolder effect = effects.get(stat);\n+        MapleBuffStatValueHolder effect;\n+        \n+        chrLock.lock();\n+        try {\n+            effect = effects.get(stat);\n+        } finally {\n+            chrLock.unlock();\n+        }\n         if (effect != null) {\n             cancelEffect(effect.effect, false, -1);\n         }\n@@ -919,19 +964,22 @@ private void cancelFullnessSchedule(int petSlot) {\n     }\n \n     public void cancelMagicDoor() {\n-        for (MapleBuffStatValueHolder mbsvh : new ArrayList<>(effects.values())) {\n+        List<MapleBuffStatValueHolder> mbsvhList;\n+                \n+        chrLock.lock();\n+        try {\n+            mbsvhList = new ArrayList<>(effects.values());\n+        } finally {\n+            chrLock.unlock();\n+        }\n+        \n+        for (MapleBuffStatValueHolder mbsvh : mbsvhList) {\n             if (mbsvh.effect.isMagicDoor()) {\n                 cancelEffect(mbsvh.effect, false, mbsvh.startTime);\n             }\n         }\n     }\n \n-    public void cancelMapTimeLimitTask() {\n-        if (mapTimeLimitTask != null) {\n-            mapTimeLimitTask.cancel(false);\n-        }\n-    }\n-\n     private void cancelPlayerBuffs(List<MapleBuffStat> buffstats) {\n         if (client.getChannelServer().getPlayerStorage().getCharacterById(getId()) != null) {\n             recalcLocalStats();\n@@ -1198,7 +1246,6 @@ public void changeMap(MapleMap to) {\n         changeMap(to, to.getPortal(0));\n     }\n \n-    // not always the MapleMap target will be the map the player will be inserted, why would this even exist? Whatever.\n     public void changeMap(final MapleMap target, final MaplePortal pto) {\n         canWarpCounter++;\n         \n@@ -1223,21 +1270,26 @@ public void changeMap(final MapleMap target, final Point pos) {\n         if(canWarpCounter == 0) canWarpMap = true;\n     }\n     \n-    private boolean buffMapProtection() {    \n-        for(Entry<MapleBuffStat, MapleBuffStatValueHolder> mbs : effects.entrySet()) {\n-            if(mbs.getKey() == MapleBuffStat.MAP_PROTECTION) {\n-                byte value = (byte)mbs.getValue().value;\n-                MapleMap map = client.getChannelServer().getMapFactory().getMap(mapid);\n-                \n-                if(value == 1 && map.getReturnMapId() == 211000000) return(true);       //protection from cold\n-                else if(value == 2 && map.getReturnMapId() == 230000000) return(true);  //breathing underwater\n-                \n-                else return(false);\n-            }\n+    private boolean buffMapProtection() {\n+        chrLock.lock();\n+        try {\n+            MapleMap thisMap = client.getChannelServer().getMapFactory().getMap(mapid);\n+            \n+            for(Entry<MapleBuffStat, MapleBuffStatValueHolder> mbs : effects.entrySet()) {\n+                if(mbs.getKey() == MapleBuffStat.MAP_PROTECTION) {\n+                    byte value = (byte)mbs.getValue().value;\n+                    \n+                    if(value == 1 && thisMap.getReturnMapId() == 211000000) return true;       //protection from cold\n+                    else if(value == 2 && thisMap.getReturnMapId() == 230000000) return true;  //breathing underwater\n+                    else return false;\n+                }\n+            }    \n+        } finally {\n+            chrLock.unlock();\n         }\n         \n         for(Item it: this.getInventory(MapleInventoryType.EQUIPPED).list()) {\n-            if((it.getFlag() & ItemConstants.COLD) == ItemConstants.COLD && map.getReturnMapId() == 211000000) return(true);       //protection from cold\n+            if((it.getFlag() & ItemConstants.COLD) == ItemConstants.COLD && map.getReturnMapId() == 211000000) return true;       //protection from cold\n         }\n         \n         return false;\n@@ -1247,6 +1299,8 @@ private void changeMapInternal(final MapleMap to, final Point pos, final byte[]\n         if(!canWarpMap) return;\n         \n         this.closePlayerInteractions();\n+        this.resetPlayerAggro();\n+        \n         client.announce(warpPacket);\n         map.removePlayer(this);\n         if (client.getChannelServer().getPlayerStorage().getCharacterById(getId()) != null) {\n@@ -1800,54 +1854,152 @@ private void dropBuffStats(List<MapleBuffStatValueHolder> effectsToCancel) {\n     }\n     \n     private List<MapleBuffStatValueHolder> deregisterBuffStats(List<MapleBuffStat> stats) {\n-        List<MapleBuffStatValueHolder> effectsToCancel = new ArrayList<>(stats.size());\n-        for (MapleBuffStat stat : stats) {\n-            MapleBuffStatValueHolder mbsvh = effects.get(stat);\n-            if (mbsvh != null) {\n-                effects.remove(stat);\n-                boolean addMbsvh = true;\n-                for (MapleBuffStatValueHolder contained : effectsToCancel) {\n-                    if (mbsvh.startTime == contained.startTime && contained.effect == mbsvh.effect) {\n-                        addMbsvh = false;\n+        chrLock.lock();\n+        try {\n+            List<MapleBuffStatValueHolder> effectsToCancel = new ArrayList<>(stats.size());\n+            for (MapleBuffStat stat : stats) {\n+                MapleBuffStatValueHolder mbsvh = effects.get(stat);\n+                if (mbsvh != null) {\n+                    effects.remove(stat);\n+                    boolean addMbsvh = true;\n+                    for (MapleBuffStatValueHolder contained : effectsToCancel) {\n+                        if (mbsvh.startTime == contained.startTime && contained.effect == mbsvh.effect) {\n+                            addMbsvh = false;\n+                        }\n                     }\n-                }\n-                if (addMbsvh) {\n-                    effectsToCancel.add(mbsvh);\n-                }\n-                if (stat == MapleBuffStat.RECOVERY) {\n-                    if (recoveryTask != null) {\n-                        recoveryTask.cancel(false);\n-                        recoveryTask = null;\n+                    if (addMbsvh) {\n+                        effectsToCancel.add(mbsvh);\n                     }\n-                } else if (stat == MapleBuffStat.SUMMON || stat == MapleBuffStat.PUPPET) {\n-                    int summonId = mbsvh.effect.getSourceId();\n-\n-                    MapleSummon summon = summons.get(summonId);\n-                    if (summon != null) {\n-                        getMap().broadcastMessage(MaplePacketCreator.removeSummon(summon, true), summon.getPosition());\n-                        getMap().removeMapObject(summon);\n-                        removeVisibleMapObject(summon);\n-                        summons.remove(summonId);\n-                        \n-                        if (summon.getSkill() == DarkKnight.BEHOLDER) {\n-                            if (beholderHealingSchedule != null) {\n-                                beholderHealingSchedule.cancel(false);\n-                                beholderHealingSchedule = null;\n-                            }\n-                            if (beholderBuffSchedule != null) {\n-                                beholderBuffSchedule.cancel(false);\n-                                beholderBuffSchedule = null;\n+                    if (stat == MapleBuffStat.RECOVERY) {\n+                        if (recoveryTask != null) {\n+                            recoveryTask.cancel(false);\n+                            recoveryTask = null;\n+                        }\n+                    } else if (stat == MapleBuffStat.SUMMON || stat == MapleBuffStat.PUPPET) {\n+                        int summonId = mbsvh.effect.getSourceId();\n+\n+                        MapleSummon summon = summons.get(summonId);\n+                        if (summon != null) {\n+                            getMap().broadcastMessage(MaplePacketCreator.removeSummon(summon, true), summon.getPosition());\n+                            getMap().removeMapObject(summon);\n+                            removeVisibleMapObject(summon);\n+                            summons.remove(summonId);\n+\n+                            if (summon.getSkill() == DarkKnight.BEHOLDER) {\n+                                if (beholderHealingSchedule != null) {\n+                                    beholderHealingSchedule.cancel(false);\n+                                    beholderHealingSchedule = null;\n+                                }\n+                                if (beholderBuffSchedule != null) {\n+                                    beholderBuffSchedule.cancel(false);\n+                                    beholderBuffSchedule = null;\n+                                }\n                             }\n                         }\n+                    } else if (stat == MapleBuffStat.DRAGONBLOOD) {\n+                        dragonBloodSchedule.cancel(false);\n+                        dragonBloodSchedule = null;\n+                    } else if (stat == MapleBuffStat.HPREC || stat == MapleBuffStat.MPREC) {\n+                        if(stat == MapleBuffStat.HPREC) {\n+                            extraHpRec = 0;\n+                        } else {\n+                            extraMpRec = 0;\n+                        }\n+                        \n+                        if (extraRecoveryTask != null) {\n+                            extraRecoveryTask.cancel(false);\n+                            extraRecoveryTask = null;\n+                        }\n+                        \n+                        if(extraHpRec > 0 || extraMpRec > 0) {\n+                            startExtraTaskInternal(extraHpRec, extraMpRec, extraRecInterval);\n+                        }\n                     }\n-                } else if (stat == MapleBuffStat.DRAGONBLOOD) {\n-                    dragonBloodSchedule.cancel(false);\n-                    dragonBloodSchedule = null;\n                 }\n             }\n+\n+            return effectsToCancel;\n+        } finally {\n+            chrLock.unlock();\n+        }\n+    }\n+    \n+    public void stopChairTask() {\n+        chrLock.lock();\n+        try {\n+            if (chairRecoveryTask != null) {\n+                chairRecoveryTask.cancel(false);\n+                chairRecoveryTask = null;\n+            }\n+        } finally {\n+            chrLock.unlock();\n+        }\n+    }\n+    \n+    public void startChairTask() {\n+        if(!ServerConstants.USE_CHAIR_EXTRAHEAL || chair.get() == 0) return;\n+        \n+        final int healInterval = 5000;\n+        final byte healHP = (byte) Math.max(ServerConstants.CHAIR_EXTRA_HEAL_HP, 1);\n+        final byte healMP = (byte) Math.max(ServerConstants.CHAIR_EXTRA_HEAL_MP, 0);\n+        \n+        chrLock.lock();\n+        try {\n+            chairRecoveryTask = TimerManager.getInstance().register(new Runnable() {\n+                @Override\n+                public void run() {\n+                    if(hp < localmaxhp) {\n+                        client.announce(MaplePacketCreator.showOwnRecovery(healHP));\n+                        getMap().broadcastMessage(MapleCharacter.this, MaplePacketCreator.showRecovery(id, healHP), false);\n+                    }\n+\n+                    addHP(healHP);\n+                    addMP(healMP);\n+                }\n+            }, healInterval, healInterval);\n+        } finally {\n+            chrLock.unlock();\n+        }\n+    }\n+    \n+    private void stopExtraTask() {\n+        chrLock.lock();\n+        try {\n+            if (extraRecoveryTask != null) {\n+                extraRecoveryTask.cancel(false);\n+                extraRecoveryTask = null;\n+            }\n+        } finally {\n+            chrLock.unlock();\n+        }\n+    }\n+    \n+    private void startExtraTask(final byte healHP, final byte healMP, final short healInterval) {\n+        chrLock.lock();\n+        try {\n+            startExtraTaskInternal(healHP, healMP, healInterval);\n+        } finally {\n+            chrLock.unlock();\n         }\n+    }\n+    \n+    private void startExtraTaskInternal(final byte healHP, final byte healMP, final short healInterval) {\n+        extraRecInterval = healInterval;\n+\n+        extraRecoveryTask = TimerManager.getInstance().register(new Runnable() {\n+            @Override\n+            public void run() {\n+                if(hp < localmaxhp) {\n+                    if(healHP > 0) {\n+                        client.announce(MaplePacketCreator.showOwnRecovery(healHP));\n+                        getMap().broadcastMessage(MapleCharacter.this, MaplePacketCreator.showRecovery(id, healHP), false);\n+                    }\n+                }\n \n-        return effectsToCancel;\n+                addHP(healHP);\n+                addMP(healMP);\n+            }\n+        }, healInterval, healInterval);\n     }\n \n     public void disableDoor() {\n@@ -1872,50 +2024,63 @@ public void disbandGuild() {\n     }\n \n     public void dispel() {\n-        for (MapleBuffStatValueHolder mbsvh : new ArrayList<>(effects.values())) {\n+        List<MapleBuffStatValueHolder> mbsvhList;\n+        \n+        chrLock.lock();\n+        try {\n+            mbsvhList = new ArrayList<>(effects.values());\n+        } finally {\n+            chrLock.unlock();\n+        }\n+        \n+        for (MapleBuffStatValueHolder mbsvh : mbsvhList) {\n             if (mbsvh.effect.isSkill()) {\n                 cancelEffect(mbsvh.effect, false, mbsvh.startTime);\n             }\n         }\n     }\n \n-    public final List<PlayerDiseaseValueHolder> getAllDiseases() {\n-        final List<PlayerDiseaseValueHolder> ret = new ArrayList<>(5);\n-\n-        DiseaseValueHolder vh;\n-        for (Entry<MapleDisease, DiseaseValueHolder> disease : diseases.entrySet()) {\n-            vh = disease.getValue();\n-            ret.add(new PlayerDiseaseValueHolder(disease.getKey(), vh.startTime, vh.length));\n+    public final boolean hasDisease(final MapleDisease dis) {\n+        chrLock.lock();\n+        try {\n+            return diseases.containsKey(dis);\n+        } finally {\n+            chrLock.unlock();\n         }\n-        return ret;\n     }\n-\n-    public final boolean hasDisease(final MapleDisease dis) {\n-        for (final MapleDisease disease : diseases.keySet()) {\n-            if (disease == dis) {\n-                return true;\n-            }\n+    \n+    public final int getDiseasesSize() {\n+        chrLock.lock();\n+        try {\n+            return diseases.size();\n+        } finally {\n+            chrLock.unlock();\n         }\n-        return false;\n     }\n \n     public void giveDebuff(final MapleDisease disease, MobSkill skill) {\n-        final List<Pair<MapleDisease, Integer>> debuff = Collections.singletonList(new Pair<>(disease, Integer.valueOf(skill.getX())));\n-\n-        if (!hasDisease(disease) && diseases.size() < 2) {\n+        if (!hasDisease(disease) && getDiseasesSize() < 2) {\n             if (!(disease == MapleDisease.SEDUCE || disease == MapleDisease.STUN)) {\n                 if (isActiveBuffedValue(Bishop.HOLY_SHIELD)) {\n                     return;\n                 }\n             }\n+            \n             TimerManager.getInstance().schedule(new Runnable() {\n                 @Override\n                 public void run() {\n                     dispelDebuff(disease);\n                 }\n             }, skill.getDuration());\n \n-            diseases.put(disease, new DiseaseValueHolder(System.currentTimeMillis(), skill.getDuration()));\n+            chrLock.lock();\n+            try {\n+                diseases.put(disease, new MapleDiseaseValueHolder(System.currentTimeMillis(), skill.getDuration()));\n+            } finally {\n+                chrLock.unlock();\n+            }\n+            \n+            final List<Pair<MapleDisease, Integer>> debuff = Collections.singletonList(new Pair<>(disease, Integer.valueOf(skill.getX())));\n             client.announce(MaplePacketCreator.giveDebuff(debuff, skill));\n             map.broadcastMessage(this, MaplePacketCreator.giveForeignDebuff(id, debuff, skill), false);\n         }\n@@ -1927,7 +2092,12 @@ public void dispelDebuff(MapleDisease debuff) {\n             announce(MaplePacketCreator.cancelDebuff(mask));\n             map.broadcastMessage(this, MaplePacketCreator.cancelForeignDebuff(id, mask), false);\n \n-            diseases.remove(debuff);\n+            chrLock.lock();\n+            try {\n+                diseases.remove(debuff);\n+            } finally {\n+                chrLock.unlock();\n+            }\n         }\n     }\n \n@@ -1940,11 +2110,23 @@ public void dispelDebuffs() {\n     }\n \n     public void cancelAllDebuffs() {\n-        diseases.clear();\n+        chrLock.lock();\n+        try {\n+            diseases.clear();\n+        } finally {\n+            chrLock.unlock();\n+        }\n     }\n     \n     public void dispelSkill(int skillid) {\n-        LinkedList<MapleBuffStatValueHolder> allBuffs = new LinkedList<>(effects.values());\n+        LinkedList<MapleBuffStatValueHolder> allBuffs;\n+        chrLock.lock();\n+        try {\n+            allBuffs = new LinkedList<>(effects.values());\n+        } finally {\n+            chrLock.unlock();\n+        }\n+        \n         for (MapleBuffStatValueHolder mbsvh : allBuffs) {\n             if (skillid == 0) {\n                 if (mbsvh.effect.isSkill() && (mbsvh.effect.getSourceId() % 10000000 == 1004 || dispelSkills(mbsvh.effect.getSourceId()))) {\n@@ -2237,20 +2419,30 @@ public int getAccountID() {\n     }\n \n     public List<PlayerBuffValueHolder> getAllBuffs() {\n-        List<PlayerBuffValueHolder> ret = new ArrayList<>();\n-        for (MapleBuffStatValueHolder mbsvh : effects.values()) {\n-            ret.add(new PlayerBuffValueHolder(mbsvh.startTime, mbsvh.effect));\n+        chrLock.lock();\n+        try {\n+            List<PlayerBuffValueHolder> ret = new ArrayList<>();\n+            for (MapleBuffStatValueHolder mbsvh : effects.values()) {\n+                ret.add(new PlayerBuffValueHolder(mbsvh.startTime, mbsvh.effect));\n+            }\n+            return ret;\n+        } finally {\n+            chrLock.unlock();\n         }\n-        return ret;\n     }\n \n     public List<Pair<MapleBuffStat, Integer>> getAllStatups() {\n-        List<Pair<MapleBuffStat, Integer>> ret = new ArrayList<>();\n-        for (MapleBuffStat mbs : effects.keySet()) {\n-            MapleBuffStatValueHolder mbsvh = effects.get(mbs);\n-\t\t\tret.add(new Pair<>(mbs, mbsvh.value));\n+        chrLock.lock();\n+        try {\n+            List<Pair<MapleBuffStat, Integer>> ret = new ArrayList<>();\n+            for (MapleBuffStat mbs : effects.keySet()) {\n+                MapleBuffStatValueHolder mbsvh = effects.get(mbs);\n+                ret.add(new Pair<>(mbs, mbsvh.value));\n+            }\n+            return ret;\n+        } finally {\n+            chrLock.unlock();\n         }\n-        return ret;\n     }\n \n     public List<PlayerCoolDownValueHolder> getAllCooldowns() {\n@@ -2311,52 +2503,77 @@ public BuddyList getBuddylist() {\n     }\n \n     public Long getBuffedStarttime(MapleBuffStat effect) {\n-        MapleBuffStatValueHolder mbsvh = effects.get(effect);\n-        if (mbsvh == null) {\n-            return null;\n+        chrLock.lock();\n+        try {\n+            MapleBuffStatValueHolder mbsvh = effects.get(effect);\n+            if (mbsvh == null) {\n+                return null;\n+            }\n+            return Long.valueOf(mbsvh.startTime);\n+        } finally {\n+            chrLock.unlock();\n         }\n-        return Long.valueOf(mbsvh.startTime);\n     }\n \n     public Integer getBuffedValue(MapleBuffStat effect) {\n-        MapleBuffStatValueHolder mbsvh = effects.get(effect);\n-        if (mbsvh == null) {\n-            return null;\n+        chrLock.lock();\n+        try {\n+            MapleBuffStatValueHolder mbsvh = effects.get(effect);\n+            if (mbsvh == null) {\n+                return null;\n+            }\n+            return Integer.valueOf(mbsvh.value);\n+        } finally {\n+            chrLock.unlock();\n         }\n-        return Integer.valueOf(mbsvh.value);\n     }\n \n     public int getBuffSource(MapleBuffStat stat) {\n-        MapleBuffStatValueHolder mbsvh = effects.get(stat);\n-        if (mbsvh == null) {\n-            return -1;\n+        chrLock.lock();\n+        try {\n+            MapleBuffStatValueHolder mbsvh = effects.get(stat);\n+            if (mbsvh == null) {\n+                return -1;\n+            }\n+            return mbsvh.effect.getSourceId();\n+        } finally {\n+            chrLock.unlock();\n         }\n-        return mbsvh.effect.getSourceId();\n     }\n \n     public MapleStatEffect getBuffEffect(MapleBuffStat stat) {\n-        MapleBuffStatValueHolder mbsvh = effects.get(stat);\n-        if (mbsvh == null) {\n-            return null;\n-        } else {\n-            return mbsvh.effect;\n+        chrLock.lock();\n+        try {\n+            MapleBuffStatValueHolder mbsvh = effects.get(stat);\n+            if (mbsvh == null) {\n+                return null;\n+            } else {\n+                return mbsvh.effect;\n+            }\n+        } finally {\n+            chrLock.unlock();\n         }\n     }\n \n     private List<MapleBuffStat> getBuffStats(MapleStatEffect effect, long startTime) {\n-        List<MapleBuffStat> stats = new ArrayList<>();\n-        for (Entry<MapleBuffStat, MapleBuffStatValueHolder> stateffect : effects.entrySet()) {\n-            if(stateffect.getValue() == null) continue;\n-            \n-            if (stateffect.getValue().effect.sameSource(effect) && (startTime == -1 || startTime == stateffect.getValue().startTime)) {\n-                stats.add(stateffect.getKey());\n+        chrLock.lock();\n+        try {\n+            List<MapleBuffStat> stats = new ArrayList<>();\n+            for (Entry<MapleBuffStat, MapleBuffStatValueHolder> stateffect : effects.entrySet()) {\n+                if(stateffect.getValue() == null) continue;\n+\n+                if (stateffect.getValue().effect.sameSource(effect) && (startTime == -1 || startTime == stateffect.getValue().startTime)) {\n+                    stats.add(stateffect.getKey());\n+                }\n             }\n+            return stats;\n+        } finally {\n+            chrLock.unlock();\n         }\n-        return stats;\n     }\n \n     public int getChair() {\n-        return chair;\n+        return chair.get();\n     }\n \n     public String getChalkboard() {\n@@ -2422,7 +2639,7 @@ public int getDojoEnergy() {\n     }\n \n     public boolean getDojoParty() {\n-        return dojoParty;\n+        return mapid >= 925030100 && mapid < 925040000;\n     }\n \n     public int getDojoPoints() {\n@@ -2434,7 +2651,12 @@ public int getDojoStage() {\n     }\n \n     public Map<Integer, MapleDoor> getDoors() {\n-        return Collections.unmodifiableMap(doors);\n+        chrLock.lock();\n+        try {\n+            return Collections.unmodifiableMap(doors);\n+        } finally {\n+            chrLock.unlock();\n+        }\n     }\n \n     public int getEnergyBar() {\n@@ -2788,6 +3010,40 @@ public MaplePartyCharacter getMPC() {\n     public void setMPC(MaplePartyCharacter mpc) {\n         this.mpc = mpc;\n     }\n+    \n+    public int getTargetHpBarHash() {\n+        return this.targetHpBarHash;\n+    }\n+    \n+    public void setTargetHpBarHash(int mobHash) {\n+        this.targetHpBarHash = mobHash;\n+    }\n+    \n+    public long getTargetHpBarTime() {\n+        return this.targetHpBarTime;\n+    }\n+    \n+    public void setTargetHpBarTime(long timeNow) {\n+        this.targetHpBarTime = timeNow;\n+    }\n+    \n+    public void setPlayerAggro(int mobHash) {\n+        setTargetHpBarHash(mobHash);\n+        setTargetHpBarTime(System.currentTimeMillis());\n+    }\n+    \n+    public void resetPlayerAggro() {\n+        setTargetHpBarHash(0);\n+        setTargetHpBarTime(0);\n+    }\n+    \n+    public int getDoorSlot() {\n+        if(doorSlot == -1) {\n+            doorSlot = (party == null) ? 0 : party.getPartyDoor(this.getId());\n+        }\n+        \n+        return doorSlot;\n+    }\n \n     public MapleMiniGame getMiniGame() {\n         return miniGame;\n@@ -3207,11 +3463,16 @@ public final int getStartedQuestsSize() {\n     }\n \n     public MapleStatEffect getStatForBuff(MapleBuffStat effect) {\n-        MapleBuffStatValueHolder mbsvh = effects.get(effect);\n-        if (mbsvh == null) {\n-            return null;\n+        chrLock.lock();\n+        try {\n+            MapleBuffStatValueHolder mbsvh = effects.get(effect);\n+            if (mbsvh == null) {\n+                return null;\n+            }\n+            return mbsvh.effect;\n+        } finally {\n+            chrLock.unlock();\n         }\n-        return mbsvh.effect;\n     }\n \n     public MapleStorage getStorage() {\n@@ -3422,7 +3683,15 @@ public void increaseGuildCapacity() { //hopefully nothing is null\n     }\n \n     public boolean isActiveBuffedValue(int skillid) {\n-        LinkedList<MapleBuffStatValueHolder> allBuffs = new LinkedList<>(effects.values());\n+        LinkedList<MapleBuffStatValueHolder> allBuffs;\n+        \n+        chrLock.lock();\n+        try {\n+            allBuffs = new LinkedList<>(effects.values());\n+        } finally {\n+            chrLock.unlock();\n+        }\n+        \n         for (MapleBuffStatValueHolder mbsvh : allBuffs) {\n             if (mbsvh.effect.isSkill() && mbsvh.effect.getSourceId() == skillid) {\n                 return true;\n@@ -3436,11 +3705,16 @@ public boolean isAlive() {\n     }\n \n     public boolean isBuffFrom(MapleBuffStat stat, Skill skill) {\n-        MapleBuffStatValueHolder mbsvh = effects.get(stat);\n-        if (mbsvh == null) {\n-            return false;\n+        chrLock.lock();\n+        try {\n+            MapleBuffStatValueHolder mbsvh = effects.get(stat);\n+            if (mbsvh == null) {\n+                return false;\n+            }\n+            return mbsvh.effect.isSkill() && mbsvh.effect.getSourceId() == skill.getId();\n+        } finally {\n+            chrLock.unlock();\n         }\n-        return mbsvh.effect.isSkill() && mbsvh.effect.getSourceId() == skill.getId();\n     }\n \n     public boolean isCygnus() {\n@@ -3456,7 +3730,7 @@ public boolean isBeginnerJob() {\n     }\n \n     public boolean isGM() {\n-        return gmLevel > 0;\n+        return gmLevel > 1;\n     }\n \n     public boolean isHidden() {\n@@ -3478,9 +3752,7 @@ public boolean isGuildLeader() {    // true on guild master or jr. master\n     public void leaveMap() {\n         controlled.clear();\n         visibleMapObjects.clear();\n-        if (chair != 0) {\n-            chair = 0;\n-        }\n+        chair.set(0);\n         if (hpDecreaseTask != null) {\n             hpDecreaseTask.cancel(false);\n         }\n@@ -3672,7 +3944,7 @@ private void levelUpMessages() {\n         } else if (level == 85) {\n             yellowMessage(\"Did you know? The majority of people who hit level 85 in Solaxia don't live to be 85 years old?\");\n         } else if (level == 90) {\n-            yellowMessage(\"Hey do you like the amusement park? I heard Spooky Wood is the best theme park around. I heard they sell cute teddy-bears.\");\n+            yellowMessage(\"Hey do you like the amusement park? I heard Spooky World is the best theme park around. I heard they sell cute teddy-bears.\");\n         } else if (level == 95) {\n             yellowMessage(\"100% of people who hit level 95 in Solaxia don't live to be 95 years old.\");\n         } else if (level == 100) {\n@@ -3762,13 +4034,8 @@ private void revertCouponRates() {\n     }\n     \n     public void updateCouponRates() {\n-        try {\n-            couponLock.lock();\n-            revertCouponRates();\n-            setCouponRates();\n-        } finally {\n-            couponLock.unlock();\n-        }\n+        revertCouponRates();\n+        setCouponRates();\n     }\n     \n     public void resetPlayerRates() {\n@@ -3855,22 +4122,27 @@ private void activateCouponsEffects() {\n     }\n     \n     private void setActiveCoupons() {\n-        activeCoupons.clear();\n-        activeCouponRates.clear();\n-        \n-        Map<Integer, Integer> coupons = Server.getInstance().getCouponRates();\n-        List<Integer> active = Server.getInstance().getActiveCoupons();\n-        \n-        for(Item it: this.getInventory(MapleInventoryType.CASH).list()) {\n-            if(MapleItemInformationProvider.getInstance().isRateCoupon(it.getItemId()) && active.contains(it.getItemId())) {\n-                Integer count = activeCoupons.get(it.getItemId());\n-                \n-                if(count != null) activeCoupons.put(it.getItemId(), count + 1);\n-                else {\n-                    activeCoupons.put(it.getItemId(), 1);\n-                    activeCouponRates.put(it.getItemId(), coupons.get(it.getItemId()));\n+        chrLock.lock();\n+        try {\n+            activeCoupons.clear();\n+            activeCouponRates.clear();\n+\n+            Map<Integer, Integer> coupons = Server.getInstance().getCouponRates();\n+            List<Integer> active = Server.getInstance().getActiveCoupons();\n+\n+            for(Item it: this.getInventory(MapleInventoryType.CASH).list()) {\n+                if(MapleItemInformationProvider.getInstance().isRateCoupon(it.getItemId()) && active.contains(it.getItemId())) {\n+                    Integer count = activeCoupons.get(it.getItemId());\n+\n+                    if(count != null) activeCoupons.put(it.getItemId(), count + 1);\n+                    else {\n+                        activeCoupons.put(it.getItemId(), 1);\n+                        activeCouponRates.put(it.getItemId(), coupons.get(it.getItemId()));\n+                    }\n                 }\n             }\n+        } finally {\n+            chrLock.unlock();\n         }\n     }\n     \n@@ -3882,7 +4154,15 @@ private void commitBuffCoupon(int couponid) {\n     }\n     \n     public void dispelBuffCoupons() {\n-        LinkedList<MapleBuffStatValueHolder> allBuffs = new LinkedList<>(effects.values());\n+        LinkedList<MapleBuffStatValueHolder> allBuffs;\n+        \n+        chrLock.lock();\n+        try {\n+            allBuffs = new LinkedList<>(effects.values());\n+        } finally {\n+            chrLock.unlock();\n+        }\n+        \n         MapleItemInformationProvider ii = MapleItemInformationProvider.getInstance();\n         \n         for (MapleBuffStatValueHolder mbsvh : allBuffs) {\n@@ -4431,7 +4711,7 @@ private void playerDead() {\n             cancelEffectFromBuffStat(MapleBuffStat.MONSTER_RIDING);\n         }\n \n-        if (getChair() == -1) {\n+        if (getChair() != 0) {\n             setChair(0);\n             client.announce(MaplePacketCreator.cancelChair(-1));\n             getMap().broadcastMessage(this, MaplePacketCreator.showChair(getId(), 0), false);\n@@ -4646,17 +4926,40 @@ public void run() {\n                     getMap().broadcastMessage(MapleCharacter.this, MaplePacketCreator.showRecovery(id, heal), false);\n                 }\n             }, healInterval, healInterval);\n+        } else if (effect.isDojoBuff()) {\n+            boolean isRecoveryBuff = false;\n+            if(effect.getHpRRate() > 0) {\n+                extraHpRec = effect.getHpR();\n+                extraRecInterval = effect.getHpRRate();\n+                isRecoveryBuff = true;\n+            }\n+            \n+            if(effect.getMpRRate() > 0) {\n+                extraMpRec = effect.getMpR();\n+                extraRecInterval = effect.getMpRRate();\n+                isRecoveryBuff = true;\n+            }\n+                \n+            if(isRecoveryBuff) {\n+                stopExtraTask();\n+                startExtraTask(extraHpRec, extraMpRec, extraRecInterval);   // HP & MP sharing the same task holder\n+            }\n         }\n         \n-        //is it possible to maintain a list of statup effects of the same type concurrently? Pair<MapleBuffStat, Itemid>\n-        for (Pair<MapleBuffStat, Integer> statup : effect.getStatups()) {\n-            effects.put(statup.getLeft(), new MapleBuffStatValueHolder(effect, starttime, schedule, statup.getRight()));\n+        chrLock.lock();\n+        try {\n+            for (Pair<MapleBuffStat, Integer> statup : effect.getStatups()) {\n+                effects.put(statup.getLeft(), new MapleBuffStatValueHolder(effect, starttime, schedule, statup.getRight()));\n+            }\n+        } finally {\n+            chrLock.unlock();\n         }\n+        \n         recalcLocalStats();\n     }\n \n     public void removeAllCooldownsExcept(int id, boolean packet) {\n-        for (MapleCoolDownValueHolder mcvh : coolDowns.values()) {\n+        for (MapleCoolDownValueHolder mcvh : Collections.unmodifiableCollection(coolDowns.values())) {\n             if (mcvh.skillId != id) {\n                 coolDowns.remove(mcvh.skillId);\n                 if (packet) {\n@@ -5274,15 +5577,20 @@ public void setBuddyCapacity(int capacity) {\n     }\n \n     public void setBuffedValue(MapleBuffStat effect, int value) {\n-        MapleBuffStatValueHolder mbsvh = effects.get(effect);\n-        if (mbsvh == null) {\n-            return;\n+        chrLock.lock();\n+        try {\n+            MapleBuffStatValueHolder mbsvh = effects.get(effect);\n+            if (mbsvh == null) {\n+                return;\n+            }\n+            mbsvh.value = value;\n+        } finally {\n+            chrLock.unlock();\n         }\n-        mbsvh.value = value;\n     }\n \n     public void setChair(int chair) {\n-        this.chair = chair;\n+        this.chair.set(chair);\n     }\n \n     public void setChalkboard(String text) {\n@@ -5298,10 +5606,6 @@ public void setDojoEnergy(int x) {\n         this.dojoEnergy = x;\n     }\n \n-    public void setDojoParty(boolean b) {\n-        this.dojoParty = b;\n-    }\n-\n     public void setDojoPoints(int x) {\n         this.dojoPoints = x;\n     }\n@@ -5310,12 +5614,6 @@ public void setDojoStage(int x) {\n         this.dojoStage = x;\n     }\n \n-    public void setDojoStart() {\n-        this.dojoMap = map;\n-        int stage = (map.getId() / 100) % 100;\n-        this.dojoFinish = System.currentTimeMillis() + (stage > 36 ? 15 : stage / 6 + 5) * 60000;\n-    }\n-\n     public void setEnergyBar(int set) {\n         energybar = set;\n     }\n@@ -5597,8 +5895,13 @@ public void changeName(String name) {\n     public void setParty(MapleParty party) {\n         if (party == null) {\n             this.mpc = null;\n+            doorSlot = -1;\n+            \n+            this.party = null;\n+            //cancelMagicDoor();  // cancel magic doors if kicked out / quitted from party.\n+        } else {\n+            this.party = party;\n         }\n-        this.party = party;\n     }\n \n     public void setPlayerShop(MaplePlayerShop playerShop) {\n@@ -5749,31 +6052,20 @@ public void shiftPetsRight() {\n         }\n     }\n \n+    private long getDojoTimeLeft() {\n+        return client.getChannelServer().getDojoFinishTime(map.getId()) - System.currentTimeMillis();\n+    }\n+    \n     public void showDojoClock() {\n-        int stage = (map.getId() / 100) % 100;\n-        long time;\n-        if (stage % 6 == 1) {\n-            time = (stage > 36 ? 15 : stage / 6 + 5) * 60;\n-        } else {\n-            time = (dojoFinish - System.currentTimeMillis()) / 1000;\n-        }\n-        if (stage % 6 > 0) {\n-            client.announce(MaplePacketCreator.getClock((int) time));\n+        if (map.isDojoFightMap()) {\n+            client.announce(MaplePacketCreator.getClock((int) (getDojoTimeLeft() / 1000)));\n         }\n-        boolean rightmap = true;\n-        int clockid = (dojoMap.getId() / 100) % 100;\n-        if (map.getId() > clockid / 6 * 6 + 6 || map.getId() < clockid / 6 * 6) {\n-            rightmap = false;\n+    }\n+    \n+    public void timeoutFromDojo() {\n+        if(map.isDojoMap()) {\n+            client.getPlayer().changeMap(client.getChannelServer().getMapFactory().getMap(925020000));\n         }\n-        final boolean rightMap = rightmap; // lol\n-        TimerManager.getInstance().schedule(new Runnable() {\n-            @Override\n-            public void run() {\n-                if (rightMap) {\n-                    client.getPlayer().changeMap(client.getChannelServer().getMapFactory().getMap(925020000));\n-                }\n-            }\n-        }, time * 1000 + 3000); // let the TIMES UP display for 3 seconds, then warp\n     }\n \n     public void showNote() {\n@@ -6042,7 +6334,7 @@ public void sendDestroyData(MapleClient client) {\n \n     @Override\n     public void sendSpawnData(MapleClient client) {\n-        if (!this.isHidden() || client.getPlayer().gmLevel() > 0) {\n+        if (!this.isHidden() || client.getPlayer().gmLevel() > 1) {\n             client.announce(MaplePacketCreator.spawnPlayerMapobject(this));\n         }\n \n@@ -6407,6 +6699,9 @@ public final void empty(final boolean remove) {\n         if (recoveryTask != null) {\n             recoveryTask.cancel(false);\n         }\n+        if (extraRecoveryTask != null) {\n+            extraRecoveryTask.cancel(false);\n+        }\n         cancelExpirationTask();\n         for (ScheduledFuture<?> sf : timers) {\n             sf.cancel(false);"}, {"sha": "5b316c2782bff337b346edc4758e68c4ed093bfa", "filename": "src/client/MapleClient.java", "status": "modified", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/client/MapleClient.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/client/MapleClient.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/MapleClient.java?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -69,6 +69,7 @@\n import scripting.quest.QuestScriptManager;\n import server.MapleMiniGame;\n import server.MaplePlayerShop;\n+import server.life.MapleMonster;\n import server.MapleTrade;\n import server.TimerManager;\n import server.maps.*;\n@@ -1165,6 +1166,25 @@ public void setGender(byte m) {\n                     e.printStackTrace();\n \t\t}\n \t}\n+        \n+        public synchronized void announceBossHpBar(MapleMonster mm, final int mobHash, final byte[] packet) {\n+                long timeNow = System.currentTimeMillis();\n+                int targetHash = player.getTargetHpBarHash();\n+                \n+                if(mobHash != targetHash) {\n+                        if(timeNow - player.getTargetHpBarTime() >= 5 * 1000) {\n+                                // is there a way to INTERRUPT this annoying thread running on the client that drops the boss bar after some time at every attack?\n+                                announce(packet);\n+                                \n+                                player.setTargetHpBarHash(mobHash);\n+                                player.setTargetHpBarTime(timeNow);\n+                        }\n+                } else {\n+                        announce(packet);\n+                        \n+                        player.setTargetHpBarTime(timeNow);\n+                }\n+\t}\n \n \tpublic synchronized void announce(final byte[] packet) {//MINA CORE IS A FUCKING BITCH AND I HATE IT <3\n \t\tsession.write(packet);"}, {"sha": "a7feab5530568acd276918480fbaf0df6b7692ed", "filename": "src/client/MapleDiseaseValueHolder.java", "status": "added", "additions": 34, "deletions": 0, "changes": 34, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/client/MapleDiseaseValueHolder.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/client/MapleDiseaseValueHolder.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/MapleDiseaseValueHolder.java?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -0,0 +1,34 @@\n+/*\n+\tThis file is part of the OdinMS Maple Story Server\n+    Copyright (C) 2008 ~ 2010 Patrick Huy <patrick.huy@frz.cc> \n+                       Matthias Butz <matze@odinms.de>\n+                       Jan Christian Meyer <vimes@odinms.de>\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License version 3\n+    as published by the Free Software Foundation. You may not use, modify\n+    or distribute this program under any other version of the\n+    GNU Affero General Public License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+package client;\n+\n+/**\n+ *\n+ * @author anybody can do this\n+ */\n+public class MapleDiseaseValueHolder {\n+    public long startTime, length;\n+    \n+    public MapleDiseaseValueHolder(long start, long length) {\n+        this.startTime = start;\n+        this.length = length;\n+    }\n+}"}, {"sha": "097df28cb1c2c0bba6e2b3aeb8452ece94ffb050", "filename": "src/client/command/Commands.java", "status": "modified", "additions": 1269, "deletions": 1005, "changes": 2274, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/client/command/Commands.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/client/command/Commands.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/Commands.java?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91"}, {"sha": "1d6201c68a220fd5e3a9aee7b5a90ea171fda281", "filename": "src/client/inventory/ItemFactory.java", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/client/inventory/ItemFactory.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/client/inventory/ItemFactory.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/inventory/ItemFactory.java?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -134,9 +134,9 @@ public int getValue() {\n     public synchronized void saveItems(List<Pair<Item, MapleInventoryType>> items, int id, Connection con) throws SQLException {\n         PreparedStatement ps = null;\n         PreparedStatement pse = null;\n-\t\tResultSet rs = null;\n-\t\t\n-\t\tlock.lock();\n+        ResultSet rs = null;\n+\n+        lock.lock();\n \t\t\n         try {\n             StringBuilder query = new StringBuilder();"}, {"sha": "a5886d556709284c8debcc1b0712e477159fb3dc", "filename": "src/client/inventory/MapleInventory.java", "status": "modified", "additions": 74, "deletions": 19, "changes": 93, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/client/inventory/MapleInventory.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/client/inventory/MapleInventory.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/inventory/MapleInventory.java?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -27,16 +27,19 @@\n import java.util.Iterator;\n import java.util.LinkedHashMap;\n import java.util.List;\n+import java.util.Map.Entry;\n import java.util.Map;\n \n import tools.Pair;\n import client.MapleCharacter;\n+import client.MapleClient;\n import constants.ItemConstants;\n import server.MapleItemInformationProvider;\n+import server.MapleInventoryManipulator;\n \n /**\n  *\n- * @author Matze\n+ * @author Matze, Ronan\n  */\n public class MapleInventory implements Iterable<Item> {\n     private MapleCharacter owner;\n@@ -101,6 +104,37 @@ public int countById(int itemId) {\n         }\n         return qty;\n     }\n+    \n+    public int freeSlotCountById(int itemId, int required) {\n+        List<Item> itemList = listById(itemId);\n+        int openSlot = 0;\n+        \n+        if(!ItemConstants.isRechargable(itemId)) {\n+            for (Item item : itemList) {\n+                required -= item.getQuantity();\n+\n+                if(required >= 0) {\n+                    openSlot++;\n+                    if(required == 0) return openSlot;\n+                } else {\n+                    return openSlot;\n+                }\n+            }\n+        } else {\n+            for (Item item : itemList) {\n+                required -= 1;\n+\n+                if(required >= 0) {\n+                    openSlot++;\n+                    if(required == 0) return openSlot;\n+                } else {\n+                    return openSlot;\n+                }\n+            }\n+        }\n+        \n+        return -1;\n+    }\n \n     public List<Item> listById(int itemId) {\n         List<Item> ret = new ArrayList<>();\n@@ -218,6 +252,10 @@ public boolean isFull() {\n     public boolean isFull(int margin) {\n         return inventory.size() + margin >= slotLimit;\n     }\n+    \n+    public boolean isFullAfterSomeItems(int margin, int used) {\n+        return inventory.size() + margin >= slotLimit - used;\n+    }\n \n     public short getNextFreeSlot() {\n         if (isFull()) {\n@@ -250,25 +288,42 @@ public static boolean checkSpot(MapleCharacter chr, Item item) {\n     }\n     \n     public static boolean checkSpots(MapleCharacter chr, List<Pair<Item, MapleInventoryType>> items) {\n-    \tint equipSlot = 0, useSlot = 0, setupSlot = 0, etcSlot = 0, cashSlot = 0;\n-    \tfor (Pair<Item, MapleInventoryType> item : items) {\n-    \t\tif (item.getRight().getType() == MapleInventoryType.EQUIP.getType())\n-    \t\t\tequipSlot++;\n-\t\t\tif (item.getRight().getType() == MapleInventoryType.USE.getType())\n-    \t\t\tuseSlot++;\n-\t\t\tif (item.getRight().getType() == MapleInventoryType.SETUP.getType())\n-    \t\t\tsetupSlot++;\n-\t\t\tif (item.getRight().getType() == MapleInventoryType.ETC.getType())\n-    \t\t\tetcSlot++;\n-\t\t\tif (item.getRight().getType() == MapleInventoryType.CASH.getType())\n-    \t\t\tcashSlot++;\n+        List<Integer> zeroedList = new ArrayList<>(5);\n+        for(byte i = 0; i < 5; i++) zeroedList.add(0);\n+        \n+        return checkSpots(chr, items, zeroedList);\n+    }\n+    \n+    public static boolean checkSpots(MapleCharacter chr, List<Pair<Item, MapleInventoryType>> items, List<Integer> typesSlotsUsed) {\n+        // assumption: no \"UNDEFINED\" or \"EQUIPPED\" items shall be tested here, all counts are >= 0.\n+        \n+        Map<Integer, Short> rcvItems = new LinkedHashMap<>();\n+        Map<Integer, Byte> rcvTypes = new LinkedHashMap<>();\n+        \n+        for (Pair<Item, MapleInventoryType> item : items) {\n+                Integer itemId = item.left.getItemId();\n+                Short qty = rcvItems.get(itemId);\n+            \n+    \t\tif(qty == null) {\n+                        rcvItems.put(itemId, item.left.getQuantity());\n+                        rcvTypes.put(itemId, item.right.getType());\n+                } else {\n+                        rcvItems.put(itemId, (short)(qty + item.left.getQuantity()));\n+                }\n     \t}\n-    \t\n-    \tif (chr.getInventory(MapleInventoryType.EQUIP).isFull(equipSlot - 1)) return false;\n-    \telse if (chr.getInventory(MapleInventoryType.USE).isFull(useSlot - 1)) return false;\n-    \telse if (chr.getInventory(MapleInventoryType.SETUP).isFull(setupSlot - 1)) return false;\n-    \telse if (chr.getInventory(MapleInventoryType.ETC).isFull(etcSlot - 1)) return false;\n-    \telse if (chr.getInventory(MapleInventoryType.CASH).isFull(cashSlot - 1)) return false;\n+        \n+        MapleClient c = chr.getClient();\n+        for(Entry<Integer, Short> it: rcvItems.entrySet()) {\n+                int itemType = rcvTypes.get(it.getKey()) - 1;\n+                int usedSlots = typesSlotsUsed.get(itemType);\n+                \n+                int result = MapleInventoryManipulator.checkSpaceProgressively(c, it.getKey(), it.getValue(), \"\", usedSlots);\n+                boolean hasSpace = ((result % 2) != 0);\n+                \n+                if(!hasSpace) return false;\n+                typesSlotsUsed.set(itemType, (result >> 1));\n+        }\n+        \n     \treturn true;\n     }\n     "}, {"sha": "e921af981f0f7b0c95ddd3677fda1b0c66121526", "filename": "src/constants/ItemConstants.java", "status": "modified", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/constants/ItemConstants.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/constants/ItemConstants.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/constants/ItemConstants.java?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -56,6 +56,19 @@ public static boolean isThrowingStar(int itemId) {\n     public static boolean isBullet(int itemId) {\n         return itemId / 10000 == 233;\n     }\n+    \n+    public static boolean isPotion(int itemId) {\n+        return itemId / 1000 == 2000;\n+    }\n+    \n+    public static boolean isFood(int itemId) {\n+        int useType = itemId / 1000;\n+        return useType == 2022 || useType == 2010 || useType == 2020;\n+    }\n+    \n+    public static boolean isConsumable(int itemId) {\n+        return isPotion(itemId) || isFood(itemId);\n+    }\n \n     public static boolean isRechargable(int itemId) {\n         return isThrowingStar(itemId) || isBullet(itemId);\n@@ -68,6 +81,10 @@ public static boolean isArrowForCrossBow(int itemId) {\n     public static boolean isArrowForBow(int itemId) {\n         return itemId / 1000 == 2060;\n     }\n+    \n+    public static boolean isArrow(int itemId) {\n+        return isArrowForBow(itemId) || isArrowForCrossBow(itemId);\n+    }\n \n     public static boolean isPet(int itemId) {\n         return itemId / 1000 == 5000;"}, {"sha": "11e17b7ca207c7ce21952ab2fd6a73f3a20adbba", "filename": "src/constants/ServerConstants.java", "status": "modified", "additions": 13, "deletions": 9, "changes": 22, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/constants/ServerConstants.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/constants/ServerConstants.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/constants/ServerConstants.java?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -33,21 +33,22 @@\n     //Gameplay Configuration\n     public static final boolean USE_CUSTOM_KEYSET = true;\n     public static final boolean USE_MAXRANGE_ECHO_OF_HERO = true;\n-    public static final boolean USE_MAXRANGE = true;        \t//Will send and receive packets from all events of a map, rather than those of only view range.\n-    public static final boolean USE_DEBUG = true;           \t//Will enable some text prints and new commands in the client oriented for debugging.\n-    public static final boolean USE_DEBUG_SHOW_RCVD_PACKET = false;     //Prints on the cmd all received packet ids.\n-    public static final boolean USE_DEBUG_SHOW_INFO_EQPEXP = false;     //Prints on the cmd all equip exp gain info.\n+    public static final boolean USE_MAXRANGE = true;                //Will send and receive packets from all events of a map, rather than those of only view range.\n+    public static final boolean USE_DEBUG = false;                  //Will enable some text prints on the client, oriented for debugging purposes.\n+    public static final boolean USE_DEBUG_SHOW_RCVD_PACKET = false; //Prints on the cmd all received packet ids.\n+    public static final boolean USE_DEBUG_SHOW_INFO_EQPEXP = false; //Prints on the cmd all equip exp gain info.\n     public static final boolean USE_MTS = false;\n     public static final boolean USE_FAMILY_SYSTEM = false;\n-    public static final boolean USE_PERMISSIVE_BUFFS = false;    //WARNING: Allows players that does not have increased certain buff-type skills to use it's effect. Used mainly on buff-cast commands, however making this active may generate a source for possible client-edited exploits.\n     public static final boolean USE_DUEY = true;\n     public static final boolean USE_ITEM_SORT = true;\n-    public static final boolean USE_ITEM_SORT_BY_NAME = false;  //Item sorting based on name rather than id.\n+    public static final boolean USE_ITEM_SORT_BY_NAME = false;      //Item sorting based on name rather than id.\n     public static final boolean USE_PARTY_SEARCH = false;\n-    public static final boolean USE_AUTOBAN = false;            //Commands the server to detect infractors automatically.\n-    public static final boolean USE_ANOTHER_AUTOASSIGN = true;  //Based on distributing AP accordingly with higher secondary stat on equipments.\n+    public static final boolean USE_AUTOBAN = false;                //Commands the server to detect infractors automatically.\n+    public static final boolean USE_ANOTHER_AUTOASSIGN = true;      //Based on distributing AP accordingly with higher secondary stat on equipments.\n     public static final boolean USE_REFRESH_RANK_MOVE = true;\n-    public static final boolean USE_PERFECT_PITCH = true;\t        //For lvl 30 or above, each lvlup player gains 1 perfect pitch.\n+    public static final boolean USE_PERFECT_PITCH = true;\t    //For lvl 30 or above, each lvlup player gains 1 perfect pitch.\n+    public static final boolean USE_PERMISSIVE_BUFFS = false;       //WARNING: Allows players that does not have increased certain buff-type skills to use it's effect. Used mainly on buff-cast commands, however making this active may generate a source for possible client-edited exploits.\n+    public static final boolean USE_ENFORCE_MDOOR_POSITION = true;  //Forces mystic door to be spawned near spawnpoints. (since things bugs out other way, and this helps players locate the door faster)\n     \n     \n     public static final int MAX_AP = 20000;                     //Max AP allotted on the auto-assigner.\n@@ -69,9 +70,12 @@\n     public static final boolean USE_STACK_COUPON_RATES = true;  //Multiple coupons effects builds up together.\n     public static final boolean USE_EQUIPMNT_LVLUP_SLOTS = true;//Equips can upgrade slots at level up.\n     public static final boolean USE_EQUIPMNT_LVLUP_POWER = true;//Enable more powerful stats upgrades at equip level up.\n+    public static final boolean USE_CHAIR_EXTRAHEAL = true;     //Enable map chairs to futher recover player`s HP and MP.\n     public static final int MAX_EQUIPMNT_LVLUP_STAT_GAIN = 10000; //Max stat upgrade an equipment can have on a levelup.\n     public static final int MAX_EQUIPMNT_STAT = 32767;            //Max stat on an equipment by leveling up.\n     public static final int USE_EQUIPMNT_LVLUP = 7;             //All equips lvlup at max level of N, set 1 to disable.\n+    public static final byte CHAIR_EXTRA_HEAL_HP = 70;          //Each extra heal proc increasing HP.\n+    public static final byte CHAIR_EXTRA_HEAL_MP = 42;          //Each extra heal proc increasing MP.\n     public static final int FAME_GAIN_BY_QUEST = 4;             //Fame gain each N quest completes, set 0 to disable.\n     public static final int SCROLL_CHANCE_RATE = 10;            //Number of tries for success on a scroll, set 0 for default.\n     "}, {"sha": "25d1a8823087488de9cbfa29cd9161af42c00fd6", "filename": "src/net/server/PlayerBuffStorage.java", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/net/server/PlayerBuffStorage.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/net/server/PlayerBuffStorage.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/PlayerBuffStorage.java?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -39,7 +39,7 @@\n     public void addBuffsToStorage(int chrid, List<PlayerBuffValueHolder> toStore) {\n         mutex.lock();\n         try {\n-            buffs.put(chrid, toStore);//Old one will be replace if it's in here.\n+            buffs.put(chrid, toStore);//Old one will be replaced if it's in here.\n         } finally {\n             mutex.unlock();\n         }"}, {"sha": "3b0c807f33c5b3b164a387d107ff7c8169dad370", "filename": "src/net/server/PlayerStorage.java", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/net/server/PlayerStorage.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/net/server/PlayerStorage.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/PlayerStorage.java?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -88,9 +88,9 @@ public MapleCharacter getCharacterById(int id) {\n     public final void disconnectAll() {\n \twlock.lock();\n \ttry {\t    \n-        final Iterator<MapleCharacter> chrit = storage.values().iterator();\n+            final Iterator<MapleCharacter> chrit = storage.values().iterator();\n \t    while (chrit.hasNext()) {\n-\t    \t\tchrit.next().getClient().disconnect(true, false);\n+                chrit.next().getClient().disconnect(true, false);\n                 chrit.remove();\n             }\n \t} finally {"}, {"sha": "60c38d95ef456fdcfb90856da7518b897ba18af8", "filename": "src/net/server/channel/Channel.java", "status": "modified", "additions": 145, "deletions": 0, "changes": 145, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/net/server/channel/Channel.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/net/server/channel/Channel.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/channel/Channel.java?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -30,6 +30,7 @@\n import java.util.Collections;\n import java.util.Map;\n import java.util.Map.Entry;\n+import java.util.concurrent.ScheduledFuture;\n import java.util.concurrent.locks.ReentrantReadWriteLock;\n import java.util.concurrent.locks.ReentrantReadWriteLock.ReadLock;\n import java.util.concurrent.locks.ReentrantReadWriteLock.WriteLock;\n@@ -80,6 +81,11 @@\n     private List<MapleExpeditionType> expedType = new ArrayList<>();\n     private MapleEvent event;\n     private boolean finishedShutdown = false;\n+    private int usedDojo = 0;\n+    private int[] dojoStage;\n+    private long[] dojoFinishTime;\n+    private ScheduledFuture<?>[] dojoTask;\n+    private Map<Integer, Integer> dojoParty = new HashMap<>();\n     \n     public Channel(final int world, final int channel) {\n         this.world = world;\n@@ -104,6 +110,15 @@ public Channel(final int world, final int channel) {\n             }\n             eventSM.init();\n             \n+            dojoStage = new int[20];\n+            dojoFinishTime = new long[20];\n+            dojoTask = new ScheduledFuture<?>[20];\n+            for(int i = 0; i < 20; i++) {\n+                dojoStage[i] = 0;\n+                dojoFinishTime[i] = 0;\n+                dojoTask[i] = null;\n+            }\n+            \n             System.out.println(\"    Channel \" + getId() + \": Listening on port \" + port);\n         } catch (Exception e) {\n             e.printStackTrace();\n@@ -312,4 +327,134 @@ public int getStoredVar(int key) {\n     public void setStoredVar(int key, int val) {\n         this.storedVars.put(key, val);\n     }\n+    \n+    public synchronized int lookupPartyDojo(MapleParty party) {\n+        if(party == null) return -1;\n+        \n+        Integer i = dojoParty.get(party.hashCode());\n+        return (i != null) ? i : -1;\n+    }\n+    \n+    public int getAvailableDojo(boolean isPartyDojo) {\n+        return getAvailableDojo(isPartyDojo, null);\n+    }\n+    \n+    public synchronized int getAvailableDojo(boolean isPartyDojo, MapleParty party) {\n+        int dojoList = this.usedDojo;\n+        int range, slot = 0;\n+        \n+        if(!isPartyDojo) {\n+            dojoList = dojoList >> 5;\n+            range = 15;\n+        } else {\n+            range = 5;\n+        }\n+        \n+        while((dojoList & 1) != 0) {\n+            dojoList = (dojoList >> 1);\n+            slot++;\n+        }\n+        \n+        if(slot < range) {\n+            if(party != null) {\n+                if(dojoParty.containsKey(party.hashCode())) return -2;\n+                dojoParty.put(party.hashCode(), slot);\n+            }\n+                \n+            this.usedDojo |= (1 << ((!isPartyDojo ? 5 : 0) + slot));\n+            return slot;\n+        } else {\n+            return -1;\n+        }\n+    }\n+    \n+    private void freeDojoSlot(int slot, MapleParty party) {\n+        int mask = 0b11111111111111111111;\n+        mask ^= (1 << slot);\n+        \n+        usedDojo &= mask;\n+        if(party != null) dojoParty.remove(party.hashCode());\n+    }\n+    \n+    private int getDojoSlot(int dojoMapId) {\n+        return (dojoMapId % 100) + ((dojoMapId / 10000 == 92502) ? 5 : 0);\n+    }\n+    \n+    public void resetDojoMap(int fromMapId) {\n+        for(int i = 0; i < (((fromMapId / 100) % 100 <= 36) ? 5 : 2); i++) {\n+            this.getMapFactory().getMap(fromMapId + (100 * i)).resetMapObjects();\n+        }\n+    }\n+    \n+    public void resetDojo(int dojoMapId) {\n+        resetDojo(dojoMapId, 0);\n+    }\n+    \n+    public void resetDojo(int dojoMapId, int thisStg) {\n+        int slot = getDojoSlot(dojoMapId);\n+        this.dojoStage[slot] = thisStg;\n+        \n+        if(this.dojoTask[slot] != null) {\n+            this.dojoTask[slot].cancel(false);\n+            this.dojoTask[slot] = null;\n+        }\n+    }\n+    \n+    public void startDojoSchedule(final int dojoMapId) {\n+        final int slot = getDojoSlot(dojoMapId);\n+        final int stage = (dojoMapId / 100) % 100;\n+        if(stage <= dojoStage[slot]) return;\n+        \n+        long clockTime = (stage > 36 ? 15 : stage / 6 + 5) * 60000;\n+        this.dojoTask[slot] = TimerManager.getInstance().schedule(new Runnable() {\n+            @Override\n+            public void run() {\n+                final int delta = (dojoMapId) % 100;\n+                final int dojoBaseMap = (slot < 5) ? 925030000 : 925020000;\n+                MapleParty party = null;\n+                \n+                for (int i = 0; i < 5; i++) { //only 32 stages, but 38 maps\n+                    for(MapleCharacter chr: getMapFactory().getMap(dojoBaseMap + (100 * (stage + i)) + delta).getAllPlayers()) {\n+                        if(chr.getMap().isDojoMap()) {\n+                            chr.timeoutFromDojo();\n+                        }\n+                        party = chr.getParty();\n+                    }\n+                }\n+                \n+                freeDojoSlot(slot, party);\n+            }\n+        }, clockTime + 3000);   // let the TIMES UP display for 3 seconds, then warp\n+        \n+        dojoFinishTime[slot] = System.currentTimeMillis() + clockTime;\n+    }\n+    \n+    public void dismissDojoSchedule(int dojoMapId, MapleParty party) {\n+        int slot = getDojoSlot(dojoMapId);\n+        int stage = (dojoMapId / 100) % 100;\n+        if(stage <= dojoStage[slot]) return;\n+        \n+        if(this.dojoTask[slot] != null) {\n+            this.dojoTask[slot].cancel(false);\n+            this.dojoTask[slot] = null;\n+        }\n+        \n+        freeDojoSlot(slot, party);\n+    }\n+    \n+    public boolean setDojoProgress(int dojoMapId) {\n+        int slot = getDojoSlot(dojoMapId);\n+        int dojoStg = (dojoMapId / 100) % 100;\n+        \n+        if(this.dojoStage[slot] < dojoStg) {\n+            this.dojoStage[slot] = dojoStg;\n+            return true;\n+        } else {\n+            return false;\n+        }\n+    }\n+    \n+    public long getDojoFinishTime(int dojoMapId) {\n+        return dojoFinishTime[getDojoSlot(dojoMapId)];\n+    }\n }\n\\ No newline at end of file"}, {"sha": "98d055b3193659c11bc07a6f4a3ca3e6b4eec700", "filename": "src/net/server/channel/handlers/CancelChairHandler.java", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/net/server/channel/handlers/CancelChairHandler.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/net/server/channel/handlers/CancelChairHandler.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/channel/handlers/CancelChairHandler.java?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -33,10 +33,12 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n         int id = slea.readShort();\n         if (id == -1) { // Cancel Chair\n             c.getPlayer().setChair(0);\n+            c.getPlayer().stopChairTask();\n             c.announce(MaplePacketCreator.cancelChair(-1));\n             c.getPlayer().getMap().broadcastMessage(c.getPlayer(), MaplePacketCreator.showChair(c.getPlayer().getId(), 0), false);\n         } else { // Use In-Map Chair\n             c.getPlayer().setChair(id);\n+            c.getPlayer().startChairTask();\n             c.announce(MaplePacketCreator.cancelChair(id));\n         }\n     }"}, {"sha": "78c94c66553a4179b583979bdfbc3e9d822ca4df", "filename": "src/net/server/channel/handlers/CashOperationHandler.java", "status": "modified", "additions": 2, "deletions": 36, "changes": 38, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/net/server/channel/handlers/CashOperationHandler.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/net/server/channel/handlers/CashOperationHandler.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/channel/handlers/CashOperationHandler.java?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -213,7 +213,7 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n             mi.removeSlot(item.getPosition());\n             c.announce(MaplePacketCreator.putIntoCashInventory(item, c.getAccID()));\n         } else if (action == 0x1D) { //crush ring (action 28)\n-\t\t\tslea.readInt();//Birthday\n+            slea.readInt();//Birthday\n            // if (checkBirthday(c, birthday)) { //We're using a default birthday, so why restrict rings to only people who know of it? \n                 int toCharge = slea.readInt();\n                 int SN = slea.readInt();\n@@ -317,40 +317,6 @@ private static boolean checkBirthday(MapleClient c, int idate) {\n     }\n \n     public static boolean canBuy(CashItem item, int cash) {\n-        return item != null && item.isOnSale() && item.getPrice() <= cash && !blocked(item.getItemId());\n-    }\n-\n-    public static boolean blocked(int id){\n-    \tswitch(id){ //All 2x exp cards\n-    \tcase 5211000:\n-    \tcase 5211004:\n-    \tcase 5211005:\n-    \tcase 5211006:\n-    \tcase 5211007:\n-    \tcase 5211008:\n-    \tcase 5211009:\n-    \tcase 5211010:\n-    \tcase 5211011:\n-    \tcase 5211012:\n-    \tcase 5211013:\n-    \tcase 5211014:\n-    \tcase 5211015:\n-    \tcase 5211016:\n-    \tcase 5211017:\n-    \tcase 5211018:\n-    \tcase 5211037:\n-    \tcase 5211038:\n-    \tcase 5211039:\n-    \tcase 5211040:\n-    \tcase 5211041:\n-    \tcase 5211042:\n-    \tcase 5211043:\n-    \tcase 5211044:\n-    \tcase 5211045:\n-    \tcase 5211049:\n-    \t\treturn true;\n-    \tdefault:\n-    \t\treturn false;\n-    \t}\n+        return item != null && item.isOnSale() && item.getPrice() <= cash;\n     }\n }"}, {"sha": "66f918d288e9a6818d08718ab61e10c46fa0b1f5", "filename": "src/net/server/channel/handlers/DoorHandler.java", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/net/server/channel/handlers/DoorHandler.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/net/server/channel/handlers/DoorHandler.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/channel/handlers/DoorHandler.java?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -33,6 +33,7 @@\n  * @author Ronan\n  */\n public final class DoorHandler extends AbstractMaplePacketHandler {\n+    @Override\n     public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c) {\n         int ownerid = slea.readInt();\n         boolean mode = (slea.readByte() == 0); // specifies if backwarp or not, 1 town to target, 0 target to town"}, {"sha": "6cda6936c1530409f6bc0c756f96b016e1786758", "filename": "src/net/server/channel/handlers/EnterMTSHandler.java", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/net/server/channel/handlers/EnterMTSHandler.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/net/server/channel/handlers/EnterMTSHandler.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/channel/handlers/EnterMTSHandler.java?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -44,7 +44,8 @@\n     @Override\n     public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c) {\n     \tif (!ServerConstants.USE_MTS){\n-    \t\treturn;\n+            c.announce(MaplePacketCreator.enableActions());\n+            return;\n     \t}\n         MapleCharacter chr = c.getPlayer();\n         if (!chr.isAlive()) {"}, {"sha": "6fe77013430a200de65487bbbf54a6d5421a5f3a", "filename": "src/net/server/channel/handlers/GeneralChatHandler.java", "status": "modified", "additions": 42, "deletions": 44, "changes": 86, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/net/server/channel/handlers/GeneralChatHandler.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/net/server/channel/handlers/GeneralChatHandler.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/channel/handlers/GeneralChatHandler.java?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -21,7 +21,6 @@\n  */\n package net.server.channel.handlers;\n \n-import tools.LogHelper;\n import tools.FilePrinter;\n import tools.MaplePacketCreator;\n import tools.data.input.SeekableLittleEndianAccessor;\n@@ -33,50 +32,49 @@\n import java.util.Calendar;\n \n public final class GeneralChatHandler extends net.AbstractMaplePacketHandler {\n-\t\n-    public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c) {\n-        String s = slea.readMapleAsciiString();\n-        MapleCharacter chr = c.getPlayer();\n-        if(chr.getAutobanManager().getLastSpam(7) + 200 > System.currentTimeMillis()) {\n-                return;\n-        }\n-        if (s.length() > Byte.MAX_VALUE && !chr.isGM()) {\n-        \tAutobanFactory.PACKET_EDIT.alert(c.getPlayer(), c.getPlayer().getName() + \" tried to packet edit in General Chat.\");\n-        \tFilePrinter.printError(FilePrinter.EXPLOITS + c.getPlayer().getName() + \".txt\", c.getPlayer().getName() + \" tried to send text with length of \" + s.length() + \"\\r\\n\");\n-        \tc.disconnect(true, false);\n-        \treturn;\n-        }\n-        char heading = s.charAt(0);\n-        if (heading == '/' || heading == '!' || heading == '@') {\n-            String[] sp = s.split(\" \");\n-            sp[0] = sp[0].toLowerCase().substring(1);\n-            if (!Commands.executePlayerCommand(c, sp, heading)) {\n-                if (chr.isGM()) {\n-                    if (!Commands.executeGMCommand(c, sp, heading)) {\n-                        Commands.executeAdminCommand(c, sp, heading);\n-                    }\n-                    String command = \"\";\n-                    for (String used : sp) {\n-                    \tcommand += used + \" \";\n-                    }\n-                    \n-                    SimpleDateFormat sdf = new SimpleDateFormat(\"dd-MM-yyyy HH:mm\");\n-                    FilePrinter.print(FilePrinter.USED_COMMANDS, c.getPlayer().getName() + \" used: \" + heading + command + \"on \" + sdf.format(Calendar.getInstance().getTime()) + \"\\r\\n\");\n+\t@Override\n+        public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c) {\n+                String s = slea.readMapleAsciiString();\n+                MapleCharacter chr = c.getPlayer();\n+                if(chr.getAutobanManager().getLastSpam(7) + 200 > System.currentTimeMillis()) {\n+                        c.announce(MaplePacketCreator.enableActions());\n+                        return;\n+                }\n+                if (s.length() > Byte.MAX_VALUE && !chr.isGM()) {\n+                        AutobanFactory.PACKET_EDIT.alert(c.getPlayer(), c.getPlayer().getName() + \" tried to packet edit in General Chat.\");\n+                        FilePrinter.printError(FilePrinter.EXPLOITS + c.getPlayer().getName() + \".txt\", c.getPlayer().getName() + \" tried to send text with length of \" + s.length() + \"\\r\\n\");\n+                        c.disconnect(true, false);\n+                        return;\n+                }\n+                char heading = s.charAt(0);\n+                if (heading == '/') {\n+                        String[] sp = s.split(\" \");\n+                        sp[0] = sp[0].toLowerCase().substring(1);\n+\n+                        if(Commands.executeSolaxiaPlayerCommand(c, sp, heading)) {\n+                            String command = \"\";\n+                            for (String used : sp) {\n+                                    command += used + \" \";\n+                            }\n+\n+                            SimpleDateFormat sdf = new SimpleDateFormat(\"dd-MM-yyyy HH:mm\");\n+                            FilePrinter.print(FilePrinter.USED_COMMANDS, c.getPlayer().getName() + \" used: \" + heading + command + \"on \" + sdf.format(Calendar.getInstance().getTime()) + \"\\r\\n\");\n+                        }            \n+                } else {\n+                        int show = slea.readByte();\n+                        if(chr.getMap().isMuted() && !chr.isGM()) {\n+                                chr.dropMessage(5, \"The map you are in is currently muted. Please try again later.\");\n+                                return;\n+                        }\n+\n+                        if (!chr.isHidden()) {\n+                                chr.getMap().broadcastMessage(MaplePacketCreator.getChatText(chr.getId(), s, chr.getWhiteChat(), show));\t\n+                        } else {\n+                                chr.getMap().broadcastGMMessage(MaplePacketCreator.getChatText(chr.getId(), s, chr.getWhiteChat(), show));\n+                        }\n+\n+                        chr.getAutobanManager().spam(7);\n                 }\n-            }\n-        } else {\n-        \tint show = slea.readByte();\n-\t\t\tif(chr.getMap().isMuted() && !chr.isGM()) {\n-\t\t\t\tchr.dropMessage(5, \"The map you are in is currently muted. Please try again later.\");\n-\t\t\t\treturn;\n-\t\t\t}\n-            if (!chr.isHidden()) {\n-            \tchr.getMap().broadcastMessage(MaplePacketCreator.getChatText(chr.getId(), s, chr.getWhiteChat(), show));\t\n-            } else {\n-                chr.getMap().broadcastGMMessage(MaplePacketCreator.getChatText(chr.getId(), s, chr.getWhiteChat(), show));\n-            }\n         }\n-        chr.getAutobanManager().spam(7);\n-    }\n }\n "}, {"sha": "76c9a8d3b08848cc46e6562e47d76a4abd22b9a8", "filename": "src/net/server/channel/handlers/PartyOperationHandler.java", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/net/server/channel/handlers/PartyOperationHandler.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/net/server/channel/handlers/PartyOperationHandler.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/channel/handlers/PartyOperationHandler.java?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -51,7 +51,7 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n                         player.setParty(party);\n                         player.setMPC(partyplayer);\n                         player.silentPartyUpdate();\n-                    c.announce(MaplePacketCreator.partyCreated(partyplayer));\n+                        c.announce(MaplePacketCreator.partyCreated(partyplayer));\n                 } else {\n                     c.announce(MaplePacketCreator.serverNotice(5, \"You can't create a party as you are already in one.\"));\n                 }"}, {"sha": "74ef072d67cb21282f0b42a85df7e4fd66286825", "filename": "src/net/server/channel/handlers/SpecialMoveHandler.java", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/net/server/channel/handlers/SpecialMoveHandler.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/net/server/channel/handlers/SpecialMoveHandler.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/channel/handlers/SpecialMoveHandler.java?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -54,12 +54,14 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n     \tMapleCharacter chr = c.getPlayer();\n         chr.getAutobanManager().setTimestamp(4, slea.readInt(), 3);\n         int skillid = slea.readInt();\n+        /*\n         if ((!GameConstants.isPQSkillMap(c.getPlayer().getMapId()) && GameConstants.isPqSkill(skillid)) || (!c.getPlayer().isGM() && GameConstants.isGMSkills(skillid)) || (!GameConstants.isInJobTree(skillid, c.getPlayer().getJob().getId()) && !c.getPlayer().isGM())) {\n         \tAutobanFactory.PACKET_EDIT.alert(c.getPlayer(), c.getPlayer().getName() + \" tried to packet edit skills.\");\n         \tFilePrinter.printError(FilePrinter.EXPLOITS + c.getPlayer().getName() + \".txt\", c.getPlayer().getName() + \" tried to use skill \" + skillid + \" without it being in their job.\\r\\n\");\n     \t\tc.disconnect(true, false);\n             return;\n         }\n+                */\n         Point pos = null;\n         int __skillLevel = slea.readByte();\n         Skill skill = SkillFactory.getSkill(skillid);"}, {"sha": "001b328da059a637db38df913099f95e45eae346", "filename": "src/net/server/channel/handlers/StorageHandler.java", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/net/server/channel/handlers/StorageHandler.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/net/server/channel/handlers/StorageHandler.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/channel/handlers/StorageHandler.java?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -57,7 +57,7 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n \t\t\tbyte slot = slea.readByte();\n \t\t\tif (slot < 0 || slot > storage.getSlots()) { // removal starts at zero\n \t\t\t\tAutobanFactory.PACKET_EDIT.alert(c.getPlayer(), c.getPlayer().getName() + \" tried to packet edit with storage.\");\n-\t\t\t\tFilePrinter.printError(FilePrinter.EXPLOITS + c.getPlayer().getName() + \".txt\", c.getPlayer().getName() + \" tried to work with storage slot \" + slot + \"\\r\\n\");\n+\t\t\t\tFilePrinter.print(FilePrinter.EXPLOITS + c.getPlayer().getName() + \".txt\", c.getPlayer().getName() + \" tried to work with storage slot \" + slot + \"\\r\\n\");\n \t\t\t\tc.disconnect(true, false);\n \t\t\t\treturn;\n \t\t\t}\n@@ -79,7 +79,7 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n \t\t\t\tif (MapleInventoryManipulator.checkSpace(c, item.getItemId(), item.getQuantity(), item.getOwner())) {                \n \t\t\t\t\titem = storage.takeOut(slot);//actually the same but idc\n \t\t\t\t\tString itemName = MapleItemInformationProvider.getInstance().getName(item.getItemId());\n-\t\t\t\t\tFilePrinter.printError(FilePrinter.STORAGE + c.getAccountName() + \".txt\", c.getPlayer().getName() + \" took out \" + item.getQuantity() + \" \" + itemName + \" (\" + item.getItemId() + \")\\r\\n\");\t\t\t\n+\t\t\t\t\tFilePrinter.print(FilePrinter.STORAGE + c.getAccountName() + \".txt\", c.getPlayer().getName() + \" took out \" + item.getQuantity() + \" \" + itemName + \" (\" + item.getItemId() + \")\\r\\n\");\n \t\t\t\t\tif ((item.getFlag() & ItemConstants.KARMA) == ItemConstants.KARMA) {\n \t\t\t\t\t\titem.setFlag((byte) (item.getFlag() ^ ItemConstants.KARMA)); //items with scissors of karma used on them are reset once traded\n \t\t\t\t\t}\n@@ -97,7 +97,7 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n \t\t\tMapleInventory Inv = chr.getInventory(slotType);\n \t\t\tif (slot < 1 || slot > Inv.getSlotLimit()) { //player inv starts at one\n \t\t\t\tAutobanFactory.PACKET_EDIT.alert(c.getPlayer(), c.getPlayer().getName() + \" tried to packet edit with storage.\");\n-\t\t\t\tFilePrinter.printError(FilePrinter.EXPLOITS + c.getPlayer().getName() + \".txt\", c.getPlayer().getName() + \" tried to store item at slot \" + slot + \"\\r\\n\");\n+\t\t\t\tFilePrinter.print(FilePrinter.EXPLOITS + c.getPlayer().getName() + \".txt\", c.getPlayer().getName() + \" tried to store item at slot \" + slot + \"\\r\\n\");\n \t\t\t\tc.disconnect(true, false);\n \t\t\t\treturn;\n \t\t\t}\n@@ -124,7 +124,7 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n \t\t\t\t\tstorage.store(item);\n \t\t\t\t\tstorage.sendStored(c, ii.getInventoryType(itemId));\n \t\t\t\t\tString itemName = MapleItemInformationProvider.getInstance().getName(item.getItemId());\n-\t\t\t\t\tFilePrinter.printError(FilePrinter.STORAGE + c.getAccountName() + \".txt\", c.getPlayer().getName() + \" stored \" + item.getQuantity() + \" \" + itemName + \" (\" + item.getItemId() + \")\\r\\n\");\t\n+\t\t\t\t\tFilePrinter.print(FilePrinter.STORAGE + c.getAccountName() + \".txt\", c.getPlayer().getName() + \" stored \" + item.getQuantity() + \" \" + itemName + \" (\" + item.getItemId() + \")\\r\\n\");\t\n \t\t\t\t}\n \t\t\t}\n \t\t} else if (mode == 7) { // meso\n@@ -145,7 +145,7 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n \t\t\t\t}\n \t\t\t\tstorage.setMeso(storageMesos - meso);\n \t\t\t\tchr.gainMeso(meso, false, true, false);\n-\t\t\t\tFilePrinter.printError(FilePrinter.STORAGE + c.getPlayer().getName() + \".txt\", c.getPlayer().getName() + (meso > 0 ? \" took out \" : \" stored \") + Math.abs(meso) + \" mesos\\r\\n\");\t\t\t\t\t\n+\t\t\t\tFilePrinter.print(FilePrinter.STORAGE + c.getPlayer().getName() + \".txt\", c.getPlayer().getName() + (meso > 0 ? \" took out \" : \" stored \") + Math.abs(meso) + \" mesos\\r\\n\");\n \t\t\t} else {\n \t\t\t\treturn;\n \t\t\t}"}, {"sha": "bd6cc1f5929a22038848485a39485c2b28abc904", "filename": "src/net/server/channel/handlers/WhisperHandler.java", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/net/server/channel/handlers/WhisperHandler.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/net/server/channel/handlers/WhisperHandler.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/channel/handlers/WhisperHandler.java?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -60,7 +60,7 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n             if (player != null) {\n                 player.getClient().announce(MaplePacketCreator.getWhisper(c.getPlayer().getName(), c.getChannel(), text));\n                 \n-                if(player.isHidden() && player.gmLevel() > c.getPlayer().gmLevel()) {\n+                if(player.isHidden() && player.gmLevel() >= c.getPlayer().gmLevel()) {\n                     c.announce(MaplePacketCreator.getWhisperReply(recipient, (byte) 0));\n                 } else {\n                     c.announce(MaplePacketCreator.getWhisperReply(recipient, (byte) 1));\n@@ -71,7 +71,7 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n                         world.whisper(c.getPlayer().getName(), recipient, c.getChannel(), text);\n                         \n                         player = world.getPlayerStorage().getCharacterByName(recipient);\n-                        if(player.isHidden() && player.gmLevel() > c.getPlayer().gmLevel())\n+                        if(player.isHidden() && player.gmLevel() >= c.getPlayer().gmLevel())\n                             c.announce(MaplePacketCreator.getWhisperReply(recipient, (byte) 0));\n                         else\n                             c.announce(MaplePacketCreator.getWhisperReply(recipient, (byte) 1));\n@@ -97,7 +97,7 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n                     ps.setString(1, recipient);\n                     ResultSet rs = ps.executeQuery();\n                     if (rs.next()) {\n-                        if (rs.getInt(\"gm\") > c.getPlayer().gmLevel()) {\n+                        if (rs.getInt(\"gm\") >= c.getPlayer().gmLevel()) {\n                             c.announce(MaplePacketCreator.getWhisperReply(recipient, (byte) 0));\n                             return;\n                         }"}, {"sha": "83a87076725a4eccb8ebde19b24ef78817006888", "filename": "src/net/server/world/MapleParty.java", "status": "modified", "additions": 33, "deletions": 0, "changes": 33, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/net/server/world/MapleParty.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/net/server/world/MapleParty.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/world/MapleParty.java?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -25,11 +25,19 @@\n import java.util.Collections;\n import java.util.LinkedList;\n import java.util.List;\n+import java.util.HashMap;\n+import java.util.Map.Entry;\n+import java.util.Map;\n+import java.util.Comparator;\n \n public class MapleParty {\n     private int leaderId;\n     private List<MaplePartyCharacter> members = new LinkedList<MaplePartyCharacter>();\n     private List<MaplePartyCharacter> pqMembers = null;\n+    \n+    private Map<Integer, Integer> histMembers = new HashMap<>();\n+    private int nextEntry = 0;\n+    \n     private int id;\n \n     public MapleParty(int id, MaplePartyCharacter chrfor) {\n@@ -43,10 +51,15 @@ public boolean containsMembers(MaplePartyCharacter member) {\n     }\n \n     public void addMember(MaplePartyCharacter member) {\n+        histMembers.put(member.getId(), nextEntry);\n+        nextEntry++;\n+        \n         members.add(member);\n     }\n \n     public void removeMember(MaplePartyCharacter member) {\n+        histMembers.remove(member.getId());\n+        \n         members.remove(member);\n     }\n \n@@ -110,6 +123,26 @@ public MaplePartyCharacter getLeader() {\n         return null;\n     }\n     \n+    public byte getPartyDoor(int cid) {\n+        List<Entry<Integer, Integer>> histList = new LinkedList<>(histMembers.entrySet());\n+        Collections.sort(histList, new Comparator<Entry<Integer, Integer>>()\n+            {\n+                @Override\n+                public int compare( Entry<Integer, Integer> o1, Entry<Integer, Integer> o2 )\n+                {\n+                    return ( o1.getValue() ).compareTo( o2.getValue() );\n+                }\n+            });\n+        \n+        byte slot = 0;\n+        for(Entry<Integer, Integer> e: histList) {\n+            if(e.getKey() == cid) break;\n+            slot++;\n+        }\n+        \n+        return slot;\n+    }\n+    \n     @Override\n     public int hashCode() {\n         final int prime = 31;"}, {"sha": "a0baf3143e21803f268682066cbf861b83b4ccb6", "filename": "src/scripting/AbstractPlayerInteraction.java", "status": "modified", "additions": 41, "deletions": 16, "changes": 57, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/scripting/AbstractPlayerInteraction.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/scripting/AbstractPlayerInteraction.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/scripting/AbstractPlayerInteraction.java?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -60,10 +60,10 @@\n import client.inventory.MapleInventoryType;\n import client.inventory.MaplePet;\n import client.inventory.ModifyInventory;\n-import client.inventory.PetDataFactory;\n import constants.ItemConstants;\n import constants.ServerConstants;\n import server.life.MapleNPC;\n+import tools.Pair;\n \n public class AbstractPlayerInteraction {\n \n@@ -113,22 +113,24 @@ public void warpMap(int map) {\n \t\tgetPlayer().getMap().warpEveryone(map);\n \t}\n \n-\tpublic void warpParty(int id) {\n-                if (getPlayer().getParty() != null) {\n-                        MaplePartyCharacter leader = getPlayer().getParty().getMemberById(getPlayer().getParty().getLeaderId());\n-                        if(leader != null) {\n-                                int leaderMapId = leader.getMapId();\n-            \n-                                for (MapleCharacter mc : getPartyMembers()) {\n-                                        if(mc.getMapId() == leaderMapId) {\n-                                                if (id == 925020100) {\n-                                                        mc.setDojoParty(true);\n-                                                }\n-                                                mc.changeMap(id);\n-                                        }\n-                                }\n+        public void warpParty(int id) {\n+                warpParty(id, 0);\n+        }\n+        \n+        public void warpParty(int id, int portalId) {\n+                warpParty(id, portalId, getMapId(), getMapId());\n+        }\n+        \n+        public void warpParty(int id, int fromMinId, int fromMaxId) {\n+                warpParty(id, 0, fromMinId, fromMaxId);\n+        }\n+        \n+\tpublic void warpParty(int id, int portalId, int fromMinId, int fromMaxId) {\n+                for (MapleCharacter mc : getPartyMembers()) {\n+                        if(mc.getMapId() >= fromMinId && mc.getMapId() <= fromMaxId) {\n+                                mc.changeMap(id, portalId);\n                         }\n-\t\t}\n+                }\n \t}\n \n \tpublic List<MapleCharacter> getPartyMembers() {\n@@ -205,6 +207,29 @@ public boolean canHold(int itemid) {\n         public boolean canHold(int itemid, int quantity) {\n                 return getPlayer().canHold(itemid, quantity);\n         }\n+        \n+        private List<Integer> convertToIntegerArray(List<Double> list) {\n+                List<Integer> intList = new LinkedList<>();\n+                for(Double d: list) intList.add(d.intValue());\n+\n+                return intList;\n+        }\n+        \n+        public boolean canHoldAll(List<Double> itemids, List<Double> quantity) {\n+                return canHoldAll(convertToIntegerArray(itemids), convertToIntegerArray(quantity), true);\n+        }\n+        \n+        private boolean canHoldAll(List<Integer> itemids, List<Integer> quantity, boolean isInteger) {\n+            int size = Math.min(itemids.size(), quantity.size());\n+            \n+            List<Pair<Item, MapleInventoryType>> addedItems = new LinkedList<>();\n+            for(int i = 0; i < size; i++) {\n+                Item it = new Item(itemids.get(i), (short) 0, quantity.get(i).shortValue());\n+                addedItems.add(new Pair<>(it, MapleItemInformationProvider.getInstance().getInventoryType(itemids.get(i))));\n+            }\n+            \n+            return MapleInventory.checkSpots(c.getPlayer(), addedItems);\n+        }\n      \n         //---- \\/ \\/ \\/ \\/ \\/ \\/ \\/  NOT TESTED  \\/ \\/ \\/ \\/ \\/ \\/ \\/ \\/ \\/ ----\n         "}, {"sha": "9d2bbf7ff7bfc71f30cca568b94ad7b710a043a2", "filename": "src/scripting/event/EventInstanceManager.java", "status": "modified", "additions": 45, "deletions": 32, "changes": 77, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/scripting/event/EventInstanceManager.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/scripting/event/EventInstanceManager.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/scripting/event/EventInstanceManager.java?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -116,6 +116,10 @@ public EventInstanceManager(EventManager em, String name) {\n \t\tmapFactory = new MapleMapFactory(this, MapleDataProviderFactory.getDataProvider(new File(System.getProperty(\"wzpath\") + \"/Map.wz\")), MapleDataProviderFactory.getDataProvider(new File(System.getProperty(\"wzpath\") + \"/String.wz\")), (byte) 0, (byte) 1);//Fk this\n \t\tmapFactory.setChannel(em.getChannelServer().getId());\n \t}\n+        \n+        public void setName(String name) {\n+                this.name = name;\n+        }\n \n \tpublic EventManager getEm() {\n \t\treturn em;\n@@ -239,8 +243,10 @@ public void exitPlayer(MapleCharacter chr) {\n \t}\n         \n         public void dropMessage(int type, String message) {\n-                for (MapleCharacter chr : getPlayers()) {\n-                        chr.dropMessage(type, message);\n+                if(!eventCleared) {\n+                        for (MapleCharacter chr : getPlayers()) {\n+                                chr.dropMessage(type, message);\n+                        }\n                 }\n         }\n \n@@ -346,21 +352,22 @@ private void registerExpeditionTeam(MapleExpedition exped, int recruitMap) {\n \t}\n \n \tpublic void unregisterPlayer(MapleCharacter chr) {\n+                try {\n+                        em.getIv().invokeFunction(\"playerUnregistered\", EventInstanceManager.this, chr);\n+                } catch (ScriptException | NoSuchMethodException ex) {\n+                        Logger.getLogger(EventManager.class.getName()).log(Level.SEVERE, null, ex);\n+                }\n+                        \n                 wL.lock();\n                 try {\n-                        try {\n-                                em.getIv().invokeFunction(\"playerUnregistered\", EventInstanceManager.this, chr);\n-                        } catch (ScriptException | NoSuchMethodException ex) {\n-                                Logger.getLogger(EventManager.class.getName()).log(Level.SEVERE, null, ex);\n-                        }\n-                    \n                         chars.remove(chr.getId());\n-                        gridRemove(chr);\n-                        dropExclusiveItems(chr);\n                 } finally {\n                         wL.unlock();\n                 }\n-            \n+                \n+                gridRemove(chr);\n+                dropExclusiveItems(chr);\n+                \n \t\tchr.setEventInstance(null);\n \t}\n \t\n@@ -832,33 +839,37 @@ public final boolean giveEventReward(MapleCharacter player) {\n         \n         //gives out EXP & a random item in a similar fashion of when clearing KPQ, LPQ, etc.\n         public final boolean giveEventReward(MapleCharacter player, int eventLevel) {\n+                List<Integer> rewardsSet, rewardsQty;\n+                Integer rewardExp;\n+            \n                 rL.lock();\n                 try {\n                         eventLevel--;       //event level starts counting from 1\n                         if(eventLevel >= collectionSet.size()) return true;\n \n-                        List<Integer> rewardsSet = collectionSet.get(eventLevel);\n-                        List<Integer> rewardsQty = collectionQty.get(eventLevel);\n-\n-                        Integer rewardExp = collectionExp.get(eventLevel);\n-                        if(rewardExp == null) rewardExp = 0;\n+                        rewardsSet = collectionSet.get(eventLevel);\n+                        rewardsQty = collectionQty.get(eventLevel);\n \n-                        if(rewardsSet == null || rewardsSet.isEmpty()) {\n-                                if(rewardExp > 0) player.gainExp(rewardExp);\n-                                return true;\n-                        }\n-\n-                        if(!hasRewardSlot(player, eventLevel)) return false;\n-\n-                        AbstractPlayerInteraction api = player.getClient().getAbstractPlayerInteraction();\n-                        int rnd = (int)Math.floor(Math.random() * rewardsSet.size());\n+                        rewardExp = collectionExp.get(eventLevel);\n+                } finally {\n+                        rL.unlock();\n+                }\n+                        \n+                if(rewardExp == null) rewardExp = 0;\n \n-                        api.gainItem(rewardsSet.get(rnd), rewardsQty.get(rnd).shortValue());\n+                if(rewardsSet == null || rewardsSet.isEmpty()) {\n                         if(rewardExp > 0) player.gainExp(rewardExp);\n                         return true;\n-                } finally {\n-                        rL.unlock();\n                 }\n+\n+                if(!hasRewardSlot(player, eventLevel)) return false;\n+\n+                AbstractPlayerInteraction api = player.getClient().getAbstractPlayerInteraction();\n+                int rnd = (int)Math.floor(Math.random() * rewardsSet.size());\n+\n+                api.gainItem(rewardsSet.get(rnd), rewardsQty.get(rnd).shortValue());\n+                if(rewardExp > 0) player.gainExp(rewardExp);\n+                return true;\n         }\n         \n         private void disposeExpedition() {\n@@ -898,10 +909,12 @@ public final boolean checkEventTeamLacking(boolean testLeader, int minPlayers) {\n         }\n         \n         public final boolean isEventTeamLackingNow(boolean testLeader, int minPlayers, MapleCharacter quitter) {\n-                if(eventCleared && getPlayerCount() > 1) return false;\n-                \n-                if(!eventCleared && testLeader && getLeaderId() == quitter.getId()) return true;\n-                if(getPlayerCount() <= minPlayers) return true;\n+                if(eventCleared) {\n+                        if(getPlayerCount() <= 1) return true;\n+                } else {\n+                        if(testLeader && getLeaderId() == quitter.getId()) return true;\n+                        if(getPlayerCount() <= minPlayers) return true;\n+                }\n                 \n                 return false;\n         }"}, {"sha": "d3c3e11462522dadeff5802ba62421679ef94a42", "filename": "src/scripting/event/EventManager.java", "status": "modified", "additions": 77, "deletions": 5, "changes": 82, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/scripting/event/EventManager.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/scripting/event/EventManager.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/scripting/event/EventManager.java?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -52,10 +52,12 @@\n import java.util.Queue;\n import java.util.concurrent.locks.Lock;\n import java.util.concurrent.locks.ReentrantLock;\n+import server.quest.MapleQuest;\n \n /**\n  *\n  * @author Matze\n+ * @author Ronan\n  */\n public class EventManager {\n     private Invocable iv;\n@@ -67,9 +69,12 @@\n     private final Queue<Integer> queuedGuilds = new LinkedList<>();\n     private final Map<Integer, Integer> queuedGuildLeaders = new HashMap<>();\n     private List<Boolean> openedLobbys;\n+    private List<EventInstanceManager> readyInstances = new LinkedList<>();\n+    private Integer readyId = 0;\n     private Properties props = new Properties();\n     private String name;\n     private Lock lobbyLock = new ReentrantLock();\n+    private Lock queueLock = new ReentrantLock();\n     \n     private static final int limitGuilds = 10;  // max numbers of guilds in queue for GPQ.\n     private static final int maxLobbys = 8;     // an event manager holds up to this amount of concurrent lobbys\n@@ -166,7 +171,14 @@ public EventInstanceManager getInstance(String name) {\n     }\n \n     public EventInstanceManager newInstance(String name) {\n-        EventInstanceManager ret = new EventInstanceManager(this, name);\n+        EventInstanceManager ret = getReadyInstance();\n+        \n+        if(ret == null) {\n+            ret = new EventInstanceManager(this, name);\n+        } else {\n+            ret.setName(name);\n+        }\n+        \n         instances.put(name, ret);\n         return ret;\n     }\n@@ -510,16 +522,16 @@ private static String ordinal(int i) {\n     \n     private void exportReadyGuild(Integer guildId) {\n         MapleGuild mg = server.getGuild(guildId);\n-        String callout = \"Your guild has been registered to attend to the Sharenian Guild Quest at channel \" + this.getChannelServer().getId() \n-                       + \" and    HAS JUST STARTED THE STRATEGY PHASE. After 3 minutes, no more guild members will be allowed to join the effort.\"\n+        String callout = \"[Guild Quest] Your guild has been registered to attend to the Sharenian Guild Quest at channel \" + this.getChannelServer().getId() \n+                       + \" and HAS JUST STARTED THE STRATEGY PHASE. After 3 minutes, no more guild members will be allowed to join the effort.\"\n                        + \" Check out Shuang at the excavation site in Perion for more info.\";\n         \n         mg.dropMessage(0, callout);\n     }\n     \n     private void exportMovedQueueToGuild(Integer guildId, int place) {\n         MapleGuild mg = server.getGuild(guildId);\n-        String callout = \"Your guild has been registered to attend to the Sharenian Guild Quest at channel \" + this.getChannelServer().getId() \n+        String callout = \"[Guild Quest] Your guild has been registered to attend to the Sharenian Guild Quest at channel \" + this.getChannelServer().getId() \n                        + \" and is currently on the \" + ordinal(place) + \" place on the waiting queue.\";\n         \n         mg.dropMessage(0, callout);\n@@ -606,4 +618,64 @@ public boolean attemptStartGuildInstance() {\n         \n         return startInstance(chr);\n     }\n-}\n+    \n+    public void startQuest(MapleCharacter chr, int id, int npcid) {\n+        try {\n+            MapleQuest.getInstance(id).forceStart(chr, npcid);\n+        } catch (NullPointerException ex) {\n+            ex.printStackTrace();\n+        }\n+    }\n+\n+    public void completeQuest(MapleCharacter chr, int id, int npcid) {\n+        try {\n+            MapleQuest.getInstance(id).forceComplete(chr, npcid);\n+        } catch (NullPointerException ex) {\n+            ex.printStackTrace();\n+        }\n+    }\n+    \n+    private void fillEimQueue() {\n+        Thread t = new Thread(new EventManagerWorker());  //call new thread to fill up readied instances queue\n+        t.start();\n+    }\n+    \n+    private EventInstanceManager getReadyInstance() {\n+        queueLock.lock();\n+        try {\n+            if(readyInstances.isEmpty()) {\n+                fillEimQueue();\n+                return null;\n+            }\n+            \n+            EventInstanceManager eim = readyInstances.remove(0);\n+            fillEimQueue();\n+                    \n+            return eim;\n+        } finally {\n+            queueLock.unlock();\n+        }\n+    }\n+    \n+    private void instantiateQueuedInstance() {\n+        queueLock.lock();\n+        try {\n+            if(readyInstances.size() >= Math.ceil((double)maxLobbys / 3.0)) return;\n+            \n+            readyInstances.add(new EventInstanceManager(this, \"sampleName\" + readyId));\n+            readyId++;\n+        } finally {\n+            queueLock.unlock();\n+        }\n+        \n+        instantiateQueuedInstance();    // keep filling the queue until reach threshold.\n+    }\n+    \n+    private class EventManagerWorker implements Runnable {\n+    \n+        @Override\n+        public void run() {\n+            instantiateQueuedInstance();\n+        }\n+    }\n+}\n\\ No newline at end of file"}, {"sha": "e07efbf6966f0648d7eb112b485048daab6e1511", "filename": "src/scripting/npc/NPCConversationManager.java", "status": "modified", "additions": 0, "deletions": 9, "changes": 9, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/scripting/npc/NPCConversationManager.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/scripting/npc/NPCConversationManager.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/scripting/npc/NPCConversationManager.java?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -22,11 +22,7 @@\n package scripting.npc;\n \n import java.io.File;\n-import java.sql.PreparedStatement;\n-import java.sql.ResultSet;\n import java.sql.SQLException;\n-import java.util.List;\n-import java.util.LinkedList;\n \n import net.server.Server;\n import net.server.guild.MapleAlliance;\n@@ -48,7 +44,6 @@\n import server.partyquest.Pyramid.PyramidMode;\n import server.quest.MapleQuest;\n import tools.LogHelper;\n-import tools.DatabaseConnection;\n import tools.FilePrinter;\n import tools.MaplePacketCreator;\n import client.MapleCharacter;\n@@ -60,12 +55,8 @@\n import client.SkillFactory;\n import client.inventory.Item;\n import client.inventory.ItemFactory;\n-import client.inventory.MapleInventoryType;\n import client.inventory.MaplePet;\n-import constants.ExpTable;\n import constants.ServerConstants;\n-import java.util.Map;\n-import java.util.Set;\n \n /**\n  *"}, {"sha": "5ca8b706969acc76b672628719378c8a0ea0d5df", "filename": "src/scripting/quest/QuestActionManager.java", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/scripting/quest/QuestActionManager.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/scripting/quest/QuestActionManager.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/scripting/quest/QuestActionManager.java?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -64,12 +64,12 @@ public boolean forceCompleteQuest() {\n         return forceCompleteQuest(quest);\n     }\n     \n-    // For compatability with some older scripts...\n+    // For compatibility with some older scripts...\n     public void startQuest() {\n         forceStartQuest();\n     }\n     \n-    // For compatability with some older scripts...\n+    // For compatibility with some older scripts...\n     public void completeQuest() {\n         forceCompleteQuest();\n     }"}, {"sha": "0578e5cdd7c9b3ac63e16df4ef35f4c7c9d3d715", "filename": "src/scripting/reactor/ReactorActionManager.java", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/scripting/reactor/ReactorActionManager.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/scripting/reactor/ReactorActionManager.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/scripting/reactor/ReactorActionManager.java?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -40,6 +40,7 @@\n import server.MapleItemInformationProvider;\n import server.TimerManager;\n import server.life.MapleLifeFactory;\n+import server.life.MapleMonster;\n import server.maps.MapMonitor;\n import server.maps.MapleReactor;\n import server.maps.ReactorDropEntry;\n@@ -163,6 +164,14 @@ public void spawnNpc(int npcId) {\n     public void spawnNpc(int npcId, Point pos) {\n         spawnNpc(npcId, pos, reactor.getMap());\n     }\n+    \n+    public void hitMonsterWithReactor(int id, int hitsToKill) {  // until someone comes with a better solution, why not?\n+        MapleMonster mm = reactor.getMap().getMonsterById(id);\n+        if(mm != null) {\n+            int damage = (int)Math.ceil(mm.getMaxHp() / hitsToKill);\n+            reactor.getMap().damageMonster(this.getPlayer(), mm, damage);\n+        }\n+    }\n \n     public MapleReactor getReactor() {\n         return reactor;"}, {"sha": "3cce2a5076b93a2aea68282ba7f553816a02a8ca", "filename": "src/server/MapleInventoryManipulator.java", "status": "modified", "additions": 47, "deletions": 1, "changes": 48, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/server/MapleInventoryManipulator.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/server/MapleInventoryManipulator.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/MapleInventoryManipulator.java?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -227,7 +227,7 @@ public static boolean addFromDrop(MapleClient c, Item item, boolean show, int pe\n         }\n         return true;\n     }\n-\n+    \n     public static boolean checkSpace(MapleClient c, int itemid, int quantity, String owner) {\n         MapleItemInformationProvider ii = MapleItemInformationProvider.getInstance();\n         MapleInventoryType type = ii.getInventoryType(itemid);\n@@ -263,6 +263,52 @@ public static boolean checkSpace(MapleClient c, int itemid, int quantity, String\n         }\n     }\n \n+    public static int checkSpaceProgressively(MapleClient c, int itemid, int quantity, String owner, int usedSlots) {\n+        // return value --> bit0: if has space for this one;\n+        //                  value after: new slots filled;\n+        \n+        int returnValue;\n+        \n+        MapleItemInformationProvider ii = MapleItemInformationProvider.getInstance();\n+        MapleInventoryType type = ii.getInventoryType(itemid);\n+        if (!type.equals(MapleInventoryType.EQUIP)) {\n+            short slotMax = ii.getSlotMax(c, itemid);\n+            if (!ItemConstants.isRechargable(itemid)) {\n+                List<Item> existing = c.getPlayer().getInventory(type).listById(itemid);\n+                \n+                if (existing.size() > 0) // first update all existing slots to slotMax\n+                {\n+                    for (Item eItem : existing) {\n+                        short oldQ = eItem.getQuantity();\n+                        if (oldQ < slotMax && owner.equals(eItem.getOwner())) {\n+                            short newQ = (short) Math.min(oldQ + quantity, slotMax);\n+                            quantity -= (newQ - oldQ);\n+                        }\n+                        if (quantity <= 0) {\n+                            break;\n+                        }\n+                    }\n+                }\n+            }\n+            final int numSlotsNeeded;\n+            if (slotMax > 0) {\n+                numSlotsNeeded = (int) (Math.ceil(((double) quantity) / slotMax));\n+            } else if (ItemConstants.isRechargable(itemid)) {\n+                numSlotsNeeded = 1;\n+            } else {\n+                numSlotsNeeded = 1;\n+            }\n+            \n+            returnValue = ((numSlotsNeeded + usedSlots) << 1);\n+            returnValue += (numSlotsNeeded == 0 || !c.getPlayer().getInventory(type).isFullAfterSomeItems(numSlotsNeeded - 1, usedSlots)) ? 1 : 0;\n+        } else {\n+            returnValue = ((1 + usedSlots) << 1);\n+            returnValue += (!c.getPlayer().getInventory(type).isFullAfterSomeItems(0, usedSlots)) ? 1 : 0;\n+        }\n+        \n+        return returnValue;\n+    }\n+\n     public static void removeFromSlot(MapleClient c, MapleInventoryType type, short slot, short quantity, boolean fromDrop) {\n         removeFromSlot(c, type, slot, quantity, fromDrop, false);\n     }"}, {"sha": "aa81e95223a27f2f042de46c8aade787653925d7", "filename": "src/server/MapleStatEffect.java", "status": "modified", "additions": 87, "deletions": 39, "changes": 126, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/server/MapleStatEffect.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/server/MapleStatEffect.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/MapleStatEffect.java?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -116,12 +116,15 @@\n /**\n  * @author Matze\n  * @author Frz\n+ * @author Ronan\n  */\n public class MapleStatEffect {\n \n     private short watk, matk, wdef, mdef, acc, avoid, speed, jump;\n     private short hp, mp;\n     private double hpR, mpR;\n+    private short mhpRRate, mmpRRate;\n+    private byte mhpR, mmpR;\n     private short mpCon, hpCon;\n     private int duration;\n     private boolean overTime, repeatEffect;\n@@ -224,37 +227,48 @@ private static MapleStatEffect loadFromData(MapleData source, int sourceid, bool\n             addBuffStatPairToListIfNotZero(statups, MapleBuffStat.PYRAMID_PQ, Integer.valueOf(ret.berserk));\n             addBuffStatPairToListIfNotZero(statups, MapleBuffStat.BOOSTER, Integer.valueOf(ret.booster));\n             \n-            if(MapleItemInformationProvider.getInstance().isRateCoupon(sourceid)) {\n-                switch(MapleDataTool.getInt(\"expR\", source, 0)) {\n-                    case 1:\n-                        addBuffStatPairToListIfNotZero(statups, MapleBuffStat.COUPON_EXP1, 1);\n-                        break;\n-                        \n-                    case 2:\n-                        addBuffStatPairToListIfNotZero(statups, MapleBuffStat.COUPON_EXP2, 1);\n-                        break;\n-                            \n-                    case 3:\n-                        addBuffStatPairToListIfNotZero(statups, MapleBuffStat.COUPON_EXP3, 1);\n-                        break;\n-                                \n-                    case 4:\n-                        addBuffStatPairToListIfNotZero(statups, MapleBuffStat.COUPON_EXP4, 1);\n-                        break;\n-                }\n-                \n-                switch(MapleDataTool.getInt(\"drpR\", source, 0)) {\n-                    case 1:\n-                        addBuffStatPairToListIfNotZero(statups, MapleBuffStat.COUPON_DRP1, 1);\n-                        break;\n-                        \n-                    case 2:\n-                        addBuffStatPairToListIfNotZero(statups, MapleBuffStat.COUPON_DRP2, 1);\n-                        break;\n-                            \n-                    case 3:\n-                        addBuffStatPairToListIfNotZero(statups, MapleBuffStat.COUPON_DRP3, 1);\n-                        break;\n+            if(!skill) {\n+                if(isDojoBuff(sourceid)) {\n+                    ret.mhpR = (byte) MapleDataTool.getInt(\"mhpR\", source, 0);\n+                    ret.mhpRRate = (short) (MapleDataTool.getInt(\"mhpRRate\", source, 0) * 100);\n+                    ret.mmpR = (byte) MapleDataTool.getInt(\"mmpRRate\", source, 0);\n+                    ret.mmpRRate = (short) (MapleDataTool.getInt(\"mmpRRate\", source, 0) * 100);\n+\n+                    addBuffStatPairToListIfNotZero(statups, MapleBuffStat.HPREC, Integer.valueOf(ret.mhpR));\n+                    addBuffStatPairToListIfNotZero(statups, MapleBuffStat.MPREC, Integer.valueOf(ret.mmpR));\n+                    \n+                } else if(isRateCoupon(sourceid)) {\n+                    switch(MapleDataTool.getInt(\"expR\", source, 0)) {\n+                        case 1:\n+                            addBuffStatPairToListIfNotZero(statups, MapleBuffStat.COUPON_EXP1, 1);\n+                            break;\n+\n+                        case 2:\n+                            addBuffStatPairToListIfNotZero(statups, MapleBuffStat.COUPON_EXP2, 1);\n+                            break;\n+\n+                        case 3:\n+                            addBuffStatPairToListIfNotZero(statups, MapleBuffStat.COUPON_EXP3, 1);\n+                            break;\n+\n+                        case 4:\n+                            addBuffStatPairToListIfNotZero(statups, MapleBuffStat.COUPON_EXP4, 1);\n+                            break;\n+                    }\n+\n+                    switch(MapleDataTool.getInt(\"drpR\", source, 0)) {\n+                        case 1:\n+                            addBuffStatPairToListIfNotZero(statups, MapleBuffStat.COUPON_DRP1, 1);\n+                            break;\n+\n+                        case 2:\n+                            addBuffStatPairToListIfNotZero(statups, MapleBuffStat.COUPON_DRP2, 1);\n+                            break;\n+\n+                        case 3:\n+                            addBuffStatPairToListIfNotZero(statups, MapleBuffStat.COUPON_DRP3, 1);\n+                            break;\n+                    }\n                 }\n             }\n         }\n@@ -819,7 +833,8 @@ private boolean applyTo(MapleCharacter applyfrom, MapleCharacter applyto, boolea\n         SummonMovementType summonMovementType = getSummonMovementType();\n         if (overTime || isCygnusFA() || summonMovementType != null) {\n             if (summonMovementType != null && pos != null) {\n-                applyto.cancelBuffStats(MapleBuffStat.SUMMON);  // if player has a summon already, drop it\n+                if(summonMovementType.getValue() == summonMovementType.STATIONARY.getValue()) applyto.cancelBuffStats(MapleBuffStat.PUPPET);\n+                else applyto.cancelBuffStats(MapleBuffStat.SUMMON);\n             }\n             \n             applyBuffEffect(applyfrom, applyto, primary);\n@@ -854,7 +869,7 @@ private boolean applyTo(MapleCharacter applyfrom, MapleCharacter applyto, boolea\n             Point doorPosition = new Point(applyto.getPosition().x, y);\n             MapleDoor door = new MapleDoor(applyto, doorPosition);\n             \n-            if(door.getOwnerId() > -1) {\n+            if(door.getOwnerId() >= 0) {\n                 if (applyto.getParty() != null) {\n                     for (MaplePartyCharacter partyMember : applyto.getParty().getMembers()) {\n                         partyMember.getPlayer().addDoor(door.getOwnerId(), door);\n@@ -867,13 +882,17 @@ private boolean applyTo(MapleCharacter applyfrom, MapleCharacter applyto, boolea\n \n                 door.getTarget().spawnDoor(door.getAreaDoor());\n                 door.getTown().spawnDoor(door.getTownDoor());\n+                \n+                applyto.disableDoor();\n             } else {\n-                if(door.getOwnerId() == -1) applyto.dropMessage(5, \"There are no door portals available for the town at this moment. Try again later.\");\n-                else applyto.dropMessage(5, \"Mystic Door cannot be cast on a slope, try elsewhere.\");\n+                MapleInventoryManipulator.addFromDrop(applyto.getClient(), new Item(4006000, (short) 0, (short) 1), false);\n+                \n+                if(door.getOwnerId() == -3) applyto.dropMessage(5, \"Mystic Door cannot be cast far from a spawn point. Nearest one is at \" + door.getDoorStatus().getRight() + \"pts \" + door.getDoorStatus().getLeft());\n+                else if(door.getOwnerId() == -2) applyto.dropMessage(5, \"Mystic Door cannot be cast on a slope, try elsewhere.\");\n+                else applyto.dropMessage(5, \"There are no door portals available for the town at this moment. Try again later.\");\n                 \n                 applyto.cancelBuffStats(MapleBuffStat.SOULARROW);  // cancel door buff\n             }\n-            applyto.disableDoor();\n         }  else if (isMist()) {\n             Rectangle bounds = calculateBoundingBox(sourceid == NightWalker.POISON_BOMB ? pos : applyfrom.getPosition(), applyfrom.isFacingLeft());\n             MapleMist mist = new MapleMist(bounds, applyfrom, this);\n@@ -1046,10 +1065,10 @@ private void applyBuffEffect(MapleCharacter applyfrom, MapleCharacter applyto, b\n             }\n             if (isDash()) {\n                 buff = MaplePacketCreator.givePirateBuff(statups, sourceid, seconds);\n-                mbuff = MaplePacketCreator.giveForgeinPirateBuff(applyto.getId(), sourceid, seconds, localstatups);\n+                mbuff = MaplePacketCreator.giveForeignPirateBuff(applyto.getId(), sourceid, seconds, localstatups);\n             } else if (isInfusion()) {\n             \tbuff = MaplePacketCreator.givePirateBuff(localstatups, sourceid, seconds);\n-                mbuff = MaplePacketCreator.giveForgeinPirateBuff(applyto.getId(), sourceid, seconds, localstatups);\n+                mbuff = MaplePacketCreator.giveForeignPirateBuff(applyto.getId(), sourceid, seconds, localstatups);\n             } else if (isDs()) {\n                 List<Pair<MapleBuffStat, Integer>> dsstat = Collections.singletonList(new Pair<>(MapleBuffStat.DARKSIGHT, 0));\n                 mbuff = MaplePacketCreator.giveForeignBuff(applyto.getId(), dsstat);\n@@ -1277,6 +1296,19 @@ public boolean isBerserk() {\n     public boolean isRecovery() {\n         return sourceid == Beginner.RECOVERY || sourceid == Noblesse.RECOVERY || sourceid == Legend.RECOVERY || sourceid == Evan.RECOVERY;\n     }\n+    \n+    public boolean isDojoBuff() {\n+        return sourceid >= 2022359 && sourceid <= 2022421;\n+    }\n+    \n+    public static boolean isDojoBuff(int sourceid) {\n+        return sourceid >= 2022359 && sourceid <= 2022421;\n+    }\n+    \n+    public static boolean isRateCoupon(int sourceid) {\n+        int itemType = sourceid / 1000;\n+        return itemType == 5211 || itemType == 5360;\n+    }\n \n     private boolean isDs() {\n         return skill && (sourceid == Rogue.DARK_SIGHT || sourceid == WindArcher.WIND_WALK || sourceid == NightWalker.DARK_SIGHT);\n@@ -1303,7 +1335,7 @@ private boolean isChakra() {\n     }\n \n     private boolean isCouponBuff() {\n-        return MapleItemInformationProvider.getInstance().isRateCoupon(sourceid);\n+        return isRateCoupon(sourceid);\n     }\n     \n     private boolean isMysticDoor() {\n@@ -1499,6 +1531,22 @@ public short getHp() {\n     public short getMp() {\n         return mp;\n     }\n+    \n+    public byte getHpR() {\n+        return mhpR;\n+    }\n+\n+    public byte getMpR() {\n+        return mmpR;\n+    }\n+    \n+    public short getHpRRate() {\n+        return mhpRRate;\n+    }\n+\n+    public short getMpRRate() {\n+        return mmpRRate;\n+    }\n \n     public short getHpCon() {\n         return hpCon;"}, {"sha": "c4c2a73b65fc081c3f2b45025a731b318ac56dc1", "filename": "src/server/events/gm/MapleOxQuiz.java", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/server/events/gm/MapleOxQuiz.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/server/events/gm/MapleOxQuiz.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/events/gm/MapleOxQuiz.java?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -63,7 +63,7 @@ private boolean isCorrectAnswer(MapleCharacter chr, int answer) {\n     public void sendQuestion() {\n         int gm = 0;\n         for (MapleCharacter mc : map.getCharacters()) {\n-            if (mc.gmLevel() > 0) {\n+            if (mc.gmLevel() > 1) {\n                 gm++;\n             }\n         }"}, {"sha": "317cac29dfb657723435ee91aa1b40fb5d84bcdc", "filename": "src/server/expeditions/MapleExpedition.java", "status": "modified", "additions": 9, "deletions": 9, "changes": 18, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/server/expeditions/MapleExpedition.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/server/expeditions/MapleExpedition.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/expeditions/MapleExpedition.java?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -96,7 +96,7 @@ public MapleExpedition(MapleCharacter player, MapleExpeditionType met) {\n \tprivate void beginRegistration() {\n \t\tregistering = true;\n                 leader.announce(MaplePacketCreator.getClock(type.getRegistrationTime() * 60));\n-\t\tstartMap.broadcastMessage(MaplePacketCreator.serverNotice(6, leader.getName() + \" has been declared the expedition captain. Please register for the expedition.\"));\n+\t\tstartMap.broadcastMessage(MaplePacketCreator.serverNotice(6, \"[Expedition] \" + leader.getName() + \" has been declared the expedition captain. Please register for the expedition.\"));\n \t\tscheduleRegistrationEnd();\n \t}\n \n@@ -109,7 +109,7 @@ private void scheduleRegistrationEnd() {\n \t\t\tpublic void run() {\n \t\t\t\tif (registering){\n \t\t\t\t\tleader.getClient().getChannelServer().getExpeditions().remove(exped);\n-\t\t\t\t\tstartMap.broadcastMessage(MaplePacketCreator.serverNotice(6, \"Time limit has been reached. Expedition has been disbanded.\"));\n+\t\t\t\t\tstartMap.broadcastMessage(MaplePacketCreator.serverNotice(6, \"[Expedition] The time limit has been reached. Expedition has been disbanded.\"));\n                                         \n                                         dispose(false);\n \t\t\t\t}\n@@ -131,9 +131,9 @@ public void dispose(boolean log){\n \tpublic void start(){\n \t\tregistering = false;\n \t\tbroadcastExped(MaplePacketCreator.removeClock());\n-\t\tbroadcastExped(MaplePacketCreator.serverNotice(6, \"The expedition has started! Good luck, brave heroes!\"));\n+\t\tbroadcastExped(MaplePacketCreator.serverNotice(6, \"[Expedition] The expedition has started! Good luck, brave heroes!\"));\n \t\tstartTime = System.currentTimeMillis();\n-\t\tServer.getInstance().broadcastGMMessage(MaplePacketCreator.serverNotice(6, type.toString() + \" Expedition started with leader: \" + leader.getName()));\n+\t\tServer.getInstance().broadcastGMMessage(MaplePacketCreator.serverNotice(6, \"[Expedition] \" + type.toString() + \" Expedition started with leader: \" + leader.getName()));\n \t}\n \n \tpublic String addMember(MapleCharacter player) {\n@@ -148,7 +148,7 @@ public String addMember(MapleCharacter player) {\n \t\t}\n \t\tif (members.add(player)){\n                         player.announce(MaplePacketCreator.getClock((int)(startTime - System.currentTimeMillis()) / 1000));\n-\t\t\tbroadcastExped(MaplePacketCreator.serverNotice(6, player.getName() + \" has joined the expedition!\"));\n+\t\t\tbroadcastExped(MaplePacketCreator.serverNotice(6, \"[Expedition] \" + player.getName() + \" has joined the expedition!\"));\n \t\t\treturn \"You have registered for the expedition successfully!\";\n \t\t} \n \t\treturn \"Sorry, something went really wrong. Report this on the forum with a screenshot!\";\n@@ -163,8 +163,8 @@ private void broadcastExped(byte [] data){\n \tpublic boolean removeMember(MapleCharacter chr) {\n \t\tif(members.remove(chr)) {\n                     chr.announce(MaplePacketCreator.removeClock());\n-                    broadcastExped(MaplePacketCreator.serverNotice(6, chr.getName() + \" has left the expedition.\"));\n-                    chr.dropMessage(6, \"You have left this expedition.\");\n+                    broadcastExped(MaplePacketCreator.serverNotice(6, \"[Expedition] \" + chr.getName() + \" has left the expedition.\"));\n+                    chr.dropMessage(6, \"[Expedition] You have left this expedition.\");\n                     return true;\n                 }\n                 \n@@ -213,10 +213,10 @@ public void ban(MapleCharacter player) {\n \t\t\tbanned.add(player.getId());\n \t\t\tmembers.remove(player);\n                         \n-                        broadcastExped(MaplePacketCreator.serverNotice(6, player.getName() + \" has been banned from the expedition.\"));\n+                        broadcastExped(MaplePacketCreator.serverNotice(6, \"[Expedition] \" + player.getName() + \" has been banned from the expedition.\"));\n                         \n                         player.announce(MaplePacketCreator.removeClock());\n-                        player.dropMessage(6, \"You have been banned from this expedition.\");\n+                        player.dropMessage(6, \"[Expedition] You have been banned from this expedition.\");\n \t\t}\n \t}\n "}, {"sha": "291a258c4345c3bf7ac671b566b1fd0c89af1a0d", "filename": "src/server/expeditions/MapleExpeditionType.java", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/server/expeditions/MapleExpeditionType.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/server/expeditions/MapleExpeditionType.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/expeditions/MapleExpeditionType.java?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -31,9 +31,10 @@\n \n     BALROG_EASY(3, 30, 50, 255, 5),\n     BALROG_NORMAL(6, 30, 50, 255, 5),\n-    SCARGA(3, 6, 100, 255, 5),\n+    SCARGA(6, 30, 100, 255, 5),\n+    SHOWA(3, 30, 100, 255, 5),\n     ZAKUM(6, 30, 50, 255, 5),\n-    HORNTAIL(6, 30, 80, 255,5),\n+    HORNTAIL(6, 30, 100, 255, 5),\n     CHAOS_ZAKUM(6, 30, 120, 255, 5),\n     CHAOS_HORNTAIL(6, 30, 120, 255, 5),\n     PINKBEAN(6, 30, 120, 255, 5),"}, {"sha": "c738231c83257fe1c1ee9cd43fef434461714c9c", "filename": "src/server/life/MapleMonster.java", "status": "modified", "additions": 10, "deletions": 13, "changes": 23, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/server/life/MapleMonster.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/server/life/MapleMonster.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/life/MapleMonster.java?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -179,7 +179,7 @@ public MapleMonsterStats getStats() {\n     }\n \n     public boolean isBoss() {\n-        return stats.isBoss() || isHT();\n+        return stats.isBoss();\n     }\n \n     public int getAnimationTime(String name) {\n@@ -209,18 +209,19 @@ public synchronized void damage(MapleCharacter from, int damage) { // may be poi\n         }\n         int trueDamage = Math.min(hp, damage); // since magic happens otherwise B^)\n         \n-        if(ServerConstants.USE_DEBUG == true && from != null) from.dropMessage(5, \"Hitted MOB \" + this.getId() + \", OID \" + this.getObjectId());\n+        if(ServerConstants.USE_DEBUG == true) from.dropMessage(5, \"Hitted MOB \" + this.getId() + \", OID \" + this.getObjectId());\n         dispatchMonsterDamaged(from, trueDamage);\n \n-        hp -= damage;\n-        if (takenDamage.containsKey(from.getId())) {\n-            takenDamage.get(from.getId()).addAndGet(trueDamage);\n-        } else {\n+        hp -= trueDamage;\n+        if (!takenDamage.containsKey(from.getId())) {\n             takenDamage.put(from.getId(), new AtomicInteger(trueDamage));\n+        } else {\n+            takenDamage.get(from.getId()).addAndGet(trueDamage);\n         }\n \n         if (hasBossHPBar()) {\n-            from.getMap().broadcastMessage(makeBossHPBarPacket(), getPosition());\n+            from.setPlayerAggro(this.hashCode());\n+            from.getMap().broadcastBossHpMessage(this, this.hashCode(), makeBossHPBarPacket(), getPosition());\n         } else if (!isBoss()) {\n             int remainingHP = (int) Math.max(1, hp * 100f / getMaxHp());\n             byte[] packet = MaplePacketCreator.showMonsterHP(getObjectId(), remainingHP);\n@@ -531,11 +532,7 @@ public void setControllerKnowsAboutAggro(boolean controllerKnowsAboutAggro) {\n     }\n \n     public boolean hasBossHPBar() {\n-        return (isBoss() && getTagColor() > 0) || isHT();\n-    }\n-\n-    private boolean isHT() {\n-        return getId() == 8810018;\n+        return isBoss() && getTagColor() > 0;\n     }\n \n     @Override\n@@ -558,7 +555,7 @@ public void sendSpawnData(MapleClient c) {\n                 this.getMap().killAllMonsters();\n                 return;\n             }\n-            c.announce(makeBossHPBarPacket());\n+            c.announceBossHpBar(this, this.hashCode(), makeBossHPBarPacket());\n         }\n     }\n "}, {"sha": "30174112c53356e925bff3e9f3049e155decbf7b", "filename": "src/server/life/MobSkill.java", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/server/life/MobSkill.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/server/life/MobSkill.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/life/MobSkill.java?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -104,8 +104,8 @@ public void setLimit(int limit) {\n \n     public void applyEffect(MapleCharacter player, MapleMonster monster, boolean skill) {\n         MapleDisease disease = null;\n-\t\tMap<MonsterStatus, Integer> stats = new ArrayMap<MonsterStatus, Integer>();\n-\t\tList<Integer> reflection = new LinkedList<Integer>();\n+        Map<MonsterStatus, Integer> stats = new ArrayMap<MonsterStatus, Integer>();\n+        List<Integer> reflection = new LinkedList<Integer>();\n         switch (skillId) {\n             case 100:\n             case 110:\n@@ -274,9 +274,9 @@ public void applyEffect(MapleCharacter player, MapleMonster monster, boolean ski\n                     }\n                 }\n                 break;\n-              default:\n-            \t  System.out.println(\"Unhandled Mob skill: \" + skillId);\n-            \t  break;\n+            default:\n+                System.out.println(\"Unhandled Mob skill: \" + skillId);\n+                break;\n         }\n \t\tif (stats.size() > 0) {\n \t\t    if (lt != null && rb != null && skill) {"}, {"sha": "85e405abe8f514571e41bc091f8680f7e1556a61", "filename": "src/server/maps/MapleDoor.java", "status": "modified", "additions": 27, "deletions": 29, "changes": 56, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/server/maps/MapleDoor.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/server/maps/MapleDoor.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/maps/MapleDoor.java?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -22,11 +22,11 @@\n package server.maps;\n \n import java.awt.Point;\n-import java.util.Collections;\n-import java.util.List;\n+import tools.Pair;\n \n import server.MaplePortal;\n import client.MapleCharacter;\n+import constants.ServerConstants;\n \n /**\n  *\n@@ -38,6 +38,7 @@\n     private MapleMap town;\n     private MaplePortal townPortal;\n     private MapleMap target;\n+    private Pair<String, Integer> posStatus = null;\n     \n     private MapleDoorObject townDoor;\n     private MapleDoorObject areaDoor;\n@@ -47,43 +48,37 @@ public MapleDoor(MapleCharacter owner, Point targetPosition) {\n         this.target = owner.getMap();\n         \n         if(target.canDeployDoor(targetPosition)) {\n-            this.town = this.target.getReturnMap();\n-            this.townPortal = allocateFreePortal();\n+            if(ServerConstants.USE_ENFORCE_MDOOR_POSITION) {\n+                 posStatus = target.getDoorPositionStatus(targetPosition);\n+            }\n+            \n+            if(posStatus == null) {\n+                this.town = this.target.getReturnMap();\n+                this.townPortal = getDoorPortal(owner.getDoorSlot());\n \n-            if(townPortal != null) {\n-                this.areaDoor = new MapleDoorObject(ownerId, town, target, false, targetPosition, townPortal.getPosition());\n-                this.townDoor = new MapleDoorObject(ownerId, target, town, true, townPortal.getPosition(), targetPosition);\n+                if(townPortal != null) {\n+                    this.areaDoor = new MapleDoorObject(ownerId, town, target, false, targetPosition, townPortal.getPosition());\n+                    this.townDoor = new MapleDoorObject(ownerId, target, town, true, townPortal.getPosition(), targetPosition);\n \n-                this.areaDoor.setPairOid(this.townDoor.getObjectId());\n-                this.townDoor.setPairOid(this.areaDoor.getObjectId());\n+                    this.areaDoor.setPairOid(this.townDoor.getObjectId());\n+                    this.townDoor.setPairOid(this.areaDoor.getObjectId());\n+                } else {\n+                    this.ownerId = -1;\n+                }\n             } else {\n-                this.ownerId = -1;\n+                this.ownerId = -3;\n             }\n         } else {\n             this.ownerId = -2;\n         }\n     }\n     \n-    public void freeAllocatedPortal() {\n-        if(townPortal != null) {\n-            town.setDisposeDoorPortal(townPortal);\n-        }\n-    }\n-    \n-    private MaplePortal allocateFreePortal() {\n-        List<MaplePortal> availablePortals = town.getAvailableDoorPortals();\n-        if(availablePortals.isEmpty() || !town.getNotUsingDoorPortal()) return null;\n-        \n-        Collections.shuffle(availablePortals);\n-        while(!availablePortals.isEmpty()) {\n-            MaplePortal port = availablePortals.remove(0);\n-            \n-            if(town.setUsingDoorPortal(port)) {\n-                return port;\n-            }\n+    private MaplePortal getDoorPortal(int slot) {\n+        try {\n+            return town.getAvailableDoorPortals().get(slot);\n+        } catch (IndexOutOfBoundsException e) {\n+            return town.getAvailableDoorPortals().get(0);\n         }\n-        \n-        return null;\n     }\n     \n     public int getOwnerId() {\n@@ -110,4 +105,7 @@ public MapleMap getTarget() {\n         return target;\n     }\n \n+    public Pair<String, Integer> getDoorStatus() {\n+        return posStatus;\n+    }\n }"}, {"sha": "65c038ab68b367d0708b797b0b566eb66b8634bb", "filename": "src/server/maps/MapleDoorObject.java", "status": "modified", "additions": 7, "deletions": 7, "changes": 14, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/server/maps/MapleDoorObject.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/server/maps/MapleDoorObject.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/maps/MapleDoorObject.java?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -51,9 +51,10 @@ public MapleDoorObject(int owner, MapleMap destination, MapleMap origin, boolean\n         toPos = toPosition;\n     }\n     \n-    public void warp(MapleCharacter chr, boolean toTown) {\n+    public void warp(final MapleCharacter chr, boolean toTown) {\n         if (chr.getId() == ownerId || (chr.getParty() != null && chr.getParty().getMemberById(ownerId) != null)) {\n-            chr.changeMap(to, toPos);\n+            if(chr.getParty() == null && (to.isLastDoorOwner(chr.getId()) || toTown)) chr.changeMap(to, toPos);\n+            else chr.changeMap(to, to.findClosestPlayerSpawnpoint(toPos));    // weird issues happens with party, relocating players elsewhere....\n         } else {\n             chr.getClient().announce(MaplePacketCreator.blockedMessage(6));\n             chr.getClient().announce(MaplePacketCreator.enableActions());\n@@ -63,13 +64,12 @@ public void warp(MapleCharacter chr, boolean toTown) {\n     @Override\n     public void sendSpawnData(MapleClient client) {\n         if (from.getId() == client.getPlayer().getMapId()) {\n-            client.announce(MaplePacketCreator.spawnPortal(this.getFrom().getId(), this.getTo().getId(), this.toPosition()));\n-            \n-            if(!this.inTown()) client.announce(MaplePacketCreator.spawnDoor(this.getOwnerId(), this.getPosition(), true));\n-            \n             if (client.getPlayer().getParty() != null && (ownerId == client.getPlayer().getId() || client.getPlayer().getParty().getMemberById(ownerId) != null)) {\n-                client.announce(MaplePacketCreator.partyPortal(this.getTown().getId(), this.getArea().getId(), this.getAreaPosition()));\n+                client.announce(MaplePacketCreator.partyPortal(this.getFrom().getId(), this.getTo().getId(), this.toPosition()));\n             }\n+            \n+            client.announce(MaplePacketCreator.spawnPortal(this.getFrom().getId(), this.getTo().getId(), this.toPosition()));\n+            if(!this.inTown()) client.announce(MaplePacketCreator.spawnDoor(this.getOwnerId(), this.getPosition(), true));\n         }\n     }\n "}, {"sha": "f45d3fa214bcdbce9924f21f5447bfd08e2ff50c", "filename": "src/server/maps/MapleMap.java", "status": "modified", "additions": 169, "deletions": 81, "changes": 250, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/server/maps/MapleMap.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/server/maps/MapleMap.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/maps/MapleMap.java?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -45,8 +45,6 @@\n import java.util.LinkedHashSet;\n import java.util.LinkedList;\n import java.util.List;\n-import java.util.Set;\n-import java.util.HashSet;\n import java.util.Iterator;\n import java.util.Map;\n import java.util.Map.Entry;\n@@ -95,8 +93,7 @@\n     private Collection<MapleCharacter> characters = new LinkedHashSet<>();\n     private Map<Integer, MaplePortal> portals = new HashMap<>();\n     private Map<Integer, Integer> backgroundTypes = new HashMap<>();\n-    private Map<String, Integer> environment = new LinkedHashMap<String, Integer>();\n-    private Set<Integer> usedDoors = new HashSet<>();\n+    private Map<String, Integer> environment = new LinkedHashMap<>();\n     private List<Rectangle> areas = new ArrayList<>();\n     private MapleFootholdTree footholds = null;\n     private int mapid;\n@@ -129,6 +126,7 @@\n     private Pair<Integer, String> timeMob = null;\n     private short mobInterval = 5000;\n     private boolean allowSummons = true; // All maps should have this true at the beginning\n+    private int lastDoorOwner = -1;\n     // HPQ\n     private int riceCakes = 0;\n     private int bunnyDamage = 0;\n@@ -186,7 +184,7 @@ public void broadcastGMMessage(MapleCharacter source, final byte[] packet) {\n         chrRLock.lock();\n         try {\n             for (MapleCharacter chr : characters) {\n-                if (chr != source && (chr.gmLevel() > source.gmLevel())) {\n+                if (chr != source && (chr.gmLevel() >= source.gmLevel())) {\n                     chr.getClient().announce(packet);\n                 }\n             }\n@@ -200,7 +198,7 @@ public void toggleDrops() {\n     }\n     \n     \n-    private double getRangedDistance() {\n+    private static double getRangedDistance() {\n         return(ServerConstants.USE_MAXRANGE ? Double.POSITIVE_INFINITY : 722500);\n     }\n \n@@ -354,8 +352,8 @@ private void spawnAndAddRangedMapObject(MapleMapObject mapobject, DelayedPacketC\n                 }\n             }\n         } finally {\n-            chrRLock.unlock();\n             objectWLock.unlock();\n+            chrRLock.unlock();\n         }\n     }\n     \n@@ -436,7 +434,56 @@ public Point calcDropPos(Point initial, Point fallback) {\n     \n     public boolean canDeployDoor(Point pos) {\n         Point toStep = calcPointBelow(pos);\n-        return toStep != null && toStep.distance(pos) < 20;\n+        return toStep != null && toStep.distance(pos) <= 42;\n+    }\n+    \n+    /**\n+     * Fetches angle relative between spawn and door points\n+     * where 3 O'Clock is 0 and 12 O'Clock is 270 degrees\n+     * \n+     * @param spawnPoint\n+     * @param doorPoint\n+     * @return angle in degress from 0-360.\n+     */\n+    private static double getAngle(Point doorPoint, Point spawnPoint) {\n+        double dx = doorPoint.getX() - spawnPoint.getX();\n+        // Minus to correct for coord re-mapping\n+        double dy = -(doorPoint.getY() - spawnPoint.getY());\n+\n+        double inRads = Math.atan2(dy, dx);\n+\n+        // We need to map to coord system when 0 degree is at 3 O'clock, 270 at 12 O'clock\n+        if (inRads < 0)\n+            inRads = Math.abs(inRads);\n+        else\n+            inRads = 2 * Math.PI - inRads;\n+\n+        return Math.toDegrees(inRads);\n+    }\n+    \n+    /**\n+     * Converts angle in degrees to rounded cardinal coordinate.\n+     * \n+     * @param angle\n+     * @return correspondent coordinate.\n+     */\n+    public static String getRoundedCoordinate(double angle) {\n+        String directions[] = {\"E\", \"SE\", \"S\", \"SW\", \"W\", \"NW\", \"N\", \"NE\", \"E\"};\n+        return directions[ (int)Math.round((  ((double)angle % 360) / 45)) ];\n+    }\n+    \n+    public Pair<String, Integer> getDoorPositionStatus(Point pos) {\n+        MaplePortal portal = findClosestPlayerSpawnpoint(pos);\n+        \n+        double angle = getAngle(portal.getPosition(), pos);\n+        double distn = pos.distanceSq(portal.getPosition());\n+        \n+        if(distn <= 777777.7) {\n+            return null;\n+        }\n+        \n+        distn = Math.sqrt(distn);\n+        return new Pair(getRoundedCoordinate(angle), Integer.valueOf((int)distn));\n     }\n \n     private void dropFromMonster(final MapleCharacter chr, final MapleMonster mob) {\n@@ -563,10 +610,14 @@ public MapleMonster getMonsterById(int id) {\n     }\n \n     public int countMonster(int id) {\n+        return countMonster(id, id);\n+    }\n+    \n+    public int countMonster(int minid, int maxid) {\n         int count = 0;\n         for (MapleMapObject m : getMapObjectsInRange(new Point(0, 0), Double.POSITIVE_INFINITY, Arrays.asList(MapleMapObjectType.MONSTER))) {\n             MapleMonster mob = (MapleMonster) m;\n-            if (mob.getId() == id) {\n+            if (mob.getId() >= minid && mob.getId() <= maxid) {\n                 count++;\n             }\n         }\n@@ -726,7 +777,23 @@ public boolean damageMonster(final MapleCharacter chr, final MapleMonster monste\n     public void broadcastHorntailVictory() {\n         for (Channel cserv : Server.getInstance().getWorld(world).getChannels()) {\n             for (MapleCharacter player : cserv.getPlayerStorage().getAllCharacters()) {\n-                player.dropMessage(\"To the crew that have finally conquered Horned Tail after numerous attempts, I salute thee! You are the true heroes of Leafre!!\");\n+                player.dropMessage(6, \"[VICTORY] To the crew that have finally conquered Horned Tail after numerous attempts, I salute thee! You are the true heroes of Leafre!!\");\n+            }\n+        }\n+    }\n+    \n+    public void broadcastZakumVictory() {\n+        for (Channel cserv : Server.getInstance().getWorld(world).getChannels()) {\n+            for (MapleCharacter player : cserv.getPlayerStorage().getAllCharacters()) {\n+                player.dropMessage(6, \"[VICTORY] At last, the tree of evil that for so long overwhelmed Ossyria has fallen. To the crew that managed to finally conquer Zakum, after numerous attempts, victory! You are the true heroes of Ossyria!!\");\n+            }\n+        }\n+    }\n+    \n+    public void broadcastPinkBeanVictory(int channel) {\n+        for (Channel cserv : Server.getInstance().getWorld(world).getChannels()) {\n+            for (MapleCharacter player : cserv.getPlayerStorage().getAllCharacters()) {\n+                player.dropMessage(6, \"[VICTORY] In a swift stroke of sorts, the crew that has attempted Pink Bean at channel \" + channel + \" has ultimately defeated it. The Temple of Time shines radiantly once again, the day finally coming back, as the crew that managed to finally conquer it returns victoriously from the battlefield!!\");\n             }\n         }\n     }\n@@ -814,6 +881,14 @@ public void killMonster(final MapleMonster monster, final MapleCharacter chr, fi\n             dropFromMonster(dropOwner, monster);\n         }\n         \n+        if (monster.hasBossHPBar()) {\n+            for(MapleCharacter mc : this.getAllPlayers()) {\n+                if(mc.getTargetHpBarHash() == monster.hashCode()) {\n+                    mc.resetPlayerAggro();\n+                }\n+            }\n+        }\n+        \n         monster.dispatchMonsterKilled();\n         broadcastMessage(MaplePacketCreator.killMonster(monster.getObjectId(), animation), monster.getPosition());\n     }\n@@ -823,7 +898,9 @@ public void killFriendlies(MapleMonster mob) {\n     }\n \n     public void killMonster(int monsId) {\n-        for (MapleMapObject mmo : getMapObjects()) {\n+        List<MapleMapObject> mmoL = new LinkedList(getMapObjects());\n+        \n+        for (MapleMapObject mmo : mmoL) {\n             if (mmo instanceof MapleMonster) {\n                 if (((MapleMonster) mmo).getId() == monsId) {\n                     this.killMonster((MapleMonster) mmo, (MapleCharacter) getPlayers().get(0), false);\n@@ -980,8 +1057,6 @@ public final void shuffleReactors(int first, int last) {\n     public final void shuffleReactors(List<Object> list) {\n         List<Point> points = new ArrayList<>();\n         List<MapleMapObject> listObjects = new ArrayList<>();\n-        \n-        List<MapleMapObject> reactors = getReactors();\n         List<MapleMapObject> targets = new LinkedList<>();\n         \n         objectRLock.lock();\n@@ -990,7 +1065,7 @@ public final void shuffleReactors(List<Object> list) {\n                 if(obj instanceof MapleMapObject) {\n                     MapleMapObject mmo = (MapleMapObject) obj;\n                     \n-                    if(mapobjects.containsValue(mmo)) {\n+                    if(mapobjects.containsValue(mmo) && mmo.getType() == MapleMapObjectType.REACTOR) {\n                         listObjects.add(mmo);\n                     }\n                 }\n@@ -1328,17 +1403,14 @@ public void spawnMonsterWithEffect(final MapleMonster monster, final int effect,\n         \n         spos.y--;\n         monster.setPosition(spos);\n-        if (mapid < 925020000 || mapid > 925030000) {\n-            monster.disableDrops();\n-        }\n         spawnAndAddRangedMapObject(monster, new DelayedPacketCreation() {\n             @Override\n             public void sendPackets(MapleClient c) {\n                 c.announce(MaplePacketCreator.spawnMonster(monster, true, effect));\n             }\n         });\n         if (monster.hasBossHPBar()) {\n-            broadcastMessage(monster.makeBossHPBarPacket(), monster.getPosition());\n+            broadcastBossHpMessage(monster, monster.hashCode(), monster.makeBossHPBarPacket(), monster.getPosition());\n         }\n         updateMonsterController(monster);\n \n@@ -1393,12 +1465,12 @@ public void spawnDoor(final MapleDoorObject door) {\n             @Override\n             public void sendPackets(MapleClient c) {\n                 if (door.getFrom().getId() == c.getPlayer().getMapId()) {\n-                    c.announce(MaplePacketCreator.spawnPortal(door.getFrom().getId(), door.getTo().getId(), door.toPosition()));\n-                    if(!door.inTown()) c.announce(MaplePacketCreator.spawnDoor(door.getOwnerId(), door.getPosition(), false));\n-                    \n                     if (c.getPlayer().getParty() != null && (door.getOwnerId() == c.getPlayer().getId() || c.getPlayer().getParty().getMemberById(door.getOwnerId()) != null)) {\n-                        c.announce(MaplePacketCreator.partyPortal(door.getTown().getId(), door.getArea().getId(), door.getAreaPosition()));\n+                        c.announce(MaplePacketCreator.partyPortal(door.getFrom().getId(), door.getTo().getId(), door.toPosition()));\n                     }\n+                    \n+                    c.announce(MaplePacketCreator.spawnPortal(door.getFrom().getId(), door.getTo().getId(), door.toPosition()));\n+                    if(!door.inTown()) c.announce(MaplePacketCreator.spawnDoor(door.getOwnerId(), door.getPosition(), false));\n                 }\n \n                 c.announce(MaplePacketCreator.enableActions());\n@@ -1409,36 +1481,8 @@ public boolean canSpawn(MapleCharacter chr) {\n                 return chr.getMapId() == door.getFrom().getId();\n             }\n         });\n-    }\n-    \n-    public boolean setUsingDoorPortal(MaplePortal port) {\n-        objectWLock.lock();\n-        try {\n-            if(usedDoors.contains(port.getId())) return false;\n-            \n-            usedDoors.add(port.getId());\n-            return true;\n-        } finally {\n-            objectWLock.unlock();\n-        }\n-    }\n-    \n-    public void setDisposeDoorPortal(MaplePortal port) {\n-        objectWLock.lock();\n-        try {\n-            usedDoors.remove(port.getId());\n-        } finally {\n-            objectWLock.unlock();\n-        }\n-    }\n-    \n-    public boolean getNotUsingDoorPortal() {\n-        objectRLock.lock();\n-        try {\n-            return usedDoors.isEmpty();\n-        } finally {\n-            objectRLock.unlock();\n-        }\n+        \n+        if(!door.inTown()) setLastDoorOwner(door.getOwnerId());\n     }\n     \n     public List<MaplePortal> getAvailableDoorPortals() {\n@@ -1447,7 +1491,7 @@ public boolean getNotUsingDoorPortal() {\n             List<MaplePortal> availablePortals = new ArrayList<>();\n             \n             for (MaplePortal port : getPortals()) {\n-                if (port.getType() == MaplePortal.DOOR_PORTAL && !usedDoors.contains(port.getId())) {\n+                if (port.getType() == MaplePortal.DOOR_PORTAL) {\n                     availablePortals.add(port);\n                 }\n             }\n@@ -1905,7 +1949,6 @@ public void removePlayer(MapleCharacter chr) {\n             updateMonsterController(monster);\n         }\n         chr.leaveMap();\n-        chr.cancelMapTimeLimitTask();\n         \n         for (MapleSummon summon : new ArrayList<>(chr.getSummonsValues())) {\n             if (summon.isStationary()) {\n@@ -1933,6 +1976,10 @@ public void broadcastStringMessage(int type, String message) {\n         broadcastMessage(MaplePacketCreator.serverNotice(type, message));\n     }\n \n+    public void broadcastBossHpMessage(MapleMonster mm, int bossHash, final byte[] packet) {\n+        broadcastBossHpMessage(mm, bossHash, null, packet, Double.POSITIVE_INFINITY, null);\n+    }\n+    \n     public void broadcastMessage(final byte[] packet) {\n         broadcastMessage(null, packet, Double.POSITIVE_INFINITY, null);\n     }\n@@ -1973,6 +2020,10 @@ public void broadcastMessage(MapleCharacter source, final byte[] packet, boolean\n     public void broadcastMessage(final byte[] packet, Point rangedFrom) {\n         broadcastMessage(null, packet, getRangedDistance(), rangedFrom);\n     }\n+    \n+    public void broadcastBossHpMessage(MapleMonster mm, int bossHash, final byte[] packet, Point rangedFrom) {\n+        broadcastBossHpMessage(mm, bossHash, null, packet, getRangedDistance(), rangedFrom);\n+    }\n \n     /**\n      * Always ranged from point. Does not repeat to source.\n@@ -2003,6 +2054,25 @@ private void broadcastMessage(MapleCharacter source, final byte[] packet, double\n             chrRLock.unlock();\n         }\n     }\n+    \n+    private void broadcastBossHpMessage(MapleMonster mm, int bossHash, MapleCharacter source, final byte[] packet, double rangeSq, Point rangedFrom) {\n+        chrRLock.lock();\n+        try {\n+            for (MapleCharacter chr : characters) {\n+                if (chr != source) {\n+                    if (rangeSq < Double.POSITIVE_INFINITY) {\n+                        if (rangedFrom.distanceSq(chr.getPosition()) <= rangeSq) {\n+                            chr.getClient().announceBossHpBar(mm, bossHash, packet);\n+                        }\n+                    } else {\n+                        chr.getClient().announceBossHpBar(mm, bossHash, packet);\n+                    }\n+                }\n+            }\n+        } finally {\n+            chrRLock.unlock();\n+        }\n+    }\n \n     private boolean isNonRangedType(MapleMapObjectType type) {\n         switch (type) {\n@@ -2020,32 +2090,38 @@ private boolean isNonRangedType(MapleMapObjectType type) {\n \n     private void sendObjectPlacement(MapleClient mapleClient) {\n         MapleCharacter chr = mapleClient.getPlayer();\n+        Collection<MapleMapObject> objects;\n+        \n         objectRLock.lock();\n         try {\n-            for (MapleMapObject o : mapobjects.values()) {\n-                if (o.getType() == MapleMapObjectType.SUMMON) {\n-                    MapleSummon summon = (MapleSummon) o;\n-                    if (summon.getOwner() == chr) {\n-                        if (chr.isSummonsEmpty() || !chr.containsSummon(summon)) {\n-                            objectWLock.lock();\n-                            try {\n-                                mapobjects.remove(o);\n-                            } finally {\n-                                objectWLock.unlock();\n-                            }\n-                            continue;\n+            objects = Collections.unmodifiableCollection(mapobjects.values());\n+        } finally {\n+            objectRLock.unlock();\n+        }\n+        \n+        for (MapleMapObject o : objects) {\n+            if (o.getType() == MapleMapObjectType.SUMMON) {\n+                MapleSummon summon = (MapleSummon) o;\n+                if (summon.getOwner() == chr) {\n+                    if (chr.isSummonsEmpty() || !chr.containsSummon(summon)) {\n+                        objectWLock.lock();\n+                        try {\n+                            mapobjects.remove(o.getObjectId());\n+                        } finally {\n+                            objectWLock.unlock();\n                         }\n+                        \n+                        continue;\n                     }\n                 }\n-                if (isNonRangedType(o.getType())) {\n-                    o.sendSpawnData(mapleClient);\n-                } else if (o.getType() == MapleMapObjectType.MONSTER) {\n-                    updateMonsterController((MapleMonster) o);\n-                }\n             }\n-        } finally {\n-            objectRLock.unlock();\n+            if (isNonRangedType(o.getType())) {\n+                o.sendSpawnData(mapleClient);\n+            } else if (o.getType() == MapleMapObjectType.MONSTER) {\n+                updateMonsterController((MapleMonster) o);\n+            }\n         }\n+        \n         if (chr != null) {\n             for (MapleMapObject o : getMapObjectsInRange(chr.getPosition(), getRangedDistance(), rangedMapobjectTypes)) {\n                 if (o.getType() == MapleMapObjectType.REACTOR) {\n@@ -2372,15 +2448,15 @@ public void makeDisappearItemFromMap(MapleMapObject mapobj) {\n     \n     public void makeDisappearItemFromMap(MapleMapItem mapitem) {\n         if (mapitem != null && mapitem == getMapObject(mapitem.getObjectId())) {\n-            mapitem.itemLock.lock();\n+            mapitem.lockItem();\n             try {\n                 if (mapitem.isPickedUp()) {\n                     return;\n                 }\n                 MapleMap.this.broadcastMessage(MaplePacketCreator.removeItemFromMap(mapitem.getObjectId(), 0, 0), mapitem.getPosition());\n                 mapitem.setPickedUp(true);\n             } finally {\n-                mapitem.itemLock.unlock();\n+                mapitem.unlockItem();\n                 MapleMap.this.removeMapObject(mapitem);\n             }\n         }\n@@ -2417,7 +2493,7 @@ public void run() {\n             reactor.lockReactor();\n             try {\n                 if (reactor.getShouldCollect() == true && mapitem != null && mapitem == getMapObject(mapitem.getObjectId())) {\n-                    mapitem.itemLock.lock();\n+                    mapitem.lockItem();\n                     try {\n                         TimerManager tMan = TimerManager.getInstance();\n                         if (mapitem.isPickedUp()) {\n@@ -2445,7 +2521,7 @@ public void run() {\n                             }, reactor.getDelay());\n                         }\n                     } finally {\n-                        mapitem.itemLock.unlock();\n+                        mapitem.unlockItem();\n                     }\n                 }\n             } finally {\n@@ -2927,14 +3003,14 @@ public void clearMapObjects() {\n         resetReactors();\n     }\n     \n-    public void resetMapObjects() {\n-        resetMapObjects(1, false);\n-    }\n-    \n     public final void resetFully() {\n         resetMapObjects();\n     }\n     \n+    public void resetMapObjects() {\n+        resetMapObjects(1, false);\n+    }\n+    \n     public void resetPQ() {\n         resetPQ(1);\n     }\n@@ -2960,10 +3036,22 @@ public void broadcastEnemyShip(final boolean state) {\n         this.setDocked(state);\n     }\n     \n+    public boolean isLastDoorOwner(int cid) {\n+        return lastDoorOwner == cid;\n+    }\n+    \n+    public void setLastDoorOwner(int cid) {\n+        lastDoorOwner = cid;\n+    }\n+    \n     public boolean isDojoMap() {\n         return mapid >= 925020000 && mapid < 925040000;\n     }\n     \n+    public boolean isDojoFightMap() {\n+        return isDojoMap() && (((mapid / 100) % 100) % 6) > 0;\n+    }\n+    \n     public boolean isHorntailDefeated() {   // all parts of dead horntail can be found here?\n         for(int i = 8810010; i <= 8810017; i++) {\n             if(getMonsterById(i) == null) return false;"}, {"sha": "c6698a876443466f61ed8cb04d5b45ed61a9c54f", "filename": "src/server/maps/MapleMapItem.java", "status": "modified", "additions": 16, "deletions": 8, "changes": 24, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/server/maps/MapleMapItem.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/server/maps/MapleMapItem.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/maps/MapleMapItem.java?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -35,7 +35,7 @@\n     protected byte type;\n     protected boolean pickedUp = false, playerDrop;\n     protected long dropTime;\n-    public ReentrantLock itemLock = new ReentrantLock();\n+    private ReentrantLock itemLock = new ReentrantLock();\n \n     public MapleMapItem(Item item, Point position, MapleMapObject dropper, MapleCharacter owner, byte type, boolean playerDrop) {\n \tsetPosition(position);\n@@ -107,17 +107,25 @@ public void setPickedUp(final boolean pickedUp) {\n \tthis.pickedUp = pickedUp;\n     }\n \t\n-\tpublic long getDropTime() {\n-\t\treturn dropTime;\n-\t}\n-\t\n-\tpublic void setDropTime(long time) {\n-\t\tthis.dropTime  = time;\n-\t}\n+    public long getDropTime() {\n+        return dropTime;\n+    }\n+\n+    public void setDropTime(long time) {\n+        this.dropTime  = time;\n+    }\n \n     public byte getDropType() {\n \treturn type;\n     }\n+    \n+    public void lockItem() {\n+        itemLock.lock();\n+    }\n+    \n+    public void unlockItem() {\n+        itemLock.unlock();\n+    }\n \n     @Override\n     public final MapleMapObjectType getType() {"}, {"sha": "92025c83f26cbdbb93a071530f4a91bdc26178bc", "filename": "src/server/quest/actions/ItemAction.java", "status": "modified", "additions": 116, "deletions": 57, "changes": 173, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/server/quest/actions/ItemAction.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/server/quest/actions/ItemAction.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/quest/actions/ItemAction.java?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -22,14 +22,15 @@\n package server.quest.actions;\n \n import client.MapleCharacter;\n+import client.MapleClient;\n import client.inventory.Item;\n import client.inventory.MapleInventory;\n import client.inventory.MapleInventoryType;\n import java.util.ArrayList;\n-import java.util.EnumMap;\n-import java.util.HashMap;\n+import java.util.Collections;\n+import java.util.Comparator;\n+import java.util.LinkedList;\n import java.util.List;\n-import java.util.Map;\n import provider.MapleData;\n import provider.MapleDataTool;\n import server.MapleInventoryManipulator;\n@@ -73,12 +74,24 @@ public void processData(MapleData data) {\n \t\t\tif (iEntry.getChildByPath(\"job\") != null)\n \t\t\t\tjob = MapleDataTool.getInt(iEntry.getChildByPath(\"job\"));\n \t\t\t\n-\t\t\titems.add(new ItemData(id, count, prop, job, gender));\n+\t\t\titems.add(new ItemData(Integer.parseInt(iEntry.getName()), id, count, prop, job, gender));\n \t\t}\n+                \n+                Collections.sort(items, new Comparator<ItemData>()\n+                {\n+                    @Override\n+                    public int compare( ItemData o1, ItemData o2 )\n+                    {\n+                        return o1.map - o2.map;\n+                    }\n+                });\n \t}\n \t\n \t@Override\n \tpublic void run(MapleCharacter chr, Integer extSelection) {\n+                List<Pair<Integer, Integer>> takeItem = new LinkedList<>();\n+                List<Pair<Integer, Integer>> giveItem = new LinkedList<>();\n+            \n \t\tMapleItemInformationProvider ii = MapleItemInformationProvider.getInstance();\n                 int props = 0, rndProps = 0, accProps = 0;\n \t\tfor(ItemData item : items) {\n@@ -110,69 +123,114 @@ public void run(MapleCharacter chr, Integer extSelection) {\n                                 }\n \t\t\t}\n \t\t\t\n-\t\t\tif(iEntry.getCount() < 0) { // Remove Items\n-\t\t\t\tMapleInventoryType type = ii.getInventoryType(iEntry.getId());\n-\t\t\t\tint quantity = iEntry.getCount() * -1; // Invert\n-\t\t\t\tif(type.equals(MapleInventoryType.EQUIP)) {\n-\t\t\t\t\tif(chr.getInventory(type).countById(iEntry.getId()) < quantity) {\n-\t\t\t\t\t\t// Not enough in the equip inventoty, so check Equipped...\n-\t\t\t\t\t\tif(chr.getInventory(MapleInventoryType.EQUIPPED).countById(iEntry.getId()) > quantity) {\n-\t\t\t\t\t\t\t// Found it equipped, so change the type to equipped.\n-\t\t\t\t\t\t\ttype = MapleInventoryType.EQUIPPED;\n-\t\t\t\t\t\t}\n-\t\t\t\t\t}\n-\t\t\t\t}\n-\t\t\t\tMapleInventoryManipulator.removeById(chr.getClient(), type, iEntry.getId(), quantity, true, false);\n-\t\t\t\tchr.announce(MaplePacketCreator.getShowItemGain(iEntry.getId(), (short) iEntry.getCount(), true));\n-\t\t\t} else {\n-\t\t\t\tif (chr.getInventory(MapleItemInformationProvider.getInstance().getInventoryType(iEntry.getId())).getNextFreeSlot() > -1) {\n-\t\t\t\t\tMapleInventoryManipulator.addById(chr.getClient(), iEntry.getId(), (short) iEntry.getCount());\n-\t\t\t\t\tchr.announce(MaplePacketCreator.getShowItemGain(iEntry.getId(), (short) iEntry.getCount(), true));\n-\t\t\t\t} else {\n-\t\t\t\t\tchr.dropMessage(1, \"Inventory Full\");\n-\t\t\t\t}\n+\t\t\tif(iEntry.getCount() < 0) { // Remove Item\n+\t\t\t\ttakeItem.add(new Pair<>(iEntry.getId(), iEntry.getCount()));\n+\t\t\t} else {                    // Give Item\n+                                giveItem.add(new Pair<>(iEntry.getId(), iEntry.getCount()));\n \t\t\t}\n \t\t}\n+                \n+                // must take all needed items before giving others\n+                \n+                for(Pair<Integer, Integer> iEntry: takeItem) {\n+                        MapleInventoryType type = ii.getInventoryType(iEntry.getLeft());\n+                        int quantity = iEntry.getRight() * -1; // Invert\n+                        if(type.equals(MapleInventoryType.EQUIP)) {\n+                                if(chr.getInventory(type).countById(iEntry.getLeft()) < quantity) {\n+                                        // Not enough in the equip inventoty, so check Equipped...\n+                                        if(chr.getInventory(MapleInventoryType.EQUIPPED).countById(iEntry.getLeft()) > quantity) {\n+                                                // Found it equipped, so change the type to equipped.\n+                                                type = MapleInventoryType.EQUIPPED;\n+                                        }\n+                                }\n+                        }\n+\n+                        MapleInventoryManipulator.removeById(chr.getClient(), type, iEntry.getLeft(), quantity, true, false);\n+                        chr.announce(MaplePacketCreator.getShowItemGain(iEntry.getLeft(), (short) iEntry.getRight().shortValue(), true));\n+                }\n+                \n+                for(Pair<Integer, Integer> iEntry: giveItem) {\n+                        MapleInventoryManipulator.addById(chr.getClient(), iEntry.getLeft(), (short) iEntry.getRight().shortValue());\n+                        chr.announce(MaplePacketCreator.getShowItemGain(iEntry.getLeft(), (short) iEntry.getRight().shortValue(), true));\n+                }\n \t}\n \t\n \t@Override\n \tpublic boolean check(MapleCharacter chr, Integer extSelection) {\n \t\tMapleItemInformationProvider ii = MapleItemInformationProvider.getInstance();\n-                EnumMap<MapleInventoryType, Integer> props = new EnumMap<>(MapleInventoryType.class);\n-\t\tList<Pair<Item, MapleInventoryType>> itemList = new ArrayList<>();\n-\t\tfor(ItemData item : items) {\n-\t\t\tif (!canGetItem(item, chr)) {\n+                \n+\t\tList<Pair<Item, MapleInventoryType>> gainList = new LinkedList<>();\n+                List<Pair<Item, MapleInventoryType>> selectList = new LinkedList<>();\n+                List<Pair<Item, MapleInventoryType>> randomList = new LinkedList<>();\n+                \n+                List<Integer> allSlotUsed = new ArrayList(5);\n+                for(byte i = 0; i < 5; i++) allSlotUsed.add(0);\n+                \n+                for(ItemData item : items) {\n+                        if (!canGetItem(item, chr)) {\n \t\t\t\tcontinue;\n \t\t\t}\n+                        \n \t\t\tMapleInventoryType type = ii.getInventoryType(item.getId());\n \t\t\tif(item.getProp() != null) {\n-\t\t\t\tif(!props.containsKey(type)) {\n-\t\t\t\t\tprops.put(type, item.getId());\n-\t\t\t\t}\n-\t\t\t\tcontinue;\n-\t\t\t}\n-\t\t\t\n-\t\t\tif(item.getCount() > 0) {\n-\t\t\t\t// Make sure they can hold the item.\n-\t\t\t\tItem toItem = new Item(item.getId(), (short) 0, (short) item.getCount());\n-\t\t\t\titemList.add(new Pair<>(toItem, type));\n+                                Item toItem = new Item(item.getId(), (short) 0, (short) item.getCount());\n+                            \n+                                if(item.getProp() < 0) {\n+                                        selectList.add(new Pair<>(toItem, type));\n+                                } else {\n+                                        randomList.add(new Pair<>(toItem, type));\n+                                }\n+\t\t\t\t\n \t\t\t} else {\n-\t\t\t\t// Make sure they actually have the item.\n-\t\t\t\tint quantity = item.getCount() * -1;\n-\t\t\t\tif(chr.getInventory(type).countById(item.getId()) < quantity) {\n-\t\t\t\t\tif(type.equals(MapleInventoryType.EQUIP) && chr.getInventory(MapleInventoryType.EQUIPPED).countById(item.getId()) > quantity)\n-\t\t\t\t\t\tcontinue;\n-\t\t\t\t\treturn false;\n-\t\t\t\t}\n-\t\t\t}\n-\t\t}\n-\t\tfor(Integer itemID : props.values()) {\n-\t\t\tMapleInventoryType type = ii.getInventoryType(itemID);\n-\t\t\tItem toItem = new Item(itemID, (short) 0, (short) 1);\n-\t\t\titemList.add(new Pair<>(toItem, type));\n+                                if(item.getCount() > 0) {\n+                                        // Make sure they can hold the item.\n+                                        Item toItem = new Item(item.getId(), (short) 0, (short) item.getCount());\n+                                        gainList.add(new Pair<>(toItem, type));\n+                                } else {\n+                                        // Make sure they actually have the item.\n+                                        int quantity = item.getCount() * -1;\n+                                        \n+                                        int freeSlotCount = chr.getInventory(type).freeSlotCountById(item.getId(), quantity);\n+                                        if(freeSlotCount == -1) {\n+                                                if(type.equals(MapleInventoryType.EQUIP) && chr.getInventory(MapleInventoryType.EQUIPPED).countById(item.getId()) > quantity)\n+                                                        continue;\n+                                                \n+                                                chr.dropMessage(1, \"Please check if you have enough items in your inventory.\");\n+                                                return false;\n+                                        } else {\n+                                                int idx = type.getType() - 1;   // more slots available from the given items!\n+                                                allSlotUsed.set(idx, allSlotUsed.get(idx) - freeSlotCount);\n+                                        }\n+                                }\n+                        }\n \t\t}\n-\t\t\n-\t\tif (!MapleInventory.checkSpots(chr, itemList)) {\n+                \n+                if(!randomList.isEmpty()) {\n+                        int result;\n+                        MapleClient c = chr.getClient();\n+                        \n+                        List<Integer> rndUsed = new ArrayList(5);\n+                        for(byte i = 0; i < 5; i++) rndUsed.add(allSlotUsed.get(i));\n+                    \n+                        for(Pair<Item, MapleInventoryType> it: randomList) {\n+                                int idx = it.getRight().getType() - 1;\n+                            \n+                                result = MapleInventoryManipulator.checkSpaceProgressively(c, it.getLeft().getItemId(), it.getLeft().getQuantity(), \"\", rndUsed.get(idx));\n+                                if(result % 2 == 0) {\n+                                    chr.dropMessage(1, \"Please check if you have enough space in your inventory.\");\n+                                    return false;\n+                                }\n+                                \n+                                allSlotUsed.set(idx, Math.max(allSlotUsed.get(idx), result >> 1));\n+                        }\n+                }\n+                \n+                if(!selectList.isEmpty()) {\n+                        Pair<Item, MapleInventoryType> selected = selectList.get(extSelection);\n+                        gainList.add(selected);\n+                }\n+                \n+\t\tif (!MapleInventory.checkSpots(chr, gainList, allSlotUsed)) {\n \t\t\tchr.dropMessage(1, \"Please check if you have enough space in your inventory.\");\n \t\t\treturn false;\n \t\t}\n@@ -199,11 +257,12 @@ private boolean canGetItem(ItemData item, MapleCharacter chr) {\n     }\n \t\n \tprivate class ItemData {\n-\t\tprivate final int id, count, job, gender;\n+\t\tprivate final int map, id, count, job, gender;\n \t\tprivate final Integer prop;\n \t\t\n-\t\tpublic ItemData(int id, int count, Integer prop, int job, int gender) {\n-\t\t\tthis.id = id;\n+\t\tpublic ItemData(int map, int id, int count, Integer prop, int job, int gender) {\n+\t\t\tthis.map = map;\n+                        this.id = id;\n \t\t\tthis.count = count;\n \t\t\tthis.prop = prop;\n \t\t\tthis.job = job;"}, {"sha": "5abcd1af6e3fdd2fba675a3d0005813cf8d5666c", "filename": "src/tools/MaplePacketCreator.java", "status": "modified", "additions": 22, "deletions": 10, "changes": 32, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/tools/MaplePacketCreator.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/src/tools/MaplePacketCreator.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/tools/MaplePacketCreator.java?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -1064,28 +1064,28 @@ public int compare(Pair<MapleStat, Integer> o1, Pair<MapleStat, Integer> o2) {\n         /**\n          * Gets a packet to spawn a door.\n          *\n-         * @param oid The door's owner ID.\n+         * @param ownerid The door's owner ID.\n          * @param pos The position of the door.\n          * @param launched Already deployed the door. \n          * @return The remove door packet.\n          */\n-        public static byte[] spawnDoor(int oid, Point pos, boolean launched) {\n+        public static byte[] spawnDoor(int ownerid, Point pos, boolean launched) {\n                 final MaplePacketLittleEndianWriter mplew = new MaplePacketLittleEndianWriter(11);\n                 mplew.writeShort(SendOpcode.SPAWN_DOOR.getValue());\n                 mplew.writeBool(launched);\n-                mplew.writeInt(oid);\n+                mplew.writeInt(ownerid);\n                 mplew.writePos(pos);\n                 return mplew.getPacket();\n         }\n \n         /**\n          * Gets a packet to remove a door.\n          *\n-         * @param oid The door's ID.\n+         * @param ownerid The door's owner ID.\n          * @param town\n          * @return The remove door packet.\n          */\n-        public static byte[] removeDoor(int oid, boolean town) {\n+        public static byte[] removeDoor(int ownerid, boolean town) {\n                 final MaplePacketLittleEndianWriter mplew = new MaplePacketLittleEndianWriter(10);\n                 if (town) {\n                         mplew.writeShort(SendOpcode.SPAWN_PORTAL.getValue());\n@@ -1094,7 +1094,7 @@ public int compare(Pair<MapleStat, Integer> o1, Pair<MapleStat, Integer> o2) {\n                 } else {\n                         mplew.writeShort(SendOpcode.REMOVE_DOOR.getValue());\n                         mplew.write(0);\n-                        mplew.writeInt(oid);\n+                        mplew.writeInt(ownerid);\n                 }\n                 return mplew.getPacket();\n         }\n@@ -2003,7 +2003,7 @@ private static void serializeMovementList(LittleEndianWriter lew, List<LifeMovem\n                 mplew.writeInt(cid);\n                 mplew.writeInt(summonOid);\n                 mplew.write(direction);\n-                mplew.write(4);\n+                mplew.write(direction);\n                 mplew.write(allDamage.size());\n                 for (SummonAttackEntry attackEntry : allDamage) {\n                         mplew.writeInt(attackEntry.getMonsterOid()); // oid\n@@ -3185,6 +3185,18 @@ private static void writeLongMaskFromList(final MaplePacketLittleEndianWriter mp\n                 mplew.write(tagBgColor);\n                 return mplew.getPacket();\n         }\n+        \n+        public static byte[] customShowBossHP(byte call, int oid, int currHP, int maxHP, byte tagColor, byte tagBgColor) {\n+                final MaplePacketLittleEndianWriter mplew = new MaplePacketLittleEndianWriter();\n+                mplew.writeShort(SendOpcode.FIELD_EFFECT.getValue());\n+                mplew.write(call);\n+                mplew.writeInt(oid);\n+                mplew.writeInt(currHP);\n+                mplew.writeInt(maxHP);\n+                mplew.write(tagColor);\n+                mplew.write(tagBgColor);\n+                return mplew.getPacket();\n+        }\n \n         public static byte[] giveFameResponse(int mode, String charname, int newfame) {\n                 final MaplePacketLittleEndianWriter mplew = new MaplePacketLittleEndianWriter();\n@@ -3235,7 +3247,7 @@ private static void writeLongMaskFromList(final MaplePacketLittleEndianWriter mp\n                     \n                         for (MapleDoor door : partychar.getDoors()) {\n                                 if(door.getOwnerId() == partychar.getId()) {\n-                                        MapleDoorObject mdo = door.getTownDoor();\n+                                        MapleDoorObject mdo = door.getAreaDoor();\n                                         mplew.writeInt(mdo.getTo().getId());\n                                         mplew.writeInt(mdo.getFrom().getId());\n                                         mplew.writeInt(mdo.getPosition().x);\n@@ -3760,7 +3772,7 @@ private static void writeIntMask(final MaplePacketLittleEndianWriter mplew, Map<\n                 mplew.writeInt(0);\n                 return mplew.getPacket();\n         }\n-\n+        \n         public static byte[] mapEffect(String path) {\n                 final MaplePacketLittleEndianWriter mplew = new MaplePacketLittleEndianWriter();\n                 mplew.writeShort(SendOpcode.FIELD_EFFECT.getValue());\n@@ -5149,7 +5161,7 @@ public static void addPetInfo(final MaplePacketLittleEndianWriter mplew, MaplePe\n                 return mplew.getPacket();\n         }\n \n-        public static byte[] giveForgeinPirateBuff(int cid, int buffid, int time, List<Pair<MapleBuffStat, Integer>> statups) {\n+        public static byte[] giveForeignPirateBuff(int cid, int buffid, int time, List<Pair<MapleBuffStat, Integer>> statups) {\n                 final MaplePacketLittleEndianWriter mplew = new MaplePacketLittleEndianWriter();\n                 boolean infusion = buffid == Buccaneer.SPEED_INFUSION || buffid == ThunderBreaker.SPEED_INFUSION || buffid == Corsair.SPEED_INFUSION;\n                 mplew.writeShort(SendOpcode.GIVE_FOREIGN_BUFF.getValue());"}, {"sha": "c5de8c33f08addd8fd1f3fa392ed0972a7daccaa", "filename": "todo.txt", "status": "modified", "additions": 57, "deletions": 4, "changes": 61, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/todo.txt", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/todo.txt", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/todo.txt?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "patch": "@@ -1,5 +1,58 @@\n-gaviota?\n-cash drop from equipped\n+========== MapleSolaxiaV2 ==========\n+Credits:\n+Ronan - Freelance Developer\n+Vcoc - Freelance Developer\n \n-PQs\n-quests doesnt need to have a free slot to give an stackable item...\n\\ No newline at end of file\n+---------------------------\n+ToDo / Missing features list:\n+---------------------------\n+\n+\n+---------------------------\n+** Others **\n+- Marriage\n+---------------------------\n+\n+\n+---------------------------\n+** Quest **\n+---------------------------\n+\n+\n+---------------------------\n+** Basic PQs **\n+- Zakum Party Quest\n+- Amoria Party Quest\n+- Magatia Party Quest\n+---------------------------\n+\n+\n+---------------------------\n+** Packet issues & advanced PQs **\n+- Mystic Doors (won't deploy players properly is some situations, only destination map matches).\n+- Ariant Party Quest\n+- Monster Carnival 1/2 Party Quest\n+- Nett's Pyramid Party Quest\n+- Dojo bar and skills combo (Bamboo Rain, Invincibility and Power Explosion)\n+---------------------------\n+\n+\n+---------------------------\n+** Skills **\n+---------------------------\n+\n+\n+---------------------------\n+** Jobs **\n+- Check Aran\n+- Check Cygnus Knights\n+---------------------------\n+\n+\n+---------------------------\n+** GM/ADMIN **\n+- Create a Gm/admin command list\n+- Set level for Gm and Admin commands. Example: Player = 0 / Donator = 1 / JuniorGm = 2 / Gm = 3 / SuperGm = 4 / Developer = 5 / Admin = 6\n+---------------------------\n+\n+====================================\n\\ No newline at end of file"}, {"sha": "099f15ff14b9dd7df2369a09740c8e303902abc6", "filename": "tools/MapleCouponInstaller/0521.img.xml", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleCouponInstaller/0521.img.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleCouponInstaller/0521.img.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/tools/MapleCouponInstaller/0521.img.xml?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "previous_filename": "MapleCouponInstaller/0521.img.xml"}, {"sha": "de8fc45878647141a02f104dd2bc8f7581d65fa8", "filename": "tools/MapleCouponInstaller/0536.img.xml", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleCouponInstaller/0536.img.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleCouponInstaller/0536.img.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/tools/MapleCouponInstaller/0536.img.xml?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "previous_filename": "MapleCouponInstaller/0536.img.xml"}, {"sha": "37baa51d87c35f7507f741557e125809b3cb4d3e", "filename": "tools/MapleCouponInstaller/build.xml", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleCouponInstaller/build.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleCouponInstaller/build.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/tools/MapleCouponInstaller/build.xml?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "previous_filename": "MapleCouponInstaller/build.xml"}, {"sha": "53d8f13a70021fe51d172110c864b93c402fca64", "filename": "tools/MapleCouponInstaller/build/built-jar.properties", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleCouponInstaller/build/built-jar.properties", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleCouponInstaller/build/built-jar.properties", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/tools/MapleCouponInstaller/build/built-jar.properties?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "previous_filename": "MapleCouponInstaller/build/built-jar.properties"}, {"sha": "e69de29bb2d1d6434b8b29ae775ad8c2e48c5391", "filename": "tools/MapleCouponInstaller/build/classes/.netbeans_automatic_build", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleCouponInstaller/build/classes/.netbeans_automatic_build", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleCouponInstaller/build/classes/.netbeans_automatic_build", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/tools/MapleCouponInstaller/build/classes/.netbeans_automatic_build?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "previous_filename": "MapleCouponInstaller/build/classes/.netbeans_automatic_build"}, {"sha": "e69de29bb2d1d6434b8b29ae775ad8c2e48c5391", "filename": "tools/MapleCouponInstaller/build/classes/.netbeans_update_resources", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleCouponInstaller/build/classes/.netbeans_update_resources", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleCouponInstaller/build/classes/.netbeans_update_resources", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/tools/MapleCouponInstaller/build/classes/.netbeans_update_resources?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "previous_filename": "MapleCouponInstaller/build/classes/.netbeans_update_resources"}, {"sha": "95a12c9381c078e028da0dfb55e67a0049ba6e62", "filename": "tools/MapleCouponInstaller/build/classes/maplecouponinstaller/MapleCouponInstaller.class", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleCouponInstaller/build/classes/maplecouponinstaller/MapleCouponInstaller.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleCouponInstaller/build/classes/maplecouponinstaller/MapleCouponInstaller.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/tools/MapleCouponInstaller/build/classes/maplecouponinstaller/MapleCouponInstaller.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "previous_filename": "MapleCouponInstaller/build/classes/maplecouponinstaller/MapleCouponInstaller.class"}, {"sha": "566be7833a15d18bc7e54431662afa6a61a5e626", "filename": "tools/MapleCouponInstaller/dist/MapleCouponInstaller.jar", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleCouponInstaller/dist/MapleCouponInstaller.jar", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleCouponInstaller/dist/MapleCouponInstaller.jar", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/tools/MapleCouponInstaller/dist/MapleCouponInstaller.jar?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "previous_filename": "MapleCouponInstaller/dist/MapleCouponInstaller.jar"}, {"sha": "6b7bfd0ba76e19b0dbf61bd08a36f165d0b9562d", "filename": "tools/MapleCouponInstaller/dist/README.TXT", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleCouponInstaller/dist/README.TXT", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleCouponInstaller/dist/README.TXT", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/tools/MapleCouponInstaller/dist/README.TXT?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "previous_filename": "MapleCouponInstaller/dist/README.TXT"}, {"sha": "0539039f716034c4896c8eaa81c075c7fa3bc997", "filename": "tools/MapleCouponInstaller/dist/lib/mysql-connector-java-bin.jar", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleCouponInstaller/dist/lib/mysql-connector-java-bin.jar", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleCouponInstaller/dist/lib/mysql-connector-java-bin.jar", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/tools/MapleCouponInstaller/dist/lib/mysql-connector-java-bin.jar?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "previous_filename": "MapleCouponInstaller/dist/lib/mysql-connector-java-bin.jar"}, {"sha": "099f15ff14b9dd7df2369a09740c8e303902abc6", "filename": "tools/MapleCouponInstaller/lib/0521.img.xml", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleCouponInstaller/lib/0521.img.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleCouponInstaller/lib/0521.img.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/tools/MapleCouponInstaller/lib/0521.img.xml?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "previous_filename": "MapleCouponInstaller/lib/0521.img.xml"}, {"sha": "de8fc45878647141a02f104dd2bc8f7581d65fa8", "filename": "tools/MapleCouponInstaller/lib/0536.img.xml", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleCouponInstaller/lib/0536.img.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleCouponInstaller/lib/0536.img.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/tools/MapleCouponInstaller/lib/0536.img.xml?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "previous_filename": "MapleCouponInstaller/lib/0536.img.xml"}, {"sha": "0539039f716034c4896c8eaa81c075c7fa3bc997", "filename": "tools/MapleCouponInstaller/lib/mysql-connector-java-bin.jar", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleCouponInstaller/lib/mysql-connector-java-bin.jar", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleCouponInstaller/lib/mysql-connector-java-bin.jar", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/tools/MapleCouponInstaller/lib/mysql-connector-java-bin.jar?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "previous_filename": "MapleCouponInstaller/lib/mysql-connector-java-bin.jar"}, {"sha": "328e8e5bc3b7f1f7bad2bc0751a933e00c801983", "filename": "tools/MapleCouponInstaller/manifest.mf", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleCouponInstaller/manifest.mf", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleCouponInstaller/manifest.mf", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/tools/MapleCouponInstaller/manifest.mf?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "previous_filename": "MapleCouponInstaller/manifest.mf"}, {"sha": "31f558ed796b6b2f49390cc8e0b3f905087ad602", "filename": "tools/MapleCouponInstaller/nbproject/build-impl.xml", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleCouponInstaller/nbproject/build-impl.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleCouponInstaller/nbproject/build-impl.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/tools/MapleCouponInstaller/nbproject/build-impl.xml?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "previous_filename": "MapleCouponInstaller/nbproject/build-impl.xml"}, {"sha": "e86bb55f9612d451315616f54f53b61634cf351a", "filename": "tools/MapleCouponInstaller/nbproject/genfiles.properties", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleCouponInstaller/nbproject/genfiles.properties", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleCouponInstaller/nbproject/genfiles.properties", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/tools/MapleCouponInstaller/nbproject/genfiles.properties?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "previous_filename": "MapleCouponInstaller/nbproject/genfiles.properties"}, {"sha": "e69de29bb2d1d6434b8b29ae775ad8c2e48c5391", "filename": "tools/MapleCouponInstaller/nbproject/private/config.properties", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleCouponInstaller/nbproject/private/config.properties", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleCouponInstaller/nbproject/private/config.properties", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/tools/MapleCouponInstaller/nbproject/private/config.properties?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "previous_filename": "MapleCouponInstaller/nbproject/private/config.properties"}, {"sha": "67c9c27960de98cc75964c3b684be04e7628d439", "filename": "tools/MapleCouponInstaller/nbproject/private/private.properties", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleCouponInstaller/nbproject/private/private.properties", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleCouponInstaller/nbproject/private/private.properties", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/tools/MapleCouponInstaller/nbproject/private/private.properties?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "previous_filename": "MapleCouponInstaller/nbproject/private/private.properties"}, {"sha": "27b105dcc9645d2beea51c2a86ec31756d447412", "filename": "tools/MapleCouponInstaller/nbproject/private/private.xml", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleCouponInstaller/nbproject/private/private.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleCouponInstaller/nbproject/private/private.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/tools/MapleCouponInstaller/nbproject/private/private.xml?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "previous_filename": "MapleCouponInstaller/nbproject/private/private.xml"}, {"sha": "bcdee47bdd437e82f369809fd288a6268ab66772", "filename": "tools/MapleCouponInstaller/nbproject/project.properties", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleCouponInstaller/nbproject/project.properties", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleCouponInstaller/nbproject/project.properties", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/tools/MapleCouponInstaller/nbproject/project.properties?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "previous_filename": "MapleCouponInstaller/nbproject/project.properties"}, {"sha": "11e9bd6dcabda778cef0c3a19c4417d03a2914d0", "filename": "tools/MapleCouponInstaller/nbproject/project.xml", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleCouponInstaller/nbproject/project.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleCouponInstaller/nbproject/project.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/tools/MapleCouponInstaller/nbproject/project.xml?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "previous_filename": "MapleCouponInstaller/nbproject/project.xml"}, {"sha": "da42aab5a45289042dea91e94e56c449846ef969", "filename": "tools/MapleCouponInstaller/src/maplecouponinstaller/MapleCouponInstaller.java", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleCouponInstaller/src/maplecouponinstaller/MapleCouponInstaller.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleCouponInstaller/src/maplecouponinstaller/MapleCouponInstaller.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/tools/MapleCouponInstaller/src/maplecouponinstaller/MapleCouponInstaller.java?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "previous_filename": "MapleCouponInstaller/src/maplecouponinstaller/MapleCouponInstaller.java"}, {"sha": "3dd3f978faea7c896cfd2c36534302bf808d8236", "filename": "tools/MapleIdRetriever/build.xml", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleIdRetriever/build.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleIdRetriever/build.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/tools/MapleIdRetriever/build.xml?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "previous_filename": "MapleIdRetriever/build.xml"}, {"sha": "db62d79b3b10fc3b032771b477f88ce9bd1c53a4", "filename": "tools/MapleIdRetriever/build/built-jar.properties", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleIdRetriever/build/built-jar.properties", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleIdRetriever/build/built-jar.properties", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/tools/MapleIdRetriever/build/built-jar.properties?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "previous_filename": "MapleIdRetriever/build/built-jar.properties"}, {"sha": "e69de29bb2d1d6434b8b29ae775ad8c2e48c5391", "filename": "tools/MapleIdRetriever/build/classes/.netbeans_automatic_build", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleIdRetriever/build/classes/.netbeans_automatic_build", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleIdRetriever/build/classes/.netbeans_automatic_build", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/tools/MapleIdRetriever/build/classes/.netbeans_automatic_build?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "previous_filename": "MapleIdRetriever/build/classes/.netbeans_automatic_build"}, {"sha": "e69de29bb2d1d6434b8b29ae775ad8c2e48c5391", "filename": "tools/MapleIdRetriever/build/classes/.netbeans_update_resources", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleIdRetriever/build/classes/.netbeans_update_resources", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleIdRetriever/build/classes/.netbeans_update_resources", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/tools/MapleIdRetriever/build/classes/.netbeans_update_resources?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "previous_filename": "MapleIdRetriever/build/classes/.netbeans_update_resources"}, {"sha": "8a204beabcae6329da6b5bde6d41f47b11bf21d2", "filename": "tools/MapleIdRetriever/build/classes/mapleidretriever/MapleIdRetriever.class", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleIdRetriever/build/classes/mapleidretriever/MapleIdRetriever.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleIdRetriever/build/classes/mapleidretriever/MapleIdRetriever.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/tools/MapleIdRetriever/build/classes/mapleidretriever/MapleIdRetriever.class?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "previous_filename": "MapleIdRetriever/build/classes/mapleidretriever/MapleIdRetriever.class"}, {"sha": "47dff62a316cf27d2f83279df7782550d39b421a", "filename": "tools/MapleIdRetriever/dist/MapleIdRetriever.jar", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleIdRetriever/dist/MapleIdRetriever.jar", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleIdRetriever/dist/MapleIdRetriever.jar", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/tools/MapleIdRetriever/dist/MapleIdRetriever.jar?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "previous_filename": "MapleIdRetriever/dist/MapleIdRetriever.jar"}, {"sha": "b3bf59e8c2d394ab6d9bbec66cde4ed1018788fd", "filename": "tools/MapleIdRetriever/dist/README.TXT", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleIdRetriever/dist/README.TXT", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleIdRetriever/dist/README.TXT", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/tools/MapleIdRetriever/dist/README.TXT?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "previous_filename": "MapleIdRetriever/dist/README.TXT"}, {"sha": "0539039f716034c4896c8eaa81c075c7fa3bc997", "filename": "tools/MapleIdRetriever/dist/lib/mysql-connector-java-bin.jar", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleIdRetriever/dist/lib/mysql-connector-java-bin.jar", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleIdRetriever/dist/lib/mysql-connector-java-bin.jar", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/tools/MapleIdRetriever/dist/lib/mysql-connector-java-bin.jar?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "previous_filename": "MapleIdRetriever/dist/lib/mysql-connector-java-bin.jar"}, {"sha": "841958639ea4e18e80e443a4a2e727076b9e10d3", "filename": "tools/MapleIdRetriever/handbook/Cash.txt", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleIdRetriever/handbook/Cash.txt", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleIdRetriever/handbook/Cash.txt", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/tools/MapleIdRetriever/handbook/Cash.txt?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "previous_filename": "MapleIdRetriever/handbook/Cash.txt"}, {"sha": "f8ec0478f1e5012916310869c018f9b11b0d183b", "filename": "tools/MapleIdRetriever/handbook/Equip/Accessory.txt", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleIdRetriever/handbook/Equip/Accessory.txt", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleIdRetriever/handbook/Equip/Accessory.txt", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/tools/MapleIdRetriever/handbook/Equip/Accessory.txt?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "previous_filename": "MapleIdRetriever/handbook/Equip/Accessory.txt"}, {"sha": "fe0beb727d5d10b2ac6243696208088897dfa859", "filename": "tools/MapleIdRetriever/handbook/Equip/Cap.txt", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleIdRetriever/handbook/Equip/Cap.txt", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleIdRetriever/handbook/Equip/Cap.txt", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/tools/MapleIdRetriever/handbook/Equip/Cap.txt?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "previous_filename": "MapleIdRetriever/handbook/Equip/Cap.txt"}, {"sha": "113117ce61590236e5a9890e82906a8b7df3cf69", "filename": "tools/MapleIdRetriever/handbook/Equip/Cape.txt", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleIdRetriever/handbook/Equip/Cape.txt", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleIdRetriever/handbook/Equip/Cape.txt", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/tools/MapleIdRetriever/handbook/Equip/Cape.txt?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "previous_filename": "MapleIdRetriever/handbook/Equip/Cape.txt"}, {"sha": "76cd609c4a2af418e911ff02e5b00584ab7249ed", "filename": "tools/MapleIdRetriever/handbook/Equip/Coat.txt", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleIdRetriever/handbook/Equip/Coat.txt", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleIdRetriever/handbook/Equip/Coat.txt", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/tools/MapleIdRetriever/handbook/Equip/Coat.txt?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "previous_filename": "MapleIdRetriever/handbook/Equip/Coat.txt"}, {"sha": "d2ad5ee3c6dd507a5f5f03d725c467d30f195bc5", "filename": "tools/MapleIdRetriever/handbook/Equip/Face.txt", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleIdRetriever/handbook/Equip/Face.txt", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleIdRetriever/handbook/Equip/Face.txt", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/tools/MapleIdRetriever/handbook/Equip/Face.txt?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "previous_filename": "MapleIdRetriever/handbook/Equip/Face.txt"}, {"sha": "f2be2128c234f232fb0382ae43804f8ff6be5610", "filename": "tools/MapleIdRetriever/handbook/Equip/Glove.txt", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleIdRetriever/handbook/Equip/Glove.txt", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleIdRetriever/handbook/Equip/Glove.txt", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/tools/MapleIdRetriever/handbook/Equip/Glove.txt?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "previous_filename": "MapleIdRetriever/handbook/Equip/Glove.txt"}, {"sha": "eebe4640d42bd821e3344dc9209482404d4d26e5", "filename": "tools/MapleIdRetriever/handbook/Equip/Hair.txt", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleIdRetriever/handbook/Equip/Hair.txt", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleIdRetriever/handbook/Equip/Hair.txt", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/tools/MapleIdRetriever/handbook/Equip/Hair.txt?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "previous_filename": "MapleIdRetriever/handbook/Equip/Hair.txt"}, {"sha": "ba6195672de504c149d75e69bbc25f9c0dbdf084", "filename": "tools/MapleIdRetriever/handbook/Equip/Longcoat.txt", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleIdRetriever/handbook/Equip/Longcoat.txt", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleIdRetriever/handbook/Equip/Longcoat.txt", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/tools/MapleIdRetriever/handbook/Equip/Longcoat.txt?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "previous_filename": "MapleIdRetriever/handbook/Equip/Longcoat.txt"}, {"sha": "57f7acdd2957bf86c5043fde4d947b70dda0a8a1", "filename": "tools/MapleIdRetriever/handbook/Equip/Pants.txt", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleIdRetriever/handbook/Equip/Pants.txt", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleIdRetriever/handbook/Equip/Pants.txt", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/tools/MapleIdRetriever/handbook/Equip/Pants.txt?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "previous_filename": "MapleIdRetriever/handbook/Equip/Pants.txt"}, {"sha": "83ba78ce1e8b5b87c0a3a590effa5e508f55a339", "filename": "tools/MapleIdRetriever/handbook/Equip/PetEquip.txt", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleIdRetriever/handbook/Equip/PetEquip.txt", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleIdRetriever/handbook/Equip/PetEquip.txt", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/tools/MapleIdRetriever/handbook/Equip/PetEquip.txt?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "previous_filename": "MapleIdRetriever/handbook/Equip/PetEquip.txt"}, {"sha": "a4c436f1f52588dc6cff5e8dbf86d424f30d0114", "filename": "tools/MapleIdRetriever/handbook/Equip/Ring.txt", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleIdRetriever/handbook/Equip/Ring.txt", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleIdRetriever/handbook/Equip/Ring.txt", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/tools/MapleIdRetriever/handbook/Equip/Ring.txt?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "previous_filename": "MapleIdRetriever/handbook/Equip/Ring.txt"}, {"sha": "408dd0de0d7cb9575cdb2ede8b1629d98f25e2e0", "filename": "tools/MapleIdRetriever/handbook/Equip/Shield.txt", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleIdRetriever/handbook/Equip/Shield.txt", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a2e382c3b1733e1525cb80b452bd65043e8ad91/tools/MapleIdRetriever/handbook/Equip/Shield.txt", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/tools/MapleIdRetriever/handbook/Equip/Shield.txt?ref=0a2e382c3b1733e1525cb80b452bd65043e8ad91", "previous_filename": "MapleIdRetriever/handbook/Equip/Shield.txt"}]}]},
