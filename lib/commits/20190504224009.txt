{"fetchDate": "2019-12-19", "content": [{"sha": "402d7b359d84394917b6dc4d380c6d7e12ff0efd", "node_id": "MDY6Q29tbWl0NDUwODIwMjM6NDAyZDdiMzU5ZDg0Mzk0OTE3YjZkYzRkMzgwYzZkN2UxMmZmMGVmZA==", "commit": {"author": {"name": "ronancpl", "email": "rcpl2010@gmail.com", "date": "2019-05-04T22:40:09Z"}, "committer": {"name": "ronancpl", "email": "rcpl2010@gmail.com", "date": "2019-05-04T22:40:09Z"}, "message": "Mobstatus tooltip update on controller interchanges\n\nFixed mob statuses being unexpectedly revoked for the new controller at transition time.", "tree": {"sha": "883459aa92176df1357bf3e861c3524e1dfb0253", "url": "https://api.github.com/repos/ronancpl/HeavenMS/git/trees/883459aa92176df1357bf3e861c3524e1dfb0253"}, "url": "https://api.github.com/repos/ronancpl/HeavenMS/git/commits/402d7b359d84394917b6dc4d380c6d7e12ff0efd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/402d7b359d84394917b6dc4d380c6d7e12ff0efd", "html_url": "https://github.com/ronancpl/HeavenMS/commit/402d7b359d84394917b6dc4d380c6d7e12ff0efd", "comments_url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/402d7b359d84394917b6dc4d380c6d7e12ff0efd/comments", "author": {"login": "ronancpl", "id": 9257761, "node_id": "MDQ6VXNlcjkyNTc3NjE=", "avatar_url": "https://avatars2.githubusercontent.com/u/9257761?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ronancpl", "html_url": "https://github.com/ronancpl", "followers_url": "https://api.github.com/users/ronancpl/followers", "following_url": "https://api.github.com/users/ronancpl/following{/other_user}", "gists_url": "https://api.github.com/users/ronancpl/gists{/gist_id}", "starred_url": "https://api.github.com/users/ronancpl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ronancpl/subscriptions", "organizations_url": "https://api.github.com/users/ronancpl/orgs", "repos_url": "https://api.github.com/users/ronancpl/repos", "events_url": "https://api.github.com/users/ronancpl/events{/privacy}", "received_events_url": "https://api.github.com/users/ronancpl/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ronancpl", "id": 9257761, "node_id": "MDQ6VXNlcjkyNTc3NjE=", "avatar_url": "https://avatars2.githubusercontent.com/u/9257761?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ronancpl", "html_url": "https://github.com/ronancpl", "followers_url": "https://api.github.com/users/ronancpl/followers", "following_url": "https://api.github.com/users/ronancpl/following{/other_user}", "gists_url": "https://api.github.com/users/ronancpl/gists{/gist_id}", "starred_url": "https://api.github.com/users/ronancpl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ronancpl/subscriptions", "organizations_url": "https://api.github.com/users/ronancpl/orgs", "repos_url": "https://api.github.com/users/ronancpl/repos", "events_url": "https://api.github.com/users/ronancpl/events{/privacy}", "received_events_url": "https://api.github.com/users/ronancpl/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e70215eb9decde02730e8ff5ebd6d59d29b7123c", "url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/e70215eb9decde02730e8ff5ebd6d59d29b7123c", "html_url": "https://github.com/ronancpl/HeavenMS/commit/e70215eb9decde02730e8ff5ebd6d59d29b7123c"}], "stats": {"total": 21, "additions": 15, "deletions": 6}, "files": [{"sha": "7166a46c8111fee56fee0893051ae85323d10c25", "filename": "docs/mychanges_ptbr.txt", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/402d7b359d84394917b6dc4d380c6d7e12ff0efd/docs/mychanges_ptbr.txt", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/402d7b359d84394917b6dc4d380c6d7e12ff0efd/docs/mychanges_ptbr.txt", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/docs/mychanges_ptbr.txt?ref=402d7b359d84394917b6dc4d380c6d7e12ff0efd", "patch": "@@ -1849,4 +1849,7 @@ Corrigido caso de dupe com itens ao serem colocados no storage.\n Adicionado sistema de \"qualquer NPC script\u00e1vel\", com apoio do GabrielSin.\n Adicionado server flag para checagem de IP's ao logar jogadores.\n Corrigido mobskills n\u00e3o sendo devidamente aplicados devido a um deslize anterior que tentaria aplicar indevidamente 2x \"uso de skill\" (uma das vezes deveria ser somente checagem de rotina).\n-Corrigido puppets de arqueiros interrompendo mob statuses para o dono ao serem lan\u00e7ados em campo.\n\\ No newline at end of file\n+Corrigido puppets de arqueiros interrompendo mob statuses para o dono ao serem lan\u00e7ados em campo.\n+\n+04 Maio 2019,\n+Corrigido vis\u00e3o de mob statuses sendo interrompido para o novo controlador ao realizar troca de controladores.\n\\ No newline at end of file"}, {"sha": "db3e2ae5690f903d50eefd24d875d05c380ff3bb", "filename": "src/server/life/MapleMonster.java", "status": "modified", "additions": 11, "deletions": 5, "changes": 16, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/402d7b359d84394917b6dc4d380c6d7e12ff0efd/src/server/life/MapleMonster.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/402d7b359d84394917b6dc4d380c6d7e12ff0efd/src/server/life/MapleMonster.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/life/MapleMonster.java?ref=402d7b359d84394917b6dc4d380c6d7e12ff0efd", "patch": "@@ -1886,7 +1886,7 @@ public void aggroSwitchController(MapleCharacter newController, boolean immediat\n             }\n             \n             this.aggroUpdatePuppetVisibility();\n-            newController.announce(MaplePacketCreator.controlMonster(this, false, immediateAggro));\n+            aggroMonsterControl(newController.getClient(), this, immediateAggro);\n             newController.controlMonster(this);\n         }\n     }\n@@ -2054,7 +2054,7 @@ public void aggroMonsterDamage(MapleCharacter attacker, int damage) {\n             \n             else if (chrController != null) {\n                 chrController.announce(MaplePacketCreator.stopControllingMonster(this.getObjectId()));\n-                chrController.announce(MaplePacketCreator.controlMonster(this, false, true));\n+                aggroMonsterControl(chrController.getClient(), this, true);\n             }\n             */\n         } else {\n@@ -2063,6 +2063,13 @@ else if (chrController != null) {\n         }\n     }\n     \n+    private static void aggroMonsterControl(MapleClient c, MapleMonster mob, boolean immediateAggro) {\n+        c.announce(MaplePacketCreator.controlMonster(mob, false, immediateAggro));\n+        \n+        // thanks BHB for noticing puppets disrupting mobstatuses for bowmans\n+        mob.announceMonsterStatus(c);\n+    }\n+    \n     private void aggroRefreshPuppetVisibility(MapleCharacter chrController, MapleSummon puppet) {\n         // lame patch for client to redirect all aggro to the puppet\n         \n@@ -2080,8 +2087,7 @@ private void aggroRefreshPuppetVisibility(MapleCharacter chrController, MapleSum\n         \n         MapleClient c = chrController.getClient();\n         for (MapleMonster mob : puppetControlled) {\n-            chrController.announce(MaplePacketCreator.controlMonster(mob, false, mob.isControllerHasAggro()));\n-            mob.announceMonsterStatus(c);   // thanks BHB for noticing puppets disrupting mobstatuses for bowmans\n+            aggroMonsterControl(c, mob, mob.isControllerKnowsAboutAggro());\n         }\n         chrController.announce(MaplePacketCreator.spawnSummon(puppet, false));\n     }\n@@ -2116,7 +2122,7 @@ public void run() {\n                         controllerHasPuppet = false;\n \n                         chrController.announce(MaplePacketCreator.stopControllingMonster(MapleMonster.this.getObjectId()));\n-                        chrController.announce(MaplePacketCreator.controlMonster(MapleMonster.this, false, MapleMonster.this.isControllerHasAggro()));\n+                        aggroMonsterControl(chrController.getClient(), MapleMonster.this, MapleMonster.this.isControllerHasAggro());\n                     }\n                 } finally {\n                     availablePuppetUpdate = true;"}]}]},
