{"fetchDate": "2019-12-19", "content": [{"sha": "0a8efa42384c54ca26546c881d10b7fe4b881064", "node_id": "MDY6Q29tbWl0NDUwODIwMjM6MGE4ZWZhNDIzODRjNTRjYTI2NTQ2Yzg4MWQxMGI3ZmU0Yjg4MTA2NA==", "commit": {"author": {"name": "Diego Armando de Freitas Matos", "email": "diego.matos@bh.mi", "date": "2019-03-08T01:37:00Z"}, "committer": {"name": "Diego Armando de Freitas Matos", "email": "diego.matos@bh.mi", "date": "2019-03-08T01:37:00Z"}, "message": "Cpq1 ,2 add linguas", "tree": {"sha": "e0e149fe4fcd8995a832983e248e1e8ef81a79fc", "url": "https://api.github.com/repos/ronancpl/HeavenMS/git/trees/e0e149fe4fcd8995a832983e248e1e8ef81a79fc"}, "url": "https://api.github.com/repos/ronancpl/HeavenMS/git/commits/0a8efa42384c54ca26546c881d10b7fe4b881064", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/0a8efa42384c54ca26546c881d10b7fe4b881064", "html_url": "https://github.com/ronancpl/HeavenMS/commit/0a8efa42384c54ca26546c881d10b7fe4b881064", "comments_url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/0a8efa42384c54ca26546c881d10b7fe4b881064/comments", "author": null, "committer": null, "parents": [{"sha": "90ad58f17feec67ea4a50c859ba472e94ef8a595", "url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/90ad58f17feec67ea4a50c859ba472e94ef8a595", "html_url": "https://github.com/ronancpl/HeavenMS/commit/90ad58f17feec67ea4a50c859ba472e94ef8a595"}], "stats": {"total": 90, "additions": 75, "deletions": 15}, "files": [{"sha": "a2443057c5611c22ee2956d5a8838146e85bf846", "filename": "sql/db_database.sql", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a8efa42384c54ca26546c881d10b7fe4b881064/sql/db_database.sql", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a8efa42384c54ca26546c881d10b7fe4b881064/sql/db_database.sql", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/sql/db_database.sql?ref=0a8efa42384c54ca26546c881d10b7fe4b881064", "patch": "@@ -42,6 +42,7 @@ CREATE TABLE IF NOT EXISTS `accounts` (\n   `rewardpoints` int(11) NOT NULL DEFAULT '0',\n   `votepoints` int(11) NOT NULL DEFAULT '0',\n   `hwid` varchar(12) NOT NULL DEFAULT '',\n+  `lingua` int(1) NOT NULL DEFAULT '2',\n   PRIMARY KEY (`id`),\n   UNIQUE KEY `name` (`name`),\n   KEY `ranking1` (`id`,`banned`),\n@@ -17443,7 +17444,7 @@ CREATE TABLE IF NOT EXISTS `rings` (\n CREATE TABLE IF NOT EXISTS `savedlocations` (\n   `id` int(11) NOT NULL AUTO_INCREMENT,\n   `characterid` int(11) NOT NULL,\n-  `locationtype` enum('FREE_MARKET','WORLDTOUR','FLORINA','INTRO','SUNDAY_MARKET','MIRROR','EVENT','BOSSPQ','HAPPYVILLE','DEVELOPER') NOT NULL,\n+  `locationtype` enum('FREE_MARKET','WORLDTOUR','FLORINA','INTRO','SUNDAY_MARKET','MIRROR','EVENT','BOSSPQ','HAPPYVILLE','DEVELOPER','MONSTER_CARNIVAL') NOT NULL,\n   `map` int(11) NOT NULL,\n   `portal` int(11) NOT NULL,\n   PRIMARY KEY (`id`)"}, {"sha": "146f65eb1a211607a3e69c62bde895d0173ee60d", "filename": "src/client/MapleCharacter.java", "status": "modified", "additions": 16, "deletions": 5, "changes": 21, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a8efa42384c54ca26546c881d10b7fe4b881064/src/client/MapleCharacter.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a8efa42384c54ca26546c881d10b7fe4b881064/src/client/MapleCharacter.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/MapleCharacter.java?ref=0a8efa42384c54ca26546c881d10b7fe4b881064", "patch": "@@ -9598,7 +9598,6 @@ public boolean isVipTrockMap(int id) {\n     private MapleFitness fitness;\n     private MapleOla ola;\n     private long snowballattack;\n-    private int lingua = 0;// 0 PTB  1 ESP  2 ENG\n     public static final List<String> itens = new ArrayList();\n     public static final List<Item> item = new ArrayList();\n \n@@ -10174,12 +10173,24 @@ public void setChallenged(boolean challenged) {\n         this.challenged = challenged;\n     }\n \n-    public void setLingua(int a) {\n-        this.lingua = a;\n+    public void setLingua(int num) {\n+        getClient().setLingua(num);\n+        try {\n+            Connection con = DatabaseConnection.getConnection();\n+            try (PreparedStatement ps = con.prepareStatement(\"UPDATE accounts SET lingua = ? WHERE id = ?\")) {\n+                ps.setInt(1, num);\n+                ps.setInt(2, getClient().getAccID());\n+                ps.executeUpdate();\n+            } finally {\n+                con.close();\n+            }\n+        } catch (SQLException e) {\n+            e.printStackTrace();\n+        }\n     }\n-\n+    \n     public int getLingua() {\n-        return lingua;\n+        return getClient().getLingua();\n     }\n \n     public void setItens(String item) {"}, {"sha": "2df77a0e248c4e14441cb68b425a9d026c1e6957", "filename": "src/client/MapleClient.java", "status": "modified", "additions": 11, "deletions": 1, "changes": 12, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a8efa42384c54ca26546c881d10b7fe4b881064/src/client/MapleClient.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a8efa42384c54ca26546c881d10b7fe4b881064/src/client/MapleClient.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/MapleClient.java?ref=0a8efa42384c54ca26546c881d10b7fe4b881064", "patch": "@@ -124,6 +124,7 @@\n     private int visibleWorlds;\n     private long lastNpcClick;\n     private long sessionId;\n+    private int lingua = 0;\n \n     public MapleClient(MapleAESOFB send, MapleAESOFB receive, IoSession session) {\n         this.send = send;\n@@ -535,7 +536,7 @@ public int login(String login, String pwd, String nibbleHwid) {\n         ResultSet rs = null;\n         try {\n             con = DatabaseConnection.getConnection();\n-            ps = con.prepareStatement(\"SELECT id, password, gender, banned, pin, pic, characterslots, tos FROM accounts WHERE name = ?\");\n+            ps = con.prepareStatement(\"SELECT id, password, gender, banned, pin, pic, characterslots, tos, lingua FROM accounts WHERE name = ?\");\n             ps.setString(1, login);\n             rs = ps.executeQuery();\n             if (rs.next()) {\n@@ -546,6 +547,7 @@ public int login(String login, String pwd, String nibbleHwid) {\n                 pic = rs.getString(\"pic\");\n                 gender = rs.getByte(\"gender\");\n                 characterSlots = rs.getByte(\"characterslots\");\n+                lingua = rs.getInt(\"lingua\");\n                 String passhash = rs.getString(\"password\");\n                 byte tos = rs.getByte(\"tos\");\n \n@@ -1528,4 +1530,12 @@ public boolean canBypassPin() {\n     public boolean canBypassPic() {\n         return MapleLoginBypassCoordinator.getInstance().canLoginBypass(getNibbleHWID(), accId, true);\n     }\n+\n+    public int getLingua() {\n+        return lingua;\n+    }\n+\n+    public void setLingua(int lingua) {\n+        this.lingua = lingua;\n+    }\n }"}, {"sha": "285b0da748aaf621445ad273d017eca7bc24d65a", "filename": "src/client/command/CommandsExecutor.java", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a8efa42384c54ca26546c881d10b7fe4b881064/src/client/command/CommandsExecutor.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a8efa42384c54ca26546c881d10b7fe4b881064/src/client/command/CommandsExecutor.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/CommandsExecutor.java?ref=0a8efa42384c54ca26546c881d10b7fe4b881064", "patch": "@@ -178,6 +178,7 @@ private void registerLv0Commands(){\n         addCommand(\"uptime\", UptimeCommand.class);\n         addCommand(\"gacha\", GachaCommand.class);\n         addCommand(\"dispose\", DisposeCommand.class);\n+        addCommand(\"changel\", ChangeLinguaCommand.class);\n         addCommand(\"equiplv\",  EquipLvCommand.class);\n         addCommand(\"showrates\", ShowRatesCommand.class);\n         addCommand(\"rates\", RatesCommand.class);"}, {"sha": "219279a99fbcfa7893951f673e5850c54a837757", "filename": "src/client/command/commands/gm0/ChangeLinguaCommand.java", "status": "added", "additions": 42, "deletions": 0, "changes": 42, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a8efa42384c54ca26546c881d10b7fe4b881064/src/client/command/commands/gm0/ChangeLinguaCommand.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a8efa42384c54ca26546c881d10b7fe4b881064/src/client/command/commands/gm0/ChangeLinguaCommand.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/commands/gm0/ChangeLinguaCommand.java?ref=0a8efa42384c54ca26546c881d10b7fe4b881064", "patch": "@@ -0,0 +1,42 @@\n+/*\n+    This file is part of the HeavenMS MapleStory Server, commands OdinMS-based\n+    Copyleft (L) 2016 - 2018 RonanLana\n+\n+    This program is free software: you can redistribute it and/or modify\n+    it under the terms of the GNU Affero General Public License as\n+    published by the Free Software Foundation version 3 as published by\n+    the Free Software Foundation. You may not use, modify or distribute\n+    this program under any other version of the GNU Affero General Public\n+    License.\n+\n+    This program is distributed in the hope that it will be useful,\n+    but WITHOUT ANY WARRANTY; without even the implied warranty of\n+    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+    GNU Affero General Public License for more details.\n+\n+    You should have received a copy of the GNU Affero General Public License\n+    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n+*/\n+\n+/*\n+   @Author: Arthur L - Refactored command content into modules\n+*/\n+package client.command.commands.gm0;\n+\n+import client.command.Command;\n+import client.MapleClient;\n+\n+public class ChangeLinguaCommand extends Command {\n+    {\n+        setDescription(\"\");\n+    }\n+\n+    @Override\n+    public void execute(MapleClient c, String[] params) {\n+        if (params.length < 1) {\n+            c.getPlayer().yellowMessage(\"Syntax: !changel <0=ptb, 1=esp, 2=eng>\");\n+            return;\n+        }\n+        c.setLingua(Integer.parseInt(params[0]));\n+    }\n+}"}, {"sha": "af1089d60eb598fffffb81983b4424d45f992ce0", "filename": "src/constants/LinguaConstants.java", "status": "modified", "additions": 1, "deletions": 6, "changes": 7, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a8efa42384c54ca26546c881d10b7fe4b881064/src/constants/LinguaConstants.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a8efa42384c54ca26546c881d10b7fe4b881064/src/constants/LinguaConstants.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/constants/LinguaConstants.java?ref=0a8efa42384c54ca26546c881d10b7fe4b881064", "patch": "@@ -1,15 +1,10 @@\n-/*\n- * To change this license header, choose License Headers in Project Properties.\n- * To change this template file, choose Tools | Templates\n- * and open the template in the editor.\n- */\n package constants;\n \n import client.MapleCharacter;\n \n /**\n  *\n- * @author Drago\n+ * @author Drago - Dragohe4rt\n  */\n public class LinguaConstants {\n \t// Portugues"}, {"sha": "5c83c3228563f4be92f952b5facf10f2785a6fda", "filename": "src/server/MapleStatEffect.java", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/0a8efa42384c54ca26546c881d10b7fe4b881064/src/server/MapleStatEffect.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/0a8efa42384c54ca26546c881d10b7fe4b881064/src/server/MapleStatEffect.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/MapleStatEffect.java?ref=0a8efa42384c54ca26546c881d10b7fe4b881064", "patch": "@@ -939,7 +939,7 @@ private boolean applyTo(MapleCharacter applyfrom, MapleCharacter applyto, boolea\n             applyto.removeAllCooldownsExcept(Buccaneer.TIME_LEAP, true);\n         } else if (cp != 0 && applyto.getMonsterCarnival() != null) {\n             applyto.gainCP(cp);\n-        } else if (nuffSkill != 0 && applyto.getParty() != null && applyto.getMap().isCPQMap()) {\n+        } else if (nuffSkill != 0 && applyto.getParty() != null && applyto.getMap().isCPQMap()) { // by Drago-Dragohe4rt\n             final MCSkill skil = MapleCarnivalFactory.getInstance().getSkill(nuffSkill);\n             if (skil != null) {\n                 final MapleDisease dis = skil.getDisease();\n@@ -964,7 +964,7 @@ private boolean applyTo(MapleCharacter applyfrom, MapleCharacter applyto, boolea\n                     }\n                 }\n             }\n-        } else if (cureDebuffs.size() > 0) {\n+        } else if (cureDebuffs.size() > 0) { // by Drago-Dragohe4rt\n             for (final MapleDisease debuff : cureDebuffs) {\n                 if (applyfrom.getParty() != null) {\n                     for (MaplePartyCharacter chrs : applyfrom.getParty().getPartyMembers()) {"}]}]},
