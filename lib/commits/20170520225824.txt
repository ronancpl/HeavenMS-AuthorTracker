{"fetchDate": "2019-12-19", "content": [{"sha": "7fcdc07b5b3f883da29619e094ba3f8ab401165a", "node_id": "MDY6Q29tbWl0NDUwODIwMjM6N2ZjZGMwN2I1YjNmODgzZGEyOTYxOWUwOTRiYTNmOGFiNDAxMTY1YQ==", "commit": {"author": {"name": "ronancpl", "email": "rcpl2010@gmail.com", "date": "2017-05-20T22:58:24Z"}, "committer": {"name": "ronancpl", "email": "rcpl2010@gmail.com", "date": "2017-05-20T22:58:24Z"}, "message": "New mechanic: Jail + fixed mob book cover issues\n\nAdded new mechanic: jail. Fixed missing card info reference about\ndropper mobs on the sql, reflecting into erros on the monster book.", "tree": {"sha": "d796b0c9f826cfe83f2334fe6cdc9ea6ad3326f0", "url": "https://api.github.com/repos/ronancpl/HeavenMS/git/trees/d796b0c9f826cfe83f2334fe6cdc9ea6ad3326f0"}, "url": "https://api.github.com/repos/ronancpl/HeavenMS/git/commits/7fcdc07b5b3f883da29619e094ba3f8ab401165a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/7fcdc07b5b3f883da29619e094ba3f8ab401165a", "html_url": "https://github.com/ronancpl/HeavenMS/commit/7fcdc07b5b3f883da29619e094ba3f8ab401165a", "comments_url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/7fcdc07b5b3f883da29619e094ba3f8ab401165a/comments", "author": {"login": "ronancpl", "id": 9257761, "node_id": "MDQ6VXNlcjkyNTc3NjE=", "avatar_url": "https://avatars2.githubusercontent.com/u/9257761?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ronancpl", "html_url": "https://github.com/ronancpl", "followers_url": "https://api.github.com/users/ronancpl/followers", "following_url": "https://api.github.com/users/ronancpl/following{/other_user}", "gists_url": "https://api.github.com/users/ronancpl/gists{/gist_id}", "starred_url": "https://api.github.com/users/ronancpl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ronancpl/subscriptions", "organizations_url": "https://api.github.com/users/ronancpl/orgs", "repos_url": "https://api.github.com/users/ronancpl/repos", "events_url": "https://api.github.com/users/ronancpl/events{/privacy}", "received_events_url": "https://api.github.com/users/ronancpl/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ronancpl", "id": 9257761, "node_id": "MDQ6VXNlcjkyNTc3NjE=", "avatar_url": "https://avatars2.githubusercontent.com/u/9257761?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ronancpl", "html_url": "https://github.com/ronancpl", "followers_url": "https://api.github.com/users/ronancpl/followers", "following_url": "https://api.github.com/users/ronancpl/following{/other_user}", "gists_url": "https://api.github.com/users/ronancpl/gists{/gist_id}", "starred_url": "https://api.github.com/users/ronancpl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ronancpl/subscriptions", "organizations_url": "https://api.github.com/users/ronancpl/orgs", "repos_url": "https://api.github.com/users/ronancpl/repos", "events_url": "https://api.github.com/users/ronancpl/events{/privacy}", "received_events_url": "https://api.github.com/users/ronancpl/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "cb49edc3cd457823826632ffce8222c19b3fa214", "url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/cb49edc3cd457823826632ffce8222c19b3fa214", "html_url": "https://github.com/ronancpl/HeavenMS/commit/cb49edc3cd457823826632ffce8222c19b3fa214"}], "stats": {"total": 697, "additions": 465, "deletions": 232}, "files": [{"sha": "b75437ea502f6b63ae7549e475fa8685e6dac7e5", "filename": "mychanges_ptbr.txt", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/7fcdc07b5b3f883da29619e094ba3f8ab401165a/mychanges_ptbr.txt", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/7fcdc07b5b3f883da29619e094ba3f8ab401165a/mychanges_ptbr.txt", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/mychanges_ptbr.txt?ref=7fcdc07b5b3f883da29619e094ba3f8ab401165a", "patch": "@@ -229,4 +229,9 @@ Corre\n \n 18 - 19 Maio 2017,\n Implementa\ufffd\ufffdo das mec\ufffdnicas do Horntail (spawn e kill).\n-Corre\ufffd\ufffdo de bugs em casos onde valores de EXP ganhos excedem o limite m\ufffdximo de um inteiro de 32bits.\n\\ No newline at end of file\n+Corre\ufffd\ufffdo de bugs em casos onde valores de EXP ganhos excedem o limite m\ufffdximo de um inteiro de 32bits.\n+\n+20 Maio 2017,\n+Adi\ufffd\ufffdo: mec\ufffdnica de cadeia para GMs.\n+Em conjunto com vcoc, adicionaram-se comandos: !clearslot, !hide/unhide, !jail, !itemvac e !healmap.\n+Corre\ufffd\ufffdo de bug em tabela SQL que continha informa\ufffd\ufffdo imcompleta para com alguns registros de cards e respectivos mobs.\n\\ No newline at end of file"}, {"sha": "5b109e707b2e7430cd5613ef4fd75780ea7a50e2", "filename": "nbproject/private/private.xml", "status": "modified", "additions": 4, "deletions": 16, "changes": 20, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/7fcdc07b5b3f883da29619e094ba3f8ab401165a/nbproject/private/private.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/7fcdc07b5b3f883da29619e094ba3f8ab401165a/nbproject/private/private.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/nbproject/private/private.xml?ref=7fcdc07b5b3f883da29619e094ba3f8ab401165a", "patch": "@@ -3,24 +3,12 @@\n     <editor-bookmarks xmlns=\"http://www.netbeans.org/ns/editor-bookmarks/2\" lastBookmarkId=\"0\"/>\n     <open-files xmlns=\"http://www.netbeans.org/ns/projectui-open-files/2\">\n         <group>\n-            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/client/inventory/MaplePet.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/server/partyquest/MonsterCarnival.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/sql/tools/test_mobcarddrop.sql</file>\n             <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/client/command/Commands.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/scripts/npc/world0/2013002.js</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/constants/ServerConstants.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/server/life/MapleMonster.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/tools/MaplePacketCreator.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/scripts/event/OrbisPQ.js</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/net/MapleServerHandler.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/scripts/event/LudiPQ.js</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/net/server/channel/handlers/ScrollHandler.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/net/server/channel/handlers/ItemRewardHandler.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/net/server/channel/handlers/GeneralChatHandler.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/server/MapleInventoryManipulator.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/scripting/AbstractPlayerInteraction.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/scripting/event/EventInstanceManager.java</file>\n             <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/client/MapleCharacter.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/server/maps/MapleMap.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/net/server/channel/handlers/PetLootHandler.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/net/server/channel/handlers/ItemPickupHandler.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/scripting/event/EventManager.java</file>\n         </group>\n     </open-files>\n </project-private>"}, {"sha": "7084b03d403ca1e9e79b6fd8c796c381d52c1799", "filename": "scripts/portal/jail_in.js", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/7fcdc07b5b3f883da29619e094ba3f8ab401165a/scripts/portal/jail_in.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/7fcdc07b5b3f883da29619e094ba3f8ab401165a/scripts/portal/jail_in.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/jail_in.js?ref=7fcdc07b5b3f883da29619e094ba3f8ab401165a", "patch": "@@ -0,0 +1,9 @@\n+/**\n+ * @author: Ronan\n+ * @event: Jail - visit to jail :3\n+*/\n+\n+function enter(pi) {\n+        pi.warp(300000012,0);\n+        return(true);\n+}\n\\ No newline at end of file"}, {"sha": "6e3adff30af8bb8dd84a8c956d34d9ac63c289e6", "filename": "scripts/portal/jail_out.js", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/7fcdc07b5b3f883da29619e094ba3f8ab401165a/scripts/portal/jail_out.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/7fcdc07b5b3f883da29619e094ba3f8ab401165a/scripts/portal/jail_out.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/portal/jail_out.js?ref=7fcdc07b5b3f883da29619e094ba3f8ab401165a", "patch": "@@ -0,0 +1,21 @@\n+/**\n+ * @author: Ronan\n+ * @event: Jail\n+*/\n+\n+function enter(pi) {\n+        var jailedTime = pi.getJailTimeLeft();\n+    \n+        if(jailedTime <= 0) {\n+                pi.warp(300000010,0);\n+                return(true);\n+        }\n+        else {\n+                var seconds = Math.floor(jailedTime / 1000) % 60 ;\n+                var minutes = (Math.floor(jailedTime / (1000*60)) % 60);\n+                var hours   = (Math.floor(jailedTime / (1000*60*60)) % 24);\n+            \n+                pi.playerMessage(5, \"You have been caught in bad behaviour by the Maple POLICE. You've got to stay here for \" + hours + \" hours \" + minutes + \" minutes \" + seconds + \" seconds yet.\");\n+                return(false);\n+        }\n+}\n\\ No newline at end of file"}, {"sha": "a06e7120f4dd93af655b3429ba611ee2d17129a9", "filename": "sql/db_database.sql", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/7fcdc07b5b3f883da29619e094ba3f8ab401165a/sql/db_database.sql", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/7fcdc07b5b3f883da29619e094ba3f8ab401165a/sql/db_database.sql", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/sql/db_database.sql?ref=7fcdc07b5b3f883da29619e094ba3f8ab401165a", "patch": "@@ -175,6 +175,7 @@ CREATE TABLE IF NOT EXISTS `characters` (\n   `dataString` varchar(64) NOT NULL DEFAULT '',\n   `lastLogoutTime` timestamp NOT NULL DEFAULT '2015-01-01 05:00:00',\n   `pendantExp` tinyint(1) NOT NULL DEFAULT '0',\n+  `jailexpire` bigint(20) NOT NULL DEFAULT '0',\n   PRIMARY KEY (`id`),\n   KEY `accountid` (`accountid`),\n   KEY `party` (`party`),"}, {"sha": "e71b5bc94fee2c3c411de47698962fb35676b77c", "filename": "sql/db_drops.sql", "status": "modified", "additions": 19, "deletions": 6, "changes": 25, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/7fcdc07b5b3f883da29619e094ba3f8ab401165a/sql/db_drops.sql", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/7fcdc07b5b3f883da29619e094ba3f8ab401165a/sql/db_drops.sql", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/sql/db_drops.sql?ref=7fcdc07b5b3f883da29619e094ba3f8ab401165a", "patch": "@@ -19015,11 +19015,14 @@\n (9500319, 1422011, 1, 1, 0, 4000),\n (9500319, 1432046, 1, 1, 0, 4000),\n (9500319, 1332030, 1, 1, 0, 4000),\n-(9300188, 2388052, 1, 1, 0, 24000),\n-(9300196, 2388008, 1, 1, 0, 24000),\n-(9300204, 2388015, 1, 1, 0, 24000),\n-(9300207, 2388052, 1, 1, 0, 24000),\n-(9300209, 2388052, 1, 1, 0, 24000);\n+(9300188, 2388052, 1, 1, 0, 8000),\n+(9300196, 2388008, 1, 1, 0, 8000),\n+(9300204, 2388015, 1, 1, 0, 8000),\n+(9300201, 2388039, 1, 1, 0, 8000),\n+(9300206, 2388032, 1, 1, 0, 8000),\n+(9300207, 2388054, 1, 1, 0, 8000),\n+(9300209, 2388053, 1, 1, 0, 8000),\n+(9300215, 2388046, 1, 1, 0, 8000);\n \n # (dropperid, itemid, minqty, maxqty, questid, chance)\n \n@@ -19204,4 +19207,14 @@\n     (9102006, 4001099, 3, -1),\n     (9102007, 4001100, 3, -1);\n \n-  #global data already updated\n\\ No newline at end of file\n+  # updates info for all cards on monster book\n+  DROP TABLE `monstercarddata`;\n+  CREATE TABLE IF NOT EXISTS `monstercarddata` (\n+    `id` int(11) NOT NULL AUTO_INCREMENT,\n+    `cardid` int(11) NOT NULL DEFAULT '0',\n+    `mobid` int(11) NOT NULL DEFAULT '0',\n+    PRIMARY KEY (`id`) USING BTREE,\n+    UNIQUE KEY `id` (`id`)\n+  ) ENGINE=MyISAM  DEFAULT CHARSET=latin1 AUTO_INCREMENT=1 ;\n+\n+  INSERT INTO `monstercarddata` (`cardid`, `mobid`) (SELECT itemid, min(dropperid) FROM drop_data where itemid>=2380000 and itemid<2390000 group by itemid);\n\\ No newline at end of file"}, {"sha": "da578432bf9204730b733582ecf53f7af7badcb8", "filename": "src/client/MapleCharacter.java", "status": "modified", "additions": 24, "deletions": 3, "changes": 27, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/7fcdc07b5b3f883da29619e094ba3f8ab401165a/src/client/MapleCharacter.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/7fcdc07b5b3f883da29619e094ba3f8ab401165a/src/client/MapleCharacter.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/MapleCharacter.java?ref=7fcdc07b5b3f883da29619e094ba3f8ab401165a", "patch": "@@ -200,7 +200,7 @@\n     private int expRate = 1, mesoRate = 1, dropRate = 1;\n     private int omokwins, omokties, omoklosses, matchcardwins, matchcardties, matchcardlosses;\n     private int married;\n-    private long dojoFinish, lastfametime, lastUsedCashItem, lastHealed, lastMesoDrop = -1;\n+    private long dojoFinish, lastfametime, lastUsedCashItem, lastHealed, lastMesoDrop = -1, jailExpiration = -1;\n     private transient int localmaxhp, localmaxmp, localstr, localdex, localluk, localint_, magic, watk;\n     private boolean hidden, canDoor = true, Berserk, hasMerchant, whiteChat = false;\n     private int linkedLevel = 0;\n@@ -3183,6 +3183,7 @@ public static MapleCharacter loadCharFromDB(int charid, MapleClient client, bool\n             ret.face = rs.getInt(\"face\");\n             ret.accountid = rs.getInt(\"accountid\");\n             ret.mapid = rs.getInt(\"map\");\n+            ret.jailExpiration = rs.getLong(\"jailexpire\");\n             ret.initialSpawnPoint = rs.getInt(\"spawnpoint\");\n             ret.world = rs.getByte(\"world\");\n             ret.rank = rs.getInt(\"rank\");\n@@ -4154,7 +4155,7 @@ public synchronized void saveToDB() {\n             con.setTransactionIsolation(Connection.TRANSACTION_READ_UNCOMMITTED);\n             con.setAutoCommit(false);\n             PreparedStatement ps;\n-            ps = con.prepareStatement(\"UPDATE characters SET level = ?, fame = ?, str = ?, dex = ?, luk = ?, `int` = ?, exp = ?, gachaexp = ?, hp = ?, mp = ?, maxhp = ?, maxmp = ?, sp = ?, ap = ?, gm = ?, skincolor = ?, gender = ?, job = ?, hair = ?, face = ?, map = ?, meso = ?, hpMpUsed = ?, spawnpoint = ?, party = ?, buddyCapacity = ?, messengerid = ?, messengerposition = ?, mountlevel = ?, mountexp = ?, mounttiredness= ?, equipslots = ?, useslots = ?, setupslots = ?, etcslots = ?,  monsterbookcover = ?, vanquisherStage = ?, dojoPoints = ?, lastDojoStage = ?, finishedDojoTutorial = ?, vanquisherKills = ?, matchcardwins = ?, matchcardlosses = ?, matchcardties = ?, omokwins = ?, omoklosses = ?, omokties = ?, dataString = ?, fquest = ? WHERE id = ?\", Statement.RETURN_GENERATED_KEYS);\n+            ps = con.prepareStatement(\"UPDATE characters SET level = ?, fame = ?, str = ?, dex = ?, luk = ?, `int` = ?, exp = ?, gachaexp = ?, hp = ?, mp = ?, maxhp = ?, maxmp = ?, sp = ?, ap = ?, gm = ?, skincolor = ?, gender = ?, job = ?, hair = ?, face = ?, map = ?, meso = ?, hpMpUsed = ?, spawnpoint = ?, party = ?, buddyCapacity = ?, messengerid = ?, messengerposition = ?, mountlevel = ?, mountexp = ?, mounttiredness= ?, equipslots = ?, useslots = ?, setupslots = ?, etcslots = ?,  monsterbookcover = ?, vanquisherStage = ?, dojoPoints = ?, lastDojoStage = ?, finishedDojoTutorial = ?, vanquisherKills = ?, matchcardwins = ?, matchcardlosses = ?, matchcardties = ?, omokwins = ?, omoklosses = ?, omokties = ?, dataString = ?, fquest = ?, jailexpire = ? WHERE id = ?\", Statement.RETURN_GENERATED_KEYS);\n             if (gmLevel < 1 && level > 199) {\n                 ps.setInt(1, isCygnus() ? 120 : 200);\n             } else {\n@@ -4248,7 +4249,8 @@ public synchronized void saveToDB() {\n             ps.setInt(47, omokties);\n             ps.setString(48, dataString);\n             ps.setInt(49, quest_fame);\n-            ps.setInt(50, id);\n+            ps.setLong(50, jailExpiration);\n+            ps.setInt(51, id);\n \n             int updateRows = ps.executeUpdate();\n             if (updateRows < 1) {\n@@ -5692,4 +5694,23 @@ public int getRemainingSpSize() {\n         }\n         return sp;\n     }\n+    \n+    public long getJailExpirationTimeLeft() {\n+        return jailExpiration - System.currentTimeMillis();\n+    }\n+    \n+    private void setFutureJailExpiration(long time) {\n+        jailExpiration = System.currentTimeMillis() + time;\n+    }\n+    \n+    public void addJailExpirationTime(long time) {\n+        long timeLeft = getJailExpirationTimeLeft();\n+\n+        if(timeLeft <= 0) setFutureJailExpiration(time);\n+        else setFutureJailExpiration(timeLeft + time);\n+    }\n+    \n+    public void removeJailExpirationTime() {\n+        jailExpiration = 0;\n+    }\n }"}, {"sha": "0ba82b6ed83f6b68abf9be32ce65998c993e32aa", "filename": "src/client/command/Commands.java", "status": "modified", "additions": 234, "deletions": 75, "changes": 309, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/7fcdc07b5b3f883da29619e094ba3f8ab401165a/src/client/command/Commands.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/7fcdc07b5b3f883da29619e094ba3f8ab401165a/src/client/command/Commands.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/command/Commands.java?ref=7fcdc07b5b3f883da29619e094ba3f8ab401165a", "patch": "@@ -333,10 +333,10 @@ public static boolean executePlayerCommand(MapleClient c, String[] sub, char hea\n \t\t\tplayer.message(\"@uptime: Shows how long Solaxia has been online.\");\n \t\t\tplayer.message(\"@bosshp: Displays the remaining HP of the bosses on your map.\");\n                         if(ServerConstants.USE_DEBUG) {\n-                            player.message(\"@debugpos: Displays the coordinates on the map the player is currently located.\");\n-                            player.message(\"@debugmap: Displays info about the current map the player is located.\");\n-                            player.message(\"@debugevent: Displays the name of the event in which the player is currently registered.\");\n-                            player.message(\"@debugreactors: Displays current info for all reactors on the map the the player is currently located.\");\n+                                player.message(\"@debugpos: Displays the coordinates on the map the player is currently located.\");\n+                                player.message(\"@debugmap: Displays info about the current map the player is located.\");\n+                                player.message(\"@debugevent: Displays the name of the event in which the player is currently registered.\");\n+                                player.message(\"@debugreactors: Displays current info for all reactors on the map the player is currently located.\");\n                         }\n \t\t\tbreak;\n \t\tcase \"time\":\n@@ -364,7 +364,7 @@ public static boolean executePlayerCommand(MapleClient c, String[] sub, char hea\n \t\t\tint seconds = (int) (milliseconds / 1000) % 60 ;\n \t\t\tint minutes = (int) ((milliseconds / (1000*60)) % 60);\n \t\t\tint hours   = (int) ((milliseconds / (1000*60*60)) % 24);\n-\t\t\tint days\t= (int) ((milliseconds / (1000*60*60*24)));\n+\t\t\tint days    = (int) ((milliseconds / (1000*60*60*24)));\n  \t\t\tplayer.yellowMessage(\"Solaxia has been online for \" + days + \" days \" + hours + \" hours \" + minutes + \" minutes and \" + seconds + \" seconds.\");\n \t\t\tbreak;\n \t\tcase \"gacha\":\n@@ -554,8 +554,6 @@ public static boolean executePlayerCommand(MapleClient c, String[] sub, char hea\n \t\t\tbreak;\n                 */\n \t\tcase \"joinevent\":\n-\t\tcase \"event\":\n-\t\tcase \"join\":\n \t\t\tif(!FieldLimit.CHANGECHANNEL.check(player.getMap().getFieldLimit())) {\n \t\t\t\tMapleEvent event = c.getChannelServer().getEvent();\n \t\t\t\tif(event != null) {\n@@ -583,7 +581,6 @@ public static boolean executePlayerCommand(MapleClient c, String[] sub, char hea\n \t\t\t}\n \t\t\tbreak;\n \t\tcase \"leaveevent\":\n-\t\tcase \"leave\":\n \t\t\tint returnMap = player.getSavedLocation(\"EVENT\");\n \t\t\tif(returnMap != -1) {\n \t\t\t\tif(player.getOla() != null) {\n@@ -685,7 +682,27 @@ public static boolean executeGMCommand(MapleClient c, String[] sub, char heading\n \t\tMapleCharacter player = c.getPlayer();\n \t\tChannel cserv = c.getChannelServer();\n \t\tServer srv = Server.getInstance();\n-\t\tif (sub[0].equals(\"ap\")) {\n+                \n+                if (sub[0].equals(\"sp\")) {\n+                        if (sub.length < 2){\n+\t\t\t\tplayer.yellowMessage(\"Syntax: !sp [<playername>] <newsp>\");\n+\t\t\t\treturn true;\n+\t\t\t}\n+                        \n+\t\t\tif (sub.length == 2) {\n+\t\t\t\tplayer.setRemainingSp(Integer.parseInt(sub[1]));\n+\t\t\t\tplayer.updateSingleStat(MapleStat.AVAILABLESP, player.getRemainingSp());\n+\t\t\t} else {\n+\t\t\t\tMapleCharacter victim = c.getChannelServer().getPlayerStorage().getCharacterByName(sub[1]);\n+\t\t\t\tvictim.setRemainingSp(Integer.parseInt(sub[2]));\n+\t\t\t\tvictim.updateSingleStat(MapleStat.AVAILABLESP, player.getRemainingSp());\n+\t\t\t}\n+                } else if (sub[0].equals(\"ap\")) {\n+                        if (sub.length < 2){\n+\t\t\t\tplayer.yellowMessage(\"Syntax: !ap [<playername>] <newap>\");\n+\t\t\t\treturn true;\n+\t\t\t}\n+                    \n \t\t\tif (sub.length < 3) {\n \t\t\t\tplayer.setRemainingAp(Integer.parseInt(sub[1]));\n \t\t\t\tplayer.updateSingleStat(MapleStat.AVAILABLEAP, player.getRemainingAp());\n@@ -702,7 +719,7 @@ public static boolean executeGMCommand(MapleClient c, String[] sub, char heading\n \t\t} else if (sub[0].equals(\"spawn\")) {\n                         if (sub.length < 2) {\n \t\t\t\tplayer.yellowMessage(\"Syntax: !spawn <mobid>\");\n-\t\t\t\treturn false;\n+\t\t\t\treturn true;\n \t\t\t}\n                     \n \t\t\tMapleMonster monster = MapleLifeFactory.getMonster(Integer.parseInt(sub[1]));\n@@ -756,7 +773,7 @@ public static boolean executeGMCommand(MapleClient c, String[] sub, char heading\n \t\t} else if (sub[0].equals(\"go\")) {\n                         if (sub.length < 2){\n \t\t\t\tplayer.yellowMessage(\"Syntax: !go <mapid>\");\n-\t\t\t\treturn false;\n+\t\t\t\treturn true;\n \t\t\t}\n                     \n \t\t\tif (gotomaps.containsKey(sub[1])) {\n@@ -806,14 +823,14 @@ public static boolean executeGMCommand(MapleClient c, String[] sub, char heading\n \t\t} else if (sub[0].equals(\"warp\")) {\n                         if (sub.length < 2){\n \t\t\t\tplayer.yellowMessage(\"Syntax: !warp <mapid>\");\n-\t\t\t\treturn false;\n+\t\t\t\treturn true;\n \t\t\t}\n                     \n \t\t\ttry {\n \t\t\t\tMapleMap target = c.getChannelServer().getMapFactory().getMap(Integer.parseInt(sub[1]));\n \t\t\t\tif (target == null) {\n \t\t\t\t\tplayer.yellowMessage(\"Map ID \" + sub[1] + \" is invalid.\");\n-\t\t\t\t\treturn false;\n+\t\t\t\t\treturn true;\n \t\t\t\t}\n \t\t\t\tif (player.getEventInstance() != null) {\n \t\t\t\t\tplayer.getEventInstance().removePlayer(player);\n@@ -822,7 +839,7 @@ public static boolean executeGMCommand(MapleClient c, String[] sub, char heading\n \t\t\t} catch (Exception ex) {\n                                 ex.printStackTrace();\n \t\t\t\tplayer.yellowMessage(\"Map ID \" + sub[1] + \" is invalid.\");\n-\t\t\t\treturn false;\n+\t\t\t\treturn true;\n \t\t\t}\n \t\t} else if (sub[0].equals(\"reloadmap\")) {\n \t\t\tMapleMap oldMap = c.getPlayer().getMap();\n@@ -838,7 +855,7 @@ public static boolean executeGMCommand(MapleClient c, String[] sub, char heading\n \t\t\t\tfor (String s : songs){\n \t\t\t\t\tplayer.yellowMessage(s);\n \t\t\t\t}\n-\t\t\t\treturn false;\n+\t\t\t\treturn true;\n \t\t\t}\n \t\t\tString song = joinStringFrom(sub, 1); \n \t\t\tfor (String s : songs){\n@@ -855,12 +872,12 @@ public static boolean executeGMCommand(MapleClient c, String[] sub, char heading\n \t\t} else if (sub[0].equals(\"monitor\")) {\n \t\t\tif (sub.length < 1){\n \t\t\t\tplayer.yellowMessage(\"Syntax: !monitor <ign>\");\n-\t\t\t\treturn false;\n+\t\t\t\treturn true;\n \t\t\t}\n \t\t\tMapleCharacter victim = c.getWorldServer().getPlayerStorage().getCharacterByName(sub[1]);\n \t\t\tif (victim == null){\n \t\t\t\tplayer.yellowMessage(\"Player not found!\");\n-\t\t\t\treturn false;\n+\t\t\t\treturn true;\n \t\t\t}\n \t\t\tboolean monitored = MapleLogger.monitored.contains(victim.getName());\n \t\t\tif (monitored){\n@@ -878,12 +895,12 @@ public static boolean executeGMCommand(MapleClient c, String[] sub, char heading\n \t\t} else if (sub[0].equals(\"ignore\")) {\n \t\t\tif (sub.length < 1){\n \t\t\t\tplayer.yellowMessage(\"Syntax: !ignore <ign>\");\n-\t\t\t\treturn false;\n+\t\t\t\treturn true;\n \t\t\t}\n \t\t\tMapleCharacter victim = c.getWorldServer().getPlayerStorage().getCharacterByName(sub[1]);\n \t\t\tif (victim == null){\n \t\t\t\tplayer.yellowMessage(\"Player not found!\");\n-\t\t\t\treturn false;\n+\t\t\t\treturn true;\n \t\t\t}\n \t\t\tboolean monitored = MapleLogger.ignored.contains(victim.getName());\n \t\t\tif (monitored){\n@@ -907,7 +924,7 @@ public static boolean executeGMCommand(MapleClient c, String[] sub, char heading\n \t\t} else if (sub[0].equals(\"dc\")) {\n                         if (sub.length < 2){\n \t\t\t\tplayer.yellowMessage(\"Syntax: !dc <playername>\");\n-\t\t\t\treturn false;\n+\t\t\t\treturn true;\n \t\t\t}\n                     \n \t\t\tMapleCharacter victim = c.getWorldServer().getPlayerStorage().getCharacterByName(sub[1]);\n@@ -934,7 +951,7 @@ public static boolean executeGMCommand(MapleClient c, String[] sub, char heading\n \t\t} else if (sub[0].equals(\"exprate\")) {\n                         if (sub.length < 2){\n \t\t\t\tplayer.yellowMessage(\"Syntax: !exprate <newrate>\");\n-\t\t\t\treturn false;\n+\t\t\t\treturn true;\n \t\t\t}\n \t\t\tc.getWorldServer().setExpRate(Integer.parseInt(sub[1]));\n \t\t} else if (sub[0].equals(\"chat\")) {\n@@ -943,7 +960,7 @@ public static boolean executeGMCommand(MapleClient c, String[] sub, char heading\n \t\t} else if (sub[0].equals(\"warpto\")) {\n                         if (sub.length < 2){\n \t\t\t\tplayer.yellowMessage(\"Syntax: !warpto <mapid>\");\n-\t\t\t\treturn false;\n+\t\t\t\treturn true;\n \t\t\t}\n                     \n \t\t\tMapleCharacter victim = cserv.getPlayerStorage().getCharacterByName(sub[1]);\n@@ -981,7 +998,7 @@ public static boolean executeGMCommand(MapleClient c, String[] sub, char heading\n \t\t} else if (sub[0].equals(\"warphere\")) {\n                         if (sub.length < 2){\n \t\t\t\tplayer.yellowMessage(\"Syntax: !warphere <playername>\");\n-\t\t\t\treturn false;\n+\t\t\t\treturn true;\n \t\t\t}\n                     \n \t\t\tMapleCharacter victim = cserv.getPlayerStorage().getCharacterByName(sub[1]);\n@@ -1018,7 +1035,7 @@ public static boolean executeGMCommand(MapleClient c, String[] sub, char heading\n \t\t} else if (sub[0].equals(\"fame\")) {\n                         if (sub.length < 3){\n \t\t\t\tplayer.yellowMessage(\"Syntax: !fame <playername> <gainfame>\");\n-\t\t\t\treturn false;\n+\t\t\t\treturn true;\n \t\t\t}\n                         \n \t\t\tMapleCharacter victim = cserv.getPlayerStorage().getCharacterByName(sub[1]);\n@@ -1027,7 +1044,7 @@ public static boolean executeGMCommand(MapleClient c, String[] sub, char heading\n \t\t} else if (sub[0].equals(\"giftnx\")) {\n                         if (sub.length < 3){\n \t\t\t\tplayer.yellowMessage(\"Syntax: !giftnx <playername> <gainnx>\");\n-\t\t\t\treturn false;\n+\t\t\t\treturn true;\n \t\t\t}\n \t\t\tcserv.getPlayerStorage().getCharacterByName(sub[1]).getCashShop().gainCash(1, Integer.parseInt(sub[2]));\n \t\t\tplayer.message(\"Done\");\n@@ -1038,13 +1055,13 @@ public static boolean executeGMCommand(MapleClient c, String[] sub, char heading\n \t\t} else if (sub[0].equals(\"vp\")) {\n                         if (sub.length < 2){\n \t\t\t\tplayer.yellowMessage(\"Syntax: !vp <gainvotepoint>\");\n-\t\t\t\treturn false;\n+\t\t\t\treturn true;\n \t\t\t}\n \t\t\tc.addVotePoints(Integer.parseInt(sub[1]));\n \t\t} else if (sub[0].equals(\"id\")) {\n                         if (sub.length < 2){\n \t\t\t\tplayer.yellowMessage(\"Syntax: !id <id>\");\n-\t\t\t\treturn false;\n+\t\t\t\treturn true;\n \t\t\t}\n \t\t\ttry {\n \t\t\t\ttry (BufferedReader dis = new BufferedReader(new InputStreamReader(new URL(\"http://www.mapletip.com/search_java.php?search_value=\" + sub[1] + \"&check=true\").openConnection().getInputStream()))) {\n@@ -1059,7 +1076,7 @@ public static boolean executeGMCommand(MapleClient c, String[] sub, char heading\n \t\t} else if (sub[0].equals(\"item\") || sub[0].equals(\"drop\")) {\n                         if (sub.length < 2){\n \t\t\t\tplayer.yellowMessage(\"Syntax: !item <itemid> <quantity>\");\n-\t\t\t\treturn false;\n+\t\t\t\treturn true;\n \t\t\t}\n                         \n \t\t\tint itemId = Integer.parseInt(sub[1]);\n@@ -1110,7 +1127,7 @@ public static boolean executeGMCommand(MapleClient c, String[] sub, char heading\n \t\t} else if (sub[0].equals(\"kill\")) {\n                         if (sub.length < 2){\n \t\t\t\tplayer.yellowMessage(\"Syntax: !kill <playername>\");\n-\t\t\t\treturn false;\n+\t\t\t\treturn true;\n \t\t\t}\n \t\t\t\n                         MapleCharacter victim = cserv.getPlayerStorage().getCharacterByName(sub[1]);\n@@ -1119,7 +1136,7 @@ public static boolean executeGMCommand(MapleClient c, String[] sub, char heading\n \t\t} else if (sub[0].equals(\"seed\")) {\n \t\t\tif (player.getMapId() != 910010000) {\n \t\t\t\tplayer.yellowMessage(\"This command can only be used in HPQ.\");\n-\t\t\t\treturn false;\n+\t\t\t\treturn true;\n \t\t\t}\n \t\t\tPoint pos[] = {new Point(7, -207), new Point(179, -447), new Point(-3, -687), new Point(-357, -687), new Point(-538, -447), new Point(-359, -207)};\n \t\t\tint seed[] = {4001097, 4001096, 4001095, 4001100, 4001099, 4001098};\n@@ -1154,7 +1171,7 @@ public static boolean executeGMCommand(MapleClient c, String[] sub, char heading\n \t\t} else if (sub[0].equals(\"level\")) {\n                         if (sub.length < 2){\n \t\t\t\tplayer.yellowMessage(\"Syntax: !level <newlevel>\");\n-\t\t\t\treturn false;\n+\t\t\t\treturn true;\n \t\t\t}\n                     \n \t\t\tplayer.setLevel(Integer.parseInt(sub[1]) - 1);\n@@ -1163,7 +1180,7 @@ public static boolean executeGMCommand(MapleClient c, String[] sub, char heading\n \t\t} else if (sub[0].equals(\"levelpro\")) {\n                         if (sub.length < 2){\n \t\t\t\tplayer.yellowMessage(\"Syntax: !levelpro <newlevel>\");\n-\t\t\t\treturn false;\n+\t\t\t\treturn true;\n \t\t\t}\n                     \n \t\t\twhile (player.getLevel() < Math.min(255, Integer.parseInt(sub[1]))) {\n@@ -1206,7 +1223,7 @@ public static boolean executeGMCommand(MapleClient c, String[] sub, char heading\n \t\t} else if (sub[0].equals(\"openportal\")) {\n                         if (sub.length < 2){\n \t\t\t\tplayer.yellowMessage(\"Syntax: !openportal <portalid>\");\n-\t\t\t\treturn false;\n+\t\t\t\treturn true;\n \t\t\t}\n \t\t\tplayer.getMap().getPortal(sub[1]).setPortalState(true);\n \t\t} else if (sub[0].equals(\"pe\")) {\n@@ -1220,7 +1237,7 @@ public static boolean executeGMCommand(MapleClient c, String[] sub, char heading\n \t\t\t} catch (IOException ex) {\n                                 ex.printStackTrace();\n \t\t\t\tplayer.yellowMessage(\"Failed to load pe.txt\");\n-\t\t\t\treturn false;\n+\t\t\t\treturn true;\n \t\t\t}\n \t\t\tMaplePacketLittleEndianWriter mplew = new MaplePacketLittleEndianWriter();\n \t\t\tmplew.write(HexTool.getByteArrayFromHexString(packet));\n@@ -1229,25 +1246,20 @@ public static boolean executeGMCommand(MapleClient c, String[] sub, char heading\n \t\t\tfinal MaplePacketHandler packetHandler = PacketProcessor.getProcessor(0, c.getChannel()).getHandler(packetId);\n \t\t\tif (packetHandler != null && packetHandler.validateState(c)) {\n \t\t\t\ttry {\n-\t\t\t\t\tplayer.yellowMessage(\"Recieving: \" + packet);\n+\t\t\t\t\tplayer.yellowMessage(\"Receiving: \" + packet);\n \t\t\t\t\tpacketHandler.handlePacket(slea, c);\n \t\t\t\t} catch (final Throwable t) {\n \t\t\t\t\tFilePrinter.printError(FilePrinter.PACKET_HANDLER + packetHandler.getClass().getName() + \".txt\", t, \"Error for \" + (c.getPlayer() == null ? \"\" : \"player ; \" + c.getPlayer() + \" on map ; \" + c.getPlayer().getMapId() + \" - \") + \"account ; \" + c.getAccountName() + \"\\r\\n\" + slea.toString());\n-\t\t\t\t\treturn false;\n+\t\t\t\t\treturn true;\n \t\t\t\t}\n \t\t\t}\n \t\t} else if (sub[0].equals(\"closeportal\")) {\n                         if (sub.length < 2){\n \t\t\t\tplayer.yellowMessage(\"Syntax: !closeportal <portalid>\");\n-\t\t\t\treturn false;\n+\t\t\t\treturn true;\n \t\t\t}\n \t\t\tplayer.getMap().getPortal(sub[1]).setPortalState(false);\n \t\t} else if (sub[0].equals(\"startevent\")) {\n-\t\t\tfor (MapleCharacter chr : player.getMap().getCharacters()) {\n-\t\t\t\tplayer.getMap().startEvent(chr);\n-\t\t\t}\n-\t\t\tc.getChannelServer().setEvent(null);\n-\t\t} else if (sub[0].equals(\"scheduleevent\")) {\n \t\t\tint players = 50;\n \t\t\tif(sub.length > 1)\n \t\t\t\tplayers = Integer.parseInt(sub[1]);\n@@ -1278,7 +1290,7 @@ public static boolean executeGMCommand(MapleClient c, String[] sub, char heading\n \t\t} else if (sub[0].equalsIgnoreCase(\"search\")) {\n                         if (sub.length < 3){\n \t\t\t\tplayer.yellowMessage(\"Syntax: !search <type> <name>\");\n-\t\t\t\treturn false;\n+\t\t\t\treturn true;\n \t\t\t}\n                     \n \t\t\tStringBuilder sb = new StringBuilder();\n@@ -1347,7 +1359,7 @@ public static boolean executeGMCommand(MapleClient c, String[] sub, char heading\n \t\t} else if (sub[0].equals(\"unban\")) {\n                         if (sub.length < 2){\n \t\t\t\tplayer.yellowMessage(\"Syntax: !unban <playername>\");\n-\t\t\t\treturn false;\n+\t\t\t\treturn true;\n \t\t\t}\n                     \n \t\t\ttry {\n@@ -1371,7 +1383,7 @@ public static boolean executeGMCommand(MapleClient c, String[] sub, char heading\n \t\t} else if (sub[0].equals(\"ban\")) {\n \t\t\tif (sub.length < 3) {\n \t\t\t\tplayer.yellowMessage(\"Syntax: !ban <IGN> <Reason> (Please be descriptive)\");\n-\t\t\t\treturn false;\n+\t\t\t\treturn true;\n \t\t\t}\n \t\t\tString ign = sub[1];\n \t\t\tString reason = joinStringFrom(sub, 2);\n@@ -1416,9 +1428,162 @@ public void run() {\n \t\t\t} else {\n \t\t\t\tc.announce(MaplePacketCreator.getGMEffect(6, (byte) 1));\n \t\t\t}\n+                        \n+                } else if (sub[0].equals(\"jail\")) {\n+                        if (sub.length < 2) {\n+\t\t\t\tplayer.yellowMessage(\"Syntax: !jail <playername> [<minutes>]\");\n+\t\t\t\treturn true;\n+\t\t\t}\n+                        \n+                        int minutesJailed = 5;\n+                        if(sub.length >= 3) {\n+                                minutesJailed = Integer.valueOf(sub[2]);\n+                                if(minutesJailed <= 0) {\n+                                        player.yellowMessage(\"Syntax: !jail <playername> [<minutes>]\");\n+                                        return true;\n+                                }\n+                        }\n+                    \n+                        MapleCharacter victim = cserv.getPlayerStorage().getCharacterByName(sub[1]);\n+                        if (victim != null) {\n+                                victim.addJailExpirationTime(minutesJailed * 60 * 1000);\n+                            \n+                                int mapid = 300000012;\n+                                \n+                                if(victim.getMapId() != mapid) {    // those gone to jail won't be changing map anyway\n+                                        MapleMap target = cserv.getMapFactory().getMap(mapid);\n+                                        MaplePortal targetPortal = target.getPortal(0);\n+                                        victim.changeMap(target, targetPortal);\n+                                        player.dropMessage(victim.getName() + \" was jailed for \" + minutesJailed + \" minutes.\");\n+                                }\n+                                else {\n+                                        player.dropMessage(victim.getName() + \"'s time in jail has been extended for \" + minutesJailed + \" minutes.\");\n+                                }\n+                                \n+                        } else {\n+                                player.dropMessage(sub[1] + \" not found on this channel! Make sure your target is logged on and on the same channel as yours.\");\n+                        }\n+                        \n+                } else if (sub[0].equals(\"unjail\")) {\n+                        if (sub.length < 2) {\n+\t\t\t\tplayer.yellowMessage(\"Syntax: !unjail <playername>\");\n+\t\t\t\treturn true;\n+\t\t\t}\n+                        \n+                        MapleCharacter victim = cserv.getPlayerStorage().getCharacterByName(sub[1]);\n+                        if (victim != null) {\n+                                if(victim.getJailExpirationTimeLeft() <= 0) {\n+                                    player.dropMessage(\"This player is already free.\");\n+                                    return true;\n+                                }\n+                                victim.removeJailExpirationTime();\n+                                victim.dropMessage(\"By lack of concrete proof you are now unjailed. Enjoy freedom!\");\n+                                player.dropMessage(victim.getName() + \" was unjailed.\");\n+                        } else {\n+                                player.dropMessage(sub[1] + \" not found on this channel! Make sure your target is logged on and on the same channel as yours.\");\n+                        }\n+                } else if (sub[0].equals(\"clearslot\")) {\n+                        if (sub.length < 2) {\n+                                player.yellowMessage(\"Syntax: !clearslot <all, equip, use, setup, etc or cash.>\");\n+                                return true;\n+                        }\n+                        String type = sub[1];\n+                        if (type.equals(\"all\")) {\n+                                for (int i = 0; i < 101; i++) {\n+                                        Item tempItem = c.getPlayer().getInventory(MapleInventoryType.EQUIP).getItem((byte) i);\n+                                        if (tempItem == null)\n+                                                continue;\n+                                        MapleInventoryManipulator.removeFromSlot(c, MapleInventoryType.EQUIP, (byte) i, tempItem.getQuantity(), false, true);\n+                                }\n+                                for (int i = 0; i < 101; i++) {\n+                                        Item tempItem = c.getPlayer().getInventory(MapleInventoryType.USE).getItem((byte) i);\n+                                        if (tempItem == null)\n+                                                continue;\n+                                        MapleInventoryManipulator.removeFromSlot(c, MapleInventoryType.USE, (byte) i, tempItem.getQuantity(), false, true);\n+                                }\n+                                for (int i = 0; i < 101; i++) {\n+                                        Item tempItem = c.getPlayer().getInventory(MapleInventoryType.ETC).getItem((byte) i);\n+                                        if (tempItem == null)\n+                                                continue;\n+                                        MapleInventoryManipulator.removeFromSlot(c, MapleInventoryType.ETC, (byte) i, tempItem.getQuantity(), false, true);\n+                                }\n+                                for (int i = 0; i < 101; i++) {\n+                                        Item tempItem = c.getPlayer().getInventory(MapleInventoryType.SETUP).getItem((byte) i);\n+                                        if (tempItem == null)\n+                                                continue;\n+                                        MapleInventoryManipulator.removeFromSlot(c, MapleInventoryType.SETUP, (byte) i, tempItem.getQuantity(), false, true);\n+                                }\n+                                for (int i = 0; i < 101; i++) {\n+                                        Item tempItem = c.getPlayer().getInventory(MapleInventoryType.CASH).getItem((byte) i);\n+                                        if (tempItem == null)\n+                                                continue;\n+                                        MapleInventoryManipulator.removeFromSlot(c, MapleInventoryType.CASH, (byte) i, tempItem.getQuantity(), false, true);\n+                                }\n+                                player.yellowMessage(\"All Slots Cleared.\");\n+                                }\n+                        else if (type.equals(\"equip\")) {\n+                                for (int i = 0; i < 101; i++) {\n+                                        Item tempItem = c.getPlayer().getInventory(MapleInventoryType.EQUIP).getItem((byte) i);\n+                                        if (tempItem == null)\n+                                                continue;\n+                                        MapleInventoryManipulator.removeFromSlot(c, MapleInventoryType.EQUIP, (byte) i, tempItem.getQuantity(), false, true);\n+                                }\n+                                player.yellowMessage(\"Equipment Slot Cleared.\");\n+                        }\n+                        else if (type.equals(\"use\")) {\n+                                for (int i = 0; i < 101; i++) {\n+                                        Item tempItem = c.getPlayer().getInventory(MapleInventoryType.USE).getItem((byte) i);\n+                                        if (tempItem == null)\n+                                                continue;\n+                                        MapleInventoryManipulator.removeFromSlot(c, MapleInventoryType.USE, (byte) i, tempItem.getQuantity(), false, true);\n+                                }\n+                                player.yellowMessage(\"Use Slot Cleared.\");\n+                        }\n+                        else if (type.equals(\"setup\")) {\n+                                for (int i = 0; i < 101; i++) {\n+                                        Item tempItem = c.getPlayer().getInventory(MapleInventoryType.SETUP).getItem((byte) i);\n+                                        if (tempItem == null)\n+                                                continue;\n+                                        MapleInventoryManipulator.removeFromSlot(c, MapleInventoryType.SETUP, (byte) i, tempItem.getQuantity(), false, true);\n+                                }\n+                                player.yellowMessage(\"Set-Up Slot Cleared.\");\n+                        }\n+                        else if (type.equals(\"etc\")) {\n+                                for (int i = 0; i < 101; i++) {\n+                                        Item tempItem = c.getPlayer().getInventory(MapleInventoryType.ETC).getItem((byte) i);\n+                                        if (tempItem == null)\n+                                                continue;\n+                                        MapleInventoryManipulator.removeFromSlot(c, MapleInventoryType.ETC, (byte) i, tempItem.getQuantity(), false, true);\n+                                }\n+                                player.yellowMessage(\"ETC Slot Cleared.\");\n+                        }\n+                        else if (type.equals(\"cash\")) {\n+                                for (int i = 0; i < 101; i++) {\n+                                        Item tempItem = c.getPlayer().getInventory(MapleInventoryType.CASH).getItem((byte) i);\n+                                        if (tempItem == null)\n+                                                continue;\n+                                        MapleInventoryManipulator.removeFromSlot(c, MapleInventoryType.CASH, (byte) i, tempItem.getQuantity(), false, true);\n+                                }\n+                                player.yellowMessage(\"Cash Slot Cleared.\");\n+                        }\n+                        else player.yellowMessage(\"Slot\" + type + \" does not exist!\");\n+                } else if (sub[0].equals(\"hide\")) {\n+                        SkillFactory.getSkill(9101004).getEffect(SkillFactory.getSkill(9101004).getMaxLevel()).applyTo(player);\n+                } else if (sub[0].equals(\"unhide\")) {\n+                        SkillFactory.getSkill(9101004).getEffect(SkillFactory.getSkill(9101004).getMaxLevel()).applyTo(player);\n+                        \n+                } else if (sub[0].equals(\"healmap\")) {\n+                        for (MapleCharacter mch : player.getMap().getCharacters()) {\n+                                if (mch != null) {\n+                                        mch.setHp(mch.getMaxHp());\n+                                        mch.updateSingleStat(MapleStat.HP, mch.getMaxHp());\n+                                        mch.setMp(mch.getMaxMp());\n+                                        mch.updateSingleStat(MapleStat.MP, mch.getMaxMp());\n+                                }\n+                        }\n                 } else if (sub[0].equalsIgnoreCase(\"night\")) {\n-                    player.getMap().broadcastNightEffect();\n-                    player.yellowMessage(\"Done.\");\n+                        player.getMap().broadcastNightEffect();\n+                        player.yellowMessage(\"Done.\");\n \t\t} else {\n \t\t\treturn false;\n \t\t}\n@@ -1446,22 +1611,6 @@ public static void executeAdminCommand(MapleClient c, String[] sub, char heading\n                        player.getMap().spawnMonsterOnGroundBelow(MapleLifeFactory.getMonster(8820001), player.getPosition());\n                        break;\n                     \n-\t\tcase \"sp\":  //Changed to support giving sp /a\n-                        if (sub.length < 2){\n-\t\t\t\tplayer.yellowMessage(\"Syntax: !sp <newsp>\");\n-\t\t\t\treturn;\n-\t\t\t}\n-                        \n-\t\t\tif (sub.length == 2) {\n-\t\t\t\tplayer.setRemainingSp(Integer.parseInt(sub[1]));\n-\t\t\t\tplayer.updateSingleStat(MapleStat.AVAILABLESP, player.getRemainingSp());\n-\t\t\t} else {\n-\t\t\t\tMapleCharacter victim = c.getChannelServer().getPlayerStorage().getCharacterByName(sub[1]);\n-\t\t\t\tvictim.setRemainingSp(Integer.parseInt(sub[2]));\n-\t\t\t\tvictim.updateSingleStat(MapleStat.AVAILABLESP, player.getRemainingSp());\n-\t\t\t}\n-\t\t\tbreak;\n-                \n \t\tcase \"packet\":\n \t\t\tplayer.getMap().broadcastMessage(MaplePacketCreator.customPacket(joinStringFrom(sub, 1)));\n \t\t\tbreak;\n@@ -1617,18 +1766,28 @@ public static void executeAdminCommand(MapleClient c, String[] sub, char heading\n \t\t\t\tplayer.equipChanged();\n \t\t\t}\n \t\t\tbreak;\n-\t\tcase \"itemvac\":\n-\t\t\tList<MapleMapObject> items = player.getMap().getMapObjectsInRange(player.getPosition(), Double.POSITIVE_INFINITY, Arrays.asList(MapleMapObjectType.ITEM));\n-\t\t\tfor (MapleMapObject item : items) {\n-\t\t\t\tMapleMapItem mapitem = (MapleMapItem) item;\n-\t\t\t\tif (!MapleInventoryManipulator.addFromDrop(c, mapitem.getItem(), true)) {\n-\t\t\t\t\tcontinue;\n-\t\t\t\t}\n-\t\t\t\tmapitem.setPickedUp(true);\n-\t\t\t\tplayer.getMap().broadcastMessage(MaplePacketCreator.removeItemFromMap(mapitem.getObjectId(), 2, player.getId()), mapitem.getPosition());\n-\t\t\t\tplayer.getMap().removeMapObject(item);\n-\t\t\t}\n-\t\t\tbreak;\n+                    \n+                case \"itemvac\":\n+                    List<MapleMapObject> items = player.getMap().getMapObjectsInRange(player.getPosition(), Double.POSITIVE_INFINITY, Arrays.asList(MapleMapObjectType.ITEM));\n+                    for (MapleMapObject item : items) {\n+                        MapleMapItem mapItem = (MapleMapItem) item;\n+                        if (mapItem.getMeso() > 0) {\n+                            player.gainMeso(mapItem.getMeso(), true);\n+                        } else if (mapItem.getItem().getItemId() >= 5000000 && mapItem.getItem().getItemId() <= 5000100) {\n+                            int petId = MaplePet.createPet(mapItem.getItem().getItemId());\n+                            if (petId == -1) {\n+                                continue;\n+                            }\n+                            MapleInventoryManipulator.addById(c, mapItem.getItem().getItemId(), mapItem.getItem().getQuantity(), null, petId);\n+                        } else {\n+                            MapleInventoryManipulator.addFromDrop(c, mapItem.getItem(), true);\n+                        }\n+                        mapItem.setPickedUp(true);\n+                        player.getMap().removeMapObject(item);\n+                        player.getMap().broadcastMessage(MaplePacketCreator.removeItemFromMap(mapItem.getObjectId(), 2, player.getId()), mapItem.getPosition());\n+                    }\n+                    break;\n+                    \n \t\tcase \"clearquestcache\":\n \t\t\tMapleQuest.clearCache();\n \t\t\tplayer.dropMessage(5, \"Quest Cache Cleared.\");"}, {"sha": "8b662f81a829781a8bff6dcb5e68a14a30c41757", "filename": "src/scripting/AbstractPlayerInteraction.java", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/7fcdc07b5b3f883da29619e094ba3f8ab401165a/src/scripting/AbstractPlayerInteraction.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/7fcdc07b5b3f883da29619e094ba3f8ab401165a/src/scripting/AbstractPlayerInteraction.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/scripting/AbstractPlayerInteraction.java?ref=7fcdc07b5b3f883da29619e094ba3f8ab401165a", "patch": "@@ -829,4 +829,8 @@ public MapleExpedition getExpedition(MapleExpeditionType type) {\n \t\t}\n \t\treturn null;\n \t}\n+        \n+        public long getJailTimeLeft() {\n+                return getPlayer().getJailExpirationTimeLeft();\n+        }\n }"}, {"sha": "61d25bc41ee0a816e5e118d1d1ae4f093a1617f2", "filename": "src/scripting/event/EventManager.java", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/7fcdc07b5b3f883da29619e094ba3f8ab401165a/src/scripting/event/EventManager.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/7fcdc07b5b3f883da29619e094ba3f8ab401165a/src/scripting/event/EventManager.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/scripting/event/EventManager.java?ref=7fcdc07b5b3f883da29619e094ba3f8ab401165a", "patch": "@@ -95,11 +95,13 @@ public void cancel() {\n     private List<Integer> getLobbyRange() {\n         try {\n             return convertToIntegerArray((List<Double>)iv.invokeFunction(\"setLobbyRange\", (Object) null));\n-        } catch (ScriptException | NoSuchMethodException ex) {\n-            ex.printStackTrace();\n+        } catch (ScriptException | NoSuchMethodException ex) { // they didn't define a lobby range\n+            List<Integer> defaultList = new ArrayList<>();\n+            defaultList.add(0);\n+            defaultList.add(maxLobbys);\n+            \n+            return defaultList;\n         }\n-        \n-        return new ArrayList<>();\n     }\n \n     public void schedule(String methodName, long delay) {"}, {"sha": "825a7f22d7f1b4f6a0aa00546dcfbbad520152a8", "filename": "src/server/TimerManager.java", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/7fcdc07b5b3f883da29619e094ba3f8ab401165a/src/server/TimerManager.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/7fcdc07b5b3f883da29619e094ba3f8ab401165a/src/server/TimerManager.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/TimerManager.java?ref=7fcdc07b5b3f883da29619e094ba3f8ab401165a", "patch": "@@ -64,9 +64,9 @@ public Thread newThread(Runnable r) {\n         });\n         //this is a no-no, it actually does nothing..then why the fuck are you doing it?\n         stpe.setContinueExistingPeriodicTasksAfterShutdownPolicy(false);\n-\t\tstpe.setRemoveOnCancelPolicy(true);\n+        stpe.setRemoveOnCancelPolicy(true);\n \t\t\n-\t\tstpe.setKeepAliveTime(5, TimeUnit.MINUTES);\n+        stpe.setKeepAliveTime(5, TimeUnit.MINUTES);\n         stpe.allowCoreThreadTimeOut(true);\n \t\t\n         ses = stpe;\n@@ -143,7 +143,7 @@ public void run() {\n             try {\n                 r.run();\n             } catch (Throwable t) {\n-\t\t\t\tFilePrinter.printError(FilePrinter.EXCEPTION_CAUGHT, t);\n+                FilePrinter.printError(FilePrinter.EXCEPTION_CAUGHT, t);\n             }\n         }\n     }"}, {"sha": "d0190a78d945d745ff94940e09767fb1b1aeb84c", "filename": "todo.txt", "status": "added", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/7fcdc07b5b3f883da29619e094ba3f8ab401165a/todo.txt", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/7fcdc07b5b3f883da29619e094ba3f8ab401165a/todo.txt", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/todo.txt?ref=7fcdc07b5b3f883da29619e094ba3f8ab401165a", "patch": "@@ -0,0 +1,3 @@\n+guild npc\n+PQs\n+scrolls for weather resistance\n\\ No newline at end of file"}, {"sha": "2214f196e57519979c53e4acd744ef873ac4115d", "filename": "wz/Map.wz/Map/Map3/300000010.img.xml", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/7fcdc07b5b3f883da29619e094ba3f8ab401165a/wz/Map.wz/Map/Map3/300000010.img.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/7fcdc07b5b3f883da29619e094ba3f8ab401165a/wz/Map.wz/Map/Map3/300000010.img.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/wz/Map.wz/Map/Map3/300000010.img.xml?ref=7fcdc07b5b3f883da29619e094ba3f8ab401165a", "patch": "@@ -1032,7 +1032,7 @@\n       <int name=\"y\" value=\"238\"/>\n       <int name=\"tm\" value=\"999999999\"/>\n       <string name=\"tn\" value=\"\"/>\n-      <string name=\"script\" value=\"cellar\"/>\n+      <string name=\"script\" value=\"jail_in\"/>\n     </imgdir>\n   </imgdir>\n </imgdir>"}, {"sha": "d261a3140edeb1a98af6fca7aa394953eb1229cf", "filename": "wz/Map.wz/Map/Map3/300000012.img.xml", "status": "modified", "additions": 130, "deletions": 123, "changes": 253, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/7fcdc07b5b3f883da29619e094ba3f8ab401165a/wz/Map.wz/Map/Map3/300000012.img.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/7fcdc07b5b3f883da29619e094ba3f8ab401165a/wz/Map.wz/Map/Map3/300000012.img.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/wz/Map.wz/Map/Map3/300000012.img.xml?ref=7fcdc07b5b3f883da29619e094ba3f8ab401165a", "patch": "@@ -1,261 +1,280 @@\n <?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n <imgdir name=\"300000012.img\">\n   <imgdir name=\"info\">\n-    <int name=\"version\" value=\"10\"/>\n+    <string name=\"bgm\" value=\"Bgm15/ElinForest\"/>\n     <int name=\"cloud\" value=\"0\"/>\n-    <int name=\"town\" value=\"1\"/>\n     <int name=\"swim\" value=\"0\"/>\n-    <int name=\"returnMap\" value=\"300000010\"/>\n-    <int name=\"forcedReturn\" value=\"300000010\"/>\n-    <float name=\"mobRate\" value=\"1.0\"/>\n-    <string name=\"bgm\" value=\"Bgm15/ElinForest\"/>\n-    <string name=\"mapMark\" value=\"EilnForest\"/>\n+    <int name=\"forcedReturn\" value=\"999999999\"/>\n     <int name=\"hideMinimap\" value=\"0\"/>\n-    <int name=\"fieldLimit\" value=\"8958\"/>\n-    <int name=\"VRTop\" value=\"-357\"/>\n+    <string name=\"mapMark\" value=\"EilnForest\"/>\n+    <float name=\"mobRate\" value=\"1.0\"/>\n+    <int name=\"returnMap\" value=\"300000010\"/>\n+    <int name=\"town\" value=\"1\"/>\n+    <int name=\"version\" value=\"10\"/>\n+    <int name=\"fieldLimit\" value=\"140024\"/>\n     <int name=\"VRLeft\" value=\"-359\"/>\n-    <int name=\"VRBottom\" value=\"239\"/>\n     <int name=\"VRRight\" value=\"439\"/>\n-  </imgdir>\n-  <imgdir name=\"back\">\n-    <imgdir name=\"0\">\n-      <string name=\"bS\" value=\"ancientForest\"/>\n-      <int name=\"front\" value=\"0\"/>\n-      <int name=\"ani\" value=\"0\"/>\n-      <int name=\"no\" value=\"0\"/>\n-      <int name=\"f\" value=\"0\"/>\n-      <int name=\"x\" value=\"0\"/>\n-      <int name=\"y\" value=\"0\"/>\n-      <int name=\"rx\" value=\"0\"/>\n-      <int name=\"ry\" value=\"0\"/>\n-      <int name=\"type\" value=\"3\"/>\n-      <int name=\"cx\" value=\"0\"/>\n-      <int name=\"cy\" value=\"0\"/>\n-      <int name=\"a\" value=\"255\"/>\n-    </imgdir>\n-  </imgdir>\n-  <imgdir name=\"life\">\n-  </imgdir>\n-  <imgdir name=\"reactor\">\n+    <int name=\"VRTop\" value=\"-357\"/>\n+    <int name=\"VRBottom\" value=\"239\"/>\n   </imgdir>\n   <imgdir name=\"0\">\n     <imgdir name=\"info\">\n     </imgdir>\n-    <imgdir name=\"tile\">\n-    </imgdir>\n     <imgdir name=\"obj\">\n     </imgdir>\n+    <imgdir name=\"tile\">\n+    </imgdir>\n   </imgdir>\n   <imgdir name=\"1\">\n     <imgdir name=\"info\">\n     </imgdir>\n-    <imgdir name=\"tile\">\n-    </imgdir>\n     <imgdir name=\"obj\">\n       <imgdir name=\"0\">\n-        <string name=\"oS\" value=\"insideEL\"/>\n-        <string name=\"l0\" value=\"undergroundroom\"/>\n-        <string name=\"l1\" value=\"wall\"/>\n-        <string name=\"l2\" value=\"0\"/>\n         <int name=\"x\" value=\"241\"/>\n         <int name=\"y\" value=\"91\"/>\n         <int name=\"z\" value=\"9\"/>\n-        <int name=\"f\" value=\"0\"/>\n         <int name=\"zM\" value=\"0\"/>\n-        <int name=\"r\" value=\"0\"/>\n-      </imgdir>\n-      <imgdir name=\"1\">\n         <string name=\"oS\" value=\"insideEL\"/>\n         <string name=\"l0\" value=\"undergroundroom\"/>\n         <string name=\"l1\" value=\"wall\"/>\n-        <string name=\"l2\" value=\"1\"/>\n+        <string name=\"l2\" value=\"0\"/>\n+        <int name=\"r\" value=\"0\"/>\n+        <int name=\"f\" value=\"0\"/>\n+      </imgdir>\n+      <imgdir name=\"1\">\n         <int name=\"x\" value=\"241\"/>\n         <int name=\"y\" value=\"91\"/>\n         <int name=\"z\" value=\"9\"/>\n-        <int name=\"f\" value=\"0\"/>\n         <int name=\"zM\" value=\"1\"/>\n-        <int name=\"r\" value=\"0\"/>\n-      </imgdir>\n-      <imgdir name=\"2\">\n         <string name=\"oS\" value=\"insideEL\"/>\n         <string name=\"l0\" value=\"undergroundroom\"/>\n         <string name=\"l1\" value=\"wall\"/>\n-        <string name=\"l2\" value=\"2\"/>\n+        <string name=\"l2\" value=\"1\"/>\n+        <int name=\"r\" value=\"0\"/>\n+        <int name=\"f\" value=\"0\"/>\n+      </imgdir>\n+      <imgdir name=\"2\">\n         <int name=\"x\" value=\"-159\"/>\n         <int name=\"y\" value=\"-209\"/>\n         <int name=\"z\" value=\"9\"/>\n-        <int name=\"f\" value=\"0\"/>\n         <int name=\"zM\" value=\"0\"/>\n-        <int name=\"r\" value=\"0\"/>\n-      </imgdir>\n-      <imgdir name=\"3\">\n         <string name=\"oS\" value=\"insideEL\"/>\n         <string name=\"l0\" value=\"undergroundroom\"/>\n         <string name=\"l1\" value=\"wall\"/>\n-        <string name=\"l2\" value=\"3\"/>\n+        <string name=\"l2\" value=\"2\"/>\n+        <int name=\"r\" value=\"0\"/>\n+        <int name=\"f\" value=\"0\"/>\n+      </imgdir>\n+      <imgdir name=\"3\">\n         <int name=\"x\" value=\"241\"/>\n         <int name=\"y\" value=\"-209\"/>\n         <int name=\"z\" value=\"9\"/>\n-        <int name=\"f\" value=\"0\"/>\n         <int name=\"zM\" value=\"0\"/>\n-        <int name=\"r\" value=\"0\"/>\n-      </imgdir>\n-      <imgdir name=\"4\">\n         <string name=\"oS\" value=\"insideEL\"/>\n         <string name=\"l0\" value=\"undergroundroom\"/>\n         <string name=\"l1\" value=\"wall\"/>\n-        <string name=\"l2\" value=\"4\"/>\n+        <string name=\"l2\" value=\"3\"/>\n+        <int name=\"r\" value=\"0\"/>\n+        <int name=\"f\" value=\"0\"/>\n+      </imgdir>\n+      <imgdir name=\"4\">\n         <int name=\"x\" value=\"64\"/>\n         <int name=\"y\" value=\"-62\"/>\n         <int name=\"z\" value=\"10\"/>\n-        <int name=\"f\" value=\"0\"/>\n         <int name=\"zM\" value=\"0\"/>\n-        <int name=\"r\" value=\"0\"/>\n-      </imgdir>\n-      <imgdir name=\"5\">\n         <string name=\"oS\" value=\"insideEL\"/>\n         <string name=\"l0\" value=\"undergroundroom\"/>\n         <string name=\"l1\" value=\"wall\"/>\n-        <string name=\"l2\" value=\"5\"/>\n+        <string name=\"l2\" value=\"4\"/>\n+        <int name=\"r\" value=\"0\"/>\n+        <int name=\"f\" value=\"0\"/>\n+      </imgdir>\n+      <imgdir name=\"5\">\n         <int name=\"x\" value=\"36\"/>\n         <int name=\"y\" value=\"98\"/>\n         <int name=\"z\" value=\"11\"/>\n-        <int name=\"f\" value=\"0\"/>\n         <int name=\"zM\" value=\"0\"/>\n+        <string name=\"oS\" value=\"insideEL\"/>\n+        <string name=\"l0\" value=\"undergroundroom\"/>\n+        <string name=\"l1\" value=\"wall\"/>\n+        <string name=\"l2\" value=\"5\"/>\n         <int name=\"r\" value=\"0\"/>\n+        <int name=\"f\" value=\"0\"/>\n       </imgdir>\n       <imgdir name=\"6\">\n-        <string name=\"oS\" value=\"insideEL\"/>\n-        <string name=\"l0\" value=\"undergroundroom\"/>\n-        <string name=\"l1\" value=\"acc\"/>\n-        <string name=\"l2\" value=\"0\"/>\n         <int name=\"x\" value=\"-301\"/>\n         <int name=\"y\" value=\"102\"/>\n         <int name=\"z\" value=\"10\"/>\n-        <int name=\"f\" value=\"0\"/>\n         <int name=\"zM\" value=\"0\"/>\n+        <string name=\"oS\" value=\"insideEL\"/>\n+        <string name=\"l0\" value=\"undergroundroom\"/>\n+        <string name=\"l1\" value=\"acc\"/>\n+        <string name=\"l2\" value=\"0\"/>\n         <int name=\"r\" value=\"0\"/>\n+        <int name=\"f\" value=\"0\"/>\n       </imgdir>\n     </imgdir>\n+    <imgdir name=\"tile\">\n+    </imgdir>\n   </imgdir>\n   <imgdir name=\"2\">\n     <imgdir name=\"info\">\n     </imgdir>\n-    <imgdir name=\"tile\">\n-    </imgdir>\n     <imgdir name=\"obj\">\n     </imgdir>\n+    <imgdir name=\"tile\">\n+    </imgdir>\n   </imgdir>\n   <imgdir name=\"3\">\n     <imgdir name=\"info\">\n     </imgdir>\n-    <imgdir name=\"tile\">\n-    </imgdir>\n     <imgdir name=\"obj\">\n       <imgdir name=\"0\">\n-        <string name=\"oS\" value=\"insideEL\"/>\n-        <string name=\"l0\" value=\"undergroundroom\"/>\n-        <string name=\"l1\" value=\"frame\"/>\n-        <string name=\"l2\" value=\"0\"/>\n         <int name=\"x\" value=\"-227\"/>\n         <int name=\"y\" value=\"-276\"/>\n         <int name=\"z\" value=\"9\"/>\n-        <int name=\"f\" value=\"0\"/>\n         <int name=\"zM\" value=\"0\"/>\n-        <int name=\"r\" value=\"0\"/>\n-      </imgdir>\n-      <imgdir name=\"1\">\n         <string name=\"oS\" value=\"insideEL\"/>\n         <string name=\"l0\" value=\"undergroundroom\"/>\n         <string name=\"l1\" value=\"frame\"/>\n-        <string name=\"l2\" value=\"1\"/>\n+        <string name=\"l2\" value=\"0\"/>\n+        <int name=\"r\" value=\"0\"/>\n+        <int name=\"f\" value=\"0\"/>\n+      </imgdir>\n+      <imgdir name=\"1\">\n         <int name=\"x\" value=\"-324\"/>\n         <int name=\"y\" value=\"-40\"/>\n         <int name=\"z\" value=\"9\"/>\n-        <int name=\"f\" value=\"0\"/>\n         <int name=\"zM\" value=\"0\"/>\n-        <int name=\"r\" value=\"0\"/>\n-      </imgdir>\n-      <imgdir name=\"2\">\n         <string name=\"oS\" value=\"insideEL\"/>\n         <string name=\"l0\" value=\"undergroundroom\"/>\n         <string name=\"l1\" value=\"frame\"/>\n-        <string name=\"l2\" value=\"2\"/>\n+        <string name=\"l2\" value=\"1\"/>\n+        <int name=\"r\" value=\"0\"/>\n+        <int name=\"f\" value=\"0\"/>\n+      </imgdir>\n+      <imgdir name=\"2\">\n         <int name=\"x\" value=\"27\"/>\n         <int name=\"y\" value=\"100\"/>\n         <int name=\"z\" value=\"9\"/>\n-        <int name=\"f\" value=\"0\"/>\n         <int name=\"zM\" value=\"0\"/>\n-        <int name=\"r\" value=\"0\"/>\n-      </imgdir>\n-      <imgdir name=\"3\">\n         <string name=\"oS\" value=\"insideEL\"/>\n         <string name=\"l0\" value=\"undergroundroom\"/>\n         <string name=\"l1\" value=\"frame\"/>\n         <string name=\"l2\" value=\"2\"/>\n+        <int name=\"r\" value=\"0\"/>\n+        <int name=\"f\" value=\"0\"/>\n+      </imgdir>\n+      <imgdir name=\"3\">\n         <int name=\"x\" value=\"55\"/>\n         <int name=\"y\" value=\"99\"/>\n         <int name=\"z\" value=\"9\"/>\n-        <int name=\"f\" value=\"1\"/>\n         <int name=\"zM\" value=\"0\"/>\n-        <int name=\"r\" value=\"0\"/>\n-      </imgdir>\n-      <imgdir name=\"4\">\n         <string name=\"oS\" value=\"insideEL\"/>\n         <string name=\"l0\" value=\"undergroundroom\"/>\n         <string name=\"l1\" value=\"frame\"/>\n-        <string name=\"l2\" value=\"1\"/>\n+        <string name=\"l2\" value=\"2\"/>\n+        <int name=\"r\" value=\"0\"/>\n+        <int name=\"f\" value=\"1\"/>\n+      </imgdir>\n+      <imgdir name=\"4\">\n         <int name=\"x\" value=\"406\"/>\n         <int name=\"y\" value=\"-41\"/>\n         <int name=\"z\" value=\"9\"/>\n-        <int name=\"f\" value=\"1\"/>\n         <int name=\"zM\" value=\"0\"/>\n-        <int name=\"r\" value=\"0\"/>\n-      </imgdir>\n-      <imgdir name=\"5\">\n         <string name=\"oS\" value=\"insideEL\"/>\n         <string name=\"l0\" value=\"undergroundroom\"/>\n         <string name=\"l1\" value=\"frame\"/>\n-        <string name=\"l2\" value=\"0\"/>\n+        <string name=\"l2\" value=\"1\"/>\n+        <int name=\"r\" value=\"0\"/>\n+        <int name=\"f\" value=\"1\"/>\n+      </imgdir>\n+      <imgdir name=\"5\">\n         <int name=\"x\" value=\"309\"/>\n         <int name=\"y\" value=\"-276\"/>\n         <int name=\"z\" value=\"9\"/>\n-        <int name=\"f\" value=\"1\"/>\n         <int name=\"zM\" value=\"0\"/>\n+        <string name=\"oS\" value=\"insideEL\"/>\n+        <string name=\"l0\" value=\"undergroundroom\"/>\n+        <string name=\"l1\" value=\"frame\"/>\n+        <string name=\"l2\" value=\"0\"/>\n         <int name=\"r\" value=\"0\"/>\n+        <int name=\"f\" value=\"1\"/>\n       </imgdir>\n     </imgdir>\n+    <imgdir name=\"tile\">\n+    </imgdir>\n   </imgdir>\n   <imgdir name=\"4\">\n     <imgdir name=\"info\">\n     </imgdir>\n-    <imgdir name=\"tile\">\n-    </imgdir>\n     <imgdir name=\"obj\">\n     </imgdir>\n+    <imgdir name=\"tile\">\n+    </imgdir>\n   </imgdir>\n   <imgdir name=\"5\">\n     <imgdir name=\"info\">\n     </imgdir>\n-    <imgdir name=\"tile\">\n-    </imgdir>\n     <imgdir name=\"obj\">\n     </imgdir>\n+    <imgdir name=\"tile\">\n+    </imgdir>\n   </imgdir>\n   <imgdir name=\"6\">\n     <imgdir name=\"info\">\n     </imgdir>\n-    <imgdir name=\"tile\">\n-    </imgdir>\n     <imgdir name=\"obj\">\n     </imgdir>\n+    <imgdir name=\"tile\">\n+    </imgdir>\n   </imgdir>\n   <imgdir name=\"7\">\n     <imgdir name=\"info\">\n     </imgdir>\n+    <imgdir name=\"obj\">\n+    </imgdir>\n     <imgdir name=\"tile\">\n     </imgdir>\n-    <imgdir name=\"obj\">\n+  </imgdir>\n+  <imgdir name=\"ladderRope\">\n+  </imgdir>\n+  <imgdir name=\"portal\">\n+    <imgdir name=\"0\">\n+      <int name=\"x\" value=\"194\"/>\n+      <int name=\"y\" value=\"19\"/>\n+      <int name=\"pt\" value=\"0\"/>\n+      <int name=\"tm\" value=\"999999999\"/>\n+      <string name=\"tn\" value=\"\"/>\n+      <string name=\"pn\" value=\"sp\"/>\n+    </imgdir>\n+    <imgdir name=\"1\">\n+      <int name=\"x\" value=\"-306\"/>\n+      <int name=\"y\" value=\"97\"/>\n+      <int name=\"pt\" value=\"8\"/>\n+      <int name=\"tm\" value=\"999999999\"/>\n+      <string name=\"tn\" value=\"\"/>\n+      <string name=\"pn\" value=\"portal\"/>\n+      <string name=\"script\" value=\"jail_out\"/>\n+    </imgdir>\n+  </imgdir>\n+  <imgdir name=\"reactor\">\n+  </imgdir>\n+  <imgdir name=\"back\">\n+    <imgdir name=\"0\">\n+      <int name=\"x\" value=\"0\"/>\n+      <int name=\"y\" value=\"0\"/>\n+      <int name=\"rx\" value=\"0\"/>\n+      <int name=\"ry\" value=\"0\"/>\n+      <int name=\"cx\" value=\"0\"/>\n+      <int name=\"cy\" value=\"0\"/>\n+      <int name=\"a\" value=\"255\"/>\n+      <int name=\"type\" value=\"3\"/>\n+      <int name=\"front\" value=\"0\"/>\n+      <int name=\"f\" value=\"0\"/>\n+      <string name=\"bS\" value=\"ancientForest\"/>\n+      <int name=\"ani\" value=\"0\"/>\n+      <int name=\"no\" value=\"0\"/>\n     </imgdir>\n   </imgdir>\n   <imgdir name=\"foothold\">\n@@ -269,8 +288,6 @@\n           <int name=\"prev\" value=\"0\"/>\n           <int name=\"next\" value=\"2\"/>\n         </imgdir>\n-      </imgdir>\n-      <imgdir name=\"1\">\n         <imgdir name=\"2\">\n           <int name=\"x1\" value=\"49\"/>\n           <int name=\"y1\" value=\"98\"/>\n@@ -282,16 +299,6 @@\n       </imgdir>\n     </imgdir>\n   </imgdir>\n-  <imgdir name=\"ladderRope\">\n-  </imgdir>\n-  <imgdir name=\"portal\">\n-    <imgdir name=\"0\">\n-      <string name=\"pn\" value=\"sp\"/>\n-      <int name=\"pt\" value=\"0\"/>\n-      <int name=\"x\" value=\"194\"/>\n-      <int name=\"y\" value=\"19\"/>\n-      <int name=\"tm\" value=\"999999999\"/>\n-      <string name=\"tn\" value=\"\"/>\n-    </imgdir>\n+  <imgdir name=\"life\">\n   </imgdir>\n </imgdir>"}]}]},
