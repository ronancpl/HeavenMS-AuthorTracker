{"fetchDate": "2019-12-19", "content": [{"sha": "fee0aa7e39673f3967e616435282ccf7ea235044", "node_id": "MDY6Q29tbWl0NDUwODIwMjM6ZmVlMGFhN2UzOTY3M2YzOTY3ZTYxNjQzNTI4MmNjZjdlYTIzNTA0NA==", "commit": {"author": {"name": "ronancpl", "email": "rcpl2010@gmail.com", "date": "2017-06-02T00:46:16Z"}, "committer": {"name": "ronancpl", "email": "rcpl2010@gmail.com", "date": "2017-06-02T00:46:16Z"}, "message": "Improved Delete Character\n\nImproved the Delete Character feature, now aiming to clean all leftovers\nof the character from the DB. Only works with the ENABLE_PIC flag\nactivated.", "tree": {"sha": "b39b98f9d2dfe79d26f29d62701c18a94c4d0558", "url": "https://api.github.com/repos/ronancpl/HeavenMS/git/trees/b39b98f9d2dfe79d26f29d62701c18a94c4d0558"}, "url": "https://api.github.com/repos/ronancpl/HeavenMS/git/commits/fee0aa7e39673f3967e616435282ccf7ea235044", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/fee0aa7e39673f3967e616435282ccf7ea235044", "html_url": "https://github.com/ronancpl/HeavenMS/commit/fee0aa7e39673f3967e616435282ccf7ea235044", "comments_url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/fee0aa7e39673f3967e616435282ccf7ea235044/comments", "author": {"login": "ronancpl", "id": 9257761, "node_id": "MDQ6VXNlcjkyNTc3NjE=", "avatar_url": "https://avatars2.githubusercontent.com/u/9257761?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ronancpl", "html_url": "https://github.com/ronancpl", "followers_url": "https://api.github.com/users/ronancpl/followers", "following_url": "https://api.github.com/users/ronancpl/following{/other_user}", "gists_url": "https://api.github.com/users/ronancpl/gists{/gist_id}", "starred_url": "https://api.github.com/users/ronancpl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ronancpl/subscriptions", "organizations_url": "https://api.github.com/users/ronancpl/orgs", "repos_url": "https://api.github.com/users/ronancpl/repos", "events_url": "https://api.github.com/users/ronancpl/events{/privacy}", "received_events_url": "https://api.github.com/users/ronancpl/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ronancpl", "id": 9257761, "node_id": "MDQ6VXNlcjkyNTc3NjE=", "avatar_url": "https://avatars2.githubusercontent.com/u/9257761?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ronancpl", "html_url": "https://github.com/ronancpl", "followers_url": "https://api.github.com/users/ronancpl/followers", "following_url": "https://api.github.com/users/ronancpl/following{/other_user}", "gists_url": "https://api.github.com/users/ronancpl/gists{/gist_id}", "starred_url": "https://api.github.com/users/ronancpl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ronancpl/subscriptions", "organizations_url": "https://api.github.com/users/ronancpl/orgs", "repos_url": "https://api.github.com/users/ronancpl/repos", "events_url": "https://api.github.com/users/ronancpl/events{/privacy}", "received_events_url": "https://api.github.com/users/ronancpl/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a6ac40a351796b22bbfbfa4cab8a7d43f793fe57", "url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/a6ac40a351796b22bbfbfa4cab8a7d43f793fe57", "html_url": "https://github.com/ronancpl/HeavenMS/commit/a6ac40a351796b22bbfbfa4cab8a7d43f793fe57"}], "stats": {"total": 445, "additions": 352, "deletions": 93}, "files": [{"sha": "7c00507c44284facca08cf6cbe5969a68072c985", "filename": "build/built-jar.properties", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/build/built-jar.properties", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/build/built-jar.properties", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/built-jar.properties?ref=fee0aa7e39673f3967e616435282ccf7ea235044", "patch": "@@ -1,4 +1,4 @@\n-#Thu, 01 Jun 2017 00:42:50 -0300\n+#Thu, 01 Jun 2017 21:33:39 -0300\n \n \n C\\:\\\\Nexon\\\\MapleSolaxia\\\\MapleSolaxiaV2="}, {"sha": "3a3efdb2b6891bfc98f9d3cc71ffc6ee7daf3944", "filename": "build/classes/client/MapleCharacter$10.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleCharacter$10.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleCharacter$10.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$10.class?ref=fee0aa7e39673f3967e616435282ccf7ea235044"}, {"sha": "4252e637f932b601d82840eb0085fc41e386202d", "filename": "build/classes/client/MapleCharacter$11.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleCharacter$11.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleCharacter$11.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$11.class?ref=fee0aa7e39673f3967e616435282ccf7ea235044"}, {"sha": "7e076464153af78ddbda6c84bec4c19494222a2f", "filename": "build/classes/client/MapleCharacter$12.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleCharacter$12.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleCharacter$12.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$12.class?ref=fee0aa7e39673f3967e616435282ccf7ea235044"}, {"sha": "81a23e7eb62761358134ecec912c59e5dba3ca95", "filename": "build/classes/client/MapleCharacter$13.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleCharacter$13.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleCharacter$13.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$13.class?ref=fee0aa7e39673f3967e616435282ccf7ea235044"}, {"sha": "fb8197d77cc406ce65984e1aefbba6ab390273fc", "filename": "build/classes/client/MapleCharacter$14.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleCharacter$14.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleCharacter$14.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$14.class?ref=fee0aa7e39673f3967e616435282ccf7ea235044"}, {"sha": "11a189b7d725ccd7a7a3bf27d6b107bcd9714324", "filename": "build/classes/client/MapleCharacter$15.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleCharacter$15.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleCharacter$15.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$15.class?ref=fee0aa7e39673f3967e616435282ccf7ea235044"}, {"sha": "b2126df10c87e65a51e3afdc140d44cda0a3b2a2", "filename": "build/classes/client/MapleCharacter$16.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleCharacter$16.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleCharacter$16.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$16.class?ref=fee0aa7e39673f3967e616435282ccf7ea235044"}, {"sha": "c13f335e1e945c912809c7e1939e91f201742979", "filename": "build/classes/client/MapleCharacter$17.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleCharacter$17.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleCharacter$17.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$17.class?ref=fee0aa7e39673f3967e616435282ccf7ea235044"}, {"sha": "6181a972241d5d4f4fcce2d511c690fbed866bf6", "filename": "build/classes/client/MapleCharacter$18.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleCharacter$18.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleCharacter$18.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$18.class?ref=fee0aa7e39673f3967e616435282ccf7ea235044"}, {"sha": "1ce930e54f5570bfe19668711ffa0831e11f9c7c", "filename": "build/classes/client/MapleCharacter$3.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleCharacter$3.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleCharacter$3.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$3.class?ref=fee0aa7e39673f3967e616435282ccf7ea235044"}, {"sha": "71dee6a07a43147ef1245d31acf252ad9939a39e", "filename": "build/classes/client/MapleCharacter$4.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleCharacter$4.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleCharacter$4.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$4.class?ref=fee0aa7e39673f3967e616435282ccf7ea235044"}, {"sha": "b4335bf3965f4c1a8b507d8f5ecdfc786c5a61e2", "filename": "build/classes/client/MapleCharacter$5.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleCharacter$5.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleCharacter$5.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$5.class?ref=fee0aa7e39673f3967e616435282ccf7ea235044"}, {"sha": "b0abe9ad971e1694d21f7502320da4ed4c62aa1e", "filename": "build/classes/client/MapleCharacter$6.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleCharacter$6.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleCharacter$6.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$6.class?ref=fee0aa7e39673f3967e616435282ccf7ea235044"}, {"sha": "08349e41ce18b77c60db72375706067bd87d7c7a", "filename": "build/classes/client/MapleCharacter$7.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleCharacter$7.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleCharacter$7.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$7.class?ref=fee0aa7e39673f3967e616435282ccf7ea235044"}, {"sha": "9cd51606e5191f343a1fa3d96365fcdeb1928b78", "filename": "build/classes/client/MapleCharacter$8.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleCharacter$8.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleCharacter$8.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$8.class?ref=fee0aa7e39673f3967e616435282ccf7ea235044"}, {"sha": "ede27e61916b138f0538b4ea25935ecb94c7fbd4", "filename": "build/classes/client/MapleCharacter$9.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleCharacter$9.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleCharacter$9.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$9.class?ref=fee0aa7e39673f3967e616435282ccf7ea235044"}, {"sha": "bcecb9a9b7c8d3689eeb2493edbf83fe5e5209fb", "filename": "build/classes/client/MapleCharacter$FameStatus.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleCharacter$FameStatus.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleCharacter$FameStatus.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$FameStatus.class?ref=fee0aa7e39673f3967e616435282ccf7ea235044"}, {"sha": "65a3a7ed99baa535711c177ce65bffc685c516b5", "filename": "build/classes/client/MapleCharacter$MapleBuffStatValueHolder.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleCharacter$MapleBuffStatValueHolder.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleCharacter$MapleBuffStatValueHolder.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$MapleBuffStatValueHolder.class?ref=fee0aa7e39673f3967e616435282ccf7ea235044"}, {"sha": "2c5c5f7b898854c605da0e50d12bd6d629916bdc", "filename": "build/classes/client/MapleCharacter$MapleCoolDownValueHolder.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleCharacter$MapleCoolDownValueHolder.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleCharacter$MapleCoolDownValueHolder.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$MapleCoolDownValueHolder.class?ref=fee0aa7e39673f3967e616435282ccf7ea235044"}, {"sha": "205a73a2f0a27c53c822a7435a2cc88655569b79", "filename": "build/classes/client/MapleCharacter$SkillEntry.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleCharacter$SkillEntry.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleCharacter$SkillEntry.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter$SkillEntry.class?ref=fee0aa7e39673f3967e616435282ccf7ea235044"}, {"sha": "e1462c1d121cc4902054647c9a5e14f62cd1d1b6", "filename": "build/classes/client/MapleCharacter.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleCharacter.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleCharacter.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleCharacter.class?ref=fee0aa7e39673f3967e616435282ccf7ea235044"}, {"sha": "c254e8e3a395bc674d557fcf60a59905667f2677", "filename": "build/classes/client/MapleClient$1.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleClient$1.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleClient$1.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleClient$1.class?ref=fee0aa7e39673f3967e616435282ccf7ea235044"}, {"sha": "715593300edd044d1fb2233415b820b5e20e43c1", "filename": "build/classes/client/MapleClient$CharNameAndId.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleClient$CharNameAndId.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleClient$CharNameAndId.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleClient$CharNameAndId.class?ref=fee0aa7e39673f3967e616435282ccf7ea235044"}, {"sha": "e9d93388b7a5983a621442854a39a1756c1a78ed", "filename": "build/classes/client/MapleClient.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleClient.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/MapleClient.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/MapleClient.class?ref=fee0aa7e39673f3967e616435282ccf7ea235044"}, {"sha": "fd818c1789f2f42dadfed821c60a4127298712df", "filename": "build/classes/client/inventory/Equip$ScrollResult.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/inventory/Equip$ScrollResult.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/inventory/Equip$ScrollResult.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/inventory/Equip$ScrollResult.class?ref=fee0aa7e39673f3967e616435282ccf7ea235044"}, {"sha": "44c4c21f06bccb4008760900cba66e24b498276b", "filename": "build/classes/client/inventory/Equip.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/inventory/Equip.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/client/inventory/Equip.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/client/inventory/Equip.class?ref=fee0aa7e39673f3967e616435282ccf7ea235044"}, {"sha": "744f90648e861d8489b4181e0a6d6ec094fc9fd1", "filename": "build/classes/constants/ServerConstants.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/constants/ServerConstants.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/constants/ServerConstants.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/constants/ServerConstants.class?ref=fee0aa7e39673f3967e616435282ccf7ea235044"}, {"sha": "29a4d8a87dde468aed8056eb7348f4eb2d567407", "filename": "build/classes/net/server/Server$1.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/net/server/Server$1.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/net/server/Server$1.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/net/server/Server$1.class?ref=fee0aa7e39673f3967e616435282ccf7ea235044"}, {"sha": "f89934da00d99864036574f2b042b6fe1adb22ab", "filename": "build/classes/net/server/Server.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/net/server/Server.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/net/server/Server.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/net/server/Server.class?ref=fee0aa7e39673f3967e616435282ccf7ea235044"}, {"sha": "feaf8fd11569f7665c122ea5229c84857ef974ce", "filename": "build/classes/net/server/channel/handlers/AllianceOperationHandler.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/net/server/channel/handlers/AllianceOperationHandler.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/net/server/channel/handlers/AllianceOperationHandler.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/net/server/channel/handlers/AllianceOperationHandler.class?ref=fee0aa7e39673f3967e616435282ccf7ea235044"}, {"sha": "fb9a95ed9fd909c72680735a786b7fec9aa57c91", "filename": "build/classes/net/server/channel/handlers/BuddylistModifyHandler.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/net/server/channel/handlers/BuddylistModifyHandler.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/net/server/channel/handlers/BuddylistModifyHandler.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/net/server/channel/handlers/BuddylistModifyHandler.class?ref=fee0aa7e39673f3967e616435282ccf7ea235044"}, {"sha": "60cc0121e304a41e28eec9cee1485147b3b296b6", "filename": "build/classes/net/server/guild/MapleAlliance.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/net/server/guild/MapleAlliance.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/net/server/guild/MapleAlliance.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/net/server/guild/MapleAlliance.class?ref=fee0aa7e39673f3967e616435282ccf7ea235044"}, {"sha": "f519cead261eac8e8d50d63d2f981097c4cf6faf", "filename": "build/classes/net/server/guild/MapleGuild.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/net/server/guild/MapleGuild.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/net/server/guild/MapleGuild.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/net/server/guild/MapleGuild.class?ref=fee0aa7e39673f3967e616435282ccf7ea235044"}, {"sha": "632ea90e1af4d16a3055eb8fcb7a71f30bfff0db", "filename": "build/classes/tools/MaplePacketCreator.class", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/tools/MaplePacketCreator.class", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/build/classes/tools/MaplePacketCreator.class", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/build/classes/tools/MaplePacketCreator.class?ref=fee0aa7e39673f3967e616435282ccf7ea235044"}, {"sha": "03f0f4877af1bc2dcf977bf83bcf3d1984a1e270", "filename": "dist/MapleSolaxia.jar", "status": "modified", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/dist/MapleSolaxia.jar", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/dist/MapleSolaxia.jar", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/dist/MapleSolaxia.jar?ref=fee0aa7e39673f3967e616435282ccf7ea235044"}, {"sha": "505c10c9c0d80282129c49f78f950f7789b47e07", "filename": "mychanges_ptbr.txt", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/mychanges_ptbr.txt", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/mychanges_ptbr.txt", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/mychanges_ptbr.txt?ref=fee0aa7e39673f3967e616435282ccf7ea235044", "patch": "@@ -271,4 +271,7 @@ MapleCouponInstaller: ferramenta desenvolvida para coleta de informa\n \n 31 Maio 2017,\n Compilada uma nova tabela de EXP para equips no jogo.\n-Adicionado novo sistema de EXP e nivelamento para todos os equipamentos, para al\ufffdm daqueles de tipo Reverse e Timeless.\n\\ No newline at end of file\n+Adicionado novo sistema de EXP e nivelamento para todos os equipamentos, para al\ufffdm daqueles de tipo Reverse e Timeless.\n+\n+01 Junho 2017,\n+Consertadas mec\ufffdnicas principais para deletar character, possivelmente eliminando quaisquer res\ufffdduos do mesmo da DB. Requer que ENABLE_PIC esteja ativado para funcionar.\n\\ No newline at end of file"}, {"sha": "5c91255d43719fc76d0ec1897b090d868c8533fe", "filename": "nbproject/private/private.xml", "status": "modified", "additions": 10, "deletions": 1, "changes": 11, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/nbproject/private/private.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/nbproject/private/private.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/nbproject/private/private.xml?ref=fee0aa7e39673f3967e616435282ccf7ea235044", "patch": "@@ -12,9 +12,18 @@\n     </editor-bookmarks>\n     <open-files xmlns=\"http://www.netbeans.org/ns/projectui-open-files/2\">\n         <group>\n+            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/net/server/channel/handlers/AllianceOperationHandler.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/net/server/guild/MapleGuild.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/net/MapleServerHandler.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/net/server/guild/MapleAlliance.java</file>\n             <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/net/server/Server.java</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/net/server/CouponWorker.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/scripting/npc/NPCConversationManager.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/constants/ServerConstants.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/net/server/handlers/login/CreateCharHandler.java</file>\n             <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/client/MapleCharacter.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/net/server/handlers/login/DeleteCharHandler.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/client/MapleClient.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/MapleSolaxiaV2/src/tools/MaplePacketCreator.java</file>\n         </group>\n     </open-files>\n </project-private>"}, {"sha": "bc6e4bbff7b81a90c66e62c8f6cda456dfc9e0d8", "filename": "src/client/MapleCharacter.java", "status": "modified", "additions": 207, "deletions": 0, "changes": 207, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/src/client/MapleCharacter.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/src/client/MapleCharacter.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/MapleCharacter.java?ref=fee0aa7e39673f3967e616435282ccf7ea235044", "patch": "@@ -1524,6 +1524,213 @@ public void deleteGuild(int guildId) {\n             ex.printStackTrace();\n         }\n     }\n+    \n+    private void nextPendingRequest(MapleClient c) {\n+        CharacterNameAndId pendingBuddyRequest = c.getPlayer().getBuddylist().pollPendingRequest();\n+        if (pendingBuddyRequest != null) {\n+            c.announce(MaplePacketCreator.requestBuddylistAdd(pendingBuddyRequest.getId(), c.getPlayer().getId(), pendingBuddyRequest.getName()));\n+        }\n+    }\n+    \n+    private void notifyRemoteChannel(MapleClient c, int remoteChannel, int otherCid, BuddyList.BuddyOperation operation) {\n+        MapleCharacter player = c.getPlayer();\n+        if (remoteChannel != -1) {\n+            c.getWorldServer().buddyChanged(otherCid, player.getId(), player.getName(), c.getChannel(), operation);\n+        }\n+    }\n+    \n+    public void deleteBuddy(int otherCid) {\n+        BuddyList bl = getBuddylist();\n+        \n+        if (bl.containsVisible(otherCid)) {\n+            notifyRemoteChannel(client, client.getWorldServer().find(otherCid), otherCid, BuddyList.BuddyOperation.DELETED);\n+        }\n+        bl.remove(otherCid);\n+        client.announce(MaplePacketCreator.updateBuddylist(getBuddylist().getBuddies()));\n+        nextPendingRequest(client);\n+    }\n+    \n+    public static boolean deleteCharFromDB(MapleCharacter player) {\n+            int cid = player.getId(), accId = -1, world = 0;\n+            \n+            Connection con = DatabaseConnection.getConnection();\n+            try {\n+                    try (PreparedStatement ps = con.prepareStatement(\"SELECT accountid, world FROM characters WHERE id = ?\")) {\n+                            ps.setInt(1, cid);\n+\n+                            try (ResultSet rs = ps.executeQuery()) {\n+                                    if(rs.next()) {\n+                                            accId = rs.getInt(\"accountid\");\n+                                            world = rs.getInt(\"world\");\n+                                    }\n+                            }\n+                    }\n+                    \n+                    try (PreparedStatement ps = con.prepareStatement(\"SELECT buddyid FROM buddies WHERE characterid = ?\")) {\n+                            ps.setInt(1, cid);\n+\n+                            try (ResultSet rs = ps.executeQuery()) {\n+                                    while(rs.next()) {\n+                                            int buddyid = rs.getInt(\"buddyid\");\n+                                            MapleCharacter buddy = Server.getInstance().getWorld(world).getPlayerStorage().getCharacterById(buddyid);\n+                                            \n+                                            if(buddy != null) {\n+                                                    buddy.deleteBuddy(cid);\n+                                            }\n+                                    }\n+                            }\n+                    }\n+                    try (PreparedStatement ps = con.prepareStatement(\"DELETE FROM buddies WHERE characterid = ?\")) {\n+                            ps.setInt(1, cid);\n+                            ps.executeUpdate();\n+                    }\n+                    \n+                    try (PreparedStatement ps = con.prepareStatement(\"SELECT threadid FROM bbs_threads WHERE postercid = ?\")) {\n+                            ps.setInt(1, cid);\n+                            \n+                            try (ResultSet rs = ps.executeQuery()) {\n+                                    while (rs.next()) {\n+                                            int tid = rs.getInt(\"threadid\");\n+                                        \n+                                            try (PreparedStatement ps2 = con.prepareStatement(\"DELETE FROM bbs_replies WHERE threadid = ?\")) {\n+                                                    ps2.setInt(1, tid);\n+                                                    ps2.executeUpdate();\n+                                            }\n+                                    }\n+                            }\n+                    }\n+                    try (PreparedStatement ps = con.prepareStatement(\"DELETE FROM bbs_threads WHERE postercid = ?\")) {\n+                            ps.setInt(1, cid);\n+                            ps.executeUpdate();\n+                    }\n+                    \n+                    try (PreparedStatement ps = con.prepareStatement(\"SELECT id, guildid, guildrank, name, allianceRank FROM characters WHERE id = ? AND accountid = ?\")) {\n+                            ps.setInt(1, cid);\n+                            ps.setInt(2, accId);\n+                            try (ResultSet rs = ps.executeQuery()) {\n+                                    if (rs.next() && rs.getInt(\"guildid\") > 0) {\n+                                            Server.getInstance().deleteGuildCharacter(new MapleGuildCharacter(player, cid, 0, rs.getString(\"name\"), (byte) -1, (byte) -1, 0, rs.getInt(\"guildrank\"), rs.getInt(\"guildid\"), false, rs.getInt(\"allianceRank\")));\n+                                    }\n+                            }\n+                    }\n+                    \n+                    if(con.isClosed()) con = DatabaseConnection.getConnection();    //wtf tho\n+\n+                    try (PreparedStatement ps = con.prepareStatement(\"DELETE FROM wishlists WHERE charid = ?\")) {\n+                            ps.setInt(1, cid);\n+                            ps.executeUpdate();\n+                    }\n+                    try (PreparedStatement ps = con.prepareStatement(\"DELETE FROM cooldowns WHERE charid = ?\")) {\n+                            ps.setInt(1, cid);\n+                            ps.executeUpdate();\n+                    }\n+                    try (PreparedStatement ps = con.prepareStatement(\"DELETE FROM area_info WHERE charid = ?\")) {\n+                            ps.setInt(1, cid);\n+                            ps.executeUpdate();\n+                    }\n+                    try (PreparedStatement ps = con.prepareStatement(\"DELETE FROM monsterbook WHERE charid = ?\")) {\n+                            ps.setInt(1, cid);\n+                            ps.executeUpdate();\n+                    }\n+                    try (PreparedStatement ps = con.prepareStatement(\"DELETE FROM characters WHERE id = ?\")) {\n+                            ps.setInt(1, cid);\n+                            ps.executeUpdate();\n+                    }\n+                    try (PreparedStatement ps = con.prepareStatement(\"DELETE FROM famelog WHERE characterid_to = ?\")) {\n+                            ps.setInt(1, cid);\n+                            ps.executeUpdate();\n+                    }\n+                    \n+                    try (PreparedStatement ps = con.prepareStatement(\"SELECT inventoryitemid, petid FROM inventoryitems WHERE characterid = ?\")) {\n+                            ps.setInt(1, cid);\n+                            \n+                            try (ResultSet rs = ps.executeQuery()) {\n+                                    while (rs.next()) {\n+                                            int inventoryitemid = rs.getInt(\"inventoryitemid\");\n+                                        \n+                                            try (PreparedStatement ps2 = con.prepareStatement(\"SELECT ringid FROM inventoryequipment WHERE inventoryitemid = ?\")) {\n+                                                    ps2.setInt(1, inventoryitemid);\n+\n+                                                    try (ResultSet rs2 = ps2.executeQuery()) {\n+                                                            while (rs2.next()) {\n+                                                                    int ringid = rs2.getInt(\"ringid\");\n+                                                                    \n+                                                                    if(ringid > -1) {\n+                                                                            try (PreparedStatement ps3 = con.prepareStatement(\"DELETE FROM rings WHERE id = ?\")) {\n+                                                                                    ps3.setInt(1, ringid);\n+                                                                                    ps3.executeUpdate();\n+                                                                            }\n+                                                                    }\n+                                                            }\n+                                                    }\n+                                            }\n+                                        \n+                                            try (PreparedStatement ps2 = con.prepareStatement(\"DELETE FROM inventoryequipment WHERE inventoryitemid = ?\")) {\n+                                                    ps2.setInt(1, inventoryitemid);\n+                                                    ps2.executeUpdate();\n+                                            }\n+                                            \n+                                            if(rs.getInt(\"petid\") > -1) {\n+                                                    try (PreparedStatement ps2 = con.prepareStatement(\"DELETE FROM pets WHERE petid = ?\")) {\n+                                                            ps2.setInt(1, rs.getInt(\"petid\"));\n+                                                            ps2.executeUpdate();\n+                                                    }\n+                                            }\n+                                    }\n+                            }\n+                    }\n+                    \n+                    try (PreparedStatement ps = con.prepareStatement(\"SELECT queststatusid FROM queststatus WHERE characterid = ?\")) {\n+                            ps.setInt(1, cid);\n+                            \n+                            try (ResultSet rs = ps.executeQuery()) {\n+                                    while (rs.next()) {\n+                                            int queststatusid = rs.getInt(\"queststatusid\");\n+                                        \n+                                            try (PreparedStatement ps2 = con.prepareStatement(\"DELETE FROM medalmaps WHERE queststatusid = ?\")) {\n+                                                    ps2.setInt(1, queststatusid);\n+                                                    ps2.executeUpdate();\n+                                            }\n+                                            \n+                                            try (PreparedStatement ps2 = con.prepareStatement(\"DELETE FROM questprogress WHERE queststatusid = ?\")) {\n+                                                    ps2.setInt(1, queststatusid);\n+                                                    ps2.executeUpdate();\n+                                            }\n+                                    }\n+                            }\n+                    }\n+                    \n+                    try (PreparedStatement ps = con.prepareStatement(\"SELECT id FROM mts_cart WHERE cid = ?\")) {\n+                            ps.setInt(1, cid);\n+                            \n+                            try (ResultSet rs = ps.executeQuery()) {\n+                                    while (rs.next()) {\n+                                            int mtsid = rs.getInt(\"id\");\n+                                        \n+                                            try (PreparedStatement ps2 = con.prepareStatement(\"DELETE FROM mts_items WHERE id = ?\")) {\n+                                                    ps2.setInt(1, mtsid);\n+                                                    ps2.executeUpdate();\n+                                            }\n+                                    }\n+                            }\n+                    }\n+                    try (PreparedStatement ps = con.prepareStatement(\"DELETE FROM mts_cart WHERE cid = ?\")) {\n+                            ps.setInt(1, cid);\n+                            ps.executeUpdate();\n+                    }\n+                    \n+                    String[] toDel = {\"famelog\", \"inventoryitems\", \"keymap\", \"queststatus\", \"savedlocations\", \"trocklocations\", \"skillmacros\", \"skills\", \"eventstats\", \"server_queue\"};\n+                    for (String s : toDel) {\n+                            MapleCharacter.deleteWhereCharacterId(con, \"DELETE FROM `\" + s + \"` WHERE characterid = ?\", cid);\n+                    }\n+                    \n+                    con.close();\n+                    return true;\n+            } catch (SQLException e) {\n+                    e.printStackTrace();\n+                    return false;\n+            }\n+    }\n \n     private void deleteWhereCharacterId(Connection con, String sql) throws SQLException {\n         try (PreparedStatement ps = con.prepareStatement(sql)) {"}, {"sha": "801013d3a450d3b89ab0ce26de2c19531a085f1e", "filename": "src/client/MapleClient.java", "status": "modified", "additions": 9, "deletions": 44, "changes": 53, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/src/client/MapleClient.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/src/client/MapleClient.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/MapleClient.java?ref=fee0aa7e39673f3967e616435282ccf7ea235044", "patch": "@@ -60,6 +60,7 @@\n import org.apache.mina.core.session.IoSession;\n \n import client.inventory.MapleInventoryType;\n+import constants.ServerConstants;\n import scripting.event.EventManager;\n import scripting.npc.NPCConversationManager;\n import scripting.npc.NPCScriptManager;\n@@ -445,6 +446,8 @@ public String getPic() {\n \t}\n \n \tpublic boolean checkPic(String other) {\n+                if(!ServerConstants.ENABLE_PIC) return true;\n+            \n \t\tpicattempt++;\n \t\tif (picattempt > 5) {\n \t\t\tgetSession().close(true);\n@@ -899,50 +902,12 @@ public Channel getChannelServer(byte channel) {\n \t}\n \n \tpublic boolean deleteCharacter(int cid) {\n-\t\tConnection con = DatabaseConnection.getConnection();\n-\t\t\n-\t\tMapleCharacter player = Server.getInstance().getWorld(0).getPlayerStorage().getCharacterById(cid);\n-\t\tif (player != null){\n-\t\t\tplayer.getClient().disconnect(false, false);\n-\t\t\tdisconnect(false, false);\n-\t\t\treturn false; //DC both and return, fuck that\n-\t\t}\n-\t\ttry {\n-\t\t\ttry (PreparedStatement ps = con.prepareStatement(\"SELECT id, guildid, guildrank, name, allianceRank FROM characters WHERE id = ? AND accountid = ?\")) {\n-\t\t\t\tps.setInt(1, cid);\n-\t\t\t\tps.setInt(2, accId);\n-\t\t\t\ttry (ResultSet rs = ps.executeQuery()) {\n-\t\t\t\t\tif (!rs.next()) {\n-\t\t\t\t\t\treturn false;\n-\t\t\t\t\t}\n-\t\t\t\t\tif (rs.getInt(\"guildid\") > 0) {\n-\t\t\t\t\t\ttry {\n-\t\t\t\t\t\t\tServer.getInstance().deleteGuildCharacter(new MapleGuildCharacter(player, cid, 0, rs.getString(\"name\"), (byte) -1, (byte) -1, 0, rs.getInt(\"guildrank\"), rs.getInt(\"guildid\"), false, rs.getInt(\"allianceRank\")));\n-\t\t\t\t\t\t} catch (Exception re) {\n-                                                        re.printStackTrace();\n-\t\t\t\t\t\t\treturn false;\n-\t\t\t\t\t\t}\n-\t\t\t\t\t}\n-\t\t\t\t}\n-\t\t\t}\n-\t\t\t\n-\t\t\ttry (PreparedStatement ps = con.prepareStatement(\"DELETE FROM wishlists WHERE charid = ?\")) {\n-\t\t\t\tps.setInt(1, cid);\n-\t\t\t\tps.executeUpdate();\n-\t\t\t}\n-\t\t\ttry (PreparedStatement ps = con.prepareStatement(\"DELETE FROM characters WHERE id = ?\")) {\n-\t\t\t\tps.setInt(1, cid);\n-\t\t\t\tps.executeUpdate();\n-\t\t\t}\n-\t\t\tString[] toDel = {\"famelog\", \"inventoryitems\", \"keymap\", \"queststatus\", \"savedlocations\", \"skillmacros\", \"skills\", \"eventstats\"};\n-\t\t\tfor (String s : toDel) {\n-\t\t\t\tMapleCharacter.deleteWhereCharacterId(con, \"DELETE FROM `\" + s + \"` WHERE characterid = ?\", cid);\n-\t\t\t}\n-\t\t\treturn true;\n-\t\t} catch (SQLException e) {\n-\t\t\te.printStackTrace();\n-\t\t\treturn false;\n-\t\t}\n+                try {\n+                        return MapleCharacter.deleteCharFromDB(MapleCharacter.loadCharFromDB(cid, this, false));\n+                } catch(SQLException ex) {\n+                        ex.printStackTrace();\n+                        return false;\n+                }\n \t}\n \n \tpublic String getAccountName() {"}, {"sha": "563fcbead1c28c0b291d1d3a3d109b65386e8c14", "filename": "src/client/inventory/Equip.java", "status": "modified", "additions": 79, "deletions": 17, "changes": 96, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/src/client/inventory/Equip.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/src/client/inventory/Equip.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/inventory/Equip.java?ref=fee0aa7e39673f3967e616435282ccf7ea235044", "patch": "@@ -26,6 +26,8 @@\n import constants.ExpTable;\n import java.util.LinkedList;\n import java.util.List;\n+import java.util.HashMap;\n+import java.util.Map;\n import server.MapleItemInformationProvider;\n import tools.MaplePacketCreator;\n import tools.Pair;\n@@ -52,7 +54,7 @@ public int getValue() {\n     private float itemExp;\n     private int ringid = -1;\n     private boolean wear = false;\n-    private boolean isElemental = false;    // timeless or reverse\n+    private boolean isUpgradeable, isElemental = false;    // timeless or reverse\n \n     public Equip(int id, short position) {\n         this(id, position, 0);\n@@ -260,6 +262,8 @@ public void setLevel(byte level) {\n     }\n \n     private int getStatModifier(boolean isAttribute) {\n+        // each set of stat points grants a chance for a bonus stat point upgrade at equip level up.\n+        \n         if(ServerConstants.USE_EQUIPMNT_LVLUP_POWER) {\n             if(isAttribute) return 2;\n             else return 4;\n@@ -270,11 +274,42 @@ private int getStatModifier(boolean isAttribute) {\n         }\n     }\n     \n+    private int randomizeStatUpgrade(int limit) {\n+        Map<Integer, Integer> pool = new HashMap<>();\n+        \n+        pool.put(0, 1);\n+        pool.put(1, 1);\n+        for(int i = 2; i <= limit; i++) {\n+            for(int j = 0; j < i; j++) {\n+                pool.put(j, pool.get(j) + 1);\n+            }\n+            pool.put(i, 1);\n+        }\n+        \n+        int poolCount = 0;\n+        for(Integer i: pool.values()) {\n+            poolCount += i;\n+        }\n+        \n+        int rnd = Randomizer.rand(0, poolCount);\n+        int stat = 0;\n+        for(Integer i: pool.values()) {\n+            if(rnd < i) break;\n+            \n+            stat++;\n+            rnd -= i;\n+        }\n+        \n+        return(stat);\n+    }\n+    \n     private void getUnitStatUpgrade(List<Pair<String, Integer>> stats, String name, int curStat, boolean isAttribute) {\n-        int maxUpgrade = Randomizer.rand(0, 1 + (curStat / getStatModifier(isAttribute)));\n+        isUpgradeable = true;\n+        \n+        int maxUpgrade = randomizeStatUpgrade((int)(1 + (curStat / getStatModifier(isAttribute))));\n         if(maxUpgrade == 0) return;\n             \n-        stats.add(new Pair<>(name, maxUpgrade));  // each 4 stat point grants a bonus stat upgrade on equip level up.\n+        stats.add(new Pair<>(name, maxUpgrade));\n     }\n     \n     private void getUnitSlotUpgrade(List<Pair<String, Integer>> stats, String name) {\n@@ -302,76 +337,103 @@ private void improveDefaultStats(List<Pair<String, Integer>> stats) {\n     \n     public void gainLevel(MapleClient c) {\n         List<Pair<String, Integer>> stats = MapleItemInformationProvider.getInstance().getItemLevelupStats(getItemId(), itemLevel);\n-        if(stats.isEmpty()) improveDefaultStats(stats);\n-        \n-        if(ServerConstants.USE_EQUIPMNT_LVLUP_SLOTS) {\n-            getUnitSlotUpgrade(stats, \"incVicious\");\n-            getUnitSlotUpgrade(stats, \"incSlot\");\n+        if(!stats.isEmpty()) {\n+            if(ServerConstants.USE_EQUIPMNT_LVLUP_SLOTS) {\n+                if(vicious > 0) getUnitSlotUpgrade(stats, \"incVicious\");\n+                getUnitSlotUpgrade(stats, \"incSlot\");\n+            }\n+        }\n+        else {\n+            isUpgradeable = false;\n+            \n+            do {\n+                improveDefaultStats(stats);\n+\n+                if(ServerConstants.USE_EQUIPMNT_LVLUP_SLOTS) {\n+                    if(vicious > 0) getUnitSlotUpgrade(stats, \"incVicious\");\n+                    getUnitSlotUpgrade(stats, \"incSlot\");\n+                }\n+            } while(stats.isEmpty() && isUpgradeable);\n         }\n         \n         itemLevel++;\n-        if(ServerConstants.USE_DEBUG) c.getPlayer().dropMessage(6, \"'\" + MapleItemInformationProvider.getInstance().getName(this.getItemId()) + \"' has LEVELED UP to level \" + itemLevel + \"!\");\n+        boolean gotVicious = false, gotSlot = false;\n         \n+        String lvupStr = \"'\" + MapleItemInformationProvider.getInstance().getName(this.getItemId()) + \"' is now level \" + itemLevel + \"! \";\n         for (Pair<String, Integer> stat : stats) {\n             switch (stat.getLeft()) {\n                 case \"incDEX\":\n                     dex += stat.getRight();\n+                    lvupStr += \"+\" + stat.getRight() + \"DEX \";\n                     break;\n                 case \"incSTR\":\n                     str += stat.getRight();\n+                    lvupStr += \"+\" + stat.getRight() + \"STR \";\n                     break;\n                 case \"incINT\":\n                     _int += stat.getRight();\n+                    lvupStr += \"+\" + stat.getRight() + \"INT \";\n                     break;\n                 case \"incLUK\":\n                     luk += stat.getRight();\n+                    lvupStr += \"+\" + stat.getRight() + \"LUK \";\n                     break;\n                 case \"incMHP\":\n                     hp += stat.getRight();\n+                    lvupStr += \"+\" + stat.getRight() + \"HP \";\n                     break;\n                 case \"incMMP\":\n                     mp += stat.getRight();\n+                    lvupStr += \"+\" + stat.getRight() + \"MP \";\n                     break;\n                 case \"incPAD\":\n                     watk += stat.getRight();\n+                    lvupStr += \"+\" + stat.getRight() + \"WATK \";\n                     break;\n                 case \"incMAD\":\n                     matk += stat.getRight();\n+                    lvupStr += \"+\" + stat.getRight() + \"MATK \";\n                     break;\n                 case \"incPDD\":\n                     wdef += stat.getRight();\n+                    lvupStr += \"+\" + stat.getRight() + \"WDEF \";\n                     break;\n                 case \"incMDD\":\n                     mdef += stat.getRight();\n+                    lvupStr += \"+\" + stat.getRight() + \"MDEF \";\n                     break;\n                 case \"incEVA\":\n                     avoid += stat.getRight();\n+                    lvupStr += \"+\" + stat.getRight() + \"AVOID \";\n                     break;\n                 case \"incACC\":\n                     acc += stat.getRight();\n+                    lvupStr += \"+\" + stat.getRight() + \"ACC \";\n                     break;\n                 case \"incSpeed\":\n                     speed += stat.getRight();\n+                    lvupStr += \"+\" + stat.getRight() + \"SPEED \";\n                     break;\n                 case \"incJump\":\n                     jump += stat.getRight();\n+                    lvupStr += \"+\" + stat.getRight() + \"JUMP \";\n                     break;\n                     \n                 case \"incVicious\":\n-                    if(vicious > 0) {\n-                        vicious -= stat.getRight();\n-                        if(vicious < 0) vicious = 0;\n-                        \n-                        c.getPlayer().dropMessage(6, \"A new Vicious Hammer opportunity has been found on the '\" + MapleItemInformationProvider.getInstance().getName(getItemId()) + \"'!\");\n-                    }\n-                    \n+                    vicious -= stat.getRight();\n+                    gotVicious = true;\n                     break;\n                 case \"incSlot\":\n                     upgradeSlots += stat.getRight();\n-                    c.getPlayer().dropMessage(6, \"A new upgrade slot has been found on the '\" + MapleItemInformationProvider.getInstance().getName(getItemId()) + \"'!\");\n+                    gotSlot = true;\n                     break;\n             }\n         }\n+        \n+        c.getPlayer().dropMessage(6, lvupStr);\n+        if(gotVicious) c.getPlayer().dropMessage(6, \"A new Vicious Hammer opportunity has been found on the '\" + MapleItemInformationProvider.getInstance().getName(getItemId()) + \"'!\");\n+        if(gotSlot) c.getPlayer().dropMessage(6, \"A new upgrade slot has been found on the '\" + MapleItemInformationProvider.getInstance().getName(getItemId()) + \"'!\");\n+        \n         c.announce(MaplePacketCreator.showEquipmentLevelUp());\n         c.getPlayer().getMap().broadcastMessage(c.getPlayer(), MaplePacketCreator.showForeignEffect(c.getPlayer().getId(), 15));\n         c.getPlayer().forceUpdateItem(this);"}, {"sha": "523ff839235ff26b2b654f9f8a78b50bb1db3e79", "filename": "src/constants/ServerConstants.java", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/src/constants/ServerConstants.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/src/constants/ServerConstants.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/constants/ServerConstants.java?ref=fee0aa7e39673f3967e616435282ccf7ea235044", "patch": "@@ -15,7 +15,7 @@\n     public static final long PURGING_INTERVAL = 5 * 60 * 1000;\n     public static final long RANKING_INTERVAL = 60 * 60 * 1000;\t//60 minutes, 3600000.\n     public static final long COUPON_INTERVAL = 60 * 60 * 1000;\t//60 minutes, 3600000.\n-    public static final boolean ENABLE_PIC = false;             //Pick true/false to enable or disable Pic.\n+    public static final boolean ENABLE_PIC = true;             //Pick true/false to enable or disable Pic.\n \t\t\n     //Ip Configuration\n     public static String HOST;\n@@ -33,6 +33,7 @@\n     public static final boolean USE_CUSTOM_KEYSET = true;\n     public static final boolean USE_MAXRANGE = true;        \t//Will send and receive packets from all events of a map, rather than those of only view range.\n     public static final boolean USE_DEBUG = true;           \t//Will enable some text prints and new commands in the client oriented for debugging.\n+    public static final boolean USE_DEBUG_SHOW_RCVD_PACKETS = false;\n     public static final boolean USE_MTS = false;\n     public static final boolean USE_FAMILY_SYSTEM = false;\n     public static final boolean USE_DUEY = true;"}, {"sha": "114c2027bb67f6ed455694fe35f8e69f41e3d5ad", "filename": "src/net/MapleServerHandler.java", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/src/net/MapleServerHandler.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/src/net/MapleServerHandler.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/MapleServerHandler.java?ref=fee0aa7e39673f3967e616435282ccf7ea235044", "patch": "@@ -131,7 +131,7 @@ public void messageReceived(IoSession session, Object message) {\n         short packetId = slea.readShort();\n         MapleClient client = (MapleClient) session.getAttribute(MapleClient.CLIENT_KEY);\n         \n-        //System.out.println(\"Received packet id \" + packetId);\n+        if(ServerConstants.USE_DEBUG_SHOW_RCVD_PACKETS) System.out.println(\"Received packet id \" + packetId);\n         final MaplePacketHandler packetHandler = processor.getHandler(packetId);\n         if (packetHandler != null && packetHandler.validateState(client)) {\n             try {"}, {"sha": "dbbd1dda8ad73a35904ce05d8b813dc573fcbe3c", "filename": "src/net/server/Server.java", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/src/net/server/Server.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/src/net/server/Server.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/Server.java?ref=fee0aa7e39673f3967e616435282ccf7ea235044", "patch": "@@ -484,6 +484,10 @@ public MapleGuild getGuild(int id) {\n         }\n     }\n \n+    public MapleGuild getGuild(int id, int world) {\n+            return getGuild(id, world, null);\n+    }\n+    \n     public MapleGuild getGuild(int id, int world, MapleCharacter mc) {\n         synchronized (guilds) {\n             if (guilds.get(id) != null) {"}, {"sha": "0f2e8aae8f2855a70d4f55ecc1d8f8068e4d3d8c", "filename": "src/net/server/channel/handlers/AllianceOperationHandler.java", "status": "modified", "additions": 5, "deletions": 13, "changes": 18, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/src/net/server/channel/handlers/AllianceOperationHandler.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/src/net/server/channel/handlers/AllianceOperationHandler.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/channel/handlers/AllianceOperationHandler.java?ref=fee0aa7e39673f3967e616435282ccf7ea235044", "patch": "@@ -62,16 +62,8 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n                 if (c.getPlayer().getGuild().getAllianceId() == 0 || c.getPlayer().getGuildId() < 1 || c.getPlayer().getGuildRank() != 1) {\n                     return;\n                 }\n-                int guildid = c.getPlayer().getGuildId();\n                 \n-                Server.getInstance().allianceMessage(alliance.getId(), MaplePacketCreator.removeGuildFromAlliance(alliance, guildid, c), -1, -1);\n-                Server.getInstance().removeGuildFromAlliance(alliance.getId(), guildid);\n-                \n-                Server.getInstance().allianceMessage(alliance.getId(), MaplePacketCreator.getGuildAlliances(alliance, c), -1, -1);\n-                Server.getInstance().allianceMessage(alliance.getId(), MaplePacketCreator.allianceNotice(alliance.getId(), alliance.getNotice()), -1, -1);\n-                Server.getInstance().guildMessage(guildid, MaplePacketCreator.disbandAlliance(alliance.getId()));\n-                \n-                alliance.dropMessage(\"[\" + c.getPlayer().getGuild().getName() + \"] guild has left the union.\");\n+                MapleAlliance.removeGuildFromAlliance(c.getPlayer().getGuild().getAllianceId(), c.getPlayer().getGuildId(), c.getPlayer().getWorld());\n                 break;\n             }\n             case 0x03: // send alliance invite... or at least it would be this way if i could find the right way to call it!\n@@ -129,10 +121,10 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n                     return;\n                 }\n                 \n-                Server.getInstance().allianceMessage(alliance.getId(), MaplePacketCreator.removeGuildFromAlliance(alliance, guildid, c), -1, -1);\n+                Server.getInstance().allianceMessage(alliance.getId(), MaplePacketCreator.removeGuildFromAlliance(alliance, guildid, c.getWorld()), -1, -1);\n                 Server.getInstance().removeGuildFromAlliance(alliance.getId(), guildid);\n                 \n-                Server.getInstance().allianceMessage(alliance.getId(), MaplePacketCreator.getGuildAlliances(alliance, c), -1, -1);\n+                Server.getInstance().allianceMessage(alliance.getId(), MaplePacketCreator.getGuildAlliances(alliance, c.getWorld()), -1, -1);\n                 Server.getInstance().allianceMessage(alliance.getId(), MaplePacketCreator.allianceNotice(alliance.getId(), alliance.getNotice()), -1, -1);\n                 Server.getInstance().guildMessage(guildid, MaplePacketCreator.disbandAlliance(allianceid));\n                 \n@@ -189,7 +181,7 @@ private void changeLeaderAllianceRank(MapleAlliance alliance, MapleCharacter new\n         newLeader.getMGC().setAllianceRank(1);\n         newLeader.saveGuildStatus();\n         \n-        Server.getInstance().allianceMessage(alliance.getId(), MaplePacketCreator.getGuildAlliances(alliance, newLeader.getClient()), -1, -1);\n+        Server.getInstance().allianceMessage(alliance.getId(), MaplePacketCreator.getGuildAlliances(alliance, newLeader.getWorld()), -1, -1);\n         alliance.dropMessage(\"'\" + newLeader.getName() + \"' has been appointed as the new head of this Alliance.\");\n     }\n     \n@@ -200,7 +192,7 @@ private void changePlayerAllianceRank(MapleAlliance alliance, MapleCharacter chr\n         chr.getMGC().setAllianceRank(newRank);\n         chr.saveGuildStatus();\n         \n-        Server.getInstance().allianceMessage(alliance.getId(), MaplePacketCreator.getGuildAlliances(alliance, chr.getClient()), -1, -1);\n+        Server.getInstance().allianceMessage(alliance.getId(), MaplePacketCreator.getGuildAlliances(alliance, chr.getWorld()), -1, -1);\n         alliance.dropMessage(\"'\" + chr.getName() + \"' has been reassigned as '\" + alliance.getRankTitle(newRank) + \"' in this Alliance.\");\n     }\n "}, {"sha": "be781a0510ba0a25533f9983dc19bc19071239fd", "filename": "src/net/server/channel/handlers/BuddylistModifyHandler.java", "status": "modified", "additions": 1, "deletions": 6, "changes": 7, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/src/net/server/channel/handlers/BuddylistModifyHandler.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/src/net/server/channel/handlers/BuddylistModifyHandler.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/channel/handlers/BuddylistModifyHandler.java?ref=fee0aa7e39673f3967e616435282ccf7ea235044", "patch": "@@ -192,12 +192,7 @@ public void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c) {\n             nextPendingRequest(c);\n         } else if (mode == 3) { // delete\n             int otherCid = slea.readInt();\n-            if (buddylist.containsVisible(otherCid)) {\n-                notifyRemoteChannel(c, c.getWorldServer().find(otherCid), otherCid, BuddyOperation.DELETED);\n-            }\n-            buddylist.remove(otherCid);\n-            c.announce(MaplePacketCreator.updateBuddylist(player.getBuddylist().getBuddies()));\n-            nextPendingRequest(c);\n+            player.deleteBuddy(otherCid);\n         }\n     }\n "}, {"sha": "dbb9e30d54ff371ea8dbd1cdfe1757a3d270820c", "filename": "src/net/server/guild/MapleAlliance.java", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/src/net/server/guild/MapleAlliance.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/src/net/server/guild/MapleAlliance.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/guild/MapleAlliance.java?ref=fee0aa7e39673f3967e616435282ccf7ea235044", "patch": "@@ -294,6 +294,19 @@ public static void disbandAlliance(int allianceId) {\n         }\n     }\n     \n+    public static void removeGuildFromAlliance(int allianceId, int guildId, int worldId) {\n+        MapleAlliance alliance = Server.getInstance().getAlliance(allianceId);\n+                \n+        Server.getInstance().allianceMessage(alliance.getId(), MaplePacketCreator.removeGuildFromAlliance(alliance, guildId, worldId), -1, -1);\n+        Server.getInstance().removeGuildFromAlliance(alliance.getId(), guildId);\n+\n+        Server.getInstance().allianceMessage(alliance.getId(), MaplePacketCreator.getGuildAlliances(alliance, worldId), -1, -1);\n+        Server.getInstance().allianceMessage(alliance.getId(), MaplePacketCreator.allianceNotice(alliance.getId(), alliance.getNotice()), -1, -1);\n+        Server.getInstance().guildMessage(guildId, MaplePacketCreator.disbandAlliance(alliance.getId()));\n+\n+        alliance.dropMessage(\"[\" + Server.getInstance().getGuild(guildId, worldId) + \"] guild has left the union.\");\n+    }\n+    \n     public void updateAlliancePackets(MapleCharacter chr) {\n         if (allianceId > 0) {\n             this.broadcastMessage(MaplePacketCreator.updateAllianceInfo(this, chr.getClient()));"}, {"sha": "b03917df1c6fa44bf588ecbd62e1cd352fb63c7c", "filename": "src/net/server/guild/MapleGuild.java", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/src/net/server/guild/MapleGuild.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/src/net/server/guild/MapleGuild.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/guild/MapleGuild.java?ref=fee0aa7e39673f3967e616435282ccf7ea235044", "patch": "@@ -136,6 +136,7 @@ public void buildNotifications() {\n     public void writeToDB(boolean bDisband) {\n         try {\n             Connection con = DatabaseConnection.getConnection();\n+            \n             if (!bDisband) {\n                 StringBuilder builder = new StringBuilder();\n                 builder.append(\"UPDATE guilds SET GP = ?, logo = ?, logoColor = ?, logoBG = ?, logoBGColor = ?, \");\n@@ -496,6 +497,13 @@ public void changeRankTitle(String[] ranks) {\n     }\n \n     public void disbandGuild() {\n+        if(allianceId > 0) {\n+            MapleAlliance alliance = Server.getInstance().getAlliance(allianceId);\n+            \n+            if(alliance.getLeader().getGuildId() != id) MapleAlliance.removeGuildFromAlliance(allianceId, id, world);\n+            else MapleAlliance.disbandAlliance(allianceId);\n+        }\n+        \n         this.writeToDB(true);\n         this.broadcast(null, -1, BCOp.DISBAND);\n     }"}, {"sha": "53dd4b6c14c38c0d874179b9865cdfbc55474496", "filename": "src/net/server/handlers/login/CreateCharHandler.java", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/src/net/server/handlers/login/CreateCharHandler.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/src/net/server/handlers/login/CreateCharHandler.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/handlers/login/CreateCharHandler.java?ref=fee0aa7e39673f3967e616435282ccf7ea235044", "patch": "@@ -88,7 +88,7 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n \t\tfor (int i = 0; i < items.length; i++){\n \t\t\tif (!isLegal(items[i])) {\n \t\t\t\tAutobanFactory.PACKET_EDIT.alert(newchar, name + \" tried to packet edit in character creation.\");\n-            \tFilePrinter.printError(FilePrinter.EXPLOITS  + newchar + \".txt\", \"Tried to packet edit in char creation.\");\t\n+                                FilePrinter.printError(FilePrinter.EXPLOITS  + newchar + \".txt\", \"Tried to packet edit in char creation.\");\t\n \t\t\t\tc.disconnect(true, false);\n \t\t\t\treturn;\n \t\t\t}"}, {"sha": "b6b678aa817d1eed4620c72378849e7ac1258a91", "filename": "src/net/server/handlers/login/DeleteCharHandler.java", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/src/net/server/handlers/login/DeleteCharHandler.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/src/net/server/handlers/login/DeleteCharHandler.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/handlers/login/DeleteCharHandler.java?ref=fee0aa7e39673f3967e616435282ccf7ea235044", "patch": "@@ -34,7 +34,7 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n         String pic = slea.readMapleAsciiString();\n         int cid = slea.readInt();\n         if (c.checkPic(pic)) {\n-        \tFilePrinter.printError(FilePrinter.DELETED_CHARACTERS + c.getAccountName() + \".txt\", c.getAccountName() + \" deleted CID: \" + cid + \"\\r\\n\");\t\t\t\n+            FilePrinter.printError(FilePrinter.DELETED_CHARACTERS + c.getAccountName() + \".txt\", c.getAccountName() + \" deleted CID: \" + cid + \"\\r\\n\");\t\t\t\n             c.announce(MaplePacketCreator.deleteCharResponse(cid, 0));\n             c.deleteCharacter(cid);\n         } else {"}, {"sha": "7510658f48ff2f8b18e11301b8569dcd3f150515", "filename": "src/net/server/handlers/login/RegisterPicHandler.java", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/src/net/server/handlers/login/RegisterPicHandler.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/src/net/server/handlers/login/RegisterPicHandler.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/handlers/login/RegisterPicHandler.java?ref=fee0aa7e39673f3967e616435282ccf7ea235044", "patch": "@@ -16,10 +16,10 @@ public final void handlePacket(SeekableLittleEndianAccessor slea, MapleClient c)\n         slea.readByte();\n         int charId = slea.readInt();\n         String macs = slea.readMapleAsciiString();\n-\t\tString hwid = slea.readMapleAsciiString();\n+        String hwid = slea.readMapleAsciiString();\n \t\t\n         c.updateMacs(macs);\n-\t\tc.updateHWID(hwid);\n+        c.updateHWID(hwid);\n \t\t\n         if (c.hasBannedMac() || c.hasBannedHWID()) {\n             c.getSession().close(true);"}, {"sha": "b24709bfc2b074f97083145d81f60bb25312bc3a", "filename": "src/tools/MaplePacketCreator.java", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/fee0aa7e39673f3967e616435282ccf7ea235044/src/tools/MaplePacketCreator.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/fee0aa7e39673f3967e616435282ccf7ea235044/src/tools/MaplePacketCreator.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/tools/MaplePacketCreator.java?ref=fee0aa7e39673f3967e616435282ccf7ea235044", "patch": "@@ -5944,13 +5944,13 @@ private static void getGuildInfo(final MaplePacketLittleEndianWriter mplew, Mapl\n                 return mplew.getPacket();\n         }\n \n-        public static byte[] getGuildAlliances(MapleAlliance alliance, MapleClient c) {\n+        public static byte[] getGuildAlliances(MapleAlliance alliance, int worldId) {\n                 final MaplePacketLittleEndianWriter mplew = new MaplePacketLittleEndianWriter();\n                 mplew.writeShort(SendOpcode.ALLIANCE_OPERATION.getValue());\n                 mplew.write(0x0D);\n                 mplew.writeInt(alliance.getGuilds().size());\n                 for (Integer guild : alliance.getGuilds()) {\n-                        getGuildInfo(mplew, Server.getInstance().getGuild(guild, c.getWorld(), null));\n+                        getGuildInfo(mplew, Server.getInstance().getGuild(guild, worldId, null));\n                 }\n                 return mplew.getPacket();\n         }\n@@ -6018,7 +6018,7 @@ private static void getGuildInfo(final MaplePacketLittleEndianWriter mplew, Mapl\n                 return mplew.getPacket();\n         }\n \n-        public static byte[] removeGuildFromAlliance(MapleAlliance alliance, int expelledGuild, MapleClient c) {\n+        public static byte[] removeGuildFromAlliance(MapleAlliance alliance, int expelledGuild, int worldId) {\n                 final MaplePacketLittleEndianWriter mplew = new MaplePacketLittleEndianWriter();\n                 mplew.writeShort(SendOpcode.ALLIANCE_OPERATION.getValue());\n                 mplew.write(0x10);\n@@ -6034,7 +6034,7 @@ private static void getGuildInfo(final MaplePacketLittleEndianWriter mplew, Mapl\n                 mplew.writeInt(alliance.getCapacity());\n                 mplew.writeMapleAsciiString(alliance.getNotice());\n                 mplew.writeInt(expelledGuild);\n-                getGuildInfo(mplew, Server.getInstance().getGuild(expelledGuild, c.getWorld(), null));\n+                getGuildInfo(mplew, Server.getInstance().getGuild(expelledGuild, worldId, null));\n                 mplew.write(0x01);\n                 return mplew.getPacket();\n         }"}]}]},
