{"fetchDate": "2019-12-19", "content": [{"sha": "8c61c616f984ada8471174600253552140a4aba4", "node_id": "MDY6Q29tbWl0NDUwODIwMjM6OGM2MWM2MTZmOTg0YWRhODQ3MTE3NDYwMDI1MzU1MjE0MGE0YWJhNA==", "commit": {"author": {"name": "ronancpl", "email": "rcpl2010@gmail.com", "date": "2017-04-09T17:23:23Z"}, "committer": {"name": "ronancpl", "email": "rcpl2010@gmail.com", "date": "2017-04-09T17:23:23Z"}, "message": "More concurrency fixes + Zombify + BPQ available\n\nFixed some inconsistencies due to race conditions in the project, added\nZombify monster effect, made BPQ available and some minor patches.", "tree": {"sha": "3ee995e8af1a792058b42eaf06e70408cf7b3eeb", "url": "https://api.github.com/repos/ronancpl/HeavenMS/git/trees/3ee995e8af1a792058b42eaf06e70408cf7b3eeb"}, "url": "https://api.github.com/repos/ronancpl/HeavenMS/git/commits/8c61c616f984ada8471174600253552140a4aba4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/8c61c616f984ada8471174600253552140a4aba4", "html_url": "https://github.com/ronancpl/HeavenMS/commit/8c61c616f984ada8471174600253552140a4aba4", "comments_url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/8c61c616f984ada8471174600253552140a4aba4/comments", "author": {"login": "ronancpl", "id": 9257761, "node_id": "MDQ6VXNlcjkyNTc3NjE=", "avatar_url": "https://avatars2.githubusercontent.com/u/9257761?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ronancpl", "html_url": "https://github.com/ronancpl", "followers_url": "https://api.github.com/users/ronancpl/followers", "following_url": "https://api.github.com/users/ronancpl/following{/other_user}", "gists_url": "https://api.github.com/users/ronancpl/gists{/gist_id}", "starred_url": "https://api.github.com/users/ronancpl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ronancpl/subscriptions", "organizations_url": "https://api.github.com/users/ronancpl/orgs", "repos_url": "https://api.github.com/users/ronancpl/repos", "events_url": "https://api.github.com/users/ronancpl/events{/privacy}", "received_events_url": "https://api.github.com/users/ronancpl/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ronancpl", "id": 9257761, "node_id": "MDQ6VXNlcjkyNTc3NjE=", "avatar_url": "https://avatars2.githubusercontent.com/u/9257761?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ronancpl", "html_url": "https://github.com/ronancpl", "followers_url": "https://api.github.com/users/ronancpl/followers", "following_url": "https://api.github.com/users/ronancpl/following{/other_user}", "gists_url": "https://api.github.com/users/ronancpl/gists{/gist_id}", "starred_url": "https://api.github.com/users/ronancpl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ronancpl/subscriptions", "organizations_url": "https://api.github.com/users/ronancpl/orgs", "repos_url": "https://api.github.com/users/ronancpl/repos", "events_url": "https://api.github.com/users/ronancpl/events{/privacy}", "received_events_url": "https://api.github.com/users/ronancpl/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7dc163fc765db51669b8feaa8613d68c3bf628ca", "url": "https://api.github.com/repos/ronancpl/HeavenMS/commits/7dc163fc765db51669b8feaa8613d68c3bf628ca", "html_url": "https://github.com/ronancpl/HeavenMS/commit/7dc163fc765db51669b8feaa8613d68c3bf628ca"}], "stats": {"total": 436, "additions": 321, "deletions": 115}, "files": [{"sha": "bd590a03d42805abd39641052b6f8ddd345d3356", "filename": "mychanges_ptbr.txt", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/8c61c616f984ada8471174600253552140a4aba4/mychanges_ptbr.txt", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/8c61c616f984ada8471174600253552140a4aba4/mychanges_ptbr.txt", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/mychanges_ptbr.txt?ref=8c61c616f984ada8471174600253552140a4aba4", "patch": "@@ -137,4 +137,10 @@ Otimiza\n Corre\ufffd\ufffdo nos m\ufffdtodos que completam quests, que n\ufffdo atribu\ufffdam corretamente itens que dependem de jobs.\n Agora \ufffd poss\ufffdvel variar atributos de mobs a serem spawnados (classes ChangeableStats, OverrideStats).\n Removido ataques letais (1HP/1MP) de bosses em Dojo, que tornava imposs\ufffdvel a completude do mesmo.\n-Adi\ufffd\ufffdo de novos scripts de evento no jogo.\n\\ No newline at end of file\n+Adi\ufffd\ufffdo de novos scripts de evento no jogo.\n+\n+08 - 09 Abril 2017,\n+Adi\ufffd\ufffdo de efeito: Zombify.\n+Adi\ufffd\ufffdo da expedi\ufffd\ufffdo BPQ.\n+Aprimoramento de m\ufffdtodos que usam acesso concorrente no projeto.\n+Diversas pequenas altera\ufffd\ufffdes nos WZs do cliente/servidor.\n\\ No newline at end of file"}, {"sha": "9b44440cfdc7a5677b10c4147aab1e02d898d34e", "filename": "nbproject/private/private.xml", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/8c61c616f984ada8471174600253552140a4aba4/nbproject/private/private.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/8c61c616f984ada8471174600253552140a4aba4/nbproject/private/private.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/nbproject/private/private.xml?ref=8c61c616f984ada8471174600253552140a4aba4", "patch": "@@ -3,8 +3,7 @@\n     <editor-bookmarks xmlns=\"http://www.netbeans.org/ns/editor-bookmarks/2\" lastBookmarkId=\"0\"/>\n     <open-files xmlns=\"http://www.netbeans.org/ns/projectui-open-files/2\">\n         <group>\n-            <file>file:/C:/Nexon/MapleSolaxia/scripts/portal/outPerrion_2.js</file>\n-            <file>file:/C:/Nexon/MapleSolaxia/src/scripting/AbstractPlayerInteraction.java</file>\n+            <file>file:/C:/Nexon/MapleSolaxia/src/server/maps/MapleMap.java</file>\n         </group>\n     </open-files>\n </project-private>"}, {"sha": "a11306b3c8960972562f137b2864e416f2ba9733", "filename": "scripts/map/onFirstUserEnter/balog_summon.js", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/8c61c616f984ada8471174600253552140a4aba4/scripts/map/onFirstUserEnter/balog_summon.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/8c61c616f984ada8471174600253552140a4aba4/scripts/map/onFirstUserEnter/balog_summon.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/map/onFirstUserEnter/balog_summon.js?ref=8c61c616f984ada8471174600253552140a4aba4", "patch": "@@ -0,0 +1,13 @@\n+importPackage(Packages.server.life);\n+importPackage(Packages.tools);\n+importPackage(Packages.server.events);\n+\n+function start(ms) {\n+    try {\n+        ms.getPlayer().resetEnteredScript();\n+        ms.getPlayer().getClient().getSession().write(MaplePacketCreator.getClock(BalrogPQ.getSecondsLeft())); // 60 mins(1hr)\n+        BalrogPQ.spawnBalrog(1, ms.getPlayer());\n+    } catch(err) {\n+        ms.getPlayer().dropMessage(err);\n+    }\n+}\n\\ No newline at end of file"}, {"sha": "3b9804955b343b155d50076a1a0c44d4e0e7c28f", "filename": "scripts/npc/world0/1061014.js", "status": "modified", "additions": 14, "deletions": 50, "changes": 64, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/8c61c616f984ada8471174600253552140a4aba4/scripts/npc/world0/1061014.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/8c61c616f984ada8471174600253552140a4aba4/scripts/npc/world0/1061014.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/world0/1061014.js?ref=8c61c616f984ada8471174600253552140a4aba4", "patch": "@@ -1,85 +1,49 @@\n-/*/*\n-\tThis file is part of the OdinMS Maple Story Server\n-    Copyright (C) 2008 Patrick Huy <patrick.huy@frz.cc>\n-\t\t       Matthias Butz <matze@odinms.de>\n-\t\t       Jan Christian Meyer <vimes@odinms.de>\n-\n-    This program is free software: you can redistribute it and/or modify\n-    it under the terms of the GNU Affero General Public License as\n-    published by the Free Software Foundation version 3 as published by\n-    the Free Software Foundation. You may not use, modify or distribute\n-    this program under any other version of the GNU Affero General Public\n-    License.\n-\n-    This program is distributed in the hope that it will be useful,\n-    but WITHOUT ANY WARRANTY; without even the implied warranty of\n-    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n-    GNU Affero General Public License for more details.\n-\n-    You should have received a copy of the GNU Affero General Public License\n-    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n-*/\n-//@Author FateJiki\n-//@Author Even (modifier)\n-importPackage(Packages.server.expeditions);\n-importPackage(Packages.tools);\n-importPackage(Packages.scripting.event);\n-\n-\n+importPackage(Packages.server.events);\n var status = 0;\n-var expedition;\n-var player;\n-var em;\n-//var barlog_easy = MapleExpeditionType.BALROG_EASY;\n-//var barlog_hard = MapleExpeditionType.BALROG_HARD;\n \n function start(){\n     status = 0;\n-    \n-    cm.sendNext(\"Hi there. I am #b#nMu Young#n#k, the temple Keeper. This expedition is currently unavailable.\");\n-    cm.dispose();\n-    \n-    //action(1, 0, 0);\n+    action(1, 0, 0);\n }\n \n-function action(mode, type, selection) {\n-    if (mode <= 0) {\n+function action(mode, type, selection){\n+    if(mode <= 0){\n         cm.dispose();\n-    } else if (status == 0) {\n+    } else if(status == 0){\n         cm.sendNext(\"Hi there. I am #b#nMu Young#n#k, the temple Keeper.\");\n         status++;\n-    } else if (BalrogPQ.partyLeader == \"undefined\") {\n-        if (status == 1) {\n+    } else if(BalrogPQ.partyLeader == \"undefined\"){\n+        if(status == 1){\n         var text = \"This temple is currently under siege by the Balrog troops. We currently do not know who gave the orders. \" +\n             \"For a few weeks now, the #e#b Order of the Altair#n#k has been sending mercenaries, but they were eliminated every time.\" +\n             \" So, traveler, would you like to try your luck at defeating this unspeakable horror? \\r\\n\\r\\n \" +\n             \"#L0#Yes. Please register me as party leader\\r\\n#L1#What is the #eOrder of the Altair?\";\n         cm.sendSimple(text);\n         status++;\n-        } else if (selection == 0) {\n-            if (cm.getPlayer().getLevel() >= 70) {\n+        } else if(selection == 0){\n+            if(cm.getPlayer().getLevel() >= 70){\n                 BalrogPQ.partyLeader = cm.getPlayer().getName();\n                 cm.sendOk(\"Success. Your name has been registered and you may enter the battlefield. Come speak to me when you're ready!\");\n                 cm.getPlayer().getMap().broadcastMessage(Packages.tools.MaplePacketCreator.serverNotice(0, cm.getPlayer().getName() + \" is currently fighting the balrog on CH\" + cm.getPlayer().getClient().getChannel() + \". To join, do @balrogpq.\"))\n                 BalrogPQ.open(cm.getPlayer());\n                 cm.dispose();\n-            } else if (cm.getPlayer().getLevel() < 70) {\n+            } else if(cm.getPlayer().getLevel() < 70){\n                 cm.sendOk(\"You must be at least level 70 to even consider battling the monster.\");\n                 cm.dispose();\n             }\n-        } else if (selection == 1) {\n+        } else if(selection == 1){\n             cm.sendOk(\"The Order of the Altair is a group of elite mercenaries that oversee the world's economy and battle operations. It was founded 40 years ago right after Black Mage was defeated in hopes of forseeing the next possible attack.\");\n             cm.dispose();\n-        } else if (status == 3) {\n+        } else if(status == 3){\n             cm.warp(105100300);\n             cm.dispose();\n         }\n         } else {\n-            if (status == 1) {\n+            if(status == 1){\n             cm.sendYesNo(BalrogPQ.partyLeader + \"'s party is currently battling the Balrog. Would you like to assist?\");\n             status++;\n             } else if(status == 2){\n-                if (cm.getPlayer().getLevel() > 60 && cm.getPlayer().getClient().getChannel() == BalrogPQ.channel){\n+                if(cm.getPlayer().getLevel() > 60 && cm.getPlayer().getClient().getChannel() == BalrogPQ.channel){\n                 cm.warp(105100300);\n                 cm.dispose();\n                 } else {"}, {"sha": "9850b6a887c38f96ed2a527ba23a6c927d232bb6", "filename": "scripts/npc/world0/1061018.js", "status": "modified", "additions": 47, "deletions": 6, "changes": 53, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/8c61c616f984ada8471174600253552140a4aba4/scripts/npc/world0/1061018.js", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/8c61c616f984ada8471174600253552140a4aba4/scripts/npc/world0/1061018.js", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/scripts/npc/world0/1061018.js?ref=8c61c616f984ada8471174600253552140a4aba4", "patch": "@@ -1,10 +1,51 @@\n-function start() {\n-    cm.sendYesNo(\"If you leave now, you'll have to start over. Are you sure you want to leave?\");\n+importPackage(Packages.server.events);\n+\n+var status = 0;\n+var dispose = false;\n+function start(){\n+    status == 0;\n+    action(1, 0, 0);\n }\n \n-function action(mode, type, selection) {\n-    if (mode == 1) {\n-\tcm.warp(105100301);\n+function action(mode, type, selection){\n+    if(mode <= 0){\n+        if(!cm.getPlayer().getMap().getAllmonsters().size() == 2){\n+        cm.sendOk(\"Alrighty. We have high hopes for you so make us mercenaries proud!\");\n+        cm.dispose();\n+        } else {\n+        cm.getPlayer().getMap().killAllMonsters();\n+        BalrogPQ.partyLeader = \"undefined\";\n+        BalrogPQ.balrogSpawned = false;\n+        BalrogPQ.close();\n+            cm.warp(105100100);\n+            cm.dispose();\n+        }\n+    } else if(status == 0){\n+        if(cm.getPlayer().getMap().getCharacters().size() > 1){\n+            cm.sendYesNo(\"Are you really going to leave this battle and leave your fellow travelers to die?\");\n+            dispose = false;\n+            status++;\n+        } else if(cm.getPlayer().getMap().getCharacters().size() <= 1 && cm.getPlayer().getMap().getAllmonsters().size() != 2){\n+            cm.sendYesNo(\"If you're a coward, you will leave.\");\n+            dispose = true;\n+            status++;\n+        } else if(cm.getPlayer().getMap().getAllmonsters().size() == 0){\n+            cm.sendOk(\"Wow! You defeated the balrog.\");\n+            dispose = true;\n+            cm.getPlayer().getClient().getChannelServer().broadcastPacket(Packages.tools.MaplePacketCreator.serverNotice(0, BalrogPQ.partyLeader + \"'s party has successfully defeated the Balrog! Praise to them, they finished with \" + cm.getPlayer().getMap().getCharacters().size() + \" players.\"));\n+            status++;\n+        } else {\n+            cm.sendYesNo(\"So you are really going to leave?\");\n+            status++;\n+        }\n+    } else if(status == 1){\n+        if(dispose){\n+            cm.getPlayer().getMap().killAllMonsters();\n+            BalrogPQ.partyLeader = \"undefined\";\n+            BalrogPQ.balrogSpawned = false;\n+            BalrogPQ.close();\n+        }\n+        cm.warp(105100100);\n+        cm.dispose();\n     }\n-    cm.dispose();\n }\n\\ No newline at end of file"}, {"sha": "fe2fe217566a62f9404e7caf8d2b4dcbe20d1bab", "filename": "sql/db_drops.sql", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/8c61c616f984ada8471174600253552140a4aba4/sql/db_drops.sql", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/8c61c616f984ada8471174600253552140a4aba4/sql/db_drops.sql", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/sql/db_drops.sql?ref=8c61c616f984ada8471174600253552140a4aba4", "patch": "@@ -18846,6 +18846,7 @@\n   UPDATE drop_data SET chance=40000 WHERE itemid=4031991;\n   UPDATE drop_data SET questid=6191 WHERE itemid=4031477;\n   UPDATE drop_data SET questid=6190 WHERE itemid=4001111;\n+  UPDATE drop_data SET questid=28282 WHERE itemid=4001373;\n \n   # two items named \"Sparta\": remove the entries where lv100 Sparta is being dropped by low-level mobs.\n   UPDATE IGNORE drop_data SET itemid=1402011 WHERE itemid=1302056 AND dropperid < 8000000;"}, {"sha": "7e5c375c3353eb527332b3b58187710fa51c7e34", "filename": "src/client/MapleDisease.java", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/8c61c616f984ada8471174600253552140a4aba4/src/client/MapleDisease.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/8c61c616f984ada8471174600253552140a4aba4/src/client/MapleDisease.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/MapleDisease.java?ref=8c61c616f984ada8471174600253552140a4aba4", "patch": "@@ -26,6 +26,7 @@\n     SLOW(0x1),\n     SEDUCE(0x80),\n     FISHABLE(0x100),\n+    ZOMBIFY(0x4000),\n     CONFUSE(0x80000),\n     STUN(0x2000000000000L),\n     POISON(0x4000000000000L),"}, {"sha": "93ff9f610fc9d14bffb2f19db51da0100df5697e", "filename": "src/client/inventory/ItemFactory.java", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/8c61c616f984ada8471174600253552140a4aba4/src/client/inventory/ItemFactory.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/8c61c616f984ada8471174600253552140a4aba4/src/client/inventory/ItemFactory.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/client/inventory/ItemFactory.java?ref=8c61c616f984ada8471174600253552140a4aba4", "patch": "@@ -43,9 +43,9 @@\n     CASH_CYGNUS(4, false),\n     CASH_ARAN(5, false),\n     MERCHANT(6, false);\n-    private int value;\n-    private boolean account;\n-\tprivate static ReentrantLock lock = new ReentrantLock(true);\n+    private final int value;\n+    private final boolean account;\n+    private static final ReentrantLock lock = new ReentrantLock(true);\n \n     private ItemFactory(int value, boolean account) {\n         this.value = value;"}, {"sha": "907d6d2b1e5035b8c90142220da01d3649e90366", "filename": "src/net/server/PlayerStorage.java", "status": "modified", "additions": 12, "deletions": 6, "changes": 18, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/8c61c616f984ada8471174600253552140a4aba4/src/net/server/PlayerStorage.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/8c61c616f984ada8471174600253552140a4aba4/src/net/server/PlayerStorage.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/PlayerStorage.java?ref=8c61c616f984ada8471174600253552140a4aba4", "patch": "@@ -26,13 +26,14 @@\n import java.util.Iterator;\n import java.util.LinkedHashMap;\n import java.util.Map;\n-import java.util.concurrent.locks.Lock;\n import java.util.concurrent.locks.ReentrantReadWriteLock;\n+import java.util.concurrent.locks.ReentrantReadWriteLock.ReadLock;\n+import java.util.concurrent.locks.ReentrantReadWriteLock.WriteLock;\n \n public class PlayerStorage {\n-    private final ReentrantReadWriteLock locks = new ReentrantReadWriteLock();\n-    private final Lock rlock = locks.readLock();\n-    private final Lock wlock = locks.writeLock();\n+    private final ReentrantReadWriteLock locks = new ReentrantReadWriteLock(true);\n+    private final ReadLock rlock = locks.readLock();\n+    private final WriteLock wlock = locks.writeLock();\n     private final Map<Integer, MapleCharacter> storage = new LinkedHashMap<>();\n \n     public void addPlayer(MapleCharacter chr) {\n@@ -76,7 +77,7 @@ public MapleCharacter getCharacterById(int id) {\n     }\n \n     public Collection<MapleCharacter> getAllCharacters() {\n-        rlock.lock();    \n+        rlock.lock();\n         try {\n             return storage.values();\n         } finally {\n@@ -98,6 +99,11 @@ public final void disconnectAll() {\n     }\n     \n     public int getSize(){\n-    \treturn storage.size();\n+        rlock.lock();\n+        try {\n+            return storage.size();\n+        } finally {\n+            rlock.unlock();\n+        }\n     }\n }\n\\ No newline at end of file"}, {"sha": "2ae74c6dbd12d33d1dbb7b264e03760215b02f72", "filename": "src/net/server/channel/Channel.java", "status": "modified", "additions": 18, "deletions": 12, "changes": 30, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/8c61c616f984ada8471174600253552140a4aba4/src/net/server/channel/Channel.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/8c61c616f984ada8471174600253552140a4aba4/src/net/server/channel/Channel.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/net/server/channel/Channel.java?ref=8c61c616f984ada8471174600253552140a4aba4", "patch": "@@ -27,9 +27,11 @@\n import java.util.HashMap;\n import java.util.Iterator;\n import java.util.List;\n+import java.util.Collections;\n import java.util.Map;\n import java.util.Map.Entry;\n import java.util.concurrent.locks.ReentrantReadWriteLock;\n+import java.util.concurrent.locks.ReentrantReadWriteLock.ReadLock;\n import java.util.concurrent.locks.ReentrantReadWriteLock.WriteLock;\n \n import net.MapleServerHandler;\n@@ -71,7 +73,9 @@\n     private EventScriptManager eventSM;\n     private Map<Integer, HiredMerchant> hiredMerchants = new HashMap<>();\n     private final Map<Integer, Integer> storedVars = new HashMap<>();\n-\tprivate ReentrantReadWriteLock merchant_lock = new ReentrantReadWriteLock(true);\n+    private ReentrantReadWriteLock merchant_lock = new ReentrantReadWriteLock(true);\n+    private ReadLock merchRlock = merchant_lock.readLock();\n+    private WriteLock merchWlock = merchant_lock.writeLock();\n     private List<MapleExpedition> expeditions = new ArrayList<>();\n     private List<MapleExpeditionType> expedType = new ArrayList<>();\n     private MapleEvent event;\n@@ -130,8 +134,7 @@ public final void shutdown() {\n     }\n \n     public void closeAllMerchants() {\n-        WriteLock wlock = merchant_lock.writeLock();\n-        wlock.lock();\n+        merchWlock.lock();\n         try {\n             final Iterator<HiredMerchant> hmit = hiredMerchants.values().iterator();\n             while (hmit.hasNext()) {\n@@ -141,7 +144,7 @@ public void closeAllMerchants() {\n         } catch (Exception e) {\n \t\te.printStackTrace();\n         } finally {\n-                wlock.unlock();\n+                merchWlock.unlock();\n         }\n     }\n     \n@@ -228,28 +231,31 @@ public void run() {\n     }\n \n     public Map<Integer, HiredMerchant> getHiredMerchants() {\n-        return hiredMerchants;\n+        merchRlock.lock();\n+        try {\n+            return Collections.unmodifiableMap(hiredMerchants);\n+        } finally {\n+            merchRlock.unlock();\n+        }\n     }\n \n     public void addHiredMerchant(int chrid, HiredMerchant hm) {\n-        WriteLock wlock = merchant_lock.writeLock();\n-        wlock.lock();\n+        merchWlock.lock();\n         try {\n             hiredMerchants.put(chrid, hm);\n         } finally {\n-            wlock.unlock();\n+            merchWlock.unlock();\n         }\n     }\n \n     public void removeHiredMerchant(int chrid) {\n-        WriteLock wlock = merchant_lock.writeLock();\n-        wlock.lock();\n+        merchWlock.lock();\n         try {        \n             hiredMerchants.remove(chrid);\n         } finally {\n-            wlock.unlock();\n-        }\n+            merchWlock.unlock();\n         }\n+    }\n \n     public int[] multiBuddyFind(int charIdFrom, int[] characterIds) {\n         List<Integer> ret = new ArrayList<>(characterIds.length);"}, {"sha": "2a6019499b4befc91e91dfc06dcacd2cb0c4bc30", "filename": "src/scripting/event/EventInstanceManager.java", "status": "modified", "additions": 29, "deletions": 9, "changes": 38, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/8c61c616f984ada8471174600253552140a4aba4/src/scripting/event/EventInstanceManager.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/8c61c616f984ada8471174600253552140a4aba4/src/scripting/event/EventInstanceManager.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/scripting/event/EventInstanceManager.java?ref=8c61c616f984ada8471174600253552140a4aba4", "patch": "@@ -30,8 +30,9 @@\n import java.util.List;\n import java.util.Map;\n import java.util.Properties;\n-import java.util.concurrent.locks.Lock;\n import java.util.concurrent.locks.ReentrantReadWriteLock;\n+import java.util.concurrent.locks.ReentrantReadWriteLock.ReadLock;\n+import java.util.concurrent.locks.ReentrantReadWriteLock.WriteLock;\n \n import javax.script.ScriptException;\n \n@@ -64,7 +65,8 @@\n         private List<Integer> mapIds = new LinkedList<Integer>();\n         private List<Boolean> isInstanced = new LinkedList<Boolean>();\n         private final ReentrantReadWriteLock mutex = new ReentrantReadWriteLock();\n-        private final Lock rL = mutex.readLock(), wL = mutex.writeLock();\n+        private final ReadLock rL = mutex.readLock();\n+        private final WriteLock wL = mutex.writeLock();\n         private boolean disposed = false;\n \n \tpublic EventInstanceManager(EventManager em, String name) {\n@@ -148,11 +150,23 @@ public void unregisterPlayer(MapleCharacter chr) {\n \t}\n \t\n \tpublic int getPlayerCount() {\n-\t\treturn chars.size();\n+                rL.lock();\n+                try {\n+                    return chars.size();\n+                }\n+                finally {\n+                    rL.unlock();\n+                }\n \t}\n \n \tpublic List<MapleCharacter> getPlayers() {\n-\t\treturn new ArrayList<>(chars);\n+                rL.lock();\n+                try {\n+                    return new ArrayList<>(chars);\n+                }\n+                finally {\n+                    rL.unlock();\n+                }\n \t}\n \n \tpublic void registerMonster(MapleMonster mob) {\n@@ -247,7 +261,14 @@ public void dispose() {\n         } catch (ScriptException | NoSuchMethodException ex) {\n             ex.printStackTrace();\n         }\n-        chars.clear();\n+        \n+        wL.lock();\n+        try {\n+            chars.clear();\n+        } finally {\n+            wL.unlock();\n+        }\n+        \n         mobs.clear();\n         killCount.clear();\n         mapFactory = null;\n@@ -374,11 +395,10 @@ public final boolean disposeIfPlayerBelow(final byte size, final int towarp) {\n                 map = this.getMapFactory().getMap(towarp);\n             }\n \n-            wL.lock();\n+            rL.lock();\n             try {\n                 if (chars != null && chars.size() <= size) {\n-                    final List<MapleCharacter> chrs = new LinkedList<MapleCharacter>(chars);\n-                    for (MapleCharacter chr : chrs) {\n+                    for (MapleCharacter chr : chars) {\n                         if (chr == null) {\n                             continue;\n                         }\n@@ -393,7 +413,7 @@ public final boolean disposeIfPlayerBelow(final byte size, final int towarp) {\n             } catch (Exception ex) {\n                 ex.printStackTrace();\n             } finally {\n-                wL.unlock();\n+                rL.unlock();\n             }\n             return false;\n         }"}, {"sha": "60d2cddffb054b6cc1bb783221738daf03dc744a", "filename": "src/server/MapleStatEffect.java", "status": "modified", "additions": 11, "deletions": 3, "changes": 14, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/8c61c616f984ada8471174600253552140a4aba4/src/server/MapleStatEffect.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/8c61c616f984ada8471174600253552140a4aba4/src/server/MapleStatEffect.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/MapleStatEffect.java?ref=8c61c616f984ada8471174600253552140a4aba4", "patch": "@@ -699,7 +699,8 @@ private boolean applyTo(MapleCharacter applyfrom, MapleCharacter applyto, boolea\n          AutobanFactory.MPCON.addPoint(applyfrom.getAutobanManager(), \"mpCon hack for skill:\" + sourceid + \"; Player MP: \" + applyto.getMp() + \" MP Needed: \" + getMpCon());\n          } */\n         if (hpchange != 0) {\n-            if (hpchange < 0 && (-hpchange) > applyto.getHp()) {\n+            if (hpchange < 0 && (-hpchange) > applyto.getHp() && !applyto.hasDisease(MapleDisease.ZOMBIFY)) {\n+                applyto.getClient().announce(MaplePacketCreator.enableActions());\n                 return false;\n             }\n             int newHp = applyto.getHp() + hpchange;\n@@ -712,6 +713,7 @@ private boolean applyTo(MapleCharacter applyfrom, MapleCharacter applyto, boolea\n         int newMp = applyto.getMp() + mpchange;\n         if (mpchange != 0) {\n             if (mpchange < 0 && -mpchange > applyto.getMp()) {\n+                applyto.getClient().announce(MaplePacketCreator.enableActions());\n                 return false;\n             }\n \n@@ -1037,12 +1039,18 @@ private int calcHPChange(MapleCharacter applyfrom, boolean primary) {\n                 } else {\n                     hpchange += hp;\n                 }\n-            } else {\n+                if (applyfrom.hasDisease(MapleDisease.ZOMBIFY)) {\n+                    hpchange /= 2;\n+                }\n+            } else { // assumption: this is heal\n                 hpchange += makeHealHP(hp / 100.0, applyfrom.getTotalMagic(), 3, 5);\n+                if (applyfrom.hasDisease(MapleDisease.ZOMBIFY)) {\n+                    hpchange = -hpchange;\n+                }\n             }\n         }\n         if (hpR != 0) {\n-            hpchange += (int) (applyfrom.getCurrentMaxHp() * hpR);\n+            hpchange += (int) (applyfrom.getCurrentMaxHp() * hpR) / (applyfrom.hasDisease(MapleDisease.ZOMBIFY) ? 2 : 1);\n             applyfrom.checkBerserk();\n         }\n         if (primary) {"}, {"sha": "4a100b2a9b4ca74fa9adedc9c2da566659a5386a", "filename": "src/server/events/BalrogPQ.java", "status": "added", "additions": 108, "deletions": 0, "changes": 108, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/8c61c616f984ada8471174600253552140a4aba4/src/server/events/BalrogPQ.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/8c61c616f984ada8471174600253552140a4aba4/src/server/events/BalrogPQ.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/events/BalrogPQ.java?ref=8c61c616f984ada8471174600253552140a4aba4", "patch": "@@ -0,0 +1,108 @@\n+package server.events;\n+import client.MapleCharacter;\n+import java.util.*;\n+import server.life.MapleLifeFactory;\n+import java.awt.Point;\n+import server.maps.MapleMap;\n+import server.TimerManager;\n+\n+/**\n+ *\n+ * @author FateJiki\n+ * @Mapid 105100300\n+ */\n+public class BalrogPQ {\n+    public static final int[] EasyBalrogParts = {8830002, 8830003, 8830000};\n+    public static final int[] HardBalrogParts = {8830000, 8830001, 8830002};\n+    public static List<MapleCharacter> candidates = new ArrayList<MapleCharacter>();\n+    public static boolean hasStarted = false;\n+    public static String partyLeader = \"undefined\";\n+    public static boolean balrogSpawned = false;\n+    public static long timeStamp = 0;\n+    public static byte channel = 1;\n+    \n+    public static void addCandidate(MapleCharacter chr){\n+        synchronized(candidates){\n+            candidates.add(chr);\n+        }\n+    }\n+\n+    public static void warpAllCandidates(){\n+        for(MapleCharacter c : candidates){\n+            c.changeMap(105100300);\n+        }\n+    }\n+\n+    public static boolean isFull(MapleCharacter chr){\n+        return chr.getClient().getChannelServer().getMapFactory().getMap(105100300).getCharacters().size() > 0;\n+    }\n+\n+    public static void warpIn(MapleCharacter chr){\n+        if(hasStarted){\n+            chr.changeMap(105100300);\n+        }\n+    }\n+\n+    public static void scheduleChecks(MapleMap map){\n+        final MapleMap fmap = map;\n+        TimerManager tMan = TimerManager.getInstance();\n+        tMan.schedule(new Runnable(){\n+            @Override\n+        public void run(){\n+                for(MapleCharacter chrs : fmap.getCharacters()){\n+                    chrs.changeMap(105100100);\n+                    chrs.message(\"You did not defeat the balrog in time..\");\n+                    close();\n+                }\n+            }\n+        } , 60 * 60 * 1000);\n+\n+                tMan.schedule(new Runnable(){\n+            @Override\n+        public void run(){\n+                if(fmap.getCharacters().size() <= 3){\n+                    if(fmap.getCharacters().size() > 0){\n+                    for(MapleCharacter chrs : fmap.getCharacters()){\n+                        chrs.message(\"[The Order]: What? You're down to that many mercenaries? I need you get you out of there.\");\n+                        chrs.changeMap(105100100);\n+                    }\n+                    }\n+                    fmap.killAllMonsters();\n+                    close();\n+                }\n+            }\n+        } , 60 * 1000);\n+    }\n+\n+    public static void open(MapleCharacter chr){\n+        channel = (byte)chr.getClient().getChannel();\n+        hasStarted = true;\n+        timeStamp = System.currentTimeMillis();\n+        scheduleChecks(chr.getClient().getChannelServer().getMapFactory().getMap(105100300));\n+    }\n+\n+    public static int getSecondsLeft(){ // assuming the thing lasts 60 minutes\n+        int hour = 60 * 60; // 3600 seconds = 1hr\n+        long elapsed = System.currentTimeMillis() - timeStamp;\n+        int secondsLeft = (int)(hour - (elapsed / 1000));\n+        return secondsLeft;\n+    }\n+\n+    public static void close(){\n+        hasStarted = false;\n+        balrogSpawned = false;\n+        partyLeader = \"undefined\";\n+        candidates.clear();\n+        timeStamp = 0;\n+    }\n+    public static void spawnBalrog(int mode, MapleCharacter chr){\n+        if(!balrogSpawned){\n+            for(int i = 0; i < HardBalrogParts.length; i++){\n+                chr.getClient().getChannelServer().getMapFactory().getMap(105100300).spawnMonsterOnGroundBelow(MapleLifeFactory.getMonster(HardBalrogParts[i]), new Point(412, 258));\n+                balrogSpawned = true;\n+            }\n+        } else {\n+            // DO NUFFIN'\n+        }\n+    }\n+}  \n\\ No newline at end of file"}, {"sha": "80b7ae37c3e518a7dd53491fc835b1713e5224e3", "filename": "src/server/life/MobSkill.java", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/8c61c616f984ada8471174600253552140a4aba4/src/server/life/MobSkill.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/8c61c616f984ada8471174600253552140a4aba4/src/server/life/MobSkill.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/life/MobSkill.java?ref=8c61c616f984ada8471174600253552140a4aba4", "patch": "@@ -274,7 +274,7 @@ public void applyEffect(MapleCharacter player, MapleMonster monster, boolean ski\n                 }\n                 break;\n               default:\n-            \t  System.out.println(\"Unhandeled Mob skill: \" + skillId);\n+            \t  System.out.println(\"Unhandled Mob skill: \" + skillId);\n             \t  break;\n         }\n \t\tif (stats.size() > 0) {"}, {"sha": "17176608ddc2025622e1b1f5e6cff39f7e2bce4a", "filename": "src/server/life/MobSkillFactory.java", "status": "modified", "additions": 9, "deletions": 5, "changes": 14, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/8c61c616f984ada8471174600253552140a4aba4/src/server/life/MobSkillFactory.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/8c61c616f984ada8471174600253552140a4aba4/src/server/life/MobSkillFactory.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/life/MobSkillFactory.java?ref=8c61c616f984ada8471174600253552140a4aba4", "patch": "@@ -28,6 +28,8 @@\n import java.util.List;\n import java.util.Map;\n import java.util.concurrent.locks.ReentrantReadWriteLock;\n+import java.util.concurrent.locks.ReentrantReadWriteLock.ReadLock;\n+import java.util.concurrent.locks.ReentrantReadWriteLock.WriteLock;\n import provider.MapleData;\n import provider.MapleDataProvider;\n import provider.MapleDataProviderFactory;\n@@ -42,20 +44,22 @@\n     private static Map<String, MobSkill> mobSkills = new HashMap<String, MobSkill>();\n     private final static MapleDataProvider dataSource = MapleDataProviderFactory.getDataProvider(new File(System.getProperty(\"wzpath\") + \"/Skill.wz\"));\n     private static MapleData skillRoot = dataSource.getData(\"MobSkill.img\");\n-    private static ReentrantReadWriteLock dataLock = new ReentrantReadWriteLock();\n+    private final static ReentrantReadWriteLock dataLock = new ReentrantReadWriteLock();\n+    private final static ReadLock rL = dataLock.readLock();\n+    private final static WriteLock wL = dataLock.writeLock();\n \n     public static MobSkill getMobSkill(final int skillId, final int level) {\n         final String key = skillId + \"\" + level;\n-        dataLock.readLock().lock();\n+        rL.lock();\n         try {\n             MobSkill ret = mobSkills.get(key);\n             if (ret != null) {\n                 return ret;\n             }\n         } finally {\n-            dataLock.readLock().unlock();\n+            rL.unlock();\n         }\n-        dataLock.writeLock().lock();\n+        wL.lock();\n         try {\n             MobSkill ret;\n             ret = mobSkills.get(key);\n@@ -103,7 +107,7 @@ public static MobSkill getMobSkill(final int skillId, final int level) {\n             }\n             return ret;\n         } finally {\n-            dataLock.writeLock().unlock();\n+            wL.unlock();\n         }\n     }\n }"}, {"sha": "9f888bbcd2b91c88d548b0a95c4af4df62dcdfca", "filename": "src/server/maps/MapleMap.java", "status": "modified", "additions": 31, "deletions": 15, "changes": 46, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/8c61c616f984ada8471174600253552140a4aba4/src/server/maps/MapleMap.java", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/8c61c616f984ada8471174600253552140a4aba4/src/server/maps/MapleMap.java", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/src/server/maps/MapleMap.java?ref=8c61c616f984ada8471174600253552140a4aba4", "patch": "@@ -81,7 +81,6 @@\n import tools.Randomizer;\n \n public class MapleMap {\n-\n     private static final List<MapleMapObjectType> rangedMapobjectTypes = Arrays.asList(MapleMapObjectType.SHOP, MapleMapObjectType.ITEM, MapleMapObjectType.NPC, MapleMapObjectType.MONSTER, MapleMapObjectType.DOOR, MapleMapObjectType.SUMMON, MapleMapObjectType.REACTOR);\n     private Map<Integer, MapleMapObject> mapobjects = new LinkedHashMap<>();\n     private Collection<SpawnPoint> monsterSpawn = Collections.synchronizedList(new LinkedList<SpawnPoint>());\n@@ -875,7 +874,13 @@ public void updateMonsterController(MapleMonster monster) {\n     }\n \n     public Collection<MapleMapObject> getMapObjects() {\n-        return Collections.unmodifiableCollection(mapobjects.values());\n+        objectRLock.lock();\n+        try {\n+            return Collections.unmodifiableCollection(mapobjects.values());\n+        }\n+        finally {\n+            objectRLock.unlock();\n+        }\n     }\n \n     public boolean containsNPC(int npcid) {\n@@ -898,7 +903,12 @@ public boolean containsNPC(int npcid) {\n     }\n \n     public MapleMapObject getMapObject(int oid) {\n-        return mapobjects.get(oid);\n+        objectRLock.lock();\n+        try {\n+            return mapobjects.get(oid);\n+        } finally {\n+            objectRLock.unlock();\n+        }\n     }\n \n     /**\n@@ -1285,11 +1295,9 @@ public void run() {\n \n     public void addPlayer(final MapleCharacter chr) {\n         chrWLock.lock();\n-        chrRLock.lock();\n         try {\n             characters.add(chr);\n         } finally {\n-            chrRLock.unlock();\n             chrWLock.unlock();\n         }\n         chr.setMapId(mapid);\n@@ -1528,11 +1536,9 @@ public MaplePortal getRandomSpawnpoint() {\n \n     public void removePlayer(MapleCharacter chr) {\n         chrWLock.lock();\n-        chrRLock.lock();\n         try {\n             characters.remove(chr);\n         } finally {\n-            chrRLock.unlock();\n             chrWLock.unlock();\n         }\n         removeMapObject(chr.getObjectId());\n@@ -1841,6 +1847,8 @@ public void movePlayer(MapleCharacter player, Point newPosition) {\n         player.setPosition(newPosition);\n         Collection<MapleMapObject> visibleObjects = player.getVisibleMapObjects();\n         MapleMapObject[] visibleObjectsNow = visibleObjects.toArray(new MapleMapObject[visibleObjects.size()]);\n+        \n+        objectRLock.lock();\n         try {\n             for (MapleMapObject mo : visibleObjectsNow) {\n                 if (mo != null) {\n@@ -1853,7 +1861,10 @@ public void movePlayer(MapleCharacter player, Point newPosition) {\n             }\n         } catch (Exception e) {\n             e.printStackTrace();\n+        } finally {\n+            objectRLock.unlock();\n         }\n+        \n         for (MapleMapObject mo : getMapObjectsInRange(player.getPosition(), 722500, rangedMapobjectTypes)) {\n             if (!player.isMapObjectVisible(mo)) {\n                 mo.sendSpawnData(player.getClient());\n@@ -2399,17 +2410,22 @@ public void timeMob(int id, String msg) {\n     }\n \n     public void toggleHiddenNPC(int id) {\n-        for (MapleMapObject obj : mapobjects.values()) {\n-            if (obj.getType() == MapleMapObjectType.NPC) {\n-                MapleNPC npc = (MapleNPC) obj;\n-                if (npc.getId() == id) {\n-                    npc.setHide(!npc.isHidden());\n-                    if (!npc.isHidden()) //Should only be hidden upon changing maps\n-                    {\n-                        broadcastMessage(MaplePacketCreator.spawnNPC(npc));\n+        objectRLock.lock();\n+        try {\n+            for (MapleMapObject obj : mapobjects.values()) {\n+                if (obj.getType() == MapleMapObjectType.NPC) {\n+                    MapleNPC npc = (MapleNPC) obj;\n+                    if (npc.getId() == id) {\n+                        npc.setHide(!npc.isHidden());\n+                        if (!npc.isHidden()) //Should only be hidden upon changing maps\n+                        {\n+                            broadcastMessage(MaplePacketCreator.spawnNPC(npc));\n+                        }\n                     }\n                 }\n             }\n+        } finally {\n+            objectRLock.unlock();\n         }\n     }\n "}, {"sha": "beda6f96a84d16f193c45e81f7ca9dd28f18c841", "filename": "wz/Item.wz/Etc/0400.img.xml", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/8c61c616f984ada8471174600253552140a4aba4/wz/Item.wz/Etc/0400.img.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/8c61c616f984ada8471174600253552140a4aba4/wz/Item.wz/Etc/0400.img.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/wz/Item.wz/Etc/0400.img.xml?ref=8c61c616f984ada8471174600253552140a4aba4", "patch": "@@ -9646,6 +9646,7 @@\n       </canvas>\n       <int name=\"price\" value=\"1\"/>\n       <int name=\"slotMax\" value=\"200\"/>\n+      <int name=\"quest\" value=\"1\"/>\n     </imgdir>\n   </imgdir>\n   <imgdir name=\"04002000\">"}, {"sha": "626cb6f3c9a4c5ea587c85030822ad55a7c32918", "filename": "wz/Quest.wz/Act.img.xml", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/8c61c616f984ada8471174600253552140a4aba4/wz/Quest.wz/Act.img.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/8c61c616f984ada8471174600253552140a4aba4/wz/Quest.wz/Act.img.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/wz/Quest.wz/Act.img.xml?ref=8c61c616f984ada8471174600253552140a4aba4", "patch": "@@ -12821,6 +12821,13 @@\n     <imgdir name=\"0\">\n     </imgdir>\n     <imgdir name=\"1\">\n+      <imgdir name=\"item\">\n+        <imgdir name=\"0\">\n+          <int name=\"count\" value=\"1\"/>\n+          <int name=\"id\" value=\"1142079\"/>\n+        </imgdir>\n+      </imgdir>\n+      <int name=\"exp\" value=\"6800\"/>\n     </imgdir>\n   </imgdir>\n   <imgdir name=\"2245\">"}, {"sha": "d643397315ea3794ba3f32cf9482f9d6cb07fc59", "filename": "wz/Quest.wz/Check.img.xml", "status": "modified", "additions": 7, "deletions": 2, "changes": 9, "blob_url": "https://github.com/ronancpl/HeavenMS/blob/8c61c616f984ada8471174600253552140a4aba4/wz/Quest.wz/Check.img.xml", "raw_url": "https://github.com/ronancpl/HeavenMS/raw/8c61c616f984ada8471174600253552140a4aba4/wz/Quest.wz/Check.img.xml", "contents_url": "https://api.github.com/repos/ronancpl/HeavenMS/contents/wz/Quest.wz/Check.img.xml?ref=8c61c616f984ada8471174600253552140a4aba4", "patch": "@@ -24325,11 +24325,16 @@\n   <imgdir name=\"2244\">\n     <imgdir name=\"0\">\n       <int name=\"npc\" value=\"1061017\"/>\n-      <int name=\"lvmin\" value=\"10\"/>\n+      <int name=\"lvmin\" value=\"50\"/>\n     </imgdir>\n     <imgdir name=\"1\">\n       <int name=\"npc\" value=\"1061017\"/>\n-      <string name=\"endscript\" value=\"q2244e\"/>\n+      <imgdir name=\"mob\">\n+        <imgdir name=\"0\">\n+          <int name=\"count\" value=\"200\"/>\n+          <int name=\"id\" value=\"8830003\"/>\n+        </imgdir>\n+      </imgdir>\n     </imgdir>\n   </imgdir>\n   <imgdir name=\"2245\">"}]}]},
